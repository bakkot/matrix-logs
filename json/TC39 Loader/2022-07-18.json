[
{"content":{"body":"https://github.com/codehag/pattern-matching-epic\ncc Kris Kowal this repo introduce a new proposal process called Epic, it looks very like what you did in #71","format":"org.matrix.custom.html","formatted_body":"https://github.com/codehag/pattern-matching-epic<br>cc <a href=\"https://matrix.to/#/@kriskowal:matrix.org\">Kris Kowal</a> this repo introduce a new proposal process called Epic, it looks very like what you did in #71","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"https://github.com/codehag/pattern-matching-epic\ncc Kris Kowal this repo introduce a new proposal process called Epic, it looks very like what you did in #71","mimetype":"text/plain"},{"body":"https://github.com/codehag/pattern-matching-epic<br>cc <a href=\"https://matrix.to/#/@kriskowal:matrix.org\">Kris Kowal</a> this repo introduce a new proposal process called Epic, it looks very like what you did in #71","mimetype":"text/html"}]},"ts":1658161033063,"senderName":"Jack Works","senderId":"@jackworks:matrix.org","id":"$X-JzFP1nJbqiqkjT1eDGPyWE1PchX52E3GptvKY5rjU"},
{"content":{"body":"Convergent evolution in the wild.","msgtype":"m.text","org.matrix.msc1767.text":"Convergent evolution in the wild."},"ts":1658163475831,"senderName":"Kris Kowal","senderId":"@kriskowal:matrix.org","id":"$uHSOLk1ydCcj7Zdr59Sc9sO5ccENs8Jdu5vCedXgGSQ"},
{"content":{"body":"yulia: as Jack Works points out, we have jinxed each other. I have a PR open that breaks Compartments into layers https://github.com/tc39/proposal-compartments/blob/fc3e8e0a6c1af7ffb09f111d9ddd9328aed09cf0/README.md","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@yulia:mozilla.org\">yulia</a>: as <a href=\"https://matrix.to/#/@jackworks:matrix.org\">Jack Works</a> points out, we have jinxed each other. I have a PR open that breaks Compartments into layers https://github.com/tc39/proposal-compartments/blob/fc3e8e0a6c1af7ffb09f111d9ddd9328aed09cf0/README.md","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"yulia: as Jack Works points out, we have jinxed each other. I have a PR open that breaks Compartments into layers https://github.com/tc39/proposal-compartments/blob/fc3e8e0a6c1af7ffb09f111d9ddd9328aed09cf0/README.md","mimetype":"text/plain"},{"body":"<a href=\"https://matrix.to/#/@yulia:mozilla.org\">yulia</a>: as <a href=\"https://matrix.to/#/@jackworks:matrix.org\">Jack Works</a> points out, we have jinxed each other. I have a PR open that breaks Compartments into layers https://github.com/tc39/proposal-compartments/blob/fc3e8e0a6c1af7ffb09f111d9ddd9328aed09cf0/README.md","mimetype":"text/html"}]},"ts":1658163642953,"senderName":"Kris Kowal","senderId":"@kriskowal:matrix.org","id":"$lPsopXm-d2wWx14YCHbYz6hsrZsYogNCxdhwEA230Q0"},
{"content":{"body":"Which is to say, I support this potential new evolution in proposal design.","msgtype":"m.text","org.matrix.msc1767.text":"Which is to say, I support this potential new evolution in proposal design."},"ts":1658163673163,"senderName":"Kris Kowal","senderId":"@kriskowal:matrix.org","id":"$aR_oFS-b7adem68PgLAjtbg2BegZr5nusJWndI5a7vg"},
{"content":{"body":"littledan, nicolo-ribaudo Had a conversation with Mark Miller and Peter Hoddie in which I managed fall back to my earlier position that `Module` needs to take a referrer and that the arguments of `importHook` need to be `(specifier, referrer)`, but now with a compelling argument: It should not be possible for the referrer to vary between calls to the `importHook`, and that’s best guaranteed if we capture the `referrer` given to the `Module` constructor in an internal slot that the module instance feeds back to `importHook`.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@littledan:matrix.org\">littledan</a>, <a href=\"https://matrix.to/#/@nicolo-ribaudo:matrix.org\">nicolo-ribaudo</a> Had a conversation with Mark Miller and Peter Hoddie in which I managed fall back to my earlier position that <code>Module</code> needs to take a referrer and that the arguments of <code>importHook</code> need to be <code>(specifier, referrer)</code>, but now with a compelling argument: It should not be possible for the referrer to vary between calls to the <code>importHook</code>, and that’s best guaranteed if we capture the <code>referrer</code> given to the <code>Module</code> constructor in an internal slot that the module instance feeds back to <code>importHook</code>.","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"littledan, nicolo-ribaudo Had a conversation with Mark Miller and Peter Hoddie in which I managed fall back to my earlier position that `Module` needs to take a referrer and that the arguments of `importHook` need to be `(specifier, referrer)`, but now with a compelling argument: It should not be possible for the referrer to vary between calls to the `importHook`, and that’s best guaranteed if we capture the `referrer` given to the `Module` constructor in an internal slot that the module instance feeds back to `importHook`.","mimetype":"text/plain"},{"body":"<a href=\"https://matrix.to/#/@littledan:matrix.org\">littledan</a>, <a href=\"https://matrix.to/#/@nicolo-ribaudo:matrix.org\">nicolo-ribaudo</a> Had a conversation with Mark Miller and Peter Hoddie in which I managed fall back to my earlier position that <code>Module</code> needs to take a referrer and that the arguments of <code>importHook</code> need to be <code>(specifier, referrer)</code>, but now with a compelling argument: It should not be possible for the referrer to vary between calls to the <code>importHook</code>, and that’s best guaranteed if we capture the <code>referrer</code> given to the <code>Module</code> constructor in an internal slot that the module instance feeds back to <code>importHook</code>.","mimetype":"text/html"}]},"ts":1658184957850,"senderName":"Kris Kowal","senderId":"@kriskowal:matrix.org","id":"$KUJ9SGiPDMQp59PydA42epkeUDB71rVjUHnuRrk1RCM"},
{"content":{"body":"I may or may not successfully edit my way to that state before I present, and obviously, my goal is to reach a consistent snapshot before plenary, not to have a final answer to the design question.","msgtype":"m.text","org.matrix.msc1767.text":"I may or may not successfully edit my way to that state before I present, and obviously, my goal is to reach a consistent snapshot before plenary, not to have a final answer to the design question."},"ts":1658185040415,"senderName":"Kris Kowal","senderId":"@kriskowal:matrix.org","id":"$g7r65_rOMf5imxORoHPLleyd7zuvwl9sBP0hQ3zQGgw"},
{"content":{"body":"Wait, I had a conversation with guybedford where he managed to convince me that a ModuleSource should have a referrer","msgtype":"m.text"},"ts":1658185057905,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$UtF7NHLnKPO36OquinaP_-NTNBiC6glLqdUiA8gPCYg"},
{"content":{"body":"This is all consistent though ","format":"org.matrix.custom.html","formatted_body":"This is all consistent though","msgtype":"m.text"},"ts":1658185072691,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$YvPOsS8X4n8JFXg8t6kkewWDQTBHy8r6wI6on1fdXWs"},
{"content":{"body":"Yeah, we’re likely to have conversations like that until we either get tired or separate all three layers.","msgtype":"m.text","org.matrix.msc1767.text":"Yeah, we’re likely to have conversations like that until we either get tired or separate all three layers."},"ts":1658185104936,"senderName":"Kris Kowal","senderId":"@kriskowal:matrix.org","id":"$YxEzC6NSK_-2teuhbpgqstvYMbIFRHeLBEcQSYFc5RU"},
{"content":{"body":"That being: {text, bindings}, {{text, bindings}, referrer}, {{{text, bindings}, referrer}, memo, meta, state, &c}","msgtype":"m.text","org.matrix.msc1767.text":"That being: {text, bindings}, {{text, bindings}, referrer}, {{{text, bindings}, referrer}, memo, meta, state, &c}"},"ts":1658185166044,"senderName":"Kris Kowal","senderId":"@kriskowal:matrix.org","id":"$IeUPbwPhSZorZ_vNRifMib4xgtZ6LuELqASW1JU6hAU"},
{"content":{"body":"The thing is, Module (and maybe also ModuleSource) also may need to close over the import map","msgtype":"m.text"},"ts":1658185166472,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$8b0U84Tyr-fRpMlT03aC1xqWAicd0bdInwyi205cbW8"},
{"content":{"body":"Ah yes Nicolo and I have been talking about where memoization happens… also confusing","msgtype":"m.text"},"ts":1658185200442,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$03eGX52tFApNIDqEdTrze4tW69XBgfcYDdXWuwmc5sM"},
{"content":{"body":"I think there are coherent stances on module blocks where `Module` instances have [[HostData]] that leads back to the host’s module map, as would be necessary to mitigate certain configuration errors, but also coherent stances where it does not.","format":"org.matrix.custom.html","formatted_body":"I think there are coherent stances on module blocks where <code>Module</code> instances have [[HostData]] that leads back to the host’s module map, as would be necessary to mitigate certain configuration errors, but also coherent stances where it does not.","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"I think there are coherent stances on module blocks where `Module` instances have [[HostData]] that leads back to the host’s module map, as would be necessary to mitigate certain configuration errors, but also coherent stances where it does not.","mimetype":"text/plain"},{"body":"I think there are coherent stances on module blocks where <code>Module</code> instances have [[HostData]] that leads back to the host’s module map, as would be necessary to mitigate certain configuration errors, but also coherent stances where it does not.","mimetype":"text/html"}]},"ts":1658185238597,"senderName":"Kris Kowal","senderId":"@kriskowal:matrix.org","id":"$nvhOU4a6itAazoq03QFrn_DVCJbqqw8ngu7NeVAzdI8"},
{"content":{"body":"But, `ModuleSource` should just close over source. I’m open to adding layers and moving state around, but it would be not good to have state with the source.","format":"org.matrix.custom.html","formatted_body":"But, <code>ModuleSource</code> should just close over source. I’m open to adding layers and moving state around, but it would be not good to have state with the source.","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"But, `ModuleSource` should just close over source. I’m open to adding layers and moving state around, but it would be not good to have state with the source.","mimetype":"text/plain"},{"body":"But, <code>ModuleSource</code> should just close over source. I’m open to adding layers and moving state around, but it would be not good to have state with the source.","mimetype":"text/html"}]},"ts":1658185284134,"senderName":"Kris Kowal","senderId":"@kriskowal:matrix.org","id":"$v6mWVPVZkZrvAZUSzJwh5NXZ_Rq0IZcXJRthcQlrgJs"},
{"content":{"body":"My intuition is that module blocks and module reflection probably give you the same thing. They both need a referrer, and module reflection needs multiple instantiation (which is optional for module blocks IMO)","msgtype":"m.text"},"ts":1658185315207,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$5NHmOIT8Qlk3sOS1TUG2xm23MhuKJAULBi5xy5OFvN8"},
{"content":{"body":"Interesting.","msgtype":"m.text","org.matrix.msc1767.text":"Interesting."},"ts":1658185355463,"senderName":"Kris Kowal","senderId":"@kriskowal:matrix.org","id":"$BgvwCvZEZ0PDtPfy6zqrPz9lcEmYhfOZjxKZGXGfkSA"},
{"content":{"body":"> <@kriskowal:matrix.org> But, `ModuleSource` should just close over source. I’m open to adding layers and moving state around, but it would be not good to have state with the source.\n\nOK, then, we probably need a third class which is ModuleSource + referrer, which can be instantiated multiple times, and module reflection and blocks should be this","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!RkpmGMjJtqLKXzByOT%3Amatrix.org/%24v6mWVPVZkZrvAZUSzJwh5NXZ_Rq0IZcXJRthcQlrgJs\">In reply to</a> <a href=\"https://matrix.to/#/@kriskowal:matrix.org\">@kriskowal:matrix.org</a><br>But, <code>ModuleSource</code> should just close over source. I’m open to adding layers and moving state around, but it would be not good to have state with the source.</blockquote></mx-reply>OK, then, we probably need a third class which is ModuleSource + referrer, which can be instantiated multiple times, and module reflection and blocks should be this","m.relates_to":{"m.in_reply_to":{"event_id":"$v6mWVPVZkZrvAZUSzJwh5NXZ_Rq0IZcXJRthcQlrgJs"}},"msgtype":"m.text"},"ts":1658185358552,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$yR7j0PdBwLjwgxu8t8N6W04daNJWDSj2f0ZCMoVS3Po"},
{"content":{"body":"`WebAssembly.Module` definitely maps to `ModuleSource`. Those do not have referrers.","format":"org.matrix.custom.html","formatted_body":"<code>WebAssembly.Module</code> definitely maps to <code>ModuleSource</code>. Those do not have referrers.","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"`WebAssembly.Module` definitely maps to `ModuleSource`. Those do not have referrers.","mimetype":"text/plain"},{"body":"<code>WebAssembly.Module</code> definitely maps to <code>ModuleSource</code>. Those do not have referrers.","mimetype":"text/html"}]},"ts":1658185377146,"senderName":"Kris Kowal","senderId":"@kriskowal:matrix.org","id":"$6KKGj0WeI8DhJ474uKY8oyqicJEmSngcgU5LXcgxrwg"},
{"content":{"body":"Guy’s proposal definitely returns something with a referrer for Wasm","msgtype":"m.text"},"ts":1658185403452,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$8I_4crI_NFudFpDL-iCFTcoUYIU16K6_5xMiJr2aeBw"},
{"content":{"body":"Otherwise csp doesn’t work","msgtype":"m.text"},"ts":1658185411542,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$4SOKyissgDl1awD0tJveQvj5BrYgnNJRK1SBZbv5n1A"},
{"content":{"body":"But I agree there might be an intermediate, or that `Module` in its initial state can serve as the intermediate.","format":"org.matrix.custom.html","formatted_body":"But I agree there might be an intermediate, or that <code>Module</code> in its initial state can serve as the intermediate.","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"But I agree there might be an intermediate, or that `Module` in its initial state can serve as the intermediate.","mimetype":"text/plain"},{"body":"But I agree there might be an intermediate, or that <code>Module</code> in its initial state can serve as the intermediate.","mimetype":"text/html"}]},"ts":1658185413696,"senderName":"Kris Kowal","senderId":"@kriskowal:matrix.org","id":"$bi0hSM1b8BVIKAL64zs7PI56Oe4HjaFMMWVArsEribg"},
{"content":{"body":"Guy’s position is consistent with annotating module sources with origin information in their host data.","msgtype":"m.text","org.matrix.msc1767.text":"Guy’s position is consistent with annotating module sources with origin information in their host data."},"ts":1658185439190,"senderName":"Kris Kowal","senderId":"@kriskowal:matrix.org","id":"$MWAEB9WuwMhac0H2l5IratSc6XUSiNFJwx64CMvXeu8"},
{"content":{"body":"I think we could say, WebAssembly.Module has a new internal slot, which might be empty, which is the referrer","msgtype":"m.text"},"ts":1658185450019,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$Ha1Sa93aaJffR1hPlr3KI8UnADcdDGZJUpYcrMWarKI"},
{"content":{"body":"And we can apply this to ModuleSource generally, or make it a separate class if needed","msgtype":"m.text"},"ts":1658185474906,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$V5l9hppbOF2sdYq-DqldFJvlyvOzQZSa5D-fnToBNzk"},
{"content":{"body":"Doe’s ModuleSource have host data?","msgtype":"m.text"},"ts":1658185497569,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$ckKpxMRN3jOvrtKOR_07ephZYaTO5Lqs6VyGAd4XOdA"}
]