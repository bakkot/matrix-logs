[
{"content":{"body":"are wasm opaque objects exposed directly to JS code? My impression was that there is currently glue code to wrap those. Now of course we could ask the question for when wasm objects are no longer opaque and gain prototypes, and possibly own props. My concern is that I don't want to introduce yet another \"kind\" of Error that all error aware code out there needs to recognize (not just debuggers). We have Error instances, and I guess we're also getting objects extended with `Error.captureStackTrace`.","format":"org.matrix.custom.html","formatted_body":"are wasm opaque objects exposed directly to JS code? My impression was that there is currently glue code to wrap those. Now of course we could ask the question for when wasm objects are no longer opaque and gain prototypes, and possibly own props. My concern is that I don't want to introduce yet another \"kind\" of Error that all error aware code out there needs to recognize (not just debuggers). We have Error instances, and I guess we're also getting objects extended with <code>Error.captureStackTrace</code>.","m.mentions":{},"msgtype":"m.text"},"ts":1762308052180,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$eHAcgCX4z3pEEqgTkYJMuPjljsaMh35VFZzZZvQUxdM"},
{"content":{"body":"especially now that we have `Error.isError`, I think it'd be a mistake to introduce something that isn't an error but behaves like one. It's already unfortunate enough we have to standardize captureStackTrace","format":"org.matrix.custom.html","formatted_body":"especially now that we have <code>Error.isError</code>, I think it'd be a mistake to introduce something that isn't an error but behaves like one. It's already unfortunate enough we have to standardize captureStackTrace","m.mentions":{},"msgtype":"m.text"},"ts":1762308200600,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$ISG8j4Blj8i6LFZI535GOpTWAVsB-_45Wxgx7NOrfbM"},
{"content":{"body":"Mathieu Hofman: the wasm custom descriptors proposal turns the opaque objects directly into objects with descriptors allowing getters and setters etc.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@mhofman:matrix.org\">Mathieu Hofman</a>: the wasm custom descriptors proposal turns the opaque objects directly into objects with descriptors allowing getters and setters etc.","m.mentions":{"user_ids":["@mhofman:matrix.org"]},"msgtype":"m.text"},"ts":1762309141275,"senderName":"guybedford","senderId":"@guybedford:matrix.org","id":"$wLz1XEu6xoxkyBWtBvnr5F4I7xuJDp8mivpe-bmuAgA"},
{"content":{"body":"they thus effectively become resource types, backed by a wasm gc managed struct or array","m.mentions":{},"msgtype":"m.text"},"ts":1762309174448,"senderName":"guybedford","senderId":"@guybedford:matrix.org","id":"$4naQcsVIRl2GEDqjDuCIRVT-P6HnVWvdzPsNvRezSY4"},
{"content":{"body":"I'd have thought the solution though would be to call out to `wrapErr(scalaErr) => Object.assign(new Error(), { gcError: scalaErr })` through to JS when there is an error to have a JS error type wrapping a scala error type instead of the converse, but I haven't thought about it deeply enough to have a strong opinion","format":"org.matrix.custom.html","formatted_body":"I'd have thought the solution though would be to call out to <code>wrapErr(scalaErr) =&gt; Object.assign(new Error(), { gcError: scalaErr })</code> through to JS when there is an error to have a JS error type wrapping a scala error type instead of the converse, but I haven't thought about it deeply enough to have a strong opinion","m.mentions":{},"msgtype":"m.text"},"ts":1762309395327,"senderName":"guybedford","senderId":"@guybedford:matrix.org","id":"$8nAkLlbd_kc5TAI7jBRu1OdF8cXSM8TCxv48J4x38lg"},
{"content":{"body":"Right, even with custom descriptors support, this is effectively purpose built glue code creating JS objects to expose wasm things. In that case, I would find it natural to create a `new Error()` and define on it a `cause: wasmThrowable` property.","format":"org.matrix.custom.html","formatted_body":"Right, even with custom descriptors support, this is effectively purpose built glue code creating JS objects to expose wasm things. In that case, I would find it natural to create a <code>new Error()</code> and define on it a <code>cause: wasmThrowable</code> property.","m.mentions":{},"msgtype":"m.text"},"ts":1762309942332,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$FRmDVrc8DMjO8H_GPiV51FrsMJa26F_S4bEMzPYYgYo"}
]