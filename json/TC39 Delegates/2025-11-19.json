[
{"content":{"body":"And we begin day 2!","m.mentions":{},"msgtype":"m.text"},"ts":1763514006885,"senderName":"Rob Palmer","senderId":"@robpalme:matrix.org","id":"$fOZD1LJKu4JnTbm2NHiiwcSTxFMIsndW7oHQe8w-3KM"},
{"content":{"body":"I think array iterators not closing when you call `return` was a mistake","format":"org.matrix.custom.html","formatted_body":"I think array iterators not closing when you call <code data-md=\"`\">return</code> was a mistake","m.mentions":{},"msgtype":"m.text"},"ts":1763514665305,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$3ZAUHTx0PdrRW_-QZEYsp4lvxyX0fTwZqlgiELJ4Lj8"},
{"content":{"body":"i think `return` was a mistake","format":"org.matrix.custom.html","formatted_body":"i think <code>return</code> was a mistake","m.mentions":{},"msgtype":"m.text"},"ts":1763514732280,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$SGTZZEATOkeP9sxHV9-ypt8DpAA6kg2qABVRfvwnaFA"},
{"content":{"body":"the generator protocol maybe, but return is fine","m.mentions":{},"msgtype":"m.text"},"ts":1763514785488,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$Niid0DnVtoagyam1N0ec4_lue9WgU7gcDfoQXLzl3qI"},
{"content":{"body":"separately, i'm not actually sure when you'd want to close the database connection - in most apps i've worked in, the database stays open and the connection is shared/pooled, and times out eventually","m.mentions":{},"msgtype":"m.text"},"ts":1763514990970,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$C2zvNsns439-sFn2hb89uU8WUyMGIHS16geqnDn_sh0"},
{"content":{"body":"Michael Ficarra: Sorry, accidentally deleted your topic while clearing the +1s","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@michaelficarra:matrix.org\">Michael Ficarra</a>: Sorry, accidentally deleted your topic while clearing the +1s","m.mentions":{"user_ids":["@michaelficarra:matrix.org"]},"msgtype":"m.text"},"ts":1763516000602,"senderName":"dminor","senderId":"@dminor:mozilla.org","id":"$vOml9idaOkpL9jLRD9sy6AAi0w5uYVL-rTvHtorNjeE"},
{"content":{"body":"these 1 or 2 or 2.7 presentations are a pretty amusing modern TC39 phenomenon","m.mentions":{},"msgtype":"m.text"},"ts":1763516010752,"senderName":"rkirsling","senderId":"@rkirsling:matrix.org","id":"$LuyLbTGBCA7ohSh1wR7nvNQg4Wvw9ct1jBcjJ4rVkm8"},
{"content":{"body":"that and conditional consensus ","m.mentions":{},"msgtype":"m.text"},"ts":1763516103850,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$FKPHzaMoaTZ_gRIsxCx5PO9-93mINX_HkdN4Pi2jLkc"},
{"content":{"body":"its nice we have ways to speed things up though","m.mentions":{},"msgtype":"m.text"},"ts":1763516117941,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$XOMc3_Yaa3HKK1C9fvcbhd6jD48ZpsNZ_lrf-zTNpc8"},
{"content":{"body":"conditional consensus is good efficiency","m.mentions":{},"msgtype":"m.text"},"ts":1763516128462,"senderName":"rkirsling","senderId":"@rkirsling:matrix.org","id":"$7gqJOw_iGNDGBYkl0v_eTxOjnKtf3Q1I1Hi5mHvGo9A"},
{"content":{"body":"@bakkot:matrix.org Can you link your async iterator slides when youâ€™re done","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@bakkot:matrix.org\">@bakkot</a> Can you link your async iterator slides when youâ€™re done","m.mentions":{"user_ids":["@bakkot:matrix.org"]},"msgtype":"m.text"},"ts":1763516225789,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$PTHMEn-3a9EhdIeFrtM9qCyWScZ5Un55cENAHXFVufQ"},
{"content":{"body":"Dumb question: Where is  CreateAsyncIteratorFromClosure defined? (re: async interator helpers-- it links to the main spec where I can't find it) ","m.mentions":{},"msgtype":"m.text"},"ts":1763516308996,"senderName":"mgaudet|travelling","senderId":"@mgaudet:mozilla.org","id":"$udZJLV_TmyPVGGBMMSTgWbfIvEo5B3mNLF3FdmODXno"},
{"content":{"body":"@mgaudet:mozilla.org https://github.com/tc39/ecma262/pull/3628","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@mgaudet:mozilla.org\">@mgaudet|travelling</a> https://github.com/tc39/ecma262/pull/3628","m.mentions":{"user_ids":["@mgaudet:mozilla.org"]},"msgtype":"m.text"},"ts":1763516396646,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$pOBonSluO5Qt2isPn9ASsyUqp-EXCVj5MoG_nCLaW6M"},
{"content":{"body":"thanks :) ","m.mentions":{},"msgtype":"m.text"},"ts":1763516447896,"senderName":"mgaudet|travelling","senderId":"@mgaudet:mozilla.org","id":"$LLtcgKakN17jGfk3kzgbrWJIZHSmmrRdWye7AcIs4Is"},
{"content":{"body":"What happens if you get an infinite loop inside a spec function? Is there any defined behavior?","m.mentions":{},"msgtype":"m.text"},"ts":1763516655644,"senderName":"waldemar","senderId":"@waldemarh:matrix.org","id":"$hAH06GJihdhHzbPtSMgXXKFJDCozV9mll8sIHxzEFgA"},
{"content":{"body":"I guess the algorithm would just never terminate until the host process does","m.mentions":{},"msgtype":"m.text"},"ts":1763516738058,"senderName":"Richard Gibson","senderId":"@gibson042:matrix.org","id":"$hae96Ios0p0oebIkSxiFKQX7nDdzFT6DP6Sg30JQimk"},
{"content":{"body":"i don't think any spec function current or proposed lets you get into a true infinite loop, they all dispatch on user code","m.mentions":{},"msgtype":"m.text"},"ts":1763516782979,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$BocQXu0KzYqkMtdaNSF-jxjn9eTgdgBaSahspt4ZQQs"},
{"content":{"body":"* i don't think any spec function current or proposed lets you get into a true infinite loop, they all predicate on user code","m.mentions":{},"m.new_content":{"body":"i don't think any spec function current or proposed lets you get into a true infinite loop, they all predicate on user code","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$BocQXu0KzYqkMtdaNSF-jxjn9eTgdgBaSahspt4ZQQs","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763516815166,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$IgmLYRwRbsmkFicdTJaVMzbzUVezDDN76jpA4fEQeA4"},
{"content":{"body":"sorry the async iterators item was so incoherent, I'd meant to do prep this weekend but I was/am down with some sort of horrible virus and am not able to think clearly enough for reasoning about concurrency code","m.mentions":{},"msgtype":"m.text"},"ts":1763517090069,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$UFMl2NzPtd3bq3msBYNCuXX0RmvGZswXuErlsv9x6DM"},
{"content":{"body":"No special casing for infinite loops; the spec technically just says you have to keep doing it forever","m.mentions":{"user_ids":["@waldemarh:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$hAH06GJihdhHzbPtSMgXXKFJDCozV9mll8sIHxzEFgA"}},"msgtype":"m.text"},"ts":1763517113723,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$zihLQpCoSesg3uu-rwzrVk0r2ikXiVjRkY5f--WwXQ8"},
{"content":{"body":"this is part of its general refusal to admit any resource constraints","m.mentions":{},"msgtype":"m.text"},"ts":1763517123160,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$lgnbpz_0NBD0QVEX_YDEPb62ic6-IqXHTohjMbR0B_g"},
{"content":{"body":"maybe, but not if we introduce a built-in infinite iterator","m.mentions":{"user_ids":["@devsnek:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$BocQXu0KzYqkMtdaNSF-jxjn9eTgdgBaSahspt4ZQQs"}},"msgtype":"m.text"},"ts":1763517127014,"senderName":"Richard Gibson","senderId":"@gibson042:matrix.org","id":"$CCQ_u-bR11Myt_RvdIkDox8ujfm791BWmGeYN4XUZrI"},
{"content":{"body":"forgive me for my naiivety (or for the lack of knowing the proper spelling), but composites are tought to be immutable, aren't they?","m.mentions":{},"msgtype":"m.text"},"ts":1763517799015,"senderName":"Christian Ulbrich","senderId":"@christianulbrich:matrix.org","id":"$5F997xphaCZWuozfb16x2xJIdFWcTxH-Bsnr5peZarA"},
{"content":{"body":"Yes","m.mentions":{},"msgtype":"m.text"},"ts":1763517828170,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$x6NnQf4bArpayG9rcD7unkY9nPftbCj85mDJIj8rdoY"},
{"content":{"body":"Shallowly ","format":"org.matrix.custom.html","formatted_body":"Shallowly","m.mentions":{},"msgtype":"m.text"},"ts":1763517830957,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$PzcZ0oLVHkFLLANy6XY8igX8tKsrFbbxRF0W13Qb9DI"},
{"content":{"body":"Shallowly?","m.mentions":{},"msgtype":"m.text"},"ts":1763517849848,"senderName":"Christian Ulbrich","senderId":"@christianulbrich:matrix.org","id":"$zU2vbdTQ82T5B7kV38FAeYzoSxifRHWMyf-ZZ_zENmc"},
{"content":{"body":"They can contain mutable stuff","m.mentions":{},"msgtype":"m.text"},"ts":1763517862673,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$lk5QSk6HlUOPSM2Yoy7QdHMCh77qxjbcepePYWIdHgc"},
{"content":{"body":"is implementation concern the only factor for interned vs unique? or are there other constraints?","m.mentions":{},"msgtype":"m.text"},"ts":1763517865776,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$mylVYaTPogAeILW8GffW8aWWZKRNAa3-nft3dRRJ2bw"},
{"content":{"body":"c1.wallet.amount is not immutable?","m.mentions":{},"msgtype":"m.text"},"ts":1763517867069,"senderName":"Christian Ulbrich","senderId":"@christianulbrich:matrix.org","id":"$df__NAPV0z7c3K2pEVx98kDApFQ6-IHTBt2xO9Tjnoc"},
{"content":{"body":"correct","m.mentions":{},"msgtype":"m.text"},"ts":1763517873249,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$p3iGMqqz7AxmItFx7onTVmkh2Z-jEDasHOnM9LBhNd4"},
{"content":{"body":"* `c1.wallet.amount` is not immutable?","format":"org.matrix.custom.html","formatted_body":"* <code>c1.wallet.amount</code> is not immutable?","m.mentions":{},"m.new_content":{"body":"`c1.wallet.amount` is not immutable?","format":"org.matrix.custom.html","formatted_body":"<code>c1.wallet.amount</code> is not immutable?","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$df__NAPV0z7c3K2pEVx98kDApFQ6-IHTBt2xO9Tjnoc","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763517876331,"senderName":"Christian Ulbrich","senderId":"@christianulbrich:matrix.org","id":"$FAGyT1XNTrkfn8I-sVh8VHwqEKUV3qU6DJtSs-gL_cs"},
{"content":{"body":"You can make wallet a composite too ","format":"org.matrix.custom.html","formatted_body":"You can make wallet a composite too","m.mentions":{},"msgtype":"m.text"},"ts":1763517891889,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$cNFKIOHbezhw5HxRm_mdLy4Hk3Y9cS8Je8Z2J1GmTag"},
{"content":{"body":"can but shouldn't, wallets have identity","m.mentions":{},"msgtype":"m.text"},"ts":1763517927023,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$TTtwySIUn5618oU4Jg6xTT8m2iHh3mp2y5swWSR67yI"},
{"content":{"body":"my wallet is not your wallet just because we both have no money","m.mentions":{},"msgtype":"m.text"},"ts":1763517936503,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$omsGQ1XDJ86yGlyCJqNQFhLarrlnceaQ51vsGjf21S4"},
{"content":{"body":"@keith_miller:matrix.org Is spec convienence causing real slowdowns for TAs?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@keith_miller:matrix.org\">@keith_miller</a> Is spec convienence causing real slowdowns for TAs?","m.mentions":{"user_ids":["@keith_miller:matrix.org"]},"msgtype":"m.text"},"ts":1763517959863,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$3YxkOspYI4s05AqHKRsHd8STnFsuqH_Q6HK7qKZWCfE"},
{"content":{"body":"so `let c1 = Composite({wallet: amount: 20}); \nlet c2 = Composite({wallet: amount: 20});\nc1 === c2; // true\nc1.wallet.amount+=20;\nc1 === c2 // ??\n`","format":"org.matrix.custom.html","formatted_body":"so <code>let c1 = Composite({wallet: amount: 20});  let c2 = Composite({wallet: amount: 20}); c1 === c2; // true c1.wallet.amount+=20; c1 === c2 // ?? </code>","m.mentions":{},"msgtype":"m.text"},"ts":1763518022320,"senderName":"Christian Ulbrich","senderId":"@christianulbrich:matrix.org","id":"$du-oFGP_4bk38VGFq_lm3VJ34LkjUYXee9jOcmhwBEo"},
{"content":{"body":"i would hope that composites are never mutable","m.mentions":{},"msgtype":"m.text"},"ts":1763518045289,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$P-nXZiwzRMpzoM1I-CQ12aUpimHYgyMK3Bm2Ldu1qZI"},
{"content":{"body":"in either case","m.mentions":{},"msgtype":"m.text"},"ts":1763518048772,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$DSMMmh9UaG4Fiu1-fMlj7BXLBTnRfmmwecInUqThxNM"},
{"content":{"body":"No, those two wallets are different objects, so the composites are different","m.mentions":{"user_ids":["@christianulbrich:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$du-oFGP_4bk38VGFq_lm3VJ34LkjUYXee9jOcmhwBEo"}},"msgtype":"m.text"},"ts":1763518053260,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$8-7SpVt5iosZouASmmhA2lq74VNGVkhkax0y51J89uI"},
{"content":{"body":"You need nested composites, right?","format":"org.matrix.custom.html","formatted_body":"You need nested composites, right?","m.mentions":{"user_ids":["@christianulbrich:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$du-oFGP_4bk38VGFq_lm3VJ34LkjUYXee9jOcmhwBEo"}},"msgtype":"m.text"},"ts":1763518056007,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$z8gDiuWF9XKHR1urEbwIITp96zkmg2TwpOwM0_ytb04"},
{"content":{"body":"* so ```\nlet c1 = Composite({wallet: amount: 20});  \nlet c2 = Composite({wallet: amount: 20}); \nc1 === c2; // true \nc1.wallet.amount+=20;\n c1 === c2 // ?? \n```","format":"org.matrix.custom.html","formatted_body":"* <p>so ```<br>let c1 = Composite({wallet: amount: 20});<br>\nlet c2 = Composite({wallet: amount: 20});<br>c1 === c2; // true<br>c1.wallet.amount+=20;<br>c1 === c2 // ??</p>\n<pre><code></code></pre>\n","m.mentions":{},"m.new_content":{"body":"so ```\nlet c1 = Composite({wallet: amount: 20});  \nlet c2 = Composite({wallet: amount: 20}); \nc1 === c2; // true \nc1.wallet.amount+=20;\n c1 === c2 // ?? \n```","format":"org.matrix.custom.html","formatted_body":"<p>so ```<br>let c1 = Composite({wallet: amount: 20});<br>\nlet c2 = Composite({wallet: amount: 20});<br>c1 === c2; // true<br>c1.wallet.amount+=20;<br>c1 === c2 // ??</p>\n<pre><code></code></pre>\n","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$du-oFGP_4bk38VGFq_lm3VJ34LkjUYXee9jOcmhwBEo","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763518058167,"senderName":"Christian Ulbrich","senderId":"@christianulbrich:matrix.org","id":"$GN8k2rMi5iay7OLw6edNJqFoQ3Myir7tJpfs5HFrgAE"},
{"content":{"body":"But these would be the same:\n```\nlet wallet = Composite({ amount: 20 });\nlet c1 = Composite({ wallet });\nlet c2 = Composite({ wallet });\n```","format":"org.matrix.custom.html","formatted_body":"<p>But these would be the same:</p>\n<pre><code>let wallet = Composite({ amount: 20 });\nlet c1 = Composite({ wallet });\nlet c2 = Composite({ wallet });\n</code></pre>\n","m.mentions":{},"msgtype":"m.text"},"ts":1763518079060,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$ExSycJbluiZrUd8Z5c4NNTyPfJiY-TdKsB7BMDTuQ3U"},
{"content":{"body":"* But these would be the same:\n\n```\nlet wallet =({ amount: 20 });\nlet c1 = Composite({ wallet });\nlet c2 = Composite({ wallet });\n```","format":"org.matrix.custom.html","formatted_body":"* <p>But these would be the same:</p>\n<pre><code>let wallet =({ amount: 20 });\nlet c1 = Composite({ wallet });\nlet c2 = Composite({ wallet });\n</code></pre>\n","m.mentions":{},"m.new_content":{"body":"But these would be the same:\n\n```\nlet wallet =({ amount: 20 });\nlet c1 = Composite({ wallet });\nlet c2 = Composite({ wallet });\n```","format":"org.matrix.custom.html","formatted_body":"<p>But these would be the same:</p>\n<pre><code>let wallet =({ amount: 20 });\nlet c1 = Composite({ wallet });\nlet c2 = Composite({ wallet });\n</code></pre>\n","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$ExSycJbluiZrUd8Z5c4NNTyPfJiY-TdKsB7BMDTuQ3U","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763518085991,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$okQvimsF8Jn43ST7qY_9jwnEyK_Fd1nOhcKXW7I5xgw"},
{"content":{"body":"The alternative is `wallet = { amount: 20 }; c1 = Composite({ `â€¦ Nicolo beat me to it.","format":"org.matrix.custom.html","formatted_body":"The alternative is <code data-md=\"`\">wallet = { amount: 20 }; c1 = Composite({ </code>â€¦ Nicolo beat me to it.","m.mentions":{},"msgtype":"m.text"},"ts":1763518089414,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$mIdIhdgavwysFkhBDzfVjUzp1CZYujFY8CuQ3F60Gi0"},
{"content":{"body":"* But these would be the same:\n\n```\nlet wallet = { amount: 20 };\nlet c1 = Composite({ wallet });\nlet c2 = Composite({ wallet });\n```","format":"org.matrix.custom.html","formatted_body":"* <p>But these would be the same:</p>\n<pre><code>let wallet = { amount: 20 };\nlet c1 = Composite({ wallet });\nlet c2 = Composite({ wallet });\n</code></pre>\n","m.mentions":{},"m.new_content":{"body":"But these would be the same:\n\n```\nlet wallet = { amount: 20 };\nlet c1 = Composite({ wallet });\nlet c2 = Composite({ wallet });\n```","format":"org.matrix.custom.html","formatted_body":"<p>But these would be the same:</p>\n<pre><code>let wallet = { amount: 20 };\nlet c1 = Composite({ wallet });\nlet c2 = Composite({ wallet });\n</code></pre>\n","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$ExSycJbluiZrUd8Z5c4NNTyPfJiY-TdKsB7BMDTuQ3U","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763518103104,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$nzYoZePEez3Dv4RVEJt9E8k27AWqcA2iVL5777A6bog"},
{"content":{"body":"Yeah, 100%","m.mentions":{"user_ids":["@jridgewell:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$3YxkOspYI4s05AqHKRsHd8STnFsuqH_Q6HK7qKZWCfE"}},"msgtype":"m.text"},"ts":1763518331659,"senderName":"keith_miller","senderId":"@keith_miller:matrix.org","id":"$ZSa1hQ6NLX-uk3F0RjE7sHJYMrzqm_VpEeMPhWSIAtM"},
{"content":{"body":"Mathieu Hofman: We also have current _custom Iterability_ with `Symbol.iterator`.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@mhofman:matrix.org\">Mathieu Hofman</a>: We also have current <em>custom Iterability</em> with <code>Symbol.iterator</code>.","m.mentions":{"user_ids":["@mhofman:matrix.org"]},"msgtype":"m.text"},"ts":1763518342238,"senderName":"Christian Ulbrich","senderId":"@christianulbrich:matrix.org","id":"$bBZaqe9eDGtuEwvDzY-VwD7STaARDVzR6gran7A-Xls"},
{"content":{"body":"please do not look at the current spec, it means nothing","m.mentions":{"user_ids":["@mgaudet:mozilla.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$udZJLV_TmyPVGGBMMSTgWbfIvEo5B3mNLF3FdmODXno"}},"msgtype":"m.text"},"ts":1763518342939,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$4u5pE0EN5n9CPllYst5JnpNRxNaY5Up6wV9iI86qQnQ"},
{"content":{"body":"I should remove it","m.mentions":{},"msgtype":"m.text"},"ts":1763518344510,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$Yb5OV5oXbLvqM4_GwjyI4xx5UiyDMYDOYEbkcmJj5Co"},
{"content":{"body":"@olivf.o1o.ch:immer.chat Does V8 have this same problem?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@olivf.o1o.ch:immer.chat\">@Olivier FlÃ¼ckiger</a> Does V8 have this same problem?","m.mentions":{"user_ids":["@olivf.o1o.ch:immer.chat","@keith_miller:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$ZSa1hQ6NLX-uk3F0RjE7sHJYMrzqm_VpEeMPhWSIAtM"}},"msgtype":"m.text"},"ts":1763518358595,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$qM--Vpjs4tBPzZZphJmtrqD6D6lBcdpHePBO8z3ybao"},
{"content":{"body":"In particular because you have to do n shape checks for each of the different views","m.mentions":{},"msgtype":"m.text"},"ts":1763518358871,"senderName":"keith_miller","senderId":"@keith_miller:matrix.org","id":"$s1BT1Eb4mMmuhtuJ1MtNvUpiq9nVIIBAumkckyEwnIU"},
{"content":{"body":"Should we be splitting the methods onto the sepcific TA subtype classes?","m.mentions":{},"msgtype":"m.text"},"ts":1763518379092,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$AyKDaSbVKfZllZPmnSJKIGWeiJGcdl4IZCQE1amg61E"},
{"content":{"body":"That is ok-ish. The place it shows up in syntax (array spread) was a mistake","m.mentions":{"user_ids":["@christianulbrich:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$bBZaqe9eDGtuEwvDzY-VwD7STaARDVzR6gran7A-Xls"}},"msgtype":"m.text"},"ts":1763518381315,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$cCe1TsRkKZ7y2GgUpRt2u7fNQjEaOZLHlDqaSHhKlL0"},
{"content":{"body":"Sometimes it will get inlined enough that we can prove only one shape shows up but there's many examples I've seen where that doesn't happen","m.mentions":{},"m.relates_to":{"m.in_reply_to":{"event_id":"$s1BT1Eb4mMmuhtuJ1MtNvUpiq9nVIIBAumkckyEwnIU"}},"msgtype":"m.text"},"ts":1763518424628,"senderName":"keith_miller","senderId":"@keith_miller:matrix.org","id":"$0J3eG09MvUwQsaEk8vpla2_Tpj9QHbH7S2EsDzmGVaE"},
{"content":{"body":"my memory of v8 is that it generally does a switch over different object kinds. i guess that could be compiled to a bunch of if/else branches but hopefully it does better than ","m.mentions":{},"msgtype":"m.text"},"ts":1763518474186,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$N6IVCSiVJClL-_R1KP4pCE2KufYyeFpT6F1GNdD3Cds"},
{"content":{"body":"* my memory of v8 is that it generally does a switch over different object kinds. i guess that could be compiled to a bunch of if/else branches but hopefully it does better than that","m.mentions":{},"m.new_content":{"body":"my memory of v8 is that it generally does a switch over different object kinds. i guess that could be compiled to a bunch of if/else branches but hopefully it does better than that","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$N6IVCSiVJClL-_R1KP4pCE2KufYyeFpT6F1GNdD3Cds","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763518479613,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$WA77a0YnyyCtqix0h6eGOknm60KembK2eQ8qdkRxWF8"},
{"content":{"body":"which is certainly still some overhead, but its not a function of the number of things you're switching over","m.mentions":{},"msgtype":"m.text"},"ts":1763518512352,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$pXbNctBy7s61ZzpKwcj6az9-WcoEQvkpulwnMw1NL_o"},
{"content":{"body":"Mathieu Hofman: `Array.prototype[Symbol.iterator] = function* () { yield 2; yield 3; }`","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@mhofman:matrix.org\">Mathieu Hofman</a>: <code>Array.prototype[Symbol.iterator] = function* () { yield 2; yield 3; }</code>","m.mentions":{"user_ids":["@mhofman:matrix.org"]},"msgtype":"m.text"},"ts":1763518537047,"senderName":"Christian Ulbrich","senderId":"@christianulbrich:matrix.org","id":"$2JgE4OJuTNlMH8H_KGK9ouaPbV58PSBVgN3hFykeCws"},
{"content":{"body":"The problem is that you also need to make the index access polymorphic","m.mentions":{},"msgtype":"m.text"},"ts":1763518545211,"senderName":"keith_miller","senderId":"@keith_miller:matrix.org","id":"$opafoHr-4MIgEBAWD0jlCF6-ovBpW8I4BmZuKwnb6OE"},
{"content":{"body":"So it's not just a check you're in bounds and load","m.mentions":{},"msgtype":"m.text"},"ts":1763518558442,"senderName":"keith_miller","senderId":"@keith_miller:matrix.org","id":"$U0p-ksfSrGd6wlHUwZGcPjWD1ZML6FIskocDSFFWC1E"},
{"content":{"body":"It's a switch over the element size then pick the right load for the active size","m.mentions":{},"msgtype":"m.text"},"ts":1763518573541,"senderName":"keith_miller","senderId":"@keith_miller:matrix.org","id":"$qkF9UZI_tFyscbh3zfaVVA4M5wya4kXT-np5fU2mxuM"},
{"content":{"body":"yeah it remains polymorphic until it can be found to be exactly 1 kind","m.mentions":{},"msgtype":"m.text"},"ts":1763518584872,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$j7G2YVstMP74YgxfLuAU0jHsnYfhsMp9_F_3Enf3Jm4"},
{"content":{"body":"Right but that wouldn't be a problem if each of the views had their own copy of the various methods","m.mentions":{},"msgtype":"m.text"},"ts":1763518609387,"senderName":"keith_miller","senderId":"@keith_miller:matrix.org","id":"$zXuo0z56dQzovS61pLMBUmjcUB3-VXVbsyUx-WaWQbo"},
{"content":{"body":"Mathieu Hofman: What I am trying to say, and I am leaning towards some, what I think Ron said, custom equality is not a bad thing per sÃ¨. We already have so many things in the language, that are powerful.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@mhofman:matrix.org\">Mathieu Hofman</a>: What I am trying to say, and I am leaning towards some, what I think Ron said, custom equality is not a bad thing per sÃ¨. We already have so many things in the language, that are powerful.","m.mentions":{"user_ids":["@mhofman:matrix.org"]},"msgtype":"m.text"},"ts":1763518655801,"senderName":"Christian Ulbrich","senderId":"@christianulbrich:matrix.org","id":"$zw7vr86OV6Pw5Gewyz-K9Z9Ngi64fqaTWd_WENy9eig"},
{"content":{"body":"Letâ€™s fix that. Doing something for convenience in the spec is much less important that actual impl difficulties.","m.mentions":{},"msgtype":"m.text"},"ts":1763518658873,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$O9aASOv1t9oQU-M1Iq-ik5-ymwuC7Ilv5HMgBhNxbOk"},
{"content":{"body":"its definitely web reality at this point","m.mentions":{},"msgtype":"m.text"},"ts":1763518681386,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$AOJB8vaVg0rILp9152weCUfmmW0rYRDK5LZy4sqZbdQ"},
{"content":{"body":"There's some compatibility risk although I don't know how high it is in practice","m.mentions":{},"msgtype":"m.text"},"ts":1763518682863,"senderName":"keith_miller","senderId":"@keith_miller:matrix.org","id":"$WwU0SMt1nekUZUlR_GjuI8_dobKKuaMijLy4PmoTeEE"},
{"content":{"body":"i've seen code in the wild using TypedArray.prototype.foo.call","m.mentions":{},"msgtype":"m.text"},"ts":1763518712867,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$CW3h6ppysytCU4WTd4CB9gcos3zL_cB_3DtWh9EdxQM"},
{"content":{"body":"actually i guess that doesn't actually preclude adding more methods","m.mentions":{},"msgtype":"m.text"},"ts":1763518733340,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$-0PSroC7OIRcsuRCGtDFFROgVUOmRc2NTRWE2VuoyK4"},
{"content":{"body":"Maybe you could just shadow the current one","m.mentions":{},"msgtype":"m.text"},"ts":1763518744110,"senderName":"keith_miller","senderId":"@keith_miller:matrix.org","id":"$jPWdoHAVVvus2mFt_XERD6tM_Q8BUy_zMXmJxdsZA8k"},
{"content":{"body":"* actually i guess that doesn't actually preclude adding more methods on the subclasses","m.mentions":{},"m.new_content":{"body":"actually i guess that doesn't actually preclude adding more methods on the subclasses","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$-0PSroC7OIRcsuRCGtDFFROgVUOmRc2NTRWE2VuoyK4","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763518745199,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$ZXHnx5v8tovWldXdCq--rFAYytCF6zAUEjCoZ0fw3ig"},
{"content":{"body":"It would be weird but I doubt anyone would really know","m.mentions":{},"msgtype":"m.text"},"ts":1763518759585,"senderName":"keith_miller","senderId":"@keith_miller:matrix.org","id":"$N3khxchziCDuluz1Vi9m06JH-BwQob7BG_od39YEREs"},
{"content":{"body":"we did a similar change moving around where some error properties were located in webkit and chrome and no one noticed","m.mentions":{},"msgtype":"m.text"},"ts":1763518803225,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$qx__IzvxGyMrq6VkHYajuwxe5pw3CWaEC69bqWNfSuc"},
{"content":{"body":"That's just prototype pollution. Which is a much more general problem. But yeah you could have an array instance with an shadowed Symbol.iterator that does something weird, and I don't like that array spread would be affected by that.","m.mentions":{"user_ids":["@christianulbrich:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$2JgE4OJuTNlMH8H_KGK9ouaPbV58PSBVgN3hFykeCws"}},"msgtype":"m.text"},"ts":1763518816293,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$vQ5TT9Ghkik2WcocSpZy8n-iMt6149G-bRpeHlJwDJg"},
{"content":{"body":"I think it is not weird to get custom behavior when spreading an object which happens to be IsArray but which has a custom `Symbol.iterator`","format":"org.matrix.custom.html","formatted_body":"I think it is not weird to get custom behavior when spreading an object which happens to be IsArray but which has a custom <code>Symbol.iterator</code>","m.mentions":{},"msgtype":"m.text"},"ts":1763518889626,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$jUPFbm_IgLcm-1cZ6MzKJyWcoJe1AXOQ_Oxzpcfv35Y"},
{"content":{"body":"as to the Array prototype Symbol.iterator pollution problem, I have a proposal for fixing that!","m.mentions":{},"msgtype":"m.text"},"ts":1763518918076,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$LzawGoFan655oeRopIQmtnn4puMf-JBtwZ0PN2tBXZ4"},
{"content":{"body":"ah actually it was the opposite direction https://github.com/WebKit/WebKit/commit/96efcf1f1c011efd5946d053272581e0a3d6c3b2 (my only webkit commit ðŸ˜„)","m.mentions":{},"m.relates_to":{"m.in_reply_to":{"event_id":"$qx__IzvxGyMrq6VkHYajuwxe5pw3CWaEC69bqWNfSuc"}},"msgtype":"m.text"},"ts":1763518939247,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$9GOjpnWs61WEDE-MezR6WlEF8LQh2FjKuBgo00Bb41w"},
{"content":{"body":"What exactly is the spec convenience we are talking about? That they all share a common proto?","m.mentions":{"user_ids":["@jridgewell:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$qM--Vpjs4tBPzZZphJmtrqD6D6lBcdpHePBO8z3ybao"}},"msgtype":"m.text"},"ts":1763519735208,"senderName":"Olivier FlÃ¼ckiger","senderId":"@olivf.o1o.ch:immer.chat","id":"$en5YKAY86NGb10vezAx8EDVOFMmO2jXDEXV9e7q92kQ"},
{"content":{"body":"Looks like, _native equality_ comes quite at some cost, of those _interned objects_ not being so _native_ anymore...","format":"org.matrix.custom.html","formatted_body":"Looks like, <em>native equality</em> comes quite at some cost, of those <em>interned objects</em> not being so <em>native</em> anymore...","m.mentions":{},"msgtype":"m.text"},"ts":1763519742722,"senderName":"Christian Ulbrich","senderId":"@christianulbrich:matrix.org","id":"$Toi5KEoMfbQPDK5ofDu7vYPcMZkqd1mldChpyQasc0g"},
{"content":{"body":"Yah, and the methods are defined on the common proto","format":"org.matrix.custom.html","formatted_body":"Yah, and the methods are defined on the common proto","m.mentions":{"user_ids":["@olivf.o1o.ch:immer.chat"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$en5YKAY86NGb10vezAx8EDVOFMmO2jXDEXV9e7q92kQ"}},"msgtype":"m.text"},"ts":1763519943574,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$XagM8z_Jo5qpxI_X8EOqWq4EXRdvawD4VyBeyg2FAIk"},
{"content":{"body":"Though apparently index access is also slower than it should be","format":"org.matrix.custom.html","formatted_body":"Though apparently index access is also slower than it should be","m.mentions":{"user_ids":["@keith_miller:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$opafoHr-4MIgEBAWD0jlCF6-ovBpW8I4BmZuKwnb6OE"}},"msgtype":"m.text"},"ts":1763520000351,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$JUrscMDGA9gB41VCnSPU3J-d6pydOv8lZdONLkqvgtY"},
{"content":{"body":"Would this be a first for the language? Is there any object, that is specially handled somewhere, somehow, besides being an object, I mean apart from `null`?","format":"org.matrix.custom.html","formatted_body":"Would this be a first for the language? Is there any object, that is specially handled somewhere, somehow, besides being an object, I mean apart from <code>null</code>?","m.mentions":{},"msgtype":"m.text"},"ts":1763520224648,"senderName":"Christian Ulbrich","senderId":"@christianulbrich:matrix.org","id":"$enIxVjiRmEQD0vHt-gjVxkfLl7eFeBknEaR4nOAJDt8"},
{"content":{"body":"It's probably not our main worry for TA... But in principle all for not doing convenience in the spec if it makes implementation harder.","m.mentions":{},"msgtype":"m.text"},"ts":1763520227103,"senderName":"Olivier FlÃ¼ckiger","senderId":"@olivf.o1o.ch:immer.chat","id":"$7jWDVfJ-GPDFS5DzmNf3GiPFqklBMyiANFl6eHNh-So"},
{"content":{"body":"also worth mentioning that a lot of TA baggage comes from khronos :P","m.mentions":{},"msgtype":"m.text"},"ts":1763520384613,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$geFD4Pf_rYi0HYfHxlQZwI4xulA43DZ4S1tSpqKZxGM"},
{"content":{"body":"* also worth mentioning that a lot of TA baggage comes from khronos, not necessarily people making convenient spec decisions :P","m.mentions":{},"m.new_content":{"body":"also worth mentioning that a lot of TA baggage comes from khronos, not necessarily people making convenient spec decisions :P","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$geFD4Pf_rYi0HYfHxlQZwI4xulA43DZ4S1tSpqKZxGM","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763520401338,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$sRXDVbJvzEiWJ59pZYlLaoFSSErBTeP43TLV2jc3Nnw"},
{"content":{"body":"`document.all`","format":"org.matrix.custom.html","formatted_body":"<code>document.all</code>","m.mentions":{"user_ids":["@christianulbrich:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$enIxVjiRmEQD0vHt-gjVxkfLl7eFeBknEaR4nOAJDt8"}},"msgtype":"m.text"},"ts":1763520521342,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$9WNFLdbngCR8xO14XAQSkWq7rTnctzpFz_Sm2suxv3Q"},
{"content":{"body":"khronos?","format":"org.matrix.custom.html","formatted_body":"khronos?","m.mentions":{"user_ids":["@devsnek:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$geFD4Pf_rYi0HYfHxlQZwI4xulA43DZ4S1tSpqKZxGM"}},"msgtype":"m.text"},"ts":1763520546689,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$swJOMgLQhQJgzMI1LtWl4rRp6osQGyS1KDTlHJo_TOE"},
{"content":{"body":"> \"Khronos typed arrays\" refers to the JavaScript Typed Arrays specification, which was originally developed under the Khronos Group for use in its graphics APIs like WebGL\n\n(google ai summary)","format":"org.matrix.custom.html","formatted_body":"<blockquote>\n<p>\"Khronos typed arrays\" refers to the JavaScript Typed Arrays specification, which was originally developed under the Khronos Group for use in its graphics APIs like WebGL</p>\n</blockquote>\n<p>(google ai summary)</p>\n","m.mentions":{},"msgtype":"m.text"},"ts":1763520586648,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$UHtnzJaGxffiCALvhLtZqTO9al-un-XZn7aFfVS0Eig"},
{"content":{"body":"yes they were developed for webgl and later merged into ecma262","m.mentions":{},"msgtype":"m.text"},"ts":1763520620258,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$ejK3fla3FlQ5W87lQtCYG4WLytcDmAEfIOJdVwFwqYo"},
{"content":{"body":"that's the origin of all the detachedness f-ery","m.mentions":{},"msgtype":"m.text"},"ts":1763520645597,"senderName":"rkirsling","senderId":"@rkirsling:matrix.org","id":"$ZwQ2wdranh2HHeU0wSegxlrDEB7rR9QRnMUzACLA2e8"},
{"content":{"body":"ljharb: In what context? This is a DOM API.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@ljharb:matrix.org\">ljharb</a>: In what context? This is a DOM API.","m.mentions":{"user_ids":["@ljharb:matrix.org"]},"msgtype":"m.text"},"ts":1763520668187,"senderName":"Christian Ulbrich","senderId":"@christianulbrich:matrix.org","id":"$Sb34maTtAgSZXzUOpFEfJ6GW1bcj2MV10RHzDXvWqmI"},
{"content":{"body":"https://tc39.es/ecma262/multipage/additional-ecmascript-features-for-web-browsers.html#sec-IsHTMLDDA-internal-slot","format":"org.matrix.custom.html","formatted_body":"https://tc39.es/ecma262/multipage/additional-ecmascript-features-for-web-browsers.html#sec-IsHTMLDDA-internal-slot","m.mentions":{"user_ids":["@christianulbrich:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$Sb34maTtAgSZXzUOpFEfJ6GW1bcj2MV10RHzDXvWqmI"}},"msgtype":"m.text"},"ts":1763520734000,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$7GW8b2K5JFUOsm6xaiSYpcSUGXZcFvyJTq6tcYv8XF8"},
{"content":{"body":"â€œIs HTML Document Dot All\"","m.mentions":{},"msgtype":"m.text"},"ts":1763520748207,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$Si3Rm8wO4ZFybYwuLe3DvbYzl1z_8Z957zWBSpLoFa8"},
{"content":{"body":"In the case ljharb describes, where developers know about weirdness or already have something wrong, throwing seems better?","msgtype":"m.text"},"ts":1763520767122,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$Bk5X7qA4pVyXJd7v9ru1OWSvzJZm94UMMvfIAaZs5ZA"},
{"content":{"body":"throw as early as possible","m.mentions":{},"msgtype":"m.text"},"ts":1763520787883,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$rcTjkt8ot34nx3j2FvDCi9oY73HV-5cq1SkPctXTP_M"},
{"content":{"body":"Like I cannot imagine wanting to leak here, on purpose","msgtype":"m.text"},"ts":1763520788357,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$GS2_tzzW_f7lWzWbyfqLvlkNuXZGnLO7Vk8JyBZZEEM"},
{"content":{"body":"If someone doesn't know about this they should learn by the language telling them","msgtype":"m.text"},"ts":1763520805636,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$6CHxYHbihQTkqA4Yc0zC68j9Dc49aEfuTsTt5DkFw3s"},
{"content":{"body":"Not by mysterious leaks","msgtype":"m.text"},"ts":1763520831643,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$KrHfEhuBhKS-I-Hx9uI88bb-TlOtWGsN99LqRW2aUIQ"},
{"content":{"body":"i mean an alternative would just be, require composites to have at least 1 object","m.mentions":{},"msgtype":"m.text"},"ts":1763520834232,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$spzW_8pVZKFCS_oKwFgG4WIPK3SGlEADR1tC-OTnC1s"},
{"content":{"body":"That is also terrible ","msgtype":"m.text"},"ts":1763520843957,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$5J9vHtyKswvPd4AMq764-GO7oxjbRGu9i8japI6PRCU"},
{"content":{"body":"why?","m.mentions":{},"msgtype":"m.text"},"ts":1763520847761,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$9o6S8A8nOOfQ3gBy3vtRc1Oay7qBYRaoY2LIFE8stqc"},
{"content":{"body":"because it breaks them","m.mentions":{},"msgtype":"m.text"},"ts":1763520857964,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$_9P2dmZmTJRJpNQByNCKFHodttEeibDqgJsh_Bp1ZWY"},
{"content":{"body":"no existing code uses composites, how does that break anything","m.mentions":{},"msgtype":"m.text"},"ts":1763520869777,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$SLxbouWTba6PWTqxifLWJ0yVEW8A0qLazbJTuM_KfIs"},
{"content":{"body":"Because you want to be able to use them for, like, pairs of numbers","msgtype":"m.text"},"ts":1763520870907,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$v8CklrPwpgHw7h0zFqU0SvD3H8S1WReyWjbGTcX0R6Q"},
{"content":{"body":"if you want a composite of primitive types you then need to keep around some special identity object to put in them","m.mentions":{},"msgtype":"m.text"},"ts":1763520873217,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$mRRzzZB5bGFW7gnvpGQ9P6QGPFQcq292rDR1JJk9EYs"},
{"content":{"body":"Coordinates in a map, eg ","msgtype":"m.text"},"ts":1763520879861,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$YsmLyH84u-9GbXUnzvf7UJ5lh3yo4Pqmoa5EmxTbX3E"},
{"content":{"body":"make one symbol and stick it in every composite","m.mentions":{},"msgtype":"m.text"},"ts":1763520898266,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$F0szJhk2ESX2SwsETSgvZF-VZ_jyW0IJRlKmeT49CAc"},
{"content":{"body":"That is so bad","msgtype":"m.text"},"ts":1763520931744,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$j2KTpQKWT_V9V60MeOnp90clSeH6aU2PDk7JoCoq2yI"},
{"content":{"body":"I find waldemar argument convincing. If we have _prior art_ of handling something specifically (although I think the `document.all` to be very _exotic_ (hihi)), then I'd rather prefer a _fail-fast_ approach, then having to accept memory leaks.","format":"org.matrix.custom.html","formatted_body":"I find <a href=\"https://matrix.to/#/@waldemarh:matrix.org\">waldemar</a> argument convincing. If we have <em>prior art</em> of handling something specifically (although I think the <code>document.all</code> to be very <em>exotic</em> (hihi)), then I'd rather prefer a <em>fail-fast</em> approach, then having to accept memory leaks.","m.mentions":{"user_ids":["@waldemarh:matrix.org"]},"msgtype":"m.text"},"ts":1763520944215,"senderName":"Christian Ulbrich","senderId":"@christianulbrich:matrix.org","id":"$EK5WnsJMwElBEHpwJRX1JilXfqo7fglVhtPAyaRpIOY"},
{"content":{"body":"imo it's far less bad than making some objects not be weakable","m.mentions":{},"msgtype":"m.text"},"ts":1763520953504,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$IPPN_OJ0rqg-r44T7NAYHjs29xjwR3WlMZkT83k2Xo0"},
{"content":{"body":"The benefit of keeping the consistency for weak maps is so, so far from being with the cost of having to do that","msgtype":"m.text"},"ts":1763520961666,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$B2O0Ia6v5Xza18NKOwDK3fkElSj_3vrDy_cmodtmHoA"},
{"content":{"body":"IsHTMLDDA is like, one of the most horrifying things in the web platform, to be certain","m.mentions":{},"msgtype":"m.text"},"ts":1763520992147,"senderName":"rkirsling","senderId":"@rkirsling:matrix.org","id":"$MIG8gnrkqH6DBO6YDpk_M_7UBu1h40gA0r-4IxMFu3Q"},
{"content":{"body":"As you already pointed out, weak maps are super niche!","msgtype":"m.text"},"ts":1763520994431,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$KBUEv5nylv_jK2dsWXecAmJpLRimP67qch3oQ_1fjYw"},
{"content":{"body":"to me this all seems to lead back to \"they need to be primitives or they shouldn't exist in the language\"","m.mentions":{},"msgtype":"m.text"},"ts":1763520994566,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$OyOYUZT2mCojD3jC7jEp3gM-9GGug_rHJN3r_OrOuys"},
{"content":{"body":"* The benefit of keeping the consistency for weak maps is so, so far from being worth the cost of having to do that","m.new_content":{"body":"The benefit of keeping the consistency for weak maps is so, so far from being worth the cost of having to do that","msgtype":"m.text"},"m.relates_to":{"event_id":"$B2O0Ia6v5Xza18NKOwDK3fkElSj_3vrDy_cmodtmHoA","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763521013170,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$trF0bxJoO2wWzEBD5yCUy06fkd3QdFkooWS9OkPY2So"},
{"content":{"body":"* document.all is like, one of the most horrifying things in the web platform, to be certain; that's why [[IsHTMLDDA]] is a sort of resentment-coded name","m.mentions":{},"m.new_content":{"body":"document.all is like, one of the most horrifying things in the web platform, to be certain; that's why [[IsHTMLDDA]] is a sort of resentment-coded name","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$MIG8gnrkqH6DBO6YDpk_M_7UBu1h40gA0r-4IxMFu3Q","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763521014161,"senderName":"rkirsling","senderId":"@rkirsling:matrix.org","id":"$rN9MptCXGN18NNGgQDIF8WeFXAR-cMlN5kgBYQCTpWU"},
{"content":{"body":"we shouldn't commit minor crimes just because the thing we want to add shouldn't be an object but is forced to be one","m.mentions":{},"msgtype":"m.text"},"ts":1763521040219,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$zKJaBuJUYymP6ImGhkZuLwIwGt0CRBZjkkoK3VGPef0"},
{"content":{"body":"Ok that is a position you could have, but at that point this question does not matter","msgtype":"m.text"},"ts":1763521077540,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$609UBjMzs72Jx-YDqsaER6gsO08XWRuHophrDlyYpMM"},
{"content":{"body":"i don't find weakmaps to be the fundamental primitive by which i decide what a value is. rather weakmap is a somewhat strange api that exposes the reality of values.","m.mentions":{},"msgtype":"m.text"},"ts":1763521083732,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$80m7gJeE1y0bnhhteIY7NA1SOLcD5TaUlJorFkCddmI"},
{"content":{"body":"* i don't find weakmaps to be the fundamental primitive by which i decide what a value is. rather weakmap is a somewhat strange api /becausae/ it exposes the reality of values.","m.mentions":{},"m.new_content":{"body":"i don't find weakmaps to be the fundamental primitive by which i decide what a value is. rather weakmap is a somewhat strange api /becausae/ it exposes the reality of values.","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$80m7gJeE1y0bnhhteIY7NA1SOLcD5TaUlJorFkCddmI","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763521089687,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$nEmD5CSWmVzaURbHjUUmYbyfCnTMVgE4pPCXooHjLKc"},
{"content":{"body":"We are talking about what happens assuming that isn't the world we're in","msgtype":"m.text"},"ts":1763521092277,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$FnzNEmlKB1Uds8DEMwSjOF0n_7tvxzlwYlm_kpgLU2w"},
{"content":{"body":"I have a feeling, that the discussion is very academic. What would be a real-world library using WeakSets that would be easily affected by this?","m.mentions":{},"msgtype":"m.text"},"ts":1763521122597,"senderName":"Christian Ulbrich","senderId":"@christianulbrich:matrix.org","id":"$SzcmKUBQQ89dSFUBhAZHVk_OJvTJPf7WXgadSR8kZwE"},
{"content":{"body":"* i don't find weakmaps to be the fundamental primitive by which i decide what a value is. rather weakmap is a somewhat strange api /because/ it exposes the reality of values.","m.mentions":{},"m.new_content":{"body":"i don't find weakmaps to be the fundamental primitive by which i decide what a value is. rather weakmap is a somewhat strange api /because/ it exposes the reality of values.","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$80m7gJeE1y0bnhhteIY7NA1SOLcD5TaUlJorFkCddmI","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763521128398,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$FoDDoe5jYA4AplzRa6kkCSVqwDksqF7ef_830f5NHBA"},
{"content":{"body":"also what would be a real-world application where this would be the biggest memory leak in the app","m.mentions":{},"msgtype":"m.text"},"ts":1763521153838,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$nZ4Pa93AOuXDKy2F3BqHmsr17wBi5rRiRd_aLhYVkLQ"},
{"content":{"body":"kinda feel sorry for Yusuke's queue item getting shoved to the bottom","m.mentions":{},"msgtype":"m.text"},"ts":1763521154517,"senderName":"rkirsling","senderId":"@rkirsling:matrix.org","id":"$_B6zLiyc-Pf8hX9B7A9PbIvJTEdTRnLRfqy715UBmgc"},
{"content":{"body":"fwiw most use of weak apis do not deal with arbitrary values","m.mentions":{},"msgtype":"m.text"},"ts":1763521158284,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$kfmAvzC1kRdZPj6K1UOoH4yKzJVXlYCfwOlfejDKlPc"},
{"content":{"body":"* fwiw most use of weak apis do not deal with arbitrary values, they are almost always contained within a single layer of an application","m.mentions":{},"m.new_content":{"body":"fwiw most use of weak apis do not deal with arbitrary values, they are almost always contained within a single layer of an application","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$kfmAvzC1kRdZPj6K1UOoH4yKzJVXlYCfwOlfejDKlPc","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763521168308,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$KzT4_a-BNQ2gr27MnBLLPZ7S9gRtbyH-SLxR8ElvuZU"},
{"content":{"body":"* fwiw most use of weak apis do not deal with arbitrary values, they are almost always contained within a single layer of a codebase","m.mentions":{},"m.new_content":{"body":"fwiw most use of weak apis do not deal with arbitrary values, they are almost always contained within a single layer of a codebase","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$kfmAvzC1kRdZPj6K1UOoH4yKzJVXlYCfwOlfejDKlPc","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763521173609,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$t1_qi4e7vIco6dPCP4E7QihK1Qp0itmxxLz4QQFk2Wc"},
{"content":{"body":"why is Yusuke's topic kept pushing down the queue?","m.mentions":{},"msgtype":"m.text"},"ts":1763521183473,"senderName":"Chengzhong Wu","senderId":"@legendecas:matrix.org","id":"$DamJRP53vM0ayShgarkS0Z0UxqjV2cw8XI56oCMqAtA"},
{"content":{"body":"* why is Yusuke's topic kept pushing down the queue? feel like new topics are added before Yusuke's","m.mentions":{},"m.new_content":{"body":"why is Yusuke's topic kept pushing down the queue? feel like new topics are added before Yusuke's","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$DamJRP53vM0ayShgarkS0Z0UxqjV2cw8XI56oCMqAtA","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763521241633,"senderName":"Chengzhong Wu","senderId":"@legendecas:matrix.org","id":"$SC9WbBtzcGayOa-146Pqxvj3T7FMJ57hUP77rEzc51c"},
{"content":{"body":"Next time we talk about this I vote implementations get priority ","msgtype":"m.text"},"ts":1763521253411,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$VXkBeJq-W4Vwh5JtqWDKQI2V7qnh8XuBEnXaXUK69hI"},
{"content":{"body":"We should really not add objects that cannot be collected. Websites running out of memory is really a terrible issue to debug for all parties involved.","m.mentions":{},"msgtype":"m.text"},"ts":1763521282684,"senderName":"Olivier FlÃ¼ckiger","senderId":"@olivf.o1o.ch:immer.chat","id":"$z9_Ak3JMnaHsvPbyXChhR1sKL0iG5-I-bupxvmcu9NQ"},
{"content":{"body":"I care a lot more about what is implementable than about our design opinions unconstrained by implementation reality","msgtype":"m.text"},"ts":1763521289317,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$PgaqRKwxaYj8CJHKhl97wZpimrYVUc2fD9Wfi_BJsg0"},
{"content":{"body":"it is easy to imagine, for example, something which is serializing values to be passed to and from a worker, and uses a WeakMap to cache the serialization, with the serializations happening very frequently (it's a common pattern when splitting some computations to be done off the main thread, for example), and then it starts passing Composites some of the time, and now it is leaking a lot","m.mentions":{"user_ids":["@ljharb:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$nZ4Pa93AOuXDKy2F3BqHmsr17wBi5rRiRd_aLhYVkLQ"}},"msgtype":"m.text"},"ts":1763521660496,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$e3L6VMeCjDN3i0Bwvfg-Yx_ltOydGpwZm2HnSi3neAI"},
{"content":{"body":"that is an unusually _easy_ example of a leak to track down, and is also very much a thing which would happen with totally normal use of WeakMaps","format":"org.matrix.custom.html","formatted_body":"that is an unusually <em>easy</em> example of a leak to track down, and is also very much a thing which would happen with totally normal use of WeakMaps","m.mentions":{},"msgtype":"m.text"},"ts":1763521691003,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$PIMt4z91ZvCacWhSYrfxOBhscAxcrw-7YbJcNhvRZ9U"},
{"content":{"body":"throwing is much, much better here, so that the developer learns that actually WeakMaps do not work for Composites.","m.mentions":{},"msgtype":"m.text"},"ts":1763521709061,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$YNZ7owJajTtb8o_lbcl1A4SfuznpQ6GUyforCrwrvX4"},
{"content":{"body":"Congratulations to eemeli and Ashley Claymore for being the only speakers yesterdayâ€”including myselfâ€”who made sure the appropriate info was recorded in the notes.","format":"org.matrix.custom.html","formatted_body":"Congratulations to <a href=\"https://matrix.to/#/@eemeli:mozilla.org\">eemeli</a> and <a href=\"https://matrix.to/#/@aclaymore:matrix.org\">Ashley Claymore</a> for being the only speakers yesterdayâ€”including myselfâ€”who made sure the appropriate info was recorded in the notes.","m.mentions":{"user_ids":["@eemeli:mozilla.org","@aclaymore:matrix.org"]},"msgtype":"m.text"},"ts":1763523696343,"senderName":"Aki","senderId":"@akirose:matrix.org","id":"$PePGVqAviOGWqLitt5Nsz7SNfOp9WVZAgipbWxYAX3g"},
{"content":{"body":"bakkot, ryzokuken , ptomato , Mikhail Barash , FYT, nicolo-ribaudo , Richard Gibson , dminor , Michael Ficarra , ljharb , and James M Snell : here's what's missing https://kdrive.infomaniak.com/app/share/1777368/c4d6dca3-6847-4674-bf1d-87d2d0370871","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@bakkot:matrix.org\">bakkot</a>, <a href=\"https://matrix.to/#/@usharma:igalia.com\">ryzokuken</a> , <a href=\"https://matrix.to/#/@pchimento:igalia.com\">ptomato</a> , <a href=\"https://matrix.to/#/@mikbar-uib:matrix.org\">Mikhail Barash</a> , FYT, <a href=\"https://matrix.to/#/@nicolo-ribaudo:matrix.org\">nicolo-ribaudo</a> , <a href=\"https://matrix.to/#/@gibson042:matrix.org\">Richard Gibson</a> , <a href=\"https://matrix.to/#/@dminor:mozilla.org\">dminor</a> , <a href=\"https://matrix.to/#/@michaelficarra:matrix.org\">Michael Ficarra</a> , <a href=\"https://matrix.to/#/@ljharb:matrix.org\">ljharb</a> , and <a href=\"https://matrix.to/#/@jasnell:matrix.org\">James M Snell</a> : here's what's missing https://kdrive.infomaniak.com/app/share/1777368/c4d6dca3-6847-4674-bf1d-87d2d0370871","m.mentions":{"user_ids":["@bakkot:matrix.org","@usharma:igalia.com","@pchimento:igalia.com","@mikbar-uib:matrix.org","@nicolo-ribaudo:matrix.org","@gibson042:matrix.org","@dminor:mozilla.org","@michaelficarra:matrix.org","@ljharb:matrix.org","@jasnell:matrix.org"]},"msgtype":"m.text"},"ts":1763523832368,"senderName":"Aki","senderId":"@akirose:matrix.org","id":"$ImJEGL4jVPjglIdFw5VKqe-xUT5BCnk0cZATYZJLLVE"},
{"content":{"body":"fwiw speakers generally aren't the ones who add the link to the slides, I don't typically check for that after having done my presentation","m.mentions":{},"msgtype":"m.text"},"ts":1763523958760,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$Jj-_XiCwg8R-3Ekxd1giqOh7p-vKF6m4RsrubMIuZjQ"},
{"content":{"body":"(usually note takers do)","m.mentions":{},"msgtype":"m.text"},"ts":1763523964405,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$3iEqLqnohxOtgHvjRw148QDzmfmiEt4idAGilFY4caE"},
{"content":{"body":"Yeah the notes are in _really_ rough shape this meeting. ","format":"org.matrix.custom.html","formatted_body":"Yeah the notes are in <em>really</em> rough shape this meeting.","m.mentions":{},"msgtype":"m.text"},"ts":1763523979010,"senderName":"Aki","senderId":"@akirose:matrix.org","id":"$HKdUp-qWs9G6r1_Q-N9R9KDBplz8UTcLCWRaOsDqRq0"},
{"content":{"body":"anyway added slides link to editor update item","m.mentions":{},"msgtype":"m.text"},"ts":1763523996645,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$oA_Snroo-GliArlv2nCHheOON1-cZA2piZNxoy0zfxI"},
{"content":{"body":"sometimes an agenda item was added without a link to slides. In this case, note takers are not able to add the link for the speakers. Please add the link after done the presentation","m.mentions":{},"msgtype":"m.text"},"ts":1763524060087,"senderName":"Chengzhong Wu","senderId":"@legendecas:matrix.org","id":"$84dAJS-_531AlXvQP6cdAneWgj7glTPxUpr-dTJyXfk"},
{"content":{"body":"* sometimes an agenda item was added without a link to slides. In this case, note takers are not able to add the link for the speakers in the notes. Please add the link after done the presentation","m.mentions":{},"m.new_content":{"body":"sometimes an agenda item was added without a link to slides. In this case, note takers are not able to add the link for the speakers in the notes. Please add the link after done the presentation","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$84dAJS-_531AlXvQP6cdAneWgj7glTPxUpr-dTJyXfk","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763524084261,"senderName":"Chengzhong Wu","senderId":"@legendecas:matrix.org","id":"$8jjJ064YXeA7p8p4t7dDpeyb3xQgFgfg_trHB00At-w"},
{"content":{"body":"what on earth is kdrive, i was so confused when i wasn't logged in to google sheets and then i realized it wasn't sheets","m.mentions":{},"m.relates_to":{"event_id":"$ImJEGL4jVPjglIdFw5VKqe-xUT5BCnk0cZATYZJLLVE","is_falling_back":true,"m.in_reply_to":{"event_id":"$ImJEGL4jVPjglIdFw5VKqe-xUT5BCnk0cZATYZJLLVE"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1763524446436,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$jHf7dWq03Nq7EZpjcTYYpqhDSQoGT0FNeepmLPM5lRI"},
{"content":{"body":"it jumps to labels: https://github.com/v8/v8/blob/638e32793f854790284bf613eca204550e1c8e56/src/builtins/builtins-collections-gen.cc#L211-L215","m.mentions":{"user_ids":["@devsnek:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$N6IVCSiVJClL-_R1KP4pCE2KufYyeFpT6F1GNdD3Cds"}},"msgtype":"m.text"},"ts":1763525085801,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$wpekX6NFM-hcHmbMfpH2U352-g5wh8P-5z0zxliH6WY"},
{"content":{"body":"that's just an if/else though. i was referring to these more: https://github.com/v8/v8/blob/638e32793f854790284bf613eca204550e1c8e56/src/builtins/builtins-typed-array-gen.cc#L546-L601","m.mentions":{},"msgtype":"m.text"},"ts":1763525179207,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$fDovNwH83fu03OPZnGJGLRmRt11AILdzXvBmSNvVYT8"},
{"content":{"body":"One motivation for them to be objects is to allow them to contain mutable objects. That is not acceptable as primitives","m.mentions":{"user_ids":["@ljharb:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$zKJaBuJUYymP6ImGhkZuLwIwGt0CRBZjkkoK3VGPef0"}},"msgtype":"m.text"},"ts":1763525199687,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$IHkAzBrKNL09QEZrOyyfQvfvwvvKjdkUdfbfo2agpzc"},
{"content":{"body":"that leaks in a worse and more subtle way. Which is why I don't want the answer to be: every composite must contain something non-forgable","m.mentions":{"user_ids":["@ljharb:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$F0szJhk2ESX2SwsETSgvZF-VZ_jyW0IJRlKmeT49CAc"}},"msgtype":"m.text"},"ts":1763525272078,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$C7b3OSW_qVa2D2gKeU0J97EF6uzDiR6b8Gjjyn_dFZU"},
{"content":{"body":"Membrane style libraries that keep an association from any object to another object they created. We also have a classification library where we'll check the shape of a deeply frozen object and remember the classification.","m.mentions":{"user_ids":["@christianulbrich:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$SzcmKUBQQ89dSFUBhAZHVk_OJvTJPf7WXgadSR8kZwE"}},"msgtype":"m.text"},"ts":1763525307687,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$fBHSuoQ-6LNW7w0f8Cry3NuubR5ANDL8ZNqT4eyl6Ow"},
{"content":{"body":"* that's just a single branch though. i was referring to these more: https://github.com/v8/v8/blob/638e32793f854790284bf613eca204550e1c8e56/src/builtins/builtins-typed-array-gen.cc#L546-L601","m.mentions":{},"m.new_content":{"body":"that's just a single branch though. i was referring to these more: https://github.com/v8/v8/blob/638e32793f854790284bf613eca204550e1c8e56/src/builtins/builtins-typed-array-gen.cc#L546-L601","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$fDovNwH83fu03OPZnGJGLRmRt11AILdzXvBmSNvVYT8","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763525321937,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$SK3XjtPrYkNuoilhMF1lLLYBUchDeAR34d6RN8zTLo4"},
{"content":{"body":"I requested during my presentation that we keep the conversation to the slides, and not extend the conversation to a wider conversation. I would rather do that in a separate meeting that specifically talks about that - with prepared slides to reference.","m.mentions":{},"m.relates_to":{"event_id":"$DamJRP53vM0ayShgarkS0Z0UxqjV2cw8XI56oCMqAtA","is_falling_back":true,"m.in_reply_to":{"event_id":"$DamJRP53vM0ayShgarkS0Z0UxqjV2cw8XI56oCMqAtA"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1763525393238,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$MEXNWNo7HmbsyN5oXSMOyDJTjG2TuHaYWX53uTRWAuw"},
{"content":{"body":"it should still be called Semaphore ðŸ’¢","m.mentions":{},"msgtype":"m.text"},"ts":1763525528479,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$nZYbORWN1oqY34zNAZP0XLnY42QZLzkaI00dEwLVRjY"},
{"content":{"body":"it seems like Governor would be a confusingly disconnected name if it's located right on globalThis but not sure whether that's the intent","m.mentions":{},"msgtype":"m.text"},"ts":1763525585258,"senderName":"rkirsling","senderId":"@rkirsling:matrix.org","id":"$a3YKmwaOfLIl6dIPbGdCBs0nBXPr43re41sVaOGY-Vg"},
{"content":{"body":"I think `Semaphore` is the right name, but only if its API is usable both for async coordination and thread coordination (with shared structs), which is certainly feasible.","format":"org.matrix.custom.html","formatted_body":"I think <code>Semaphore</code> is the right name, but only if its API is usable both for async coordination and thread coordination (with shared structs), which is certainly feasible.","m.mentions":{},"msgtype":"m.text"},"ts":1763525650642,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$3Pldzaj4TTxip-9pUYS08dQvEeeoTi2Geb_oXHX2mPE"},
{"content":{"body":"I _think_ the only thing necessary to make it work for thread coordination is for it to be structured-cloneable?","format":"org.matrix.custom.html","formatted_body":"I <em>think</em> the only thing necessary to make it work for thread coordination is for it to be structured-cloneable?","m.mentions":{},"msgtype":"m.text"},"ts":1763526058944,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$0oH4fDKr16Ckh_OUyWb8mrXI9h9RpU5scz3PVUoMcRM"},
{"content":{"body":"with the internal state not being shared not cloned, obviously","m.mentions":{},"msgtype":"m.text"},"ts":1763526071570,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$RDo0mTTEEg3lfMLE1qEYk4BgVI1MHTkIfb2jmSxGNSM"},
{"content":{"body":"I guess the spec would require some atomics stuff, probably","m.mentions":{},"msgtype":"m.text"},"ts":1763526084776,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$wriRn_GXyWHzePla5BI5xOULHs8NQ9QXJFHFldZNGmw"},
{"content":{"body":"No, it wouldn't be structured clonable, it would be shared (just like Mutex, Condition)","m.mentions":{},"msgtype":"m.text"},"ts":1763526103270,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$vY6ksg2iQYtQBGCrDeecHInJxUyQ1xPjsFs67JwVx74"},
{"content":{"body":"Structured cloneable isn't shareable","m.mentions":{},"msgtype":"m.text"},"ts":1763526118846,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$QXis85H2RAAQ6msXqyffKkr_39n8MxQ-EUJKbJExuEQ"},
{"content":{"body":"Ideally it would be the same kind of object as we want Mutex to be (shared with a per-realm prototype). ","m.mentions":{},"msgtype":"m.text"},"ts":1763526264102,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$ZQPJMlRjEcod8aPRvUAg8T5fP-WltlB97eChMP5FEnk"},
{"content":{"body":"structured cloneable includes shared values ","m.mentions":{},"msgtype":"m.text"},"ts":1763526282727,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$C3l6kXMoUhfuVLrj7VC-Ln7ppVIImxrnZh2Bl9zjkhU"},
{"content":{"body":"Structured clone requires postmessage. Shareable only requires assignment","m.mentions":{},"msgtype":"m.text"},"ts":1763526321912,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$A5vwCQOp0KWYGSvPVCEnDoA_oo0eHF1nxwfQaZZOfgo"},
{"content":{"body":"You can't assign a structured clonable object to a property on a shared struct, only primitive and shareable values","m.mentions":{},"msgtype":"m.text"},"ts":1763526359478,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$ruVdk5k9nAf5ifs2BkEPkK6oPZKYNwNeJ-8cSNf02V0"},
{"content":{"body":"oh you are referring to a new category of value based on shared struct ok","m.mentions":{},"msgtype":"m.text"},"ts":1763526389432,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$MnBXXbkl9_wEpY4nFYRdsBsjCIGt2aKUk0z9V34ZjQA"},
{"content":{"body":"Yes.","m.mentions":{},"msgtype":"m.text"},"ts":1763526393803,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$biJ4J0EB9ME67rtv02fzn-z9fIFAGKWha0eQffZcw9w"},
{"content":{"body":"sorry, I meant prior to shared structs existing","m.mentions":{},"msgtype":"m.text"},"ts":1763526423417,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$ad8Fuzukqyx0_GpEPTi_-V7GYHepevH8gT9Tqk8RGVM"},
{"content":{"body":"You could make it structure clonable, and when we have shared struct redefine is as a shared object, the distinction is not observable without shared structs anyway","m.mentions":{},"msgtype":"m.text"},"ts":1763526424685,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$GpS7J4-y79GCwGm33ySqCjS2cBEXlAS-gp-X7QWtuUk"},
{"content":{"body":"Mutex and Condition both fall under this category and are essentially shared structs.","m.mentions":{},"msgtype":"m.text"},"ts":1763526428608,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$wH5kjGdhqdGEYPcv4XE3wOghjXf59AzyGJeOKwDPFTs"},
{"content":{"body":"we need inter-thread coordination even without shared structs","m.mentions":{},"msgtype":"m.text"},"ts":1763526432469,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$zssukMYlmcmHQFJhEN_87TT-9JDHtZEK0HMHEVhboYE"},
{"content":{"body":"and this proposal will probably go forward before that one","m.mentions":{},"msgtype":"m.text"},"ts":1763526444906,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$HbOc91z-Aed50R6BrhmVq7mi5aqCa5m43S0gHwfSnVA"},
{"content":{"body":"oh, I see \"resource governor\" is a SQL thing, so that must be the origin of this terminology?","m.mentions":{},"m.relates_to":{"m.in_reply_to":{"event_id":"$a3YKmwaOfLIl6dIPbGdCBs0nBXPr43re41sVaOGY-Vg"}},"msgtype":"m.text"},"ts":1763526452378,"senderName":"rkirsling","senderId":"@rkirsling:matrix.org","id":"$7FwyxtCD5OWMTsZDq2Q2cHikbdPqFTdbh0nYD0-suoU"},
{"content":{"body":"IMO we shouldn't make it structured clonable, we should make it frozen and specially handled in postMessage.","m.mentions":{},"msgtype":"m.text"},"ts":1763526488117,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$Uo01rW4wCN-Lqp-u3xUvMoTld3d5QsYYhcF3XTqT7Vs"},
{"content":{"body":"fwiw structured cloneable is a superset of basically everything, except host resources that explicitly can't support it","m.mentions":{},"msgtype":"m.text"},"ts":1763526490624,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$MANfX-VEGKSRrzERAXzUuIuFKG2uSMcUL7x9yy5vGf0"},
{"content":{"body":"That would allow us to hedge ","m.mentions":{},"msgtype":"m.text"},"ts":1763526496738,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$B6pKHgRMBfqUF4GLLJK-AzBpGbzLk13odALDvDoTUxE"},
{"content":{"body":"The difference is that something structured clonable will create a *new* instance in another worker thread. A shared thing is the *same* instance in another thread.","format":"org.matrix.custom.html","formatted_body":"The difference is that something structured clonable will create a <em>new</em> instance in another worker thread. A shared thing is the <em>same</em> instance in another thread.","m.mentions":{},"msgtype":"m.text"},"ts":1763526538859,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$UHgmjZ4KELecWiCVDY_wX8HFHzH5273zG9P-xy67a10"},
{"content":{"body":"https://github.com/v8/v8/blob/638e32793f854790284bf613eca204550e1c8e56/src/builtins/builtins-collections-gen.cc#L1887-L1898 has more branches - haven't looked at exactly what this compiles to - if it's a jump table","m.mentions":{},"m.relates_to":{"event_id":"$fDovNwH83fu03OPZnGJGLRmRt11AILdzXvBmSNvVYT8","is_falling_back":true,"m.in_reply_to":{"event_id":"$fDovNwH83fu03OPZnGJGLRmRt11AILdzXvBmSNvVYT8"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1763526593039,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$D9dBAI4LCsNpOwUv3jx_ZvcJQYZJL-bLytAr-_IUnlk"},
{"content":{"body":"is SharedArrayBuffer a sharable value?","m.mentions":{},"msgtype":"m.text"},"ts":1763526594029,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$89w9Jm6hD96fUHG2OYtdo97uzvlXnLFx7ts4uAF7SOY"},
{"content":{"body":"No","m.mentions":{},"msgtype":"m.text"},"ts":1763526614017,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$O553xorUGBOGeDKlFkDks7QTQOBp-grwsHUFHGMIDsM"},
{"content":{"body":"Unfortunately","m.mentions":{},"msgtype":"m.text"},"ts":1763526623962,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$XYSCBpSDfC9aaYOSjrD1A52-MZTD_ADoGiywETT4Xfk"},
{"content":{"body":"SharedArrayBuffer is cloned, i.e. posting it back and forth doesn't preserve equality, but it points to a shared internal thing","m.mentions":{},"msgtype":"m.text"},"ts":1763526627862,"senderName":"Andreu Botella (ðŸ•‘ JST, at TC39)","senderId":"@abotella:igalia.com","id":"$veujzZoSLA_xDt4OBJnj-mpqQBhzVN_pHMmJNS6l67Q"},
{"content":{"body":"well then we can make up whatever rules we want in the structured clone algo for \"shared\" values","m.mentions":{},"msgtype":"m.text"},"ts":1763526647754,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$zUZ0T02_rHRd3b4a0zb3lq3b7EZK6i4J9KOkLbYnq2I"},
{"content":{"body":"but yeah i see your point","m.mentions":{},"msgtype":"m.text"},"ts":1763526661513,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$P34-wOHGAI-1FSmfUGnaYnc-xqmMBRGXpK-EdXsHHMU"},
{"content":{"body":"Also, Shared Structs is already at Stage 2. Its delays have been mostly been as a result of both champions having major job changes in the past few months.","m.mentions":{},"msgtype":"m.text"},"ts":1763526753609,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$rKYRfmcr_IexK_-8-Orhj-TpJO9QjX7hQNJmGKED0P0"},
{"content":{"body":"Again I maintain that having an object being sharable over postMessage doesn't prevent it from also becoming directly a shared object","m.mentions":{},"msgtype":"m.text"},"ts":1763526782025,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$61XMGq_SBLgVXHxwRPnC-epcV__UDzbUxgnFGu6AVzw"},
{"content":{"body":"I'm hoping to dedicate more time to getting it to Stage 2.7 in the coming year, though ideally I would like someone from V8 to take on @syg's co-champion role as he's indicated he is unable to participate regularly going forward.","m.mentions":{},"msgtype":"m.text"},"ts":1763526826588,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$YvgyS2BF4jqMiCjJ6ZOwxsicblSFBVn0lQ-YvYpfj8s"},
{"content":{"body":"(except maybe for all the exotic SAB stuff)","m.mentions":{},"msgtype":"m.text"},"ts":1763526829619,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$pd-t6EtdPuV-pPRoHIpY2DGfwP1SxvEbIcO4L3TLr4g"},
{"content":{"body":"rbuckton: you might want to chat with Olivier FlÃ¼ckiger ","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@rbuckton:matrix.org\">rbuckton</a>: you might want to chat with <a href=\"https://matrix.to/#/@olivf.o1o.ch:immer.chat\">Olivier FlÃ¼ckiger</a>","m.mentions":{"user_ids":["@rbuckton:matrix.org","@olivf.o1o.ch:immer.chat"]},"msgtype":"m.text"},"ts":1763526873984,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$i1V803ioCmlDgN3MB7_rUe3yp_solhdbaSgiHrJ_2AA"},
{"content":{"body":"Minor point: The audio coming from the room is very quiet compared to those joining remotely, so I either can barely hear the room or my speakers are blown out by remote attendees depending on who I adjust the audio for. ","m.mentions":{},"msgtype":"m.text"},"ts":1763526954151,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$TfYDFAwHW3XmB8kWxWFTYykZiFyOB2weOU5Cmgn1Bdk"},
{"content":{"body":"... huh, audio's fine for me","m.mentions":{},"msgtype":"m.text"},"ts":1763527000792,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$wqX31VtlO_hrRTKeUVBz0vaEJ0D4Fvw8CV-OpOka6gg"},
{"content":{"body":"The issue with structured clone is that a value going from thread A to thread B and back to thread A will not produce the same instance.","m.mentions":{},"msgtype":"m.text"},"ts":1763527023696,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$ZM0O98pO1WefBn-p9nLdsqM2pqrLs0KnGDspWwaFaP4"},
{"content":{"body":"Seems fine?","m.mentions":{},"msgtype":"m.text"},"ts":1763527040809,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$J7pKRFsL4HYOXmcbu-eWm39Opr2AbXnTuv-arSBngNI"},
{"content":{"body":"I don't actually see a reason why that would matter for this.","m.mentions":{},"msgtype":"m.text"},"ts":1763527049075,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$hQecWNaMvG6DL6c25fXiz921SJWJI_pvgi8sIW1hFhs"},
{"content":{"body":"That isn't what happens for shared structs.","m.mentions":{},"msgtype":"m.text"},"ts":1763527053052,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$mcjK74_GV_sEIRXjRTCLF_RNAda3e4J7KsXtNBkvOxA"},
{"content":{"body":"... OK?","m.mentions":{},"msgtype":"m.text"},"ts":1763527057989,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$PNVnk845a85tSaLfqJWV6XQ9WjFYI4mdvfzXiwyHubg"},
{"content":{"body":"So if you change it from being cloneable to shareable, that's an observable change","m.mentions":{},"msgtype":"m.text"},"ts":1763527067591,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$7wHWI9VI-5MV2eAcdu2ejCwG7Li_cYmTZoTJCko_JCc"},
{"content":{"body":"i don't particularly care what structured clone does as long as i get some sort of native shared state out of it, like SAB","m.mentions":{},"msgtype":"m.text"},"ts":1763527070700,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$DI-gUsLBPEJEi_umO_xgOwjgpXHf7BmvbWAdMeGGLE0"},
{"content":{"body":"New topic:  how is the quality of the original transcription for the notes today?  We had quality drop-off at 16:15 yesterday.","m.mentions":{},"msgtype":"m.text"},"ts":1763527082541,"senderName":"Rob Palmer","senderId":"@robpalme:matrix.org","id":"$8AdwriFSDaUFEKj6BTDEvollOSiViB10DH0Qj_th-IY"},
{"content":{"body":"how ?","m.mentions":{"user_ids":["@rbuckton:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$7wHWI9VI-5MV2eAcdu2ejCwG7Li_cYmTZoTJCko_JCc"}},"msgtype":"m.text"},"ts":1763527094717,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$xj83p2x4cmTt2oQp67ip2AzDZRyUMXcsik8Ou3vAk3s"},
{"content":{"body":"doing fine so far","m.mentions":{"user_ids":["@robpalme:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$8AdwriFSDaUFEKj6BTDEvollOSiViB10DH0Qj_th-IY"}},"msgtype":"m.text"},"ts":1763527124048,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$zZ6WzYttbGMaMZiVPd56fKDkLV8rcqEY8DRv667jjQw"},
{"content":{"body":"Correct me if I'm wrong, but you can't currently rely on reference equality for something like SAB bouncing between two threads, can you? \\","format":"org.matrix.custom.html","formatted_body":"Correct me if I&#39;m wrong, but you can&#39;t currently rely on reference equality for something like SAB bouncing between two threads, can you? \\","m.mentions":{},"msgtype":"m.text"},"ts":1763527185648,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$d76NQWkMVUf55ZKsxTCNhzuyPTfNF-7q7TudCwgIDaw"},
{"content":{"body":"* Correct me if I'm wrong, but you can't currently rely on reference equality for something like SAB bouncing between two threads, can you?","m.mentions":{},"m.new_content":{"body":"Correct me if I'm wrong, but you can't currently rely on reference equality for something like SAB bouncing between two threads, can you?","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$d76NQWkMVUf55ZKsxTCNhzuyPTfNF-7q7TudCwgIDaw","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763527187930,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$ToWx22s3cVWSNQMPY3Uh_c88PmqdHVp3x3SEsgpYYkw"},
{"content":{"body":"you can not","m.mentions":{},"msgtype":"m.text"},"ts":1763527192998,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$TSz8l1wqSopdt0DUrFzFCkm0aopoCgoxKOgOgCDFHIw"},
{"content":{"body":"and i don't care about it maintaining reference equality","m.mentions":{},"msgtype":"m.text"},"ts":1763527205684,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$Mcre2kww6VPkwJOj1dHSrEzGtgJyByjKPgMGCAPyYLM"},
{"content":{"body":"You can rely on reference equality for this case with Shared Structs","m.mentions":{},"msgtype":"m.text"},"ts":1763527208857,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$sGeWjkFy44kh2b0ag99RvKO333UUxdrMhaYtAr1PmfE"}
]