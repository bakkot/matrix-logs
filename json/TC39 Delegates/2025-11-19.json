[
{"content":{"body":"And we begin day 2!","m.mentions":{},"msgtype":"m.text"},"ts":1763514006885,"senderName":"Rob Palmer","senderId":"@robpalme:matrix.org","id":"$fOZD1LJKu4JnTbm2NHiiwcSTxFMIsndW7oHQe8w-3KM"},
{"content":{"body":"I think array iterators not closing when you call `return` was a mistake","format":"org.matrix.custom.html","formatted_body":"I think array iterators not closing when you call <code data-md=\"`\">return</code> was a mistake","m.mentions":{},"msgtype":"m.text"},"ts":1763514665305,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$3ZAUHTx0PdrRW_-QZEYsp4lvxyX0fTwZqlgiELJ4Lj8"},
{"content":{"body":"i think `return` was a mistake","format":"org.matrix.custom.html","formatted_body":"i think <code>return</code> was a mistake","m.mentions":{},"msgtype":"m.text"},"ts":1763514732280,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$SGTZZEATOkeP9sxHV9-ypt8DpAA6kg2qABVRfvwnaFA"},
{"content":{"body":"the generator protocol maybe, but return is fine","m.mentions":{},"msgtype":"m.text"},"ts":1763514785488,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$Niid0DnVtoagyam1N0ec4_lue9WgU7gcDfoQXLzl3qI"},
{"content":{"body":"separately, i'm not actually sure when you'd want to close the database connection - in most apps i've worked in, the database stays open and the connection is shared/pooled, and times out eventually","m.mentions":{},"msgtype":"m.text"},"ts":1763514990970,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$C2zvNsns439-sFn2hb89uU8WUyMGIHS16geqnDn_sh0"},
{"content":{"body":"Michael Ficarra: Sorry, accidentally deleted your topic while clearing the +1s","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@michaelficarra:matrix.org\">Michael Ficarra</a>: Sorry, accidentally deleted your topic while clearing the +1s","m.mentions":{"user_ids":["@michaelficarra:matrix.org"]},"msgtype":"m.text"},"ts":1763516000602,"senderName":"dminor","senderId":"@dminor:mozilla.org","id":"$vOml9idaOkpL9jLRD9sy6AAi0w5uYVL-rTvHtorNjeE"},
{"content":{"body":"these 1 or 2 or 2.7 presentations are a pretty amusing modern TC39 phenomenon","m.mentions":{},"msgtype":"m.text"},"ts":1763516010752,"senderName":"rkirsling","senderId":"@rkirsling:matrix.org","id":"$LuyLbTGBCA7ohSh1wR7nvNQg4Wvw9ct1jBcjJ4rVkm8"},
{"content":{"body":"that and conditional consensus ","m.mentions":{},"msgtype":"m.text"},"ts":1763516103850,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$FKPHzaMoaTZ_gRIsxCx5PO9-93mINX_HkdN4Pi2jLkc"},
{"content":{"body":"its nice we have ways to speed things up though","m.mentions":{},"msgtype":"m.text"},"ts":1763516117941,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$XOMc3_Yaa3HKK1C9fvcbhd6jD48ZpsNZ_lrf-zTNpc8"},
{"content":{"body":"conditional consensus is good efficiency","m.mentions":{},"msgtype":"m.text"},"ts":1763516128462,"senderName":"rkirsling","senderId":"@rkirsling:matrix.org","id":"$7gqJOw_iGNDGBYkl0v_eTxOjnKtf3Q1I1Hi5mHvGo9A"},
{"content":{"body":"@bakkot:matrix.org Can you link your async iterator slides when youâ€™re done","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@bakkot:matrix.org\">@bakkot</a> Can you link your async iterator slides when youâ€™re done","m.mentions":{"user_ids":["@bakkot:matrix.org"]},"msgtype":"m.text"},"ts":1763516225789,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$PTHMEn-3a9EhdIeFrtM9qCyWScZ5Un55cENAHXFVufQ"},
{"content":{"body":"Dumb question: Where is  CreateAsyncIteratorFromClosure defined? (re: async interator helpers-- it links to the main spec where I can't find it) ","m.mentions":{},"msgtype":"m.text"},"ts":1763516308996,"senderName":"mgaudet|travelling","senderId":"@mgaudet:mozilla.org","id":"$udZJLV_TmyPVGGBMMSTgWbfIvEo5B3mNLF3FdmODXno"},
{"content":{"body":"@mgaudet:mozilla.org https://github.com/tc39/ecma262/pull/3628","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@mgaudet:mozilla.org\">@mgaudet|travelling</a> https://github.com/tc39/ecma262/pull/3628","m.mentions":{"user_ids":["@mgaudet:mozilla.org"]},"msgtype":"m.text"},"ts":1763516396646,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$pOBonSluO5Qt2isPn9ASsyUqp-EXCVj5MoG_nCLaW6M"},
{"content":{"body":"thanks :) ","m.mentions":{},"msgtype":"m.text"},"ts":1763516447896,"senderName":"mgaudet|travelling","senderId":"@mgaudet:mozilla.org","id":"$LLtcgKakN17jGfk3kzgbrWJIZHSmmrRdWye7AcIs4Is"},
{"content":{"body":"What happens if you get an infinite loop inside a spec function? Is there any defined behavior?","m.mentions":{},"msgtype":"m.text"},"ts":1763516655644,"senderName":"waldemar","senderId":"@waldemarh:matrix.org","id":"$hAH06GJihdhHzbPtSMgXXKFJDCozV9mll8sIHxzEFgA"},
{"content":{"body":"I guess the algorithm would just never terminate until the host process does","m.mentions":{},"msgtype":"m.text"},"ts":1763516738058,"senderName":"Richard Gibson","senderId":"@gibson042:matrix.org","id":"$hae96Ios0p0oebIkSxiFKQX7nDdzFT6DP6Sg30JQimk"},
{"content":{"body":"i don't think any spec function current or proposed lets you get into a true infinite loop, they all dispatch on user code","m.mentions":{},"msgtype":"m.text"},"ts":1763516782979,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$BocQXu0KzYqkMtdaNSF-jxjn9eTgdgBaSahspt4ZQQs"},
{"content":{"body":"* i don't think any spec function current or proposed lets you get into a true infinite loop, they all predicate on user code","m.mentions":{},"m.new_content":{"body":"i don't think any spec function current or proposed lets you get into a true infinite loop, they all predicate on user code","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$BocQXu0KzYqkMtdaNSF-jxjn9eTgdgBaSahspt4ZQQs","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763516815166,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$IgmLYRwRbsmkFicdTJaVMzbzUVezDDN76jpA4fEQeA4"},
{"content":{"body":"sorry the async iterators item was so incoherent, I'd meant to do prep this weekend but I was/am down with some sort of horrible virus and am not able to think clearly enough for reasoning about concurrency code","m.mentions":{},"msgtype":"m.text"},"ts":1763517090069,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$UFMl2NzPtd3bq3msBYNCuXX0RmvGZswXuErlsv9x6DM"},
{"content":{"body":"No special casing for infinite loops; the spec technically just says you have to keep doing it forever","m.mentions":{"user_ids":["@waldemarh:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$hAH06GJihdhHzbPtSMgXXKFJDCozV9mll8sIHxzEFgA"}},"msgtype":"m.text"},"ts":1763517113723,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$zihLQpCoSesg3uu-rwzrVk0r2ikXiVjRkY5f--WwXQ8"},
{"content":{"body":"this is part of its general refusal to admit any resource constraints","m.mentions":{},"msgtype":"m.text"},"ts":1763517123160,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$lgnbpz_0NBD0QVEX_YDEPb62ic6-IqXHTohjMbR0B_g"},
{"content":{"body":"maybe, but not if we introduce a built-in infinite iterator","m.mentions":{"user_ids":["@devsnek:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$BocQXu0KzYqkMtdaNSF-jxjn9eTgdgBaSahspt4ZQQs"}},"msgtype":"m.text"},"ts":1763517127014,"senderName":"Richard Gibson","senderId":"@gibson042:matrix.org","id":"$CCQ_u-bR11Myt_RvdIkDox8ujfm791BWmGeYN4XUZrI"},
{"content":{"body":"forgive me for my naiivety (or for the lack of knowing the proper spelling), but composites are tought to be immutable, aren't they?","m.mentions":{},"msgtype":"m.text"},"ts":1763517799015,"senderName":"Christian Ulbrich","senderId":"@christianulbrich:matrix.org","id":"$5F997xphaCZWuozfb16x2xJIdFWcTxH-Bsnr5peZarA"},
{"content":{"body":"Yes","m.mentions":{},"msgtype":"m.text"},"ts":1763517828170,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$x6NnQf4bArpayG9rcD7unkY9nPftbCj85mDJIj8rdoY"},
{"content":{"body":"Shallowly ","format":"org.matrix.custom.html","formatted_body":"Shallowly","m.mentions":{},"msgtype":"m.text"},"ts":1763517830957,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$PzcZ0oLVHkFLLANy6XY8igX8tKsrFbbxRF0W13Qb9DI"},
{"content":{"body":"Shallowly?","m.mentions":{},"msgtype":"m.text"},"ts":1763517849848,"senderName":"Christian Ulbrich","senderId":"@christianulbrich:matrix.org","id":"$zU2vbdTQ82T5B7kV38FAeYzoSxifRHWMyf-ZZ_zENmc"},
{"content":{"body":"They can contain mutable stuff","m.mentions":{},"msgtype":"m.text"},"ts":1763517862673,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$lk5QSk6HlUOPSM2Yoy7QdHMCh77qxjbcepePYWIdHgc"},
{"content":{"body":"is implementation concern the only factor for interned vs unique? or are there other constraints?","m.mentions":{},"msgtype":"m.text"},"ts":1763517865776,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$mylVYaTPogAeILW8GffW8aWWZKRNAa3-nft3dRRJ2bw"},
{"content":{"body":"c1.wallet.amount is not immutable?","m.mentions":{},"msgtype":"m.text"},"ts":1763517867069,"senderName":"Christian Ulbrich","senderId":"@christianulbrich:matrix.org","id":"$df__NAPV0z7c3K2pEVx98kDApFQ6-IHTBt2xO9Tjnoc"},
{"content":{"body":"correct","m.mentions":{},"msgtype":"m.text"},"ts":1763517873249,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$p3iGMqqz7AxmItFx7onTVmkh2Z-jEDasHOnM9LBhNd4"},
{"content":{"body":"* `c1.wallet.amount` is not immutable?","format":"org.matrix.custom.html","formatted_body":"* <code>c1.wallet.amount</code> is not immutable?","m.mentions":{},"m.new_content":{"body":"`c1.wallet.amount` is not immutable?","format":"org.matrix.custom.html","formatted_body":"<code>c1.wallet.amount</code> is not immutable?","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$df__NAPV0z7c3K2pEVx98kDApFQ6-IHTBt2xO9Tjnoc","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763517876331,"senderName":"Christian Ulbrich","senderId":"@christianulbrich:matrix.org","id":"$FAGyT1XNTrkfn8I-sVh8VHwqEKUV3qU6DJtSs-gL_cs"},
{"content":{"body":"You can make wallet a composite too ","format":"org.matrix.custom.html","formatted_body":"You can make wallet a composite too","m.mentions":{},"msgtype":"m.text"},"ts":1763517891889,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$cNFKIOHbezhw5HxRm_mdLy4Hk3Y9cS8Je8Z2J1GmTag"},
{"content":{"body":"can but shouldn't, wallets have identity","m.mentions":{},"msgtype":"m.text"},"ts":1763517927023,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$TTtwySIUn5618oU4Jg6xTT8m2iHh3mp2y5swWSR67yI"},
{"content":{"body":"my wallet is not your wallet just because we both have no money","m.mentions":{},"msgtype":"m.text"},"ts":1763517936503,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$omsGQ1XDJ86yGlyCJqNQFhLarrlnceaQ51vsGjf21S4"},
{"content":{"body":"@keith_miller:matrix.org Is spec convienence causing real slowdowns for TAs?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@keith_miller:matrix.org\">@keith_miller</a> Is spec convienence causing real slowdowns for TAs?","m.mentions":{"user_ids":["@keith_miller:matrix.org"]},"msgtype":"m.text"},"ts":1763517959863,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$3YxkOspYI4s05AqHKRsHd8STnFsuqH_Q6HK7qKZWCfE"},
{"content":{"body":"so `let c1 = Composite({wallet: amount: 20}); \nlet c2 = Composite({wallet: amount: 20});\nc1 === c2; // true\nc1.wallet.amount+=20;\nc1 === c2 // ??\n`","format":"org.matrix.custom.html","formatted_body":"so <code>let c1 = Composite({wallet: amount: 20});  let c2 = Composite({wallet: amount: 20}); c1 === c2; // true c1.wallet.amount+=20; c1 === c2 // ?? </code>","m.mentions":{},"msgtype":"m.text"},"ts":1763518022320,"senderName":"Christian Ulbrich","senderId":"@christianulbrich:matrix.org","id":"$du-oFGP_4bk38VGFq_lm3VJ34LkjUYXee9jOcmhwBEo"},
{"content":{"body":"i would hope that composites are never mutable","m.mentions":{},"msgtype":"m.text"},"ts":1763518045289,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$P-nXZiwzRMpzoM1I-CQ12aUpimHYgyMK3Bm2Ldu1qZI"},
{"content":{"body":"in either case","m.mentions":{},"msgtype":"m.text"},"ts":1763518048772,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$DSMMmh9UaG4Fiu1-fMlj7BXLBTnRfmmwecInUqThxNM"},
{"content":{"body":"No, those two wallets are different objects, so the composites are different","m.mentions":{"user_ids":["@christianulbrich:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$du-oFGP_4bk38VGFq_lm3VJ34LkjUYXee9jOcmhwBEo"}},"msgtype":"m.text"},"ts":1763518053260,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$8-7SpVt5iosZouASmmhA2lq74VNGVkhkax0y51J89uI"},
{"content":{"body":"You need nested composites, right?","format":"org.matrix.custom.html","formatted_body":"You need nested composites, right?","m.mentions":{"user_ids":["@christianulbrich:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$du-oFGP_4bk38VGFq_lm3VJ34LkjUYXee9jOcmhwBEo"}},"msgtype":"m.text"},"ts":1763518056007,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$z8gDiuWF9XKHR1urEbwIITp96zkmg2TwpOwM0_ytb04"},
{"content":{"body":"* so ```\nlet c1 = Composite({wallet: amount: 20});  \nlet c2 = Composite({wallet: amount: 20}); \nc1 === c2; // true \nc1.wallet.amount+=20;\n c1 === c2 // ?? \n```","format":"org.matrix.custom.html","formatted_body":"* <p>so ```<br>let c1 = Composite({wallet: amount: 20});<br>\nlet c2 = Composite({wallet: amount: 20});<br>c1 === c2; // true<br>c1.wallet.amount+=20;<br>c1 === c2 // ??</p>\n<pre><code></code></pre>\n","m.mentions":{},"m.new_content":{"body":"so ```\nlet c1 = Composite({wallet: amount: 20});  \nlet c2 = Composite({wallet: amount: 20}); \nc1 === c2; // true \nc1.wallet.amount+=20;\n c1 === c2 // ?? \n```","format":"org.matrix.custom.html","formatted_body":"<p>so ```<br>let c1 = Composite({wallet: amount: 20});<br>\nlet c2 = Composite({wallet: amount: 20});<br>c1 === c2; // true<br>c1.wallet.amount+=20;<br>c1 === c2 // ??</p>\n<pre><code></code></pre>\n","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$du-oFGP_4bk38VGFq_lm3VJ34LkjUYXee9jOcmhwBEo","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763518058167,"senderName":"Christian Ulbrich","senderId":"@christianulbrich:matrix.org","id":"$GN8k2rMi5iay7OLw6edNJqFoQ3Myir7tJpfs5HFrgAE"},
{"content":{"body":"But these would be the same:\n```\nlet wallet = Composite({ amount: 20 });\nlet c1 = Composite({ wallet });\nlet c2 = Composite({ wallet });\n```","format":"org.matrix.custom.html","formatted_body":"<p>But these would be the same:</p>\n<pre><code>let wallet = Composite({ amount: 20 });\nlet c1 = Composite({ wallet });\nlet c2 = Composite({ wallet });\n</code></pre>\n","m.mentions":{},"msgtype":"m.text"},"ts":1763518079060,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$ExSycJbluiZrUd8Z5c4NNTyPfJiY-TdKsB7BMDTuQ3U"},
{"content":{"body":"* But these would be the same:\n\n```\nlet wallet =({ amount: 20 });\nlet c1 = Composite({ wallet });\nlet c2 = Composite({ wallet });\n```","format":"org.matrix.custom.html","formatted_body":"* <p>But these would be the same:</p>\n<pre><code>let wallet =({ amount: 20 });\nlet c1 = Composite({ wallet });\nlet c2 = Composite({ wallet });\n</code></pre>\n","m.mentions":{},"m.new_content":{"body":"But these would be the same:\n\n```\nlet wallet =({ amount: 20 });\nlet c1 = Composite({ wallet });\nlet c2 = Composite({ wallet });\n```","format":"org.matrix.custom.html","formatted_body":"<p>But these would be the same:</p>\n<pre><code>let wallet =({ amount: 20 });\nlet c1 = Composite({ wallet });\nlet c2 = Composite({ wallet });\n</code></pre>\n","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$ExSycJbluiZrUd8Z5c4NNTyPfJiY-TdKsB7BMDTuQ3U","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763518085991,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$okQvimsF8Jn43ST7qY_9jwnEyK_Fd1nOhcKXW7I5xgw"},
{"content":{"body":"The alternative is `wallet = { amount: 20 }; c1 = Composite({ `â€¦ Nicolo beat me to it.","format":"org.matrix.custom.html","formatted_body":"The alternative is <code data-md=\"`\">wallet = { amount: 20 }; c1 = Composite({ </code>â€¦ Nicolo beat me to it.","m.mentions":{},"msgtype":"m.text"},"ts":1763518089414,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$mIdIhdgavwysFkhBDzfVjUzp1CZYujFY8CuQ3F60Gi0"},
{"content":{"body":"* But these would be the same:\n\n```\nlet wallet = { amount: 20 };\nlet c1 = Composite({ wallet });\nlet c2 = Composite({ wallet });\n```","format":"org.matrix.custom.html","formatted_body":"* <p>But these would be the same:</p>\n<pre><code>let wallet = { amount: 20 };\nlet c1 = Composite({ wallet });\nlet c2 = Composite({ wallet });\n</code></pre>\n","m.mentions":{},"m.new_content":{"body":"But these would be the same:\n\n```\nlet wallet = { amount: 20 };\nlet c1 = Composite({ wallet });\nlet c2 = Composite({ wallet });\n```","format":"org.matrix.custom.html","formatted_body":"<p>But these would be the same:</p>\n<pre><code>let wallet = { amount: 20 };\nlet c1 = Composite({ wallet });\nlet c2 = Composite({ wallet });\n</code></pre>\n","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$ExSycJbluiZrUd8Z5c4NNTyPfJiY-TdKsB7BMDTuQ3U","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763518103104,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$nzYoZePEez3Dv4RVEJt9E8k27AWqcA2iVL5777A6bog"},
{"content":{"body":"Yeah, 100%","m.mentions":{"user_ids":["@jridgewell:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$3YxkOspYI4s05AqHKRsHd8STnFsuqH_Q6HK7qKZWCfE"}},"msgtype":"m.text"},"ts":1763518331659,"senderName":"keith_miller","senderId":"@keith_miller:matrix.org","id":"$ZSa1hQ6NLX-uk3F0RjE7sHJYMrzqm_VpEeMPhWSIAtM"},
{"content":{"body":"Mathieu Hofman: We also have current _custom Iterability_ with `Symbol.iterator`.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@mhofman:matrix.org\">Mathieu Hofman</a>: We also have current <em>custom Iterability</em> with <code>Symbol.iterator</code>.","m.mentions":{"user_ids":["@mhofman:matrix.org"]},"msgtype":"m.text"},"ts":1763518342238,"senderName":"Christian Ulbrich","senderId":"@christianulbrich:matrix.org","id":"$bBZaqe9eDGtuEwvDzY-VwD7STaARDVzR6gran7A-Xls"},
{"content":{"body":"please do not look at the current spec, it means nothing","m.mentions":{"user_ids":["@mgaudet:mozilla.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$udZJLV_TmyPVGGBMMSTgWbfIvEo5B3mNLF3FdmODXno"}},"msgtype":"m.text"},"ts":1763518342939,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$4u5pE0EN5n9CPllYst5JnpNRxNaY5Up6wV9iI86qQnQ"},
{"content":{"body":"I should remove it","m.mentions":{},"msgtype":"m.text"},"ts":1763518344510,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$Yb5OV5oXbLvqM4_GwjyI4xx5UiyDMYDOYEbkcmJj5Co"},
{"content":{"body":"@olivf.o1o.ch:immer.chat Does V8 have this same problem?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@olivf.o1o.ch:immer.chat\">@Olivier FlÃ¼ckiger</a> Does V8 have this same problem?","m.mentions":{"user_ids":["@olivf.o1o.ch:immer.chat","@keith_miller:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$ZSa1hQ6NLX-uk3F0RjE7sHJYMrzqm_VpEeMPhWSIAtM"}},"msgtype":"m.text"},"ts":1763518358595,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$qM--Vpjs4tBPzZZphJmtrqD6D6lBcdpHePBO8z3ybao"},
{"content":{"body":"In particular because you have to do n shape checks for each of the different views","m.mentions":{},"msgtype":"m.text"},"ts":1763518358871,"senderName":"keith_miller","senderId":"@keith_miller:matrix.org","id":"$s1BT1Eb4mMmuhtuJ1MtNvUpiq9nVIIBAumkckyEwnIU"},
{"content":{"body":"Should we be splitting the methods onto the sepcific TA subtype classes?","m.mentions":{},"msgtype":"m.text"},"ts":1763518379092,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$AyKDaSbVKfZllZPmnSJKIGWeiJGcdl4IZCQE1amg61E"},
{"content":{"body":"That is ok-ish. The place it shows up in syntax (array spread) was a mistake","m.mentions":{"user_ids":["@christianulbrich:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$bBZaqe9eDGtuEwvDzY-VwD7STaARDVzR6gran7A-Xls"}},"msgtype":"m.text"},"ts":1763518381315,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$cCe1TsRkKZ7y2GgUpRt2u7fNQjEaOZLHlDqaSHhKlL0"},
{"content":{"body":"Sometimes it will get inlined enough that we can prove only one shape shows up but there's many examples I've seen where that doesn't happen","m.mentions":{},"m.relates_to":{"m.in_reply_to":{"event_id":"$s1BT1Eb4mMmuhtuJ1MtNvUpiq9nVIIBAumkckyEwnIU"}},"msgtype":"m.text"},"ts":1763518424628,"senderName":"keith_miller","senderId":"@keith_miller:matrix.org","id":"$0J3eG09MvUwQsaEk8vpla2_Tpj9QHbH7S2EsDzmGVaE"},
{"content":{"body":"my memory of v8 is that it generally does a switch over different object kinds. i guess that could be compiled to a bunch of if/else branches but hopefully it does better than ","m.mentions":{},"msgtype":"m.text"},"ts":1763518474186,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$N6IVCSiVJClL-_R1KP4pCE2KufYyeFpT6F1GNdD3Cds"},
{"content":{"body":"* my memory of v8 is that it generally does a switch over different object kinds. i guess that could be compiled to a bunch of if/else branches but hopefully it does better than that","m.mentions":{},"m.new_content":{"body":"my memory of v8 is that it generally does a switch over different object kinds. i guess that could be compiled to a bunch of if/else branches but hopefully it does better than that","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$N6IVCSiVJClL-_R1KP4pCE2KufYyeFpT6F1GNdD3Cds","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763518479613,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$WA77a0YnyyCtqix0h6eGOknm60KembK2eQ8qdkRxWF8"},
{"content":{"body":"which is certainly still some overhead, but its not a function of the number of things you're switching over","m.mentions":{},"msgtype":"m.text"},"ts":1763518512352,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$pXbNctBy7s61ZzpKwcj6az9-WcoEQvkpulwnMw1NL_o"},
{"content":{"body":"Mathieu Hofman: `Array.prototype[Symbol.iterator] = function* () { yield 2; yield 3; }`","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@mhofman:matrix.org\">Mathieu Hofman</a>: <code>Array.prototype[Symbol.iterator] = function* () { yield 2; yield 3; }</code>","m.mentions":{"user_ids":["@mhofman:matrix.org"]},"msgtype":"m.text"},"ts":1763518537047,"senderName":"Christian Ulbrich","senderId":"@christianulbrich:matrix.org","id":"$2JgE4OJuTNlMH8H_KGK9ouaPbV58PSBVgN3hFykeCws"},
{"content":{"body":"The problem is that you also need to make the index access polymorphic","m.mentions":{},"msgtype":"m.text"},"ts":1763518545211,"senderName":"keith_miller","senderId":"@keith_miller:matrix.org","id":"$opafoHr-4MIgEBAWD0jlCF6-ovBpW8I4BmZuKwnb6OE"},
{"content":{"body":"So it's not just a check you're in bounds and load","m.mentions":{},"msgtype":"m.text"},"ts":1763518558442,"senderName":"keith_miller","senderId":"@keith_miller:matrix.org","id":"$U0p-ksfSrGd6wlHUwZGcPjWD1ZML6FIskocDSFFWC1E"},
{"content":{"body":"It's a switch over the element size then pick the right load for the active size","m.mentions":{},"msgtype":"m.text"},"ts":1763518573541,"senderName":"keith_miller","senderId":"@keith_miller:matrix.org","id":"$qkF9UZI_tFyscbh3zfaVVA4M5wya4kXT-np5fU2mxuM"},
{"content":{"body":"yeah it remains polymorphic until it can be found to be exactly 1 kind","m.mentions":{},"msgtype":"m.text"},"ts":1763518584872,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$j7G2YVstMP74YgxfLuAU0jHsnYfhsMp9_F_3Enf3Jm4"},
{"content":{"body":"Right but that wouldn't be a problem if each of the views had their own copy of the various methods","m.mentions":{},"msgtype":"m.text"},"ts":1763518609387,"senderName":"keith_miller","senderId":"@keith_miller:matrix.org","id":"$zXuo0z56dQzovS61pLMBUmjcUB3-VXVbsyUx-WaWQbo"},
{"content":{"body":"Mathieu Hofman: What I am trying to say, and I am leaning towards some, what I think Ron said, custom equality is not a bad thing per sÃ¨. We already have so many things in the language, that are powerful.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@mhofman:matrix.org\">Mathieu Hofman</a>: What I am trying to say, and I am leaning towards some, what I think Ron said, custom equality is not a bad thing per sÃ¨. We already have so many things in the language, that are powerful.","m.mentions":{"user_ids":["@mhofman:matrix.org"]},"msgtype":"m.text"},"ts":1763518655801,"senderName":"Christian Ulbrich","senderId":"@christianulbrich:matrix.org","id":"$zw7vr86OV6Pw5Gewyz-K9Z9Ngi64fqaTWd_WENy9eig"},
{"content":{"body":"Letâ€™s fix that. Doing something for convenience in the spec is much less important that actual impl difficulties.","m.mentions":{},"msgtype":"m.text"},"ts":1763518658873,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$O9aASOv1t9oQU-M1Iq-ik5-ymwuC7Ilv5HMgBhNxbOk"},
{"content":{"body":"its definitely web reality at this point","m.mentions":{},"msgtype":"m.text"},"ts":1763518681386,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$AOJB8vaVg0rILp9152weCUfmmW0rYRDK5LZy4sqZbdQ"},
{"content":{"body":"There's some compatibility risk although I don't know how high it is in practice","m.mentions":{},"msgtype":"m.text"},"ts":1763518682863,"senderName":"keith_miller","senderId":"@keith_miller:matrix.org","id":"$WwU0SMt1nekUZUlR_GjuI8_dobKKuaMijLy4PmoTeEE"},
{"content":{"body":"i've seen code in the wild using TypedArray.prototype.foo.call","m.mentions":{},"msgtype":"m.text"},"ts":1763518712867,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$CW3h6ppysytCU4WTd4CB9gcos3zL_cB_3DtWh9EdxQM"},
{"content":{"body":"actually i guess that doesn't actually preclude adding more methods","m.mentions":{},"msgtype":"m.text"},"ts":1763518733340,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$-0PSroC7OIRcsuRCGtDFFROgVUOmRc2NTRWE2VuoyK4"},
{"content":{"body":"Maybe you could just shadow the current one","m.mentions":{},"msgtype":"m.text"},"ts":1763518744110,"senderName":"keith_miller","senderId":"@keith_miller:matrix.org","id":"$jPWdoHAVVvus2mFt_XERD6tM_Q8BUy_zMXmJxdsZA8k"},
{"content":{"body":"* actually i guess that doesn't actually preclude adding more methods on the subclasses","m.mentions":{},"m.new_content":{"body":"actually i guess that doesn't actually preclude adding more methods on the subclasses","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$-0PSroC7OIRcsuRCGtDFFROgVUOmRc2NTRWE2VuoyK4","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763518745199,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$ZXHnx5v8tovWldXdCq--rFAYytCF6zAUEjCoZ0fw3ig"},
{"content":{"body":"It would be weird but I doubt anyone would really know","m.mentions":{},"msgtype":"m.text"},"ts":1763518759585,"senderName":"keith_miller","senderId":"@keith_miller:matrix.org","id":"$N3khxchziCDuluz1Vi9m06JH-BwQob7BG_od39YEREs"},
{"content":{"body":"we did a similar change moving around where some error properties were located in webkit and chrome and no one noticed","m.mentions":{},"msgtype":"m.text"},"ts":1763518803225,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$qx__IzvxGyMrq6VkHYajuwxe5pw3CWaEC69bqWNfSuc"},
{"content":{"body":"That's just prototype pollution. Which is a much more general problem. But yeah you could have an array instance with an shadowed Symbol.iterator that does something weird, and I don't like that array spread would be affected by that.","m.mentions":{"user_ids":["@christianulbrich:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$2JgE4OJuTNlMH8H_KGK9ouaPbV58PSBVgN3hFykeCws"}},"msgtype":"m.text"},"ts":1763518816293,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$vQ5TT9Ghkik2WcocSpZy8n-iMt6149G-bRpeHlJwDJg"},
{"content":{"body":"I think it is not weird to get custom behavior when spreading an object which happens to be IsArray but which has a custom `Symbol.iterator`","format":"org.matrix.custom.html","formatted_body":"I think it is not weird to get custom behavior when spreading an object which happens to be IsArray but which has a custom <code>Symbol.iterator</code>","m.mentions":{},"msgtype":"m.text"},"ts":1763518889626,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$jUPFbm_IgLcm-1cZ6MzKJyWcoJe1AXOQ_Oxzpcfv35Y"},
{"content":{"body":"as to the Array prototype Symbol.iterator pollution problem, I have a proposal for fixing that!","m.mentions":{},"msgtype":"m.text"},"ts":1763518918076,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$LzawGoFan655oeRopIQmtnn4puMf-JBtwZ0PN2tBXZ4"},
{"content":{"body":"ah actually it was the opposite direction https://github.com/WebKit/WebKit/commit/96efcf1f1c011efd5946d053272581e0a3d6c3b2 (my only webkit commit ðŸ˜„)","m.mentions":{},"m.relates_to":{"m.in_reply_to":{"event_id":"$qx__IzvxGyMrq6VkHYajuwxe5pw3CWaEC69bqWNfSuc"}},"msgtype":"m.text"},"ts":1763518939247,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$9GOjpnWs61WEDE-MezR6WlEF8LQh2FjKuBgo00Bb41w"},
{"content":{"body":"What exactly is the spec convenience we are talking about? That they all share a common proto?","m.mentions":{"user_ids":["@jridgewell:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$qM--Vpjs4tBPzZZphJmtrqD6D6lBcdpHePBO8z3ybao"}},"msgtype":"m.text"},"ts":1763519735208,"senderName":"Olivier FlÃ¼ckiger","senderId":"@olivf.o1o.ch:immer.chat","id":"$en5YKAY86NGb10vezAx8EDVOFMmO2jXDEXV9e7q92kQ"},
{"content":{"body":"Looks like, _native equality_ comes quite at some cost, of those _interned objects_ not being so _native_ anymore...","format":"org.matrix.custom.html","formatted_body":"Looks like, <em>native equality</em> comes quite at some cost, of those <em>interned objects</em> not being so <em>native</em> anymore...","m.mentions":{},"msgtype":"m.text"},"ts":1763519742722,"senderName":"Christian Ulbrich","senderId":"@christianulbrich:matrix.org","id":"$Toi5KEoMfbQPDK5ofDu7vYPcMZkqd1mldChpyQasc0g"},
{"content":{"body":"Yah, and the methods are defined on the common proto","format":"org.matrix.custom.html","formatted_body":"Yah, and the methods are defined on the common proto","m.mentions":{"user_ids":["@olivf.o1o.ch:immer.chat"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$en5YKAY86NGb10vezAx8EDVOFMmO2jXDEXV9e7q92kQ"}},"msgtype":"m.text"},"ts":1763519943574,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$XagM8z_Jo5qpxI_X8EOqWq4EXRdvawD4VyBeyg2FAIk"},
{"content":{"body":"Though apparently index access is also slower than it should be","format":"org.matrix.custom.html","formatted_body":"Though apparently index access is also slower than it should be","m.mentions":{"user_ids":["@keith_miller:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$opafoHr-4MIgEBAWD0jlCF6-ovBpW8I4BmZuKwnb6OE"}},"msgtype":"m.text"},"ts":1763520000351,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$JUrscMDGA9gB41VCnSPU3J-d6pydOv8lZdONLkqvgtY"},
{"content":{"body":"Would this be a first for the language? Is there any object, that is specially handled somewhere, somehow, besides being an object, I mean apart from `null`?","format":"org.matrix.custom.html","formatted_body":"Would this be a first for the language? Is there any object, that is specially handled somewhere, somehow, besides being an object, I mean apart from <code>null</code>?","m.mentions":{},"msgtype":"m.text"},"ts":1763520224648,"senderName":"Christian Ulbrich","senderId":"@christianulbrich:matrix.org","id":"$enIxVjiRmEQD0vHt-gjVxkfLl7eFeBknEaR4nOAJDt8"},
{"content":{"body":"It's probably not our main worry for TA... But in principle all for not doing convenience in the spec if it makes implementation harder.","m.mentions":{},"msgtype":"m.text"},"ts":1763520227103,"senderName":"Olivier FlÃ¼ckiger","senderId":"@olivf.o1o.ch:immer.chat","id":"$7jWDVfJ-GPDFS5DzmNf3GiPFqklBMyiANFl6eHNh-So"},
{"content":{"body":"also worth mentioning that a lot of TA baggage comes from khronos :P","m.mentions":{},"msgtype":"m.text"},"ts":1763520384613,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$geFD4Pf_rYi0HYfHxlQZwI4xulA43DZ4S1tSpqKZxGM"},
{"content":{"body":"* also worth mentioning that a lot of TA baggage comes from khronos, not necessarily people making convenient spec decisions :P","m.mentions":{},"m.new_content":{"body":"also worth mentioning that a lot of TA baggage comes from khronos, not necessarily people making convenient spec decisions :P","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$geFD4Pf_rYi0HYfHxlQZwI4xulA43DZ4S1tSpqKZxGM","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763520401338,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$sRXDVbJvzEiWJ59pZYlLaoFSSErBTeP43TLV2jc3Nnw"},
{"content":{"body":"`document.all`","format":"org.matrix.custom.html","formatted_body":"<code>document.all</code>","m.mentions":{"user_ids":["@christianulbrich:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$enIxVjiRmEQD0vHt-gjVxkfLl7eFeBknEaR4nOAJDt8"}},"msgtype":"m.text"},"ts":1763520521342,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$9WNFLdbngCR8xO14XAQSkWq7rTnctzpFz_Sm2suxv3Q"},
{"content":{"body":"khronos?","format":"org.matrix.custom.html","formatted_body":"khronos?","m.mentions":{"user_ids":["@devsnek:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$geFD4Pf_rYi0HYfHxlQZwI4xulA43DZ4S1tSpqKZxGM"}},"msgtype":"m.text"},"ts":1763520546689,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$swJOMgLQhQJgzMI1LtWl4rRp6osQGyS1KDTlHJo_TOE"},
{"content":{"body":"> \"Khronos typed arrays\" refers to the JavaScript Typed Arrays specification, which was originally developed under the Khronos Group for use in its graphics APIs like WebGL\n\n(google ai summary)","format":"org.matrix.custom.html","formatted_body":"<blockquote>\n<p>\"Khronos typed arrays\" refers to the JavaScript Typed Arrays specification, which was originally developed under the Khronos Group for use in its graphics APIs like WebGL</p>\n</blockquote>\n<p>(google ai summary)</p>\n","m.mentions":{},"msgtype":"m.text"},"ts":1763520586648,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$UHtnzJaGxffiCALvhLtZqTO9al-un-XZn7aFfVS0Eig"},
{"content":{"body":"yes they were developed for webgl and later merged into ecma262","m.mentions":{},"msgtype":"m.text"},"ts":1763520620258,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$ejK3fla3FlQ5W87lQtCYG4WLytcDmAEfIOJdVwFwqYo"},
{"content":{"body":"that's the origin of all the detachedness f-ery","m.mentions":{},"msgtype":"m.text"},"ts":1763520645597,"senderName":"rkirsling","senderId":"@rkirsling:matrix.org","id":"$ZwQ2wdranh2HHeU0wSegxlrDEB7rR9QRnMUzACLA2e8"},
{"content":{"body":"ljharb: In what context? This is a DOM API.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@ljharb:matrix.org\">ljharb</a>: In what context? This is a DOM API.","m.mentions":{"user_ids":["@ljharb:matrix.org"]},"msgtype":"m.text"},"ts":1763520668187,"senderName":"Christian Ulbrich","senderId":"@christianulbrich:matrix.org","id":"$Sb34maTtAgSZXzUOpFEfJ6GW1bcj2MV10RHzDXvWqmI"},
{"content":{"body":"https://tc39.es/ecma262/multipage/additional-ecmascript-features-for-web-browsers.html#sec-IsHTMLDDA-internal-slot","format":"org.matrix.custom.html","formatted_body":"https://tc39.es/ecma262/multipage/additional-ecmascript-features-for-web-browsers.html#sec-IsHTMLDDA-internal-slot","m.mentions":{"user_ids":["@christianulbrich:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$Sb34maTtAgSZXzUOpFEfJ6GW1bcj2MV10RHzDXvWqmI"}},"msgtype":"m.text"},"ts":1763520734000,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$7GW8b2K5JFUOsm6xaiSYpcSUGXZcFvyJTq6tcYv8XF8"},
{"content":{"body":"â€œIs HTML Document Dot All\"","m.mentions":{},"msgtype":"m.text"},"ts":1763520748207,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$Si3Rm8wO4ZFybYwuLe3DvbYzl1z_8Z957zWBSpLoFa8"},
{"content":{"body":"In the case ljharb describes, where developers know about weirdness or already have something wrong, throwing seems better?","msgtype":"m.text"},"ts":1763520767122,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$Bk5X7qA4pVyXJd7v9ru1OWSvzJZm94UMMvfIAaZs5ZA"},
{"content":{"body":"throw as early as possible","m.mentions":{},"msgtype":"m.text"},"ts":1763520787883,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$rcTjkt8ot34nx3j2FvDCi9oY73HV-5cq1SkPctXTP_M"},
{"content":{"body":"Like I cannot imagine wanting to leak here, on purpose","msgtype":"m.text"},"ts":1763520788357,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$GS2_tzzW_f7lWzWbyfqLvlkNuXZGnLO7Vk8JyBZZEEM"},
{"content":{"body":"If someone doesn't know about this they should learn by the language telling them","msgtype":"m.text"},"ts":1763520805636,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$6CHxYHbihQTkqA4Yc0zC68j9Dc49aEfuTsTt5DkFw3s"},
{"content":{"body":"Not by mysterious leaks","msgtype":"m.text"},"ts":1763520831643,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$KrHfEhuBhKS-I-Hx9uI88bb-TlOtWGsN99LqRW2aUIQ"},
{"content":{"body":"i mean an alternative would just be, require composites to have at least 1 object","m.mentions":{},"msgtype":"m.text"},"ts":1763520834232,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$spzW_8pVZKFCS_oKwFgG4WIPK3SGlEADR1tC-OTnC1s"},
{"content":{"body":"That is also terrible ","msgtype":"m.text"},"ts":1763520843957,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$5J9vHtyKswvPd4AMq764-GO7oxjbRGu9i8japI6PRCU"},
{"content":{"body":"why?","m.mentions":{},"msgtype":"m.text"},"ts":1763520847761,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$9o6S8A8nOOfQ3gBy3vtRc1Oay7qBYRaoY2LIFE8stqc"},
{"content":{"body":"because it breaks them","m.mentions":{},"msgtype":"m.text"},"ts":1763520857964,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$_9P2dmZmTJRJpNQByNCKFHodttEeibDqgJsh_Bp1ZWY"},
{"content":{"body":"no existing code uses composites, how does that break anything","m.mentions":{},"msgtype":"m.text"},"ts":1763520869777,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$SLxbouWTba6PWTqxifLWJ0yVEW8A0qLazbJTuM_KfIs"},
{"content":{"body":"Because you want to be able to use them for, like, pairs of numbers","msgtype":"m.text"},"ts":1763520870907,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$v8CklrPwpgHw7h0zFqU0SvD3H8S1WReyWjbGTcX0R6Q"},
{"content":{"body":"if you want a composite of primitive types you then need to keep around some special identity object to put in them","m.mentions":{},"msgtype":"m.text"},"ts":1763520873217,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$mRRzzZB5bGFW7gnvpGQ9P6QGPFQcq292rDR1JJk9EYs"},
{"content":{"body":"Coordinates in a map, eg ","msgtype":"m.text"},"ts":1763520879861,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$YsmLyH84u-9GbXUnzvf7UJ5lh3yo4Pqmoa5EmxTbX3E"},
{"content":{"body":"make one symbol and stick it in every composite","m.mentions":{},"msgtype":"m.text"},"ts":1763520898266,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$F0szJhk2ESX2SwsETSgvZF-VZ_jyW0IJRlKmeT49CAc"},
{"content":{"body":"That is so bad","msgtype":"m.text"},"ts":1763520931744,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$j2KTpQKWT_V9V60MeOnp90clSeH6aU2PDk7JoCoq2yI"},
{"content":{"body":"I find waldemar argument convincing. If we have _prior art_ of handling something specifically (although I think the `document.all` to be very _exotic_ (hihi)), then I'd rather prefer a _fail-fast_ approach, then having to accept memory leaks.","format":"org.matrix.custom.html","formatted_body":"I find <a href=\"https://matrix.to/#/@waldemarh:matrix.org\">waldemar</a> argument convincing. If we have <em>prior art</em> of handling something specifically (although I think the <code>document.all</code> to be very <em>exotic</em> (hihi)), then I'd rather prefer a <em>fail-fast</em> approach, then having to accept memory leaks.","m.mentions":{"user_ids":["@waldemarh:matrix.org"]},"msgtype":"m.text"},"ts":1763520944215,"senderName":"Christian Ulbrich","senderId":"@christianulbrich:matrix.org","id":"$EK5WnsJMwElBEHpwJRX1JilXfqo7fglVhtPAyaRpIOY"},
{"content":{"body":"imo it's far less bad than making some objects not be weakable","m.mentions":{},"msgtype":"m.text"},"ts":1763520953504,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$IPPN_OJ0rqg-r44T7NAYHjs29xjwR3WlMZkT83k2Xo0"},
{"content":{"body":"The benefit of keeping the consistency for weak maps is so, so far from being with the cost of having to do that","msgtype":"m.text"},"ts":1763520961666,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$B2O0Ia6v5Xza18NKOwDK3fkElSj_3vrDy_cmodtmHoA"},
{"content":{"body":"IsHTMLDDA is like, one of the most horrifying things in the web platform, to be certain","m.mentions":{},"msgtype":"m.text"},"ts":1763520992147,"senderName":"rkirsling","senderId":"@rkirsling:matrix.org","id":"$MIG8gnrkqH6DBO6YDpk_M_7UBu1h40gA0r-4IxMFu3Q"},
{"content":{"body":"As you already pointed out, weak maps are super niche!","msgtype":"m.text"},"ts":1763520994431,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$KBUEv5nylv_jK2dsWXecAmJpLRimP67qch3oQ_1fjYw"},
{"content":{"body":"to me this all seems to lead back to \"they need to be primitives or they shouldn't exist in the language\"","m.mentions":{},"msgtype":"m.text"},"ts":1763520994566,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$OyOYUZT2mCojD3jC7jEp3gM-9GGug_rHJN3r_OrOuys"},
{"content":{"body":"* The benefit of keeping the consistency for weak maps is so, so far from being worth the cost of having to do that","m.new_content":{"body":"The benefit of keeping the consistency for weak maps is so, so far from being worth the cost of having to do that","msgtype":"m.text"},"m.relates_to":{"event_id":"$B2O0Ia6v5Xza18NKOwDK3fkElSj_3vrDy_cmodtmHoA","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763521013170,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$trF0bxJoO2wWzEBD5yCUy06fkd3QdFkooWS9OkPY2So"},
{"content":{"body":"* document.all is like, one of the most horrifying things in the web platform, to be certain; that's why [[IsHTMLDDA]] is a sort of resentment-coded name","m.mentions":{},"m.new_content":{"body":"document.all is like, one of the most horrifying things in the web platform, to be certain; that's why [[IsHTMLDDA]] is a sort of resentment-coded name","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$MIG8gnrkqH6DBO6YDpk_M_7UBu1h40gA0r-4IxMFu3Q","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763521014161,"senderName":"rkirsling","senderId":"@rkirsling:matrix.org","id":"$rN9MptCXGN18NNGgQDIF8WeFXAR-cMlN5kgBYQCTpWU"},
{"content":{"body":"we shouldn't commit minor crimes just because the thing we want to add shouldn't be an object but is forced to be one","m.mentions":{},"msgtype":"m.text"},"ts":1763521040219,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$zKJaBuJUYymP6ImGhkZuLwIwGt0CRBZjkkoK3VGPef0"},
{"content":{"body":"Ok that is a position you could have, but at that point this question does not matter","msgtype":"m.text"},"ts":1763521077540,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$609UBjMzs72Jx-YDqsaER6gsO08XWRuHophrDlyYpMM"},
{"content":{"body":"i don't find weakmaps to be the fundamental primitive by which i decide what a value is. rather weakmap is a somewhat strange api that exposes the reality of values.","m.mentions":{},"msgtype":"m.text"},"ts":1763521083732,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$80m7gJeE1y0bnhhteIY7NA1SOLcD5TaUlJorFkCddmI"},
{"content":{"body":"* i don't find weakmaps to be the fundamental primitive by which i decide what a value is. rather weakmap is a somewhat strange api /becausae/ it exposes the reality of values.","m.mentions":{},"m.new_content":{"body":"i don't find weakmaps to be the fundamental primitive by which i decide what a value is. rather weakmap is a somewhat strange api /becausae/ it exposes the reality of values.","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$80m7gJeE1y0bnhhteIY7NA1SOLcD5TaUlJorFkCddmI","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763521089687,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$nEmD5CSWmVzaURbHjUUmYbyfCnTMVgE4pPCXooHjLKc"},
{"content":{"body":"We are talking about what happens assuming that isn't the world we're in","msgtype":"m.text"},"ts":1763521092277,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$FnzNEmlKB1Uds8DEMwSjOF0n_7tvxzlwYlm_kpgLU2w"},
{"content":{"body":"I have a feeling, that the discussion is very academic. What would be a real-world library using WeakSets that would be easily affected by this?","m.mentions":{},"msgtype":"m.text"},"ts":1763521122597,"senderName":"Christian Ulbrich","senderId":"@christianulbrich:matrix.org","id":"$SzcmKUBQQ89dSFUBhAZHVk_OJvTJPf7WXgadSR8kZwE"},
{"content":{"body":"* i don't find weakmaps to be the fundamental primitive by which i decide what a value is. rather weakmap is a somewhat strange api /because/ it exposes the reality of values.","m.mentions":{},"m.new_content":{"body":"i don't find weakmaps to be the fundamental primitive by which i decide what a value is. rather weakmap is a somewhat strange api /because/ it exposes the reality of values.","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$80m7gJeE1y0bnhhteIY7NA1SOLcD5TaUlJorFkCddmI","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763521128398,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$FoDDoe5jYA4AplzRa6kkCSVqwDksqF7ef_830f5NHBA"},
{"content":{"body":"also what would be a real-world application where this would be the biggest memory leak in the app","m.mentions":{},"msgtype":"m.text"},"ts":1763521153838,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$nZ4Pa93AOuXDKy2F3BqHmsr17wBi5rRiRd_aLhYVkLQ"},
{"content":{"body":"kinda feel sorry for Yusuke's queue item getting shoved to the bottom","m.mentions":{},"msgtype":"m.text"},"ts":1763521154517,"senderName":"rkirsling","senderId":"@rkirsling:matrix.org","id":"$_B6zLiyc-Pf8hX9B7A9PbIvJTEdTRnLRfqy715UBmgc"},
{"content":{"body":"fwiw most use of weak apis do not deal with arbitrary values","m.mentions":{},"msgtype":"m.text"},"ts":1763521158284,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$kfmAvzC1kRdZPj6K1UOoH4yKzJVXlYCfwOlfejDKlPc"},
{"content":{"body":"* fwiw most use of weak apis do not deal with arbitrary values, they are almost always contained within a single layer of an application","m.mentions":{},"m.new_content":{"body":"fwiw most use of weak apis do not deal with arbitrary values, they are almost always contained within a single layer of an application","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$kfmAvzC1kRdZPj6K1UOoH4yKzJVXlYCfwOlfejDKlPc","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763521168308,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$KzT4_a-BNQ2gr27MnBLLPZ7S9gRtbyH-SLxR8ElvuZU"},
{"content":{"body":"* fwiw most use of weak apis do not deal with arbitrary values, they are almost always contained within a single layer of a codebase","m.mentions":{},"m.new_content":{"body":"fwiw most use of weak apis do not deal with arbitrary values, they are almost always contained within a single layer of a codebase","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$kfmAvzC1kRdZPj6K1UOoH4yKzJVXlYCfwOlfejDKlPc","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763521173609,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$t1_qi4e7vIco6dPCP4E7QihK1Qp0itmxxLz4QQFk2Wc"},
{"content":{"body":"why is Yusuke's topic kept pushing down the queue?","m.mentions":{},"msgtype":"m.text"},"ts":1763521183473,"senderName":"Chengzhong Wu","senderId":"@legendecas:matrix.org","id":"$DamJRP53vM0ayShgarkS0Z0UxqjV2cw8XI56oCMqAtA"},
{"content":{"body":"* why is Yusuke's topic kept pushing down the queue? feel like new topics are added before Yusuke's","m.mentions":{},"m.new_content":{"body":"why is Yusuke's topic kept pushing down the queue? feel like new topics are added before Yusuke's","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$DamJRP53vM0ayShgarkS0Z0UxqjV2cw8XI56oCMqAtA","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763521241633,"senderName":"Chengzhong Wu","senderId":"@legendecas:matrix.org","id":"$SC9WbBtzcGayOa-146Pqxvj3T7FMJ57hUP77rEzc51c"},
{"content":{"body":"Next time we talk about this I vote implementations get priority ","msgtype":"m.text"},"ts":1763521253411,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$VXkBeJq-W4Vwh5JtqWDKQI2V7qnh8XuBEnXaXUK69hI"},
{"content":{"body":"We should really not add objects that cannot be collected. Websites running out of memory is really a terrible issue to debug for all parties involved.","m.mentions":{},"msgtype":"m.text"},"ts":1763521282684,"senderName":"Olivier FlÃ¼ckiger","senderId":"@olivf.o1o.ch:immer.chat","id":"$z9_Ak3JMnaHsvPbyXChhR1sKL0iG5-I-bupxvmcu9NQ"},
{"content":{"body":"I care a lot more about what is implementable than about our design opinions unconstrained by implementation reality","msgtype":"m.text"},"ts":1763521289317,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$PgaqRKwxaYj8CJHKhl97wZpimrYVUc2fD9Wfi_BJsg0"},
{"content":{"body":"it is easy to imagine, for example, something which is serializing values to be passed to and from a worker, and uses a WeakMap to cache the serialization, with the serializations happening very frequently (it's a common pattern when splitting some computations to be done off the main thread, for example), and then it starts passing Composites some of the time, and now it is leaking a lot","m.mentions":{"user_ids":["@ljharb:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$nZ4Pa93AOuXDKy2F3BqHmsr17wBi5rRiRd_aLhYVkLQ"}},"msgtype":"m.text"},"ts":1763521660496,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$e3L6VMeCjDN3i0Bwvfg-Yx_ltOydGpwZm2HnSi3neAI"},
{"content":{"body":"that is an unusually _easy_ example of a leak to track down, and is also very much a thing which would happen with totally normal use of WeakMaps","format":"org.matrix.custom.html","formatted_body":"that is an unusually <em>easy</em> example of a leak to track down, and is also very much a thing which would happen with totally normal use of WeakMaps","m.mentions":{},"msgtype":"m.text"},"ts":1763521691003,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$PIMt4z91ZvCacWhSYrfxOBhscAxcrw-7YbJcNhvRZ9U"},
{"content":{"body":"throwing is much, much better here, so that the developer learns that actually WeakMaps do not work for Composites.","m.mentions":{},"msgtype":"m.text"},"ts":1763521709061,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$YNZ7owJajTtb8o_lbcl1A4SfuznpQ6GUyforCrwrvX4"},
{"content":{"body":"Congratulations to eemeli and Ashley Claymore for being the only speakers yesterdayâ€”including myselfâ€”who made sure the appropriate info was recorded in the notes.","format":"org.matrix.custom.html","formatted_body":"Congratulations to <a href=\"https://matrix.to/#/@eemeli:mozilla.org\">eemeli</a> and <a href=\"https://matrix.to/#/@aclaymore:matrix.org\">Ashley Claymore</a> for being the only speakers yesterdayâ€”including myselfâ€”who made sure the appropriate info was recorded in the notes.","m.mentions":{"user_ids":["@eemeli:mozilla.org","@aclaymore:matrix.org"]},"msgtype":"m.text"},"ts":1763523696343,"senderName":"Aki","senderId":"@akirose:matrix.org","id":"$PePGVqAviOGWqLitt5Nsz7SNfOp9WVZAgipbWxYAX3g"},
{"content":{"body":"bakkot, ryzokuken , ptomato , Mikhail Barash , FYT, nicolo-ribaudo , Richard Gibson , dminor , Michael Ficarra , ljharb , and James M Snell : here's what's missing https://kdrive.infomaniak.com/app/share/1777368/c4d6dca3-6847-4674-bf1d-87d2d0370871","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@bakkot:matrix.org\">bakkot</a>, <a href=\"https://matrix.to/#/@usharma:igalia.com\">ryzokuken</a> , <a href=\"https://matrix.to/#/@pchimento:igalia.com\">ptomato</a> , <a href=\"https://matrix.to/#/@mikbar-uib:matrix.org\">Mikhail Barash</a> , FYT, <a href=\"https://matrix.to/#/@nicolo-ribaudo:matrix.org\">nicolo-ribaudo</a> , <a href=\"https://matrix.to/#/@gibson042:matrix.org\">Richard Gibson</a> , <a href=\"https://matrix.to/#/@dminor:mozilla.org\">dminor</a> , <a href=\"https://matrix.to/#/@michaelficarra:matrix.org\">Michael Ficarra</a> , <a href=\"https://matrix.to/#/@ljharb:matrix.org\">ljharb</a> , and <a href=\"https://matrix.to/#/@jasnell:matrix.org\">James M Snell</a> : here's what's missing https://kdrive.infomaniak.com/app/share/1777368/c4d6dca3-6847-4674-bf1d-87d2d0370871","m.mentions":{"user_ids":["@bakkot:matrix.org","@usharma:igalia.com","@pchimento:igalia.com","@mikbar-uib:matrix.org","@nicolo-ribaudo:matrix.org","@gibson042:matrix.org","@dminor:mozilla.org","@michaelficarra:matrix.org","@ljharb:matrix.org","@jasnell:matrix.org"]},"msgtype":"m.text"},"ts":1763523832368,"senderName":"Aki","senderId":"@akirose:matrix.org","id":"$ImJEGL4jVPjglIdFw5VKqe-xUT5BCnk0cZATYZJLLVE"},
{"content":{"body":"fwiw speakers generally aren't the ones who add the link to the slides, I don't typically check for that after having done my presentation","m.mentions":{},"msgtype":"m.text"},"ts":1763523958760,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$Jj-_XiCwg8R-3Ekxd1giqOh7p-vKF6m4RsrubMIuZjQ"},
{"content":{"body":"(usually note takers do)","m.mentions":{},"msgtype":"m.text"},"ts":1763523964405,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$3iEqLqnohxOtgHvjRw148QDzmfmiEt4idAGilFY4caE"},
{"content":{"body":"Yeah the notes are in _really_ rough shape this meeting. ","format":"org.matrix.custom.html","formatted_body":"Yeah the notes are in <em>really</em> rough shape this meeting.","m.mentions":{},"msgtype":"m.text"},"ts":1763523979010,"senderName":"Aki","senderId":"@akirose:matrix.org","id":"$HKdUp-qWs9G6r1_Q-N9R9KDBplz8UTcLCWRaOsDqRq0"},
{"content":{"body":"anyway added slides link to editor update item","m.mentions":{},"msgtype":"m.text"},"ts":1763523996645,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$oA_Snroo-GliArlv2nCHheOON1-cZA2piZNxoy0zfxI"},
{"content":{"body":"sometimes an agenda item was added without a link to slides. In this case, note takers are not able to add the link for the speakers. Please add the link after done the presentation","m.mentions":{},"msgtype":"m.text"},"ts":1763524060087,"senderName":"Chengzhong Wu","senderId":"@legendecas:matrix.org","id":"$84dAJS-_531AlXvQP6cdAneWgj7glTPxUpr-dTJyXfk"},
{"content":{"body":"* sometimes an agenda item was added without a link to slides. In this case, note takers are not able to add the link for the speakers in the notes. Please add the link after done the presentation","m.mentions":{},"m.new_content":{"body":"sometimes an agenda item was added without a link to slides. In this case, note takers are not able to add the link for the speakers in the notes. Please add the link after done the presentation","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$84dAJS-_531AlXvQP6cdAneWgj7glTPxUpr-dTJyXfk","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763524084261,"senderName":"Chengzhong Wu","senderId":"@legendecas:matrix.org","id":"$8jjJ064YXeA7p8p4t7dDpeyb3xQgFgfg_trHB00At-w"},
{"content":{"body":"what on earth is kdrive, i was so confused when i wasn't logged in to google sheets and then i realized it wasn't sheets","m.mentions":{},"m.relates_to":{"event_id":"$ImJEGL4jVPjglIdFw5VKqe-xUT5BCnk0cZATYZJLLVE","is_falling_back":true,"m.in_reply_to":{"event_id":"$ImJEGL4jVPjglIdFw5VKqe-xUT5BCnk0cZATYZJLLVE"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1763524446436,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$jHf7dWq03Nq7EZpjcTYYpqhDSQoGT0FNeepmLPM5lRI"},
{"content":{"body":"it jumps to labels: https://github.com/v8/v8/blob/638e32793f854790284bf613eca204550e1c8e56/src/builtins/builtins-collections-gen.cc#L211-L215","m.mentions":{"user_ids":["@devsnek:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$N6IVCSiVJClL-_R1KP4pCE2KufYyeFpT6F1GNdD3Cds"}},"msgtype":"m.text"},"ts":1763525085801,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$wpekX6NFM-hcHmbMfpH2U352-g5wh8P-5z0zxliH6WY"},
{"content":{"body":"that's just an if/else though. i was referring to these more: https://github.com/v8/v8/blob/638e32793f854790284bf613eca204550e1c8e56/src/builtins/builtins-typed-array-gen.cc#L546-L601","m.mentions":{},"msgtype":"m.text"},"ts":1763525179207,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$fDovNwH83fu03OPZnGJGLRmRt11AILdzXvBmSNvVYT8"},
{"content":{"body":"One motivation for them to be objects is to allow them to contain mutable objects. That is not acceptable as primitives","m.mentions":{"user_ids":["@ljharb:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$zKJaBuJUYymP6ImGhkZuLwIwGt0CRBZjkkoK3VGPef0"}},"msgtype":"m.text"},"ts":1763525199687,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$IHkAzBrKNL09QEZrOyyfQvfvwvvKjdkUdfbfo2agpzc"},
{"content":{"body":"that leaks in a worse and more subtle way. Which is why I don't want the answer to be: every composite must contain something non-forgable","m.mentions":{"user_ids":["@ljharb:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$F0szJhk2ESX2SwsETSgvZF-VZ_jyW0IJRlKmeT49CAc"}},"msgtype":"m.text"},"ts":1763525272078,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$C7b3OSW_qVa2D2gKeU0J97EF6uzDiR6b8Gjjyn_dFZU"},
{"content":{"body":"Membrane style libraries that keep an association from any object to another object they created. We also have a classification library where we'll check the shape of a deeply frozen object and remember the classification.","m.mentions":{"user_ids":["@christianulbrich:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$SzcmKUBQQ89dSFUBhAZHVk_OJvTJPf7WXgadSR8kZwE"}},"msgtype":"m.text"},"ts":1763525307687,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$fBHSuoQ-6LNW7w0f8Cry3NuubR5ANDL8ZNqT4eyl6Ow"},
{"content":{"body":"* that's just a single branch though. i was referring to these more: https://github.com/v8/v8/blob/638e32793f854790284bf613eca204550e1c8e56/src/builtins/builtins-typed-array-gen.cc#L546-L601","m.mentions":{},"m.new_content":{"body":"that's just a single branch though. i was referring to these more: https://github.com/v8/v8/blob/638e32793f854790284bf613eca204550e1c8e56/src/builtins/builtins-typed-array-gen.cc#L546-L601","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$fDovNwH83fu03OPZnGJGLRmRt11AILdzXvBmSNvVYT8","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763525321937,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$SK3XjtPrYkNuoilhMF1lLLYBUchDeAR34d6RN8zTLo4"},
{"content":{"body":"I requested during my presentation that we keep the conversation to the slides, and not extend the conversation to a wider conversation. I would rather do that in a separate meeting that specifically talks about that - with prepared slides to reference.","m.mentions":{},"m.relates_to":{"event_id":"$DamJRP53vM0ayShgarkS0Z0UxqjV2cw8XI56oCMqAtA","is_falling_back":true,"m.in_reply_to":{"event_id":"$DamJRP53vM0ayShgarkS0Z0UxqjV2cw8XI56oCMqAtA"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1763525393238,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$MEXNWNo7HmbsyN5oXSMOyDJTjG2TuHaYWX53uTRWAuw"},
{"content":{"body":"it should still be called Semaphore ðŸ’¢","m.mentions":{},"msgtype":"m.text"},"ts":1763525528479,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$nZYbORWN1oqY34zNAZP0XLnY42QZLzkaI00dEwLVRjY"},
{"content":{"body":"it seems like Governor would be a confusingly disconnected name if it's located right on globalThis but not sure whether that's the intent","m.mentions":{},"msgtype":"m.text"},"ts":1763525585258,"senderName":"rkirsling","senderId":"@rkirsling:matrix.org","id":"$a3YKmwaOfLIl6dIPbGdCBs0nBXPr43re41sVaOGY-Vg"},
{"content":{"body":"I think `Semaphore` is the right name, but only if its API is usable both for async coordination and thread coordination (with shared structs), which is certainly feasible.","format":"org.matrix.custom.html","formatted_body":"I think <code>Semaphore</code> is the right name, but only if its API is usable both for async coordination and thread coordination (with shared structs), which is certainly feasible.","m.mentions":{},"msgtype":"m.text"},"ts":1763525650642,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$3Pldzaj4TTxip-9pUYS08dQvEeeoTi2Geb_oXHX2mPE"},
{"content":{"body":"I _think_ the only thing necessary to make it work for thread coordination is for it to be structured-cloneable?","format":"org.matrix.custom.html","formatted_body":"I <em>think</em> the only thing necessary to make it work for thread coordination is for it to be structured-cloneable?","m.mentions":{},"msgtype":"m.text"},"ts":1763526058944,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$0oH4fDKr16Ckh_OUyWb8mrXI9h9RpU5scz3PVUoMcRM"},
{"content":{"body":"with the internal state not being shared not cloned, obviously","m.mentions":{},"msgtype":"m.text"},"ts":1763526071570,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$RDo0mTTEEg3lfMLE1qEYk4BgVI1MHTkIfb2jmSxGNSM"},
{"content":{"body":"I guess the spec would require some atomics stuff, probably","m.mentions":{},"msgtype":"m.text"},"ts":1763526084776,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$wriRn_GXyWHzePla5BI5xOULHs8NQ9QXJFHFldZNGmw"},
{"content":{"body":"No, it wouldn't be structured clonable, it would be shared (just like Mutex, Condition)","m.mentions":{},"msgtype":"m.text"},"ts":1763526103270,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$vY6ksg2iQYtQBGCrDeecHInJxUyQ1xPjsFs67JwVx74"},
{"content":{"body":"Structured cloneable isn't shareable","m.mentions":{},"msgtype":"m.text"},"ts":1763526118846,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$QXis85H2RAAQ6msXqyffKkr_39n8MxQ-EUJKbJExuEQ"},
{"content":{"body":"Ideally it would be the same kind of object as we want Mutex to be (shared with a per-realm prototype). ","m.mentions":{},"msgtype":"m.text"},"ts":1763526264102,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$ZQPJMlRjEcod8aPRvUAg8T5fP-WltlB97eChMP5FEnk"},
{"content":{"body":"structured cloneable includes shared values ","m.mentions":{},"msgtype":"m.text"},"ts":1763526282727,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$C3l6kXMoUhfuVLrj7VC-Ln7ppVIImxrnZh2Bl9zjkhU"},
{"content":{"body":"Structured clone requires postmessage. Shareable only requires assignment","m.mentions":{},"msgtype":"m.text"},"ts":1763526321912,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$A5vwCQOp0KWYGSvPVCEnDoA_oo0eHF1nxwfQaZZOfgo"},
{"content":{"body":"You can't assign a structured clonable object to a property on a shared struct, only primitive and shareable values","m.mentions":{},"msgtype":"m.text"},"ts":1763526359478,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$ruVdk5k9nAf5ifs2BkEPkK6oPZKYNwNeJ-8cSNf02V0"},
{"content":{"body":"oh you are referring to a new category of value based on shared struct ok","m.mentions":{},"msgtype":"m.text"},"ts":1763526389432,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$MnBXXbkl9_wEpY4nFYRdsBsjCIGt2aKUk0z9V34ZjQA"},
{"content":{"body":"Yes.","m.mentions":{},"msgtype":"m.text"},"ts":1763526393803,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$biJ4J0EB9ME67rtv02fzn-z9fIFAGKWha0eQffZcw9w"},
{"content":{"body":"sorry, I meant prior to shared structs existing","m.mentions":{},"msgtype":"m.text"},"ts":1763526423417,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$ad8Fuzukqyx0_GpEPTi_-V7GYHepevH8gT9Tqk8RGVM"},
{"content":{"body":"You could make it structure clonable, and when we have shared struct redefine is as a shared object, the distinction is not observable without shared structs anyway","m.mentions":{},"msgtype":"m.text"},"ts":1763526424685,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$GpS7J4-y79GCwGm33ySqCjS2cBEXlAS-gp-X7QWtuUk"},
{"content":{"body":"Mutex and Condition both fall under this category and are essentially shared structs.","m.mentions":{},"msgtype":"m.text"},"ts":1763526428608,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$wH5kjGdhqdGEYPcv4XE3wOghjXf59AzyGJeOKwDPFTs"},
{"content":{"body":"we need inter-thread coordination even without shared structs","m.mentions":{},"msgtype":"m.text"},"ts":1763526432469,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$zssukMYlmcmHQFJhEN_87TT-9JDHtZEK0HMHEVhboYE"},
{"content":{"body":"and this proposal will probably go forward before that one","m.mentions":{},"msgtype":"m.text"},"ts":1763526444906,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$HbOc91z-Aed50R6BrhmVq7mi5aqCa5m43S0gHwfSnVA"},
{"content":{"body":"oh, I see \"resource governor\" is a SQL thing, so that must be the origin of this terminology?","m.mentions":{},"m.relates_to":{"m.in_reply_to":{"event_id":"$a3YKmwaOfLIl6dIPbGdCBs0nBXPr43re41sVaOGY-Vg"}},"msgtype":"m.text"},"ts":1763526452378,"senderName":"rkirsling","senderId":"@rkirsling:matrix.org","id":"$7FwyxtCD5OWMTsZDq2Q2cHikbdPqFTdbh0nYD0-suoU"},
{"content":{"body":"IMO we shouldn't make it structured clonable, we should make it frozen and specially handled in postMessage.","m.mentions":{},"msgtype":"m.text"},"ts":1763526488117,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$Uo01rW4wCN-Lqp-u3xUvMoTld3d5QsYYhcF3XTqT7Vs"},
{"content":{"body":"fwiw structured cloneable is a superset of basically everything, except host resources that explicitly can't support it","m.mentions":{},"msgtype":"m.text"},"ts":1763526490624,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$MANfX-VEGKSRrzERAXzUuIuFKG2uSMcUL7x9yy5vGf0"},
{"content":{"body":"That would allow us to hedge ","m.mentions":{},"msgtype":"m.text"},"ts":1763526496738,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$B6pKHgRMBfqUF4GLLJK-AzBpGbzLk13odALDvDoTUxE"},
{"content":{"body":"The difference is that something structured clonable will create a *new* instance in another worker thread. A shared thing is the *same* instance in another thread.","format":"org.matrix.custom.html","formatted_body":"The difference is that something structured clonable will create a <em>new</em> instance in another worker thread. A shared thing is the <em>same</em> instance in another thread.","m.mentions":{},"msgtype":"m.text"},"ts":1763526538859,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$UHgmjZ4KELecWiCVDY_wX8HFHzH5273zG9P-xy67a10"},
{"content":{"body":"https://github.com/v8/v8/blob/638e32793f854790284bf613eca204550e1c8e56/src/builtins/builtins-collections-gen.cc#L1887-L1898 has more branches - haven't looked at exactly what this compiles to - if it's a jump table","m.mentions":{},"m.relates_to":{"event_id":"$fDovNwH83fu03OPZnGJGLRmRt11AILdzXvBmSNvVYT8","is_falling_back":true,"m.in_reply_to":{"event_id":"$fDovNwH83fu03OPZnGJGLRmRt11AILdzXvBmSNvVYT8"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1763526593039,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$D9dBAI4LCsNpOwUv3jx_ZvcJQYZJL-bLytAr-_IUnlk"},
{"content":{"body":"is SharedArrayBuffer a sharable value?","m.mentions":{},"msgtype":"m.text"},"ts":1763526594029,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$89w9Jm6hD96fUHG2OYtdo97uzvlXnLFx7ts4uAF7SOY"},
{"content":{"body":"No","m.mentions":{},"msgtype":"m.text"},"ts":1763526614017,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$O553xorUGBOGeDKlFkDks7QTQOBp-grwsHUFHGMIDsM"},
{"content":{"body":"Unfortunately","m.mentions":{},"msgtype":"m.text"},"ts":1763526623962,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$XYSCBpSDfC9aaYOSjrD1A52-MZTD_ADoGiywETT4Xfk"},
{"content":{"body":"SharedArrayBuffer is cloned, i.e. posting it back and forth doesn't preserve equality, but it points to a shared internal thing","m.mentions":{},"msgtype":"m.text"},"ts":1763526627862,"senderName":"Andreu Botella (ðŸ•‘ JST, at TC39)","senderId":"@abotella:igalia.com","id":"$veujzZoSLA_xDt4OBJnj-mpqQBhzVN_pHMmJNS6l67Q"},
{"content":{"body":"well then we can make up whatever rules we want in the structured clone algo for \"shared\" values","m.mentions":{},"msgtype":"m.text"},"ts":1763526647754,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$zUZ0T02_rHRd3b4a0zb3lq3b7EZK6i4J9KOkLbYnq2I"},
{"content":{"body":"but yeah i see your point","m.mentions":{},"msgtype":"m.text"},"ts":1763526661513,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$P34-wOHGAI-1FSmfUGnaYnc-xqmMBRGXpK-EdXsHHMU"},
{"content":{"body":"Also, Shared Structs is already at Stage 2. Its delays have been mostly been as a result of both champions having major job changes in the past few months.","m.mentions":{},"msgtype":"m.text"},"ts":1763526753609,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$rKYRfmcr_IexK_-8-Orhj-TpJO9QjX7hQNJmGKED0P0"},
{"content":{"body":"Again I maintain that having an object being sharable over postMessage doesn't prevent it from also becoming directly a shared object","m.mentions":{},"msgtype":"m.text"},"ts":1763526782025,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$61XMGq_SBLgVXHxwRPnC-epcV__UDzbUxgnFGu6AVzw"},
{"content":{"body":"I'm hoping to dedicate more time to getting it to Stage 2.7 in the coming year, though ideally I would like someone from V8 to take on @syg's co-champion role as he's indicated he is unable to participate regularly going forward.","m.mentions":{},"msgtype":"m.text"},"ts":1763526826588,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$YvgyS2BF4jqMiCjJ6ZOwxsicblSFBVn0lQ-YvYpfj8s"},
{"content":{"body":"(except maybe for all the exotic SAB stuff)","m.mentions":{},"msgtype":"m.text"},"ts":1763526829619,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$pd-t6EtdPuV-pPRoHIpY2DGfwP1SxvEbIcO4L3TLr4g"},
{"content":{"body":"rbuckton: you might want to chat with Olivier FlÃ¼ckiger ","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@rbuckton:matrix.org\">rbuckton</a>: you might want to chat with <a href=\"https://matrix.to/#/@olivf.o1o.ch:immer.chat\">Olivier FlÃ¼ckiger</a>","m.mentions":{"user_ids":["@rbuckton:matrix.org","@olivf.o1o.ch:immer.chat"]},"msgtype":"m.text"},"ts":1763526873984,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$i1V803ioCmlDgN3MB7_rUe3yp_solhdbaSgiHrJ_2AA"},
{"content":{"body":"Minor point: The audio coming from the room is very quiet compared to those joining remotely, so I either can barely hear the room or my speakers are blown out by remote attendees depending on who I adjust the audio for. ","m.mentions":{},"msgtype":"m.text"},"ts":1763526954151,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$TfYDFAwHW3XmB8kWxWFTYykZiFyOB2weOU5Cmgn1Bdk"},
{"content":{"body":"... huh, audio's fine for me","m.mentions":{},"msgtype":"m.text"},"ts":1763527000792,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$wqX31VtlO_hrRTKeUVBz0vaEJ0D4Fvw8CV-OpOka6gg"},
{"content":{"body":"The issue with structured clone is that a value going from thread A to thread B and back to thread A will not produce the same instance.","m.mentions":{},"msgtype":"m.text"},"ts":1763527023696,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$ZM0O98pO1WefBn-p9nLdsqM2pqrLs0KnGDspWwaFaP4"},
{"content":{"body":"Seems fine?","m.mentions":{},"msgtype":"m.text"},"ts":1763527040809,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$J7pKRFsL4HYOXmcbu-eWm39Opr2AbXnTuv-arSBngNI"},
{"content":{"body":"I don't actually see a reason why that would matter for this.","m.mentions":{},"msgtype":"m.text"},"ts":1763527049075,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$hQecWNaMvG6DL6c25fXiz921SJWJI_pvgi8sIW1hFhs"},
{"content":{"body":"That isn't what happens for shared structs.","m.mentions":{},"msgtype":"m.text"},"ts":1763527053052,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$mcjK74_GV_sEIRXjRTCLF_RNAda3e4J7KsXtNBkvOxA"},
{"content":{"body":"... OK?","m.mentions":{},"msgtype":"m.text"},"ts":1763527057989,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$PNVnk845a85tSaLfqJWV6XQ9WjFYI4mdvfzXiwyHubg"},
{"content":{"body":"So if you change it from being cloneable to shareable, that's an observable change","m.mentions":{},"msgtype":"m.text"},"ts":1763527067591,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$7wHWI9VI-5MV2eAcdu2ejCwG7Li_cYmTZoTJCko_JCc"},
{"content":{"body":"i don't particularly care what structured clone does as long as i get some sort of native shared state out of it, like SAB","m.mentions":{},"msgtype":"m.text"},"ts":1763527070700,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$DI-gUsLBPEJEi_umO_xgOwjgpXHf7BmvbWAdMeGGLE0"},
{"content":{"body":"New topic:  how is the quality of the original transcription for the notes today?  We had quality drop-off at 16:15 yesterday.","m.mentions":{},"msgtype":"m.text"},"ts":1763527082541,"senderName":"Rob Palmer","senderId":"@robpalme:matrix.org","id":"$8AdwriFSDaUFEKj6BTDEvollOSiViB10DH0Qj_th-IY"},
{"content":{"body":"how ?","m.mentions":{"user_ids":["@rbuckton:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$7wHWI9VI-5MV2eAcdu2ejCwG7Li_cYmTZoTJCko_JCc"}},"msgtype":"m.text"},"ts":1763527094717,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$xj83p2x4cmTt2oQp67ip2AzDZRyUMXcsik8Ou3vAk3s"},
{"content":{"body":"doing fine so far","m.mentions":{"user_ids":["@robpalme:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$8AdwriFSDaUFEKj6BTDEvollOSiViB10DH0Qj_th-IY"}},"msgtype":"m.text"},"ts":1763527124048,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$zZ6WzYttbGMaMZiVPd56fKDkLV8rcqEY8DRv667jjQw"},
{"content":{"body":"Correct me if I'm wrong, but you can't currently rely on reference equality for something like SAB bouncing between two threads, can you? \\","format":"org.matrix.custom.html","formatted_body":"Correct me if I&#39;m wrong, but you can&#39;t currently rely on reference equality for something like SAB bouncing between two threads, can you? \\","m.mentions":{},"msgtype":"m.text"},"ts":1763527185648,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$d76NQWkMVUf55ZKsxTCNhzuyPTfNF-7q7TudCwgIDaw"},
{"content":{"body":"* Correct me if I'm wrong, but you can't currently rely on reference equality for something like SAB bouncing between two threads, can you?","m.mentions":{},"m.new_content":{"body":"Correct me if I'm wrong, but you can't currently rely on reference equality for something like SAB bouncing between two threads, can you?","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$d76NQWkMVUf55ZKsxTCNhzuyPTfNF-7q7TudCwgIDaw","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763527187930,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$ToWx22s3cVWSNQMPY3Uh_c88PmqdHVp3x3SEsgpYYkw"},
{"content":{"body":"you can not","m.mentions":{},"msgtype":"m.text"},"ts":1763527192998,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$TSz8l1wqSopdt0DUrFzFCkm0aopoCgoxKOgOgCDFHIw"},
{"content":{"body":"and i don't care about it maintaining reference equality","m.mentions":{},"msgtype":"m.text"},"ts":1763527205684,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$Mcre2kww6VPkwJOj1dHSrEzGtgJyByjKPgMGCAPyYLM"},
{"content":{"body":"You can rely on reference equality for this case with Shared Structs","m.mentions":{},"msgtype":"m.text"},"ts":1763527208857,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$sGeWjkFy44kh2b0ag99RvKO333UUxdrMhaYtAr1PmfE"},
{"content":{"body":"i care about it for shared structs, sure","m.mentions":{},"msgtype":"m.text"},"ts":1763527221006,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$VtuK-4jl5Y-ER-8E1K2gjsmi2IuB008z1x0cIfzFsao"},
{"content":{"body":"I care about something like `Semaphore` behaving like a shared struct, so maintaining reference  equality.","format":"org.matrix.custom.html","formatted_body":"I care about something like <code>Semaphore</code> behaving like a shared struct, so maintaining reference  equality.","m.mentions":{},"msgtype":"m.text"},"ts":1763527248547,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$3CPiHxLDkbGSoBwMdBJPx1I3iD2HO6gyn9b0LJHKX50"},
{"content":{"body":"If it starts out behaving like SAB, we have to be ok with changing that behavior later.","m.mentions":{},"msgtype":"m.text"},"ts":1763527283917,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$cI0tzs2vwkwDuThcJhXk3PlyEl2D1X5Wx0sVU57H9N0"},
{"content":{"body":"yeah i have no strong opinion over whether it behaves like a shared struct or not","m.mentions":{},"msgtype":"m.text"},"ts":1763527306405,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$mBTxem6GvrOARl0b9dIi3J4eOV6wWzW6O3DIh_U9aes"},
{"content":{"body":"either way it can be shared between threads somehow","m.mentions":{},"msgtype":"m.text"},"ts":1763527331854,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$sZoEzfcVqtjnM1-SoYmSRfcvnt74azbFLWhOw38SF7M"},
{"content":{"body":"that's good enough for me","m.mentions":{},"msgtype":"m.text"},"ts":1763527335958,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$CHcJsc4rcc-HV75zPRfqoCRB9BZQ-_SwmJ4NFkL_1-Y"},
{"content":{"body":"I think we can work out a solution that hedges towards availability of shared structs.","m.mentions":{},"msgtype":"m.text"},"ts":1763527353417,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$p5YS7tp3tW2QytKwGsW3ROM1qrno9gcdwAAiTu5d_2c"},
{"content":{"body":"right but if you admit there can be multiple objects identities that are back by the same internal thing, all these objects could be shared, it's just you cannot rely on identity to differentiate them, which I don't think is a requirement?","m.mentions":{},"msgtype":"m.text"},"ts":1763527363835,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$Lh3ayq_WYDBFYouVXP2arGsQAU35jinB5UswroGKe6U"},
{"content":{"body":"* right but if you admit there can be multiple objects identities that are backed by the same internal thing, all these objects could be shared, it's just you cannot rely on identity to differentiate them, which I don't think is a requirement?","m.mentions":{},"m.new_content":{"body":"right but if you admit there can be multiple objects identities that are backed by the same internal thing, all these objects could be shared, it's just you cannot rely on identity to differentiate them, which I don't think is a requirement?","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$Lh3ayq_WYDBFYouVXP2arGsQAU35jinB5UswroGKe6U","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763527372554,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$pNKrPOBzTyLBnUJEmXSnKjjNQkZ80pOuB0rBJ3anH_Q"},
{"content":{"body":"I think you need to be able to rely on identity.","m.mentions":{"user_ids":["@mhofman:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$Lh3ayq_WYDBFYouVXP2arGsQAU35jinB5UswroGKe6U"}},"msgtype":"m.text"},"ts":1763527403472,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$WkDEd-FUUs289Cs1l2cDwDq9EJHk8KOyOU4BDJqKens"},
{"content":{"body":"what's the use case?","m.mentions":{},"msgtype":"m.text"},"ts":1763527414465,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$0eIte48zQlD7poD2qGpflaTsZVMKTKGSMAdVg_4Itmk"},
{"content":{"body":"We can't do SAB because it has quirks like this.","m.mentions":{},"msgtype":"m.text"},"ts":1763527418570,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$S_hyl8OdChyC7dRH1PgxywtdPpiwKIJwUwsB8pSeN7I"},
{"content":{"body":"sorry, who's talking? for the notes","m.mentions":{},"msgtype":"m.text"},"ts":1763527436341,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$aj_z4eDUbG8VSaSEpvgf0w2SngcAPJ_y2Xk9gj-iqV4"},
{"content":{"body":"Oli","m.mentions":{"user_ids":["@bakkot:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$aj_z4eDUbG8VSaSEpvgf0w2SngcAPJ_y2Xk9gj-iqV4"}},"msgtype":"m.text"},"ts":1763527445045,"senderName":"Chris de Almeida","senderId":"@softwarechris:matrix.org","id":"$JTwhp2CN_awGizrifQBybnFSgmkbb7zkDz2BTUayx04"},
{"content":{"body":"bakkot: +1 on everything there with AbortSignal... if you want some help on getting that proposal going in WHATWG, I'm more than happy to help","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@bakkot:matrix.org\">bakkot</a>: +1 on everything there with AbortSignal... if you want some help on getting that proposal going in WHATWG, I'm more than happy to help","m.mentions":{"user_ids":["@bakkot:matrix.org"]},"msgtype":"m.text"},"ts":1763527450349,"senderName":"James M Snell","senderId":"@jasnell:matrix.org","id":"$gUoZqjty9iFq71LHzPlbzU9Gw48FE1zfhrT6vo_41gk"},
{"content":{"body":"Not having `Semaphore` behave differently than `Mutex` when writing code. It's a major quirk that you would run into regularly.","format":"org.matrix.custom.html","formatted_body":"Not having <code>Semaphore</code> behave differently than <code>Mutex</code> when writing code. It's a major quirk that you would run into regularly.","m.mentions":{"user_ids":["@mhofman:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$0eIte48zQlD7poD2qGpflaTsZVMKTKGSMAdVg_4Itmk"}},"msgtype":"m.text"},"ts":1763527459042,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$EOxHVWkzptNBPTglrJ9u7KUHoa31u4BFPWYXlp_7ZkM"},
{"content":{"body":"note, thanks, will probably take you up on that","m.mentions":{"user_ids":["@jasnell:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$gUoZqjty9iFq71LHzPlbzU9Gw48FE1zfhrT6vo_41gk"}},"msgtype":"m.text"},"ts":1763527476445,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$ynylf-yFS2-gtfMwN5u1O69DT3WP3NYKXxvnQC3cs1E"},
{"content":{"body":"IMO, with structs at Stage 2 we should renew the effort to get that proposal to Stage 2.7 and perhaps we won't run into a timing issue. ","m.mentions":{},"msgtype":"m.text"},"ts":1763527535612,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$2FWVlj4XKoXfsrkJippbJhje1RfGYbTYSs8eKGmOf-A"},
{"content":{"body":"I'm missing the context around the can of worms / current issues with the state of AbortSignal, is there anything good I can read to get up to speed?","m.mentions":{"user_ids":["@jasnell:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$gUoZqjty9iFq71LHzPlbzU9Gw48FE1zfhrT6vo_41gk"}},"msgtype":"m.text"},"ts":1763527549594,"senderName":"jkup","senderId":"@jkup:matrix.org","id":"$tpHiUJuGqkzE6hEmFJJOfrqWuRfzXDvxIfWUTWVE_78"},
{"content":{"body":"Or we ship this proposal without `CountingGovernor` since it can be implemented in userland until such time as both proposals have hit stage 4.","format":"org.matrix.custom.html","formatted_body":"Or we ship this proposal without <code>CountingGovernor</code> since it can be implemented in userland until such time as both proposals have hit stage 4.","m.mentions":{},"msgtype":"m.text"},"ts":1763527574889,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$jISig6CBdcccY4Pv2OwQON0zIchQIU5hcwSJmDg6XP8"},
{"content":{"body":"there's a bunch of things, some of it here: https://matrixlogs.bakkot.com/WHATWG/2025-09-25#L18","m.mentions":{"user_ids":["@jkup:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$tpHiUJuGqkzE6hEmFJJOfrqWuRfzXDvxIfWUTWVE_78"}},"msgtype":"m.text"},"ts":1763527613591,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$dbjQpYdw6YNMivfWlfPuu4WcqBM5NyYGBvL7hdCpUe4"},
{"content":{"body":"I can discuss some of my concerns at length after the plenary, if you'd like.","m.mentions":{"user_ids":["@jkup:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$tpHiUJuGqkzE6hEmFJJOfrqWuRfzXDvxIfWUTWVE_78"}},"msgtype":"m.text"},"ts":1763527624597,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$6MqLBvsOZ9R7ELPtd4T16WNt43fjBWAeHH6TMa31ixU"},
{"content":{"body":"just negate all of those bullets and that's how it currently works","m.mentions":{},"msgtype":"m.text"},"ts":1763527630294,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$DS4JQgpe_sTHMPX8qwlnB2eismVrEcxZCn8wtmeHECw"},
{"content":{"body":"Is it just me or do people have wildly different mic volumes today?","m.mentions":{},"msgtype":"m.text"},"ts":1763527637222,"senderName":"danielrosenwasser","senderId":"@danielrosenwasser:matrix.org","id":"$8LRS5QjQKg4oaNK8fVTf6E1v8_Lr47nRTJo7RMwxssQ"},
{"content":{"body":"that was blastingly loud, yeah","m.mentions":{},"msgtype":"m.text"},"ts":1763527646081,"senderName":"rkirsling","senderId":"@rkirsling:matrix.org","id":"$HA_ymEyWchnop9-LD4DX1Znhr6MGj-4uiOIREELhEws"},
{"content":{"body":"not just you","m.mentions":{"user_ids":["@danielrosenwasser:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$8LRS5QjQKg4oaNK8fVTf6E1v8_Lr47nRTJo7RMwxssQ"}},"msgtype":"m.text"},"ts":1763527653892,"senderName":"Chris de Almeida","senderId":"@softwarechris:matrix.org","id":"$aXm94AlmGVLqDjj8N7nZPnem7AYT44bawmSLkNj9wVk"},
{"content":{"body":"rbuckton: I understand how identity preservations is important for actors, but these seem like very specialized tools purely meant to implement low level synchronization, and I fail to understand the use case where identity preservation matters here. I do understand it may be beneficial to in the future share these tools over existing shared object instead of postMessage ","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@rbuckton:matrix.org\">rbuckton</a>: I understand how identity preservations is important for actors, but these seem like very specialized tools purely meant to implement low level synchronization, and I fail to understand the use case where identity preservation matters here. I do understand it may be beneficial to in the future share these tools over existing shared object instead of postMessage","m.mentions":{"user_ids":["@rbuckton:matrix.org"]},"msgtype":"m.text"},"ts":1763527674784,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$KukYWHWD8p7UHbqWuWVIrciVQ8nUlupo08bZQNP2RaI"},
{"content":{"body":"yeah, but a lot of the presenters have had extremely low mics today","m.mentions":{},"msgtype":"m.text"},"ts":1763527675486,"senderName":"danielrosenwasser","senderId":"@danielrosenwasser:matrix.org","id":"$iqpyOt9ASSRftIQMjUhi7GD5zFZEoFSFfFKPOPgUCtw"},
{"content":{"body":"bakkot: How is your audio OK? I can barely hear michael with my audio set to a level where Steve Hick's audio doesn't make my ears bleed.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@bakkot:matrix.org\">bakkot</a>: How is your audio OK? I can barely hear michael with my audio set to a level where Steve Hick's audio doesn't make my ears bleed.","m.mentions":{"user_ids":["@bakkot:matrix.org"]},"msgtype":"m.text"},"ts":1763527678118,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$e_Zi4DXkpls5heSzxJwg470pvLYXu06YHy6HRNsmMEM"},
{"content":{"body":"maybe my computer or browser is doing some equalization? idk","m.mentions":{},"msgtype":"m.text"},"ts":1763527694704,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$3WoS7yKOtM7oj1KTbv5DO2sWyg5FMqf7f0YOLkY3jKU"},
{"content":{"body":"can you adjust audio per-person?","m.mentions":{},"msgtype":"m.text"},"ts":1763527696580,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$Y-7IAa6nfhPYs0No_7sjKz1G4evnUO5ZZElCqS8cVK0"},
{"content":{"body":"Not that I can find","m.mentions":{},"msgtype":"m.text"},"ts":1763527705243,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$hOm1kZw1zuUhXxgXrYob-bczRN9Yf8FRfBw7XWayoiM"},
{"content":{"body":"I think there's a fair number of folks potentially interested in this discussion. Maybe organizing a call would be worthwhile?","m.mentions":{"user_ids":["@rbuckton:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$6MqLBvsOZ9R7ELPtd4T16WNt43fjBWAeHH6TMa31ixU"}},"msgtype":"m.text"},"ts":1763527760093,"senderName":"James M Snell","senderId":"@jasnell:matrix.org","id":"$1XdiBAE_k9IjseKyA0z2udwfnkb6gQXpauDmCdWEbcE"},
{"content":{"body":"bakkot: I'm interested in the abort controller stuff","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@bakkot:matrix.org\">bakkot</a>: I'm interested in the abort controller stuff","m.mentions":{"user_ids":["@bakkot:matrix.org"]},"msgtype":"m.text"},"ts":1763527859299,"senderName":"Jake Archibald","senderId":"@jakea:matrix.org","id":"$yoxF6QEoxK8ixL-4uoEYu1tnpIa5dXMoaE5hBuGcJEI"},
{"content":{"body":"(I'm the original author of the abort controller spec. pls don't hate me)","m.mentions":{},"msgtype":"m.text"},"ts":1763527880953,"senderName":"Jake Archibald","senderId":"@jakea:matrix.org","id":"$Mb0wfRlU4UG871obd5cIdhRcJSBNQsXbtp-Xk4ckg5M"},
{"content":{"body":"Me too","m.mentions":{},"msgtype":"m.text"},"ts":1763527885900,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$LVI7s0oAWSa0lf1aXiruCI3JyqJCFGgBucT9MpJGCjQ"},
{"content":{"body":"I don't hate you, I just wish you'd given userland the nice behavior that the web platform gets, is all","m.mentions":{"user_ids":["@jakea:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$Mb0wfRlU4UG871obd5cIdhRcJSBNQsXbtp-Xk4ckg5M"}},"msgtype":"m.text"},"ts":1763527939567,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$2emGqwJRV_8_mmv4QqX-xlILwSa1zvdsst4wPXv2Gho"},
{"content":{"body":"users deserve nice things too","m.mentions":{},"msgtype":"m.text"},"ts":1763527952125,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$5kQcaxu71O3ylhlBD7Uv08ieDdYIcSKy-3kWL38wBGA"},
{"content":{"body":"Kris Kowal has opinions too","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@kriskowal:matrix.org\">Kris Kowal</a> has opinions too","m.mentions":{"user_ids":["@kriskowal:matrix.org"]},"msgtype":"m.text"},"ts":1763527956204,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$DwOeNF_eMDVdH09HGB-wpn1Ex7D62dAG_3EVNcRljYo"},
{"content":{"body":"bakkot: is the behaviour gap documented anywhere?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@bakkot:matrix.org\">bakkot</a>: is the behaviour gap documented anywhere?","m.mentions":{"user_ids":["@bakkot:matrix.org"]},"msgtype":"m.text"},"ts":1763527986405,"senderName":"Jake Archibald","senderId":"@jakea:matrix.org","id":"$YXtlCi4zqInjv_W1kAk9vLBPfx3uPnZCqgl1eE-pdD4"},
{"content":{"body":"I just wish AbortSignal wasn't an EventTarget.","format":"org.matrix.custom.html","formatted_body":"I just wish AbortSignal wasn't an EventTarget.","msgtype":"m.text"},"ts":1763528008422,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$3cDZJobh_IcjSLW3U-93o5JqNnCKX70bmvGYrn_1JqI"},
{"content":{"body":"But I also use it on the web all the time and thanks Jake Archibald for adding it!","format":"org.matrix.custom.html","formatted_body":"But I also use it on the web all the time and thanks <a href=\"https://matrix.to/#/@jakea:matrix.org\">Jake Archibald</a> for adding it!","msgtype":"m.text"},"ts":1763528026713,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$Gkbynohcx2LX-XCbmygoiCkMHa0_7omJ6MrmRoeAFCw"},
{"content":{"body":"lots of random griping on the web, but the best place I've got to hand is https://matrixlogs.bakkot.com/WHATWG/2025-09-25#L18","m.mentions":{"user_ids":["@jakea:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$YXtlCi4zqInjv_W1kAk9vLBPfx3uPnZCqgl1eE-pdD4"}},"msgtype":"m.text"},"ts":1763528030765,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$sjpXrlRK68jNneeXR2ro-kkDwH_fMYFrZCHNktp0qbE"},
{"content":{"body":"specifically, for the web, you have these things:\n\n- someone manually doing a dispatchEvent on the signal won't trigger your callback\n- another listener doing stopImmediatePropagation won't prevent your callback from being triggered\n- the callback is automatically released once the signal is aborted\n- adding a callback after the signal is already aborted won't do anything (and in particular won't hold a reference to your callback)\n\nusers consumers of AbortSignal don't get any of those","format":"org.matrix.custom.html","formatted_body":"<p>specifically, for the web, you have these things:</p>\n<ul>\n<li>someone manually doing a dispatchEvent on the signal won't trigger your callback</li>\n<li>another listener doing stopImmediatePropagation won't prevent your callback from being triggered</li>\n<li>the callback is automatically released once the signal is aborted</li>\n<li>adding a callback after the signal is already aborted won't do anything (and in particular won't hold a reference to your callback)</li>\n</ul>\n<p>users consumers of AbortSignal don't get any of those</p>\n","m.mentions":{},"msgtype":"m.text"},"ts":1763528057106,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$6l0eTq-aGQCsYBoXPq0vderIhjccqiJMhc_RaI-HMpo"},
{"content":{"body":"Grab the pitchforks everyone... we know who to chase down","m.mentions":{"user_ids":["@jakea:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$Mb0wfRlU4UG871obd5cIdhRcJSBNQsXbtp-Xk4ckg5M"}},"msgtype":"m.text"},"ts":1763528071161,"senderName":"James M Snell","senderId":"@jasnell:matrix.org","id":"$pKQL1xmr6kwHFPqvLYQnvrqoONBaTj18pdS1fsjkVfM"},
{"content":{"body":"I'll admit I've had a number of gripes (some vocal, some not so) with the `AbortController` API, but my biggest frustration was that it felt very rushed out while I was in the middle of trying to get cancellation into the core language.","format":"org.matrix.custom.html","formatted_body":"I'll admit I've had a number of gripes (some vocal, some not so) with the <code>AbortController</code> API, but my biggest frustration was that it felt very rushed out while I was in the middle of trying to get cancellation into the core language.","m.mentions":{"user_ids":["@jakea:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$Mb0wfRlU4UG871obd5cIdhRcJSBNQsXbtp-Xk4ckg5M"}},"msgtype":"m.text"},"ts":1763528071988,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$2R0WyQKJ48o8swjWwY36liC76wgyMvI5uoglABXcFKw"},
{"content":{"body":"* specifically, for abort listeners added from web machinery instead of userland, you have these things:\n\n- someone manually doing a dispatchEvent on the signal won't trigger your callback\n- another listener doing stopImmediatePropagation won't prevent your callback from being triggered\n- the callback is automatically released once the signal is aborted\n- adding a callback after the signal is already aborted won't do anything (and in particular won't hold a reference to your callback)\n\nusers consumers of AbortSignal don't get any of those","format":"org.matrix.custom.html","formatted_body":"* <p>specifically, for abort listeners added from web machinery instead of userland, you have these things:</p>\n<ul>\n<li>someone manually doing a dispatchEvent on the signal won't trigger your callback</li>\n<li>another listener doing stopImmediatePropagation won't prevent your callback from being triggered</li>\n<li>the callback is automatically released once the signal is aborted</li>\n<li>adding a callback after the signal is already aborted won't do anything (and in particular won't hold a reference to your callback)</li>\n</ul>\n<p>users consumers of AbortSignal don't get any of those</p>\n","m.mentions":{},"m.new_content":{"body":"specifically, for abort listeners added from web machinery instead of userland, you have these things:\n\n- someone manually doing a dispatchEvent on the signal won't trigger your callback\n- another listener doing stopImmediatePropagation won't prevent your callback from being triggered\n- the callback is automatically released once the signal is aborted\n- adding a callback after the signal is already aborted won't do anything (and in particular won't hold a reference to your callback)\n\nusers consumers of AbortSignal don't get any of those","format":"org.matrix.custom.html","formatted_body":"<p>specifically, for abort listeners added from web machinery instead of userland, you have these things:</p>\n<ul>\n<li>someone manually doing a dispatchEvent on the signal won't trigger your callback</li>\n<li>another listener doing stopImmediatePropagation won't prevent your callback from being triggered</li>\n<li>the callback is automatically released once the signal is aborted</li>\n<li>adding a callback after the signal is already aborted won't do anything (and in particular won't hold a reference to your callback)</li>\n</ul>\n<p>users consumers of AbortSignal don't get any of those</p>\n","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$6l0eTq-aGQCsYBoXPq0vderIhjccqiJMhc_RaI-HMpo","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763528081283,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$fKc_SF-OTcRK9o8S9S1eAT_jIzPwstdxijOgaju8FwI"},
{"content":{"body":"I'll put together a doodle poll early next week and post it to get a call set up","m.mentions":{},"msgtype":"m.text"},"ts":1763528101038,"senderName":"James M Snell","senderId":"@jasnell:matrix.org","id":"$LL0BQogScMnBHiPYj65tIOx_Lf2ZVN422--CqVo4U7Y"},
{"content":{"body":"if we add EventTarget and DOMException to 262 this becomes a very simple problem to solve","m.mentions":{},"msgtype":"m.text"},"ts":1763528103523,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$X1R8BLzDLK-UQ6_7aWsLL6JRIsXyyuAqVbGIP03Mvsk"},
{"content":{"body":"what i wish is that abortsignal hadn't been shipped before notifying TC39 that it was happening :-/","m.mentions":{},"msgtype":"m.text"},"ts":1763528109885,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$beY3C-6oHUyOb-5sn5NvjlYqT3ZidPKOeVSK8-H1hbE"},
{"content":{"body":"https://en.wikipedia.org/wiki/Governor_(device)","format":"org.matrix.custom.html","formatted_body":"https://en.wikipedia.org/wiki/Governor_(device)","m.mentions":{"user_ids":["@rkirsling:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$7FwyxtCD5OWMTsZDq2Q2cHikbdPqFTdbh0nYD0-suoU"}},"msgtype":"m.text"},"ts":1763528124113,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$P8lTpATy9A0S51MK2rVH8ViXv1gtF1_TlCGbL4dUX70"},
{"content":{"body":"whoa","m.mentions":{},"msgtype":"m.text"},"ts":1763528139759,"senderName":"rkirsling","senderId":"@rkirsling:matrix.org","id":"$DnFiKsfBVet9-p1_KoAnyqJcNtZpCgm8ETtaR7s8lu0"},
{"content":{"body":"That's precisely one of my gripes.","m.mentions":{"user_ids":["@devsnek:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$X1R8BLzDLK-UQ6_7aWsLL6JRIsXyyuAqVbGIP03Mvsk"}},"msgtype":"m.text"},"ts":1763528148307,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$gQjDbk7j8JmY98Xe4Ad-6vevOzHNY1yEQY8CY86mZhE"},
{"content":{"body":"rbuckton: interesting. I was told at the time that cancellation primitives has been abandoned in TC39. Hm.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@rbuckton:matrix.org\">rbuckton</a>: interesting. I was told at the time that cancellation primitives has been abandoned in TC39. Hm.","m.mentions":{"user_ids":["@rbuckton:matrix.org"]},"msgtype":"m.text"},"ts":1763528201763,"senderName":"Jake Archibald","senderId":"@jakea:matrix.org","id":"$sNfcxyZuxCKfbAZfVE7lXboPWe-fALoR2BOAbIZtChQ"},
{"content":{"body":"I refuse to write a standard library function which has as one if its steps \"and then call `.addEventListener('abort', fn)`\"","format":"org.matrix.custom.html","formatted_body":"I refuse to write a standard library function which has as one if its steps \"and then call <code>.addEventListener('abort', fn)</code>\"","m.mentions":{"user_ids":["@devsnek:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$X1R8BLzDLK-UQ6_7aWsLL6JRIsXyyuAqVbGIP03Mvsk"}},"msgtype":"m.text"},"ts":1763528211871,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$RW5wpVh4iFwD6Cb_wb9GlRHoIPqmLZA7grAnFTp6XH8"},
{"content":{"body":"even DOM consumers of AbortSignal don't stoop to that","m.mentions":{},"msgtype":"m.text"},"ts":1763528221008,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$m2UxlLqNKA1lV6wG5yjwWkntJgxSOEfSTDdKi4_HiP8"},
{"content":{"body":"* I refuse to write a standard library function which has as one of its steps \"and then call `.addEventListener('abort', fn)`\"","format":"org.matrix.custom.html","formatted_body":"* I refuse to write a standard library function which has as one of its steps \"and then call <code>.addEventListener('abort', fn)</code>\"","m.mentions":{},"m.new_content":{"body":"I refuse to write a standard library function which has as one of its steps \"and then call `.addEventListener('abort', fn)`\"","format":"org.matrix.custom.html","formatted_body":"I refuse to write a standard library function which has as one of its steps \"and then call <code>.addEventListener('abort', fn)</code>\"","m.mentions":{"user_ids":["@devsnek:matrix.org"]},"msgtype":"m.text"},"m.relates_to":{"event_id":"$RW5wpVh4iFwD6Cb_wb9GlRHoIPqmLZA7grAnFTp6XH8","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763528242943,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$sFehrfj_GKEENlvXubzXZNbiHo-H3lIhlOtSrK1SROo"},
{"content":{"body":"Certainly not. See https://github.com/tc39/proposal-cancellation","m.mentions":{"user_ids":["@jakea:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$sNfcxyZuxCKfbAZfVE7lXboPWe-fALoR2BOAbIZtChQ"}},"msgtype":"m.text"},"ts":1763528246475,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$OgTnvbv5Ymiqm3WAOgIjI2Fto8XVYglRUxwBFP6ojM4"},
{"content":{"body":"I feel like `keyCount` reads less awkwardly than `keysLength`.","format":"org.matrix.custom.html","formatted_body":"I feel like <code>keyCount</code> reads less awkwardly than <code>keysLength</code>.","m.mentions":{},"msgtype":"m.text"},"ts":1763528286905,"senderName":"danielrosenwasser","senderId":"@danielrosenwasser:matrix.org","id":"$-KPWKl6wZQupV8N6IB37Gs1dkgepwsT305qm-LC-USs"},
{"content":{"body":"that's a reasonable thing to bikeshed within stage 2 :-)","m.mentions":{},"msgtype":"m.text"},"ts":1763528340481,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$eCnQN02OCNLAEaDdj7ivc47iJh572pudwSByNw0YzZA"},
{"content":{"body":"or generally xsLength -> xCount","m.mentions":{},"msgtype":"m.text"},"ts":1763528342976,"senderName":"rkirsling","senderId":"@rkirsling:matrix.org","id":"$N1eGnZZOeUDL8-3ub99Atf3vCMg2U_TpVYrzrMEtGp8"},
{"content":{"body":"sign me up for the abort call plz ðŸ˜„","m.mentions":{},"msgtype":"m.text"},"ts":1763528364072,"senderName":"ptomato","senderId":"@pchimento:igalia.com","id":"$qIKGfVaOX2YxWzJBooPyUdFqKeOEai8cVmdFR6H68Bg"},
{"content":{"body":"Promise cancellation as a 3rd state was abandoned, not cancellation","format":"org.matrix.custom.html","formatted_body":"Promise cancellation as a 3rd state was abandoned, not cancellation","m.mentions":{"user_ids":["@jakea:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$sNfcxyZuxCKfbAZfVE7lXboPWe-fALoR2BOAbIZtChQ"}},"msgtype":"m.text"},"ts":1763528377898,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$1iab0K0dABBpdRri1ZjxZj4uk9tZzNfdH6Q28ivWc64"},
{"content":{"body":"do web-machinery things also remove their listener once their task has finished?\nA thing I've come across is: long lived abortSignal with lots of shortLived user tasks and it leaks listeners","m.mentions":{"user_ids":["@bakkot:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$6l0eTq-aGQCsYBoXPq0vderIhjccqiJMhc_RaI-HMpo"}},"msgtype":"m.text"},"ts":1763528435179,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$wyUD-nQcKgfBY2Vp2m3UHGDJ-8HlYoKDxoV5B2Umk04"},
{"content":{"body":"yes","m.mentions":{},"msgtype":"m.text"},"ts":1763528442714,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$LPFkOs3mHBjLEX4OvrBpxa-YhSy9YlCKXn70BXHfLuA"},
{"content":{"body":"I think `getOwnPropertyNameCount` is actually worse ðŸ˜…","format":"org.matrix.custom.html","formatted_body":"I think <code>getOwnPropertyNameCount</code> is actually worse ðŸ˜…","m.mentions":{},"msgtype":"m.text"},"ts":1763528453850,"senderName":"danielrosenwasser","senderId":"@danielrosenwasser:matrix.org","id":"$f1y2u049DVySjSGvq3UBT-i9W8DI2G6miuCELvY5vig"},
{"content":{"body":"My major concerns with AbortController were:\n- Dependence on DOM-specific eventing/exceptions.\n- DOM APIs privileged over user code\n- Poor separation of concerns (user listeners for `abort` can be fooled by `.dispatchEvent`)\n- No single use `abort` for user code (again, due to `dispatchEvent`)\n- No cancellation graphs (somewhat addressed over the years, but not well), so memory leaks abound","format":"org.matrix.custom.html","formatted_body":"<p>My major concerns with AbortController were:</p>\n<ul>\n<li>Dependence on DOM-specific eventing/exceptions.</li>\n<li>DOM APIs privileged over user code</li>\n<li>Poor separation of concerns (user listeners for <code>abort</code> can be fooled by <code>.dispatchEvent</code>)</li>\n<li>No single use <code>abort</code> for user code (again, due to <code>dispatchEvent</code>)</li>\n<li>No cancellation graphs (somewhat addressed over the years, but not well), so memory leaks abound</li>\n</ul>\n","m.mentions":{},"msgtype":"m.text"},"ts":1763528454984,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$cx-rkmNPJziRwzuTOxWVZqcHpurv4f8SCUPf4JMzaD0"},
{"content":{"body":"see https://dom.spec.whatwg.org/#run-the-abort-steps","m.mentions":{},"msgtype":"m.text"},"ts":1763528458611,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$N5qzB9QCa5IqUJkhtU-SjXUg_74CkkjKtGm_41Uk0Qo"},
{"content":{"body":"* My major concerns with AbortController are:\n\n- Dependence on DOM-specific eventing/exceptions.\n- DOM APIs privileged over user code\n- Poor separation of concerns (user listeners for `abort` can be fooled by `.dispatchEvent`)\n- No single use `abort` for user code (again, due to `dispatchEvent`)\n- No cancellation graphs (somewhat addressed over the years, but not well), so memory leaks abound","format":"org.matrix.custom.html","formatted_body":"* <p>My major concerns with AbortController are:</p>\n<ul>\n<li>Dependence on DOM-specific eventing/exceptions.</li>\n<li>DOM APIs privileged over user code</li>\n<li>Poor separation of concerns (user listeners for <code>abort</code> can be fooled by <code>.dispatchEvent</code>)</li>\n<li>No single use <code>abort</code> for user code (again, due to <code>dispatchEvent</code>)</li>\n<li>No cancellation graphs (somewhat addressed over the years, but not well), so memory leaks abound</li>\n</ul>\n","m.mentions":{},"m.new_content":{"body":"My major concerns with AbortController are:\n\n- Dependence on DOM-specific eventing/exceptions.\n- DOM APIs privileged over user code\n- Poor separation of concerns (user listeners for `abort` can be fooled by `.dispatchEvent`)\n- No single use `abort` for user code (again, due to `dispatchEvent`)\n- No cancellation graphs (somewhat addressed over the years, but not well), so memory leaks abound","format":"org.matrix.custom.html","formatted_body":"<p>My major concerns with AbortController are:</p>\n<ul>\n<li>Dependence on DOM-specific eventing/exceptions.</li>\n<li>DOM APIs privileged over user code</li>\n<li>Poor separation of concerns (user listeners for <code>abort</code> can be fooled by <code>.dispatchEvent</code>)</li>\n<li>No single use <code>abort</code> for user code (again, due to <code>dispatchEvent</code>)</li>\n<li>No cancellation graphs (somewhat addressed over the years, but not well), so memory leaks abound</li>\n</ul>\n","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$cx-rkmNPJziRwzuTOxWVZqcHpurv4f8SCUPf4JMzaD0","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763528464791,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$g148klVhemYcGfodCvcKeqP4raxwqBYaDXJuSFDL_C8"},
{"content":{"body":"I'm gonna totally lose track of everyone interested in this chat. I'll post the doodle link likely on monday and will send invites to anyone who responds","m.mentions":{"user_ids":["@jridgewell:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$1iab0K0dABBpdRri1ZjxZj4uk9tZzNfdH6Q28ivWc64"}},"msgtype":"m.text"},"ts":1763528471602,"senderName":"James M Snell","senderId":"@jasnell:matrix.org","id":"$IL-wmwqK1mrUqZIX2GhTrkuEOSTcYmmp_c_4SjprZsI"},
{"content":{"body":"\"Empty signalâ€™s abort algorithms.\" is the bit which removes existing web-machinery listeners","m.mentions":{},"msgtype":"m.text"},"ts":1763528475859,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$LMUtdidCChgabKif1Uh6Ru0W4ATMvv_IQJrMC8TkdDc"},
{"content":{"body":"bakkot: The reason AbortSignal uses events is just because that's kinda the standard on the web platform for callbacks. But given there are other benefits to avoiding events, your proposal seems reasonable","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@bakkot:matrix.org\">bakkot</a>: The reason AbortSignal uses events is just because that's kinda the standard on the web platform for callbacks. But given there are other benefits to avoiding events, your proposal seems reasonable","m.mentions":{"user_ids":["@bakkot:matrix.org"]},"msgtype":"m.text"},"ts":1763528478509,"senderName":"Jake Archibald","senderId":"@jakea:matrix.org","id":"$vVkpGbnMin7XfeE0SBwcQEurtQVN19gD68xUezlrqG4"},
{"content":{"body":"Almost always when I find a need to call `Object.keys(...).length`, all I really want to know is whether I have an empty `{}` object, or something else.","format":"org.matrix.custom.html","formatted_body":"Almost always when I find a need to call <code>Object.keys(...).length</code>, all I really want to know is whether I have an empty <code>{}</code> object, or something else.","m.mentions":{},"msgtype":"m.text"},"ts":1763528506720,"senderName":"eemeli","senderId":"@eemeli:mozilla.org","id":"$TaI6e73dFWxrwQCzypdHf8Mcm3kRIHtBGabjCewP4V0"},
{"content":{"body":"or, wait, I think I read your question backwards?","m.mentions":{"user_ids":["@aclaymore:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$wyUD-nQcKgfBY2Vp2m3UHGDJ-8HlYoKDxoV5B2Umk04"}},"msgtype":"m.text"},"ts":1763528509290,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$Sr1ncczoFZCNy4VUroPL5AqB29J_Y21ovrOthwaQfws"},
{"content":{"body":"I don't actually know but I don't think it's observable, because the listeners are purely internal","m.mentions":{},"msgtype":"m.text"},"ts":1763528527023,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$KdPxoCBL4ULVhqc4JMXujwPdLR48uikAlktX3sMc9a8"},
{"content":{"body":"Can you imagine if DOM shipped `Future` using DOM events instead of `then`? IIRC, that wasn't even on the table for `Future` before it was adopted by 262 as `Promise`.","format":"org.matrix.custom.html","formatted_body":"Can you imagine if DOM shipped <code>Future</code> using DOM events instead of <code>then</code>? IIRC, that wasn't even on the table for <code>Future</code> before it was adopted by 262 as <code>Promise</code>.","m.mentions":{},"msgtype":"m.text"},"ts":1763528553546,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$y5LYz2GwBU0IUX5aJZpOtD6NKmhPqD-eyOtusoJAjyY"},
{"content":{"body":"What is there to be gained? Is this really totally un-optimizable for implementers, if it such a common pattern?","m.mentions":{},"msgtype":"m.text"},"ts":1763528574133,"senderName":"Christian Ulbrich","senderId":"@christianulbrich:matrix.org","id":"$zTKNUMfb94jz7v5GYPxzl9nFWOAFJAu4qhfuXiMfpj8"},
{"content":{"body":"I kinda want abortSignal listener add to have Symbol.dispose ","m.mentions":{},"msgtype":"m.text"},"ts":1763528585424,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$L3Dbjubsd_ODJiy7Q_56GnQHUmuuGlOTvwtS3gUf3yg"},
{"content":{"body":"TCQ doesn't let me add a reply ","m.mentions":{},"msgtype":"m.text"},"ts":1763528603135,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$kPV4OwoxGcJyJ9urOb0c8Zou-aBjgSnqvGw0AGsLPyo"},
{"content":{"body":"see Nic's clarifying Q :)","m.mentions":{"user_ids":["@mhofman:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$kPV4OwoxGcJyJ9urOb0c8Zou-aBjgSnqvGw0AGsLPyo"}},"msgtype":"m.text"},"ts":1763528622111,"senderName":"jkup","senderId":"@jkup:matrix.org","id":"$S8MTairJAOLXjxRSBNPS1T-x4kZs76jqI0h7LXe-dCc"},
{"content":{"body":"hey! I hoist the options bags","m.mentions":{},"msgtype":"m.text"},"ts":1763528626757,"senderName":"ptomato","senderId":"@pchimento:igalia.com","id":"$bbywqYg_VpRK38FXGoaBqFjpdUy5nw-PLChJVoKdUws"},
{"content":{"body":"yeah this completely perplexes me","format":"org.matrix.custom.html","formatted_body":"yeah this completely perplexes me","m.mentions":{"user_ids":["@christianulbrich:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$zTKNUMfb94jz7v5GYPxzl9nFWOAFJAu4qhfuXiMfpj8"}},"msgtype":"m.text"},"ts":1763528629774,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$a5LB-uvbD3WARyVZjgIzkLujyZeV0Uzv2jDfXPkNaRo"},
{"content":{"body":"refresh? I had to re-auth recently","format":"org.matrix.custom.html","formatted_body":"refresh? I had to re-auth recently","m.mentions":{"user_ids":["@mhofman:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$kPV4OwoxGcJyJ9urOb0c8Zou-aBjgSnqvGw0AGsLPyo"}},"msgtype":"m.text"},"ts":1763528648706,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$Rc7K8xYriNIN0SXNfh_e8ycKDABLGoG5rmSnk4xHvIA"},
{"content":{"body":"static interned inline composites could be safely hoisted by tools ðŸ˜Ž","m.mentions":{},"msgtype":"m.text"},"ts":1763528734776,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$33ss9353Sl-OS8YLD22lNt8fV18LE5V5snza-_el-Ho"},
{"content":{"body":"bakkot: \n> I don't understand why the web platform uses a completely different set of infrastructure for abortables\n\nWeb specs never use events internally.","format":"org.matrix.custom.html","formatted_body":"<p><a href=\"https://matrix.to/#/@bakkot:matrix.org\">bakkot</a>:</p>\n<blockquote>\n<p>I don't understand why the web platform uses a completely different set of infrastructure for abortables</p>\n</blockquote>\n<p>Web specs never use events internally.</p>\n","m.mentions":{"user_ids":["@bakkot:matrix.org"]},"msgtype":"m.text"},"ts":1763528744792,"senderName":"Jake Archibald","senderId":"@jakea:matrix.org","id":"$SEkMc7DHB7XVZiVF2RRLo5xMxlyCtDEAp479xImIQ7c"},
{"content":{"body":"I mean apart from a theoretical point of view, how often is this used in critical paths?","m.mentions":{},"msgtype":"m.text"},"ts":1763528749979,"senderName":"Christian Ulbrich","senderId":"@christianulbrich:matrix.org","id":"$JOGXl4abVda-Qmsi9cMSpqpj-JtsX84K0V3iE8qezNk"},
{"content":{"body":"* bakkot:\n\n> I don't understand why the web platform uses a completely different set of infrastructure for abortables\n\nWeb specs never listen to events internally.","format":"org.matrix.custom.html","formatted_body":"* <p><a href=\"https://matrix.to/#/@bakkot:matrix.org\">bakkot</a>:</p>\n<blockquote>\n<p>I don't understand why the web platform uses a completely different set of infrastructure for abortables</p>\n</blockquote>\n<p>Web specs never listen to events internally.</p>\n","m.mentions":{},"m.new_content":{"body":"bakkot:\n\n> I don't understand why the web platform uses a completely different set of infrastructure for abortables\n\nWeb specs never listen to events internally.","format":"org.matrix.custom.html","formatted_body":"<p><a href=\"https://matrix.to/#/@bakkot:matrix.org\">bakkot</a>:</p>\n<blockquote>\n<p>I don't understand why the web platform uses a completely different set of infrastructure for abortables</p>\n</blockquote>\n<p>Web specs never listen to events internally.</p>\n","m.mentions":{"user_ids":["@bakkot:matrix.org"]},"msgtype":"m.text"},"m.relates_to":{"event_id":"$SEkMc7DHB7XVZiVF2RRLo5xMxlyCtDEAp479xImIQ7c","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763528764383,"senderName":"Jake Archibald","senderId":"@jakea:matrix.org","id":"$t3C6rXMa4VbJQ1rzjoUeB4k9luEcAXKm9QD3mbo10AQ"},
{"content":{"body":"well... but like... why","m.mentions":{"user_ids":["@jakea:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$SEkMc7DHB7XVZiVF2RRLo5xMxlyCtDEAp479xImIQ7c"}},"msgtype":"m.text"},"ts":1763528766526,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$R4368cssQkZD_U6YIPZoba8WEGOHZSCd5UGIcpC95sg"},
{"content":{"body":"like if it's recognized that web platform should get to use better infrastructure... why doesn't userland get to use better infrastructure?","m.mentions":{},"msgtype":"m.text"},"ts":1763528787709,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$KBF7ktGipyzay-3oBdrR-x9iTVr1yaLhN3INWCfVy4k"},
{"content":{"body":"reply button is back!  ðŸŽ‰","m.mentions":{"user_ids":["@mhofman:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$kPV4OwoxGcJyJ9urOb0c8Zou-aBjgSnqvGw0AGsLPyo"}},"msgtype":"m.text"},"ts":1763528798648,"senderName":"Chris de Almeida","senderId":"@softwarechris:matrix.org","id":"$gmZpEMRYlOWwr_aJQ0YreV8KDELQw8MrABsCyE_ZPYU"},
{"content":{"body":"My proposal originally had something like:\n```\nclass CancelSource {\n  constructor(...linkedTokens: CancelToken[]);\n  token: CancelToken;\n  cancel(): void;\n  close(): void;\n}\nclass CancelToken {\n  static canceled: CancelToken;\n  static none: CancelToken;\n  subscribe(cb): CancelSubscription; // disposable\n  get canceled(): boolean;\n  get canBeCanceled(): boolean;\n}\n```","format":"org.matrix.custom.html","formatted_body":"<p>My proposal originally had something like:</p>\n<pre><code>class CancelSource {\n  constructor(...linkedTokens: CancelToken[]);\n  token: CancelToken;\n  cancel(): void;\n  close(): void;\n}\nclass CancelToken {\n  static canceled: CancelToken;\n  static none: CancelToken;\n  subscribe(cb): CancelSubscription; // disposable\n  get canceled(): boolean;\n  get canBeCanceled(): boolean;\n}\n</code></pre>\n","m.mentions":{"user_ids":["@aclaymore:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$L3Dbjubsd_ODJiy7Q_56GnQHUmuuGlOTvwtS3gUf3yg"}},"msgtype":"m.text"},"ts":1763528810174,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$KAB--M7lOiq-Ig31vFl-jHeI7q85p5eLHfVE90DfPx0"},
{"content":{"body":"the many many use cases that ruben and i looked over were definitely not just needing that simple a semantic","m.mentions":{"user_ids":["@eemeli:mozilla.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$TaI6e73dFWxrwQCzypdHf8Mcm3kRIHtBGabjCewP4V0"}},"msgtype":"m.text"},"ts":1763528810667,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$rdWizs_Pl_jHjnNhYrKlySPdn-tEVke5FRsj_tBhDl4"},
{"content":{"body":"bakkot: it's not a better vs worse thing. It's the same reason why internal methods are called rather than directly calling exposed interfaces.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@bakkot:matrix.org\">bakkot</a>: it's not a better vs worse thing. It's the same reason why internal methods are called rather than directly calling exposed interfaces.","m.mentions":{"user_ids":["@bakkot:matrix.org"]},"msgtype":"m.text"},"ts":1763528844873,"senderName":"Jake Archibald","senderId":"@jakea:matrix.org","id":"$MvAqiNtSv6T3QYOACfUOLh6GohWOKBjqu6RXxaymlA0"},
{"content":{"body":"this discussion as a whole feels very like, supportive of a problem statement and not a solution, hm","m.mentions":{},"msgtype":"m.text"},"ts":1763528888871,"senderName":"rkirsling","senderId":"@rkirsling:matrix.org","id":"$u0tJdkt716DjUFd5e6FWsJh3BT_h8THQ3uB3XxMRyxo"},
{"content":{"body":"it could be using entirely internal methods and still same the same machinery, though","m.mentions":{},"msgtype":"m.text"},"ts":1763528905153,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$mOWUmvx22eQpZzhNn4IeZRsWMpdmVl_CArJ081Yyye4"},
{"content":{"body":"keith_miller: what was that 40% metric specifically?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@keith_miller:matrix.org\">keith_miller</a>: what was that 40% metric specifically?","m.mentions":{"user_ids":["@keith_miller:matrix.org"]},"msgtype":"m.text"},"ts":1763528909101,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$ShH2J-wC4ZsAL5CvkdwJtw2GTAtLqJEVaVufeR4rE9E"},
{"content":{"body":"so it is about counting keys, properties or symbols and wether they are enumerable or not, how about them configurable? :D","m.mentions":{},"msgtype":"m.text"},"ts":1763528912403,"senderName":"Christian Ulbrich","senderId":"@christianulbrich:matrix.org","id":"$lAYgWiwWFScZtNsfLfPaKwqfngW7BbPbAX6xYWogkio"},
{"content":{"body":"Any idea what sort of percentage is testing the value against 0, vs. doing somethign else?","m.mentions":{"user_ids":["@ljharb:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$rdWizs_Pl_jHjnNhYrKlySPdn-tEVke5FRsj_tBhDl4"}},"msgtype":"m.text"},"ts":1763528915345,"senderName":"eemeli","senderId":"@eemeli:mozilla.org","id":"$iGyEcyJxcShzF0E2Px3rf0KJuaQtiQI8nb3X-tQbKYM"},
{"content":{"body":"there's no reason that AbortController needs to have a separate privileged list of web-platform things to trigger on abort, instead of just adding web-level things to the existing list of callbacks to call","m.mentions":{},"msgtype":"m.text"},"ts":1763528936519,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$0jl_f734xMT4qlu5Vgb8tNuDy_S6qDGAfYfHhExd3cc"},
{"content":{"body":"bakkot: similar to JS, if you override `globalThis.Array`, that isn't called by internal JS things that create arrays","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@bakkot:matrix.org\">bakkot</a>: similar to JS, if you override <code>globalThis.Array</code>, that isn't called by internal JS things that create arrays","m.mentions":{"user_ids":["@bakkot:matrix.org"]},"msgtype":"m.text"},"ts":1763528940528,"senderName":"Jake Archibald","senderId":"@jakea:matrix.org","id":"$MhalDvFqsPUi7C5CjXnagnpOGho8Mm2k-cYKCoCMtr4"},
{"content":{"body":"the vast vast majority where it's just counting care about enumerable properties and/or symbols","m.mentions":{"user_ids":["@eemeli:mozilla.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$iGyEcyJxcShzF0E2Px3rf0KJuaQtiQI8nb3X-tQbKYM"}},"msgtype":"m.text"},"ts":1763528945105,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$yoOVbycXyyBUNHnGx5AfVCJfhqP-KlJQhzOr-rcE7Cg"},
{"content":{"body":"Code that goes through the optimizing compiler","m.mentions":{},"m.relates_to":{"event_id":"$ShH2J-wC4ZsAL5CvkdwJtw2GTAtLqJEVaVufeR4rE9E","is_falling_back":true,"m.in_reply_to":{"event_id":"$ShH2J-wC4ZsAL5CvkdwJtw2GTAtLqJEVaVufeR4rE9E"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1763529004926,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$VIS29Xa0MWbr52nbupj3GcujRaN9ey_09IW0mOX22MQ"},
{"content":{"body":"I'm not asking about literally doing `.addEventListener`, just about having only a single internal list of things to trigger on abort, instead of having two lists","format":"org.matrix.custom.html","formatted_body":"I'm not asking about literally doing <code>.addEventListener</code>, just about having only a single internal list of things to trigger on abort, instead of having two lists","m.mentions":{"user_ids":["@jakea:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$MhalDvFqsPUi7C5CjXnagnpOGho8Mm2k-cYKCoCMtr4"}},"msgtype":"m.text"},"ts":1763529005873,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$ss5j4GDuKecksXZCmg_UsRQkIdxVC9PKV7Y5AuhZ0JE"},
{"content":{"body":"the one place this does happen (which is evil) is `Array.prototype.toString` dynamically looks up `Array.prototype.join` - not the original.","format":"org.matrix.custom.html","formatted_body":"the one place this does happen (which is evil) is <code>Array.prototype.toString</code> dynamically looks up <code>Array.prototype.join</code> - not the original.","m.mentions":{"user_ids":["@jakea:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$MhalDvFqsPUi7C5CjXnagnpOGho8Mm2k-cYKCoCMtr4"}},"msgtype":"m.text"},"ts":1763529014398,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$OSjg77c5omeoz4WgBPlhVfQJQ6TiHSiYKvE9BCMbLWo"},
{"content":{"body":"bakkot: basically, it isn't a deliberate choice to give web devs something bad and retain something good for internal use - and taking it to the WHATWG with that as an immutable assumption will get in the way of progress","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@bakkot:matrix.org\">bakkot</a>: basically, it isn't a deliberate choice to give web devs something bad and retain something good for internal use - and taking it to the WHATWG with that as an immutable assumption will get in the way of progress","m.mentions":{"user_ids":["@bakkot:matrix.org"]},"msgtype":"m.text"},"ts":1763529017437,"senderName":"Jake Archibald","senderId":"@jakea:matrix.org","id":"$0TY97-0roxWGZ6IULu90r2tO3Sdyp4R_FtKTskOcc2M"},
{"content":{"body":"tip for newcomers: some people find it a bit rude to look ahead on the queue and make assumptions about what somebody is going to say (and pre-reply, putting words in their mouth)","m.mentions":{},"msgtype":"m.text"},"ts":1763529030449,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$i5k_GcRLktdRICXW3bnFzlJg20gzeGSOsfsfhY7rQAE"},
{"content":{"body":"40% of code on internal page loads or Speedometer get to optimizing tiers yeah","m.mentions":{},"m.relates_to":{"event_id":"$ShH2J-wC4ZsAL5CvkdwJtw2GTAtLqJEVaVufeR4rE9E","is_falling_back":true,"m.in_reply_to":{"event_id":"$VIS29Xa0MWbr52nbupj3GcujRaN9ey_09IW0mOX22MQ"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1763529038728,"senderName":"keith_miller","senderId":"@keith_miller:matrix.org","id":"$KLRERB84mIdErum41ewb5SZFO_O4YYeDpoAAlGoLito"},
{"content":{"body":"* My proposal originally had something like:\n\n```\nclass CancelSource {\n  constructor(...linkedTokens: CancelToken[]);\n  token: CancelToken;\n  cancel(): void;\n  close(): void;\n}\nclass CancelToken {\n  static canceled: CancelToken;\n  static none: CancelToken;\n  get canceled(): boolean;\n  get canBeCanceled(): boolean;\n  get reason(): unknown;\n  subscribe(cb): CancelSubscription; // disposable\n  throwIfCanceled(): void;\n}\n```","format":"org.matrix.custom.html","formatted_body":"* <p>My proposal originally had something like:</p>\n<pre><code>class CancelSource {\n  constructor(...linkedTokens: CancelToken[]);\n  token: CancelToken;\n  cancel(): void;\n  close(): void;\n}\nclass CancelToken {\n  static canceled: CancelToken;\n  static none: CancelToken;\n  get canceled(): boolean;\n  get canBeCanceled(): boolean;\n  get reason(): unknown;\n  subscribe(cb): CancelSubscription; // disposable\n  throwIfCanceled(): void;\n}\n</code></pre>\n","m.mentions":{},"m.new_content":{"body":"My proposal originally had something like:\n\n```\nclass CancelSource {\n  constructor(...linkedTokens: CancelToken[]);\n  token: CancelToken;\n  cancel(): void;\n  close(): void;\n}\nclass CancelToken {\n  static canceled: CancelToken;\n  static none: CancelToken;\n  get canceled(): boolean;\n  get canBeCanceled(): boolean;\n  get reason(): unknown;\n  subscribe(cb): CancelSubscription; // disposable\n  throwIfCanceled(): void;\n}\n```","format":"org.matrix.custom.html","formatted_body":"<p>My proposal originally had something like:</p>\n<pre><code>class CancelSource {\n  constructor(...linkedTokens: CancelToken[]);\n  token: CancelToken;\n  cancel(): void;\n  close(): void;\n}\nclass CancelToken {\n  static canceled: CancelToken;\n  static none: CancelToken;\n  get canceled(): boolean;\n  get canBeCanceled(): boolean;\n  get reason(): unknown;\n  subscribe(cb): CancelSubscription; // disposable\n  throwIfCanceled(): void;\n}\n</code></pre>\n","m.mentions":{"user_ids":["@aclaymore:matrix.org"]},"msgtype":"m.text"},"m.relates_to":{"event_id":"$KAB--M7lOiq-Ig31vFl-jHeI7q85p5eLHfVE90DfPx0","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763529058802,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$c4jrTcW9Uzcm9pdip8IR0aJ0aivhGAPU0z4E8kHuHq4"},
{"content":{"body":"bakkot: otherwise I understand your proposal and it seems reasonable. I'm just giving context for why things were designed as they were","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@bakkot:matrix.org\">bakkot</a>: otherwise I understand your proposal and it seems reasonable. I'm just giving context for why things were designed as they were","m.mentions":{"user_ids":["@bakkot:matrix.org"]},"msgtype":"m.text"},"ts":1763529083746,"senderName":"Jake Archibald","senderId":"@jakea:matrix.org","id":"$ss12ZtoervAh80c14_2J2yc5NNw65loOA6vi4lAEJ7s"},
{"content":{"body":"sorry, to be clear I didn't think it was deliberately good for web and bad for users! just that the actual effect of splitting the machinery is that it has had the consequence that the user things are stuck with something with a bunch of bad properties which the web gets to avoid","m.mentions":{"user_ids":["@jakea:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$0TY97-0roxWGZ6IULu90r2tO3Sdyp4R_FtKTskOcc2M"}},"msgtype":"m.text"},"ts":1763529091513,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$RPw1eOwjZl_MAbGvtdVyzm7SstiShFMvAPJs1w-QvPg"},
{"content":{"body":"yes, thank you, I appreciate the context","m.mentions":{"user_ids":["@jakea:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$ss12ZtoervAh80c14_2J2yc5NNw65loOA6vi4lAEJ7s"}},"msgtype":"m.text"},"ts":1763529105223,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$h8cEADHWEqhXyUfGs34tZcJ2VPDZq3AOOBbQ8Tm9dfI"},
{"content":{"body":"Infomaniak, swiss hosting","m.mentions":{},"m.relates_to":{"event_id":"$ImJEGL4jVPjglIdFw5VKqe-xUT5BCnk0cZATYZJLLVE","is_falling_back":true,"m.in_reply_to":{"event_id":"$jHf7dWq03Nq7EZpjcTYYpqhDSQoGT0FNeepmLPM5lRI"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1763529121399,"senderName":"Aki","senderId":"@akirose:matrix.org","id":"$NJJ98oI-UCQEBZQDopP5sEHb1X1jxCNN48zgTeI8aWk"},
{"content":{"body":"I ended up implementing something like this (`@esfx/canceltoken`, docs here: https://esfx.js.org/esfx/api/canceltoken/canceltoken.html#_esfx_canceltoken_CancelToken_class). It even theoretically works in place of `AbortSignal` on the web as it repurposes an `AbortSignal` instance with custom `[[Prototype]]`.","format":"org.matrix.custom.html","formatted_body":"I ended up implementing something like this (<code>@esfx/canceltoken</code>, docs here: https://esfx.js.org/esfx/api/canceltoken/canceltoken.html#_esfx_canceltoken_CancelToken_class). It even theoretically works in place of <code>AbortSignal</code> on the web as it repurposes an <code>AbortSignal</code> instance with custom <code>[[Prototype]]</code>.","m.mentions":{},"m.relates_to":{"m.in_reply_to":{"event_id":"$KAB--M7lOiq-Ig31vFl-jHeI7q85p5eLHfVE90DfPx0"}},"msgtype":"m.text"},"ts":1763529404564,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$EE7_nODHIGHEJHuKO98i6ztNzwsuiIiVJL-lTXuAlxc"},
{"content":{"body":"chipmorningstar: https://bugzilla.mozilla.org/show_bug.cgi?id=1914502 shallowEquals in react is one of the hottest functions, and uses this pattern ","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@chipmorningstar:matrix.org\">chipmorningstar</a>: https://bugzilla.mozilla.org/show_bug.cgi?id=1914502 shallowEquals in react is one of the hottest functions, and uses this pattern","m.mentions":{"user_ids":["@chipmorningstar:matrix.org"]},"msgtype":"m.text"},"ts":1763529720343,"senderName":"mgaudet|travelling","senderId":"@mgaudet:mozilla.org","id":"$w_3hdu7BMLynOWG4a2xKJ30BtiTtBqFJDGCRsxQRFMA"},
{"content":{"body":"bakkot: It'd be nice to keep `throwIfAborted()`. I guess JS will need an `AbortError`. As long as it passes `err instanceof Error && err.name === 'AbortError'`, that seems fine","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@bakkot:matrix.org\">bakkot</a>: It'd be nice to keep <code>throwIfAborted()</code>. I guess JS will need an <code>AbortError</code>. As long as it passes <code>err instanceof Error &amp;&amp; err.name === 'AbortError'</code>, that seems fine","m.mentions":{"user_ids":["@bakkot:matrix.org"]},"msgtype":"m.text"},"ts":1763529737613,"senderName":"Jake Archibald","senderId":"@jakea:matrix.org","id":"$WLH7nXhLoB0zf6XcYN6_NXwfKmYlLfYSX0z7xC8IFz0"},
{"content":{"body":"Yeah chipmorningstar I am totally with you. And giving what nicolo-ribaudo said, I think we have to see real usages in the wild with actual numbers in critical paths.","format":"org.matrix.custom.html","formatted_body":"Yeah <a href=\"https://matrix.to/#/@chipmorningstar:matrix.org\">chipmorningstar</a> I am totally with you. And giving what <a href=\"https://matrix.to/#/@nicolo-ribaudo:matrix.org\">nicolo-ribaudo</a> said, I think we have to see real usages in the wild with actual numbers in critical paths.","m.mentions":{"user_ids":["@chipmorningstar:matrix.org","@nicolo-ribaudo:matrix.org"]},"msgtype":"m.text"},"ts":1763529825218,"senderName":"Christian Ulbrich","senderId":"@christianulbrich:matrix.org","id":"$HL1JuUL4phjXvUohasfrXSz8VCk8cpZf9Y1sFeXv7y0"},
{"content":{"body":"I'd also considered `source.cancel(reason)` so you could cancel with a specific reason, not just `AbortError`.","format":"org.matrix.custom.html","formatted_body":"I'd also considered <code>source.cancel(reason)</code> so you could cancel with a specific reason, not just <code>AbortError</code>.","m.mentions":{"user_ids":["@jakea:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$WLH7nXhLoB0zf6XcYN6_NXwfKmYlLfYSX0z7xC8IFz0"}},"msgtype":"m.text"},"ts":1763529831343,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$p3EDU1ol0inMSLW8p1SMd918kx_JRi6UfDYO0q4lD48"},
{"content":{"body":"it can also be `HostCreateAbortError()`","format":"org.matrix.custom.html","formatted_body":"it can also be <code>HostCreateAbortError()</code>","m.mentions":{"user_ids":["@jakea:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$WLH7nXhLoB0zf6XcYN6_NXwfKmYlLfYSX0z7xC8IFz0"}},"msgtype":"m.text"},"ts":1763529866043,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$_dEIILcm2YhMJixhP5VqwbWa2F2Ge874m8gYqvgbw7s"},
{"content":{"body":"rbuckton: `controller.abort()` has that too","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@rbuckton:matrix.org\">rbuckton</a>: <code>controller.abort()</code> has that too","m.mentions":{"user_ids":["@rbuckton:matrix.org"]},"msgtype":"m.text"},"ts":1763529894343,"senderName":"Jake Archibald","senderId":"@jakea:matrix.org","id":"$aJZz99fT-JtVcxgFzb0HcWuegf0LtaqFVw7aFn1cy1k"},
{"content":{"body":"snek: yeah that's fine, I'd just like there to be a cross-platform way to tell an 'abort' from other things.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@devsnek:matrix.org\">snek</a>: yeah that's fine, I'd just like there to be a cross-platform way to tell an 'abort' from other things.","m.mentions":{"user_ids":["@devsnek:matrix.org"]},"msgtype":"m.text"},"ts":1763529931947,"senderName":"Jake Archibald","senderId":"@jakea:matrix.org","id":"$wu1Wez371yPvKaAYwbWmP3R0arVwJvDXiRO-qKpfJso"},
{"content":{"body":"Can we just have a cancellation protocol (`obj[Symbol.subscribeForCancellation](cb)`), and have web AbortSignal do that? And the web AbortSignal uses the good algorithm for it","format":"org.matrix.custom.html","formatted_body":"Can we just have a cancellation protocol (<code>obj[Symbol.subscribeForCancellation](cb)</code>), and have web AbortSignal do that? And the web AbortSignal uses the good algorithm for it","m.mentions":{},"msgtype":"m.text"},"ts":1763529939759,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$aWJVMWbf4nHk1MnC9YnNIo9ZqvVJNH0Av2ETXMIWocQ"},
{"content":{"body":"And then our APIs can just use that protocol","m.mentions":{},"msgtype":"m.text"},"ts":1763529945451,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$CVPf-xsoQDP-7wjClsRnmIYyNQcoXPZY-73IAvmCZFg"},
{"content":{"body":"rbuckton: https://dom.spec.whatwg.org/#dom-abortsignal-abort","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@rbuckton:matrix.org\">rbuckton</a>: https://dom.spec.whatwg.org/#dom-abortsignal-abort","m.mentions":{"user_ids":["@rbuckton:matrix.org"]},"msgtype":"m.text"},"ts":1763529953594,"senderName":"Jake Archibald","senderId":"@jakea:matrix.org","id":"$4KHz1C_OOBjx08vohqOXHNKh38kbqXqApLQIcJsoF1U"},
{"content":{"body":"See https://github.com/tc39/proposal-cancellation/issues/22. Back in 2018 the answer ended up being \"No\"","m.mentions":{"user_ids":["@nicolo-ribaudo:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$aWJVMWbf4nHk1MnC9YnNIo9ZqvVJNH0Av2ETXMIWocQ"}},"msgtype":"m.text"},"ts":1763529980904,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$gGME9B3i80MwpZ6qdijR-zvSR10AbVFQccDCFj7FYcg"},
{"content":{"body":"* rbuckton: https://dom.spec.whatwg.org/#dom-abortcontroller-abort","format":"org.matrix.custom.html","formatted_body":"* <a href=\"https://matrix.to/#/@rbuckton:matrix.org\">rbuckton</a>: https://dom.spec.whatwg.org/#dom-abortcontroller-abort","m.mentions":{},"m.new_content":{"body":"rbuckton: https://dom.spec.whatwg.org/#dom-abortcontroller-abort","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@rbuckton:matrix.org\">rbuckton</a>: https://dom.spec.whatwg.org/#dom-abortcontroller-abort","m.mentions":{"user_ids":["@rbuckton:matrix.org"]},"msgtype":"m.text"},"m.relates_to":{"event_id":"$4KHz1C_OOBjx08vohqOXHNKh38kbqXqApLQIcJsoF1U","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763529997159,"senderName":"Jake Archibald","senderId":"@jakea:matrix.org","id":"$cpaHoEYWc6cBuIn4ROSCdGxBR1iCgjDxlLF8LwW6sKg"},
{"content":{"body":"The more time passes without a solution happening, the more people need to relax their constraint (if we gree that want some solution to happen)","m.mentions":{"user_ids":["@rbuckton:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$gGME9B3i80MwpZ6qdijR-zvSR10AbVFQccDCFj7FYcg"}},"msgtype":"m.text"},"ts":1763530061356,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$KGNPW3yVU7lR51Bknzwm1ekMKrA93tDj_Anrg4uYU8Q"},
{"content":{"body":"Jake Archibald: if you haven't seen it, here is the Stage 0 cancellation proposal from 2017: https://github.com/tc39/proposal-cancellation/tree/master/stage0","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@jakea:matrix.org\">Jake Archibald</a>: if you haven't seen it, here is the Stage 0 cancellation proposal from 2017: https://github.com/tc39/proposal-cancellation/tree/master/stage0","m.mentions":{"user_ids":["@jakea:matrix.org"]},"msgtype":"m.text"},"ts":1763530063796,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$rL-hGNyilnR6epEUQzgAazDiqeGq1dWM6QpYp7iqnwc"},
{"content":{"body":"I don't think the API name (in this proposal's case) is a Stage 2 concern","m.mentions":{},"msgtype":"m.text"},"ts":1763530080669,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$7VHtLikJvzoYl6r95A8-qeFZSkhIgFec8IPs2GYvFC4"},
{"content":{"body":"But I don't see in that issue why the answer ended up being no","m.mentions":{},"m.relates_to":{"m.in_reply_to":{"event_id":"$KGNPW3yVU7lR51Bknzwm1ekMKrA93tDj_Anrg4uYU8Q"}},"msgtype":"m.text"},"ts":1763530087621,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$whKgSykoJdNbYvvOzU_ebvnY3HeO7cBdJVnxhNKWUpM"},
{"content":{"body":"is there a reason to want this to be a symbol-named protocol instead of a string-named protocol? Because my plan was to add a string-named `whenAborted` or something to AbortSignal, which does the good algorithm, and have consumers like Governor do a call to the user-observable `.whenAborted`, which would make it de-facto a protocol ","format":"org.matrix.custom.html","formatted_body":"is there a reason to want this to be a symbol-named protocol instead of a string-named protocol? Because my plan was to add a string-named <code>whenAborted</code> or something to AbortSignal, which does the good algorithm, and have consumers like Governor do a call to the user-observable <code>.whenAborted</code>, which would make it de-facto a protocol","m.mentions":{"user_ids":["@nicolo-ribaudo:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$aWJVMWbf4nHk1MnC9YnNIo9ZqvVJNH0Av2ETXMIWocQ"}},"msgtype":"m.text"},"ts":1763530151880,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$o-F8zXojpJYlU3hjxxl_WYLUZA6YsJrOJjNkTQgTOGw"},
{"content":{"body":"also percent of spec text that the name occupies does not make one bit of difference","m.mentions":{},"msgtype":"m.text"},"ts":1763530160447,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$HgW6M2AI_VO3OnYmO1QJhVFWfm9X2W0xgUEFSQBX6iE"},
{"content":{"body":"I think symbol-named protocols are good for things where you want the protocol implemented on arbitrary objects","m.mentions":{},"msgtype":"m.text"},"ts":1763530164597,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$qyUgi0mEXKB9loigZ_WCANnNmxM5xk5j0T4pjn1tjDc"},
{"content":{"body":"like iterator","m.mentions":{},"msgtype":"m.text"},"ts":1763530168044,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$jqXM-yIgF7m5lNcJA3gPQjuJr91jUnqph2FVzRjjwSQ"},
{"content":{"body":"but don't see much reason for symbols for cases like this","m.mentions":{},"msgtype":"m.text"},"ts":1763530174079,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$uk1RooJk54DbuPg0gi9Hn9YFm6n0Kr-56RskVqM8Uk0"},
{"content":{"body":"I'd been working with Domenic Denicola on a solution and ended up being told later that the protocol idea was not going to be accepted and only thing WHATWG would consider would be a host hook.","m.mentions":{"user_ids":["@nicolo-ribaudo:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$whKgSykoJdNbYvvOzU_ebvnY3HeO7cBdJVnxhNKWUpM"}},"msgtype":"m.text"},"ts":1763530179052,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$---nzdxXrLGBnhEQdJLWfhPefK1OhG39xVvgAH9VcV8"},
{"content":{"body":"eemeli: do you know why Map & Set don't use `count`?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@eemeli:mozilla.org\">eemeli</a>: do you know why Map &amp; Set don't use <code>count</code>?","m.mentions":{"user_ids":["@eemeli:mozilla.org"]},"msgtype":"m.text"},"ts":1763530180758,"senderName":"Jake Archibald","senderId":"@jakea:matrix.org","id":"$Q9A4D3yRfhR4p58SdXhGC68hAMtvIhIYOn9Y5tbCg4o"},
{"content":{"body":"* but don't see much reason for symbol-named protocols for cases like this","m.mentions":{},"m.new_content":{"body":"but don't see much reason for symbol-named protocols for cases like this","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$uk1RooJk54DbuPg0gi9Hn9YFm6n0Kr-56RskVqM8Uk0","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763530182304,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$6W95kSaEUGJFRrXozqUdlQFZUipJQWXvb7VljngqhzM"},
{"content":{"body":"That the web API already has one way to register, and it can be confusing to have two","m.mentions":{"user_ids":["@bakkot:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$qyUgi0mEXKB9loigZ_WCANnNmxM5xk5j0T4pjn1tjDc"}},"msgtype":"m.text"},"ts":1763530194397,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$_BBZxyi5gbd3_t-PIdHqbAehEQt2NclbLggXql4QZj8"},
{"content":{"body":"you think it needs to happen before stage 2?","m.mentions":{"user_ids":["@michaelficarra:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$7VHtLikJvzoYl6r95A8-qeFZSkhIgFec8IPs2GYvFC4"}},"msgtype":"m.text"},"ts":1763530196776,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$Zzy4IF1scWMtzdZUDP2wa5A8PASP7KX4Kkx2PtqF2dY"},
{"content":{"body":"* you think it needs to be decidd before stage 2?","m.mentions":{},"m.new_content":{"body":"you think it needs to be decidd before stage 2?","m.mentions":{"user_ids":["@michaelficarra:matrix.org"]},"msgtype":"m.text"},"m.relates_to":{"event_id":"$Zzy4IF1scWMtzdZUDP2wa5A8PASP7KX4Kkx2PtqF2dY","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763530201882,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$kMaOIhgWbyB9Jj2L-A2aCOFp1e8s_RI30z8CVn8r1r4"},
{"content":{"body":"I don't want to object but this really feels premature","m.mentions":{},"msgtype":"m.text"},"ts":1763530202917,"senderName":"rkirsling","senderId":"@rkirsling:matrix.org","id":"$dOSD1k3wL422hDjdMBL-A9Wpx8kWgWxgg5mMyfKR7fE"},
{"content":{"body":"* you think it needs to be decided before stage 2?","m.mentions":{},"m.new_content":{"body":"you think it needs to be decided before stage 2?","m.mentions":{"user_ids":["@michaelficarra:matrix.org"]},"msgtype":"m.text"},"m.relates_to":{"event_id":"$Zzy4IF1scWMtzdZUDP2wa5A8PASP7KX4Kkx2PtqF2dY","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763530203680,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$ZZyD1wX4Kbnup7_H92l7l_0okYnoemikfIJyECHH_RY"},
{"content":{"body":"Unless we want every of its users to consider the event-based API to be deprecated","m.mentions":{},"m.relates_to":{"m.in_reply_to":{"event_id":"$_BBZxyi5gbd3_t-PIdHqbAehEQt2NclbLggXql4QZj8"}},"msgtype":"m.text"},"ts":1763530206292,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$WS7ysmHQokcNAJ5jVS6Hnw6rxdxXvC2RCKgrglhhXBQ"},
{"content":{"body":"* Unless we want every of its users to consider the event-based API to be basically considered to be deprecated","m.mentions":{},"m.new_content":{"body":"Unless we want every of its users to consider the event-based API to be basically considered to be deprecated","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$WS7ysmHQokcNAJ5jVS6Hnw6rxdxXvC2RCKgrglhhXBQ","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763530212950,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$e8u9PhkCoMM9DHDC09bxfiUD6ImFgJmavWaFrLShTJo"},
{"content":{"body":"@ljharb:matrix.org no I was objecting to @eemeli:mozilla.org's objection","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@ljharb:matrix.org\">@ljharb</a> no I was objecting to <a href=\"https://matrix.to/#/@eemeli:mozilla.org\">@eemeli</a>&#39;s objection","m.mentions":{"user_ids":["@ljharb:matrix.org","@eemeli:mozilla.org"]},"msgtype":"m.text"},"ts":1763530216550,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$aGO0kRauRZ36NU7Ow8OFGuj479E4WM2JRmyTpdgDuY8"},
{"content":{"body":"* Unless we want every of its users to consider the event-based API tobe deprecated","m.mentions":{},"m.new_content":{"body":"Unless we want every of its users to consider the event-based API tobe deprecated","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$WS7ysmHQokcNAJ5jVS6Hnw6rxdxXvC2RCKgrglhhXBQ","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763530218361,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$1ZVhw8lOmHoKBxJx_FR0qQbpdx-EkpCw99BprgdZAdQ"},
{"content":{"body":"* Unless we want every of its users to consider the event-based API to be deprecated","m.mentions":{},"m.new_content":{"body":"Unless we want every of its users to consider the event-based API to be deprecated","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$WS7ysmHQokcNAJ5jVS6Hnw6rxdxXvC2RCKgrglhhXBQ","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763530222145,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$wLM21ykisFMaD6w37lUBoOXIGVDV-j7-l-KEP-jo29I"},
{"content":{"body":"uhhhh yeah that's pretty much what I'm hoping for","m.mentions":{"user_ids":["@nicolo-ribaudo:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$WS7ysmHQokcNAJ5jVS6Hnw6rxdxXvC2RCKgrglhhXBQ"}},"msgtype":"m.text"},"ts":1763530236513,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$u0sP7BZdWUNeRHHiUAlyCX9rRPQqfPtBAkzm8dM5y0E"},
{"content":{"body":"Then a string-based protocol is good","m.mentions":{},"msgtype":"m.text"},"ts":1763530251085,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$1tx2GUdGBWencmNqyuyX0OjiMYQRhfAPgRU_OLpkteg"},
{"content":{"body":"it's got a bunch of footguns so that's desirable anyway","m.mentions":{},"msgtype":"m.text"},"ts":1763530254059,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$3RIujIUvBmh2GRgW0Y0fazUsOTU1PJA7NLf48zkIa4k"},
{"content":{"body":"See https://github.com/tc39/proposal-cancellation/issues/22#issuecomment-916548469","m.mentions":{"user_ids":["@nicolo-ribaudo:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$whKgSykoJdNbYvvOzU_ebvnY3HeO7cBdJVnxhNKWUpM"}},"msgtype":"m.text"},"ts":1763530267779,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$hC639dAOhGFFPMcr0iMXppwJlya4srX9D9ojxKN6Myw"},
{"content":{"body":"It seems like the motivation there is that we have a good API on the web and we shouldn't use a second one. Kevin is now saying that it'd be good to provide a second API on the web (which would be good regardless of the ECMA-262 interop)","m.mentions":{"user_ids":["@rbuckton:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$hC639dAOhGFFPMcr0iMXppwJlya4srX9D9ojxKN6Myw"}},"msgtype":"m.text"},"ts":1763530333644,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$DbznEV6Ji4HkZj9NJyBwYAnuwfwZ90ySWyuNw3fzhPg"},
{"content":{"body":"oh oops I see, I mistook the conclusion. I'm definitely okay with the conclusion Jordan stated","m.mentions":{},"m.relates_to":{"m.in_reply_to":{"event_id":"$dOSD1k3wL422hDjdMBL-A9Wpx8kWgWxgg5mMyfKR7fE"}},"msgtype":"m.text"},"ts":1763530351454,"senderName":"rkirsling","senderId":"@rkirsling:matrix.org","id":"$3ZTAu17tHh6xVHbAjyDnH0-MYs_-N1Qkv1siB0Ici7I"},
{"content":{"body":"No; I don't find their `size`s awkward though. Is the story relevant here?","format":"org.matrix.custom.html","formatted_body":"No; I don't find their <code>size</code>s awkward though. Is the story relevant here?","m.mentions":{"user_ids":["@jakea:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$Q9A4D3yRfhR4p58SdXhGC68hAMtvIhIYOn9Y5tbCg4o"}},"msgtype":"m.text"},"ts":1763530390029,"senderName":"eemeli","senderId":"@eemeli:mozilla.org","id":"$MIbhlXsHJbucC64sPtl6j2NA4uJz7oDZQCCBu-s45Jc"},
{"content":{"body":"One reason why splitting doesn't really make sense to me","m.mentions":{"user_ids":["@danielrosenwasser:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$f1y2u049DVySjSGvq3UBT-i9W8DI2G6miuCELvY5vig"}},"msgtype":"m.text"},"ts":1763530409784,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$cYobptwLb84rtzMHeYnrxptr0Z3YAt2LJYBaQ1WawLw"},
{"content":{"body":"eemeli: just that it's another word the platform uses for \"number of items\"","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@eemeli:mozilla.org\">eemeli</a>: just that it's another word the platform uses for \"number of items\"","m.mentions":{"user_ids":["@eemeli:mozilla.org"]},"msgtype":"m.text"},"ts":1763530437463,"senderName":"Jake Archibald","senderId":"@jakea:matrix.org","id":"$O6amsPT0OjEAljHTjPuX5FVfixh-O6kVeU2RyBuOQ5w"},
{"content":{"body":"@rbuckton:matrix.org What was the proposal that prompted you to create Cancellation?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@rbuckton:matrix.org\">@rbuckton</a> What was the proposal that prompted you to create Cancellation?","m.mentions":{"user_ids":["@rbuckton:matrix.org"]},"msgtype":"m.text"},"ts":1763530439106,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$BkWswHQSSBNcY9itihTD-VjDqIcmzAiLuaO_upItLbA"},
{"content":{"body":"I remember there being something that needed the ability to cancel","m.mentions":{},"msgtype":"m.text"},"ts":1763530448297,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$gP2ImBeWsp4MtJmlANtKjXGgKGI0tEQW3huCpr2LYDs"},
{"content":{"body":"I've always contended that we have a less than adequate API on the web with numerous footguns. We can possibly address the footguns, but that requires deprecating older parts of the API","m.mentions":{"user_ids":["@nicolo-ribaudo:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$DbznEV6Ji4HkZj9NJyBwYAnuwfwZ90ySWyuNw3fzhPg"}},"msgtype":"m.text"},"ts":1763530451352,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$gRJLSD8iN0GVOJgcYIMeB9RCEfx_jHKiCW3cwqgTgwo"},
{"content":{"body":"Justin Ridgewell: on the web side, a lot was driven by cancellable fetch","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@jridgewell:matrix.org\">Justin Ridgewell</a>: on the web side, a lot was driven by cancellable fetch","m.mentions":{"user_ids":["@jridgewell:matrix.org"]},"msgtype":"m.text"},"ts":1763530479499,"senderName":"Jake Archibald","senderId":"@jakea:matrix.org","id":"$TSOGSpwK_8ckAQXy8jT6x3kAbWyg8gzco1CLRje35FA"},
{"content":{"body":"`Promise` and `async function`. ","format":"org.matrix.custom.html","formatted_body":"<code>Promise</code> and <code>async function</code>.","m.mentions":{"user_ids":["@jridgewell:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$BkWswHQSSBNcY9itihTD-VjDqIcmzAiLuaO_upItLbA"}},"msgtype":"m.text"},"ts":1763530498468,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$YotR8fzZhggM2rUPvjMiv21N8Wc0zc-96lUsg3QWPpk"},
{"content":{"body":"Wasnâ€™t there something more recent than that?","m.mentions":{},"msgtype":"m.text"},"ts":1763530529056,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$0I_KflP3m3VVuIHo-imrRMNQE5dRt6jFCnw3Xgxusuo"},
{"content":{"body":"Those both predate my joining the committee","m.mentions":{},"msgtype":"m.text"},"ts":1763530539167,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$FyPoFSz1GCNOT5ss00_KY90_RZr95BWcAlHkPNmW9H8"},
{"content":{"body":"I remember there being something","m.mentions":{},"msgtype":"m.text"},"ts":1763530543834,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$WA9n7BLy63Y9YJtofjH4U4ANtH2ip7nPp3bRBqnZe7Q"},
{"content":{"body":"Not really, I started working on the proposal before `async function` was finalized.","format":"org.matrix.custom.html","formatted_body":"Not really, I started working on the proposal before <code>async function</code> was finalized.","m.mentions":{},"msgtype":"m.text"},"ts":1763530568714,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$P7jEUDYo_F_Cx7WVwL0yN2WH0ZveNSQwEOfAYI5Ss_g"},
{"content":{"body":"A standard CancellationAsyncContext","m.mentions":{},"msgtype":"m.text"},"ts":1763530575794,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$WaBTkw7AAZ4cpfj3dhEkiHfUug3lUf_TjGuKqG-oBR4"},
{"content":{"body":"also if Observables was done in TC39","m.mentions":{},"msgtype":"m.text"},"ts":1763530585179,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$_FzQbv5THYmMYhxfcCDLlvFDWeyvF1dHKulEuJyjBtk"},
{"content":{"body":"I think this would still count as the same API, just a different way of using it, and fwiw I think domenic agrees er https://matrixlogs.bakkot.com/WHATWG/2025-09-26#L7","m.mentions":{"user_ids":["@nicolo-ribaudo:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$DbznEV6Ji4HkZj9NJyBwYAnuwfwZ90ySWyuNw3fzhPg"}},"msgtype":"m.text"},"ts":1763530596775,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$if6vK1oVgwSaNCHUhT6Ar1t5Zu1w3R03sI1gKmTts4M"},
{"content":{"body":"* I think this would still count as the same API, just a different way of using it, and fwiw I think domenic agrees per https://matrixlogs.bakkot.com/WHATWG/2025-09-26#L7","m.mentions":{},"m.new_content":{"body":"I think this would still count as the same API, just a different way of using it, and fwiw I think domenic agrees per https://matrixlogs.bakkot.com/WHATWG/2025-09-26#L7","m.mentions":{"user_ids":["@nicolo-ribaudo:matrix.org"]},"msgtype":"m.text"},"m.relates_to":{"event_id":"$if6vK1oVgwSaNCHUhT6Ar1t5Zu1w3R03sI1gKmTts4M","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763530604067,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$OGGR-6P4iip1KzkbLPr9yyMqOYvbqnk8XLwGQyRn6K0"},
{"content":{"body":"Tbf my stated preference continues to be for `isEmpty`, but `keysLength` rubs me the wrong way because \"keys length\" is not grammatically correct English.","format":"org.matrix.custom.html","formatted_body":"Tbf my stated preference continues to be for <code>isEmpty</code>, but <code>keysLength</code> rubs me the wrong way because \"keys length\" is not grammatically correct English.","m.mentions":{"user_ids":["@jakea:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$O6amsPT0OjEAljHTjPuX5FVfixh-O6kVeU2RyBuOQ5w"}},"msgtype":"m.text"},"ts":1763530650891,"senderName":"eemeli","senderId":"@eemeli:mozilla.org","id":"$VdwdzdZwDqhoRTDfBzjVUjOLVGsF61CgsnTSi1DOm0U"},
{"content":{"body":"I'd already been using cancellation in .NET for years, and had an early implementation of `Promise` for JS back in 2015. When `Promise` was proposed for JS, I wanted cancellation for async programming.","format":"org.matrix.custom.html","formatted_body":"I'd already been using cancellation in .NET for years, and had an early implementation of <code>Promise</code> for JS back in 2015. When <code>Promise</code> was proposed for JS, I wanted cancellation for async programming.","m.mentions":{},"msgtype":"m.text"},"ts":1763530680640,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$Onh6dfIKkK5-6s4k8T-ISeuitvW492qpNBMuP18wnWY"},
{"content":{"body":"I wanted cancellation for `new Promise(init, token)` and `Promise.prototype.then(onfulfill, onreject, token)` as a way to unregister callbacks as a more memory friendly version of `p.then(() => { token.throwIfCanceled(); ... })`. I also wanted it for dynamic `import()`.","format":"org.matrix.custom.html","formatted_body":"I wanted cancellation for <code>new Promise(init, token)</code> and <code>Promise.prototype.then(onfulfill, onreject, token)</code> as a way to unregister callbacks as a more memory friendly version of <code>p.then(() =&gt; { token.throwIfCanceled(); ... })</code>. I also wanted it for dynamic <code>import()</code>.","m.mentions":{},"msgtype":"m.text"},"ts":1763530787472,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$6UJFl_AoZ9UaFPrQ8r8nVsiTIw5l0-Dkt3YbrgJDwuY"},
{"content":{"body":"What held up cancellation to the point that WHATWG shipped something before we could standardize, was a number of delegates wanting cancellation to be somehow transparent, which I was strongly opposed to.","m.mentions":{},"msgtype":"m.text"},"ts":1763530858549,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$jvsOOexEAl-0NPtMtWl8p18AI2Qq-f0z3Pu_Eetc2z4"},
{"content":{"body":"i don't love cancellation at the promise layer specifically, I think it leads to a footgun of stopping listening when you meant to stop the actual work that is happening, but cancellation in general seems quite nice.","msgtype":"m.text"},"ts":1763530888202,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$EzXXRBn8m4e9uuSNfWfm8TCvoe3KUrVJWCke_7uou-4"},
{"content":{"body":"I based that consideration on my experience with .NET's `new Task()` and `Task.ContinueWith()`, which both accept a cancellation token as a way to cancel work up-front and avoid memory leaks due to holding on to closures longer than necessary.","format":"org.matrix.custom.html","formatted_body":"I based that consideration on my experience with .NET's <code>new Task()</code> and <code>Task.ContinueWith()</code>, which both accept a cancellation token as a way to cancel work up-front and avoid memory leaks due to holding on to closures longer than necessary.","m.mentions":{},"msgtype":"m.text"},"ts":1763530978315,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$RGQKbopg2-pAy9z_YHkNYVR7fzmBdtrmkCYog2eiGVI"},
{"content":{"body":"detaching promise callbacks also seems useful","msgtype":"m.text"},"ts":1763531084795,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$ccrbBpVb3WsQtA4JwzTtlD64m8oxNF6grXdgAd3qLuA"},
{"content":{"body":"That's the same reasoning why I think `AbortController`/`CancelSource` needs a `close()`/`[Symbol.dispose]()` that unregisters all callbacks, to avoid memory leaks from entire cancellation graphs that can no longer be canceled.","format":"org.matrix.custom.html","formatted_body":"That's the same reasoning why I think <code>AbortController</code>/<code>CancelSource</code> needs a <code>close()</code>/<code>[Symbol.dispose]()</code> that unregisters all callbacks, to avoid memory leaks from entire cancellation graphs that can no longer be canceled.","m.mentions":{},"msgtype":"m.text"},"ts":1763531096955,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$d1wJ2HI0baWqjXbqLdiS9u73h2AQ6s-7Vlxv9rYN5Vs"},
{"content":{"body":"* One reason why splitting proposals doesn't really make sense to me","m.mentions":{},"m.new_content":{"body":"One reason why splitting proposals doesn't really make sense to me","m.mentions":{"user_ids":["@danielrosenwasser:matrix.org"]},"msgtype":"m.text"},"m.relates_to":{"event_id":"$cYobptwLb84rtzMHeYnrxptr0Z3YAt2LJYBaQ1WawLw","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763531097217,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$JJOJkBtpkAyNCyNjbTgDyBTsOO57kR1t73qR0N1VtJo"},
{"content":{"body":"Isnâ€™t this effectively what `fetch({ signal })` does?","format":"org.matrix.custom.html","formatted_body":"Isnâ€™t this effectively what <code data-md=\"`\">fetch({ signal })</code> does?","m.mentions":{"user_ids":["@devsnek:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$EzXXRBn8m4e9uuSNfWfm8TCvoe3KUrVJWCke_7uou-4"}},"msgtype":"m.text"},"ts":1763531108101,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$hlLfXVeKJk5DKjFqaeWDYK80TtSuKwRYGjRdDDX3SjQ"},
{"content":{"body":"fetch's signal can actually cancel the native operation ","msgtype":"m.text"},"ts":1763531144293,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$2Qen8uHbUBJgGhx7VQve2DRpvdoDFYO_PCNiXhFK9z8"},
{"content":{"body":"right. the signal should be given to the producer - not the result","m.mentions":{},"msgtype":"m.text"},"ts":1763531157240,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$ZsqhTaC-pOshfvistTsZlaKtLrzRiKKQ164qNr7VuwE"},
{"content":{"body":"promise != task. promise = result","m.mentions":{},"msgtype":"m.text"},"ts":1763531166405,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$Wxw949bh89GXSOtRPBRVevZG7Ebq8wY5MwBJL0Iyayw"},
{"content":{"body":"* promise != task. promise == result","m.mentions":{},"m.new_content":{"body":"promise != task. promise == result","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$Wxw949bh89GXSOtRPBRVevZG7Ebq8wY5MwBJL0Iyayw","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763531187413,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$H-pAfurpILMlJ0062_tZq24aUtVN34_bMWyEPcCggGU"},
{"content":{"body":"a Promise is a producer of calls to its `.then` listeners","format":"org.matrix.custom.html","formatted_body":"a Promise is a producer of calls to its <code>.then</code> listeners","m.mentions":{},"msgtype":"m.text"},"ts":1763531192097,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$h09VFxO97LPEUTXyBA595AvvsA87dz50WPQ-0YvmOwM"},
{"content":{"body":"program-counter++ is a producer of progress","m.mentions":{},"msgtype":"m.text"},"ts":1763531229092,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$T_qOCwWGPVt0nGf6MaERBVBEPURNNWG-yNgwy1dThxQ"},
{"content":{"body":"The .then callback can do actual significant work","m.mentions":{},"msgtype":"m.text"},"ts":1763531247874,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$5K4qDk8EuorXJkQpcH9l-gxhvevsc1y3To4ZeGAjqZ4"},
{"content":{"body":"Ignore the names. A .NET `Task` is virtually the same as a JS `Promise`. The only difference is that a .NET `Task` can delay starting.","format":"org.matrix.custom.html","formatted_body":"Ignore the names. A .NET <code>Task</code> is virtually the same as a JS <code>Promise</code>. The only difference is that a .NET <code>Task</code> can delay starting.","m.mentions":{},"msgtype":"m.text"},"ts":1763531267418,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$4eDeXHtBAF3YsInq_uMVVoZCRwg6ea8SahB1OKQ0GDk"},
{"content":{"body":"that's a big difference","m.mentions":{},"msgtype":"m.text"},"ts":1763531282180,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$YWozGbUY4l1me_eknKaCRqD0hhv_ehlfVQ6vm0FyxUY"},
{"content":{"body":"In .NET, a `Task` generally represents an eventual result.","format":"org.matrix.custom.html","formatted_body":"In .NET, a <code>Task</code> generally represents an eventual result.","m.mentions":{},"msgtype":"m.text"},"ts":1763531286001,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$pTwOQGpX7wR8TJzDhSudz-7ItNZ6BMDdPGA_dUpvR6g"},
{"content":{"body":"Yes, but in the Venn diagram if Task and Promise, Task covers Promise entirely.","m.mentions":{"user_ids":["@aclaymore:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$YWozGbUY4l1me_eknKaCRqD0hhv_ehlfVQ6vm0FyxUY"}},"msgtype":"m.text"},"ts":1763531321996,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$X-icLb9JyR8fFTxWApDp12vcJjw6vDtH_40Xjg3oMmw"},
{"content":{"body":"an `async function` that was lazy would have been very different","format":"org.matrix.custom.html","formatted_body":"an <code>async function</code> that was lazy would have been very different","m.mentions":{},"msgtype":"m.text"},"ts":1763531331003,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$nas4PBL3OodoDPi4y5ugx1Pp8yFK_GS_I2RtjkFjpp4"},
{"content":{"body":"* Yes, but in the Venn diagram of Task and Promise, Task covers Promise entirely.","m.mentions":{},"m.new_content":{"body":"Yes, but in the Venn diagram of Task and Promise, Task covers Promise entirely.","m.mentions":{"user_ids":["@aclaymore:matrix.org"]},"msgtype":"m.text"},"m.relates_to":{"event_id":"$X-icLb9JyR8fFTxWApDp12vcJjw6vDtH_40Xjg3oMmw","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763531331435,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$jlpidajlr7hLIYXFnIFoUDkCqQVvhi3y8X6Fu1MsCN8"},
{"content":{"body":"I think youâ€™re confusing promise `p1` and the callbackâ€™s returned result `p2` in `p2 = p1.then(() => work())`","format":"org.matrix.custom.html","formatted_body":"I think youâ€™re confusing promise <code data-md=\"`\">p1</code> and the callbackâ€™s returned result <code data-md=\"`\">p2</code> in <code data-md=\"`\">p2 = p1.then(() =&gt; work())</code>","m.mentions":{"user_ids":["@aclaymore:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$Wxw949bh89GXSOtRPBRVevZG7Ebq8wY5MwBJL0Iyayw"}},"msgtype":"m.text"},"ts":1763531351142,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$MmeJ-3XlCzpPYE-hM5t05jdDQEzKBFR7TAilCTu1mL0"},
{"content":{"body":"I agree that tasks have results","m.mentions":{"user_ids":["@rbuckton:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$X-icLb9JyR8fFTxWApDp12vcJjw6vDtH_40Xjg3oMmw"}},"msgtype":"m.text"},"ts":1763531360687,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$wRpJJsb1rqY_Lbr7BiCkl0DrWlEHZBG15jx-2Tv7YEo"},
{"content":{"body":"my concern is when people write `fetch(url).then(cb, { signal })` instead of `fetch(url, { signal }).then(cb)` these do very different things while being very similar","msgtype":"m.text"},"ts":1763531368585,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$pjP1PTGnYtIVLxjAVL-0Kst2ABqM_r_89qhQUlYmIt4"},
{"content":{"body":"I also I think both use cases are valid ","msgtype":"m.text"},"ts":1763531411488,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$jP56YkjeTtBdbsOHcLSCS0huA65qUg0ZGD1ooTtiVVE"},
{"content":{"body":"I'm saying that even though a task can be a promise, that doesn't mean it's better. Restrictions are powerful","m.mentions":{},"msgtype":"m.text"},"ts":1763531419277,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$_Q9NcR1IeGDLU3UVRPYCb0Mz5DlOHYoIIvbN24Rr46o"},
{"content":{"body":"@erights Mark Miller (Agoric) MM: IIRC, you had strong opinions on WeakRef and the [[KeptValues]] list. Do you have thoughts on relaxing the behavior to match JSC in https://bugs.webkit.org/show_bug.cgi?id=301334.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@erights:matrix.org\">@erights Mark Miller (Agoric) MM</a>: IIRC, you had strong opinions on WeakRef and the [[KeptValues]] list. Do you have thoughts on relaxing the behavior to match JSC in https://bugs.webkit.org/show_bug.cgi?id=301334.","m.mentions":{"user_ids":["@erights:matrix.org"]},"msgtype":"m.text"},"ts":1763531426282,"senderName":"keith_miller","senderId":"@keith_miller:matrix.org","id":"$zN3oA8NI2sDjYvnIhw7Gm3aII1QkXgEYpesDMZe-Tgo"},
{"content":{"body":"Perhaps TG1 & WHATWG could take some inspiration from TG2 & W3C I18N: TG2 stage advancement requires _asking_ for a horizontal review from W3C I18NWG, but does not require _receiving_ it","format":"org.matrix.custom.html","formatted_body":"Perhaps TG1 &amp; WHATWG could take some inspiration from TG2 &amp; W3C I18N: TG2 stage advancement requires <em>asking</em> for a horizontal review from W3C I18NWG, but does not require <em>receiving</em> it","m.mentions":{},"msgtype":"m.text"},"ts":1763531457068,"senderName":"Aki","senderId":"@akirose:matrix.org","id":"$YYgW36V6WgrAkolFTTPanWbRRY1H3ER3G_ydzI3jx4E"},
{"content":{"body":"TL;DR JSC only keeps the target alive as long as there exists some WeakRef that has `deref()`ed the target this cycle is still alive","format":"org.matrix.custom.html","formatted_body":"TL;DR JSC only keeps the target alive as long as there exists some WeakRef that has <code>deref()</code>ed the target this cycle is still alive","m.mentions":{},"m.relates_to":{"event_id":"$zN3oA8NI2sDjYvnIhw7Gm3aII1QkXgEYpesDMZe-Tgo","is_falling_back":true,"m.in_reply_to":{"event_id":"$zN3oA8NI2sDjYvnIhw7Gm3aII1QkXgEYpesDMZe-Tgo"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1763531478552,"senderName":"keith_miller","senderId":"@keith_miller:matrix.org","id":"$lzODGfTMbG3H-DTaH56X9kVV2Vj_igtd-KuAa05AnwA"},
{"content":{"body":"How do I add myself to the end of the queue?","m.mentions":{},"msgtype":"m.text"},"ts":1763531478843,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$aClm7m7qZRcM2WXg-9ZWvf7_MzvHKIh56DpDYw1mJRA"},
{"content":{"body":"Imagine a .NET `Task` being something like:\n\n```js\nfunction Task(init, opts) {\n  if (opts?.delay) {\n    const { promise, resolve, reject } = Promise.withResolvers();\n    promise.start = () => init(resolve, reject);\n    return promise;\n  }  \n  const p = new Promise(init);\n  p.start = () => {};\n  return p;\n}\n```","format":"org.matrix.custom.html","formatted_body":"<p>Imagine a .NET <code>Task</code> being something like:</p>\n<pre><code class=\"language-js\">function Task(init, opts) {\n  if (opts?.delay) {\n    const { promise, resolve, reject } = Promise.withResolvers();\n    promise.start = () =&gt; init(resolve, reject);\n    return promise;\n  }  \n  const p = new Promise(init);\n  p.start = () =&gt; {};\n  return p;\n}\n</code></pre>\n","m.mentions":{},"msgtype":"m.text"},"ts":1763531484273,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$NnD0iznI2wzaL97bA5SmNd0KIizJ0_ehBuRJkErc2Vw"},
{"content":{"body":"It keeps inserting my topic before James's","m.mentions":{},"m.relates_to":{"m.in_reply_to":{"event_id":"$aClm7m7qZRcM2WXg-9ZWvf7_MzvHKIh56DpDYw1mJRA"}},"msgtype":"m.text"},"ts":1763531492638,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$tXsD9rE1VIa8u_7fnUoVmw8tJVR6qWcEnWJKnNOLQ3Y"},
{"content":{"body":"It's been doing that all day, that is *not* the normal behavior, right?","format":"org.matrix.custom.html","formatted_body":"It's been doing that all day, that is <em>not</em> the normal behavior, right?","m.mentions":{},"msgtype":"m.text"},"ts":1763531517575,"senderName":"jkup","senderId":"@jkup:matrix.org","id":"$ictO5RZLiqBLvnvwJnmiAK4-n659z5BOLgarmfh6fFM"},
{"content":{"body":"It's now TCS instead of TCQ","m.mentions":{},"msgtype":"m.text"},"ts":1763531533066,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$BYp49ej2DdIodFpy4j8zXhdt0GhGHvlhfVlL_QascZA"},
{"content":{"body":"People who submit New Topic's early during the presentation are kept at the bottom and often don't get to speak","m.mentions":{},"msgtype":"m.text"},"ts":1763531554926,"senderName":"jkup","senderId":"@jkup:matrix.org","id":"$I6QtpO5vZIcJhbMACM-iz5j_NnFoixsh1pRrywK2Uzw"},
{"content":{"body":"splitting them doesn't change that all the names will have to be consistent full stop","m.mentions":{"user_ids":["@mhofman:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$cYobptwLb84rtzMHeYnrxptr0Z3YAt2LJYBaQ1WawLw"}},"msgtype":"m.text"},"ts":1763531580147,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$z04h4sI0sxxEZxBmrFGBswmPX9IU3b0LP0JfkqSse9g"},
{"content":{"body":"is this an observable difference?","m.mentions":{},"m.relates_to":{"event_id":"$zN3oA8NI2sDjYvnIhw7Gm3aII1QkXgEYpesDMZe-Tgo","is_falling_back":true,"m.in_reply_to":{"event_id":"$lzODGfTMbG3H-DTaH56X9kVV2Vj_igtd-KuAa05AnwA"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1763531676606,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$ffJbvVQSsR_PFV0f_h0wUn_ojkwlnIfmR67C4uGtKaY"},
{"content":{"body":"(didn't read the issue yet)","m.mentions":{},"m.relates_to":{"event_id":"$zN3oA8NI2sDjYvnIhw7Gm3aII1QkXgEYpesDMZe-Tgo","is_falling_back":true,"m.in_reply_to":{"event_id":"$ffJbvVQSsR_PFV0f_h0wUn_ojkwlnIfmR67C4uGtKaY"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1763531686930,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$8rhTki4l7m4Lo7djIufvZZ2vhx0s3mxSjvBwHYHximw"},
{"content":{"body":"let's chat on the break","m.mentions":{},"m.relates_to":{"event_id":"$zN3oA8NI2sDjYvnIhw7Gm3aII1QkXgEYpesDMZe-Tgo","is_falling_back":true,"m.in_reply_to":{"event_id":"$8rhTki4l7m4Lo7djIufvZZ2vhx0s3mxSjvBwHYHximw"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1763531694686,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$WxSRYmMNMbZ0jRNxKRpPXPyhJiO1V9uxXLH14Ll5nWk"},
{"content":{"body":"Only when you have two WeakRefs that point to the same target. My thinking is that's probably impossible to mentally model that two WeakRefs point to the same target correctly anyway.","m.mentions":{},"m.relates_to":{"event_id":"$zN3oA8NI2sDjYvnIhw7Gm3aII1QkXgEYpesDMZe-Tgo","is_falling_back":true,"m.in_reply_to":{"event_id":"$WxSRYmMNMbZ0jRNxKRpPXPyhJiO1V9uxXLH14Ll5nWk"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1763531780188,"senderName":"keith_miller","senderId":"@keith_miller:matrix.org","id":"$aAfrmvNy1tjasiKkPMyS2tgxFq3V4WmC-foVL3ILaNQ"},
{"content":{"body":"I also think (once you know the GC of a given engine) that the current behavior is a communications channel","m.mentions":{},"m.relates_to":{"event_id":"$zN3oA8NI2sDjYvnIhw7Gm3aII1QkXgEYpesDMZe-Tgo","is_falling_back":true,"m.in_reply_to":{"event_id":"$aAfrmvNy1tjasiKkPMyS2tgxFq3V4WmC-foVL3ILaNQ"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1763531816212,"senderName":"keith_miller","senderId":"@keith_miller:matrix.org","id":"$Tnr-k8yA1FXlrxH12o0IkwYoja1F0LTdApvONMT5jO4"},
{"content":{"body":"So we're admitting we want the other methods? The `Count` suffix for the longer Object methods don't read well to me. Advancing keys separately opens the risk it advances with Count","format":"org.matrix.custom.html","formatted_body":"So we're admitting we want the other methods? The <code>Count</code> suffix for the longer Object methods don't read well to me. Advancing keys separately opens the risk it advances with Count","m.mentions":{},"msgtype":"m.text"},"ts":1763531850248,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$8T6A3EFyyt81Gm-S97HMqn589HJogmMIAAmfUHR3Fdo"},
{"content":{"body":"* So we're admitting we want the other methods? The `Count` suffix for the longer Object methods don't read well to me. Advancing keys separately opens the risk it advances as keyCount","format":"org.matrix.custom.html","formatted_body":"* So we're admitting we want the other methods? The <code>Count</code> suffix for the longer Object methods don't read well to me. Advancing keys separately opens the risk it advances as keyCount","m.mentions":{},"m.new_content":{"body":"So we're admitting we want the other methods? The `Count` suffix for the longer Object methods don't read well to me. Advancing keys separately opens the risk it advances as keyCount","format":"org.matrix.custom.html","formatted_body":"So we're admitting we want the other methods? The <code>Count</code> suffix for the longer Object methods don't read well to me. Advancing keys separately opens the risk it advances as keyCount","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$8T6A3EFyyt81Gm-S97HMqn589HJogmMIAAmfUHR3Fdo","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763531871646,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$7KQBd8or4qfhG4uh1fNB-obtCBECfuWmxESY5w-uzpo"},
{"content":{"body":"it doesn't","m.mentions":{},"msgtype":"m.text"},"ts":1763531874818,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$skdp1mEDp_NiBvtBVr1V-WWvPd_bVgeEvgOrochmX10"},
{"content":{"body":"I am admitting no such thing","m.mentions":{},"msgtype":"m.text"},"ts":1763531885850,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$parFKz4cIZR6GG5Rd8nMuVTV1Q4LgXuGqQUpj2ERbN0"},
{"content":{"body":"keysX won't advance with any X that wouldn't also be palatable for all the other methods","m.mentions":{},"msgtype":"m.text"},"ts":1763531887937,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$YtRF5ydOkmqtR0-AuxytkVyT30OcWPqXe8JFDRU4Xyg"},
{"content":{"body":"* keysX won't advance with any X that wouldn't also be palatable for all the other methods, that would violate the \"cross-cutting concerns\" part of stage 2","m.mentions":{},"m.new_content":{"body":"keysX won't advance with any X that wouldn't also be palatable for all the other methods, that would violate the \"cross-cutting concerns\" part of stage 2","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$YtRF5ydOkmqtR0-AuxytkVyT30OcWPqXe8JFDRU4Xyg","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763531897672,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$zW6vu94_tQmLw6bMUNsefFNP1PY_EltARYbNzzkaC8w"},
{"content":{"body":"* keysX won't advance with any X that wouldn't also be palatable for all the other methods, that would violate the \"cross-cutting concerns\" part of stage 2 (whether we have the other methods eventually or not)","m.mentions":{},"m.new_content":{"body":"keysX won't advance with any X that wouldn't also be palatable for all the other methods, that would violate the \"cross-cutting concerns\" part of stage 2 (whether we have the other methods eventually or not)","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$YtRF5ydOkmqtR0-AuxytkVyT30OcWPqXe8JFDRU4Xyg","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763531908156,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$SFFjYW--52YfYgcuy8KCQNOcBld4iGu5JlaeOJalW3g"},
{"content":{"body":"I wrote out an example of loading JSON with ESM and non-UTF-8 encodings at https://github.com/eemeli/proposal-import-text/issues/6. It has the behavior I described yesterday: early error, triggered by syntax.\n\nI also collected some examples of prior art: https://github.com/eemeli/proposal-import-text/issues/5#issuecomment-3550911025","m.mentions":{},"msgtype":"m.text"},"ts":1763532191482,"senderName":"sffc","senderId":"@sffc:mozilla.org","id":"$p1PnFhLJS1lci8AjilScoVmHfyS0Zk-ZWgFNv56DjSM"},
{"content":{"body":"@sffc:mozilla.org I don't think that makes a difference","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@sffc:mozilla.org\">@sffc</a> I don&#39;t think that makes a difference","m.mentions":{"user_ids":["@sffc:mozilla.org"]},"msgtype":"m.text"},"ts":1763532222501,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$HjtCoCdP2rynH3cheDAmikyYDLjfFxS2GPP-o9ctN4g"},
{"content":{"body":"there are occasions when you *won't* get an early error, even though you have the wrong encoding, so any warning you want to convey to hosts about mismanaging the encoding for text also applies to JSON because it's the exact same error","format":"org.matrix.custom.html","formatted_body":"there are occasions when you <i data-md=\"*\">won&#39;t</i> get an early error, even though you have the wrong encoding, so any warning you want to convey to hosts about mismanaging the encoding for text also applies to JSON because it&#39;s the exact same error","m.mentions":{},"msgtype":"m.text"},"ts":1763532292895,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$B-_ulfSQqDcVDgYBwWiFBcqHCDN3C5LCKM74TwBMz_w"},
{"content":{"body":"and we don't have such a warning about JSON, and I don't think we need it","m.mentions":{},"msgtype":"m.text"},"ts":1763532323151,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$_Wp9Ls8vfh052iiBBPAzANReOhqYxyVSOehezK3ZOsY"},
{"content":{"body":"the `encoding` option doesn't make sense here because there is no reason to assume the resource is backed by bytes from the perspective of the importing machiner","format":"org.matrix.custom.html","formatted_body":"the <code>encoding</code> option doesn't make sense here because there is no reason to assume the resource is backed by bytes from the perspective of the importing machiner","m.mentions":{},"msgtype":"m.text"},"ts":1763532377364,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$e9gjYtqfpMyNmR9R2ws03NNAfDhjLVOatjoFcH_KALM"},
{"content":{"body":"* the `encoding` option doesn't make sense here because there is no reason to assume the resource is backed by bytes from the perspective of the importing machinery","format":"org.matrix.custom.html","formatted_body":"* the <code>encoding</code> option doesn't make sense here because there is no reason to assume the resource is backed by bytes from the perspective of the importing machinery","m.mentions":{},"m.new_content":{"body":"the `encoding` option doesn't make sense here because there is no reason to assume the resource is backed by bytes from the perspective of the importing machinery","format":"org.matrix.custom.html","formatted_body":"the <code>encoding</code> option doesn't make sense here because there is no reason to assume the resource is backed by bytes from the perspective of the importing machinery","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$e9gjYtqfpMyNmR9R2ws03NNAfDhjLVOatjoFcH_KALM","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763532380259,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$SURPLiuHsx6VPUaoPSI9Tp2DpT8G_2O23vXqJj55gEA"},
{"content":{"body":"MIME types could include a universal `codecs` sub-parameter or similar","format":"org.matrix.custom.html","formatted_body":"MIME types could include a universal <code>codecs</code> sub-parameter or similar","m.mentions":{"user_ids":["@sffc:mozilla.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$p1PnFhLJS1lci8AjilScoVmHfyS0Zk-ZWgFNv56DjSM"}},"msgtype":"m.text"},"ts":1763532390705,"senderName":"Eli Grey","senderId":"@eli-grey:matrix.org","id":"$jzAxa0Vv86xm3ldEFvk_8WKv6inNCwQai-PlE6edaDo"},
{"content":{"body":"that assumption is true in e.g. HTML, but whatwg is pretty dogmatic these days about interpreting any text over the wire as UTF-8 in any new APIs, so I don't think they'd be on board with allowing specifying any other encoding anyway","m.mentions":{},"msgtype":"m.text"},"ts":1763532400481,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$S4FFQfNhz5UEkVm2hWErZj3CvC1C_-uTsVf5z3Rwh0c"},
{"content":{"body":"Could HTML only support UTF-8, but throw if it detects somehow a non-UTF-8 encoding?","m.mentions":{},"msgtype":"m.text"},"ts":1763532408305,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$He4ItCtvZjaukQfkZWR6LDUjN7CcoLUlde39OUo0GJ0"},
{"content":{"body":"and we could add a way to include the expect mime type","m.mentions":{},"m.relates_to":{"m.in_reply_to":{"event_id":"$jzAxa0Vv86xm3ldEFvk_8WKv6inNCwQai-PlE6edaDo"}},"msgtype":"m.text"},"ts":1763532418098,"senderName":"Eli Grey","senderId":"@eli-grey:matrix.org","id":"$QOLZykfxLVHPMj8WMOSgetzsSijRvzzA-yRuBKf7p40"},
{"content":{"body":"The Content-Type header is already mime type + charset","m.mentions":{"user_ids":["@eli-grey:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$jzAxa0Vv86xm3ldEFvk_8WKv6inNCwQai-PlE6edaDo"}},"msgtype":"m.text"},"ts":1763532442045,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$_UOev6ibDFJxcLvf53iS72QnIKLPx8sw3lHratjr6ZQ"},
{"content":{"body":"* and we could add a way to include the expected mime type","m.mentions":{},"m.new_content":{"body":"and we could add a way to include the expected mime type","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$QOLZykfxLVHPMj8WMOSgetzsSijRvzzA-yRuBKf7p40","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1763532443891,"senderName":"Eli Grey","senderId":"@eli-grey:matrix.org","id":"$k1IgI6mZbrfDKjyK4iq2sFM6qsT9SJ_YkMD_MTzcvyk"},
{"content":{"body":"that's what i meant; re-using that if possible","m.mentions":{"user_ids":["@nicolo-ribaudo:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$_UOev6ibDFJxcLvf53iS72QnIKLPx8sw3lHratjr6ZQ"}},"msgtype":"m.text"},"ts":1763532466580,"senderName":"Eli Grey","senderId":"@eli-grey:matrix.org","id":"$brz82_YpXgpmFJWddvA6yuOHEeFOmIzskVdGSDIYB8w"},
{"content":{"body":"Btw, the scope of the proposal in TC39 is \"if an import with type:text succeeds, it must return a string\". HTML doesn't actually need our proposal to do type:text, our proposal just prevents returning random stuff there","m.mentions":{},"msgtype":"m.text"},"ts":1763532525410,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$qTn8StEUTbnWLk6Xj5DGrXXYBKTOYLKb9nMilThwf3U"},
{"content":{"body":"nicolo-ribaudo: are there slides for your \"Module-declarations-like proposals in other areas of the web platform\" topic? it sounds interesting but I might be asleep","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@nicolo-ribaudo:matrix.org\">nicolo-ribaudo</a>: are there slides for your \"Module-declarations-like proposals in other areas of the web platform\" topic? it sounds interesting but I might be asleep","m.mentions":{"user_ids":["@nicolo-ribaudo:matrix.org"]},"msgtype":"m.text"},"ts":1763532891725,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$BdY9Vw9rjrDchyhBle3glbR8AMJYQPjrGYRGzlxEx94"}
]