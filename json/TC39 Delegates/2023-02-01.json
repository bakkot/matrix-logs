[
{"content":{"body":"reading through it, it kind of seems like the conclusion of this page is roughly identical (modulo placeholder choice, perhaps) to the JS proposal?","m.relates_to":{"event_id":"$8o7d7kxS99gAfu4IOy7vmOvinrSSx_Wl76bMgHd0CGw","is_falling_back":true,"m.in_reply_to":{"event_id":"$8o7d7kxS99gAfu4IOy7vmOvinrSSx_Wl76bMgHd0CGw"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675210451083,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$Ef091y7_IDDW9_mumWTC81GW3BnL9KaYsTuNIbq-e6E"},
{"content":{"body":"Huh, I assumed that the range operator| was supposed to subsume pipeline ","format":"org.matrix.custom.html","formatted_body":"Huh, I assumed that the range operator| was supposed to subsume pipeline","m.relates_to":{"event_id":"$8o7d7kxS99gAfu4IOy7vmOvinrSSx_Wl76bMgHd0CGw","is_falling_back":true,"m.in_reply_to":{"event_id":"$Ef091y7_IDDW9_mumWTC81GW3BnL9KaYsTuNIbq-e6E"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675215742845,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$Cu86GGAziVPUpCNgJxfMNo0152iTiWOtd5c2G3ajHvE"},
{"content":{"body":"> \"Scala is unique in that it only provides _, but that placeholder refers to a different parameter on each use. So _ > _ is a binary predicate that checks if the first parameter is greater than the second. Boost.HOF does the same with its unnamed placeholders [boost.hof.unnamed].\"","format":"org.matrix.custom.html","formatted_body":"<blockquote>\n<p>&quot;Scala is unique in that it only provides _, but that placeholder refers to a different parameter on each use. So _ &gt; _ is a binary predicate that checks if the first parameter is greater than the second. Boost.HOF does the same with its unnamed placeholders [boost.hof.unnamed].&quot;</p>\n</blockquote>","m.relates_to":{"event_id":"$8o7d7kxS99gAfu4IOy7vmOvinrSSx_Wl76bMgHd0CGw","is_falling_back":true,"m.in_reply_to":{"event_id":"$Cu86GGAziVPUpCNgJxfMNo0152iTiWOtd5c2G3ajHvE"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675225041192,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$jeQNxjg_o_dDNyot3wPXETHjQ7TwSJk-62F_QV3n5B8"},
{"content":{"body":"Wild!","m.relates_to":{"event_id":"$8o7d7kxS99gAfu4IOy7vmOvinrSSx_Wl76bMgHd0CGw","is_falling_back":true,"m.in_reply_to":{"event_id":"$jeQNxjg_o_dDNyot3wPXETHjQ7TwSJk-62F_QV3n5B8"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675225046600,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$LOvAguGKgrHAC5-_gdo_buQ8HEuDLSskCN8AGTzhoF8"},
{"content":{"body":"honestly kinda like scala's `_`","format":"org.matrix.custom.html","formatted_body":"honestly kinda like scala's <code>_</code>","m.relates_to":{"event_id":"$8o7d7kxS99gAfu4IOy7vmOvinrSSx_Wl76bMgHd0CGw","is_falling_back":true,"m.in_reply_to":{"event_id":"$LOvAguGKgrHAC5-_gdo_buQ8HEuDLSskCN8AGTzhoF8"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675225181362,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$ZIsWNGhpdk7Ay8pkt1EXqmYWWxA7tl9tYh0LPb0QsOk"},
{"content":{"body":"> <@bakkot:matrix.org> honestly kinda like scala's `_`\n\nI mean, PFA would do this with `?`, though doing that with operators required other syntax. ","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$ZIsWNGhpdk7Ay8pkt1EXqmYWWxA7tl9tYh0LPb0QsOk?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@bakkot:matrix.org\">@bakkot:matrix.org</a><br />honestly kinda like scala's <code>_</code></blockquote></mx-reply>I mean, PFA would do this with <code>?</code>, though doing that with operators required other syntax.","m.relates_to":{"event_id":"$8o7d7kxS99gAfu4IOy7vmOvinrSSx_Wl76bMgHd0CGw","is_falling_back":false,"m.in_reply_to":{"event_id":"$ZIsWNGhpdk7Ay8pkt1EXqmYWWxA7tl9tYh0LPb0QsOk"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675225938467,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$vpeNnBnOZJ_NbMnBAg1jDM6lxPxsrvfohF7wvUNh64A"},
{"content":{"body":"Notes editors: let’s remember to remove the >> and add a blank line between different speakers (and text that you want to render in different paragraphs in general). I did this for some topics but I think we can also do it on-line as well.","format":"org.matrix.custom.html","formatted_body":"Notes editors: let’s remember to remove the &gt;&gt; and add a blank line between different speakers (and text that you want to render in different paragraphs in general). I did this for some topics but I think we can also do it on-line as well.","msgtype":"m.text"},"ts":1675228531166,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$u3ucSgAy3Z3FvQAeJO-9WjI7fSK1eEbsWkE9kffsyXE"},
{"content":{"body":"scala has something like 18 meanings for `_`, it's very confusing until you've internalized all the relevant contexts","format":"org.matrix.custom.html","formatted_body":"scala has something like 18 meanings for <code>_</code>, it's very confusing until you've internalized all the relevant contexts","m.relates_to":{"event_id":"$8o7d7kxS99gAfu4IOy7vmOvinrSSx_Wl76bMgHd0CGw","is_falling_back":true,"m.in_reply_to":{"event_id":"$vpeNnBnOZJ_NbMnBAg1jDM6lxPxsrvfohF7wvUNh64A"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675231840115,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$L3oTiSu4rALAP2R7RvzD8TH1jBhlp4S5ZMwC5H8-6Xw"},
{"content":{"body":"> <@haxjs:matrix.org> At least wikipedia article also use ID as the abbr for identifier or identity ( https://en.wikipedia.org/wiki/Identifier )\n\nWhat are you talking about? ","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw%3Amatrix.org/%24IUZeo3uks7n-CRdRBtzml9M_jLyLLPXsNp1vQKUrqIs\">In reply to</a> <a href=\"https://matrix.to/#/@haxjs:matrix.org\">@haxjs:matrix.org</a><br>At least wikipedia article also use ID as the abbr for identifier or identity ( https://en.wikipedia.org/wiki/Identifier )</blockquote></mx-reply>What are you talking about?","m.relates_to":{"m.in_reply_to":{"event_id":"$IUZeo3uks7n-CRdRBtzml9M_jLyLLPXsNp1vQKUrqIs"}},"msgtype":"m.text"},"ts":1675241416351,"senderName":"pipobscure","senderId":"@pipobscure:matrix.org","id":"$_mdCa_DO4r-s0-UGQ7OAWpL3E2M_ziwmgJ2Bpk0bp1Q"},
{"content":{"body":"So wikipedia is probably not a good source to go for here.","msgtype":"m.text"},"ts":1675241443811,"senderName":"pipobscure","senderId":"@pipobscure:matrix.org","id":"$UuSxmUmx_TEefZtbyJ9nZbRXxs7WkrhOrXE_eQEOrLU"},
{"content":{"body":"`_ ? _ : _`","format":"org.matrix.custom.html","formatted_body":"<code>_ ? _ : _</code>","m.relates_to":{"event_id":"$8o7d7kxS99gAfu4IOy7vmOvinrSSx_Wl76bMgHd0CGw","is_falling_back":true,"m.in_reply_to":{"event_id":"$L3oTiSu4rALAP2R7RvzD8TH1jBhlp4S5ZMwC5H8-6Xw"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675243678851,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$IlFCJ8IUS24WbWQ0itxZ5fzyzl53DClhUciaWyeMxzE"},
{"content":{"body":"> <@ljharb:matrix.org> at any rate i feel very strongly against \"Id\" but \"identifier\" or \"code\" seem fine to me\n\nljharb: Could you clarify how you feel about \"ID\", an acronym of \"identity document\"?","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$x_85lJG5wFEm96lPF7QWcYfd78p3Afn1ZztvchdyMaw?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@ljharb:matrix.org\">@ljharb:matrix.org</a><br>at any rate i feel very strongly against &quot;Id&quot; but &quot;identifier&quot; or &quot;code&quot; seem fine to me</blockquote></mx-reply><a href=\"https://matrix.to/#/@ljharb:matrix.org\">ljharb</a>: Could you clarify how you feel about &quot;ID&quot;, an acronym of &quot;identity document&quot;?","m.relates_to":{"m.in_reply_to":{"event_id":"$x_85lJG5wFEm96lPF7QWcYfd78p3Afn1ZztvchdyMaw"}},"msgtype":"m.text"},"ts":1675249441694,"senderName":"eemeli","senderId":"@eemeli:mozilla.org","id":"$CFa02gPNfFRccXtP1Vy5ERoZt8E-EcjneTMod2pbr78"},
{"content":{"body":"This _should_ now be OK for day 1 & 2.","format":"org.matrix.custom.html","formatted_body":"This <em>should</em> now be OK for day 1 &amp; 2.","msgtype":"m.text","m.relates_to":{"m.in_reply_to":{"event_id":"$u3ucSgAy3Z3FvQAeJO-9WjI7fSK1eEbsWkE9kffsyXE"}}},"ts":1675254759479,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$jsoOOJ-Mwppb1UYpugjQkgEJSYlDOGFg744jwXStroY"},
{"content":{"body":"> <@littledan:matrix.org> Notes editors: let’s remember to remove the >> and add a blank line between different speakers (and text that you want to render in different paragraphs in general). I did this for some topics but I think we can also do it on-line as well.\n\n * This _should_ now be OK for day 1 & 2.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$u3ucSgAy3Z3FvQAeJO-9WjI7fSK1eEbsWkE9kffsyXE?via=matrix.org&amp;via=igalia.com&amp;via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@littledan:matrix.org\">@littledan:matrix.org</a><br>Notes editors: let’s remember to remove the &gt;&gt; and add a blank line between different speakers (and text that you want to render in different paragraphs in general). I did this for some topics but I think we can also do it on-line as well.</blockquote></mx-reply> * This <em>should</em> now be OK for day 1 &amp; 2.","m.new_content":{"body":"This _should_ now be OK for day 1 & 2.","format":"org.matrix.custom.html","formatted_body":"This <em>should</em> now be OK for day 1 &amp; 2.","msgtype":"m.text"},"m.relates_to":{"event_id":"$jsoOOJ-Mwppb1UYpugjQkgEJSYlDOGFg744jwXStroY","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675254764145,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$leDy6bQj7wv2kuNbZxGoUOhyUT5R_jQ-o3MXcA8QKzs"},
{"content":{"body":"I think we should also keep the practice of starting every paragraph with the acronym, even if it's a continuation of the current speaker. To make it super clear that it is a continuation and not a missing acronym.","msgtype":"m.text"},"ts":1675254836845,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$RODaXNr5rOoT66svQtAiOtnMS06FMDFSiJc749GM70k"},
{"content":{"body":" * I think we should also keep the practice of starting every paragraph with the acronym, even if it's a continuation of the current speaker. To make it super clear that it is a continuation and not a missing acronym.","m.new_content":{"body":"I think we should also keep the practice of starting every paragraph with the acronym, even if it's a continuation of the current speaker. To make it super clear that it is a continuation and not a missing acronym.","msgtype":"m.text"},"m.relates_to":{"event_id":"$RODaXNr5rOoT66svQtAiOtnMS06FMDFSiJc749GM70k","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675254844829,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$YRQUqoNxgCpPik8wL0nAFbLsr7oop1HnARjwJb31K5U"},
{"content":{"body":"> <@pipobscure:matrix.org> What are you talking about?\n\ncheck the page history, someone changed ID to Id yesterday. 🫥","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$_mdCa_DO4r-s0-UGQ7OAWpL3E2M_ziwmgJ2Bpk0bp1Q?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@pipobscure:matrix.org\">@pipobscure:matrix.org</a><br>What are you talking about?</blockquote></mx-reply>check the page history, someone changed ID to Id yesterday. 🫥","m.relates_to":{"m.in_reply_to":{"event_id":"$_mdCa_DO4r-s0-UGQ7OAWpL3E2M_ziwmgJ2Bpk0bp1Q"}},"msgtype":"m.text"},"ts":1675259097315,"senderName":"HE Shi-Jun","senderId":"@haxjs:matrix.org","id":"$tPhY9PQbzpqHi1LblCDNwHdhIGYvCcu91jsXBIAcsKo"},
{"content":{"body":"> <@aclaymore:matrix.org> I think we should also keep the practice of starting every paragraph with the acronym, even if it's a continuation of the current speaker. To make it super clear that it is a continuation and not a missing acronym.\n\nGood point, we usually do that and I hadn’t made that fix","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw%3Amatrix.org/%24RODaXNr5rOoT66svQtAiOtnMS06FMDFSiJc749GM70k\">In reply to</a> <a href=\"https://matrix.to/#/@aclaymore:matrix.org\">@aclaymore:matrix.org</a><br>I think we should also keep the practice of starting every paragraph with the acronym, even if it's a continuation of the current speaker. To make it super clear that it is a continuation and not a missing acronym.</blockquote></mx-reply>Good point, we usually do that and I hadn’t made that fix","m.relates_to":{"m.in_reply_to":{"event_id":"$RODaXNr5rOoT66svQtAiOtnMS06FMDFSiJc749GM70k"}},"msgtype":"m.text"},"ts":1675259193645,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$taZWddEvjegQBqW0kOGAmzKi72T5Dpz4A0i6Fznir7M"},
{"content":{"body":"One point to note there, the transcriptionist introduces many unnecessary or unnatural newlines\n\nThis affects the grammar checking a lot, and is very tedious to clean up(and sometimes to even notice)","msgtype":"m.text"},"ts":1675259591497,"senderName":"Anthony Bullard","senderId":"@anthonybullard:matrix.org","id":"$wRtSA5AgCQCJ73-gRDr7LTTZ44-mpRiD1mZjA3mjR4Q"},
{"content":{"body":"yep hopefully that can get sorted at some point. I would say \"surely that is an easy part of the software to change\" but we all know not to assume the ease of making code changes to software :D","msgtype":"m.text"},"ts":1675260043404,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$mdQz5csGYWc7mlbvmO0ekZW8Q3Kup7uwEVvxqQGvPgU"},
{"content":{"body":" * yep hopefully that can get sorted at some point. I would say \"surely that is an easy part of the software to change\" but we all know not to assume the ease of making code changes to software :D","m.new_content":{"body":"yep hopefully that can get sorted at some point. I would say \"surely that is an easy part of the software to change\" but we all know not to assume the ease of making code changes to software :D","msgtype":"m.text"},"m.relates_to":{"event_id":"$mdQz5csGYWc7mlbvmO0ekZW8Q3Kup7uwEVvxqQGvPgU","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675260052833,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$T57lmux5Gtk0pAc9PuLspKGsOZ_umsqmcU9peFh4Q7I"},
{"content":{"body":"a post-meeting script that replaces newlines where the previous line has text which does not end in punctuation might cover the majority of the occurrences.","msgtype":"m.text"},"ts":1675260132731,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$lIP5BS_oTLehN06wkeGosf_qf21a6Miuv9g11fKsPGc"},
{"content":{"body":"Yes, we complained about these new lines to the transcriptionist, and I will also follow up with the company after this meeting to see if there is any possible fix.","msgtype":"m.text"},"ts":1675260184018,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$w5gLKP9pI9_PL0Vttpc0-6IyOCMiiH8MrfCDRZl8NAA"},
{"content":{"body":"> <@haxjs:matrix.org> check the page history, someone changed ID to Id yesterday. 🫥\n\nSorry if that wasn’t clear from the tone. That was me in order to point out how unreliable Wikipedia is for topics where there is controversy. It’s ok as a lookup for common knowledge stuff, but wherever there is ongoing discussion wikipedia is useless.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw%3Amatrix.org/%24tPhY9PQbzpqHi1LblCDNwHdhIGYvCcu91jsXBIAcsKo\">In reply to</a> <a href=\"https://matrix.to/#/@haxjs:matrix.org\">@haxjs:matrix.org</a><br>check the page history, someone changed ID to Id yesterday. 🫥</blockquote></mx-reply>Sorry if that wasn’t clear from the tone. That was me in order to point out how unreliable Wikipedia is for topics where there is controversy. It’s ok as a lookup for common knowledge stuff, but wherever there is ongoing discussion wikipedia is useless.","m.relates_to":{"m.in_reply_to":{"event_id":"$tPhY9PQbzpqHi1LblCDNwHdhIGYvCcu91jsXBIAcsKo"}},"msgtype":"m.text"},"ts":1675260321266,"senderName":"pipobscure","senderId":"@pipobscure:matrix.org","id":"$FJKt97UgYG7VGEqNH2JY0WIi-VNlKsr1EGhn_CzwFQo"},
{"content":{"body":"Even years of interwebs experience still let me forget that tone doesn’t always translate well. /blush","msgtype":"m.text","m.relates_to":{"m.in_reply_to":{"event_id":"$FJKt97UgYG7VGEqNH2JY0WIi-VNlKsr1EGhn_CzwFQo"}}},"ts":1675260413345,"senderName":"pipobscure","senderId":"@pipobscure:matrix.org","id":"$fBEEA_8j_DL367sx7F8Xv2ip8ET8AvlTFcGWsDs8orI"},
{"content":{"body":"> <@pipobscure:matrix.org> Sorry if that wasn’t clear from the tone. That was me in order to point out how unreliable Wikipedia is for topics where there is controversy. It’s ok as a lookup for common knowledge stuff, but wherever there is ongoing discussion wikipedia is useless.\n\n * Even years of interwebs experience still let me forget that tone doesn’t always translate well. /blush","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw%3Amatrix.org/%24FJKt97UgYG7VGEqNH2JY0WIi-VNlKsr1EGhn_CzwFQo\">In reply to</a> <a href=\"https://matrix.to/#/@pipobscure:matrix.org\">@pipobscure:matrix.org</a><br>Sorry if that wasn’t clear from the tone. That was me in order to point out how unreliable Wikipedia is for topics where there is controversy. It’s ok as a lookup for common knowledge stuff, but wherever there is ongoing discussion wikipedia is useless.</blockquote></mx-reply> * Even years of interwebs experience still let me forget that tone doesn’t always translate well. /blush","m.new_content":{"body":"Even years of interwebs experience still let me forget that tone doesn’t always translate well. /blush","msgtype":"m.text"},"m.relates_to":{"event_id":"$fBEEA_8j_DL367sx7F8Xv2ip8ET8AvlTFcGWsDs8orI","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675260432923,"senderName":"pipobscure","senderId":"@pipobscure:matrix.org","id":"$0XuDgC5RRkUT9TXQYD4SnbEqYjYbWSAFsAW06eDStbo"},
{"content":{"body":"Yeah I am pretty baffled, what does vandalizing Wikipedia have to do with what we are discussing?","msgtype":"m.text"},"ts":1675260698324,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$V2Z82dr6hj_A81q1I-fiWY5TOl6ye16iTbDImocK-K4"},
{"content":{"body":"> <@littledan:matrix.org> Yeah I am pretty baffled, what does vandalizing Wikipedia have to do with what we are discussing?\n\nI resent that (vandalizing?). That was an entirely valid edit. Also you do have to explain why the change is an improvement. So…\n\nBut it does go to show that some sources (i.e. wikipedia) can’t really be valid precedent in this argument. ","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw%3Amatrix.org/%24V2Z82dr6hj_A81q1I-fiWY5TOl6ye16iTbDImocK-K4\">In reply to</a> <a href=\"https://matrix.to/#/@littledan:matrix.org\">@littledan:matrix.org</a><br>Yeah I am pretty baffled, what does vandalizing Wikipedia have to do with what we are discussing?</blockquote></mx-reply><p>I resent that (vandalizing?). That was an entirely valid edit. Also you do have to explain why the change is an improvement. So…</p>\n<p>But it does go to show that some sources (i.e. wikipedia) can’t really be valid precedent in this argument.</p>","m.relates_to":{"m.in_reply_to":{"event_id":"$V2Z82dr6hj_A81q1I-fiWY5TOl6ye16iTbDImocK-K4"}},"msgtype":"m.text"},"ts":1675260816650,"senderName":"pipobscure","senderId":"@pipobscure:matrix.org","id":"$aJxcb0TSz-Sfb6AKhRhSlYO1rRt1opG5ppoAlPSMII0"},
{"content":{"body":"OK, I think we all know Wikipedia can be edited… not sure what that proves","msgtype":"m.text"},"ts":1675260944148,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$uCOqxWLE_ATg7Lk7gRi0SA-u6rSG6y8Dk1QWlOhlKzY"},
{"content":{"body":"The bigger point here is, we should be able to collectively bikeshed something and be able to draw a conclusion based on treating all delegates as equal and respecting all the points raised. This is what we are having trouble doing here.","msgtype":"m.text"},"ts":1675260978107,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$RB5HXyjUCzp3o5bj7ke_HxIs_-lTm7kf2M1_7D2aEAY"},
{"content":{"body":"I think our unanimity model is getting a little frustrating here because folks feel like threats of blocks are being used in a way that makes other delegates feel like their point will be ignored (which would violate the original goal of our consensus-seeking in the first place). This equality/inclusion/process question is a bigger issue than the actual contents of the arguments (since anything will work technically).","msgtype":"m.text"},"ts":1675261285219,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$PUGDwK9AKKgwRzc1IRHufS_Q9YaGIo6wkveu7CiD6bg"},
{"content":{"body":"Luckily we could ensure that doesn't happen. Scala evolves with a very different process","m.relates_to":{"event_id":"$8o7d7kxS99gAfu4IOy7vmOvinrSSx_Wl76bMgHd0CGw","is_falling_back":true,"m.in_reply_to":{"event_id":"$IlFCJ8IUS24WbWQ0itxZ5fzyzl53DClhUciaWyeMxzE"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675263073055,"senderName":"Anthony Bullard","senderId":"@anthonybullard:matrix.org","id":"$5Y88djUV-OMcoM9gxHQObjJb_rjRXknS8rmc0gGu8QY"},
{"content":{"body":"And values different things","m.relates_to":{"event_id":"$8o7d7kxS99gAfu4IOy7vmOvinrSSx_Wl76bMgHd0CGw","is_falling_back":true,"m.in_reply_to":{"event_id":"$5Y88djUV-OMcoM9gxHQObjJb_rjRXknS8rmc0gGu8QY"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675263081683,"senderName":"Anthony Bullard","senderId":"@anthonybullard:matrix.org","id":"$-cO1EB4pJoKk56lEZ_9kV7JJ_MBXlKjljdRRUuSQ1VY"},
{"content":{"body":"But as someone who wrote it in some capacity professionally for four years, the _ seems like a more natural  placeholder","m.relates_to":{"event_id":"$8o7d7kxS99gAfu4IOy7vmOvinrSSx_Wl76bMgHd0CGw","is_falling_back":true,"m.in_reply_to":{"event_id":"$-cO1EB4pJoKk56lEZ_9kV7JJ_MBXlKjljdRRUuSQ1VY"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675263127796,"senderName":"Anthony Bullard","senderId":"@anthonybullard:matrix.org","id":"$_YZhfjt7XakbU_6Z-uOumCwBkBXhhcqEFFDRD1MZ4Bg"},
{"content":{"body":"Compiled languages have it so much easier in many ways...","m.relates_to":{"event_id":"$8o7d7kxS99gAfu4IOy7vmOvinrSSx_Wl76bMgHd0CGw","is_falling_back":true,"m.in_reply_to":{"event_id":"$_YZhfjt7XakbU_6Z-uOumCwBkBXhhcqEFFDRD1MZ4Bg"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675263311014,"senderName":"Anthony Bullard","senderId":"@anthonybullard:matrix.org","id":"$hvSuSOSMlc3YQ2coRTRHm65-13JQ0KOD0Iu_ov8a4xw"},
{"content":{"body":"> <@littledan:matrix.org> I think our unanimity model is getting a little frustrating here because folks feel like threats of blocks are being used in a way that makes other delegates feel like their point will be ignored (which would violate the original goal of our consensus-seeking in the first place). This equality/inclusion/process question is a bigger issue than the actual contents of the arguments (since anything will work technically).\n\nI would support the change to a consensus model that doesn't require 100% agreement.  I don't like that one veto stops something.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$PUGDwK9AKKgwRzc1IRHufS_Q9YaGIo6wkveu7CiD6bg?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@littledan:matrix.org\">@littledan:matrix.org</a><br>I think our unanimity model is getting a little frustrating here because folks feel like threats of blocks are being used in a way that makes other delegates feel like their point will be ignored (which would violate the original goal of our consensus-seeking in the first place). This equality/inclusion/process question is a bigger issue than the actual contents of the arguments (since anything will work technically).</blockquote></mx-reply>I would support the change to a consensus model that doesn't require 100% agreement.  I don't like that one veto stops something.","m.relates_to":{"m.in_reply_to":{"event_id":"$PUGDwK9AKKgwRzc1IRHufS_Q9YaGIo6wkveu7CiD6bg"}},"msgtype":"m.text"},"ts":1675263619678,"senderName":"msaboff","senderId":"@msaboff:matrix.org","id":"$cYx1OZX1TGZJDT9Ahn0v5TaWjRsBvwVbJRML4IjWsdQ"},
{"content":{"body":"I think all other TC's use a true consensus model.","msgtype":"m.text"},"ts":1675263688344,"senderName":"msaboff","senderId":"@msaboff:matrix.org","id":"$V3BqCYVFQGMmyTIXQaW6LZj691U2t1-E1q-Jn7MOzRw"},
{"content":{"body":"It feels like there needs to be a very clear model of what kind of dissent and by how many parties constitutes a breakage of consensus. ","msgtype":"m.text"},"ts":1675264241802,"senderName":"Anthony Bullard","senderId":"@anthonybullard:matrix.org","id":"$MccSUSLnPNBElla7ekS4_iFCT70WxQn__6v1Vb1iihM"},
{"content":{"body":"re: async contexts, I am assuming that the behavior is, whenever a function is scheduled to be run on a subsequent microtask tick or turn of the event loop, the host is required to snapshot the current async context bits and then restore them before running the function?","msgtype":"m.text"},"ts":1675264466633,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$wQFcfuAWcHEcKpmdqRJUXWA3-7SITrf4-BhHsV-rhgs"},
{"content":{"body":"If not one, how many? To be honest, I feel the problem is not 100% or 80%.","msgtype":"m.text"},"ts":1675264482457,"senderName":"HE Shi-Jun","senderId":"@haxjs:matrix.org","id":"$mxnvjQVXztzyrCLVrrZzAI9d5jlie32HhG7cyqT3Orc"},
{"content":{"body":"i.e. this isn't just for literal `async` but also for stuff like `addEventListener`?","format":"org.matrix.custom.html","formatted_body":"i.e. this isn't just for literal <code>async</code> but also for stuff like <code>addEventListener</code>?","msgtype":"m.text"},"ts":1675264483402,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$hZtq6BU0H59F3_Y_0gVE4KSPOfi--7587n3APGmDdKE"},
{"content":{"body":" * i.e. this isn't just for literal `async` but also for stuff like `addEventListener`?","format":"org.matrix.custom.html","formatted_body":" * i.e. this isn't just for literal <code>async</code> but also for stuff like <code>addEventListener</code>?","m.new_content":{"body":"i.e. this isn't just for literal `async` but also for stuff like `addEventListener`?","format":"org.matrix.custom.html","formatted_body":"i.e. this isn't just for literal <code>async</code> but also for stuff like <code>addEventListener</code>?","msgtype":"m.text"},"m.relates_to":{"event_id":"$hZtq6BU0H59F3_Y_0gVE4KSPOfi--7587n3APGmDdKE","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675264488451,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$2-fvdRGj8kHJZfi_wpNXCTAt9jEAC93qwSBhSiJIIrY"},
{"content":{"body":"> <@msaboff:matrix.org> I would support the change to a consensus model that doesn't require 100% agreement.  I don't like that one veto stops something.\n\nI agree. The failure mode we have is very unfortunate, and this case highlights it. I think this indicates a need for us to reconsider our process.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$cYx1OZX1TGZJDT9Ahn0v5TaWjRsBvwVbJRML4IjWsdQ?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@msaboff:matrix.org\">@msaboff:matrix.org</a><br>I would support the change to a consensus model that doesn't require 100% agreement.  I don't like that one veto stops something.</blockquote></mx-reply>I agree. The failure mode we have is very unfortunate, and this case highlights it. I think this indicates a need for us to reconsider our process.","m.relates_to":{"m.in_reply_to":{"event_id":"$cYx1OZX1TGZJDT9Ahn0v5TaWjRsBvwVbJRML4IjWsdQ"}},"msgtype":"m.text"},"ts":1675264497812,"senderName":"yulia","senderId":"@yulia:mozilla.org","id":"$5HyhHEHe8eVuaDxbCP68JRp4jZaKcfUJSkQHcGhFE30"},
{"content":{"body":"though event listeners are kind of an odd case, because they run _sync_ if you dispatch an event manually, so I'm not totally clear what's supposed to happen there...","format":"org.matrix.custom.html","formatted_body":"though event listeners are kind of an odd case, because they run <em>sync</em> if you dispatch an event manually, so I'm not totally clear what's supposed to happen there...","msgtype":"m.text"},"ts":1675264508650,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$c1YnrT6RPd_k7MZ9O1HeIY-7V3_DVVRu1X23BlS-XJM"},
{"content":{"body":"> <@bakkot:matrix.org> re: async contexts, I am assuming that the behavior is, whenever a function is scheduled to be run on a subsequent microtask tick or turn of the event loop, the host is required to snapshot the current async context bits and then restore them before running the function?\n\nyes, there will be a responsibility for the host environment to make sure the event-scheduling APIs it introduces (like `setTimeout`) use something similar to `AsyncContext.wrap` for their callbacks","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$wQFcfuAWcHEcKpmdqRJUXWA3-7SITrf4-BhHsV-rhgs?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@bakkot:matrix.org\">@bakkot:matrix.org</a><br>re: async contexts, I am assuming that the behavior is, whenever a function is scheduled to be run on a subsequent microtask tick or turn of the event loop, the host is required to snapshot the current async context bits and then restore them before running the function?</blockquote></mx-reply>yes, there will be a responsibility for the host environment to make sure the event-scheduling APIs it introduces (like <code>setTimeout</code>) use something similar to <code>AsyncContext.wrap</code> for their callbacks","m.relates_to":{"m.in_reply_to":{"event_id":"$wQFcfuAWcHEcKpmdqRJUXWA3-7SITrf4-BhHsV-rhgs"}},"msgtype":"m.text"},"ts":1675264519066,"senderName":"Ben Newman (Apollo, @benjamn on GH)","senderId":"@benjamn:matrix.org","id":"$nDhLs7b_5S5c8YVHYop-tKOX2cEbY_JdRB3RSt2m3MM"},
{"content":{"body":"bakkot: that's been my understanding as well","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@bakkot:matrix.org\">bakkot</a>: that's been my understanding as well","msgtype":"m.text"},"ts":1675264523864,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$HouTgWa8ZGbARvR6dubqUYMsNj-XicN7qxjQ-WHKYzg"},
{"content":{"body":"i'm kind of confused by justin's example saying the propagation point is at the await pause","msgtype":"m.text"},"ts":1675264538642,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$gbUBruJrUa4UURPjez2K_jblf030Ag8qTPPgcKKMmTc"},
{"content":{"body":"there is a decent list of proposals that were blocked by a lone objector, including some of the folks discussing changing the process here, fwiw. would we revist all of those if there were a process change?","msgtype":"m.text"},"ts":1675264543902,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$CnZ6vLRNIeyby2cfPMra1AP87jGtuAptZqx30V00RLE"},
{"content":{"body":"it can't work if it's _just_ promise reactions","format":"org.matrix.custom.html","formatted_body":"it can't work if it's <em>just</em> promise reactions","msgtype":"m.text"},"ts":1675264549057,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$eAETsWSUb1FoDGVp_z86ubRXKRMqieInKemxVcesQNw"},
{"content":{"body":"right, but those are the hardest to polyfill","msgtype":"m.text"},"ts":1675264564382,"senderName":"Ben Newman (Apollo, @benjamn on GH)","senderId":"@benjamn:matrix.org","id":"$IxEgmJWospCMne5L3G6WEXt3gheXEotafrt55btiO6A"},
{"content":{"body":"> <@shuyuguo:matrix.org> i'm kind of confused by justin's example saying the propagation point is at the await pause\n\nthe await pause is the point where you are scheduling a thing to be run on a subsequent tick, so that seems consistent?","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$gbUBruJrUa4UURPjez2K_jblf030Ag8qTPPgcKKMmTc?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@shuyuguo:matrix.org\">@shuyuguo:matrix.org</a><br>i&#39;m kind of confused by justin&#39;s example saying the propagation point is at the await pause</blockquote></mx-reply>the await pause is the point where you are scheduling a thing to be run on a subsequent tick, so that seems consistent?","m.relates_to":{"m.in_reply_to":{"event_id":"$gbUBruJrUa4UURPjez2K_jblf030Ag8qTPPgcKKMmTc"}},"msgtype":"m.text"},"ts":1675264598221,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$M9OwPfGN9jgAq0c4nJ7gABI00B2rsxd2BfrJBJf8Yhs"},
{"content":{"body":"bakkot: that's the second one, i thought there was a handler scheduled earlier","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@bakkot:matrix.org\">bakkot</a>: that's the second one, i thought there was a handler scheduled earlier","msgtype":"m.text"},"ts":1675264615580,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$fhswmCnqgpGzxlCWTdLgrLf-red69O7I6PLr6NjmOFM"},
{"content":{"body":"i might be mixing slides?","msgtype":"m.text"},"ts":1675264619731,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$M6RJ3UgIt95nFb6-sAypNYOW5t5Tcfe6ZCrjPAkjtPk"},
{"content":{"body":"anyway my point is just the host hooks i added for incumbent are only for JS callbacks","msgtype":"m.text"},"ts":1675264642709,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$cGuuzhhOsRTCTRsT243hIxL6qU2tRjPHQF4lkm7fpUk"},
{"content":{"body":"this needs host event loop hook-ins as well","msgtype":"m.text"},"ts":1675264651650,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$NtvtjP6yZJZmHPClYeZNPfQ3uVsrJu7NiuXqL4cHtfw"},
{"content":{"body":" * there is a decent list of proposals that were blocked by a lone objector, including some of the folks discussing changing the process here, fwiw. would we revist all of those if there were a process change?","m.new_content":{"body":"there is a decent list of proposals that were blocked by a lone objector, including some of the folks discussing changing the process here, fwiw. would we revist all of those if there were a process change?","msgtype":"m.text"},"m.relates_to":{"event_id":"$CnZ6vLRNIeyby2cfPMra1AP87jGtuAptZqx30V00RLE","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675264669103,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$4TLwFaFpYQIsTYEUgN_y8ipa8LjUVwDUIJ25Tc3pp4c"},
{"content":{"body":" * anyway my point is just the host hooks i added for incumbent are only for JS callbacks","m.new_content":{"body":"anyway my point is just the host hooks i added for incumbent are only for JS callbacks","msgtype":"m.text"},"m.relates_to":{"event_id":"$cGuuzhhOsRTCTRsT243hIxL6qU2tRjPHQF4lkm7fpUk","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675264670239,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$jsYG-BBPq-eBZCt2Uj_zM--hCPE-h-Eu134NKNG1ws4"},
{"content":{"body":"indeed, as this slide is saying","msgtype":"m.text"},"ts":1675264697761,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$i3dOzw1tJHN0pybQoEGJkE5XBAwrS-Sk4FkJs_W69n4"},
{"content":{"body":"I will ask the question about event listener dispatch I guess","msgtype":"m.text"},"ts":1675264742060,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$XkFffuJ-smlm5kotKJCgBI3-PsEfLHidSUsAMn04KNw"},
{"content":{"body":"are folks here aware of the V8 methods `v8::Context::{Get,Set}ContinuationPreservedEmbedderData`?","format":"org.matrix.custom.html","formatted_body":"are folks here aware of the V8 methods <code>v8::Context::{Get,Set}ContinuationPreservedEmbedderData</code>?","msgtype":"m.text"},"ts":1675264760285,"senderName":"Ben Newman (Apollo, @benjamn on GH)","senderId":"@benjamn:matrix.org","id":"$gYe64AyeGk1KQSNwZfYnILlNLjm82phH60YtUXWupFI"},
{"content":{"body":"that's not quite enough","msgtype":"m.text"},"ts":1675264780756,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$kbaaX1pM4AjsbWMMsMCyARXIPupzzB9AR4HzbeRsQNc"},
{"content":{"body":"we have that, yes, but you need more muxing","msgtype":"m.text"},"ts":1675264792807,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$ADgIsiWHaGDIyVH36phDFP-baAcDwssxXvpIkYPM_uo"},
{"content":{"body":"I know, but I'm trying to gauge context","msgtype":"m.text"},"ts":1675264793084,"senderName":"Ben Newman (Apollo, @benjamn on GH)","senderId":"@benjamn:matrix.org","id":"$hfVGHR2EyV_zEYGgaKP3BORSjOLid0Uba9VaXFm24OY"},
{"content":{"body":"> <@bakkot:matrix.org> I will ask the question about event listener dispatch I guess\n\ngood to ask. Though presumably all APIs could be wrapped in userland anyway. So technically nothing also stopping hosts doing that?","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$XkFffuJ-smlm5kotKJCgBI3-PsEfLHidSUsAMn04KNw?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@bakkot:matrix.org\">@bakkot:matrix.org</a><br>I will ask the question about event listener dispatch I guess</blockquote></mx-reply>good to ask. Though presumably all APIs could be wrapped in userland anyway. So technically nothing also stopping hosts doing that?","m.relates_to":{"m.in_reply_to":{"event_id":"$XkFffuJ-smlm5kotKJCgBI3-PsEfLHidSUsAMn04KNw"}},"msgtype":"m.text"},"ts":1675264800726,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$ncdAgVfLCrLWT02cNqrbzTgd86YQ04790ZnnyTbgtjA"},
{"content":{"body":"Ashley Claymore: the event listener question is less \"how is this implemented\" and more \"what is the thing you want here\" - I'm trying to get at the mental model, not the implementation","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@aclaymore:matrix.org\">Ashley Claymore</a>: the event listener question is less &quot;how is this implemented&quot; and more &quot;what is the thing you want here&quot; - I'm trying to get at the mental model, not the implementation","msgtype":"m.text"},"ts":1675264869059,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$d9WdzMyxH7Y6lkZCxU6Y5Q_wzvK0l8asS_eo9qCYulI"},
{"content":{"body":"I disagree with Justin's example: i think web platform built-ins should do the `wrap` for you. It's more like if you have JS code which queues callbacks, that you want `wrap`.","format":"org.matrix.custom.html","formatted_body":"I disagree with Justin's example: i think web platform built-ins should do the <code>wrap</code> for you. It's more like if you have JS code which queues callbacks, that you want <code>wrap</code>.","msgtype":"m.text"},"ts":1675264898824,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$Bu3-usaePQuOpzxfUjFKOsEw-FvtMYVIgHHAlVtTpbI"},
{"content":{"body":"that becomes a lot easier if/once `AsyncWrap` is standardized","format":"org.matrix.custom.html","formatted_body":"that becomes a lot easier if/once <code>AsyncWrap</code> is standardized","msgtype":"m.text"},"ts":1675264927935,"senderName":"Ben Newman (Apollo, @benjamn on GH)","senderId":"@benjamn:matrix.org","id":"$Yx5g-80Uu8ZexYKN4g2-Ly_30MeTCxgJwnBm8yvK6B4"},
{"content":{"body":"> <@bakkot:matrix.org> Ashley Claymore: the event listener question is less \"how is this implemented\" and more \"what is the thing you want here\" - I'm trying to get at the mental model, not the implementation\n\nhttps://github.com/legendecas/proposal-async-context/issues/19 many events are emitted by runtimes asynchronously","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$d9WdzMyxH7Y6lkZCxU6Y5Q_wzvK0l8asS_eo9qCYulI?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@bakkot:matrix.org\">@bakkot:matrix.org</a><br><a href=\"https://matrix.to/#/@aclaymore:matrix.org\">Ashley Claymore</a>: the event listener question is less \"how is this implemented\" and more \"what is the thing you want here\" - I'm trying to get at the mental model, not the implementation</blockquote></mx-reply>https://github.com/legendecas/proposal-async-context/issues/19 many events are emitted by runtimes asynchronously","m.relates_to":{"m.in_reply_to":{"event_id":"$d9WdzMyxH7Y6lkZCxU6Y5Q_wzvK0l8asS_eo9qCYulI"}},"msgtype":"m.text"},"ts":1675264935978,"senderName":"Chengzhong Wu","senderId":"@legendecas:matrix.org","id":"$ErE7XdQD47Pz1HOfmIrwuidQhWuOT8EtAAk7yCW3xqo"},
{"content":{"body":"> <@benjamn:matrix.org> that becomes a lot easier if/once `AsyncWrap` is standardized\n\nYes, obviously the platform can't do anything if we don't add AsyncContext :) I was just nit-picking","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$Yx5g-80Uu8ZexYKN4g2-Ly_30MeTCxgJwnBm8yvK6B4?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@benjamn:matrix.org\">@benjamn:matrix.org</a><br>that becomes a lot easier if/once <code>AsyncWrap</code> is standardized</blockquote></mx-reply>Yes, obviously the platform can't do anything if we don't add AsyncContext :) I was just nit-picking","m.relates_to":{"m.in_reply_to":{"event_id":"$Yx5g-80Uu8ZexYKN4g2-Ly_30MeTCxgJwnBm8yvK6B4"}},"msgtype":"m.text"},"ts":1675264963641,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$tvJiCrYO1a8pfDiemwDaqtN_gaz1fE06UPQ-cGRvJes"},
{"content":{"body":"Chengzhong Wu: right, and others are emitted synchronously (e.g. by a manual `dispatchEvent`)","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@legendecas:matrix.org\">Chengzhong Wu</a>: right, and others are emitted synchronously (e.g. by a manual <code>dispatchEvent</code>)","msgtype":"m.text"},"ts":1675264973651,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$sAfuCE9EuLo4I2p0dNczaBG08eEzbAqu3VXGMH2OgTo"},
{"content":{"body":"so: if you register an event listener while within an async context, and then an event is dispatched async by the browser, presumably you want the listener to see the original context. but what if the event is dispatched sync, by `dispatchEvent`? sync dispatch is basically just a weird sort of function call, so it seems like it's the _current_ context, not the original one?","format":"org.matrix.custom.html","formatted_body":"so: if you register an event listener while within an async context, and then an event is dispatched async by the browser, presumably you want the listener to see the original context. but what if the event is dispatched sync, by <code>dispatchEvent</code>? sync dispatch is basically just a weird sort of function call, so it seems like it's the <em>current</em> context, not the original one?","msgtype":"m.text"},"ts":1675265040526,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$Ak9u-gYvih7ZYohMBqVGXjrpiWguqzj9c3Nz0M-3orQ"},
{"content":{"body":"not clear to me which context you want there","msgtype":"m.text"},"ts":1675265050550,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$1nKWZp_ACXBBay5DYqjvRlDqTgdrm2A6DpKEaU5QHgM"},
{"content":{"body":"Unfortunately the answer might depend on the event","msgtype":"m.text"},"ts":1675265109901,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$pkGxzpT4DuSrUSWwm_2qhtM0gmHNLswOcCu2g7bPfG8"},
{"content":{"body":"sync function calls should just inherit the current context, leading to the same behavior? (pls clarify)","msgtype":"m.text"},"ts":1675265110726,"senderName":"Ben Newman (Apollo, @benjamn on GH)","senderId":"@benjamn:matrix.org","id":"$0KUX-myCJgNmzeClkheMHnJ9C3M5nygjft7z5wI5JVY"},
{"content":{"body":" * sync function calls should just inherit the current context, leading to the same behavior? (pls clarify)","m.new_content":{"body":"sync function calls should just inherit the current context, leading to the same behavior? (pls clarify)","msgtype":"m.text"},"m.relates_to":{"event_id":"$0KUX-myCJgNmzeClkheMHnJ9C3M5nygjft7z5wI5JVY","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675265120235,"senderName":"Ben Newman (Apollo, @benjamn on GH)","senderId":"@benjamn:matrix.org","id":"$d-SetqrA0yT61CD0PwEd3z6_85yGakrPLJCEGIHMiFE"},
{"content":{"body":"and there may be up to three answers for different task types","msgtype":"m.text"},"ts":1675265125656,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$nvPZGJAkZWbdX7_kNsLn_OR9B9nPV1G-gBm3hWWixxE"},
{"content":{"body":"this would be part of the DOM/HTML/Node.js integration with AsyncContext","msgtype":"m.text"},"ts":1675265140593,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$3BbTR3qIiy66NRYcr8wCzIJF7CJh-cGt5mAkZQ5nsH8"},
{"content":{"body":"Yeah, that's the point of an alternative option `captureAsyncContext` of `addEventListener`","format":"org.matrix.custom.html","formatted_body":"Yeah, that's the point of an alternative option <code>captureAsyncContext</code> of <code>addEventListener</code>","msgtype":"m.text"},"ts":1675265142959,"senderName":"Chengzhong Wu","senderId":"@legendecas:matrix.org","id":"$jmRR-0HgaJsG2mVebSXS1HdxObTm8mp8FT1T3uwGZbU"},
{"content":{"body":"> <@benjamn:matrix.org> sync function calls should just inherit the current context, leading to the same behavior? (pls clarify)\n\nsorry: the same behavior as what?","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$0KUX-myCJgNmzeClkheMHnJ9C3M5nygjft7z5wI5JVY?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@benjamn:matrix.org\">@benjamn:matrix.org</a><br>sync function calls should just inherit the current context, leading to the same behavior? (pls clarify)</blockquote></mx-reply>sorry: the same behavior as what?","m.relates_to":{"m.in_reply_to":{"event_id":"$0KUX-myCJgNmzeClkheMHnJ9C3M5nygjft7z5wI5JVY"}},"msgtype":"m.text"},"ts":1675265147195,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$uIEbq3BaHy-UXmIIXmsR16g7cW4-ye2A1ZbJ9-PY7xY"},
{"content":{"body":"> <@legendecas:matrix.org> Yeah, that's the point of an alternative option `captureAsyncContext` of `addEventListener`\n\nwell, there are separate questions about whether we want to give programmatic control, and what the default should be for each event.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$jmRR-0HgaJsG2mVebSXS1HdxObTm8mp8FT1T3uwGZbU?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@legendecas:matrix.org\">@legendecas:matrix.org</a><br>Yeah, that's the point of an alternative option <code>captureAsyncContext</code> of <code>addEventListener</code></blockquote></mx-reply>well, there are separate questions about whether we want to give programmatic control, and what the default should be for each event.","m.relates_to":{"m.in_reply_to":{"event_id":"$jmRR-0HgaJsG2mVebSXS1HdxObTm8mp8FT1T3uwGZbU"}},"msgtype":"m.text"},"ts":1675265171798,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$yV3W8F_H5t5Tpzn3oYYYlsbZ6zAjZnNRCrdkTlZLSf4"},
{"content":{"body":"the event should be dispatched with the context you bound/wrapped, whether that happens synchronously or async","msgtype":"m.text"},"ts":1675265174579,"senderName":"Ben Newman (Apollo, @benjamn on GH)","senderId":"@benjamn:matrix.org","id":"$dNObKo6j8d1HnCFZH-DkqYWlAdUp28BqPUZQt8EkmZo"},
{"content":{"body":"> <@benjamn:matrix.org> the event should be dispatched with the context you bound/wrapped, whether that happens synchronously or async\n\nthis is definitely sometimes not true. It is really not the right answer for the unhandled rejection event, for example (we are discussing this in an issue)","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$dNObKo6j8d1HnCFZH-DkqYWlAdUp28BqPUZQt8EkmZo?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@benjamn:matrix.org\">@benjamn:matrix.org</a><br>the event should be dispatched with the context you bound/wrapped, whether that happens synchronously or async</blockquote></mx-reply>this is definitely sometimes not true. It is really not the right answer for the unhandled rejection event, for example (we are discussing this in an issue)","m.relates_to":{"m.in_reply_to":{"event_id":"$dNObKo6j8d1HnCFZH-DkqYWlAdUp28BqPUZQt8EkmZo"}},"msgtype":"m.text"},"ts":1675265200499,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$_Lp-XtLaAfDFhIUMpsago46yAJ0J5HsfnBP5jvZp_ok"},
{"content":{"body":"I think we have to look event by event to figure this out","msgtype":"m.text"},"ts":1675265214325,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$qb37K7oA3s52gNeA4ldXtPiYgLkUjIMDFdRv7dK1aNM"},
{"content":{"body":"sorry I think we must be talking past each other or about slightly different things","msgtype":"m.text"},"ts":1675265221009,"senderName":"Ben Newman (Apollo, @benjamn on GH)","senderId":"@benjamn:matrix.org","id":"$0TS3QbVNpCuAJQmsaPaptn8pvX7wKNNrujJZIy8nrqg"},
{"content":{"body":"> <@benjamn:matrix.org> the event should be dispatched with the context you bound/wrapped, whether that happens synchronously or async\n\nI guess I don't know what those words mean","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$dNObKo6j8d1HnCFZH-DkqYWlAdUp28BqPUZQt8EkmZo?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@benjamn:matrix.org\">@benjamn:matrix.org</a><br>the event should be dispatched with the context you bound/wrapped, whether that happens synchronously or async</blockquote></mx-reply>I guess I don't know what those words mean","m.relates_to":{"m.in_reply_to":{"event_id":"$dNObKo6j8d1HnCFZH-DkqYWlAdUp28BqPUZQt8EkmZo"}},"msgtype":"m.text"},"ts":1675265225231,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$Uqv6M1kQpFiN3_7KficqGtfTs6wqzx5qwexL8IfokAQ"},
{"content":{"body":"calling a wrapped synchronous function would also let you change a context synchronously","msgtype":"m.text","org.matrix.msc1767.text":"calling a wrapped synchronous function would also let you change a context synchronously"},"ts":1675265453095,"senderName":"Andreu Botella","senderId":"@abotella:igalia.com","id":"$YBPteL48HyIkrliHUnFp4KoMlzf7kkUn9uYJdclz0YA"},
{"content":{"body":"OK I think I understand now","msgtype":"m.text"},"ts":1675265458936,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$7BK8JNCqRnu13o5afFtYKcjQTz1x4IgAg8lYMwsFaN8"},
{"content":{"body":"the fact that not all callbacks will necessarily automatically inherit the context in which the callback was added (depending on the API which adds the callback) is a little bit awkward, since the whole point of this is that you want to define a context which is available when your callback runs _even though your callback is getting registered to run by code you don't control_","format":"org.matrix.custom.html","formatted_body":"the fact that not all callbacks will necessarily automatically inherit the context in which the callback was added (depending on the API which adds the callback) is a little bit awkward, since the whole point of this is that you want to define a context which is available when your callback runs <em>even though your callback is getting registered to run by code you don't control</em>","msgtype":"m.text"},"ts":1675265716497,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$qFmtvADQK-4P0lswX0jY-VR6RmosaBukkn-JSefgQFk"},
{"content":{"body":"is there any precedent for an API like this?","msgtype":"m.text"},"ts":1675265718689,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$noM9FMeQgf91HMCKH99ZqR4bvhXoY-0MErcows7_G5E"},
{"content":{"body":"it's a stage 2 concern, but I'm very skeptical that this is the right representation","msgtype":"m.text"},"ts":1675265731823,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$c-h3JaOhPHhXAwca9vj3a9Y9QIWERhJTR9VSJE5zhqQ"},
{"content":{"body":" * it's a stage 2 concern, but I'm very skeptical that this is the right representation","m.new_content":{"body":"it's a stage 2 concern, but I'm very skeptical that this is the right representation","msgtype":"m.text"},"m.relates_to":{"event_id":"$c-h3JaOhPHhXAwca9vj3a9Y9QIWERhJTR9VSJE5zhqQ","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675265747102,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$g1lcJmoFF_qu2LJV4KZr7Hnv4LKN0Di_yP3UII2Az7k"},
{"content":{"body":" * the fact that not all callbacks will necessarily automatically inherit the context in which the callback was added is a little bit awkward, since the whole point of this is that you want to define a context which is available when your callback runs _even though your callback is getting scheduled by code you don't control_","format":"org.matrix.custom.html","formatted_body":" * the fact that not all callbacks will necessarily automatically inherit the context in which the callback was added is a little bit awkward, since the whole point of this is that you want to define a context which is available when your callback runs <em>even though your callback is getting scheduled by code you don't control</em>","m.new_content":{"body":"the fact that not all callbacks will necessarily automatically inherit the context in which the callback was added is a little bit awkward, since the whole point of this is that you want to define a context which is available when your callback runs _even though your callback is getting scheduled by code you don't control_","format":"org.matrix.custom.html","formatted_body":"the fact that not all callbacks will necessarily automatically inherit the context in which the callback was added is a little bit awkward, since the whole point of this is that you want to define a context which is available when your callback runs <em>even though your callback is getting scheduled by code you don't control</em>","msgtype":"m.text"},"m.relates_to":{"event_id":"$qFmtvADQK-4P0lswX0jY-VR6RmosaBukkn-JSefgQFk","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675265788076,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$5xVoxCgIkQE5TWGQkwg_CjZmiRMDoWqTTxkLY67TVMo"},
{"content":{"body":" * the fact that not all callbacks will necessarily automatically inherit the context in which the callback was added (depending on the API which adds the callback) is a little bit awkward, since the whole point of this is that you want to define a context which is available when your callback runs _even though your callback is getting registered to run by code you don't control_","format":"org.matrix.custom.html","formatted_body":" * the fact that not all callbacks will necessarily automatically inherit the context in which the callback was added (depending on the API which adds the callback) is a little bit awkward, since the whole point of this is that you want to define a context which is available when your callback runs <em>even though your callback is getting registered to run by code you don't control</em>","m.new_content":{"body":"the fact that not all callbacks will necessarily automatically inherit the context in which the callback was added (depending on the API which adds the callback) is a little bit awkward, since the whole point of this is that you want to define a context which is available when your callback runs _even though your callback is getting registered to run by code you don't control_","format":"org.matrix.custom.html","formatted_body":"the fact that not all callbacks will necessarily automatically inherit the context in which the callback was added (depending on the API which adds the callback) is a little bit awkward, since the whole point of this is that you want to define a context which is available when your callback runs <em>even though your callback is getting registered to run by code you don't control</em>","msgtype":"m.text"},"m.relates_to":{"event_id":"$qFmtvADQK-4P0lswX0jY-VR6RmosaBukkn-JSefgQFk","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675265823182,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$1r3HMRKufpr2HuwCnj3YDsvAZ4hvj6DHv98pYeLw0Vs"},
{"content":{"body":"https://github.com/legendecas/proposal-async-context#prior-arts","msgtype":"m.text"},"ts":1675265922336,"senderName":"Chengzhong Wu","senderId":"@legendecas:matrix.org","id":"$n3Vpxt6LFALpglkBaOykcNin3EEdJXQMOOho8mAF9Yg"},
{"content":{"body":"These are javascript precedents. C# also implements similar APIs","msgtype":"m.text"},"ts":1675265945436,"senderName":"Chengzhong Wu","senderId":"@legendecas:matrix.org","id":"$vKg78Zl4oNkGDK3bNVKRQk0SAnkz_16-MuANJkOR-tY"},
{"content":{"body":"Reactivity libraries with dependency tracking like SolidJS also have similar though more domain specific APIs","msgtype":"m.text"},"ts":1675265960894,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$lg5fzLDPAWfyjUpOhfeqXpPMf9ZgI5XaKN2qgG4Cfgw"},
{"content":{"body":"https://learn.microsoft.com/en-us/dotnet/api/system.threading.asynclocal-1?view=net-7.0","m.relates_to":{"event_id":"$vKg78Zl4oNkGDK3bNVKRQk0SAnkz_16-MuANJkOR-tY","is_falling_back":true,"m.in_reply_to":{"event_id":"$vKg78Zl4oNkGDK3bNVKRQk0SAnkz_16-MuANJkOR-tY"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675265986443,"senderName":"Chengzhong Wu","senderId":"@legendecas:matrix.org","id":"$GbpZ1R0aodqztSHxQuKbhon_FdKmNodpjo2Zv1t-Lus"},
{"content":{"body":"here's the link from Mark from the jitsi chat: https://github.com/endojs/endo/blob/markm-fluid-scopes/packages/eventual-send/src/async-contexts/6-async-context-transpose.js","msgtype":"m.text"},"ts":1675266113843,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$bJQg8VKQqKb-QZX6kjuMmFFM0Lk6J0EpI6SPvEVTGv0"},
{"content":{"body":"thanks for the links, Chengzhong Wu and Ashley Claymore ","format":"org.matrix.custom.html","formatted_body":"thanks for the links, <a href=\"https://matrix.to/#/@legendecas:matrix.org\">Chengzhong Wu</a> and <a href=\"https://matrix.to/#/@aclaymore:matrix.org\">Ashley Claymore</a>","msgtype":"m.text"},"ts":1675266152541,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$0-BuxRiudgZgCAVrzVwkYgt5YiK1hK_oxfT_MswEvgs"},
{"content":{"body":"> <@bakkot:matrix.org> the fact that not all callbacks will necessarily automatically inherit the context in which the callback was added (depending on the API which adds the callback) is a little bit awkward, since the whole point of this is that you want to define a context which is available when your callback runs _even though your callback is getting registered to run by code you don't control_\n\nthinking about this more, I guess the fix is, if you are passing a context to someone else you manually `.wrap` the function first","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$qFmtvADQK-4P0lswX0jY-VR6RmosaBukkn-JSefgQFk?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@bakkot:matrix.org\">@bakkot:matrix.org</a><br>the fact that not all callbacks will necessarily automatically inherit the context in which the callback was added (depending on the API which adds the callback) is a little bit awkward, since the whole point of this is that you want to define a context which is available when your callback runs <em>even though your callback is getting registered to run by code you don't control</em></blockquote></mx-reply>thinking about this more, I guess the fix is, if you are passing a context to someone else you manually <code>.wrap</code> the function first","m.relates_to":{"m.in_reply_to":{"event_id":"$qFmtvADQK-4P0lswX0jY-VR6RmosaBukkn-JSefgQFk"}},"msgtype":"m.text"},"ts":1675266156538,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$EudevcJUVdv7Yf4KpTHIm8D8xJ4OXffKLoCWise0cws"},
{"content":{"body":"I have no idea how a JS engine would implement that super fancy context splitting that Shu was alluding to","msgtype":"m.text"},"ts":1675266156782,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$vhordIS4VhHKGlLXNaEdwC_ySEE_0XLVQGDdqDhqDtw"},
{"content":{"body":"this is a bit distinct from weak maps/references","msgtype":"m.text"},"ts":1675266169966,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$qJ1W9RZznE1fl6aJ3BvzgF2cj2j58gnjRM3wyitkaUs"},
{"content":{"body":"always impressed by all JS engines' optimization ideas","msgtype":"m.text"},"ts":1675266188420,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$DH8L9xL4jPrdRc7qcNtQCdhDGbULUkLB7mTc6hiIpt0"},
{"content":{"body":"Someone might be able to get a published paper out of optimizing this :D","msgtype":"m.text"},"ts":1675266272185,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$ldEqNRtlehc1us5tUAQv4u_OFgFwhhntf-v2eM6aEEc"},
{"content":{"body":"\"This one weird trick to get zero overhead async contexts\" ","msgtype":"m.text"},"ts":1675266323634,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$2yXhQei7DgKH9erkQNDw5uGWC9VteR-nzGpAbYz0Sag"},
{"content":{"body":"v8 has zero overhead async contexts","msgtype":"m.text"},"ts":1675266384578,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$1IDEVBncIdbyToZaxFANXj6k4bFGVEu5SNH-tNOukiY"},
{"content":{"body":"thinking about this even more, I am tempted to say that automatic wrapping happens _only_ when you can't do it yourself, i.e. only for syntactic `yield` and `await` (and friends, like `using await`, of course) - in every other case (including manual calls to `.then`) you can just wrap the continuation yourself, and not have to worry about whether the scheduler you're using happens to do wrapping for you","format":"org.matrix.custom.html","formatted_body":"thinking about this even more, I am tempted to say that automatic wrapping happens <em>only</em> when you can't do it yourself, i.e. only for syntactic <code>yield</code> and <code>await</code> (and friends, like <code>using await</code>, of course) - in every other case (including manual calls to <code>.then</code>) you can just wrap the continuation yourself, and not have to worry about whether the scheduler you're using happens to do wrapping for you","msgtype":"m.text","m.relates_to":{"m.in_reply_to":{"event_id":"$EudevcJUVdv7Yf4KpTHIm8D8xJ4OXffKLoCWise0cws"}}},"ts":1675266387742,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$03zvHBeK02w7hboAqk2T32zF7sYut_T6ARq5ikkZrX4"},
{"content":{"body":"the trick is that sometimes you can't get the stack!","msgtype":"m.text"},"ts":1675266390137,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$7Pau7RFajL2let5lEiSwDTvXzI1ZsWsLsy5nv-AQ-iI"},
{"content":{"body":"> <@bakkot:matrix.org> thinking about this more, I guess the fix is, if you are passing a context to someone else you manually `.wrap` the function first\n\n * thinking about this even more, I am tempted to say that automatic wrapping happens _only_ when you can't do it yourself, i.e. only for syntactic `yield` and `await` - in every other case (including manual calls to `.then`) you can just wrap the continuation yourself, and not have to worry about whether the scheduler you're using happens to do wrapping for you","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$EudevcJUVdv7Yf4KpTHIm8D8xJ4OXffKLoCWise0cws?via=matrix.org&amp;via=igalia.com&amp;via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@bakkot:matrix.org\">@bakkot:matrix.org</a><br>thinking about this more, I guess the fix is, if you are passing a context to someone else you manually <code>.wrap</code> the function first</blockquote></mx-reply> * thinking about this even more, I am tempted to say that automatic wrapping happens <em>only</em> when you can't do it yourself, i.e. only for syntactic <code>yield</code> and <code>await</code> - in every other case (including manual calls to <code>.then</code>) you can just wrap the continuation yourself, and not have to worry about whether the scheduler you're using happens to do wrapping for you","m.new_content":{"body":"thinking about this even more, I am tempted to say that automatic wrapping happens _only_ when you can't do it yourself, i.e. only for syntactic `yield` and `await` - in every other case (including manual calls to `.then`) you can just wrap the continuation yourself, and not have to worry about whether the scheduler you're using happens to do wrapping for you","format":"org.matrix.custom.html","formatted_body":"thinking about this even more, I am tempted to say that automatic wrapping happens <em>only</em> when you can't do it yourself, i.e. only for syntactic <code>yield</code> and <code>await</code> - in every other case (including manual calls to <code>.then</code>) you can just wrap the continuation yourself, and not have to worry about whether the scheduler you're using happens to do wrapping for you","msgtype":"m.text"},"m.relates_to":{"event_id":"$03zvHBeK02w7hboAqk2T32zF7sYut_T6ARq5ikkZrX4","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675266409486,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$s1vZ5wDIwYPDlIFoPmlxmFBBilXdBKJgTDR8iZRZ8cw"},
{"content":{"body":" * thinking about this even more, I am tempted to say that automatic wrapping happens _only_ when you can't do it yourself, i.e. only for syntactic `yield` and `await` (and friends, like `using await`, of course) - in every other case (including manual calls to `.then`) you can just wrap the continuation yourself, and not have to worry about whether the scheduler you're using happens to do wrapping for you","format":"org.matrix.custom.html","formatted_body":" * thinking about this even more, I am tempted to say that automatic wrapping happens <em>only</em> when you can't do it yourself, i.e. only for syntactic <code>yield</code> and <code>await</code> (and friends, like <code>using await</code>, of course) - in every other case (including manual calls to <code>.then</code>) you can just wrap the continuation yourself, and not have to worry about whether the scheduler you're using happens to do wrapping for you","m.new_content":{"body":"thinking about this even more, I am tempted to say that automatic wrapping happens _only_ when you can't do it yourself, i.e. only for syntactic `yield` and `await` (and friends, like `using await`, of course) - in every other case (including manual calls to `.then`) you can just wrap the continuation yourself, and not have to worry about whether the scheduler you're using happens to do wrapping for you","format":"org.matrix.custom.html","formatted_body":"thinking about this even more, I am tempted to say that automatic wrapping happens <em>only</em> when you can't do it yourself, i.e. only for syntactic <code>yield</code> and <code>await</code> (and friends, like <code>using await</code>, of course) - in every other case (including manual calls to <code>.then</code>) you can just wrap the continuation yourself, and not have to worry about whether the scheduler you're using happens to do wrapping for you","msgtype":"m.text"},"m.relates_to":{"event_id":"$03zvHBeK02w7hboAqk2T32zF7sYut_T6ARq5ikkZrX4","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675266450249,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$fzlE9nv1XLNExSFNG_ajjsii5RdMSnOqadY1wstq6dc"},
{"content":{"body":"https://github.com/wintercg/proposal-common-minimum-api/blob/main/asynclocalstorage.md","msgtype":"m.text","org.matrix.msc1767.text":"https://github.com/wintercg/proposal-common-minimum-api/blob/main/asynclocalstorage.md"},"ts":1675266461502,"senderName":"Andreu Botella","senderId":"@abotella:igalia.com","id":"$m9RkpGQD7OpsxpdMZmxdVDHiGRFyRMMy1MZoa5EZ5xE"},
{"content":{"body":"> <@bakkot:matrix.org> thinking about this even more, I am tempted to say that automatic wrapping happens _only_ when you can't do it yourself, i.e. only for syntactic `yield` and `await` (and friends, like `using await`, of course) - in every other case (including manual calls to `.then`) you can just wrap the continuation yourself, and not have to worry about whether the scheduler you're using happens to do wrapping for you\n\nI mostly agree, with the exception of `.then`. The biggest problem with context passing and Promises is that you would need to potentially wrap _every_ `.then` callback in the event one of them throws. This is far more arduous than wrapping the single entrypoint of an event handler.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$03zvHBeK02w7hboAqk2T32zF7sYut_T6ARq5ikkZrX4?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@bakkot:matrix.org\">@bakkot:matrix.org</a><br>thinking about this even more, I am tempted to say that automatic wrapping happens <em>only</em> when you can't do it yourself, i.e. only for syntactic <code>yield</code> and <code>await</code> (and friends, like <code>using await</code>, of course) - in every other case (including manual calls to <code>.then</code>) you can just wrap the continuation yourself, and not have to worry about whether the scheduler you're using happens to do wrapping for you</blockquote></mx-reply>I mostly agree, with the exception of <code>.then</code>. The biggest problem with context passing and Promises is that you would need to potentially wrap <em>every</em> <code>.then</code> callback in the event one of them throws. This is far more arduous than wrapping the single entrypoint of an event handler.","m.relates_to":{"m.in_reply_to":{"event_id":"$03zvHBeK02w7hboAqk2T32zF7sYut_T6ARq5ikkZrX4"}},"msgtype":"m.text"},"ts":1675266516527,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$rDNwk0gqsCmgBJlfaJ4hM7HgepDE83kKMuGMpCC_7Dk"},
{"content":{"body":"If it works with `await`, it should work with `.then` on native `Promise` implementations.","format":"org.matrix.custom.html","formatted_body":"If it works with <code>await</code>, it should work with <code>.then</code> on native <code>Promise</code> implementations.","msgtype":"m.text"},"ts":1675266537168,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$UVrBTTNRCM4WHMrvKBb_X8Je7YWvGMGpLkFrx54znWo"},
{"content":{"body":"> <@rbuckton:matrix.org> I mostly agree, with the exception of `.then`. The biggest problem with context passing and Promises is that you would need to potentially wrap _every_ `.then` callback in the event one of them throws. This is far more arduous than wrapping the single entrypoint of an event handler.\n\nonly if you have a bunch of `.then` calls, which isn't so common, and even then if you factor out a helper to do the wrapping it seems not so arduous?","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$rDNwk0gqsCmgBJlfaJ4hM7HgepDE83kKMuGMpCC_7Dk?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@rbuckton:matrix.org\">@rbuckton:matrix.org</a><br>I mostly agree, with the exception of <code>.then</code>. The biggest problem with context passing and Promises is that you would need to potentially wrap <em>every</em> <code>.then</code> callback in the event one of them throws. This is far more arduous than wrapping the single entrypoint of an event handler.</blockquote></mx-reply>only if you have a bunch of <code>.then</code> calls, which isn't so common, and even then if you factor out a helper to do the wrapping it seems not so arduous?","m.relates_to":{"m.in_reply_to":{"event_id":"$rDNwk0gqsCmgBJlfaJ4hM7HgepDE83kKMuGMpCC_7Dk"}},"msgtype":"m.text"},"ts":1675266569337,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$ZLDpAyD3tJJ47C-TF7aZNpbtm1z1y2f6h3KtQ3W8OjU"},
{"content":{"body":"but I am maybe open to it; something to talk about more","msgtype":"m.text"},"ts":1675266582240,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$DAQR5hTTo4LCjfgZZsOw4NNaoif1ZytP0HnXl2qvsrs"},
{"content":{"body":"I disagree. If you are still using `.then` today when async/await exists, you are likely doing something far more complex than a single `.then` continuation.","format":"org.matrix.custom.html","formatted_body":"I disagree. If you are still using <code>.then</code> today when async/await exists, you are likely doing something far more complex than a single <code>.then</code> continuation.","msgtype":"m.text","m.relates_to":{"m.in_reply_to":{"event_id":"$ZLDpAyD3tJJ47C-TF7aZNpbtm1z1y2f6h3KtQ3W8OjU"}}},"ts":1675266611115,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$Da8RcwD2VsG96Ndcwg2KJHPT4nn6V8BLzXyxfr-rHGI"},
{"content":{"body":"tons of people do that with fetch - `await fetch(…).then(x => x.json())`","format":"org.matrix.custom.html","formatted_body":"tons of people do that with fetch - <code>await fetch(…).then(x =&gt; x.json())</code>","msgtype":"m.text"},"ts":1675266632286,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$tsc3lqIVLr75TlHTXeygruenH989DfL_-Br6wV-duyA"},
{"content":{"body":"it's pretty common","msgtype":"m.text"},"ts":1675266637222,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$LRC83z09clcbKpzhJNIY9NOjk4YVGY1pNNLwBLuZEM8"},
{"content":{"body":"> <@bakkot:matrix.org> only if you have a bunch of `.then` calls, which isn't so common, and even then if you factor out a helper to do the wrapping it seems not so arduous?\n\n * I disagree. If you are still using `.then` today when async/await exists, you are likely doing something far more complex than a single `.then` continuation.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$ZLDpAyD3tJJ47C-TF7aZNpbtm1z1y2f6h3KtQ3W8OjU?via=matrix.org&amp;via=igalia.com&amp;via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@bakkot:matrix.org\">@bakkot:matrix.org</a><br>only if you have a bunch of <code>.then</code> calls, which isn't so common, and even then if you factor out a helper to do the wrapping it seems not so arduous?</blockquote></mx-reply> * I disagree. If you are still using <code>.then</code> today when async/await exists, you are likely doing something far more complex than a single <code>.then</code> continuation.","m.new_content":{"body":"I disagree. If you are still using `.then` today when async/await exists, you are likely doing something far more complex than a single `.then` continuation.","format":"org.matrix.custom.html","formatted_body":"I disagree. If you are still using <code>.then</code> today when async/await exists, you are likely doing something far more complex than a single <code>.then</code> continuation.","msgtype":"m.text"},"m.relates_to":{"event_id":"$Da8RcwD2VsG96Ndcwg2KJHPT4nn6V8BLzXyxfr-rHGI","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675266637482,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$IWmeRHZju5Hp5zNkYvA9Zj39aS_pk8UFbPlHPNbM9Hc"},
{"content":{"body":"I am OK with the people doing the `fetch` thing having to refactor their code or do a manual wrap","format":"org.matrix.custom.html","formatted_body":"I am OK with the people doing the <code>fetch</code> thing having to refactor their code or do a manual wrap","msgtype":"m.text"},"ts":1675266661679,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$bv5GwQuzq9SaqKw1uPz1mqYjLanzKsai0ydF-CV5z_s"},
{"content":{"body":"but yes sometimes things get more complicated","msgtype":"m.text"},"ts":1675266668065,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$cXOk9RY_P-nPiI9ttpfgWaiuwEAnqA_VwQSKhJEDyGw"},
{"content":{"body":"i haven't been following, but it seems pretty important to preserve the sugar-ness of await over promises.","msgtype":"m.text"},"ts":1675266749183,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$5bIKcd30FOF2r23v8ncfCOcwseRvz1Yb4-Vx4uGx9GE"},
{"content":{"body":"my main concern with automatically wrapping in `.then` is, the rule \"you have to wrap any callback, whereas syntactic continuations get wrapped for you\" is much easier to learn than \"Promise.then automatically wraps, but [some other subset of schedulers] does not\"","format":"org.matrix.custom.html","formatted_body":"my main concern with automatically wrapping in <code>.then</code> is, the rule &quot;you have to wrap any callback, whereas syntactic continuations get wrapped for you&quot; is much easier to learn than &quot;Promise.then automatically wraps, but [some other subset of schedulers] does not&quot;","msgtype":"m.text"},"ts":1675266755577,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$8hcXVDU7Tkvap4x-RPnyZhq27iK_iPAR7jsMNROTQkk"},
{"content":{"body":"> <@ljharb:matrix.org> i haven't been following, but it seems pretty important to preserve the sugar-ness of await over promises.\n\nit's still preserved either way, the sugar just gets a little more complicated","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$5bIKcd30FOF2r23v8ncfCOcwseRvz1Yb4-Vx4uGx9GE?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@ljharb:matrix.org\">@ljharb:matrix.org</a><br>i haven&#39;t been following, but it seems pretty important to preserve the sugar-ness of await over promises.</blockquote></mx-reply>it's still preserved either way, the sugar just gets a little more complicated","m.relates_to":{"m.in_reply_to":{"event_id":"$5bIKcd30FOF2r23v8ncfCOcwseRvz1Yb4-Vx4uGx9GE"}},"msgtype":"m.text"},"ts":1675266785097,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$tXYItzXT93oaW8gdMpuvI3EBlwjA8e0SHdJxL8BZxjs"},
{"content":{"body":"in the `.json` case, it will probably be fine that it doesn't keep the context, unless `.json` has been patched","format":"org.matrix.custom.html","formatted_body":"in the <code>.json</code> case, it will probably be fine that it doesn't keep the context, unless <code>.json</code> has been patched","msgtype":"m.text"},"ts":1675266790890,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$XOZKbchrGXQ811OTrndmqAmH_HfdxXm0TqQkOGFyoAM"},
{"content":{"body":"oohh I think I like that WinterCG proposed API better","msgtype":"m.text"},"ts":1675266799802,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$SnVEgiJtduiMqaXgPuAjGiObc6zP2gIua3H9YwFXf0A"},
{"content":{"body":"that's fine as long as the non-await usage isn't made more complicated - altho i guess it might be in order to use the new functionality without the sugar, as is the case with `class`","format":"org.matrix.custom.html","formatted_body":"that's fine as long as the non-await usage isn't made more complicated - altho i guess it might be in order to use the new functionality without the sugar, as is the case with <code>class</code>","msgtype":"m.text"},"ts":1675266813066,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$mWKdQgdEIa-iH6CHeZgxWLnAzAhtBsAgC2OyzAHiPcg"},
{"content":{"body":"Can someone link to the YouTube playlist?","msgtype":"m.text"},"ts":1675266825857,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$Qq1SWaVdNwJrHo_ATDSuAK_lK5FEduHkxrzf-m-ETBM"},
{"content":{"body":"for the minutes","msgtype":"m.text"},"ts":1675266828831,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$bYkpjZrTZ-ZNA0aWerIThKBl4j1IJRY-S3JorQsPA9M"},
{"content":{"body":" * that's fine as long as the non-await usage isn't made more complicated - altho i guess it might be in order to use the new functionality without the sugar, as is the case with `class`","format":"org.matrix.custom.html","formatted_body":" * that's fine as long as the non-await usage isn't made more complicated - altho i guess it might be in order to use the new functionality without the sugar, as is the case with <code>class</code>","m.new_content":{"body":"that's fine as long as the non-await usage isn't made more complicated - altho i guess it might be in order to use the new functionality without the sugar, as is the case with `class`","format":"org.matrix.custom.html","formatted_body":"that's fine as long as the non-await usage isn't made more complicated - altho i guess it might be in order to use the new functionality without the sugar, as is the case with <code>class</code>","msgtype":"m.text"},"m.relates_to":{"event_id":"$mWKdQgdEIa-iH6CHeZgxWLnAzAhtBsAgC2OyzAHiPcg","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675266840310,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$EviEp6LVueu3VNaeHnyo7ERh950kQgbObYW1JYYXuBY"},
{"content":{"body":"It will also be difficult to explain why `await x; doSomethingWithContext()` would work, but `x.then(() => doSomethingWithContext())` wouldn't. Especially when many editors have refactorings for that, which now become potentially unsafe operations.","format":"org.matrix.custom.html","formatted_body":"It will also be difficult to explain why <code>await x; doSomethingWithContext()</code> would work, but <code>x.then(() =&gt; doSomethingWithContext())</code> wouldn't. Especially when many editors have refactorings for that, which now become potentially unsafe operations.","msgtype":"m.text"},"ts":1675266850109,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$3m-04bBrbsNraTfXNomYLWilm-mcwUIkjr-ZVXV3AIE"},
{"content":{"body":"> <@rbuckton:matrix.org> It will also be difficult to explain why `await x; doSomethingWithContext()` would work, but `x.then(() => doSomethingWithContext())` wouldn't. Especially when many editors have refactorings for that, which now become potentially unsafe operations.\n\nthat seems pretty straightforward to explain, for people using async contexts? \"if you pass a callback, you need to wrap it\" is not a hard rule to learn","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$3m-04bBrbsNraTfXNomYLWilm-mcwUIkjr-ZVXV3AIE?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@rbuckton:matrix.org\">@rbuckton:matrix.org</a><br>It will also be difficult to explain why <code>await x; doSomethingWithContext()</code> would work, but <code>x.then(() =&gt; doSomethingWithContext())</code> wouldn't. Especially when many editors have refactorings for that, which now become potentially unsafe operations.</blockquote></mx-reply>that seems pretty straightforward to explain, for people using async contexts? &quot;if you pass a callback, you need to wrap it&quot; is not a hard rule to learn","m.relates_to":{"m.in_reply_to":{"event_id":"$3m-04bBrbsNraTfXNomYLWilm-mcwUIkjr-ZVXV3AIE"}},"msgtype":"m.text"},"ts":1675266911405,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$0cpcTx9_ao5lhi8gsX9gkdGDK1a9r12NhTmULyz9Zd4"},
{"content":{"body":"and if you're _not_ using an async context in your own function body you don't need to learn anything","format":"org.matrix.custom.html","formatted_body":"and if you're <em>not</em> using an async context in your own function body you don't need to learn anything","msgtype":"m.text"},"ts":1675266931221,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$OJQN1oeYY1Cm_Qka0HxQRsaAAdk5MFjKbqURELNPVXA"},
{"content":{"body":"> <@littledan:matrix.org> Can someone link to the YouTube playlist?\n\ndone","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$Qq1SWaVdNwJrHo_ATDSuAK_lK5FEduHkxrzf-m-ETBM?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@littledan:matrix.org\">@littledan:matrix.org</a><br>Can someone link to the YouTube playlist?</blockquote></mx-reply>done","m.relates_to":{"m.in_reply_to":{"event_id":"$Qq1SWaVdNwJrHo_ATDSuAK_lK5FEduHkxrzf-m-ETBM"}},"msgtype":"m.text"},"ts":1675266950239,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$6icyBbEq-hxpKWxRhQ8RmtKaDuj3fWhqXE5cRxJ0tEk"},
{"content":{"body":"I appreciate the investigation into performance from v8 and the security review from SES. From our side, we see use cases for this but need to do a more thorough review. No outstanding concerns from us right now","msgtype":"m.text"},"ts":1675266979742,"senderName":"yulia","senderId":"@yulia:mozilla.org","id":"$pqP8TFY7baOcp_HpbiUXNBGHHG5nXwOlXTHzGgINkrw"},
{"content":{"body":"what is mark talking about?","msgtype":"m.text"},"ts":1675266986008,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$LdhA5WREqkcSZGGXxyeIRHhfMjDW8Yng1rcS0FhgELU"},
{"content":{"body":" * I appreciate the investigation into performance from v8 and the security review from SES. From our side, we see use cases for this but need to do a more thorough review. No outstanding concerns from us right now","m.new_content":{"body":"I appreciate the investigation into performance from v8 and the security review from SES. From our side, we see use cases for this but need to do a more thorough review. No outstanding concerns from us right now","msgtype":"m.text"},"m.relates_to":{"event_id":"$pqP8TFY7baOcp_HpbiUXNBGHHG5nXwOlXTHzGgINkrw","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675266993725,"senderName":"yulia","senderId":"@yulia:mozilla.org","id":"$idjDg1UnwmGcOyImZo6BosvrsghRf0moNYrCVXWr_UI"},
{"content":{"body":"is this the AsyncContext spec draft or 262?","msgtype":"m.text"},"ts":1675266996841,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$4BlOZY6PmT6jEQlPGujysad6Kw10dbwcGgbxR6uTGdI"},
{"content":{"body":"the other side of this, it will be difficult to explain why `x.then(doSomethingWithContext)` would work, but `setTimeout(doSomethingWithContext)` would not. so that implies `setTimeout` needs to automatically wrap as well. and then now you have the same problem but with `s/setTimeout/setEventListener/`, and so on","format":"org.matrix.custom.html","formatted_body":"the other side of this, it will be difficult to explain why <code>x.then(doSomethingWithContext)</code> would work, but <code>setTimeout(doSomethingWithContext)</code> would not. so that implies <code>setTimeout</code> needs to automatically wrap as well. and then now you have the same problem but with <code>s/setTimeout/setEventListener/</code>, and so on","msgtype":"m.text","m.relates_to":{"m.in_reply_to":{"event_id":"$3m-04bBrbsNraTfXNomYLWilm-mcwUIkjr-ZVXV3AIE"}}},"ts":1675267086185,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$gOcfmkNkoUuk2ABFEcvSORkXl-HkNKCXa0izFoux078"},
{"content":{"body":"This becomes one more thing to consider when wrapping code in an `AsyncContext`, especially if that code calls into a third-party package that might use `.then`.","format":"org.matrix.custom.html","formatted_body":"This becomes one more thing to consider when wrapping code in an <code>AsyncContext</code>, especially if that code calls into a third-party package that might use <code>.then</code>.","msgtype":"m.text"},"ts":1675267101707,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$U6DnnR8fLM_la0yR0yZDWNyE2p955WgEnL9lwyBUYK4"},
{"content":{"body":"> <@rbuckton:matrix.org> It will also be difficult to explain why `await x; doSomethingWithContext()` would work, but `x.then(() => doSomethingWithContext())` wouldn't. Especially when many editors have refactorings for that, which now become potentially unsafe operations.\n\n * the other side of this, it will be difficult to explain why `x.then(doSomethingWithContext)` would work, but `setTimeout(doSomethingWithContext)` would not. so that implies `setTimeout` needs to automatically wrap as well. and then now you have the same problem but with `s/setTimeout/setEventListener/`, and so on","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$3m-04bBrbsNraTfXNomYLWilm-mcwUIkjr-ZVXV3AIE?via=matrix.org&amp;via=igalia.com&amp;via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@rbuckton:matrix.org\">@rbuckton:matrix.org</a><br>It will also be difficult to explain why <code>await x; doSomethingWithContext()</code> would work, but <code>x.then(() =&gt; doSomethingWithContext())</code> wouldn't. Especially when many editors have refactorings for that, which now become potentially unsafe operations.</blockquote></mx-reply> * the other side of this, it will be difficult to explain why <code>x.then(doSomethingWithContext)</code> would work, but <code>setTimeout(doSomethingWithContext)</code> would not. so that implies <code>setTimeout</code> needs to automatically wrap as well. and then now you have the same problem but with <code>s/setTimeout/setEventListener/</code>, and so on","m.new_content":{"body":"the other side of this, it will be difficult to explain why `x.then(doSomethingWithContext)` would work, but `setTimeout(doSomethingWithContext)` would not. so that implies `setTimeout` needs to automatically wrap as well. and then now you have the same problem but with `s/setTimeout/setEventListener/`, and so on","format":"org.matrix.custom.html","formatted_body":"the other side of this, it will be difficult to explain why <code>x.then(doSomethingWithContext)</code> would work, but <code>setTimeout(doSomethingWithContext)</code> would not. so that implies <code>setTimeout</code> needs to automatically wrap as well. and then now you have the same problem but with <code>s/setTimeout/setEventListener/</code>, and so on","msgtype":"m.text"},"m.relates_to":{"event_id":"$gOcfmkNkoUuk2ABFEcvSORkXl-HkNKCXa0izFoux078","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675267102120,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$WEWtN-ebUPhO5Nevp8kjw04m6BLcvrZF0FURnmfEGtM"},
{"content":{"body":"since this is only stage 1, can we word the proposal (in its repo and the proposals list) in terms that don't lock us into any API decisions? something like \"hooks for associating state with async call stack frames\"?","msgtype":"m.text"},"ts":1675267130229,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$QidHEYBT63o77cRsTZftL3DOQ2QP45tdqcBGjq3XT4Q"},
{"content":{"body":"> <@bakkot:matrix.org> the other side of this, it will be difficult to explain why `x.then(doSomethingWithContext)` would work, but `setTimeout(doSomethingWithContext)` would not. so that implies `setTimeout` needs to automatically wrap as well. and then now you have the same problem but with `s/setTimeout/setEventListener/`, and so on\n\nIIRC, `setTimeout`, `setImmediate`, `process.nextTick` were discussed in the slides as other potential places to automatically flow state.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$gOcfmkNkoUuk2ABFEcvSORkXl-HkNKCXa0izFoux078?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@bakkot:matrix.org\">@bakkot:matrix.org</a><br>the other side of this, it will be difficult to explain why <code>x.then(doSomethingWithContext)</code> would work, but <code>setTimeout(doSomethingWithContext)</code> would not. so that implies <code>setTimeout</code> needs to automatically wrap as well. and then now you have the same problem but with <code>s/setTimeout/setEventListener/</code>, and so on</blockquote></mx-reply>IIRC, <code>setTimeout</code>, <code>setImmediate</code>, <code>process.nextTick</code> were discussed in the slides as other potential places to automatically flow state.","m.relates_to":{"m.in_reply_to":{"event_id":"$gOcfmkNkoUuk2ABFEcvSORkXl-HkNKCXa0izFoux078"}},"msgtype":"m.text"},"ts":1675267156195,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$lK2C9iHHtM6mvV0fHVkHyS6aXwJxtktMKB176GzDqAM"},
{"content":{"body":"> <@rbuckton:matrix.org> This becomes one more thing to consider when wrapping code in an `AsyncContext`, especially if that code calls into a third-party package that might use `.then`.\n\ndoes it? if you pass a callback to the library you need to wrap it. but you need to _anyway_ because the third-party package might schedule the callback to get called in some way _other than_ `.then`, like event listener dispatch or something.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$U6DnnR8fLM_la0yR0yZDWNyE2p955WgEnL9lwyBUYK4?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@rbuckton:matrix.org\">@rbuckton:matrix.org</a><br>This becomes one more thing to consider when wrapping code in an <code>AsyncContext</code>, especially if that code calls into a third-party package that might use <code>.then</code>.</blockquote></mx-reply>does it? if you pass a callback to the library you need to wrap it. but you need to <em>anyway</em> because the third-party package might schedule the callback to get called in some way <em>other than</em> <code>.then</code>, like event listener dispatch or something.","m.relates_to":{"m.in_reply_to":{"event_id":"$U6DnnR8fLM_la0yR0yZDWNyE2p955WgEnL9lwyBUYK4"}},"msgtype":"m.text"},"ts":1675267180924,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$TLB58YVdUP1EoUhZnH0PZn77aJHmUagZJKEIJL62QAs"},
{"content":{"body":"Justin Ridgewell: ^","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@jridgewell:matrix.org\">Justin Ridgewell</a>: ^","m.relates_to":{"event_id":"$QidHEYBT63o77cRsTZftL3DOQ2QP45tdqcBGjq3XT4Q","is_falling_back":true,"m.in_reply_to":{"event_id":"$QidHEYBT63o77cRsTZftL3DOQ2QP45tdqcBGjq3XT4Q"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675267186277,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$uWcoN-zAfSmL4ETmFbTLveGaPw20JOb463UvkfM2Qp0"},
{"content":{"body":"i.e., if you're passing a callback to another library, you need to wrap it anyway, because you can't trust that the library is going to do the scheduling using one of the automatically-wrapping APIs\n\n(or even schedule it at all - some libraries do deliberately invoke zalgo)","msgtype":"m.text"},"ts":1675267210589,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$Z5PIZ87cUSrnJp6WBeLl0keisw1zC7pRMrtm9wPLw3Y"},
{"content":{"body":"so making the rule \"you always need to wrap callbacks\" is much simpler","msgtype":"m.text"},"ts":1675267220942,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$qbyyX9XvUcg-d4DjckLoBDxOuP5KFGuxXYBlH7C8YtM"},
{"content":{"body":" * i.e., if you're passing a callback to another library, you need to wrap it anyway, because you can't trust that the library is going to do the scheduling using one of the automatically-wrapping APIs\n\n(or even schedule it at all - some libraries do deliberately invoke zalgo)","m.new_content":{"body":"i.e., if you're passing a callback to another library, you need to wrap it anyway, because you can't trust that the library is going to do the scheduling using one of the automatically-wrapping APIs\n\n(or even schedule it at all - some libraries do deliberately invoke zalgo)","msgtype":"m.text"},"m.relates_to":{"event_id":"$Z5PIZ87cUSrnJp6WBeLl0keisw1zC7pRMrtm9wPLw3Y","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675267243698,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$08ccaghl7e0v1UFMRpnFxAMuID8KfH9i4IDf9hvEZeA"},
{"content":{"body":"> <@bakkot:matrix.org> so making the rule \"you always need to wrap callbacks\" is much simpler\n\nI don't agree its simpler. Simpler is not having to wrap callbacks for things that are, categorically, async continuations. ","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$qbyyX9XvUcg-d4DjckLoBDxOuP5KFGuxXYBlH7C8YtM?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@bakkot:matrix.org\">@bakkot:matrix.org</a><br>so making the rule &quot;you always need to wrap callbacks&quot; is much simpler</blockquote></mx-reply>I don't agree its simpler. Simpler is not having to wrap callbacks for things that are, categorically, async continuations.","m.relates_to":{"m.in_reply_to":{"event_id":"$qbyyX9XvUcg-d4DjckLoBDxOuP5KFGuxXYBlH7C8YtM"}},"msgtype":"m.text"},"ts":1675267329733,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$fCjh-1bDUgHDw52We76hcnzjiHeTfVzg3ycj0lIVqDQ"},
{"content":{"body":"if you are passing a callback to another library, you don't know that it's categorically an async continuation.","msgtype":"m.text"},"ts":1675267378864,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$3JKcBeB-O2ApTiKLmWwH_oXZq-v4Brg7XXxV99eB8uk"},
{"content":{"body":"it's just a callback. whether it's an async continuation depends on how _that library_ consumes the callback.","format":"org.matrix.custom.html","formatted_body":"it's just a callback. whether it's an async continuation depends on how <em>that library</em> consumes the callback.","msgtype":"m.text"},"ts":1675267394706,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$1WfvE71RKhCLNf7b6QsOf_rlwr_BKXq7nd1fn4abX0Q"},
{"content":{"body":"so if you want to preserve the async context, you need to mark it as an async continuation, by wrapping it","msgtype":"m.text"},"ts":1675267427392,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$RaEGGfb3huYTli4n2NsW3NhhK74Ffh78YvTDkIUj6zM"},
{"content":{"body":"Simpler is knowing that `asyncIterable[Symbol.asyncIterator]().map(element => { /*has outer context*/ })` will work, but since there's no explicit `await`, how would I know? ","format":"org.matrix.custom.html","formatted_body":"Simpler is knowing that <code>asyncIterable[Symbol.asyncIterator]().map(element =&gt; { /*has outer context*/ })</code> will work, but since there's no explicit <code>await</code>, how would I know?","msgtype":"m.text"},"ts":1675267432125,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$HvTgBtvbNMcB_xM68n_bYEvGN6_bxJW2K1pr_ZGHqAc"},
{"content":{"body":"Regardless of whether `.then` automatically wraps, I could write a `Symbol.asyncIterator` implementation that does not in fact wrap the callback using the top-of-stack callback; that's up to the implementation of `Symbol.asyncIterator`.","format":"org.matrix.custom.html","formatted_body":"Regardless of whether <code>.then</code> automatically wraps, I could write a <code>Symbol.asyncIterator</code> implementation that does not in fact wrap the callback using the top-of-stack callback; that's up to the implementation of <code>Symbol.asyncIterator</code>.","msgtype":"m.text"},"ts":1675267561357,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$HozSrqjcdussgtYjfZHIQQr0JvOH8jIwwijj0JjHpRE"},
{"content":{"body":"I also think not supporting this in `.then` would make it far less useful to quite a few of the use cases this is intended to support.","format":"org.matrix.custom.html","formatted_body":"I also think not supporting this in <code>.then</code> would make it far less useful to quite a few of the use cases this is intended to support.","msgtype":"m.text"},"ts":1675267566294,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$VLUh1aO8KYTyR2MfvXw6gFskam3EBuBBqwiCL2e4mYU"},
{"content":{"body":"I'm pointing at the async iterator helpers proposal's built-in capabilities here.","msgtype":"m.text"},"ts":1675267601481,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$xz4oPDxtf37IvrJmpARVnXhEZwUsaR_42JD0fOCNvps"},
{"content":{"body":"Right, but my point is that the async iterable is something someone hands you, and you can't trust that it's only going to use the scheduling APIs you expect it to on the way to its ultimate call to `Promise.prototype.then`.","format":"org.matrix.custom.html","formatted_body":"Right, but my point is that the async iterable is something someone hands you, and you can't trust that it's only going to use the scheduling APIs you expect it to on the way to its ultimate call to <code>Promise.prototype.then</code>.","msgtype":"m.text"},"ts":1675267654508,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$3i2LDR5CYQT0E_iMYpPpbrXQi4bN47Y03wizuKf4LK0"},
{"content":{"body":"And the whole point of this API is that you shouldn't have to coordinate with other people's code about how they choose to schedule your callback. If you could coordinate, you could just have the other code thread the state through.","msgtype":"m.text"},"ts":1675267706594,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$ikmJVKt5PlfOlG6uA7ctaupD33O02LbsDB1o0TOC9BI"},
{"content":{"body":" * And the whole point of this API is that you shouldn't have to coordinate with other people's code about how they choose to schedule your callback. If you could coordinate, you could just have the other code thread the state through.","m.new_content":{"body":"And the whole point of this API is that you shouldn't have to coordinate with other people's code about how they choose to schedule your callback. If you could coordinate, you could just have the other code thread the state through.","msgtype":"m.text"},"m.relates_to":{"event_id":"$ikmJVKt5PlfOlG6uA7ctaupD33O02LbsDB1o0TOC9BI","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675267718418,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$M1bmtrkiOMLUivQ9Kht9SJ6jZTpsGTi_uMa_4_6_8I0"},
{"content":{"body":"There was some fascinating investigation into a sort of \"borrowing\" model for ArrayBuffers in https://gist.github.com/domenic/a9343fa787ba54b4ba3a60882c49cc32#file-readme-md","msgtype":"m.text"},"ts":1675267769972,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$B3m0bLlAhn78rcHzNnkahsapDY_SLE8BUr9o2lQgFZM"},
{"content":{"body":"Which is why I think we should not encourage you to write patterns which rely on other people's code using particular APIs to do scheduling.","msgtype":"m.text"},"ts":1675267782720,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$vF0rN1CMtGclJwZb6790aITZVbem40CIyLbAYCL4vkE"},
{"content":{"body":"i.e., we should not make some APIs do wrapping of callbacks automatically.","msgtype":"m.text"},"ts":1675267808236,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$6XdbYYLXNeN4EPBWd4qMiqQ3sLcfGXSJhVWpVDXzYCw"},
{"content":{"body":"This is a different primitive; it couldn't be implemented in `transfer`. It'd be better IMO. Anyway, done is better than perfect, we already had Stage 3 on this current thread","format":"org.matrix.custom.html","formatted_body":"This is a different primitive; it couldn't be implemented in <code>transfer</code>. It'd be better IMO. Anyway, done is better than perfect, we already had Stage 3 on this current thread","msgtype":"m.text"},"ts":1675267839628,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$5el4fUKUfMujQBxZNbzX5rWbRUpUhpGIgQ6h63SrKCM"},
{"content":{"body":"> <@bakkot:matrix.org> i.e., we should not make some APIs do wrapping of callbacks automatically.\n\nhuh, have you considered arguing this to the Node.js APM ecosystem?","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$6XdbYYLXNeN4EPBWd4qMiqQ3sLcfGXSJhVWpVDXzYCw?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@bakkot:matrix.org\">@bakkot:matrix.org</a><br>i.e., we should not make some APIs do wrapping of callbacks automatically.</blockquote></mx-reply>huh, have you considered arguing this to the Node.js APM ecosystem?","m.relates_to":{"m.in_reply_to":{"event_id":"$6XdbYYLXNeN4EPBWd4qMiqQ3sLcfGXSJhVWpVDXzYCw"}},"msgtype":"m.text"},"ts":1675267855337,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$doL5BqcMkmLspxcoHmgoRZd1vStRyGY1Xf2fKnkyB1k"},
{"content":{"body":"littledan: nope","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@littledan:matrix.org\">littledan</a>: nope","msgtype":"m.text"},"ts":1675267885482,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$Zh9lu6q2tk5iTaC4qEYS5_aiSQB7vqeJBipkiCVESk0"},
{"content":{"body":"well... I think the implicit wrapping is just a sort of requirement to make any of this work in practice.","msgtype":"m.text"},"ts":1675267903624,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$BpmNotx8yjWEcHPdpnsVQB4bXWQCNn79cxTJUY_pE2g"},
{"content":{"body":"It's still stated as possible solution in the readme.","m.relates_to":{"event_id":"$QidHEYBT63o77cRsTZftL3DOQ2QP45tdqcBGjq3XT4Q","is_falling_back":true,"m.in_reply_to":{"event_id":"$uWcoN-zAfSmL4ETmFbTLveGaPw20JOb463UvkfM2Qp0"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675267911182,"senderName":"Chengzhong Wu","senderId":"@legendecas:matrix.org","id":"$yYO8UEg5nNGn74hplN3_8VkzdbBcUuiQOeamEJobjxs"},
{"content":{"body":"implicit wrapping of syntactic `await`/`yield` continuations, absolutely","format":"org.matrix.custom.html","formatted_body":"implicit wrapping of syntactic <code>await</code>/<code>yield</code> continuations, absolutely","msgtype":"m.text"},"ts":1675267923721,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$IjfugN3N-L1V1xcDgRshzyHkmXHlzHGIexkEuOyFv4M"},
{"content":{"body":"implicit wrapping of explicit callbacks, I don't see it. you can wrap those yourself.","msgtype":"m.text"},"ts":1675267938031,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$qbQPd_5IcsdN3Yvqv8HZKgjFz6b4DiLMTHQgFeMbwyM"},
{"content":{"body":"I think it'd be worth looking at existing use cases to see whether your suggestion would be viable...","msgtype":"m.text"},"ts":1675268011103,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$YfgoLFDAojKO1-dCYlJP4NvFxurDhVEBM4YXRoS7DhU"},
{"content":{"body":"indeed you _have to_ wrap those yourself if the callback is going to thread through someone else's code, because you can't trust that they're going to do the scheduling using one of those automatically wrapping APIs ","format":"org.matrix.custom.html","formatted_body":"indeed you <em>have to</em> wrap those yourself if the callback is going to thread through someone else's code, because you can't trust that they're going to do the scheduling using one of those automatically wrapping APIs","msgtype":"m.text"},"ts":1675268017094,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$sF_t07EhmRGDzVG8rOZKXAq_7yweqv4LFCFDyeJ-uSo"},
{"content":{"body":"I mean, cases, where this is already deployed","msgtype":"m.text"},"ts":1675268025320,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$XQIhJCbGgk6aVvUjIFs4ZdV98sYuOiEdhSdOHYIztyE"},
{"content":{"body":"`yield` is something we'll need to discuss: https://github.com/legendecas/proposal-async-context/issues/18","format":"org.matrix.custom.html","formatted_body":"<code>yield</code> is something we'll need to discuss: https://github.com/legendecas/proposal-async-context/issues/18","msgtype":"m.text"},"ts":1675268040920,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$gEDg7tVuvdD8MBBjdilHacogW6dT9v-yzWh0_gaFKmA"},
{"content":{"body":"For `await` and `Promise.p.then`, I think we have to do them automatically","format":"org.matrix.custom.html","formatted_body":"For <code>await</code> and <code>Promise.p.then</code>, I think we have to do them automatically","msgtype":"m.text"},"ts":1675268064784,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$V07kPgsuMyYx6OYVA0VxEM9oWQi0lqXfn2Ojju_Cte0"},
{"content":{"body":"`await` should just be a sytnax on top of promises","format":"org.matrix.custom.html","formatted_body":"<code>await</code> should just be a sytnax on top of promises","msgtype":"m.text"},"ts":1675268076192,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$Xx_Ab3h9O9g7oSLNwil97L9ER_NFFoKjtrJBWzvZVrU"},
{"content":{"body":"(And also if you force me to take away the fast path for `await promise` because I have to patch `.then`, I will riot)","format":"org.matrix.custom.html","formatted_body":"(And also if you force me to take away the fast path for <code>await promise</code> because I have to patch <code>.then</code>, I will riot)","msgtype":"m.text"},"ts":1675268096745,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$lMqhnmcf_lM38lTNMmceE6zPfiwgzW5EFGSna_zi6HY"},
{"content":{"body":"I think bakkot's arguments would need to be made to host environments, since we just don't own much of what would need to make these decisions","msgtype":"m.text"},"ts":1675268097310,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$ooHSVzJdNTo_F_Ojday7bilETgyWyo4W5n_UWFk-SR4"},
{"content":{"body":"> <@jridgewell:matrix.org> (And also if you force me to take away the fast path for `await promise` because I have to patch `.then`, I will riot)\n\nMy point is that you don't have to patch `.then`","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$lMqhnmcf_lM38lTNMmceE6zPfiwgzW5EFGSna_zi6HY?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@jridgewell:matrix.org\">@jridgewell:matrix.org</a><br>(And also if you force me to take away the fast path for <code>await promise</code> because I have to patch <code>.then</code>, I will riot)</blockquote></mx-reply>My point is that you don't have to patch <code>.then</code>","m.relates_to":{"m.in_reply_to":{"event_id":"$lMqhnmcf_lM38lTNMmceE6zPfiwgzW5EFGSna_zi6HY"}},"msgtype":"m.text"},"ts":1675268113085,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$rrEu4aQy19xvb7OdIni-Jq8I7O4cX15KYyR8-mNB1pM"},
{"content":{"body":"As the platform, I do","msgtype":"m.text"},"ts":1675268121158,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$kxR2e-kx5KfZKmKnPHmG8khbrDXXi6T7fCxvyAAsQzU"},
{"content":{"body":"... why?","msgtype":"m.text"},"ts":1675268125356,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$sksYD_aa8xq-EMvTITmtF-6iXERwn_ta3O-ZqZ3oxD0"},
{"content":{"body":"Assuming there's implicit wrapping in syntactic `await`s","format":"org.matrix.custom.html","formatted_body":"Assuming there's implicit wrapping in syntactic <code>await</code>s","msgtype":"m.text"},"ts":1675268135399,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$7_5MsvyMOQzHg5aLtyOZM2EjF7gxScpyHuHK2jQTzWo"},
{"content":{"body":"The whole `console.log` use case in the slides","format":"org.matrix.custom.html","formatted_body":"The whole <code>console.log</code> use case in the slides","msgtype":"m.text"},"ts":1675268141328,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$d6TxpNUqASwLjKrsv2P8Y2xf-FEgEYgi-bigiqg-ChA"},
{"content":{"body":"> <@bakkot:matrix.org> Assuming there's implicit wrapping in syntactic `await`s\n\nsure, I agree, in theory we could fork the semantics here","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$7_5MsvyMOQzHg5aLtyOZM2EjF7gxScpyHuHK2jQTzWo?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@bakkot:matrix.org\">@bakkot:matrix.org</a><br>Assuming there's implicit wrapping in syntactic <code>await</code>s</blockquote></mx-reply>sure, I agree, in theory we could fork the semantics here","m.relates_to":{"m.in_reply_to":{"event_id":"$7_5MsvyMOQzHg5aLtyOZM2EjF7gxScpyHuHK2jQTzWo"}},"msgtype":"m.text"},"ts":1675268153521,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$bQR2lCaPQf-WjupMYpFCFVEZUhUz2TrFAyDuVDNsNpo"},
{"content":{"body":"I have to preserve across any promise usage, because anything else will break an important API for us","msgtype":"m.text"},"ts":1675268157209,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$Rr96DY-ZR55QeQTSn1unxkPhNBbAWcDc_XbUReNYc9E"},
{"content":{"body":"what I don't understand is the motivation","msgtype":"m.text"},"ts":1675268160200,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$HTO2slKnWcQuoe0-Ez6ZGJXsN5ov2kRLRwfpE6DOgeg"},
{"content":{"body":"> <@jridgewell:matrix.org> I have to preserve across any promise usage, because anything else will break an important API for us\n\nI think bakkot is saying, you could go patch that","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$Rr96DY-ZR55QeQTSn1unxkPhNBbAWcDc_XbUReNYc9E?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@jridgewell:matrix.org\">@jridgewell:matrix.org</a><br>I have to preserve across any promise usage, because anything else will break an important API for us</blockquote></mx-reply>I think bakkot is saying, you could go patch that","m.relates_to":{"m.in_reply_to":{"event_id":"$Rr96DY-ZR55QeQTSn1unxkPhNBbAWcDc_XbUReNYc9E"}},"msgtype":"m.text"},"ts":1675268171191,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$GUgcZj3SSOjdt4yk-biZmeISWY2eT7dskdytXNy6kXE"},
{"content":{"body":"> <@jridgewell:matrix.org> I have to preserve across any promise usage, because anything else will break an important API for us\n\nCan you give an example?","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$Rr96DY-ZR55QeQTSn1unxkPhNBbAWcDc_XbUReNYc9E?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@jridgewell:matrix.org\">@jridgewell:matrix.org</a><br>I have to preserve across any promise usage, because anything else will break an important API for us</blockquote></mx-reply>Can you give an example?","m.relates_to":{"m.in_reply_to":{"event_id":"$Rr96DY-ZR55QeQTSn1unxkPhNBbAWcDc_XbUReNYc9E"}},"msgtype":"m.text"},"ts":1675268181772,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$6FlFK6j48SRO3_EkPv-W2VU3FoA84LDv5Mt4XSRHYRA"},
{"content":{"body":"I think he's saying I don't","msgtype":"m.text"},"ts":1675268182701,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$P-_yJKvgKfE6-bMI3MwgehV-SZuGb0etXEU2QxtxzAQ"},
{"content":{"body":"by \"you\" I mean, either the program or the Vercel environment","msgtype":"m.text"},"ts":1675268210539,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$cgVRm9LNwtL4t7ArJHgf6SEmEMGeyfr2DRMt5FQ1hg4"},
{"content":{"body":"Vercel's platform","msgtype":"m.text"},"ts":1675268222163,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$e04FknQjUfGckbrZMQU7TxfLTp4GgYDf119OPYLjGlE"},
{"content":{"body":"https://docs.google.com/presentation/d/1yw4d0ca6v2Z2Vmrnac9E9XJFlC872LDQ4GFR17QdRzk/edit#slide=id.g18e6eaa50e1_0_164","msgtype":"m.text"},"ts":1675268225003,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$nwfNz5AJdm0sOORfs64CQ_UV6WNsgF_37TY9nZ5zUc0"},
{"content":{"body":"I have to preserve this start time across any user code  per request","msgtype":"m.text"},"ts":1675268236275,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$aCYAozW9WZJCtFT4oi5CvFVUXite1JAchw7BAhJZmMo"},
{"content":{"body":"Let's slow down; I think you're talking past each other","msgtype":"m.text"},"ts":1675268244840,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$-V3WCJJaKRtzD3liP_5-STxqIXRowfCjkvvHnQWhACg"},
{"content":{"body":"It doesn't matter if they use `setTimeout`, `p.then()`, or `await`, it's all got to work","format":"org.matrix.custom.html","formatted_body":"It doesn't matter if they use <code>setTimeout</code>, <code>p.then()</code>, or <code>await</code>, it's all got to work","msgtype":"m.text"},"ts":1675268254497,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$WYsTlJbumNqPmEj--qEMKF4xJU_PTGTalqNifD0yWsg"},
{"content":{"body":"Justin Ridgewell: right, and that would still work?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@jridgewell:matrix.org\">Justin Ridgewell</a>: right, and that would still work?","msgtype":"m.text"},"ts":1675268295123,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$cBQ_pxei2bTE93cRq8YVwguiA8mS4mrmlm96MdeBX7k"},
{"content":{"body":"I am confused","msgtype":"m.text"},"ts":1675268296522,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$V4BuGR8GEahhRSBrCyMSCyGOudPpTpbb4hYRPqfnomI"},
{"content":{"body":"You need to wrap your handlers before you hand them to other people","msgtype":"m.text"},"ts":1675268315447,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$rokIkwnzf3CyqH-NxbibWQroEd4AFwmhZBb1usSGp9E"},
{"content":{"body":"How? If I force my users to wrap their `p.then()` callbacks, then it's not seamlessly working","format":"org.matrix.custom.html","formatted_body":"How? If I force my users to wrap their <code>p.then()</code> callbacks, then it's not seamlessly working","msgtype":"m.text"},"ts":1675268327504,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$ID587_z8eqFpxC0qGDO2OXSvIMzWsiTsxa60gBkh1tw"},
{"content":{"body":"and as long as you do that, the handlers run in your context, regardless of how other people are scheduling them to run","msgtype":"m.text"},"ts":1675268329410,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$-MfE10sgobekkkFaMbms84I-14sWQlEtiATac_xdnUM"},
{"content":{"body":" * and as long as you do that, the handlers run in your context, regardless of how other people are scheduling them to run","m.new_content":{"body":"and as long as you do that, the handlers run in your context, regardless of how other people are scheduling them to run","msgtype":"m.text"},"m.relates_to":{"event_id":"$-MfE10sgobekkkFaMbms84I-14sWQlEtiATac_xdnUM","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675268341501,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$F8Xje_Lz1_aalNtR4yMHRDbXXqgcQA5BtX5eBvrV_O4"},
{"content":{"body":"`console.log` isn't a callback I pass around, it exists in the global scope","format":"org.matrix.custom.html","formatted_body":"<code>console.log</code> isn't a callback I pass around, it exists in the global scope","msgtype":"m.text"},"ts":1675268358570,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$Z0a__y20c4CbxnQ023oA-XM_FTHR7d_rUTFnsgEXHQ0"},
{"content":{"body":"I can't wrap it per requests, because the global value will change per request","msgtype":"m.text"},"ts":1675268397983,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$cr1hBrDRWgnuK9vMO_LV2PnPHz8x7oBgZKiPQPc-uAE"},
{"content":{"body":"They don't store an access to the current value, they just access the property on the shared `console` object","format":"org.matrix.custom.html","formatted_body":"They don't store an access to the current value, they just access the property on the shared <code>console</code> object","msgtype":"m.text"},"ts":1675268416708,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$vAziX_77y2teAPo7fsiR4XkjDWunShU3YaptEG_F6wo"},
{"content":{"body":"> <@bakkot:matrix.org> You need to wrap your handlers before you hand them to other people\n\nIf you automatically associate context for .then, you are saving users a significant amount of complexity and boilerplate. If you are calling into questionable code, the presence of automatic context copying doesn't prevent you from manually wrapping the callback yourself. ","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$rokIkwnzf3CyqH-NxbibWQroEd4AFwmhZBb1usSGp9E?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@bakkot:matrix.org\">@bakkot:matrix.org</a><br>You need to wrap your handlers before you hand them to other people</blockquote></mx-reply>If you automatically associate context for .then, you are saving users a significant amount of complexity and boilerplate. If you are calling into questionable code, the presence of automatic context copying doesn't prevent you from manually wrapping the callback yourself.","m.relates_to":{"m.in_reply_to":{"event_id":"$rokIkwnzf3CyqH-NxbibWQroEd4AFwmhZBb1usSGp9E"}},"msgtype":"m.text"},"ts":1675268418187,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$rFc2pcv05XifG1PlYrLo1pO3A_-uW7lc44ClvYJGzVs"},
{"content":{"body":" * I can't wrap it per requests, because the global value would change per request","m.new_content":{"body":"I can't wrap it per requests, because the global value would change per request","msgtype":"m.text"},"m.relates_to":{"event_id":"$cr1hBrDRWgnuK9vMO_LV2PnPHz8x7oBgZKiPQPc-uAE","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675268463761,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$YtuJFGr24hHYLCsZhF0EapY0ztgMwY5lyt3RqbDOFE0"},
{"content":{"body":"Justin Ridgewell: oh, sorry, I missed that it is crucial to this example that you are patching global state and expecting that to be respected. I am not convinced that's something worth designing for.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@jridgewell:matrix.org\">Justin Ridgewell</a>: oh, sorry, I missed that it is crucial to this example that you are patching global state and expecting that to be respected. I am not convinced that's something worth designing for.","msgtype":"m.text"},"ts":1675268472565,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$VPGN5ecbIiyVLgTeTst4uuZYY_OnzymIngzo4AyAy_4"},
{"content":{"body":"> <@rbuckton:matrix.org> If you automatically associate context for .then, you are saving users a significant amount of complexity and boilerplate. If you are calling into questionable code, the presence of automatic context copying doesn't prevent you from manually wrapping the callback yourself.\n\n\"calling into questionable code\" meaning calling into... any code?","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$rFc2pcv05XifG1PlYrLo1pO3A_-uW7lc44ClvYJGzVs?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@rbuckton:matrix.org\">@rbuckton:matrix.org</a><br>If you automatically associate context for .then, you are saving users a significant amount of complexity and boilerplate. If you are calling into questionable code, the presence of automatic context copying doesn't prevent you from manually wrapping the callback yourself.</blockquote></mx-reply>&quot;calling into questionable code&quot; meaning calling into... any code?","m.relates_to":{"m.in_reply_to":{"event_id":"$rFc2pcv05XifG1PlYrLo1pO3A_-uW7lc44ClvYJGzVs"}},"msgtype":"m.text"},"ts":1675268514539,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$m5wsaipdgtHIiwZhh6jYg4UnQMc_WMQPN9n9CIZ_HAo"},
{"content":{"body":"if you aren't calling into other people's code, you don't need async contexts at all. and if you are, you need to wrap. I don't see how any work is saved here.","msgtype":"m.text"},"ts":1675268575236,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$FH8ZKfH2W63_3HURHyccpD9-fsXPRz5Z4KnZgEz4y-U"},
{"content":{"body":"Other use cases are distributed trace, where request handlers are, eventually, resolved by combing other requests.  That's not 'global state' like `console.log`, but still a global singleton to make a request","format":"org.matrix.custom.html","formatted_body":"Other use cases are distributed trace, where request handlers are, eventually, resolved by combing other requests.  That's not 'global state' like <code>console.log</code>, but still a global singleton to make a request","msgtype":"m.text"},"ts":1675268620487,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$5RlAKoSJP1FFx-HVdKmbaFjrj5bfQS2rfNguxpWpjII"},
{"content":{"body":"> I am not convinced that's something worth designing for.\n\nThis would be a significant change from the way Node works, and would be a huge burden","format":"org.matrix.custom.html","formatted_body":"<blockquote>\n<p>I am not convinced that's something worth designing for.</p>\n</blockquote>\n<p>This would be a significant change from the way Node works, and would be a huge burden</p>\n","msgtype":"m.text"},"ts":1675268652911,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$d289LwHPB1y2SavIvZRwO3ZgxNou3CIVKNOlXPcDOLM"},
{"content":{"body":"And it's also going to force me out of my promise fast path","msgtype":"m.text"},"ts":1675268662409,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$CFg0JEhSkBSwOobREaNHAb5BrrwQmzB5-3dQHjWFTSk"},
{"content":{"body":"My two proposals won't play nice with each other","msgtype":"m.text"},"ts":1675268676257,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$46I__5jIv2oleVan-fNqVXHc8dXyjW01Aw1J7x_pwmg"},
{"content":{"body":"> <@jridgewell:matrix.org> I can't wrap it per requests, because the global value would change per request\n\nhm, also, I'm confused about this example. assuming that `addEventListener` doesn't automatically wrap callbacks passed to it, how does this work if the dev code, instead of using `await`, had added an event listener which would do the `console.log` at some later time?","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$cr1hBrDRWgnuK9vMO_LV2PnPHz8x7oBgZKiPQPc-uAE?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@jridgewell:matrix.org\">@jridgewell:matrix.org</a><br>I can&#39;t wrap it per requests, because the global value would change per request</blockquote></mx-reply>hm, also, I'm confused about this example. assuming that <code>addEventListener</code> doesn't automatically wrap callbacks passed to it, how does this work if the dev code, instead of using <code>await</code>, had added an event listener which would do the <code>console.log</code> at some later time?","m.relates_to":{"m.in_reply_to":{"event_id":"$cr1hBrDRWgnuK9vMO_LV2PnPHz8x7oBgZKiPQPc-uAE"}},"msgtype":"m.text"},"ts":1675268681909,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$pDeUCgKg3jpvnsQnt4l36nUYhdVVObmv3IEJlJclv1U"},
{"content":{"body":"I think `transferAndFixLength is better than `transferToFixedLength`","format":"org.matrix.custom.html","formatted_body":"I think <code>transferAndFixLength is better than </code>transferToFixedLength`","msgtype":"m.text"},"ts":1675268696354,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$StGNnFEoBCWRipT5r5-gFS11YN86nyMs7VabWzmjBoM"},
{"content":{"body":"I think it has to work for promises","msgtype":"m.text"},"ts":1675268698795,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$aS6PPP3ZUOqZ58l-KxTcypzSXkzI3WBeUc7SQ0TKtxI"},
{"content":{"body":" * I think `transferAndFixLength` is better than `transferToFixedLength`","format":"org.matrix.custom.html","formatted_body":" * I think <code>transferAndFixLength</code> is better than <code>transferToFixedLength</code>","m.new_content":{"body":"I think `transferAndFixLength` is better than `transferToFixedLength`","format":"org.matrix.custom.html","formatted_body":"I think <code>transferAndFixLength</code> is better than <code>transferToFixedLength</code>","msgtype":"m.text"},"m.relates_to":{"event_id":"$StGNnFEoBCWRipT5r5-gFS11YN86nyMs7VabWzmjBoM","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675268708934,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$gsA_WXHcsApRYFSJwP8brVV1O_8IHHeYui7rpnNyB2Y"},
{"content":{"body":"> <@michaelficarra:matrix.org> I think `transferAndFixLength` is better than `transferToFixedLength`\n\n\"fix\" as a verb there is pretty overloaded","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$StGNnFEoBCWRipT5r5-gFS11YN86nyMs7VabWzmjBoM?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@michaelficarra:matrix.org\">@michaelficarra:matrix.org</a><br>I think <code>transferAndFixLength</code> is better than <code>transferToFixedLength</code></blockquote></mx-reply>&quot;fix&quot; as a verb there is pretty overloaded","m.relates_to":{"is_falling_back":false,"m.in_reply_to":{"event_id":"$StGNnFEoBCWRipT5r5-gFS11YN86nyMs7VabWzmjBoM"}},"msgtype":"m.text"},"ts":1675268733523,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$ETV_e6BaddaByYKWLQzKeozZW14JtFJg2gqGdmvnWao"},
{"content":{"body":"> <@bakkot:matrix.org> \"calling into questionable code\" meaning calling into... any code?\n\nI don't believe people should or do compose code in a perfectly defensive way all the time","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$m5wsaipdgtHIiwZhh6jYg4UnQMc_WMQPN9n9CIZ_HAo?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@bakkot:matrix.org\">@bakkot:matrix.org</a><br>\"calling into questionable code\" meaning calling into... any code?</blockquote></mx-reply>I don't believe people should or do compose code in a perfectly defensive way all the time","m.relates_to":{"m.in_reply_to":{"event_id":"$m5wsaipdgtHIiwZhh6jYg4UnQMc_WMQPN9n9CIZ_HAo"}},"msgtype":"m.text"},"ts":1675268738143,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$U7pQGuGRYdl_nLhjAoG48xGXV_g1yS7qdMtmvPA_cEU"},
{"content":{"body":"Devs cannot escape our context on our platform, so any future point in which they would trigger an event listener would already have restored the request context","msgtype":"m.text"},"ts":1675268757670,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$cctkBUl9btOL_jpnvzdpQJVKn6nR0M7M9L3cljEFmXw"},
{"content":{"body":"the same overload as `Fixed`, no?","format":"org.matrix.custom.html","formatted_body":"the same overload as <code>Fixed</code>, no?","m.relates_to":{"event_id":"$ETV_e6BaddaByYKWLQzKeozZW14JtFJg2gqGdmvnWao","is_falling_back":true,"m.in_reply_to":{"event_id":"$ETV_e6BaddaByYKWLQzKeozZW14JtFJg2gqGdmvnWao"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675268768102,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$Pp1IYrlcyZEUMN_0g-uPJuYAEVsGvoFkknnivXg09ps"},
{"content":{"body":"littledan: while true, I also believe that a refactoring from scheduling with promises to scheduling with some other mechanism should be transparent to consumers of your code.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@littledan:matrix.org\">littledan</a>: while true, I also believe that a refactoring from scheduling with promises to scheduling with some other mechanism should be transparent to consumers of your code.","msgtype":"m.text"},"ts":1675268773068,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$_SRR_Alw5oBVDUYvJfOWmKtMc68hWam29LBBWMOHsv4"},
{"content":{"body":"yeah, Bloomberg's use case also has requirements that we strictly not allow \"escape\".","msgtype":"m.text"},"ts":1675268785086,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$kS1Ms17UDJsRy29_zGb0YUh-n7YzBsVY-azukpe99Ek"},
{"content":{"body":"that is, we should not design the language such that such a refactoring is by-default not transparent.","msgtype":"m.text"},"ts":1675268788963,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$jCrHI-n6qIGriA71HMFluGcd8hTZTInvfHVUV6B9C9M"},
{"content":{"body":"In APMs OTOH, they would simply not work if everyone had to update all of their code... they are just based around implicit wrapping","msgtype":"m.text"},"ts":1675268810157,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$ro2y3W1wDD_NT1YR7NArsoDOTX2MSnjz-kNkluO83K4"},
{"content":{"body":"like, this was proven out historically, leading to its development","msgtype":"m.text"},"ts":1675268823792,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$m28IBkJFAkGVVBNsegcyW-OqSPLSE1Gmfpe5ZSdUi70"},
{"content":{"body":"APMs have used decorators in the past to get around that though","msgtype":"m.text","org.matrix.msc1767.text":"APMs have used decorators in the past to get around that though"},"ts":1675268859924,"senderName":"ryzokuken","senderId":"@usharma:igalia.com","id":"$Qp_kg-vhPCd0PHpEpGmV11UZIbTajcOBLwBOxOSvHx0"},
{"content":{"body":"shu: please try to give a little more time between a name change and a stage 3 advancement next time; we may have been able to come up with a better name if we had more time","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@shuyuguo:matrix.org\">shu</a>: please try to give a little more time between a name change and a stage 3 advancement next time; we may have been able to come up with a better name if we had more time","msgtype":"m.text"},"ts":1675268887995,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$DFA-HRjb1k1LmkPsMzGQTXr-UkqxPie21r-UW3yMnKE"},
{"content":{"body":"well, although that'd still need changes","msgtype":"m.text","org.matrix.msc1767.text":"well, although that'd still need changes"},"ts":1675268888511,"senderName":"ryzokuken","senderId":"@usharma:igalia.com","id":"$UDdn8WlNSjjTEqJ7p_NyiqvT6DvBpkdbI3M_mEp4twA"},
{"content":{"body":"> <@jridgewell:matrix.org> Devs cannot escape our context on our platform, so any future point in which they would trigger an event listener would already have restored the request context\n\nIf you hand your callback to someone else, and there is literally no way they could schedule the callback to run with a different context than the one which existed when you handed the callback to them, I am also fine with that ","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$cctkBUl9btOL_jpnvzdpQJVKn6nR0M7M9L3cljEFmXw?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@jridgewell:matrix.org\">@jridgewell:matrix.org</a><br>Devs cannot escape our context on our platform, so any future point in which they would trigger an event listener would already have restored the request context</blockquote></mx-reply>If you hand your callback to someone else, and there is literally no way they could schedule the callback to run with a different context than the one which existed when you handed the callback to them, I am also fine with that","m.relates_to":{"m.in_reply_to":{"event_id":"$cctkBUl9btOL_jpnvzdpQJVKn6nR0M7M9L3cljEFmXw"}},"msgtype":"m.text"},"ts":1675268889495,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$KDbQHAFZdki0tDhGsZjw3yW67Nf7TT9F9aGQ_Br7q78"},
{"content":{"body":"> <@michaelficarra:matrix.org> shu: please try to give a little more time between a name change and a stage 3 advancement next time; we may have been able to come up with a better name if we had more time\n\nWhy didn't you put yourself on the queue?","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$DFA-HRjb1k1LmkPsMzGQTXr-UkqxPie21r-UW3yMnKE?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@michaelficarra:matrix.org\">@michaelficarra:matrix.org</a><br><a href=\"https://matrix.to/#/@shuyuguo:matrix.org\">shu</a>: please try to give a little more time between a name change and a stage 3 advancement next time; we may have been able to come up with a better name if we had more time</blockquote></mx-reply>Why didn't you put yourself on the queue?","m.relates_to":{"m.in_reply_to":{"event_id":"$DFA-HRjb1k1LmkPsMzGQTXr-UkqxPie21r-UW3yMnKE"}},"msgtype":"m.text"},"ts":1675268916456,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$EH9c8Qq1k-bIzLalSCwmg6YhmXRtmL10Z-NkVbiBB5w"},
{"content":{"body":"but that does lock us into, _every_ way of scheduling a task in the host must automatically wrap the callback passed to that context","format":"org.matrix.custom.html","formatted_body":"but that does lock us into, <em>every</em> way of scheduling a task in the host must automatically wrap the callback passed to that context","msgtype":"m.text"},"ts":1675268920214,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$eyZVajIi_4qynGYzWVgUoMwmn7u4hZOeS4hsR0Z6iiw"},
{"content":{"body":"Michael Ficarra: technically there wasn't a name change","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@michaelficarra:matrix.org\">Michael Ficarra</a>: technically there wasn't a name change","msgtype":"m.text"},"ts":1675268920881,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$vIED-32HiSoMY3z9_3wCHAeG3-E6oYiPHbM4oqFIoAA"},
{"content":{"body":"littledan: because it didn't matter enough","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@littledan:matrix.org\">littledan</a>: because it didn't matter enough","msgtype":"m.text"},"ts":1675268926499,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$Ucu_TuGOXe9ejH60nyuLnUtsgPmik2wLzW2IHoXzN4Q"},
{"content":{"body":"eventListener, unhandled promise handler, everything","msgtype":"m.text"},"ts":1675268932656,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$_7ny7dF5ojP86dlwx0yBdqGJv8EDs_udz7WS9Rc1Mfc"},
{"content":{"body":"you can AsyncContext.wrap the callback in such case","format":"org.matrix.custom.html","formatted_body":"you can AsyncContext.wrap the callback in such case","msgtype":"m.text","m.relates_to":{"m.in_reply_to":{"event_id":"$KDbQHAFZdki0tDhGsZjw3yW67Nf7TT9F9aGQ_Br7q78"}}},"ts":1675268952449,"senderName":"Chengzhong Wu","senderId":"@legendecas:matrix.org","id":"$KEIs5lfIc_h2DJqPF2RlgoqzdASekWfWbUN07thtBNE"},
{"content":{"body":"Chengzhong Wu: well, that's my argument","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@legendecas:matrix.org\">Chengzhong Wu</a>: well, that's my argument","msgtype":"m.text"},"ts":1675268961779,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$7atvs12QbjMjCq6YTkK2xGJNXUPEv66x6TIwGxo22cU"},
{"content":{"body":"> <@bakkot:matrix.org> If you hand your callback to someone else, and there is literally no way they could schedule the callback to run with a different context than the one which existed when you handed the callback to them, I am also fine with that\n\n * you can AsyncContext.wrap the callback in such case","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$KDbQHAFZdki0tDhGsZjw3yW67Nf7TT9F9aGQ_Br7q78?via=matrix.org&amp;via=igalia.com&amp;via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@bakkot:matrix.org\">@bakkot:matrix.org</a><br>If you hand your callback to someone else, and there is literally no way they could schedule the callback to run with a different context than the one which existed when you handed the callback to them, I am also fine with that</blockquote></mx-reply> * you can AsyncContext.wrap the callback in such case","m.new_content":{"body":"you can AsyncContext.wrap the callback in such case","format":"org.matrix.custom.html","formatted_body":"you can AsyncContext.wrap the callback in such case","msgtype":"m.text"},"m.relates_to":{"event_id":"$KEIs5lfIc_h2DJqPF2RlgoqzdASekWfWbUN07thtBNE","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675268963989,"senderName":"Chengzhong Wu","senderId":"@legendecas:matrix.org","id":"$QaHY510bbJP2a9GSt4zOe0ytN73UjZiNsUDPU0pgUyE"},
{"content":{"body":"if some ways of scheduling require you to wrap, they all should","msgtype":"m.text"},"ts":1675268979749,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$CjuMIXUnITEvVpzqQ882UY0P0zOzShSm2tdAKD_gjlI"},
{"content":{"body":"but if no ways of scheduling require you to wrap, that's fine too","msgtype":"m.text"},"ts":1675268989050,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$ziWNNAV6lCNp0yg1M6usWbw5Z7IkxZVgS0_XBSK6Hhs"},
{"content":{"body":"Promises are a way for our users to later schedule a task, we do not control where they create promises or where the chain `.then()`","format":"org.matrix.custom.html","formatted_body":"Promises are a way for our users to later schedule a task, we do not control where they create promises or where the chain <code>.then()</code>","msgtype":"m.text"},"ts":1675269002850,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$ngsRj9QN8Ignghq6xp9Hj1-orHJvZeU4pIKuOyE1U8k"},
{"content":{"body":"Michael Ficarra: `transfer` was always named transfer, but because of the \"preserve resizability\" semantics change, to get the original \"fixed length\" behavior, i added a new method","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@michaelficarra:matrix.org\">Michael Ficarra</a>: <code>transfer</code> was always named transfer, but because of the &quot;preserve resizability&quot; semantics change, to get the original &quot;fixed length&quot; behavior, i added a new method","msgtype":"m.text"},"ts":1675269003468,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$ZseLzdTePPZ5vcNMBV9x8Iu-4WQ7cSLNvBFqQ9z1Wdg"},
{"content":{"body":"I am just not enthusiastic about _some_ callback-taking scheduling APIs wrapping","format":"org.matrix.custom.html","formatted_body":"I am just not enthusiastic about <em>some</em> callback-taking scheduling APIs wrapping","msgtype":"m.text"},"ts":1675269004611,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$99o8P1u-2E7jHjZUsABzGBONN5fz1ix1YfCteiuwnIA"},
{"content":{"body":"But the default behavior can be that people can get the host defined context when using host apis.","msgtype":"m.text"},"ts":1675269008149,"senderName":"Chengzhong Wu","senderId":"@legendecas:matrix.org","id":"$dLtrj23aZCDUHwG_kM54mMEdKa9hfQSJJCkQyPIrJTI"},
{"content":{"body":" * But the default behavior can be that people can get the host defined context when using host apis.","m.new_content":{"body":"But the default behavior can be that people can get the host defined context when using host apis.","msgtype":"m.text"},"m.relates_to":{"event_id":"$dLtrj23aZCDUHwG_kM54mMEdKa9hfQSJJCkQyPIrJTI","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675269014460,"senderName":"Chengzhong Wu","senderId":"@legendecas:matrix.org","id":"$6wka_LWHtH-dWidEvJ5VQUqa4-556N2U40Z8GulQWBQ"},
{"content":{"body":"this meeting is the first meeting i presented the new method","msgtype":"m.text"},"ts":1675269018531,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$ATJUqkSXsdw1o--4YuENy5_dvqKrWhF3oNmaBFL3xGM"},
{"content":{"body":"So in order for us to guarantee they cannot escape our context, the `promise.then()` must preserve context","format":"org.matrix.custom.html","formatted_body":"So in order for us to guarantee they cannot escape our context, the <code>promise.then()</code> must preserve context","msgtype":"m.text"},"ts":1675269028356,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$gSSamMjDdL3Ph2ZeeUA_zsDikGNoxFy-UIuxslPVNr8"},
{"content":{"body":"littledan: I don't think we need to introduce a formal process around it. If I think the name was *bad* I would have blocked advancement.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@littledan:matrix.org\">littledan</a>: I don't think we need to introduce a formal process around it. If I think the name was <em>bad</em> I would have blocked advancement.","msgtype":"m.text"},"ts":1675269030757,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$ouyGFzvfL_Z62qLxGIywqO0bvjg_9ZU1mqRzlOmNaf4"},
{"content":{"body":"> <@michaelficarra:matrix.org> littledan: because it didn't matter enough\n\nOK, in this case, I don't see your advice for waiting more for Stage 3 as something actionable for me if I ran into a simlar case","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$Ucu_TuGOXe9ejH60nyuLnUtsgPmik2wLzW2IHoXzN4Q?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@michaelficarra:matrix.org\">@michaelficarra:matrix.org</a><br><a href=\"https://matrix.to/#/@littledan:matrix.org\">littledan</a>: because it didn't matter enough</blockquote></mx-reply>OK, in this case, I don't see your advice for waiting more for Stage 3 as something actionable for me if I ran into a simlar case","m.relates_to":{"m.in_reply_to":{"event_id":"$Ucu_TuGOXe9ejH60nyuLnUtsgPmik2wLzW2IHoXzN4Q"}},"msgtype":"m.text"},"ts":1675269036032,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$ztLXIPFBcLnIUbyRRARvYmSxBhG_UzO1yaw666JHf6Q"},
{"content":{"body":"Things that obviously schedule an async task should preserve async context","msgtype":"m.text"},"ts":1675269044245,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$VNQu5dgRy1-uoZSX8OQi9XgOvTUOD8INWUJxM8Keuco"},
{"content":{"body":"shu: true, but I had reviewed the proposal with the earlier name","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@shuyuguo:matrix.org\">shu</a>: true, but I had reviewed the proposal with the earlier name","msgtype":"m.text"},"ts":1675269044379,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$pquXXmxsvA6LVoAHrPJglWX3Vyp416WFHEY978lqZ_o"},
{"content":{"body":"> <@jridgewell:matrix.org> So in order for us to guarantee they cannot escape our context, the `promise.then()` must preserve context\n\nyes, and also every other possible way of scheduling a callback","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$gSSamMjDdL3Ph2ZeeUA_zsDikGNoxFy-UIuxslPVNr8?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@jridgewell:matrix.org\">@jridgewell:matrix.org</a><br>So in order for us to guarantee they cannot escape our context, the <code>promise.then()</code> must preserve context</blockquote></mx-reply>yes, and also every other possible way of scheduling a callback","m.relates_to":{"m.in_reply_to":{"event_id":"$gSSamMjDdL3Ph2ZeeUA_zsDikGNoxFy-UIuxslPVNr8"}},"msgtype":"m.text"},"ts":1675269064075,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$HhxoAUAGV6KMQgiGFPdgE9oG6UAU961tNjbknZHParA"},
{"content":{"body":"Michael Ficarra: yeah also fair, it was kind of last minute there","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@michaelficarra:matrix.org\">Michael Ficarra</a>: yeah also fair, it was kind of last minute there","msgtype":"m.text"},"ts":1675269064256,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$yg1pvEKdN9FtHMJj8jUMh6vhdpP3v5lyOJLFSFdcAAI"},
{"content":{"body":"which I am fine with, if it's viable","msgtype":"m.text"},"ts":1675269065693,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$ynaVZ_XpJC4TYvIPikyD1Ij5d5betfy-NGLspJGW27c"},
{"content":{"body":"Michael, this is exactly what we introduced the \"note dissent that's non-blocking\" part for","msgtype":"m.text"},"ts":1675269067079,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$rABIs212TZZBTVma4oPGO0PKdw6-zSVAPrrLBkvcNC0"},
{"content":{"body":"Note: Summary needs writing for previous item","msgtype":"m.text"},"ts":1675269067928,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$N-g9yZm99U2hGilM_759iM4wIRLSWG2Ce6iqAkbQcJI"},
{"content":{"body":"> <@bakkot:matrix.org> yes, and also every other possible way of scheduling a callback\n\nI agree, that's the behavior that I want","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$HhxoAUAGV6KMQgiGFPdgE9oG6UAU961tNjbknZHParA?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@bakkot:matrix.org\">@bakkot:matrix.org</a><br>yes, and also every other possible way of scheduling a callback</blockquote></mx-reply>I agree, that's the behavior that I want","m.relates_to":{"m.in_reply_to":{"event_id":"$HhxoAUAGV6KMQgiGFPdgE9oG6UAU961tNjbknZHParA"}},"msgtype":"m.text"},"ts":1675269084780,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$6pPvXcTXi-44gP2Wlf5IEG61VV_MBpBKwY13z5q5Crw"},
{"content":{"body":"> <@littledan:matrix.org> Michael, this is exactly what we introduced the \"note dissent that's non-blocking\" part for\n\nso I'm wondering what's not going to work about that","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$rABIs212TZZBTVma4oPGO0PKdw6-zSVAPrrLBkvcNC0?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@littledan:matrix.org\">@littledan:matrix.org</a><br>Michael, this is exactly what we introduced the &quot;note dissent that&#39;s non-blocking&quot; part for</blockquote></mx-reply>so I'm wondering what's not going to work about that","m.relates_to":{"m.in_reply_to":{"event_id":"$rABIs212TZZBTVma4oPGO0PKdw6-zSVAPrrLBkvcNC0"}},"msgtype":"m.text"},"ts":1675269085080,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$LRL0yRwDjP1hUdbgHUfZjfn30Tn6bPGK8iQTBcwI1X4"},
{"content":{"body":"Key word is _scheduling_ here","format":"org.matrix.custom.html","formatted_body":"Key word is <em>scheduling</em> here","msgtype":"m.text"},"ts":1675269107345,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$ed1RWxkmnJRjf5CX_5ULlnHkMOWlNaJO8w1EiLE4QZ0"},
{"content":{"body":"\"addEventListener\" counts as scheduling, of course","msgtype":"m.text"},"ts":1675269119831,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$sqoCRgnUs5wrbwpOxzmuuQ2YYrc32Z-IxMT0wWUTlDI"},
{"content":{"body":"and `onMessage`","format":"org.matrix.custom.html","formatted_body":"and <code>onMessage</code>","msgtype":"m.text"},"ts":1675269121909,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$P-owDdmhAyImC0pU9i8UbX49beYuN5h8qG6cs7tMtvI"},
{"content":{"body":"It doesn't","msgtype":"m.text"},"ts":1675269124894,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$kdG8eaAg3WHu7tCJxLO-EweZdmUrEcTuRRt_-Ps-NxY"},
{"content":{"body":"There's not obvious point where the callback would be invoked","msgtype":"m.text"},"ts":1675269137777,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$U2dD3hJogajpkjxCMXf-AmtqeYMOBzmVBYFRSahZsUM"},
{"content":{"body":"ok then I don't understand what you're saying","msgtype":"m.text"},"ts":1675269137965,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$VI_kvcG9LEpFLeJLbwfATMQTxDWpKSFmX5vj5CqeXxQ"},
{"content":{"body":"I can make a thing which looks exactly like a promise but which uses `addEventListener` to schedule the callback to run","format":"org.matrix.custom.html","formatted_body":"I can make a thing which looks exactly like a promise but which uses <code>addEventListener</code> to schedule the callback to run","msgtype":"m.text"},"ts":1675269173530,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$sK4mXTqRsrmOvUfcyXzVKgN7CBTvpROa4n7xpWgYtB4"},
{"content":{"body":"> <@littledan:matrix.org> so I'm wondering what's not going to work about that\n\nTo me, the value of advancing today outweighed the value of potentially coming up with a slightly better name. If it had not, I would have spoken up formally.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$LRL0yRwDjP1hUdbgHUfZjfn30Tn6bPGK8iQTBcwI1X4?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@littledan:matrix.org\">@littledan:matrix.org</a><br>so I'm wondering what's not going to work about that</blockquote></mx-reply>To me, the value of advancing today outweighed the value of potentially coming up with a slightly better name. If it had not, I would have spoken up formally.","m.relates_to":{"is_falling_back":false,"m.in_reply_to":{"event_id":"$LRL0yRwDjP1hUdbgHUfZjfn30Tn6bPGK8iQTBcwI1X4"}},"msgtype":"m.text"},"ts":1675269174646,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$ehPIo3YKP0Ssq1EbY-N2C9PD72cVS4eUpOnDDYscrtU"},
{"content":{"body":"`await` schedules a task to happen as soon as the promise settles (same for `.then()`), `setTimeout` schedules to run after X ms, etc","format":"org.matrix.custom.html","formatted_body":"<code>await</code> schedules a task to happen as soon as the promise settles (same for <code>.then()</code>), <code>setTimeout</code> schedules to run after X ms, etc","msgtype":"m.text"},"ts":1675269177487,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$R4CdX3aJvuEb4xFelXYIktSY-6WcsS2dl5Ti5D7DcA4"},
{"content":{"body":"there is no fundamental difference btween these things","msgtype":"m.text"},"ts":1675269179909,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$Nw-rschsYFOs2Z1gmbZTs-1XM95Lrtvtkg9vJQAjhb0"},
{"content":{"body":"There is","msgtype":"m.text"},"ts":1675269199005,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$7XBYuV7yDhkz2XmhaIZ3H-mdYWm0n58Wmqcltq-kUfw"},
{"content":{"body":"It exists only in imperative user code, not as part of the language","msgtype":"m.text"},"ts":1675269215425,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$AeP5JImPIGX5r1YEVpEzegukLSe3N31xMSQm9AMNNEk"},
{"content":{"body":"What is \"it\" in that sentence?","msgtype":"m.text"},"ts":1675269230312,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$LG_pg8LX4mjaAOn7oQHh_n2rWZobuRfxLYnmFT2VqI0"},
{"content":{"body":"Whatever calls your registered listener","msgtype":"m.text"},"ts":1675269250558,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$Wf36o44Qw83_7FQrobOeYuX-t1puzrahfysZNR8ITRo"},
{"content":{"body":"\"this callback gets called when the user clicks a button\" is exactly the same kind of thing as \"this callback gets called when the network request completes [and therefore settles the `fetch` promise]\"","format":"org.matrix.custom.html","formatted_body":"&quot;this callback gets called when the user clicks a button&quot; is exactly the same kind of thing as &quot;this callback gets called when the network request completes [and therefore settles the <code>fetch</code> promise]&quot;","msgtype":"m.text"},"ts":1675269299607,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$QFAz5HSl4MaSaF5DYJdMLHjt4mHd6bf-4vrYOeDJdtc"},
{"content":{"body":"like, `XMLHttpRequest`'s `onload` is not a different kind of thing from `fetch`'s `.then`","format":"org.matrix.custom.html","formatted_body":"like, <code>XMLHttpRequest</code>'s <code>onload</code> is not a different kind of thing from <code>fetch</code>'s <code>.then</code>","msgtype":"m.text"},"ts":1675269338118,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$wZOuXw1FBPpiEC68TCgqd9ftKUgRstgwjT98s2oIfP8"},
{"content":{"body":"That invocation isn't done automatically per the scheduling","msgtype":"m.text"},"ts":1675269349568,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$XSAbiglyxX45va9ypDcJ5mWywLYHhaMeRp-Bhv4BHs8"},
{"content":{"body":"Node has a long history of how this works, and I'm really hesitant to break with their precedent","msgtype":"m.text"},"ts":1675269371593,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$mz5K60RSKtotlkvK79nW5-gjqTDOJn9qDSNyVJM-7I4"},
{"content":{"body":"If there is a meaningful difference between `XMLHttpRequest`'s `onload` and `fetch`'s `.then`, I am not yet seeing it","format":"org.matrix.custom.html","formatted_body":"If there is a meaningful difference between <code>XMLHttpRequest</code>'s <code>onload</code> and <code>fetch</code>'s <code>.then</code>, I am not yet seeing it","msgtype":"m.text"},"ts":1675269400398,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$4nnd8Y5XH9lMlzyBqHXZDaoQ95wvnngEsbjgR09jVIo"},
{"content":{"body":"and in the absence of such a difference, I do not think those should behave differently wrt AsyncContext","msgtype":"m.text"},"ts":1675269434835,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$YxL5WhUgMXSlUY8tN1lSLMYI6cvAx9fEE4aGK_X8nco"},
{"content":{"body":"I am OK with both \"both of those APIs wrap\" and \"neither API wraps\", but not only one of them doing so","msgtype":"m.text"},"ts":1675269460785,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$HKb6qgYXvmwxAHOiEy_N1GTVjWTQW41k6lu0hnzvbp8"},
{"content":{"body":"The difference is the promise instance?","msgtype":"m.text"},"ts":1675269508939,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$Io-bGziOiMUHgaIdutOJT62E1CnADGwqwRmb29jlnyY"},
{"content":{"body":"I could see the point that `setImmediate`, `setTimeout`, `setInterval`, and even `process.nextTick` not automatically flow context, but `AsyncContext` is an async control-flow capability. `await` and `then` are explicitly async control-flow operations. The Timers API's aren't _precisely_ async control flow, though async control flow has been implemented on top of them in the past. ","format":"org.matrix.custom.html","formatted_body":"I could see the point that <code>setImmediate</code>, <code>setTimeout</code>, <code>setInterval</code>, and even <code>process.nextTick</code> not automatically flow context, but <code>AsyncContext</code> is an async control-flow capability. <code>await</code> and <code>then</code> are explicitly async control-flow operations. The Timers API's aren't <em>precisely</em> async control flow, though async control flow has been implemented on top of them in the past.","msgtype":"m.text"},"ts":1675269513594,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$kBPaPuJn5CGieeFW1DIZIPG7uZHI-bFJFD2OrcsWLFQ"},
{"content":{"body":"The fact that it exists in ecma262","msgtype":"m.text"},"ts":1675269516009,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$dYCcrNenaanYKvPiwiKzicAJB5g3-poiiIlJb1zcaKQ"},
{"content":{"body":"The internal event listener that fetch uses doesn't need extra work, because the promise it returns is responsible for scheduling continuations","msgtype":"m.text"},"ts":1675269569110,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$plo-9gV1_fR5uzOYpKdZmDXJWNnopHFIv8dvhnZYgOA"},
{"content":{"body":"Why are promise instances relevant?","msgtype":"m.text"},"ts":1675269569823,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$v3OkLg-9oI6Hx-bEIGk3tyFjpCN_2pvovxPCR4Je3AI"},
{"content":{"body":"I'm fairly certain `AsyncContext` must _at least_ support both `await` and `.then` to be truly viable.","format":"org.matrix.custom.html","formatted_body":"I'm fairly certain <code>AsyncContext</code> must <em>at least</em> support both <code>await</code> and <code>.then</code> to be truly viable.","msgtype":"m.text"},"ts":1675269570420,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$oa7CvQR4NLdoevmgtdYMhZ4cJiyQs5CyaNIIVcEkj54"},
{"content":{"body":"Why is \"it exists in ecma262\" relevant, or even something you could reasonably ask a developer to know?","msgtype":"m.text"},"ts":1675269614111,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$niOO6wZo8awlCl4Jv_SN1_stlZ0WBwrb_rrrMYOK5DU"},
{"content":{"body":"> <@bakkot:matrix.org> Why are promise instances relevant?\n\nPromise instances are reified async control flow operations. ","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$v3OkLg-9oI6Hx-bEIGk3tyFjpCN_2pvovxPCR4Je3AI?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@bakkot:matrix.org\">@bakkot:matrix.org</a><br>Why are promise instances relevant?</blockquote></mx-reply>Promise instances are reified async control flow operations.","m.relates_to":{"m.in_reply_to":{"event_id":"$v3OkLg-9oI6Hx-bEIGk3tyFjpCN_2pvovxPCR4Je3AI"}},"msgtype":"m.text"},"ts":1675269616606,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$LyhFSOIAUefV5vPf5srp2JI7ixnM_IcEzEPRFusy340"},
{"content":{"body":"More to the point: Justin Ridgewell , you said that for your abstraction to work, there _must_ not be a way to escape the context. if `onload` is a way to escape the context, then... ???","format":"org.matrix.custom.html","formatted_body":"More to the point: <a href=\"https://matrix.to/#/@jridgewell:matrix.org\">Justin Ridgewell</a> , you said that for your abstraction to work, there <em>must</em> not be a way to escape the context. if <code>onload</code> is a way to escape the context, then... ???","msgtype":"m.text"},"ts":1675269646274,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$RcQ2SG2HDsY07HIwU0rkGEZw1PL-yQ-Qv8fC4TnMpGg"},
{"content":{"body":"That's a great way to put it","msgtype":"m.text"},"ts":1675269648288,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$F6D1rWfH6LL4S1AdsUVmJ6qTReC36vz9RP8P8mzgnIs"},
{"content":{"body":"so are callbacks!","msgtype":"m.text"},"ts":1675269658337,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$O9jACUfv-6eOO14AvXoKN8S_o3ZnifwDonAirMi03G0"},
{"content":{"body":"\"Promises are sugar for callbacks\" is at least as important as \"await is sugar for Promises\"","msgtype":"m.text"},"ts":1675269684196,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$KaGG7indGxaxnPmx5kPJjszltJ6aO9CLGW3avPKovKs"},
{"content":{"body":"Callbacks aren't _explicitly_ async control flow.","format":"org.matrix.custom.html","formatted_body":"Callbacks aren't <em>explicitly</em> async control flow.","msgtype":"m.text"},"ts":1675269689092,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$QU04s64PRed30Lr2zT-AZuwMreyBMUtGrgJbVhPpzvQ"},
{"content":{"body":"> <@bakkot:matrix.org> \"Promises are sugar for callbacks\" is at least as important as \"await is sugar for Promises\"\n\nThat's a false equivalence. Promises are sugar for CPS, of which callbacks are a part, not the entirety.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$KaGG7indGxaxnPmx5kPJjszltJ6aO9CLGW3avPKovKs?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@bakkot:matrix.org\">@bakkot:matrix.org</a><br>&quot;Promises are sugar for callbacks&quot; is at least as important as &quot;await is sugar for Promises&quot;</blockquote></mx-reply>That's a false equivalence. Promises are sugar for CPS, of which callbacks are a part, not the entirety.","m.relates_to":{"m.in_reply_to":{"event_id":"$KaGG7indGxaxnPmx5kPJjszltJ6aO9CLGW3avPKovKs"}},"msgtype":"m.text"},"ts":1675269718025,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$Jby54VJa8GkM4NSlhBiSmhpPi1pdkkJdm3FRJFw9GWk"},
{"content":{"body":"Sure, sugar for CPS, then. But `onload` is CPS also.","format":"org.matrix.custom.html","formatted_body":"Sure, sugar for CPS, then. But <code>onload</code> is CPS also.","msgtype":"m.text"},"ts":1675269747979,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$oEDICPgACaqIqD-gh5ImIj50maw6znROwk650aPngvw"},
{"content":{"body":"No, onload is reactivity. It isn't expressly intended to solve async control-flow.","msgtype":"m.text"},"ts":1675269768720,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$-bIjUpGd9qx7Bx-m1aPvKsModcb6Gacu93TQaXyBUd8"},
{"content":{"body":"I do not understand the distinction you're drawing here.","msgtype":"m.text"},"ts":1675269788973,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$d2UMAQllchneIMFuzIxqiGHZWX-n_-u0Hbc7SB38s9Q"},
{"content":{"body":"`Promise` is expressly intended to solve async control flow. ","format":"org.matrix.custom.html","formatted_body":"<code>Promise</code> is expressly intended to solve async control flow.","msgtype":"m.text"},"ts":1675269792778,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$6doBZUc59NEEvx34dQcN9RaAEtedD30eZwNrSp38670"},
{"content":{"body":"backing up a step from whether something is or is not \"explicitly\" async control flow, my position is that it is not reasonable to ask developers to intuit that XHR's `.onload` is a fundamentally different _kind of thing_ than `fetch`'s `.then`, especially since we've spent most of the last decade going around telling everyone that the latter is sugar for the former.","format":"org.matrix.custom.html","formatted_body":"backing up a step from whether something is or is not &quot;explicitly&quot; async control flow, my position is that it is not reasonable to ask developers to intuit that XHR's <code>.onload</code> is a fundamentally different <em>kind of thing</em> than <code>fetch</code>'s <code>.then</code>, especially since we've spent most of the last decade going around telling everyone that the latter is sugar for the former.","msgtype":"m.text"},"ts":1675269864318,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$SAJlnGNozG9Znnl7HKIlkTuGjUH3KdMxZ02ghBZxE_U"},
{"content":{"body":"so I am not OK with designs which require developers to intuit this difference.","msgtype":"m.text"},"ts":1675269881936,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$TZr6yZ6e25u1hpcw9wdFoD9uV_X-ThimbEcX_MCA51A"},
{"content":{"body":"ljharb: I'd like to try to have a call to resolve the `Id` issue, are you available during the break today?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@ljharb:matrix.org\">ljharb</a>: I'd like to try to have a call to resolve the <code>Id</code> issue, are you available during the break today?","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"ljharb: I'd like to try to have a call to resolve the `Id` issue, are you available during the break today?","mimetype":"text/plain"},{"body":"<a href=\"https://matrix.to/#/@ljharb:matrix.org\">ljharb</a>: I'd like to try to have a call to resolve the <code>Id</code> issue, are you available during the break today?","mimetype":"text/html"}]},"ts":1675269933299,"senderName":"ptomato","senderId":"@pchimento:igalia.com","id":"$oyBGKIUE8uTAMWcPynTelbMxOPwtd1W8MvDsooRn1CQ"},
{"content":{"body":"but I am OK with both possible designs which treat those as the same kind of thing - making `onload` wrap, or making `then` not wrap.","format":"org.matrix.custom.html","formatted_body":"but I am OK with both possible designs which treat those as the same kind of thing - making <code>onload</code> wrap, or making <code>then</code> not wrap.","msgtype":"m.text"},"ts":1675269940112,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$rgg7rtC3L-KepC7iTak8ERV01-qFTEL-tddgOMXVPX4"},
{"content":{"body":"I think your definition of CPS is is _far_ more broad than what is generally accepted.","format":"org.matrix.custom.html","formatted_body":"I think your definition of CPS is is <em>far</em> more broad than what is generally accepted.","msgtype":"m.text"},"ts":1675269957482,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$WfruK3gwYBw0Z9PV5fet_l5U2ecwtq0Zz4WyJ4sOBig"},
{"content":{"body":"again, I am not super committed to the definition of terms here.","msgtype":"m.text"},"ts":1675269971711,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$lzNGciV9kodLhYakF-ENjcnJszfIYSP07gj-CzwBzjI"},
{"content":{"body":"> <@pchimento:igalia.com> ljharb: I'd like to try to have a call to resolve the `Id` issue, are you available during the break today?\n\nabsolutely, thanks","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$oyBGKIUE8uTAMWcPynTelbMxOPwtd1W8MvDsooRn1CQ?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@pchimento:igalia.com\">@pchimento:igalia.com</a><br><a href=\"https://matrix.to/#/@ljharb:matrix.org\">ljharb</a>: I'd like to try to have a call to resolve the <code>Id</code> issue, are you available during the break today?</blockquote></mx-reply>absolutely, thanks","m.relates_to":{"m.in_reply_to":{"event_id":"$oyBGKIUE8uTAMWcPynTelbMxOPwtd1W8MvDsooRn1CQ"}},"msgtype":"m.text"},"ts":1675270000173,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$H0RTDx3K5G22-W47vJn0pnLI95mHpVkU44xOX4xbpBU"},
{"content":{"body":"the thing which is important to me is the bit about whether or not developer should know to treat `.onload` as a different kind of thing from `.then`","format":"org.matrix.custom.html","formatted_body":"the thing which is important to me is the bit about whether or not developer should know to treat <code>.onload</code> as a different kind of thing from <code>.then</code>","msgtype":"m.text"},"ts":1675270002501,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$8IJeLQVU0nAyFgZvdd6DeBdTsAtg7U_9TG7wsgSuwJQ"},
{"content":{"body":"and, specifically, whether developers _who aren't doing anything with async contexts at all_ should have to know that","format":"org.matrix.custom.html","formatted_body":"and, specifically, whether developers <em>who aren't doing anything with async contexts at all</em> should have to know that","msgtype":"m.text"},"ts":1675270017944,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$zxCtKzobm70ll-HZ5Gqu-lF3O07K-25WUEoq7-Ixtao"},
{"content":{"body":"I think that whether `onload` should wrap should be up to WHATWG. TC39 doesn't spec `onload`, however. What we do specify is `Promise`.","format":"org.matrix.custom.html","formatted_body":"I think that whether <code>onload</code> should wrap should be up to WHATWG. TC39 doesn't spec <code>onload</code>, however. What we do specify is <code>Promise</code>.","msgtype":"m.text"},"ts":1675270030591,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$o4UAS02nACoPrzTd6Bu3a84D2ZDobWSUNeQovq2jHYQ"},
{"content":{"body":"> <@ljharb:matrix.org> absolutely, thanks\n\ncan we aim for the first half of the break?","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$H0RTDx3K5G22-W47vJn0pnLI95mHpVkU44xOX4xbpBU?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@ljharb:matrix.org\">@ljharb:matrix.org</a><br>absolutely, thanks</blockquote></mx-reply>can we aim for the first half of the break?","m.relates_to":{"m.in_reply_to":{"event_id":"$H0RTDx3K5G22-W47vJn0pnLI95mHpVkU44xOX4xbpBU"}},"msgtype":"m.text","org.matrix.msc1767.message":[{"body":"> <@ljharb:matrix.org> absolutely, thanks\n\ncan we aim for the first half of the break?","mimetype":"text/plain"},{"body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$H0RTDx3K5G22-W47vJn0pnLI95mHpVkU44xOX4xbpBU?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@ljharb:matrix.org\">@ljharb:matrix.org</a><br>absolutely, thanks</blockquote></mx-reply>can we aim for the first half of the break?","mimetype":"text/html"}]},"ts":1675270065992,"senderName":"ptomato","senderId":"@pchimento:igalia.com","id":"$GHImY5f3y-uklezvaCNmJm8M4cAFjlnBEHYXOimTnRo"},
{"content":{"body":"refactoring my library from `fetch` to `XHR` should not break _consumers_ of my library just because they happened to be using async contexts.","format":"org.matrix.custom.html","formatted_body":"refactoring my library from <code>fetch</code> to <code>XHR</code> should not break <em>consumers</em> of my library just because they happened to be using async contexts.","msgtype":"m.text"},"ts":1675270067813,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$Up08fHGSiVYKhVjI1NZ3TxEGhUYdXRAT5FlYn91M0TI"},
{"content":{"body":"yup, just shoot me a link, i'm open","m.relates_to":{"event_id":"$GHImY5f3y-uklezvaCNmJm8M4cAFjlnBEHYXOimTnRo","is_falling_back":true,"m.in_reply_to":{"event_id":"$GHImY5f3y-uklezvaCNmJm8M4cAFjlnBEHYXOimTnRo"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675270096959,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$JI864lpzzMqXXROiYxrZSFn4l7micSAzUmIz8umU6Y0"},
{"content":{"body":"That would already have consequences","msgtype":"m.text"},"ts":1675270114774,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$pkzjbfgVeQk6buCIIZdKVROnC9YjiamXvDJr8757C6g"},
{"content":{"body":" * again, I am not super committed to the definition of terms here.","m.new_content":{"body":"again, I am not super committed to the definition of terms here.","msgtype":"m.text"},"m.relates_to":{"event_id":"$lzNGciV9kodLhYakF-ENjcnJszfIYSP07gj-CzwBzjI","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675270157930,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$ZyvYlG4-kDl7HiUh2SceS2yNZG1HAJ9rFMqNb-NLiPk"},
{"content":{"body":"For example, you would have to manually handle error propagation. If not, then there are observable differences in whether that error is a rejection, an unhandled promise rejection, or some other host-defined error-handling mechanism.","msgtype":"m.text"},"ts":1675270203391,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$SPvmcmPBEYKa7MLvFpnCDf9gRlL46J9uXJvg_DzIeHY"},
{"content":{"body":"By using `Promise`, you get a lot of async control flow functionality for free. Automatically flowing an `AsyncContext` across async control flow is more free functionality.","format":"org.matrix.custom.html","formatted_body":"By using <code>Promise</code>, you get a lot of async control flow functionality for free. Automatically flowing an <code>AsyncContext</code> across async control flow is more free functionality.","msgtype":"m.text"},"ts":1675270285789,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$R7toziolLHFIWLCNLGoZH4dLjiw9TEIBePD6Z39JoDE"},
{"content":{"body":"OK, so assume I am manually handling error propagation.","msgtype":"m.text"},"ts":1675270289796,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$2D6IvsOwJawYNLkbpezSxm1rZCAd_xMxVK3Vat_DaYQ"},
{"content":{"body":"You, as the library author, could also manually `AsyncContext.wrap` the incoming callback to support context flow.","format":"org.matrix.custom.html","formatted_body":"You, as the library author, could also manually <code>AsyncContext.wrap</code> the incoming callback to support context flow.","msgtype":"m.text"},"ts":1675270327418,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$pIkN9cE1-Ij3_K25LXabmtC9TkfUNzT3mLLicgGZ0BA"},
{"content":{"body":"As the library implementor, I should not have to care about whether or not I am flowing an `AsyncContext`. That is, as I understand it, literally the entire point of this feature.","format":"org.matrix.custom.html","formatted_body":"As the library implementor, I should not have to care about whether or not I am flowing an <code>AsyncContext</code>. That is, as I understand it, literally the entire point of this feature.","msgtype":"m.text"},"ts":1675270329429,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$o74qUmUFB22ryxhBLSOD9CII3vzJjJOaUqxCYUdzygM"},
{"content":{"body":" * As the library implementor, I should not have to care about whether or not I am flowing an `AsyncContext`. That is, as I understand it, literally the entire point of this feature.","format":"org.matrix.custom.html","formatted_body":" * As the library implementor, I should not have to care about whether or not I am flowing an <code>AsyncContext</code>. That is, as I understand it, literally the entire point of this feature.","m.new_content":{"body":"As the library implementor, I should not have to care about whether or not I am flowing an `AsyncContext`. That is, as I understand it, literally the entire point of this feature.","format":"org.matrix.custom.html","formatted_body":"As the library implementor, I should not have to care about whether or not I am flowing an <code>AsyncContext</code>. That is, as I understand it, literally the entire point of this feature.","msgtype":"m.text"},"m.relates_to":{"event_id":"$o74qUmUFB22ryxhBLSOD9CII3vzJjJOaUqxCYUdzygM","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675270350464,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$osHBvk--l3Bz0RBjbiRppuP8Ejl8j_fTmU1IXSN5UfY"},
{"content":{"body":"I've created https://meet.jit.si/identifier. not all the champions will be there but Justin, Richard, and I will","m.relates_to":{"event_id":"$GHImY5f3y-uklezvaCNmJm8M4cAFjlnBEHYXOimTnRo","is_falling_back":true,"m.in_reply_to":{"event_id":"$GHImY5f3y-uklezvaCNmJm8M4cAFjlnBEHYXOimTnRo"},"rel_type":"m.thread"},"msgtype":"m.text","org.matrix.msc1767.text":"I've created https://meet.jit.si/identifier. not all the champions will be there but Justin, Richard, and I will"},"ts":1675270374611,"senderName":"ptomato","senderId":"@pchimento:igalia.com","id":"$mRy3gpHUV-HA-3_yBBJM5f7JFm7WJLtVEYmL-OCyVNE"},
{"content":{"body":"Please join the fun AsyncContext discussion at #tc39-async-context:matrix.org !","msgtype":"m.text"},"ts":1675270492031,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$Fji3k4oCEfVQ-dJx5NuNIfuRL7FsAUYFxhsu2QZm2Ow"},
{"content":{"body":"> <@bakkot:matrix.org> As the library implementor, I should not have to care about whether or not I am flowing an `AsyncContext`. That is, as I understand it, literally the entire point of this feature.\n\nThat's not entirely true. If you, as a library author, are using language-specified async control flow capabilities (`await`, `Promise`, `AsyncContext`), then yes it should be transparent. As a library author you should also be able to explicitly escape the current context, which is also achievable with `AsyncContext.wrap`.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$o74qUmUFB22ryxhBLSOD9CII3vzJjJOaUqxCYUdzygM?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@bakkot:matrix.org\">@bakkot:matrix.org</a><br>As the library implementor, I should not have to care about whether or not I am flowing an <code>AsyncContext</code>. That is, as I understand it, literally the entire point of this feature.</blockquote></mx-reply>That's not entirely true. If you, as a library author, are using language-specified async control flow capabilities (<code>await</code>, <code>Promise</code>, <code>AsyncContext</code>), then yes it should be transparent. As a library author you should also be able to explicitly escape the current context, which is also achievable with <code>AsyncContext.wrap</code>.","m.relates_to":{"m.in_reply_to":{"event_id":"$o74qUmUFB22ryxhBLSOD9CII3vzJjJOaUqxCYUdzygM"}},"msgtype":"m.text"},"ts":1675270548029,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$HnYToxgB26-O99lxiq0SzMKnC2nQYVPhwyLLGwNzk5o"},
{"content":{"body":"In fact, if you were wrapping your XHR `onload` in a `new Promise(...)`, having `.then` do async control flow for you would be a win, because you still get `AsyncContext` flow for free.","format":"org.matrix.custom.html","formatted_body":"In fact, if you were wrapping your XHR <code>onload</code> in a <code>new Promise(...)</code>, having <code>.then</code> do async control flow for you would be a win, because you still get <code>AsyncContext</code> flow for free.","msgtype":"m.text"},"ts":1675270628524,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$UQtBcMw14qmcdaCVxroqYvIzkzZZ86Vaw_sFwiOVReU"},
{"content":{"body":" * In fact, if you were wrapping your XHR `onload` in a `new Promise(...)`, having `.then` do async control flow for you would be a win, because you still get `AsyncContext` flow for free.","format":"org.matrix.custom.html","formatted_body":" * In fact, if you were wrapping your XHR <code>onload</code> in a <code>new Promise(...)</code>, having <code>.then</code> do async control flow for you would be a win, because you still get <code>AsyncContext</code> flow for free.","m.new_content":{"body":"In fact, if you were wrapping your XHR `onload` in a `new Promise(...)`, having `.then` do async control flow for you would be a win, because you still get `AsyncContext` flow for free.","format":"org.matrix.custom.html","formatted_body":"In fact, if you were wrapping your XHR <code>onload</code> in a <code>new Promise(...)</code>, having <code>.then</code> do async control flow for you would be a win, because you still get <code>AsyncContext</code> flow for free.","msgtype":"m.text"},"m.relates_to":{"event_id":"$UQtBcMw14qmcdaCVxroqYvIzkzZZ86Vaw_sFwiOVReU","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675270642728,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$tL2ZWYrqA-ONSYKWVh1mMdOgdSIvebBaTODORUkFc-c"},
{"content":{"body":"littledan: MatrixError: [403] You are not invited to this room. (https://matrix-client.matrix.org/_matrix/client/r0/join/%23tc39-async-context%3Amatrix.org)  🥺","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@littledan:matrix.org\">littledan</a>: MatrixError: [403] You are not invited to this room. (https://matrix-client.matrix.org/_matrix/client/r0/join/%23tc39-async-context%3Amatrix.org)  🥺","msgtype":"m.text"},"ts":1675270645526,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$2HvjS_iJeCaYtH2iIangcyho1-zYC6jkC_IN5PLBTmg"},
{"content":{"body":"The thing that Justin Ridgewell said earlier was that they are trying to \"guarantee they cannot escape our context\"","format":"org.matrix.custom.html","formatted_body":"The thing that <a href=\"https://matrix.to/#/@jridgewell:matrix.org\">Justin Ridgewell</a> said earlier was that they are trying to &quot;guarantee they cannot escape our context&quot;","msgtype":"m.text"},"ts":1675270651597,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$KxH80sJ84-U43HVCP_aIi2reaVZ-ikQ0HoVh7qGkEoI"},
{"content":{"body":"which means that \"some subset of things will preserve the context transparently\" is not good enough","msgtype":"m.text"},"ts":1675270678473,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$n6snZSw5h2A1HU0N_wxy24R2TpcIedz0XocyQ08VfLY"},
{"content":{"body":"I think it will always be possible for a library to run a callback in a pre-captured context? but the user can always wrap their callback to force it back.","msgtype":"m.text"},"ts":1675270839076,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$RjtMaTv0gi6OHAEvLTJOEYAbsHsA6ddu9k36d5b65oE"},
{"content":{"body":"> <@bakkot:matrix.org> which means that \"some subset of things will preserve the context transparently\" is not good enough\n\nI'm not refuting that. My position is that `await` and `Promise` must support automatic flow _at a minimum_ to be viable.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$n6snZSw5h2A1HU0N_wxy24R2TpcIedz0XocyQ08VfLY?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@bakkot:matrix.org\">@bakkot:matrix.org</a><br>which means that &quot;some subset of things will preserve the context transparently&quot; is not good enough</blockquote></mx-reply>I'm not refuting that. My position is that <code>await</code> and <code>Promise</code> must support automatic flow <em>at a minimum</em> to be viable.","m.relates_to":{"m.in_reply_to":{"event_id":"$n6snZSw5h2A1HU0N_wxy24R2TpcIedz0XocyQ08VfLY"}},"msgtype":"m.text"},"ts":1675270856350,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$B9BDXI6LfFSjWacKC7YUwri_MQ64ZyOaYIxRbM_C9jg"},
{"content":{"body":"It means any API or syntactic surface the user code has available to them cannot allow them to escape an AsyncContext that was created when invoking the user code the first time","msgtype":"m.text"},"ts":1675270876084,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$YkOkIriWKK6fLZUT9wYSFX1tc30fa6XZBtUtAMMrdJI"},
{"content":{"body":"I am still confused about what you mean by \"viable\", since, while I grant that those are _necessary_ for the thing Justing wants, they are certainly not _sufficient_","format":"org.matrix.custom.html","formatted_body":"I am still confused about what you mean by &quot;viable&quot;, since, while I grant that those are <em>necessary</em> for the thing Justing wants, they are certainly not <em>sufficient</em>","msgtype":"m.text"},"ts":1675270895349,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$qQcTmjQ3hkoMsT2th7qAY7sWF1Uug6MlY3wtz0OsMGs"},
{"content":{"body":"built-ins like Promise and syntax like await must preserve this","msgtype":"m.text"},"ts":1675270902733,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$tv3bfvLqKei-bepcNQZsKy6_3kdHGPahqonrx8_B9O0"},
{"content":{"body":"by \"viable\" do you mean something like \"convenient\"?","msgtype":"m.text"},"ts":1675270907229,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$S50i2nf_BtZjOAeI31ndmN4ubKLeKtmQx-rtcToKIDw"},
{"content":{"body":"> <@littledan:matrix.org> Please join the fun AsyncContext discussion at #tc39-async-context:matrix.org !\n\nI think we need to transfer it to the TC39 space first, then open up registrations to any space members","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$Fji3k4oCEfVQ-dJx5NuNIfuRL7FsAUYFxhsu2QZm2Ow?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@littledan:matrix.org\">@littledan:matrix.org</a><br>Please join the fun AsyncContext discussion at #tc39-async-context:matrix.org !</blockquote></mx-reply>I think we need to transfer it to the TC39 space first, then open up registrations to any space members","m.relates_to":{"m.in_reply_to":{"event_id":"$Fji3k4oCEfVQ-dJx5NuNIfuRL7FsAUYFxhsu2QZm2Ow"}},"msgtype":"m.text"},"ts":1675270913506,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$0j_K5U2Gq83Yl5zM3Su3VAFOU0PEo_qesnxvNfcsBBA"},
{"content":{"body":"> <@shuyuguo:matrix.org> littledan: MatrixError: [403] You are not invited to this room. (https://matrix-client.matrix.org/_matrix/client/r0/join/%23tc39-async-context%3Amatrix.org)  🥺\n\nSorry about that, please try again","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$2HvjS_iJeCaYtH2iIangcyho1-zYC6jkC_IN5PLBTmg?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@shuyuguo:matrix.org\">@shuyuguo:matrix.org</a><br><a href=\"https://matrix.to/#/@littledan:matrix.org\">littledan</a>: MatrixError: [403] You are not invited to this room. (https://matrix-client.matrix.org/_matrix/client/r0/join/%23tc39-async-context%3Amatrix.org)  🥺</blockquote></mx-reply>Sorry about that, please try again","m.relates_to":{"m.in_reply_to":{"event_id":"$2HvjS_iJeCaYtH2iIangcyho1-zYC6jkC_IN5PLBTmg"}},"msgtype":"m.text"},"ts":1675270915848,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$jCB1mKGpdYJ1y2Q74ZMDbdoPSftjWeHsrYRnzZfwSqw"},
{"content":{"body":"> <@jridgewell:matrix.org> I think we need to transfer it to the TC39 space first, then open up registrations to any space members\n\nno, you literally just left it private","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$0j_K5U2Gq83Yl5zM3Su3VAFOU0PEo_qesnxvNfcsBBA?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@jridgewell:matrix.org\">@jridgewell:matrix.org</a><br>I think we need to transfer it to the TC39 space first, then open up registrations to any space members</blockquote></mx-reply>no, you literally just left it private","m.relates_to":{"m.in_reply_to":{"event_id":"$0j_K5U2Gq83Yl5zM3Su3VAFOU0PEo_qesnxvNfcsBBA"}},"msgtype":"m.text"},"ts":1675270926005,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$99JfF6GZP5JihCF2v7gH6bvuiOi6QTeYF-3hUwwHGNA"},
{"content":{"body":"the only other feature in the language async calling is FinalizationRegistry callbacks, which should also capture at creation","msgtype":"m.text"},"ts":1675270949749,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$vyd-CLdd1gWqQl0n3-J0LQ27dxO1D4Pem0Y2RsW2QLM"},
{"content":{"body":"> <@mhofman:matrix.org> built-ins like Promise and syntax like await must preserve this\n\nno one should have to know that XHR or setTimeout are not \"built in\" in the same sense that Promise is","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$tv3bfvLqKei-bepcNQZsKy6_3kdHGPahqonrx8_B9O0?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@mhofman:matrix.org\">@mhofman:matrix.org</a><br>built-ins like Promise and syntax like await must preserve this</blockquote></mx-reply>no one should have to know that XHR or setTimeout are not &quot;built in&quot; in the same sense that Promise is","m.relates_to":{"m.in_reply_to":{"event_id":"$tv3bfvLqKei-bepcNQZsKy6_3kdHGPahqonrx8_B9O0"}},"msgtype":"m.text"},"ts":1675270964997,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$_t9D54ss7Sywk2cC5p7JlgxRZuoQSIc_ztFRoM_J4Lc"},
{"content":{"body":"anything else is a host API, that can be virtualized by the environment executing the user code","msgtype":"m.text"},"ts":1675270968233,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$a2SnYmHl9as9O5MalChR5UVd2MoAohdKwLPshDYQeps"},
{"content":{"body":"I'm not asking that they do, I'm saying the onus is on the host to preserve this guarantee, whatever \"host\" is (virtual or browser, etc.)","msgtype":"m.text"},"ts":1675271009870,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$FePqTYacFHy0M6QCfSQv6n3Bt8bTyseXVg56vN63KNY"},
{"content":{"body":"If we want it to be a guarantee we can write it down, but it sounds like the designers of the feature do not think it should be a guarantee, so I don't understand the model we're going for here","msgtype":"m.text"},"ts":1675271085522,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$ohQFN7SFjqkt7SDW3362B5fPMW-NqK8hwuK7SiO_fZE"},
{"content":{"body":"> <@bakkot:matrix.org> by \"viable\" do you mean something like \"convenient\"?\n\nNo, I mean an `AsyncContext` that doesn't support `.then` would not be useful for my purposes and I don't know that I would be willing to support Stage 2 without it. Limiting it only to `await` makes it barely usable and results in a terrible DX for the most common case outside of `await` itself.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$S50i2nf_BtZjOAeI31ndmN4ubKLeKtmQx-rtcToKIDw?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@bakkot:matrix.org\">@bakkot:matrix.org</a><br>by &quot;viable&quot; do you mean something like &quot;convenient&quot;?</blockquote></mx-reply>No, I mean an <code>AsyncContext</code> that doesn't support <code>.then</code> would not be useful for my purposes and I don't know that I would be willing to support Stage 2 without it. Limiting it only to <code>await</code> makes it barely usable and results in a terrible DX for the most common case outside of <code>await</code> itself.","m.relates_to":{"m.in_reply_to":{"event_id":"$S50i2nf_BtZjOAeI31ndmN4ubKLeKtmQx-rtcToKIDw"}},"msgtype":"m.text"},"ts":1675271086204,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$4r0nYh_DIE_cT2LRMDAHXWu62Miw5obX81KNKdyc8Kk"},
{"content":{"body":"How can we transfer #tc39-async-context:matrix.org to the TC39 space?","msgtype":"m.text"},"ts":1675271114509,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$mCv-JHlPSrLQZGv3DWJWdt9mbFqihVKfx6HGphFo5ZM"},
{"content":{"body":"i think i can do it if you add me as an admin to the channel","msgtype":"m.text"},"ts":1675271125854,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$zFrFvelY9wQ305YN85F7irJRPp0ZtPgZLJ_HiimvVl8"},
{"content":{"body":"Done","msgtype":"m.text"},"ts":1675271164212,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$J0ENr_Rlktqnu5GwPwR7w76k2bs7e6mf0BDcviQkwVA"},
{"content":{"body":"> <@rbuckton:matrix.org> No, I mean an `AsyncContext` that doesn't support `.then` would not be useful for my purposes and I don't know that I would be willing to support Stage 2 without it. Limiting it only to `await` makes it barely usable and results in a terrible DX for the most common case outside of `await` itself.\n\nthat is: the thing you mean is \"without this it will be too inconvenient to be practical\", not \"without this it will lack some guarantee I rely on\", right? ","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$4r0nYh_DIE_cT2LRMDAHXWu62Miw5obX81KNKdyc8Kk?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@rbuckton:matrix.org\">@rbuckton:matrix.org</a><br>No, I mean an <code>AsyncContext</code> that doesn't support <code>.then</code> would not be useful for my purposes and I don't know that I would be willing to support Stage 2 without it. Limiting it only to <code>await</code> makes it barely usable and results in a terrible DX for the most common case outside of <code>await</code> itself.</blockquote></mx-reply>that is: the thing you mean is &quot;without this it will be too inconvenient to be practical&quot;, not &quot;without this it will lack some guarantee I rely on&quot;, right?","m.relates_to":{"m.in_reply_to":{"event_id":"$4r0nYh_DIE_cT2LRMDAHXWu62Miw5obX81KNKdyc8Kk"}},"msgtype":"m.text"},"ts":1675271237953,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$-z0y1OnVP7Cixeaz3Awsk0YRCLYbUFY_kkJFcoLuJ4A"},
{"content":{"body":"give me a bit, i should have it done by 10","m.relates_to":{"event_id":"$J0ENr_Rlktqnu5GwPwR7w76k2bs7e6mf0BDcviQkwVA","is_falling_back":true,"m.in_reply_to":{"event_id":"$J0ENr_Rlktqnu5GwPwR7w76k2bs7e6mf0BDcviQkwVA"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675271240828,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$rSwbosBcOh8pN09jU7zXJMPx64ftPeND-m-umgG3az8"},
{"content":{"body":"I am open to arguments of that form, but those would incline me in the direction of making it a requirement for hosts that _any_ method of registering a callback which might get run out of the current microtask tick must wrap the callback with the async context which was present when the callback was registered","format":"org.matrix.custom.html","formatted_body":"I am open to arguments of that form, but those would incline me in the direction of making it a requirement for hosts that <em>any</em> method of registering a callback which might get run out of the current microtask tick must wrap the callback with the async context which was present when the callback was registered","msgtype":"m.text"},"ts":1675271323401,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$KF_b-3_vZoYZJkPW5Y-DAH5k1iqQBzeiyYjlj3Hy8Rw"},
{"content":{"body":"(like I said, I'm ok with \"all\" or \"none\", just not \"some\")","msgtype":"m.text"},"ts":1675271334183,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$_qv3yqz6pcUjEkw6B3ynRZERRXoNsCj06fpd-3Si4ms"},
{"content":{"body":" * I am open to arguments of that form, but those would incline me in the direction of making it a requirement for hosts that _any_ method of registering a callback which might get run out of the current microtask tick must wrap the callback with the async context which was present when the callback was registered","format":"org.matrix.custom.html","formatted_body":" * I am open to arguments of that form, but those would incline me in the direction of making it a requirement for hosts that <em>any</em> method of registering a callback which might get run out of the current microtask tick must wrap the callback with the async context which was present when the callback was registered","m.new_content":{"body":"I am open to arguments of that form, but those would incline me in the direction of making it a requirement for hosts that _any_ method of registering a callback which might get run out of the current microtask tick must wrap the callback with the async context which was present when the callback was registered","format":"org.matrix.custom.html","formatted_body":"I am open to arguments of that form, but those would incline me in the direction of making it a requirement for hosts that <em>any</em> method of registering a callback which might get run out of the current microtask tick must wrap the callback with the async context which was present when the callback was registered","msgtype":"m.text"},"m.relates_to":{"event_id":"$KF_b-3_vZoYZJkPW5Y-DAH5k1iqQBzeiyYjlj3Hy8Rw","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675271351364,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$eSpVs74mM9T1c7V9dkanFrD4wI1Z2pujFQk0RzlcFEE"},
{"content":{"body":"> <@bakkot:matrix.org> that is: the thing you mean is \"without this it will be too inconvenient to be practical\", not \"without this it will lack some guarantee I rely on\", right?\n\nThen yes. Requiring manual wrap for `.then` is too inconvenient to be practical, and too confusing for users who have been told for years that `async`/`await` is a syntactic transformation over `.then`. Adding something new to `await` would break that mental model.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$-z0y1OnVP7Cixeaz3Awsk0YRCLYbUFY_kkJFcoLuJ4A?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@bakkot:matrix.org\">@bakkot:matrix.org</a><br>that is: the thing you mean is \"without this it will be too inconvenient to be practical\", not \"without this it will lack some guarantee I rely on\", right?</blockquote></mx-reply>Then yes. Requiring manual wrap for <code>.then</code> is too inconvenient to be practical, and too confusing for users who have been told for years that <code>async</code>/<code>await</code> is a syntactic transformation over <code>.then</code>. Adding something new to <code>await</code> would break that mental model.","m.relates_to":{"m.in_reply_to":{"event_id":"$-z0y1OnVP7Cixeaz3Awsk0YRCLYbUFY_kkJFcoLuJ4A"}},"msgtype":"m.text"},"ts":1675271404707,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$-OHZXPCaWeZ7fAk3Ma7XRwdxqwEDFIpzHwRL93WG04c"},
{"content":{"body":"Who has permissions to add rooms to the TC39 space?","msgtype":"m.text"},"ts":1675271417569,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$FE-7E4Ho_rNDlpcGOqsTYu_1d2PvaCeuFc3Ad4whCeY"},
{"content":{"body":"We'd like to add the existing async context room","msgtype":"m.text"},"ts":1675271423952,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$qc77umVB_QWJsGPVyllWXvMHt87uKukMsYudAiK-_lc"},
{"content":{"body":"Jordan said he'd do it just above","msgtype":"m.text"},"ts":1675271468298,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$Tp_IFIlpCYDQrg3IT4-AWrW8HuwDFDmBI7Hq66V1p8A"},
{"content":{"body":"(I wouldn't mind if all delegates had these sorts of permissions)","msgtype":"m.text"},"ts":1675271550279,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$wWK5m0A3jg9SCmd0hYHNHIBL5l9ckNN30R6mcrODh1Q"},
{"content":{"body":"sorry, I had missed this comment. thanks, Jordan!","m.relates_to":{"event_id":"$J0ENr_Rlktqnu5GwPwR7w76k2bs7e6mf0BDcviQkwVA","is_falling_back":true,"m.in_reply_to":{"event_id":"$rSwbosBcOh8pN09jU7zXJMPx64ftPeND-m-umgG3az8"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675271582373,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$W0bdM_C3b-LjkzGJiNTSPiBR-9hjtKCwkeXqY_LfNJg"},
{"content":{"body":"> <@bakkot:matrix.org> (like I said, I'm ok with \"all\" or \"none\", just not \"some\")\n\nI don't imagine \"all\" is practical either, not without running afoul of shu's performance concerns. My position is that it should be considered on a case-by-case basis by hosts whether async context should automatically flow. Perhaps we can provide guidance on what cases make sense, but I'm not sure we could mandate \"all\".","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$_qv3yqz6pcUjEkw6B3ynRZERRXoNsCj06fpd-3Si4ms?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@bakkot:matrix.org\">@bakkot:matrix.org</a><br>(like I said, I&#39;m ok with &quot;all&quot; or &quot;none&quot;, just not &quot;some&quot;)</blockquote></mx-reply>I don't imagine &quot;all&quot; is practical either, not without running afoul of <a href=\"https://matrix.to/#/@shuyuguo:matrix.org\">shu</a>'s performance concerns. My position is that it should be considered on a case-by-case basis by hosts whether async context should automatically flow. Perhaps we can provide guidance on what cases make sense, but I'm not sure we could mandate &quot;all&quot;.","m.relates_to":{"m.in_reply_to":{"event_id":"$_qv3yqz6pcUjEkw6B3ynRZERRXoNsCj06fpd-3Si4ms"}},"msgtype":"m.text"},"ts":1675271644961,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$w3ADwbVe3DzcLxrpHZJmkguqkgvBPhj0lzHMIPNXX70"},
{"content":{"body":"But within ECMA-262, it should _at least_ flow through the built-in control-flow objects we have (namely built-in `Promise` and `Generator` objects).","format":"org.matrix.custom.html","formatted_body":"But within ECMA-262, it should <em>at least</em> flow through the built-in control-flow objects we have (namely built-in <code>Promise</code> and <code>Generator</code> objects).","msgtype":"m.text"},"ts":1675271739705,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$vyo4TrtZKALHzg7nLtHtv1vfVVtGVbDZY8hKYuUsk30"},
{"content":{"body":"If we can't mandate \"all\", we can't do the \"cannot escape context\" thing Justin said is a requirement","msgtype":"m.text"},"ts":1675271938472,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$dRgUnNCQVYKpzhaJZ4stDbKXpHtD3PKi_fRMrCFzq5Q"},
{"content":{"body":"\"cannot escape the context\" is something which a particular *environment* can give semantics to","format":"org.matrix.custom.html","formatted_body":"&quot;cannot escape the context&quot; is something which a particular <em>environment</em> can give semantics to","msgtype":"m.text"},"ts":1675271979371,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$A1E1wD2wWBSbfwp3Bl8rg7j5Yf2V3OmnyEvS6HawyP0"},
{"content":{"body":"it is not a meaningful thing at our level","msgtype":"m.text"},"ts":1675271984368,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$-VyB-Q8aw3NSuk2MldPhH36JJmU4TEfUbqOHN2zkSDI"},
{"content":{"body":"we just have a couple cases to decide on","msgtype":"m.text"},"ts":1675271996669,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$coyX5Zt3Wszwy_HiighKOkmXrqMJSdBfN-H3bIX0ebk"},
{"content":{"body":"it is certainly meaningful within Bloomberg, and has been implemented with this case-by-case approach","msgtype":"m.text"},"ts":1675272016638,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$SNuF3yokTAFB7BFXoq4kLKG3mg3RsUskwi6m9k2MIMw"},
{"content":{"body":"If we're not worried about whether or not it's _possible_ to escape the context, then it's just a question of ergonomics, and that's something which we can discuss - I continue to be of the opinion that requiring _every library author in the world_ to think about AsyncContexts is worse ergonomics than making people who are doing fancy things with `.then` _and also_ with AsyncContexts think about AsyncContexts.","format":"org.matrix.custom.html","formatted_body":"If we're not worried about whether or not it's <em>possible</em> to escape the context, then it's just a question of ergonomics, and that's something which we can discuss - I continue to be of the opinion that requiring <em>every library author in the world</em> to think about AsyncContexts is worse ergonomics than making people who are doing fancy things with <code>.then</code> <em>and also</em> with AsyncContexts think about AsyncContexts.","msgtype":"m.text"},"ts":1675272065805,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$CzoVV2vrdcNrSm-ICZq4zrzBmlSb3D3dToW15Qn-ax4"},
{"content":{"body":" * If we're not worried about whether or not it's _possible_ to escape the context, then it's just a question of ergonomics, and that's something which we can discuss - I continue to be of the opinion that requiring _every library author in the world_ to think about AsyncContexts is worse ergonomics than making people who are doing fancy things with `.then` _and also_ with AsyncContexts think about eAsyncContexts.","format":"org.matrix.custom.html","formatted_body":" * If we're not worried about whether or not it's <em>possible</em> to escape the context, then it's just a question of ergonomics, and that's something which we can discuss - I continue to be of the opinion that requiring <em>every library author in the world</em> to think about AsyncContexts is worse ergonomics than making people who are doing fancy things with <code>.then</code> <em>and also</em> with AsyncContexts think about eAsyncContexts.","m.new_content":{"body":"If we're not worried about whether or not it's _possible_ to escape the context, then it's just a question of ergonomics, and that's something which we can discuss - I continue to be of the opinion that requiring _every library author in the world_ to think about AsyncContexts is worse ergonomics than making people who are doing fancy things with `.then` _and also_ with AsyncContexts think about eAsyncContexts.","format":"org.matrix.custom.html","formatted_body":"If we're not worried about whether or not it's <em>possible</em> to escape the context, then it's just a question of ergonomics, and that's something which we can discuss - I continue to be of the opinion that requiring <em>every library author in the world</em> to think about AsyncContexts is worse ergonomics than making people who are doing fancy things with <code>.then</code> <em>and also</em> with AsyncContexts think about eAsyncContexts.","msgtype":"m.text"},"m.relates_to":{"event_id":"$CzoVV2vrdcNrSm-ICZq4zrzBmlSb3D3dToW15Qn-ax4","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675272076247,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$e2zin07ZShKBUsiV_5rnKtgIuxE4fLBiGu91bs2Y38c"},
{"content":{"body":" * If we're not worried about whether or not it's _possible_ to escape the context, then it's just a question of ergonomics, and that's something which we can discuss - I continue to be of the opinion that requiring _every library author in the world_ to think about AsyncContexts is worse ergonomics than making people who are doing fancy things with `.then` _and also_ with AsyncContexts think about AsyncContexts.","format":"org.matrix.custom.html","formatted_body":" * If we're not worried about whether or not it's <em>possible</em> to escape the context, then it's just a question of ergonomics, and that's something which we can discuss - I continue to be of the opinion that requiring <em>every library author in the world</em> to think about AsyncContexts is worse ergonomics than making people who are doing fancy things with <code>.then</code> <em>and also</em> with AsyncContexts think about AsyncContexts.","m.new_content":{"body":"If we're not worried about whether or not it's _possible_ to escape the context, then it's just a question of ergonomics, and that's something which we can discuss - I continue to be of the opinion that requiring _every library author in the world_ to think about AsyncContexts is worse ergonomics than making people who are doing fancy things with `.then` _and also_ with AsyncContexts think about AsyncContexts.","format":"org.matrix.custom.html","formatted_body":"If we're not worried about whether or not it's <em>possible</em> to escape the context, then it's just a question of ergonomics, and that's something which we can discuss - I continue to be of the opinion that requiring <em>every library author in the world</em> to think about AsyncContexts is worse ergonomics than making people who are doing fancy things with <code>.then</code> <em>and also</em> with AsyncContexts think about AsyncContexts.","msgtype":"m.text"},"m.relates_to":{"event_id":"$CzoVV2vrdcNrSm-ICZq4zrzBmlSb3D3dToW15Qn-ax4","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675272088854,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$vMlQJfmN1tRch_Tmz017xgrS8ViWNVVGfcT40NvMMBw"},
{"content":{"body":"I am a lot more OK with making people who are explicitly using AsyncContexts think about them than making everyone else think about them.","msgtype":"m.text"},"ts":1675272119219,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$DvsopGhudaEFM7U5bqyjBVAwR2bVcILXj7x_g0HN4uc"},
{"content":{"body":"> <@bakkot:matrix.org> I am a lot more OK with making people who are explicitly using AsyncContexts think about them than making everyone else think about them.\n\nThis just isn't the way they are used; the AsyncContext flows through a whole environment automatically and this is the entire point.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$DvsopGhudaEFM7U5bqyjBVAwR2bVcILXj7x_g0HN4uc?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@bakkot:matrix.org\">@bakkot:matrix.org</a><br>I am a lot more OK with making people who are explicitly using AsyncContexts think about them than making everyone else think about them.</blockquote></mx-reply>This just isn't the way they are used; the AsyncContext flows through a whole environment automatically and this is the entire point.","m.relates_to":{"m.in_reply_to":{"event_id":"$DvsopGhudaEFM7U5bqyjBVAwR2bVcILXj7x_g0HN4uc"}},"msgtype":"m.text"},"ts":1675272154143,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$WFHFnyAjaHnu8tAseKikW6mWMr3OdZpcAcBhaOxknb8"},
{"content":{"body":"> <@bakkot:matrix.org> If we can't mandate \"all\", we can't do the \"cannot escape context\" thing Justin said is a requirement\n\nOur platform only has so many ways for devs to do async tasks, so just having `await`/`Promise`/`setTimeout`/`setInterval` is sufficient for us to guarantee our platform contexts is preserved","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$dRgUnNCQVYKpzhaJZ4stDbKXpHtD3PKi_fRMrCFzq5Q?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@bakkot:matrix.org\">@bakkot:matrix.org</a><br>If we can&#39;t mandate &quot;all&quot;, we can&#39;t do the &quot;cannot escape context&quot; thing Justin said is a requirement</blockquote></mx-reply>Our platform only has so many ways for devs to do async tasks, so just having <code>await</code>/<code>Promise</code>/<code>setTimeout</code>/<code>setInterval</code> is sufficient for us to guarantee our platform contexts is preserved","m.relates_to":{"m.in_reply_to":{"event_id":"$dRgUnNCQVYKpzhaJZ4stDbKXpHtD3PKi_fRMrCFzq5Q"}},"msgtype":"m.text"},"ts":1675272178013,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$844jGS4THn_M5QVPLIGZs-wyP6XdZymIWO_UlVe6CFQ"},
{"content":{"body":"The dev could have their own contexts inside ours, but it'd be impossible for them to escape ours","msgtype":"m.text"},"ts":1675272192941,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$IoB_HQnr-QWHghTzX8ftbm5_3SrOrkjCnhUeorDHBTE"},
{"content":{"body":"> <@littledan:matrix.org> This just isn't the way they are used; the AsyncContext flows through a whole environment automatically and this is the entire point.\n\nOnly if we require of hosts that every mechanism of scheduling callbacks flows AsyncContexts, including event listeners and unhandled promise rejection handlers and so on.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$WFHFnyAjaHnu8tAseKikW6mWMr3OdZpcAcBhaOxknb8?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@littledan:matrix.org\">@littledan:matrix.org</a><br>This just isn't the way they are used; the AsyncContext flows through a whole environment automatically and this is the entire point.</blockquote></mx-reply>Only if we require of hosts that every mechanism of scheduling callbacks flows AsyncContexts, including event listeners and unhandled promise rejection handlers and so on.","m.relates_to":{"m.in_reply_to":{"event_id":"$WFHFnyAjaHnu8tAseKikW6mWMr3OdZpcAcBhaOxknb8"}},"msgtype":"m.text"},"ts":1675272241662,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$YUPAaclc744fNEEyoH-PPmZeRf3oMF0ENT-DQV7LC9w"},
{"content":{"body":"it's not something we require, it's something we allow","msgtype":"m.text"},"ts":1675272279291,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$RLlemhzrnd9JZ3C_FWs3dPlZSt3hahyLm-LC22k_DVo"},
{"content":{"body":"That's what I keep saying - if it is in fact a requirement that it flows through the whole environment automatically, then the _ergonomic_ differences between Promise.prototype.then and addEventListener just aren't relevant.","format":"org.matrix.custom.html","formatted_body":"That's what I keep saying - if it is in fact a requirement that it flows through the whole environment automatically, then the <em>ergonomic</em> differences between Promise.prototype.then and addEventListener just aren't relevant.","msgtype":"m.text"},"ts":1675272280691,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$yrSSMojWVK1qFFyKkg5UXEUqIgBlqpRh551VhZzA1bs"},
{"content":{"body":"maybe we should shift this conversation to the AsyncContext room?","msgtype":"m.text"},"ts":1675272309867,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$JcyJ8V8qSgOTpDH-bjXTY8dXejUrvRZ6FXF98BjPib4"},
{"content":{"body":"And if it's not a requirement that the context flows automatically, then library authors now have to think about async contexts all the time.","msgtype":"m.text"},"ts":1675272315955,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$MI-jbF8XybUPx6CIZiG7JSUWJwKH_JLHEIj6S3PSLl0"},
{"content":{"body":"Sure.","msgtype":"m.text"},"ts":1675272316635,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$MrJSdF_XDe0oFMfkuuxlEIJXqTqEH_CtomQsZ0_c75M"},
{"content":{"body":"I also opened https://github.com/legendecas/proposal-async-context/issues/22 for anyone who wants to follow along.","msgtype":"m.text"},"ts":1675272331829,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$4RqQFwVfdhRwbf9PbMRsGSxrbkX3Ranc1l4uJPbYtRI"},
{"content":{"body":"> <@bakkot:matrix.org> And if it's not a requirement that the context flows automatically, then library authors now have to think about async contexts all the time.\n\nYes. Actually, having just one mechanism here as opposed to several should simplify things for library authors who are already living this reality in environments with a version of this feature.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$MI-jbF8XybUPx6CIZiG7JSUWJwKH_JLHEIj6S3PSLl0?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@bakkot:matrix.org\">@bakkot:matrix.org</a><br>And if it&#39;s not a requirement that the context flows automatically, then library authors now have to think about async contexts all the time.</blockquote></mx-reply>Yes. Actually, having just one mechanism here as opposed to several should simplify things for library authors who are already living this reality in environments with a version of this feature.","m.relates_to":{"m.in_reply_to":{"event_id":"$MI-jbF8XybUPx6CIZiG7JSUWJwKH_JLHEIj6S3PSLl0"}},"msgtype":"m.text"},"ts":1675272419594,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$qDitNGHtZj07c00fU5IpfG136GUV-riQIiA5bVqLaxY"},
{"content":{"body":"Let's continue the conversation in the async contexts room?","msgtype":"m.text"},"ts":1675272484903,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$4Cg5OTgFawNRNCIMZRFNxfKI78ZcuDMeWff7YaF04CA"},
{"content":{"body":"Also, as `AsyncDisposableStack` is another case of a reified async control-flow mechanism (representing an imperative version of `using await`), I would also expect that the async context would automatically flow to the registered `[Symbol.dispose]()` method or `adopt`/`defer` callbacks when the stack itself is disposed.","format":"org.matrix.custom.html","formatted_body":"Also, as <code>AsyncDisposableStack</code> is another case of a reified async control-flow mechanism (representing an imperative version of <code>using await</code>), I would also expect that the async context would automatically flow to the registered <code>[Symbol.dispose]()</code> method or <code>adopt</code>/<code>defer</code> callbacks when the stack itself is disposed.","msgtype":"m.text"},"ts":1675272518664,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$AYUETlEa7EH7yj81jvlAzpvDOU8BySwbjWVJKLX3510"},
{"content":{"body":"Not when the stack is disposed manually, surely?","msgtype":"m.text"},"ts":1675272589995,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$i582n4bNF4tzo6uuws5f5jnNlMsKzv342Gz3GE0urBY"},
{"content":{"body":"Why would that not be the case? That would certainly be the case if calling `dispose()` on the synchronous `DisposableStack`, would it not? ","format":"org.matrix.custom.html","formatted_body":"Why would that not be the case? That would certainly be the case if calling <code>dispose()</code> on the synchronous <code>DisposableStack</code>, would it not?","msgtype":"m.text"},"ts":1675273417226,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$jDpkmr0FHAS_1hQg5xpR5keph7saytNeN5ad1u_KKAc"},
{"content":{"body":"Though it could be that the automatic capture might need to occur at the point the resource is registered. I admit, it is something that will need to be investigated.","msgtype":"m.text"},"ts":1675274288008,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$pDI299aw5R3GdtxgIbPPyFDC0gjh2wXFhs9CVCoHEPM"},
{"content":{"body":" * Though it could be that the automatic capture might need to occur at the point the resource is registered. I admit, it is something that will need to be investigated.","m.new_content":{"body":"Though it could be that the automatic capture might need to occur at the point the resource is registered. I admit, it is something that will need to be investigated.","msgtype":"m.text"},"m.relates_to":{"event_id":"$pDI299aw5R3GdtxgIbPPyFDC0gjh2wXFhs9CVCoHEPM","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675274295026,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$LUvw99Khn7fLjTYGMRBznOzYOZQyHdNQkblpal0i5uI"},
{"content":{"body":"My connection may have dropped","msgtype":"m.text"},"ts":1675274537398,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$BibcRGKnP3ZaSX7---bc4n1to6LBTdonO_8qFDFN6WE"},
{"content":{"body":"Sorry, it looks like I just lost my internet connection","msgtype":"m.text"},"ts":1675274586935,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$VSuRg-nQrp7KmeG_s55ZnjmngghHFH0ahNEVRFEfGuQ"},
{"content":{"body":"rbuckton: would you be able to reconnect?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@rbuckton:matrix.org\">rbuckton</a>: would you be able to reconnect?","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"rbuckton: would you be able to reconnect?","mimetype":"text/plain"},{"body":"<a href=\"https://matrix.to/#/@rbuckton:matrix.org\">rbuckton</a>: would you be able to reconnect?","mimetype":"text/html"}]},"ts":1675274611385,"senderName":"ryzokuken","senderId":"@usharma:igalia.com","id":"$bqMLDwPLljxEiRwPvfR_OJ6PSn1nKF-jOgxYE7lOgsU"},
{"content":{"body":"I just restarted the router and am waiting for a connection","msgtype":"m.text"},"ts":1675274724679,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$iHp8xeGZ2gPZ1RCGECI0H36JhfGu8CefuRv7M3MZZU4"},
{"content":{"body":"It does not look like it will be back up quickly. I can try to connect from my phone if someone else can run the slides","msgtype":"m.text"},"ts":1675274758997,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$ll9q-zquiuIyWIFzD6C423xAEhw3E8SsFN63UER_rXE"},
{"content":{"body":"https://tc39.es/proposal-symbol-predicates/","msgtype":"m.text"},"ts":1675275080481,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$7GlVoWcyOeA2ZgN94QrRsbEBOl2yCPVZhvj--VWYwls"},
{"content":{"body":"Rob Palmer: Is there a plan to come back to the demoting import assertions to stage 2 in this meeting?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@robpalme:matrix.org\">Rob Palmer</a>: Is there a plan to come back to the demoting import assertions to stage 2 in this meeting?","msgtype":"m.text"},"ts":1675275420827,"senderName":"msaboff","senderId":"@msaboff:matrix.org","id":"$UoxN3CdD3kzJw_4qH-3kYSL03ZA3kfbvYJqiLqRrkDU"},
{"content":{"body":"msaboff: We want to discuss import assertions tomorrow, but we're still drafting what would be proposed.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@msaboff:matrix.org\">msaboff</a>: We want to discuss import assertions tomorrow, but we're still drafting what would be proposed.","msgtype":"m.text"},"ts":1675275590066,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$HiUOvxHGPBARdDHSufXf0TyR5uNzvyoN6b1MeYAtf4w"},
{"content":{"body":"can't see the screen, is that only me?","msgtype":"m.text"},"ts":1675275609934,"senderName":"HE Shi-Jun","senderId":"@haxjs:matrix.org","id":"$tnbYoVUK7p9bnCoaI6KQmmrexPIIlJJaiqTgQ9pGVtw"},
{"content":{"body":"I am now back online, my apologies for the interruption.","msgtype":"m.text"},"ts":1675275660906,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$FmbZFFDnroKhXKLT0xvyb07L9V_JOndKSE7TqHI4j2Y"},
{"content":{"body":"I can see","m.relates_to":{"event_id":"$tnbYoVUK7p9bnCoaI6KQmmrexPIIlJJaiqTgQ9pGVtw","is_falling_back":true,"m.in_reply_to":{"event_id":"$tnbYoVUK7p9bnCoaI6KQmmrexPIIlJJaiqTgQ9pGVtw"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675275670993,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$YM-okQACtkkScZ7rX3SX1iPwuHMTXjUfeI_sb3s6jPA"},
{"content":{"body":"reconnected and now i also see","m.relates_to":{"event_id":"$tnbYoVUK7p9bnCoaI6KQmmrexPIIlJJaiqTgQ9pGVtw","is_falling_back":true,"m.in_reply_to":{"event_id":"$YM-okQACtkkScZ7rX3SX1iPwuHMTXjUfeI_sb3s6jPA"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675275702923,"senderName":"HE Shi-Jun","senderId":"@haxjs:matrix.org","id":"$Ug2iSqMVl_gPRxSF-srzxd53IR4NC75lcWrFwLR_TyQ"},
{"content":{"body":"shu: current semantics is the class declaration is decorated, and potentially replaced, affecting both the local and exported binding.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@shuyuguo:matrix.org\">shu</a>: current semantics is the class declaration is decorated, and potentially replaced, affecting both the local and exported binding.","msgtype":"m.text"},"ts":1675275896488,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$YNIS0HijLck69NelM01al8ltBKourtgtQyVsd4QtyKc"},
{"content":{"body":"then what's the footgun?","msgtype":"m.text"},"ts":1675275909101,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$no_0EBvqwD_5SNsvrB2QCgfh1qhI_W-rdVQ1B8qRLpk"},
{"content":{"body":"the footgun as daniel says depends on the local being undecorated but the export being decorated","msgtype":"m.text"},"ts":1675275924111,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$DUz3VfP_lTxB3Xf0uYyAFDblkX5OIUYBWYYKx8gT3Sk"},
{"content":{"body":"The biggest reason why we did not change this back in stage two was the potential do decorate _both_ the export _and_ the class separately.","format":"org.matrix.custom.html","formatted_body":"The biggest reason why we did not change this back in stage two was the potential do decorate <em>both</em> the export <em>and</em> the class separately.","msgtype":"m.text"},"ts":1675275941770,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$JuXdf0HVM9yYE84b3aZthIpAyBkv85NCdoBHAHNkXPo"},
{"content":{"body":"oh okay i think i get it, let me try","msgtype":"m.text"},"ts":1675275959347,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$SeunUpgvUjo7fQw4-LjcPwZjojwJge_En4rMztEhouk"},
{"content":{"body":"the reason we have export-decorator ordering is for the _possibility_ of distinguishing decorated export-only or decorated local-only","format":"org.matrix.custom.html","formatted_body":"the reason we have export-decorator ordering is for the <em>possibility</em> of distinguishing decorated export-only or decorated local-only","msgtype":"m.text"},"ts":1675275987217,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$GE2GxS7JzE8m2j7YYQGyvlt69p3njRbhY_yA3Sw0ddk"},
{"content":{"body":"do you figure I could write a codemod to move the `export` keyword before the decorators before this topic finishes while also fixing up the notes","format":"org.matrix.custom.html","formatted_body":"do you figure I could write a codemod to move the <code>export</code> keyword before the decorators before this topic finishes while also fixing up the notes","msgtype":"m.text"},"ts":1675275992164,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$0Z-JDc1V3FtGXORVIl2TsdWR6lU10rq6SSptCvNmCKE"},
{"content":{"body":"it can't be that hard","msgtype":"m.text"},"ts":1675275994738,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$BdkjiMePCvMKWQTux1g8ZUgrDhtaYNAs0Qy9vy2y-Ys"},
{"content":{"body":"and you're saying, not only is there no demand for that distinguishing, it is a footgun to distinguish","msgtype":"m.text"},"ts":1675276003659,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$pW61k8nNAVIsnCJs31MheGREcSyv36Ns5elEiiXRXfo"},
{"content":{"body":"The investigation I did into \"export decorators\" led to the conclusion that it isn't something that could have any kind of meaningful semantics.","msgtype":"m.text"},"ts":1675276016019,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$uw1pvPytpXg44oVd0mIDOq5L9DSndG4a6HwMcgMKaCE"},
{"content":{"body":"Yes.","msgtype":"m.text"},"ts":1675276021749,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$dzlXDxVtkY8citUQDJYfRnuT0YrgQmFgC4xoT62gjA4"},
{"content":{"body":"that's not the only reason tho. it's also because of some who believe the decorator \"should\" come next to the thing it's decorating, instead of an unrelated keyword being injected between them","format":"org.matrix.custom.html","formatted_body":"that's not the only reason tho. it's also because of some who believe the decorator &quot;should&quot; come next to the thing it's decorating, instead of an unrelated keyword being injected between them","msgtype":"m.text","m.relates_to":{"m.in_reply_to":{"event_id":"$GE2GxS7JzE8m2j7YYQGyvlt69p3njRbhY_yA3Sw0ddk"}}},"ts":1675276061532,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$P0C3QjnA6XTyAxblTi0tjpWvO3g3a6a6cehQl4S7auA"},
{"content":{"body":"in GNOME, we had a strong use case for the local binding being the decorated class, not the undecorated one. although we seem to have managed to rewrite things so it doesn't matter. I gave more details in https://github.com/tc39/proposal-decorators/issues/441","msgtype":"m.text","org.matrix.msc1767.text":"in GNOME, we had a strong use case for the local binding being the decorated class, not the undecorated one. although we seem to have managed to rewrite things so it doesn't matter. I gave more details in https://github.com/tc39/proposal-decorators/issues/441"},"ts":1675276096117,"senderName":"ptomato","senderId":"@pchimento:igalia.com","id":"$Kuun17Zagstb1bWW8O7lkBY1kMPDZD-ZYh0Mb2-rYGA"},
{"content":{"body":"> <@shuyuguo:matrix.org> the reason we have export-decorator ordering is for the _possibility_ of distinguishing decorated export-only or decorated local-only\n\n * that's not the only reason tho. it's also because of some who believe the decorator \"should\" come next to the thing it's decorating, instead of an unrelated keyword being injected between them","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$GE2GxS7JzE8m2j7YYQGyvlt69p3njRbhY_yA3Sw0ddk?via=matrix.org&amp;via=igalia.com&amp;via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@shuyuguo:matrix.org\">@shuyuguo:matrix.org</a><br>the reason we have export-decorator ordering is for the <em>possibility</em> of distinguishing decorated export-only or decorated local-only</blockquote></mx-reply> * that's not the only reason tho. it's also because of some who believe the decorator &quot;should&quot; come next to the thing it's decorating, instead of an unrelated keyword being injected between them","m.new_content":{"body":"that's not the only reason tho. it's also because of some who believe the decorator \"should\" come next to the thing it's decorating, instead of an unrelated keyword being injected between them","format":"org.matrix.custom.html","formatted_body":"that's not the only reason tho. it's also because of some who believe the decorator &quot;should&quot; come next to the thing it's decorating, instead of an unrelated keyword being injected between them","msgtype":"m.text"},"m.relates_to":{"event_id":"$P0C3QjnA6XTyAxblTi0tjpWvO3g3a6a6cehQl4S7auA","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675276108092,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$9sVUL4xDMvoulZpOXCt7UPOi90fm-a2qvJ-ROJGnIOM"},
{"content":{"body":"by the local binding, do you mean the binding within the class?","msgtype":"m.text"},"ts":1675276150021,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$Mc6EMGVrCYnljpAqN5QauwdSYQytJTzbnOt-TTzkoTc"},
{"content":{"body":"littledan: no, the unexported binding","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@littledan:matrix.org\">littledan</a>: no, the unexported binding","msgtype":"m.text"},"ts":1675276163371,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$eCISn2L-8INzWUI1VW0zjxu07dzGfhFZEf8u_eOyRjs"},
{"content":{"body":"within the module","msgtype":"m.text"},"ts":1675276165647,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$EcmSVekG8jK3c4UrFDy8izKZIC3lnDcflQKRf2sUxO0"},
{"content":{"body":"> <@shuyuguo:matrix.org> littledan: no, the unexported binding\n\nyeah I guess that part is clear","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$eCISn2L-8INzWUI1VW0zjxu07dzGfhFZEf8u_eOyRjs?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@shuyuguo:matrix.org\">@shuyuguo:matrix.org</a><br><a href=\"https://matrix.to/#/@littledan:matrix.org\">littledan</a>: no, the unexported binding</blockquote></mx-reply>yeah I guess that part is clear","m.relates_to":{"m.in_reply_to":{"event_id":"$eCISn2L-8INzWUI1VW0zjxu07dzGfhFZEf8u_eOyRjs"}},"msgtype":"m.text"},"ts":1675276183039,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$DD_QdZPh5FpV7hsyX4YwsMchBpqPH2pPAwSMUX2J1_I"},
{"content":{"body":"I assumed the binding would be decorated either way, and \"export decorators\" would be decorators that applied specifically _to exports_ in some way","format":"org.matrix.custom.html","formatted_body":"I assumed the binding would be decorated either way, and &quot;export decorators&quot; would be decorators that applied specifically <em>to exports</em> in some way","msgtype":"m.text"},"ts":1675276195926,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$h2u3VlPsmjk7-ePo-8MaKJrJrxfF84vZ9HlU2wcrnyo"},
{"content":{"body":"yes, that","msgtype":"m.text"},"ts":1675276211741,"senderName":"Richard Gibson","senderId":"@gibson042:matrix.org","id":"$x-aLmGpMgrRxXc98z0Iy1lLo5yZZ3FGh8HvQeju2TIA"},
{"content":{"body":"okay i just don't have an intuition here","msgtype":"m.text"},"ts":1675276211865,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$y6UHzQ_98RJrdlLqvzLc4-KDv_ipaTUag6PQRcQsvE4"},
{"content":{"body":"bakkot: ah okay","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@bakkot:matrix.org\">bakkot</a>: ah okay","msgtype":"m.text"},"ts":1675276222678,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$w6x3t07QOJmbijVZv5e-ZiZ0_0KP5oHdPiErTxfuAYQ"},
{"content":{"body":"oh, I meant the binding within the class. disregard my comment then","msgtype":"m.text","org.matrix.msc1767.text":"oh, I meant the binding within the class. disregard my comment then"},"ts":1675276267649,"senderName":"ptomato","senderId":"@pchimento:igalia.com","id":"$3uBxn1zz7GZZ_H36zNOfeEmWw6RBExd9E9wXpthAJ2I"},
{"content":{"body":"We definitely had at least 8 months of plenary discussion about decorator/export ordering","msgtype":"m.text"},"ts":1675276269216,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$Dy49V11ipOqvRV1a_KvCGhkL9Y0ur0SPFv8Er2evtqs"},
{"content":{"body":"in addition to the breakout groups that Jordan mentions","msgtype":"m.text"},"ts":1675276281336,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$sNNggnPKFtYg4sCqIKb7Pn5Ui8XghIIXKob_-o392lU"},
{"content":{"body":"and in addition to extensive discussion in the regular decorator calls","msgtype":"m.text"},"ts":1675276293763,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$oHgxQ04luRh_gBn77BK180MfFGpXik98O2LMXj_0QCA"},
{"content":{"body":"i remember the breakout yes","msgtype":"m.text"},"ts":1675276297489,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$nEm58omt6d_GE1ne1h3RcIbf1GLFfyz14ACB-EINn18"},
{"content":{"body":"That doesn't mean it's bad to bring up!","msgtype":"m.text"},"ts":1675276333394,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$kX-F-RK8eZd_iTJpb7IZZrUjd76Xz4iUzKIeWmHZSrg"},
{"content":{"body":"> <@bakkot:matrix.org> I assumed the binding would be decorated either way, and \"export decorators\" would be decorators that applied specifically _to exports_ in some way\n\n(e.g. as jrl says on the queue, make the binding writable from the outside which would be kind of neat I guess)","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$h2u3VlPsmjk7-ePo-8MaKJrJrxfF84vZ9HlU2wcrnyo?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@bakkot:matrix.org\">@bakkot:matrix.org</a><br>I assumed the binding would be decorated either way, and \"export decorators\" would be decorators that applied specifically <em>to exports</em> in some way</blockquote></mx-reply>(e.g. as jrl says on the queue, make the binding writable from the outside which would be kind of neat I guess)","m.relates_to":{"m.in_reply_to":{"event_id":"$h2u3VlPsmjk7-ePo-8MaKJrJrxfF84vZ9HlU2wcrnyo"}},"msgtype":"m.text"},"ts":1675276334547,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$UC-oiazGP0wR_0Uwji8rVvHSTC2Y0X992tTCoUeAdyU"},
{"content":{"body":"man I don't care that much about this question but the idea that `export` is the same kind of thing as `async` is _wild_ to me","format":"org.matrix.custom.html","formatted_body":"man I don't care that much about this question but the idea that <code>export</code> is the same kind of thing as <code>async</code> is <em>wild</em> to me","msgtype":"m.text"},"ts":1675276388175,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$-6YaX_N-GrYwIq7ZiRu3yna2DDTlX21ieFddjtNEFTo"},
{"content":{"body":"what happens to export default? ","msgtype":"m.text"},"ts":1675276395118,"senderName":"leobalter","senderId":"@leobalter:matrix.org","id":"$C3EGyMNTtzvSif1-TiYqiT2NGM9-_Oz6BlyEKX8Wvc8"},
{"content":{"body":"rbuckton: ^^","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@rbuckton:matrix.org\">rbuckton</a>: ^^","msgtype":"m.text"},"ts":1675276409705,"senderName":"leobalter","senderId":"@leobalter:matrix.org","id":"$rCAi08hzcLVyrRDaFUV1xRMYhCa-zc2hc6P7sG1My1E"},
{"content":{"body":"`@dec export default class {}`","format":"org.matrix.custom.html","formatted_body":"<code>@dec export default class {}</code>","msgtype":"m.text"},"ts":1675276430416,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$NOJemogGtAaQ9sxNhs1FecnNsepVGgnorbSiEj0nc7Y"},
{"content":{"body":"Justin Ridgewell: it's a strawperson (meaning in the hypothetical sense) footgun","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@jridgewell:matrix.org\">Justin Ridgewell</a>: it's a strawperson (meaning in the hypothetical sense) footgun","msgtype":"m.text"},"ts":1675276431505,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$HTGwtB4_KaRmx07hyEbzVqN6rsh4Bvyp-GTaJz0wRVE"},
{"content":{"body":"like, nothing has this footgun today, but if we started distinguishing semantics depending on where the decorator appears, then it becomes a footgun","msgtype":"m.text"},"ts":1675276451404,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$-PoNAHiIJ7RZ33YBMfRrlAGfzqmYbeVLbl8YuZHHXzA"},
{"content":{"body":"does anyone know offhand of a library which is using `@dec export class {}` style decorators so I can develop my codemod against it ","format":"org.matrix.custom.html","formatted_body":"does anyone know offhand of a library which is using <code>@dec export class {}</code> style decorators so I can develop my codemod against it","msgtype":"m.text"},"ts":1675276539866,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$tMsYxgAuJWpMal_1qh3YDMWtM1ru5Torf9FAzklSz1s"},
{"content":{"body":"bakkot: it's a good question, i added a q item","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@bakkot:matrix.org\">bakkot</a>: it's a good question, i added a q item","msgtype":"m.text"},"ts":1675276568928,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$XBxgcKhJPyfbAYMqGB4QuRaYewcRHyMUK0mj73iJkhc"},
{"content":{"body":"is anyone actually advocating for the distinct semantics? Or is this just about syntax placement?","msgtype":"m.text"},"ts":1675276575727,"senderName":"leobalter","senderId":"@leobalter:matrix.org","id":"$FdNLmAw3xBruqbVs1O02zc-hIirFYjRmdWJH1e5VTv8"},
{"content":{"body":"`nest`, apparently","format":"org.matrix.custom.html","formatted_body":"<code>nest</code>, apparently","msgtype":"m.text"},"ts":1675276691555,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$hkwbyZI_hUnV3yfj1Rsg6J5bTbl3jbKV6IqjdTIBcy0"},
{"content":{"body":"https://github.com/nestjs/nest","msgtype":"m.text"},"ts":1675276696894,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$zSVE7CO0llzzu1h8RVtH4dJ0hqm4veM1EWjuaNK765I"},
{"content":{"body":"> <@leobalter:matrix.org> is anyone actually advocating for the distinct semantics? Or is this just about syntax placement?\n\nWe are stating that the one major reason that changing the syntax was blocked some time back was to allow for the potential of \"export decorators\", which we do not believe to be a viable option. If that is no longer a blocking concern, then we want to discuss changing the ordering.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$FdNLmAw3xBruqbVs1O02zc-hIirFYjRmdWJH1e5VTv8?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@leobalter:matrix.org\">@leobalter:matrix.org</a><br>is anyone actually advocating for the distinct semantics? Or is this just about syntax placement?</blockquote></mx-reply>We are stating that the one major reason that changing the syntax was blocked some time back was to allow for the potential of &quot;export decorators&quot;, which we do not believe to be a viable option. If that is no longer a blocking concern, then we want to discuss changing the ordering.","m.relates_to":{"m.in_reply_to":{"event_id":"$FdNLmAw3xBruqbVs1O02zc-hIirFYjRmdWJH1e5VTv8"}},"msgtype":"m.text"},"ts":1675276697995,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$-XBdxqieJfWOiJgL95zk9sxy_UgCeu4zKQ3biQlBVrU"},
{"content":{"body":"Fwiw, Babel's most used decorators versions is the \"legacy\" one, which has decorators before `export`. The new versions have a `decoratorsBeforeExport` option to choose, and according to GitHub search it's set to `true` and `false` more or less the same number of times","format":"org.matrix.custom.html","formatted_body":"Fwiw, Babel's most used decorators versions is the &quot;legacy&quot; one, which has decorators before <code>export</code>. The new versions have a <code>decoratorsBeforeExport</code> option to choose, and according to GitHub search it's set to <code>true</code> and <code>false</code> more or less the same number of times","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"Fwiw, Babel's most used decorators versions is the \"legacy\" one, which has decorators before `export`. The new versions have a `decoratorsBeforeExport` option to choose, and according to GitHub search it's set to `true` and `false` more or less the same number of times","mimetype":"text/plain"},{"body":"Fwiw, Babel's most used decorators versions is the &quot;legacy&quot; one, which has decorators before <code>export</code>. The new versions have a <code>decoratorsBeforeExport</code> option to choose, and according to GitHub search it's set to <code>true</code> and <code>false</code> more or less the same number of times","mimetype":"text/html"}]},"ts":1675276721502,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$k2NFP8axegcqE1zn7zu1fkSIcoLn8eUjqZUPHTel0Sg"},
{"content":{"body":"https://github.com/nestjs/nest/blob/master/sample/33-graphql-mercurius/src/app.module.ts","msgtype":"m.text"},"ts":1675276731923,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$_mh-DbjzhkXIbQeUoy04wd7uE_5v7hR5YNOrfcNAxR0"},
{"content":{"body":"Thanks for the clarification, rbuckton. So this seems like only about syntax ergonomics","format":"org.matrix.custom.html","formatted_body":"Thanks for the clarification, <a href=\"https://matrix.to/#/@rbuckton:matrix.org\">rbuckton</a>. So this seems like only about syntax ergonomics","msgtype":"m.text"},"ts":1675276741659,"senderName":"leobalter","senderId":"@leobalter:matrix.org","id":"$ICB0SzZypMNTOZ_t9Bxx-7HY5Nt4PwYq8PxHAarzpjI"},
{"content":{"body":"https://github.com/search?q=decoratorsBeforeExport%3A+true&type=code and https://github.com/search?q=decoratorsBeforeExport%3A+false&type=code","m.relates_to":{"event_id":"$k2NFP8axegcqE1zn7zu1fkSIcoLn8eUjqZUPHTel0Sg","is_falling_back":true,"m.in_reply_to":{"event_id":"$k2NFP8axegcqE1zn7zu1fkSIcoLn8eUjqZUPHTel0Sg"},"rel_type":"m.thread"},"msgtype":"m.text","org.matrix.msc1767.text":"https://github.com/search?q=decoratorsBeforeExport%3A+true&type=code and https://github.com/search?q=decoratorsBeforeExport%3A+false&type=code"},"ts":1675276764706,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$5s21zcMS3EHfQcawz_o-D5WbU4nRMyVFHY6qmzSur5g"},
{"content":{"body":"wait what","msgtype":"m.text"},"ts":1675276773317,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$yjpy_ZmTt6pQoSkXrNcfynhNh2Y_LMVArFQHg3_343I"},
{"content":{"body":"that it's set the same number of times is a pretty strong counterargument to \"nobody's demanded a different ordering in 8 years\" imo","m.relates_to":{"event_id":"$k2NFP8axegcqE1zn7zu1fkSIcoLn8eUjqZUPHTel0Sg","is_falling_back":true,"m.in_reply_to":{"event_id":"$5s21zcMS3EHfQcawz_o-D5WbU4nRMyVFHY6qmzSur5g"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675276784933,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$Ra3vlWKTlqZiMnOd-q2o7XY_XuWGc7z17DuWGkR9u54"},
{"content":{"body":"i... would've figured we definitely don't have appetite to add keywords for such scoped semantics like \"writable namespace exports\"?","msgtype":"m.text"},"ts":1675276797598,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$LFAREd0Cfnh-U0QfEotvVOqc0Ln8kbM7BQpbGJyPFsQ"},
{"content":{"body":"\"we want syntax for more static analyzability\" is pretty true of a lot of things that don't meet the syntax bar, no?","msgtype":"m.text"},"ts":1675276857651,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$WKynh69M4uLa89FsVyINP9t2pBvpg6qM-RbN042w4Oo"},
{"content":{"body":"Well, but most people are using the legacy version that _only_ supports decorators before exports.\n\nI'm saying this based on how much issues/discussions we get about decorators, but also searching for `babel legacy: true` on GitHub gives a lot of results -- https://github.com/search?q=babel+legacy%3A+true&type=code","format":"org.matrix.custom.html","formatted_body":"<p>Well, but most people are using the legacy version that <em>only</em> supports decorators before exports.</p>\n<p>I'm saying this based on how much issues/discussions we get about decorators, but also searching for <code>babel legacy: true</code> on GitHub gives a lot of results -- https://github.com/search?q=babel+legacy%3A+true&amp;type=code</p>\n","m.relates_to":{"event_id":"$k2NFP8axegcqE1zn7zu1fkSIcoLn8eUjqZUPHTel0Sg","is_falling_back":true,"m.in_reply_to":{"event_id":"$Ra3vlWKTlqZiMnOd-q2o7XY_XuWGc7z17DuWGkR9u54"},"rel_type":"m.thread"},"msgtype":"m.text","org.matrix.msc1767.message":[{"body":"Well, but most people are using the legacy version that _only_ supports decorators before exports.\n\nI'm saying this based on how much issues/discussions we get about decorators, but also searching for `babel legacy: true` on GitHub gives a lot of results -- https://github.com/search?q=babel+legacy%3A+true&type=code","mimetype":"text/plain"},{"body":"<p>Well, but most people are using the legacy version that <em>only</em> supports decorators before exports.</p>\n<p>I'm saying this based on how much issues/discussions we get about decorators, but also searching for <code>babel legacy: true</code> on GitHub gives a lot of results -- https://github.com/search?q=babel+legacy%3A+true&amp;type=code</p>\n","mimetype":"text/html"}]},"ts":1675276868695,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$820uI9vrfMd8EPyIPcehUVNk_wSQR2mi4Pr0BXI-5SA"},
{"content":{"body":"all decorators","msgtype":"m.text"},"ts":1675276892325,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$OnvlU1B5AEMNfvGLS4mWiGYazjkgfpe3qAmR28fXvqU"},
{"content":{"body":"regarding Symbol predicates: i'd love some committee feedback on https://github.com/tc39/proposal-symbol-predicates/issues/9. Namely, to me, a predicate never throws and only returns a boolean - and in this case, eg \"isRegisteredSymbol\" is asking \"is this a symbol and also a registered one\". michael seems to read it as asking \"is this symbol a registered symbol\", implying it should throw on non-symbols.\n\ndoes anyone have thoughts on this? Please add them to the issue!","msgtype":"m.text"},"ts":1675276894014,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$CI9ucwHue4LOARNodKf5TQSxNzzQrUN3auBjL6Q9-gU"},
{"content":{"body":"all decorators meet that bar","msgtype":"m.text"},"ts":1675276895486,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$bdGwHxyr5SOnWC-Dee2a6rvpwSeo7n_yJJF3iOUarHE"},
{"content":{"body":"oh sure. most people don't have the choice tho","m.relates_to":{"event_id":"$k2NFP8axegcqE1zn7zu1fkSIcoLn8eUjqZUPHTel0Sg","is_falling_back":true,"m.in_reply_to":{"event_id":"$820uI9vrfMd8EPyIPcehUVNk_wSQR2mi4Pr0BXI-5SA"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675276911846,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$AYciPBx_6GscfOAkvMnMO2gDTwXpAEHnWq3V01QY-bs"},
{"content":{"body":"it's telling that when _given_ the choice, it's about an even split","format":"org.matrix.custom.html","formatted_body":"it's telling that when <em>given</em> the choice, it's about an even split","m.relates_to":{"event_id":"$k2NFP8axegcqE1zn7zu1fkSIcoLn8eUjqZUPHTel0Sg","is_falling_back":true,"m.in_reply_to":{"event_id":"$AYciPBx_6GscfOAkvMnMO2gDTwXpAEHnWq3V01QY-bs"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675276922137,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$jqPeQcWjKNw_D7ZgyJ9r8nFJicXQHidJyQwOoEBC5aA"},
{"content":{"body":"side question: in matrix, now that there are threads, how do i find threads i have unread messages in?","msgtype":"m.text"},"ts":1675277173350,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$mjY8q59DSKEE9148WT2KLtILw3s_qFzE0grbsXUhNPI"},
{"content":{"body":"my answer so far is, scroll","msgtype":"m.text"},"ts":1675277188510,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$EChvi8ulXn2lH9E7ma1yn6vVaUn04FBG6J8hWDr8TJs"},
{"content":{"body":"I was trying to do this same thing!","m.relates_to":{"event_id":"$mjY8q59DSKEE9148WT2KLtILw3s_qFzE0grbsXUhNPI","is_falling_back":true,"m.in_reply_to":{"event_id":"$mjY8q59DSKEE9148WT2KLtILw3s_qFzE0grbsXUhNPI"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675277191422,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$pxl_9kBO4XRr_Q0r7HYhsL7x_t0ee8OhVwcTKMY0T6s"},
{"content":{"body":"which is not... ideal","msgtype":"m.text"},"ts":1675277192260,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$MIjCTKNf6G0ioJPGQpFimrwXQWMQELdCWUSgieKWKI8"},
{"content":{"body":"well guess some messages are staying unread","msgtype":"m.text"},"ts":1675277206653,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$eIANmghp9gKGDAORVBFOpf5SL3oRqHk_-HB2MNuQ61s"},
{"content":{"body":"oh I think I just figured it out","m.relates_to":{"event_id":"$mjY8q59DSKEE9148WT2KLtILw3s_qFzE0grbsXUhNPI","is_falling_back":true,"m.in_reply_to":{"event_id":"$pxl_9kBO4XRr_Q0r7HYhsL7x_t0ee8OhVwcTKMY0T6s"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675277225226,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$2EkS85jlyVVnqXSkYrz5jH8JRaShiOxFFqllJyMtCWI"},
{"content":{"body":"close any open thread if you have one open, then click this button:","m.relates_to":{"event_id":"$mjY8q59DSKEE9148WT2KLtILw3s_qFzE0grbsXUhNPI","is_falling_back":true,"m.in_reply_to":{"event_id":"$2EkS85jlyVVnqXSkYrz5jH8JRaShiOxFFqllJyMtCWI"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675277261071,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$svMPxluXTJP4UKefDh53Pdm17anVDODdS4kUH2X-mUI"},
{"content":{"body":"Click the thread icon in the top right of the app","msgtype":"m.text"},"ts":1675277261198,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$brXY25uLWHCpWeu8yBbNkeLMMwexmyzogel57nMi-lw"},
{"content":{"body":"in the top right","m.relates_to":{"event_id":"$mjY8q59DSKEE9148WT2KLtILw3s_qFzE0grbsXUhNPI","is_falling_back":true,"m.in_reply_to":{"event_id":"$YP5T4KrPEcIw_oyDdxZpuIZgtkmAzNyBca5GLn09q4c"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675277268592,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$I4qBEWiw-4eQusabW1HnqoP_O3YVXCDE2aMRNvQM960"},
{"content":{"body":"ooo","msgtype":"m.text"},"ts":1675277283794,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$yexoN9hAOgCUpjSLzUX3LzIyt5CF8zlEOwbTWop9cQw"},
{"content":{"body":"i can click on `< Threads`","format":"org.matrix.custom.html","formatted_body":"i can click on <code>&lt; Threads</code>","msgtype":"m.text"},"ts":1675277288426,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$dQky8zahul1RV6YZbrCeyTbUkX_dLUag2cDv90ge-Bw"},
{"content":{"body":"and when you still can't find it, right click on the room and Mark as read","msgtype":"m.text"},"ts":1675277301585,"senderName":"Richard Gibson","senderId":"@gibson042:matrix.org","id":"$6pwpLXn9iM9mEm_mMgvcpueG-i6YwNvsry0HJXFSPBo"},
{"content":{"body":"there's also a \"back\" left chevron in the upper left corner of a thread window that takes you there","m.relates_to":{"event_id":"$mjY8q59DSKEE9148WT2KLtILw3s_qFzE0grbsXUhNPI","is_falling_back":true,"m.in_reply_to":{"event_id":"$I4qBEWiw-4eQusabW1HnqoP_O3YVXCDE2aMRNvQM960"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675277374756,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$2zumCoeiDmI-EgWU8HLejS9L3DOdBZawpVMwj12MWcA"},
{"content":{"body":"oh, also this is helpful:","msgtype":"m.text"},"ts":1675277375205,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$xCf1m-GpPN-gWCCUqRvkHEovwDrPnSFgDiBKEksODhY"},
{"content":{"body":"the default seems to list every thread, which I can't imagine wanting","msgtype":"m.text"},"ts":1675277408200,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$fSmPqkrqVbeJcpRa51DwD9oaVOO6WdxXyCUgPLD9MH0"},
{"content":{"body":"I see this in Element: ","msgtype":"m.text"},"ts":1675277488587,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$7AS5fBTX3GsK-tWVdqvIEQ2gQOXp8o7NcBt_y3gydvE"},
{"content":{"body":"ugh, it doesn't remember that preference though","msgtype":"m.text"},"ts":1675277490230,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$UTWHlAy81iGIgig7rBGVYM1hiaJAZ8kAuxBvC1noVKs"},
{"content":{"body":"Option 2 kills the idea of distinct semantics. Syntax positioning can eventually be set as a linter preference for consistency within user code.","msgtype":"m.text"},"ts":1675277498117,"senderName":"leobalter","senderId":"@leobalter:matrix.org","id":"$PNOVABcv-w9fwHVQULlhuLzl7eGfaT1MYc_haghq9hM"},
{"content":{"body":"I really like option 2 for this reason.","msgtype":"m.text"},"ts":1675277515157,"senderName":"leobalter","senderId":"@leobalter:matrix.org","id":"$YzKMfjWfxr4NlKSqzjeX4_hH8LVM_wJX56haxkB9urM"},
{"content":{"body":"not to me in this context, where \"fixed\" is much more likely to mean \"unchanging\" than \"no longer broken\"","m.relates_to":{"event_id":"$ETV_e6BaddaByYKWLQzKeozZW14JtFJg2gqGdmvnWao","is_falling_back":true,"m.in_reply_to":{"event_id":"$Pp1IYrlcyZEUMN_0g-uPJuYAEVsGvoFkknnivXg09ps"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675277525819,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$fTH0dkbNCv1MiS2w-wwKAUUfXaK0mL78gsO3SHiswig"},
{"content":{"body":"option 2, however, ensures burden on linters/formatters, and creates style debates, forever","msgtype":"m.text"},"ts":1675277546917,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$-j3Fovwy8WXmNj6hSFbfUiSbWU9lIulgJv_1Y_VOUdE"},
{"content":{"body":"but... it's the same word","m.relates_to":{"event_id":"$ETV_e6BaddaByYKWLQzKeozZW14JtFJg2gqGdmvnWao","is_falling_back":true,"m.in_reply_to":{"event_id":"$fTH0dkbNCv1MiS2w-wwKAUUfXaK0mL78gsO3SHiswig"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675277578048,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$6Ph8mnvAepFdomBinOcR2VMVc7TUB8_bIF8Pz4GOVCA"},
{"content":{"body":"the tense makes the difference to me","m.relates_to":{"event_id":"$ETV_e6BaddaByYKWLQzKeozZW14JtFJg2gqGdmvnWao","is_falling_back":true,"m.in_reply_to":{"event_id":"$6Ph8mnvAepFdomBinOcR2VMVc7TUB8_bIF8Pz4GOVCA"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675277630939,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$Eb4LFmPnmyBrOjFlBLXgdwffuZbo59VEzIKI3XiRhzg"},
{"content":{"body":"ok here is a codemod to go from TS-style to ES-style placement https://github.com/bakkot/export-decorated-class-codemod","msgtype":"m.text"},"ts":1675277649941,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$hIOX6uPAbSqCXP90nOqxe2kYi1UDi2BJmPEmu2hSIVU"},
{"content":{"body":"especially in programming, where (it seems to me that) \"fix\" is relatively rare but \"fixed\" is relatively common","format":"org.matrix.custom.html","formatted_body":"especially in programming, where (it seems to me that) &quot;fix&quot; is relatively rare but &quot;fixed&quot; is relatively common","msgtype":"m.text","m.relates_to":{"event_id":"$ETV_e6BaddaByYKWLQzKeozZW14JtFJg2gqGdmvnWao","is_falling_back":true,"m.in_reply_to":{"event_id":"$Eb4LFmPnmyBrOjFlBLXgdwffuZbo59VEzIKI3XiRhzg"},"rel_type":"m.thread"}},"ts":1675277653512,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$0AA8EngtpjEvVDDCTx-VL2Rff-dbiWGYIJ12kUU-L9c"},
{"content":{"body":"thank you to whoever has been fixing the notes while I looked away to write this","msgtype":"m.text"},"ts":1675277657781,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$0J8vOwJkvndAPye8oYyyXggoTipmLmaoE0HLFXJU0HU"},
{"content":{"body":" * especially in programming, where (it seems to me that) \"fix\" is relatively rare but \"fixed\" is relatively common","format":"org.matrix.custom.html","formatted_body":" * especially in programming, where (it seems to me that) &quot;fix&quot; is relatively rare but &quot;fixed&quot; is relatively common","m.new_content":{"body":"especially in programming, where (it seems to me that) \"fix\" is relatively rare but \"fixed\" is relatively common","format":"org.matrix.custom.html","formatted_body":"especially in programming, where (it seems to me that) &quot;fix&quot; is relatively rare but &quot;fixed&quot; is relatively common","msgtype":"m.text"},"m.relates_to":{"event_id":"$0AA8EngtpjEvVDDCTx-VL2Rff-dbiWGYIJ12kUU-L9c","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675277659067,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$-9foZgUPlWtxEIObhoRh1lNrpII9tIq3AOkN6SpUoLs"},
{"content":{"body":"bakkot: you were supposed to do both at the same time!","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@bakkot:matrix.org\">bakkot</a>: you were supposed to do both at the same time!","msgtype":"m.text"},"ts":1675277680557,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$8EKStXNACsIpcXAMTfvAv-VgPrVi0iJOytBWqby0RwQ"},
{"content":{"body":"I was doing some amount of it","msgtype":"m.text"},"ts":1675277689539,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$vPmzjezjlB6SWFia0JFPIl6mxHPDYUQddZdA9AS3g1U"},
{"content":{"body":"but then kind of forgot","msgtype":"m.text"},"ts":1675277692039,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$MkkoftYRgI2qS_SebqB-lsYCN6e8nFlViGh-ixV4cOQ"},
{"content":{"body":"there's also https://hackage.haskell.org/package/base-4.17.0.0/docs/Data-Function.html#v:fix","m.relates_to":{"event_id":"$ETV_e6BaddaByYKWLQzKeozZW14JtFJg2gqGdmvnWao","is_falling_back":true,"m.in_reply_to":{"event_id":"$0AA8EngtpjEvVDDCTx-VL2Rff-dbiWGYIJ12kUU-L9c"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675277738160,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$Bxn2afEx1Xzybke31GHAHTff360z1OS7NRKLL8T92yE"},
{"content":{"body":"`export default class C {}` is a default export and a `C` class declaration.","format":"org.matrix.custom.html","formatted_body":"<code>export default class C {}</code> is a default export and a <code>C</code> class declaration.","msgtype":"m.text"},"ts":1675277815036,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$hS8BEaf8adDL_sk8xzxWnPMdLsNDLw-uM69zDbaVSDE"},
{"content":{"body":"`export default (class C {})` is a default export for an expression","format":"org.matrix.custom.html","formatted_body":"<code>export default (class C {})</code> is a default export for an expression","msgtype":"m.text"},"ts":1675277829856,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$rLOYUS7UUdnJp7ubmCWK-uhgpwK3fr8MHZf2-SvRIuc"},
{"content":{"body":"i think `transferAndFixLength` makes it sound like it does a transfer, then does an operation to turn a resizable buffer into a fixed length one","format":"org.matrix.custom.html","formatted_body":"i think <code>transferAndFixLength</code> makes it sound like it does a transfer, then does an operation to turn a resizable buffer into a fixed length one","m.relates_to":{"event_id":"$ETV_e6BaddaByYKWLQzKeozZW14JtFJg2gqGdmvnWao","is_falling_back":true,"m.in_reply_to":{"event_id":"$Bxn2afEx1Xzybke31GHAHTff360z1OS7NRKLL8T92yE"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675277831152,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$IHZ4a8gAAuNOxtxqUEAMMayNd7PXjVMHDnXlXuzBXs0"},
{"content":{"body":"I'm off for the evening, if anyone has any concerns or wants to get a Mozilla opinion, we have iain taking over for the last hour! (acronym is IID)","format":"org.matrix.custom.html","formatted_body":"I'm off for the evening, if anyone has any concerns or wants to get a Mozilla opinion, we have <a href=\"https://matrix.to/#/@iain:mozilla.org\">iain</a> taking over for the last hour! (acronym is IID)","msgtype":"m.text"},"ts":1675277847906,"senderName":"yulia","senderId":"@yulia:mozilla.org","id":"$5XqpW3_DtwvdGsyX5fHSPinfumGfigJIbgqfVjIHeqg"},
{"content":{"body":"but that \"fixing the length\" operation isn't something that exists","m.relates_to":{"event_id":"$ETV_e6BaddaByYKWLQzKeozZW14JtFJg2gqGdmvnWao","is_falling_back":true,"m.in_reply_to":{"event_id":"$IHZ4a8gAAuNOxtxqUEAMMayNd7PXjVMHDnXlXuzBXs0"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675277851529,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$rCIsdlWP_gpgofoaCdTFdfdOfbWAUfN-qE7KAwlfNbI"},
{"content":{"body":"option 1 is really nice to avoid confusion from `export` vs `export default`. The @decorator will always be placed without confusion.\n\nljharb the style discussion burden option 2 seems not enough for me to object. It's already in the nature of the language","format":"org.matrix.custom.html","formatted_body":"<p>option 1 is really nice to avoid confusion from <code>export</code> vs <code>export default</code>. The @decorator will always be placed without confusion.</p>\n<p><a href=\"https://matrix.to/#/@ljharb:matrix.org\">ljharb</a> the style discussion burden option 2 seems not enough for me to object. It's already in the nature of the language</p>\n","msgtype":"m.text"},"ts":1675277858145,"senderName":"leobalter","senderId":"@leobalter:matrix.org","id":"$kkOmdTPYIR2LQXExokBKLUBcP4POC_cHYM3_Iz4iRKY"},
{"content":{"body":"also it may be ambiguous between what length you're fixing","m.relates_to":{"event_id":"$ETV_e6BaddaByYKWLQzKeozZW14JtFJg2gqGdmvnWao","is_falling_back":true,"m.in_reply_to":{"event_id":"$rCIsdlWP_gpgofoaCdTFdfdOfbWAUfN-qE7KAwlfNbI"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675277865054,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$mNLQidZwq0R6bbW4M_S6IfGMlhVEruanFeRQggHVsL0"},
{"content":{"body":"the receiver or the return value","m.relates_to":{"event_id":"$ETV_e6BaddaByYKWLQzKeozZW14JtFJg2gqGdmvnWao","is_falling_back":true,"m.in_reply_to":{"event_id":"$mNLQidZwq0R6bbW4M_S6IfGMlhVEruanFeRQggHVsL0"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675277868208,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$EmBIoEt8J528BM8s3Z2CRVNDuWIAryBl6MuTIxh-zWs"},
{"content":{"body":"rbuckton: what about `export default class {}`?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@rbuckton:matrix.org\">rbuckton</a>: what about <code>export default class {}</code>?","msgtype":"m.text"},"ts":1675277907945,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$1c8eoTMgCyTtx5GYdd1Phw5RSxPD9PE18YL0U2PWpgQ"},
{"content":{"body":"prefer option 1","msgtype":"m.text"},"ts":1675277913038,"senderName":"HE Shi-Jun","senderId":"@haxjs:matrix.org","id":"$Uc5des5dzemD5FYHuecw2uTbCY59nUu2r_N5W0vDkZM"},
{"content":{"body":" * rbuckton: what about `export default class {}`?","format":"org.matrix.custom.html","formatted_body":" * <a href=\"https://matrix.to/#/@rbuckton:matrix.org\">rbuckton</a>: what about <code>export default class {}</code>?","m.new_content":{"body":"rbuckton: what about `export default class {}`?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@rbuckton:matrix.org\">rbuckton</a>: what about <code>export default class {}</code>?","msgtype":"m.text"},"m.relates_to":{"event_id":"$1c8eoTMgCyTtx5GYdd1Phw5RSxPD9PE18YL0U2PWpgQ","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675277913122,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$GAgHjS8LcMxPBWlddlbvgJF597rFyqlzQSiru0wrsrc"},
{"content":{"body":"> <@ljharb:matrix.org> rbuckton: what about `export default class {}`?\n\ndeclaration","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$1c8eoTMgCyTtx5GYdd1Phw5RSxPD9PE18YL0U2PWpgQ?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@ljharb:matrix.org\">@ljharb:matrix.org</a><br><a href=\"https://matrix.to/#/@rbuckton:matrix.org\">rbuckton</a>: what about <code>export default class {}</code>?</blockquote></mx-reply>declaration","m.relates_to":{"m.in_reply_to":{"event_id":"$1c8eoTMgCyTtx5GYdd1Phw5RSxPD9PE18YL0U2PWpgQ"}},"msgtype":"m.text"},"ts":1675277919005,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$PrncS-nQZqPySh8A5EAOz8vv0CoD5HkXi1s2PL6LAtQ"},
{"content":{"body":"with what binding name, \"default\"?","msgtype":"m.text"},"ts":1675277925511,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$gF-0gR9BfHsZ6qSBDEVF6wZvy1lPsxV-9PHUZii4NhQ"},
{"content":{"body":"With option 1 (decorators only before export), would `export default @dec class A {}` be a valid export of a class expression?","format":"org.matrix.custom.html","formatted_body":"With option 1 (decorators only before export), would <code>export default @dec class A {}</code> be a valid export of a class expression?","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"With option 1 (decorators only before export), would `export default @dec class A {}` be a valid export of a class expression?","mimetype":"text/plain"},{"body":"With option 1 (decorators only before export), would <code>export default @dec class A {}</code> be a valid export of a class expression?","mimetype":"text/html"}]},"ts":1675277926568,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$c5I8zA_7KGEHdeP6u5UxH6qLaD5i9Wvbzec5GDN-eDs"},
{"content":{"body":" * With option 1 (decorators only before export), would `export default @dec class A {}` be a valid export of a class expression?","format":"org.matrix.custom.html","formatted_body":" * With option 1 (decorators only before export), would <code>export default @dec class A {}</code> be a valid export of a class expression?","m.new_content":{"body":"With option 1 (decorators only before export), would `export default @dec class A {}` be a valid export of a class expression?","format":"org.matrix.custom.html","formatted_body":"With option 1 (decorators only before export), would <code>export default @dec class A {}</code> be a valid export of a class expression?","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"With option 1 (decorators only before export), would `export default @dec class A {}` be a valid export of a class expression?","mimetype":"text/plain"},{"body":"With option 1 (decorators only before export), would <code>export default @dec class A {}</code> be a valid export of a class expression?","mimetype":"text/html"}]},"m.relates_to":{"event_id":"$c5I8zA_7KGEHdeP6u5UxH6qLaD5i9Wvbzec5GDN-eDs","rel_type":"m.replace"},"msgtype":"m.text","org.matrix.msc1767.message":[{"body":" * With option 1 (decorators only before export), would `export default @dec class A {}` be a valid export of a class expression?","mimetype":"text/plain"},{"body":" * With option 1 (decorators only before export), would <code>export default @dec class A {}</code> be a valid export of a class expression?","mimetype":"text/html"}]},"ts":1675277933898,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$1UthjPZUucko0bZQduYiLmqNL4rzDXjoypdR5VxxdUg"},
{"content":{"body":"and what about `export default @noopDecorator class {}`?","format":"org.matrix.custom.html","formatted_body":"and what about <code>export default @noopDecorator class {}</code>?","msgtype":"m.text"},"ts":1675277944559,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$70tLXP38rNtpr9LgM84tgEEO6DhqjBiUceZGeaphXH4"},
{"content":{"body":"> <@nicolo-ribaudo:matrix.org> With option 1 (decorators only before export), would `export default @dec class A {}` be a valid export of a class expression?\n\noh god","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$c5I8zA_7KGEHdeP6u5UxH6qLaD5i9Wvbzec5GDN-eDs?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@nicolo-ribaudo:matrix.org\">@nicolo-ribaudo:matrix.org</a><br>With option 1 (decorators only before export), would <code>export default @dec class A {}</code> be a valid export of a class expression?</blockquote></mx-reply>oh god","m.relates_to":{"m.in_reply_to":{"event_id":"$c5I8zA_7KGEHdeP6u5UxH6qLaD5i9Wvbzec5GDN-eDs"}},"msgtype":"m.text"},"ts":1675277952365,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$88KeZTs4xSYMRfGV5CFI3GfngZI7yhyaNfznPBKZu8U"},
{"content":{"body":"It creates an export binding named `default`, as evidenced by `import { default as Foo } from \"module\"`","format":"org.matrix.custom.html","formatted_body":"It creates an export binding named <code>default</code>, as evidenced by <code>import { default as Foo } from &quot;module&quot;</code>","msgtype":"m.text"},"ts":1675277958202,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$wlEZhHRzYKlmymnRvf-ULYl75tKJXZDCU1HBJy0jL14"},
{"content":{"body":"> <@nicolo-ribaudo:matrix.org> With option 1 (decorators only before export), would `export default @dec class A {}` be a valid export of a class expression?\n\nI guess we would need a lookahead restriction to disallow it","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$c5I8zA_7KGEHdeP6u5UxH6qLaD5i9Wvbzec5GDN-eDs?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@nicolo-ribaudo:matrix.org\">@nicolo-ribaudo:matrix.org</a><br>With option 1 (decorators only before export), would <code>export default @dec class A {}</code> be a valid export of a class expression?</blockquote></mx-reply>I guess we would need a lookahead restriction to disallow it","m.relates_to":{"m.in_reply_to":{"event_id":"$c5I8zA_7KGEHdeP6u5UxH6qLaD5i9Wvbzec5GDN-eDs"}},"msgtype":"m.text","org.matrix.msc1767.message":[{"body":"> <@nicolo-ribaudo:matrix.org> With option 1 (decorators only before export), would `export default @dec class A {}` be a valid export of a class expression?\n\nI guess we would need a lookahead restriction to disallow it","mimetype":"text/plain"},{"body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$c5I8zA_7KGEHdeP6u5UxH6qLaD5i9Wvbzec5GDN-eDs?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@nicolo-ribaudo:matrix.org\">@nicolo-ribaudo:matrix.org</a><br>With option 1 (decorators only before export), would <code>export default @dec class A {}</code> be a valid export of a class expression?</blockquote></mx-reply>I guess we would need a lookahead restriction to disallow it","mimetype":"text/html"}]},"ts":1675277967507,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$gTO6aM4DVgUXJaskNyv4jIqimo85LHbMtYxA32NT2-c"},
{"content":{"body":"We would disallow that and require parens. or at least, that would be my preference","format":"org.matrix.custom.html","formatted_body":"We would disallow that and require parens. or at least, that would be my preference","msgtype":"m.text","m.relates_to":{"m.in_reply_to":{"event_id":"$88KeZTs4xSYMRfGV5CFI3GfngZI7yhyaNfznPBKZu8U"}}},"ts":1675277978166,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$W5bJkDDnNisj6dWGDPPddCFkaPuCn4aL--k7sFK5Hiw"},
{"content":{"body":"> <@bakkot:matrix.org> oh god\n\n * We would disallow that and require parens. or at least, that would be my preference","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$88KeZTs4xSYMRfGV5CFI3GfngZI7yhyaNfznPBKZu8U?via=matrix.org&amp;via=igalia.com&amp;via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@bakkot:matrix.org\">@bakkot:matrix.org</a><br>oh god</blockquote></mx-reply> * We would disallow that and require parens. or at least, that would be my preference","m.new_content":{"body":"We would disallow that and require parens. or at least, that would be my preference","format":"org.matrix.custom.html","formatted_body":"We would disallow that and require parens. or at least, that would be my preference","msgtype":"m.text"},"m.relates_to":{"event_id":"$W5bJkDDnNisj6dWGDPPddCFkaPuCn4aL--k7sFK5Hiw","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675277992710,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$l-vIHDDy4nSqofs7_LcDR7JxMwQ4d8rUF9XFxt8m6l4"},
{"content":{"body":"Someone is typing very loudly","msgtype":"m.text"},"ts":1675277997681,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$6DmVVKctmb1i6sbuogv0OlpEMA2H0A0a0AZzHKWdbJQ"},
{"content":{"body":"sorry, that was me","msgtype":"m.text"},"ts":1675278006062,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$siWVQTIMvs7uyD3CqXo_OWewoB3m7U_DJPQqtP107IE"},
{"content":{"body":"> <@ljharb:matrix.org> and what about `export default @noopDecorator class {}`?\n\nThis is very much a declaration. This is clear in the decorator spec.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$70tLXP38rNtpr9LgM84tgEEO6DhqjBiUceZGeaphXH4?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@ljharb:matrix.org\">@ljharb:matrix.org</a><br>and what about <code>export default @noopDecorator class {}</code>?</blockquote></mx-reply>This is very much a declaration. This is clear in the decorator spec.","m.relates_to":{"m.in_reply_to":{"event_id":"$70tLXP38rNtpr9LgM84tgEEO6DhqjBiUceZGeaphXH4"}},"msgtype":"m.text"},"ts":1675278012264,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$WSpaoZx-dAGfXk1DE-4x_dvDQU0TKIbw8S0iY8iq2pQ"},
{"content":{"body":"I guess we already lookahead prevent `class` and `function` in that position, so adding decorators there is presumably easy","format":"org.matrix.custom.html","formatted_body":"I guess we already lookahead prevent <code>class</code> and <code>function</code> in that position, so adding decorators there is presumably easy","msgtype":"m.text"},"ts":1675278015098,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$Ksyly76l80YJrL8Ae9H-mhUA5NDkmWI-RNR2XDXUw5U"},
{"content":{"body":"> <@littledan:matrix.org> This is very much a declaration. This is clear in the decorator spec.\n\nand it makes a local binding `default`?","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$WSpaoZx-dAGfXk1DE-4x_dvDQU0TKIbw8S0iY8iq2pQ?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@littledan:matrix.org\">@littledan:matrix.org</a><br>This is very much a declaration. This is clear in the decorator spec.</blockquote></mx-reply>and it makes a local binding <code>default</code>?","m.relates_to":{"m.in_reply_to":{"event_id":"$WSpaoZx-dAGfXk1DE-4x_dvDQU0TKIbw8S0iY8iq2pQ"}},"msgtype":"m.text"},"ts":1675278043342,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$HplxD46y8YpPlJsJi0vk_Z5WI58KY9xUyt2YGnPWghA"},
{"content":{"body":"no you don't get a local binding from anonymous classes","msgtype":"m.text"},"ts":1675278055317,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$263JSykQutL6bnwghb2ofcAQPNlfDliokhvc7_uPQzQ"},
{"content":{"body":"with or without decorators, `export class {}` has no user-observable local binding","format":"org.matrix.custom.html","formatted_body":"with or without decorators, <code>export class {}</code> has no user-observable local binding","msgtype":"m.text"},"ts":1675278075022,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$cKwXyIAtYGTTflsURzmQq9T_R-P3NF1C049jE8U3lMU"},
{"content":{"body":"ryzokuken: can we do a heat check for both options?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@usharma:igalia.com\">ryzokuken</a>: can we do a heat check for both options?","msgtype":"m.text"},"ts":1675278101706,"senderName":"leobalter","senderId":"@leobalter:matrix.org","id":"$z6LMYRESddfECfSX8IRG3v433JR5He3-JhyYxJvMBjA"},
{"content":{"body":"interesting","m.relates_to":{"event_id":"$ETV_e6BaddaByYKWLQzKeozZW14JtFJg2gqGdmvnWao","is_falling_back":true,"m.in_reply_to":{"event_id":"$EmBIoEt8J528BM8s3Z2CRVNDuWIAryBl6MuTIxh-zWs"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675278163111,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$nPvRkPyYC4b7jOdN2jqv6l3kehmYyqSaUErIfFDOjwM"},
{"content":{"body":"> <@bakkot:matrix.org> with or without decorators, `export class {}` has no user-observable local binding\n\n`export class {}` without either `default` or a name is illegal","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$cKwXyIAtYGTTflsURzmQq9T_R-P3NF1C049jE8U3lMU?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@bakkot:matrix.org\">@bakkot:matrix.org</a><br>with or without decorators, <code>export class {}</code> has no user-observable local binding</blockquote></mx-reply><code>export class {}</code> without either <code>default</code> or a name is illegal","m.relates_to":{"m.in_reply_to":{"event_id":"$cKwXyIAtYGTTflsURzmQq9T_R-P3NF1C049jE8U3lMU"}},"msgtype":"m.text"},"ts":1675278164656,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$PYVarzQgIRXJNMuI3XP4DAaK8iOv3IZM2eGaxC6_PFE"},
{"content":{"body":"the thing I didn't like about the name we went with is that it feels like it drops off without mentioning a noun","m.relates_to":{"event_id":"$ETV_e6BaddaByYKWLQzKeozZW14JtFJg2gqGdmvnWao","is_falling_back":true,"m.in_reply_to":{"event_id":"$nPvRkPyYC4b7jOdN2jqv6l3kehmYyqSaUErIfFDOjwM"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675278179437,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$tPx2W4M93p6hLgrE5Su8lcbZGQQ_SD43RFSebmz16Oo"},
{"content":{"body":"We will need very clear wording for a temp check.","msgtype":"m.text","org.matrix.msc1767.text":"We will need very clear wording for a temp check."},"ts":1675278185936,"senderName":"Rob Palmer","senderId":"@robpalme:matrix.org","id":"$PQZr0ZOfq9t1IzY6F78P5ggSDkTdF4825HTOxAaxP5M"},
{"content":{"body":"sorry, `export default class {}`, of course","format":"org.matrix.custom.html","formatted_body":"sorry, <code>export default class {}</code>, of course","msgtype":"m.text"},"ts":1675278186998,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$um6VSQ0VwUFFBkhZPBPkViavHR-7IzYXVHziY3worqY"},
{"content":{"body":"\"transferTo\" needs to be followed by a thing","format":"org.matrix.custom.html","formatted_body":"&quot;transferTo&quot; needs to be followed by a thing","msgtype":"m.text","m.relates_to":{"event_id":"$ETV_e6BaddaByYKWLQzKeozZW14JtFJg2gqGdmvnWao","is_falling_back":true,"m.in_reply_to":{"event_id":"$tPx2W4M93p6hLgrE5Su8lcbZGQQ_SD43RFSebmz16Oo"},"rel_type":"m.thread"}},"ts":1675278197877,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$f57U8vIVdFomWkYuYL3MFIv5Ftn1lxwUZgpev-Vv-W4"},
{"content":{"body":"but it's missing a thing","m.relates_to":{"event_id":"$ETV_e6BaddaByYKWLQzKeozZW14JtFJg2gqGdmvnWao","is_falling_back":true,"m.in_reply_to":{"event_id":"$f57U8vIVdFomWkYuYL3MFIv5Ftn1lxwUZgpev-Vv-W4"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675278201546,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$DeBQy_RHDiWlnbWV6B3PRci48Wgiv0bVJ2FIM5K0Y4w"},
{"content":{"body":" * \"transferTo\" needs to be followed by a thing","format":"org.matrix.custom.html","formatted_body":" * &quot;transferTo&quot; needs to be followed by a thing","m.new_content":{"body":"\"transferTo\" needs to be followed by a thing","format":"org.matrix.custom.html","formatted_body":"&quot;transferTo&quot; needs to be followed by a thing","msgtype":"m.text"},"m.relates_to":{"event_id":"$f57U8vIVdFomWkYuYL3MFIv5Ftn1lxwUZgpev-Vv-W4","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675278212278,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$xKtiY6RoDwbiurl3Gjf1ciOtUcLy_XyxQ3dplpls_r8"},
{"content":{"body":"> <@leobalter:matrix.org> ryzokuken: can we do a heat check for both options?\n\nWe have 3 options","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$z6LMYRESddfECfSX8IRG3v433JR5He3-JhyYxJvMBjA?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@leobalter:matrix.org\">@leobalter:matrix.org</a><br><a href=\"https://matrix.to/#/@usharma:igalia.com\">ryzokuken</a>: can we do a heat check for both options?</blockquote></mx-reply>We have 3 options","m.relates_to":{"m.in_reply_to":{"event_id":"$z6LMYRESddfECfSX8IRG3v433JR5He3-JhyYxJvMBjA"}},"msgtype":"m.text"},"ts":1675278213684,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$qJksTH0bUO2Yry2uYebHaqhiFreEGjElAFEGFiWNf6M"},
{"content":{"body":"hey now, my codemod is correct","msgtype":"m.text"},"ts":1675278236116,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$_JPR9Tu2xjMKREEWdrNjfOcEag76mLVibv_wohcUyfY"},
{"content":{"body":"we'd need a well-defined problem statement for a temp check","msgtype":"m.text","org.matrix.msc1767.text":"we'd need a well-defined problem statement for a temp check"},"ts":1675278237458,"senderName":"ryzokuken","senderId":"@usharma:igalia.com","id":"$PKwX1T25Pli92DGM0ZxUlAyscL-sZnbCW3mFvRNVjY4"},
{"content":{"body":"it keeps trivia","msgtype":"m.text"},"ts":1675278238978,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$y8wEEbrpifpXy3rU6VFH5EOBKZQqAw85PxzAjS0q4Xk"},
{"content":{"body":"> <@robpalme:matrix.org> We will need very clear wording for a temp check.\n\nI'd like to hear how people support or object to Option 1 and Option 2. The XOR might be discussed after?","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$PQZr0ZOfq9t1IzY6F78P5ggSDkTdF4825HTOxAaxP5M?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@robpalme:matrix.org\">@robpalme:matrix.org</a><br>We will need very clear wording for a temp check.</blockquote></mx-reply>I'd like to hear how people support or object to Option 1 and Option 2. The XOR might be discussed after?","m.relates_to":{"m.in_reply_to":{"event_id":"$PQZr0ZOfq9t1IzY6F78P5ggSDkTdF4825HTOxAaxP5M"}},"msgtype":"m.text"},"ts":1675278246881,"senderName":"leobalter","senderId":"@leobalter:matrix.org","id":"$QMCsxeRZAtAWgtaj5PdDcH-xj1SRmRIToFMCtR66lTs"},
{"content":{"body":"it keeps every single character that was in the source","msgtype":"m.text"},"ts":1675278253194,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$L62aVYaqCxE57m1syT5G5ML9zhz0b6mTTpPtuDzLbEs"},
{"content":{"body":"just moves them around","msgtype":"m.text"},"ts":1675278255328,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$PpbSlNkva2TOJwJbyHKo7oTVlPXVneBABUzL9NSS-WQ"},
{"content":{"body":"writing correct codemods is not that hard","msgtype":"m.text"},"ts":1675278274662,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$xby_wMZpIZV9tNDOqay7DMPteNEBwLNR2fst99QETF4"},
{"content":{"body":"Please phrase the question as a temp-check compatible question.  \n\nhttps://github.com/tc39/how-we-work/blob/main/presenting.md#temperature-checks","msgtype":"m.text","org.matrix.msc1767.text":"Please phrase the question as a temp-check compatible question.  \n\nhttps://github.com/tc39/how-we-work/blob/main/presenting.md#temperature-checks"},"ts":1675278305663,"senderName":"Rob Palmer","senderId":"@robpalme:matrix.org","id":"$TH_brz6aSC44yxbngY9g6X515sYpKa_3TLM1Eo0xMcQ"},
{"content":{"body":"Do you want multiple temp checks?","msgtype":"m.text","org.matrix.msc1767.text":"Do you want multiple temp checks?"},"ts":1675278333103,"senderName":"Rob Palmer","senderId":"@robpalme:matrix.org","id":"$3TgSLJv6KK2adArWl0twe8Jp3ImIjOiRbc5Z77iuuJ4"},
{"content":{"body":"multiple, for each option proposed","msgtype":"m.text"},"ts":1675278348631,"senderName":"leobalter","senderId":"@leobalter:matrix.org","id":"$nUCM6HHacPdl1iHLqMfD-i2LZFYvfLEhe1-VNtueTes"},
{"content":{"body":"presumably TS could retain the ability to parse decorator-before-export, and give a specific helpful message in that case too telling them how to fix it?","msgtype":"m.text"},"ts":1675278370417,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$_PfsbwYTvzYx7F_CVRnMFXHEk-KelerDE40adklbzKM"},
{"content":{"body":"The goal is to help me identify what concerns are counted as strong objections","msgtype":"m.text"},"ts":1675278373259,"senderName":"leobalter","senderId":"@leobalter:matrix.org","id":"$cIx5oz51-9ExEiYlxgidgTPadNp_jV7d63Yx2weorug"},
{"content":{"body":"Mark has already said he is strongly opposed to Option 1","msgtype":"m.text","org.matrix.msc1767.text":"Mark has already said he is strongly opposed to Option 1"},"ts":1675278403496,"senderName":"Rob Palmer","senderId":"@robpalme:matrix.org","id":"$ejURqq6SkJSR61u7tv7joAYIGe3uA70louVnWOKef4Q"},
{"content":{"body":"hm, i just got booted from the meeting, is that just me? (probably just me)","msgtype":"m.text"},"ts":1675278452502,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$qCSpPbL5UHEfLhQ4aL-Ax8SUTqnCzzK6pu8bLGtyEXE"},
{"content":{"body":" * hm, i just got booted from the meeting, is that just me? (probably just me)","m.new_content":{"body":"hm, i just got booted from the meeting, is that just me? (probably just me)","msgtype":"m.text"},"m.relates_to":{"event_id":"$qCSpPbL5UHEfLhQ4aL-Ax8SUTqnCzzK6pu8bLGtyEXE","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675278453158,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$n-puShBsdWx4TV5p7aBbOYbCNUj8wmFVh7qOmDPIhIE"},
{"content":{"body":"could you try reconnecting?","msgtype":"m.text","org.matrix.msc1767.text":"could you try reconnecting?"},"ts":1675278471544,"senderName":"ryzokuken","senderId":"@usharma:igalia.com","id":"$v9J5Ih1mT8M5Je-SfxjFC4QU4mqx1qhAzhLNAwFaqY4"},
{"content":{"body":"nah it was just my local internet. comcast fun times.","msgtype":"m.text"},"ts":1675278481187,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$UZMCECn6h4hBxaX6JH1b68ymgZf3-3xg5HpgxLhj9j0"},
{"content":{"body":"and Mark seems to be ok with Option 2.\n\nPerhaps the heat check might just aim to this option","msgtype":"m.text"},"ts":1675278483057,"senderName":"leobalter","senderId":"@leobalter:matrix.org","id":"$gmz4gegOYye2v1NdhRi0pSmuOv8rZvFgM5gYh3_MfZ8"},
{"content":{"body":"Rob Palmer ryzokuken if the TS team is fine, can we just do a temp check for support/objection to Option 2? ","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@robpalme:matrix.org\">Rob Palmer</a> <a href=\"https://matrix.to/#/@usharma:igalia.com\">ryzokuken</a> if the TS team is fine, can we just do a temp check for support/objection to Option 2?","msgtype":"m.text"},"ts":1675278544663,"senderName":"leobalter","senderId":"@leobalter:matrix.org","id":"$tNG3oqRTju-1ROTOkngPeegRx3SJ8MkkZ993bxO9YDs"},
{"content":{"body":"I also apologize for the keyboard noise. I thought Jitsi had NVidia Broadcast set for my input audio, which normally filters that out, but it was not.","msgtype":"m.text"},"ts":1675278552370,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$y5hUny-uWy_t__BVEANfNVRosJnwQfnVNndgWkF6JQM"},
{"content":{"body":"we don't have time for it now","msgtype":"m.text","org.matrix.msc1767.text":"we don't have time for it now"},"ts":1675278560920,"senderName":"Rob Palmer","senderId":"@robpalme:matrix.org","id":"$9If6N-MHDE-EnKvhWkGqqP4yGNBcetg9yksAMKIW4TA"},
{"content":{"body":"this would be a very valuable information from this discussion","msgtype":"m.text"},"ts":1675278584343,"senderName":"leobalter","senderId":"@leobalter:matrix.org","id":"$7bhWcDhU00uhukj1POY1cftSOgyuCsaZMDwjlVZZZs0"},
{"content":{"body":"leaving a workable path to move it forward","msgtype":"m.text"},"ts":1675278612106,"senderName":"leobalter","senderId":"@leobalter:matrix.org","id":"$SPFxD3xYrHn8Mftb-wMjhh_wnt_TIUmKQGGZJcPJykw"},
{"content":{"body":"leobalter: You still haven't formed a clear question for the temperature check","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@leobalter:matrix.org\">leobalter</a>: You still haven't formed a clear question for the temperature check","msgtype":"m.text"},"ts":1675278625658,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$0xyVhtQhLysqsFVAFkATidpd0kRHcokRKU7-xiskuXk"},
{"content":{"body":"I did","msgtype":"m.text"},"ts":1675278631356,"senderName":"leobalter","senderId":"@leobalter:matrix.org","id":"$e2gEKfWu6qu4dO0TZz4fUOy_CEQS26FGjigYTVlKR8Q"},
{"content":{"body":"We'll do the temp check tomorrow.  I encourage the champions (and everyone) to read the guidance on how to request and frame temp checks.  We have repeatedly had problems when people request them on-the-fly.  It is much better to pre-plan them.\n\nhttps://github.com/tc39/how-we-work/blob/main/presenting.md#temperature-checks","msgtype":"m.text","org.matrix.msc1767.text":"We'll do the temp check tomorrow.  I encourage the champions (and everyone) to read the guidance on how to request and frame temp checks.  We have repeatedly had problems when people request them on-the-fly.  It is much better to pre-plan them.\n\nhttps://github.com/tc39/how-we-work/blob/main/presenting.md#temperature-checks"},"ts":1675278733021,"senderName":"Rob Palmer","senderId":"@robpalme:matrix.org","id":"$SToShlSQdP1c2K-BWuORkqkafhu7zJsL59tCJ0LNIPA"},
{"content":{"body":"re: the migration path, there are going to be some decorators which cannot be migrated 1-1 is the core issue. The new spec is just less powerful than the old one in some core ways. In these cases, it's likely that teams will try to migrate in parts, and possibly use both specs in different files (using a pragma to distinguish which spec to use)","msgtype":"m.text"},"ts":1675278746113,"senderName":"pzuraq","senderId":"@pzura:matrix.org","id":"$6PKybNUFvXAbuJ-TgK0uYRV4ocOmY2xxC5J_Nr4m0Es"},
{"content":{"body":"depending on the size of the codebase, of course","msgtype":"m.text"},"ts":1675278764823,"senderName":"pzuraq","senderId":"@pzura:matrix.org","id":"$uyMxAwu0ZfgUfcQdzg6HW6DkVKM5yk2XG9R8WsttMsk"},
{"content":{"body":"Yeah, but you can codemod one file at a time, surely","msgtype":"m.text"},"ts":1675278797423,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$tcjLgTqGB_0JY_RChAddZHBaSzrRlU6DMNewujiEMZU"},
{"content":{"body":"minimizing syntax changes minimizes the number of files that _need_ a pragma, because files when the syntax is the same can feature detect based on usage","format":"org.matrix.custom.html","formatted_body":"minimizing syntax changes minimizes the number of files that <em>need</em> a pragma, because files when the syntax is the same can feature detect based on usage","msgtype":"m.text"},"ts":1675278811271,"senderName":"pzuraq","senderId":"@pzura:matrix.org","id":"$fMF21xhND-UavWmFiJ87k9zZo3M2U0TIaTaFiOnMm34"},
{"content":{"body":"so is that an argument that this particular ordering is better served by codemods, or not by codemods and by changing the language...?","msgtype":"m.text"},"ts":1675278814277,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$v4GV-ee_0_BhhUJ_S2S1DtPKPg7KAaWNcno1VZueP5E"},
{"content":{"body":"Rob Palmer: I'm sorry about the last minute request. I did a quick read on the doc. I'm not the one proposing the change, so I'll drop my requests anyway.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@robpalme:matrix.org\">Rob Palmer</a>: I'm sorry about the last minute request. I did a quick read on the doc. I'm not the one proposing the change, so I'll drop my requests anyway.","msgtype":"m.text"},"ts":1675278822220,"senderName":"leobalter","senderId":"@leobalter:matrix.org","id":"$FdM6_CvpEO8KwMsGpvP60sEF-7TagXpC6zB1MoUo0ao"},
{"content":{"body":"bakkot: some of these changes will not be codemoddable","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@bakkot:matrix.org\">bakkot</a>: some of these changes will not be codemoddable","msgtype":"m.text"},"ts":1675278853864,"senderName":"pzuraq","senderId":"@pzura:matrix.org","id":"$g1FLt4LFDw45VrWfGwX1rTF4ACnpfkSQD67T8ucsSxE"},
{"content":{"body":"pzuraq: the only change we're discussing is syntax, which is definitely codemoddable","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@pzura:matrix.org\">pzuraq</a>: the only change we're discussing is syntax, which is definitely codemoddable","msgtype":"m.text"},"ts":1675278873150,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$rjJkcG9jZN5GskTDuz6hihryOy0afM9KrfV1MAbfU58"},
{"content":{"body":" * pzuraq: the only change we're discussing is syntax, which is definitely codemoddable","format":"org.matrix.custom.html","formatted_body":" * <a href=\"https://matrix.to/#/@pzura:matrix.org\">pzuraq</a>: the only change we're discussing is syntax, which is definitely codemoddable","m.new_content":{"body":"pzuraq: the only change we're discussing is syntax, which is definitely codemoddable","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@pzura:matrix.org\">pzuraq</a>: the only change we're discussing is syntax, which is definitely codemoddable","msgtype":"m.text"},"m.relates_to":{"event_id":"$rjJkcG9jZN5GskTDuz6hihryOy0afM9KrfV1MAbfU58","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675278876638,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$q2rEOJqyd4Hhnz4iPt4Zo4DuVowKO5Ud2l5ZuywkyXg"},
{"content":{"body":"e.g. transitioning to `accessor`","format":"org.matrix.custom.html","formatted_body":"e.g. transitioning to <code>accessor</code>","msgtype":"m.text"},"ts":1675278879911,"senderName":"pzuraq","senderId":"@pzura:matrix.org","id":"$VjA6H_F1wbZvL9XeKiuva_kbIozw2lLfrfKYBzQ5asY"},
{"content":{"body":"yes i'd prefer this discussion to be scoped to this particular change","msgtype":"m.text"},"ts":1675278898071,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$-9ImRJH10WN2UNhhdIGnJBFDJC39KO1nlTmepyISRrk"},
{"content":{"body":"not fully generic ones, or even generic ones about decorators","msgtype":"m.text"},"ts":1675278905904,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$Dt3k4leaAsligRfSOJmsxooF6061e9vRT53QtO8DrIk"},
{"content":{"body":"in that case, yes that one exact change is very codemoddable","msgtype":"m.text"},"ts":1675278916293,"senderName":"pzuraq","senderId":"@pzura:matrix.org","id":"$NAUhA8MHbGYIglIBYwydu1rV6GQnSUmiZprpevWFg9s"},
{"content":{"body":"unless the fullness of transitioning to ES decorators _is_ the point you're trying to make, which i can appreciate","format":"org.matrix.custom.html","formatted_body":"unless the fullness of transitioning to ES decorators <em>is</em> the point you're trying to make, which i can appreciate","msgtype":"m.text"},"ts":1675278930433,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$q3tDR5JbKy0Yf6DK14WbuNoHW9fodkHnwsCDwr28YRU"},
{"content":{"body":"but i didn't get that point from TS","msgtype":"m.text"},"ts":1675278940137,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$qShXX_Rg2gQo8SFTjHj9alCs6IbXpOZUu-cmMUZbdlo"},
{"content":{"body":"yes, that is the point I'm trying to make","msgtype":"m.text"},"ts":1675278943389,"senderName":"pzuraq","senderId":"@pzura:matrix.org","id":"$RA92ZWpCYwGZbXlR3Q2AAsb_s-Wf8bgxFZX5yScVS3A"},
{"content":{"body":"danielrosenwasser rbuckton pzuraq I don't think I'm available tomorrow. FWIW, option 2 works for me. I +1 the preference for XOR positioning. I also +1 to blocking decorator before ambiguous class expr.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@danielrosenwasser:matrix.org\">danielrosenwasser</a> <a href=\"https://matrix.to/#/@rbuckton:matrix.org\">rbuckton</a> <a href=\"https://matrix.to/#/@pzura:matrix.org\">pzuraq</a> I don't think I'm available tomorrow. FWIW, option 2 works for me. I +1 the preference for XOR positioning. I also +1 to blocking decorator before ambiguous class expr.","msgtype":"m.text"},"ts":1675278965620,"senderName":"leobalter","senderId":"@leobalter:matrix.org","id":"$qrPBMAZrw_J9SR6ySh7GcTGMiqHZoaMqdcxCFSGYYUc"},
{"content":{"body":" * danielrosenwasser rbuckton pzuraq I don't think I'm available tomorrow. FWIW, option 2 works for me. I +1 the preference for XOR positioning. I also +1 to blocking decorator before ambiguous class expr.","format":"org.matrix.custom.html","formatted_body":" * <a href=\"https://matrix.to/#/@danielrosenwasser:matrix.org\">danielrosenwasser</a> <a href=\"https://matrix.to/#/@rbuckton:matrix.org\">rbuckton</a> <a href=\"https://matrix.to/#/@pzura:matrix.org\">pzuraq</a> I don't think I'm available tomorrow. FWIW, option 2 works for me. I +1 the preference for XOR positioning. I also +1 to blocking decorator before ambiguous class expr.","m.new_content":{"body":"danielrosenwasser rbuckton pzuraq I don't think I'm available tomorrow. FWIW, option 2 works for me. I +1 the preference for XOR positioning. I also +1 to blocking decorator before ambiguous class expr.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@danielrosenwasser:matrix.org\">danielrosenwasser</a> <a href=\"https://matrix.to/#/@rbuckton:matrix.org\">rbuckton</a> <a href=\"https://matrix.to/#/@pzura:matrix.org\">pzuraq</a> I don't think I'm available tomorrow. FWIW, option 2 works for me. I +1 the preference for XOR positioning. I also +1 to blocking decorator before ambiguous class expr.","msgtype":"m.text"},"m.relates_to":{"event_id":"$qrPBMAZrw_J9SR6ySh7GcTGMiqHZoaMqdcxCFSGYYUc","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675278981200,"senderName":"leobalter","senderId":"@leobalter:matrix.org","id":"$FvFxvPtxdGAwS1kiOXnIcXtzDQ-BrMiX2ovH8fTfH6Y"},
{"content":{"body":"what do you mean by \"blocking decorator before ambiguous class expression\"?","msgtype":"m.text"},"ts":1675278996412,"senderName":"danielrosenwasser","senderId":"@danielrosenwasser:matrix.org","id":"$J_VETX8mRJbZtjvyN6R9YJ6xF-rMtCIWLKISdftE96Q"},
{"content":{"body":"if we do the XOR thing that implies `export default @dec class A{}` is a declaration, not an expression","format":"org.matrix.custom.html","formatted_body":"if we do the XOR thing that implies <code>export default @dec class A{}</code> is a declaration, not an expression","msgtype":"m.text"},"ts":1675279005997,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$qpbDzKStkGoEmJ6ozyIOBQWU4u4-BGpbm6LzMianMD0"},
{"content":{"body":" * if we do the XOR thing that implies `export default @dec class A{}` is a declaration, not an expression","format":"org.matrix.custom.html","formatted_body":" * if we do the XOR thing that implies <code>export default @dec class A{}</code> is a declaration, not an expression","m.new_content":{"body":"if we do the XOR thing that implies `export default @dec class A{}` is a declaration, not an expression","format":"org.matrix.custom.html","formatted_body":"if we do the XOR thing that implies <code>export default @dec class A{}</code> is a declaration, not an expression","msgtype":"m.text"},"m.relates_to":{"event_id":"$qpbDzKStkGoEmJ6ozyIOBQWU4u4-BGpbm6LzMianMD0","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675279033793,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$7xDUtjWlv_glJWbLVlyV_V49Zz_rvLVC4F3tfhrD8mA"},
{"content":{"body":"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$gTO6aM4DVgUXJaskNyv4jIqimo85LHbMtYxA32NT2-c?via=matrix.org&via=igalia.com&via=mozilla.org","m.relates_to":{"event_id":"$J_VETX8mRJbZtjvyN6R9YJ6xF-rMtCIWLKISdftE96Q","is_falling_back":true,"m.in_reply_to":{"event_id":"$J_VETX8mRJbZtjvyN6R9YJ6xF-rMtCIWLKISdftE96Q"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675279044466,"senderName":"leobalter","senderId":"@leobalter:matrix.org","id":"$q8Q9WGHIq96OdbNDg1_lGAE4garjRZ5QAEhD0vtRxus"},
{"content":{"body":"if we do decorators-only-before-export then `export default @dec class A {}` is a default export of a class expression, under some possible ways of writing the spec","format":"org.matrix.custom.html","formatted_body":"if we do decorators-only-before-export then <code>export default @dec class A {}</code> is a default export of a class expression, under some possible ways of writing the spec","msgtype":"m.text"},"ts":1675279052332,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$r7MGXgL15KKsHLxw9f-29ic3eSe4zqB7-iN7FIeZTpk"},
{"content":{"body":"in the decorators-only-before-export world that should be illegal, probably","msgtype":"m.text"},"ts":1675279068496,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$yKF06n0LGpKSfzVUecN7C9XfvRBRlm0LerO8iDGhGSw"},
{"content":{"body":"`export default @dec class A {}`","format":"org.matrix.custom.html","formatted_body":"<code>export default @dec class A {}</code>","m.relates_to":{"event_id":"$J_VETX8mRJbZtjvyN6R9YJ6xF-rMtCIWLKISdftE96Q","is_falling_back":true,"m.in_reply_to":{"event_id":"$q8Q9WGHIq96OdbNDg1_lGAE4garjRZ5QAEhD0vtRxus"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675279114344,"senderName":"leobalter","senderId":"@leobalter:matrix.org","id":"$Rh5gWzDMUu01AWcMOv-TZ-epndvBJkoTS02hKPwPabY"},
{"content":{"body":"I don't get it, the proposal already does a \"lookahead ∉ {... `@` }","format":"org.matrix.custom.html","formatted_body":"I don't get it, the proposal already does a &quot;lookahead ∉ {... <code>@</code> }","msgtype":"m.text"},"ts":1675279149689,"senderName":"danielrosenwasser","senderId":"@danielrosenwasser:matrix.org","id":"$9-Yk12C22IpAOAmJaSPmMsF6KNwRXaEiJY48BsyF-1U"},
{"content":{"body":" * I don't get it, the proposal already does a \"lookahead ∉ {... `class`, `@` }","format":"org.matrix.custom.html","formatted_body":" * I don't get it, the proposal already does a &quot;lookahead ∉ {... <code>class</code>, <code>@</code> }","m.new_content":{"body":"I don't get it, the proposal already does a \"lookahead ∉ {... `class`, `@` }","format":"org.matrix.custom.html","formatted_body":"I don't get it, the proposal already does a &quot;lookahead ∉ {... <code>class</code>, <code>@</code> }","msgtype":"m.text"},"m.relates_to":{"event_id":"$9-Yk12C22IpAOAmJaSPmMsF6KNwRXaEiJY48BsyF-1U","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1675279214609,"senderName":"danielrosenwasser","senderId":"@danielrosenwasser:matrix.org","id":"$7gDG8p2F30jLGIwxvF45Jx4tmV9SkI3j0_kce7HwQUI"},
{"content":{"body":"\"some possible ways of writing the spec\"","msgtype":"m.text"},"ts":1675279230318,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$Ja2DewoAPXKeN_bdewMEP3ItEmxWVsbZRDrZv5P92mY"},
{"content":{"body":"if it is already prohibited I assume everyone is happy","msgtype":"m.text"},"ts":1675279274812,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$4IGdIXL_NlllB1297HX8JX9YerOvCPcPLUaBkvze9rQ"},
{"content":{"body":"actually, we might be wanting the same thing leobalter ","format":"org.matrix.custom.html","formatted_body":"actually, we might be wanting the same thing <a href=\"https://matrix.to/#/@leobalter:matrix.org\">leobalter</a>","msgtype":"m.text"},"ts":1675279288160,"senderName":"danielrosenwasser","senderId":"@danielrosenwasser:matrix.org","id":"$_RYYyF-uGNffGkTpI-oP0rmgRvO7dRf7tMmrHDCEI4Y"},
{"content":{"body":"yes! I'm just sharing my support or whatever goes as my Salesforce / LWC position","m.relates_to":{"event_id":"$_RYYyF-uGNffGkTpI-oP0rmgRvO7dRf7tMmrHDCEI4Y","is_falling_back":true,"m.in_reply_to":{"event_id":"$_RYYyF-uGNffGkTpI-oP0rmgRvO7dRf7tMmrHDCEI4Y"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675279321507,"senderName":"leobalter","senderId":"@leobalter:matrix.org","id":"$CjQw4nBkU_czhOgLMULQyYT-Y-35Plvai3f_IisFSzM"},
{"content":{"body":"LWC does not use class decorators yet, but the feedback comes in from the team.","m.relates_to":{"event_id":"$_RYYyF-uGNffGkTpI-oP0rmgRvO7dRf7tMmrHDCEI4Y","is_falling_back":true,"m.in_reply_to":{"event_id":"$CjQw4nBkU_czhOgLMULQyYT-Y-35Plvai3f_IisFSzM"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675279344764,"senderName":"leobalter","senderId":"@leobalter:matrix.org","id":"$_3qH7AwNYEb8umPXDRaoy9tcQep6q4vJeraiPJ8sD1I"},
{"content":{"body":"> <@pzura:matrix.org> yes, that is the point I'm trying to make\n\nfor every file, decorators in that file will either be written using TS's old semantics or ES semantics. If you are choosing for that file to use ES semantics, it is not that hard to codemod that file, I would think. if you're changing the semantics for your whole project at once, you can run the codemod for your whole project at once.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$RA92ZWpCYwGZbXlR3Q2AAsb_s-Wf8bgxFZX5yScVS3A?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@pzura:matrix.org\">@pzura:matrix.org</a><br>yes, that is the point I&#39;m trying to make</blockquote></mx-reply>for every file, decorators in that file will either be written using TS's old semantics or ES semantics. If you are choosing for that file to use ES semantics, it is not that hard to codemod that file, I would think. if you're changing the semantics for your whole project at once, you can run the codemod for your whole project at once.","m.relates_to":{"m.in_reply_to":{"event_id":"$RA92ZWpCYwGZbXlR3Q2AAsb_s-Wf8bgxFZX5yScVS3A"}},"msgtype":"m.text"},"ts":1675279410102,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$xRJLXNHJi3TkcrEi9rSo01oc9we5emkQa66Ga0zmKT8"},
{"content":{"body":"I there's migration pain involved in getting the semantics within the decorator right, but the codemod still seems basically trivial.","msgtype":"m.text"},"ts":1675279431240,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$exPshAIOkrMWZenUg2Lg3YfU2UN0BNQHDICc5-NP6ac"},
{"content":{"body":"I do not oppose to option 1 either. Option 2 is just my preference considering the discussion the committee had.","m.relates_to":{"event_id":"$_RYYyF-uGNffGkTpI-oP0rmgRvO7dRf7tMmrHDCEI4Y","is_falling_back":true,"m.in_reply_to":{"event_id":"$_3qH7AwNYEb8umPXDRaoy9tcQep6q4vJeraiPJ8sD1I"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1675279445639,"senderName":"leobalter","senderId":"@leobalter:matrix.org","id":"$BPhz_4V38_k0sQp4KpozbZ4OmOSUIW-8jLSqd9Rmkpo"},
{"content":{"body":"btw what is a codemod","msgtype":"m.text"},"ts":1675279450299,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$kldZ9IK6ovWonpr8QTCRRU8k3rmqhnhvrTMHmzqGqdk"},
{"content":{"body":"is it \"just\" a transform","msgtype":"m.text"},"ts":1675279454812,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$Aio9lHwNDB0pSvJy7TxvKJ0zd5BoUR0fgcBQPSCx2Ww"},
{"content":{"body":"or does it have more bells and whistles attached?","msgtype":"m.text"},"ts":1675279462747,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$HakDgZr8G6_3pejNytDcScgbaFgSbHHaHICwLdL48l4"},
{"content":{"body":"in my case, just a source rewrite","msgtype":"m.text"},"ts":1675279470765,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$lTwOPMkcGfbH94osbdlX9KHiUx1dnl5CP4YUdjk3QRo"},
{"content":{"body":"string-to-string","msgtype":"m.text"},"ts":1675279473464,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$boUNzx2wSFBD4gnskoOPHi5cfvsXYMEJL_FHagEXiDE"},
{"content":{"body":"teams will have to remove some decorators and change the invocations of others, and a codemod will not be able to tell based on usage","msgtype":"m.text"},"ts":1675279475335,"senderName":"pzuraq","senderId":"@pzura:matrix.org","id":"$MiiyfRCHXK74Cptw0sVIrFP9mK7ohzzW7NGXmHRNPB0"},
{"content":{"body":"e.g. a dev will have to manually look at each decorated field to see if it needs `accessor`","format":"org.matrix.custom.html","formatted_body":"e.g. a dev will have to manually look at each decorated field to see if it needs <code>accessor</code>","msgtype":"m.text"},"ts":1675279490393,"senderName":"pzuraq","senderId":"@pzura:matrix.org","id":"$yL3fieS6LS8jSeW0Oi6y9gBsiQoaVBzXYfKY0P21zRc"},
{"content":{"body":"yeah, I agree that a codemod cannot help you with the thing where the semantics are different","msgtype":"m.text"},"ts":1675279501513,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$Orq7xTwMBEZC1cTJZZ_u3Py1unQV5ozSUzqTJgNTAk0"},
{"content":{"body":"but neither can any particular choice of syntax here","msgtype":"m.text"},"ts":1675279507582,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$D6PbtbxJLVQfdsyZZ7mdhBubixzEKprjlOHfxb3sJPc"},
{"content":{"body":"it can reduce what is going to be a very painful transition","msgtype":"m.text"},"ts":1675279521571,"senderName":"pzuraq","senderId":"@pzura:matrix.org","id":"$WfBdMaBO-VaBztJ4LhlEa4D0g8TtNFaRuiPWvrjST3c"},
{"content":{"body":"for some teams","msgtype":"m.text"},"ts":1675279524508,"senderName":"pzuraq","senderId":"@pzura:matrix.org","id":"$Rz7oLkISV_4T0Myh_C62K3BCeYnme62nY8a7Xjj5dO8"},
{"content":{"body":"on top of the other benefits, e.g. documentation costs","msgtype":"m.text"},"ts":1675279544839,"senderName":"pzuraq","senderId":"@pzura:matrix.org","id":"$Rb56z5zdVxDqfu7nlh2uJ730ocblFBGMMs9_gCMMbrw"},
{"content":{"body":"I just don't see the \"after going through every decorator in this file and migrating it so it's going to be ES-semantics-compatible, also run a codemod after\" as being a noticeable change in the amount of pain","msgtype":"m.text"},"ts":1675279570536,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$rbEvK1rONvHNoOzBLA6hCUsagisTZlJAnlukc5vhJ10"},
{"content":{"body":"I agree the transition is painful in general but not that this particular thing is more than a trivial additional amount of pain","msgtype":"m.text"},"ts":1675279589537,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$tXrnqt9EH1dD5R7DscXTCbNESQT75hPk8R1ySVzT5h8"}
]