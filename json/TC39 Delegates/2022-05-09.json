[
{"content":{"body":"Unlucky ","msgtype":"m.text"},"ts":1652062658454,"senderName":"Jack Works","senderId":"@jackworks:matrix.org","id":"$htcs5e-ilv7sodA7zmmBNgHl11pYs-8yzlJZNR51hUs"},
{"content":{"body":"What's the reason it being rejected? ","msgtype":"m.text"},"ts":1652062659125,"senderName":"Jack Works","senderId":"@jackworks:matrix.org","id":"$qTbJK2aXauv5hUHD8Ar6TY7Yx5sh9uh7hMR-nI6R3-I"},
{"content":{"body":"it was considered to be adding too much complexity","msgtype":"m.text","org.matrix.msc1767.text":"it was considered to be adding too much complexity"},"ts":1652066888557,"senderName":"devsnek","senderId":"@devsnek:matrix.org","id":"$7fHRGJe7pe_9BPGEdiM47ksuoD-u1KS8dxAUCyPaaeg"},
{"content":{"body":"ultimately i think that was a mistake (i still see people run into the dynamic import problem in the wild) but what can ya do ðŸ¤·","msgtype":"m.text","org.matrix.msc1767.text":"ultimately i think that was a mistake (i still see people run into the dynamic import problem in the wild) but what can ya do ðŸ¤·"},"ts":1652066939680,"senderName":"devsnek","senderId":"@devsnek:matrix.org","id":"$3sDhiv5OaWtyPccuK0DUXXpWxxPAMp5WLcwLA2qI6e0"},
{"content":{"body":"hmm here are the notes https://github.com/tc39/notes/blob/main/meetings/2018-05/may-24.md#symbolthenable-for-stage-1-or-2","msgtype":"m.text","org.matrix.msc1767.text":"hmm here are the notes https://github.com/tc39/notes/blob/main/meetings/2018-05/may-24.md#symbolthenable-for-stage-1-or-2"},"ts":1652067042011,"senderName":"devsnek","senderId":"@devsnek:matrix.org","id":"$X7jveph3LaI_0Y-l-WAj8UOHvoAbNC6XKykXbw6wph0"},
{"content":{"body":"> <@jackworks:matrix.org> Is it possible to add a Symbol.unthenable and attach it to the module namespace object? \n\nI think unfortunately that ship has definitely sailed. At this point adding such a symbol to the language wouldn't accomplish anything. You can't add such a symbol automatically to all module namespace objects as it'd be Web incompatible. And developers can't add such a symbol themselves (only string identifiers can be exports) before they'd get tripped by a dynamic import.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$ltXz5Ukl3LwA7jBzlHBE_JYcYpG1O6wZfWcikPSZJ94?via=matrix.org&via=mozilla.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@jackworks:matrix.org\">@jackworks:matrix.org</a><br />Is it possible to add a Symbol.unthenable and attach it to the module namespace object?</blockquote></mx-reply>I think unfortunately that ship has definitely sailed. At this point adding such a symbol to the language wouldn't accomplish anything. You can't add such a symbol automatically to all module namespace objects as it'd be Web incompatible. And developers can't add such a symbol themselves (only string identifiers can be exports) before they'd get tripped by a dynamic import.","m.relates_to":{"m.in_reply_to":{"event_id":"$ltXz5Ukl3LwA7jBzlHBE_JYcYpG1O6wZfWcikPSZJ94"}},"msgtype":"m.text"},"ts":1652069092510,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$CJbDGMTtOLhrjUV-B3bPmnJclvMV0d_U_xe3RMrRSCc"},
{"content":{"body":"Just some history... the hazard of dynamic import resolving thenables was known ahead of time.  I tried to point it out but it didn't end up going anywhere as it was framed as yet-another-instance of an existing hazard.\n\nhttps://github.com/tc39/proposal-dynamic-import/issues/48","msgtype":"m.text","org.matrix.msc1767.text":"Just some history... the hazard of dynamic import resolving thenables was known ahead of time.  I tried to point it out but it didn't end up going anywhere as it was framed as yet-another-instance of an existing hazard.\n\nhttps://github.com/tc39/proposal-dynamic-import/issues/48"},"ts":1652081181148,"senderName":"Rob Palmer","senderId":"@robpalme:matrix.org","id":"$ktdZQGo-3B7WqMpD6CB2IPEd0sTBJI314iqhPfTF2Dw"},
{"content":{"body":"> <@mhofman:matrix.org> I think unfortunately that ship has definitely sailed. At this point adding such a symbol to the language wouldn't accomplish anything. You can't add such a symbol automatically to all module namespace objects as it'd be Web incompatible. And developers can't add such a symbol themselves (only string identifiers can be exports) before they'd get tripped by a dynamic import.\n\nwhy would it be web incompatible? exports can't provide symbols there, specifically so we CAN add a new symbol to module namespace objects at any time.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$CJbDGMTtOLhrjUV-B3bPmnJclvMV0d_U_xe3RMrRSCc?via=matrix.org&via=mozilla.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@mhofman:matrix.org\">@mhofman:matrix.org</a><br>I think unfortunately that ship has definitely sailed. At this point adding such a symbol to the language wouldn't accomplish anything. You can't add such a symbol automatically to all module namespace objects as it'd be Web incompatible. And developers can't add such a symbol themselves (only string identifiers can be exports) before they'd get tripped by a dynamic import.</blockquote></mx-reply>why would it be web incompatible? exports can't provide symbols there, specifically so we CAN add a new symbol to module namespace objects at any time.","m.relates_to":{"m.in_reply_to":{"event_id":"$CJbDGMTtOLhrjUV-B3bPmnJclvMV0d_U_xe3RMrRSCc"}},"msgtype":"m.text","org.matrix.msc1767.message":[{"body":"> <@mhofman:matrix.org> I think unfortunately that ship has definitely sailed. At this point adding such a symbol to the language wouldn't accomplish anything. You can't add such a symbol automatically to all module namespace objects as it'd be Web incompatible. And developers can't add such a symbol themselves (only string identifiers can be exports) before they'd get tripped by a dynamic import.\n\nwhy would it be web incompatible? exports can't provide symbols there, specifically so we CAN add a new symbol to module namespace objects at any time.","mimetype":"text/plain"},{"body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw:matrix.org/$CJbDGMTtOLhrjUV-B3bPmnJclvMV0d_U_xe3RMrRSCc?via=matrix.org&via=mozilla.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@mhofman:matrix.org\">@mhofman:matrix.org</a><br>I think unfortunately that ship has definitely sailed. At this point adding such a symbol to the language wouldn't accomplish anything. You can't add such a symbol automatically to all module namespace objects as it'd be Web incompatible. And developers can't add such a symbol themselves (only string identifiers can be exports) before they'd get tripped by a dynamic import.</blockquote></mx-reply>why would it be web incompatible? exports can't provide symbols there, specifically so we CAN add a new symbol to module namespace objects at any time.","mimetype":"text/html"}]},"ts":1652122784083,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$4WU1FrWF9nGpeZ7-KS4ThMkpanXrC5mkAsGLeTK0esA"},
{"content":{"body":"or do you just mean, making it unthenable would be incompatible","msgtype":"m.text","org.matrix.msc1767.text":"or do you just mean, making it unthenable would be incompatible"},"ts":1652122857935,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$X4k-h30DpXGhGa2NtHvziSS495jrhptlWhM14KpKF3s"},
{"content":{"body":"I meant adding a symbol such as unthenable by default to all module namespace objects. There are modules in the wild that do expect this thenable behavior","msgtype":"m.text","org.matrix.msc1767.text":"I meant adding a symbol such as unthenable by default to all module namespace objects. There are modules in the wild that do expect this thenable behavior"},"ts":1652122860266,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$jHNlGTuouYo773PCtZ8osn62tBvE97y1vWwpU3hlfxY"},
{"content":{"body":"right, true enough. altho probably not a ton, since having a thenable module is broken in node (i forget if it's broken just in the repl, or just not in the repl)","msgtype":"m.text","org.matrix.msc1767.text":"right, true enough. altho probably not a ton, since having a thenable module is broken in node (i forget if it's broken just in the repl, or just not in the repl)"},"ts":1652122893999,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$fQUH-mX2sGnHo0uRtyfGKmypjSRK3UurrIZwxp_UQgw"},
{"content":{"body":"It definitely works in the browser, I have personally (ab)used this mechanism","msgtype":"m.text","org.matrix.msc1767.text":"It definitely works in the browser, I have personally (ab)used this mechanism"},"ts":1652123081932,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$40XGUz02T8WgVBgftUdUpyZh8KvWH0yICMV5vDANN0Y"},
{"content":{"body":"Ooo boy, did anyone realize we don't actually follow the Promises A+ spec?","msgtype":"m.text","org.matrix.msc1767.text":"Ooo boy, did anyone realize we don't actually follow the Promises A+ spec?"},"ts":1652125302955,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$DEewwlMPfmD_Q7p_hng9RInIPbapnoSwqE5Iuy48NL8"},
{"content":{"body":"We pass the spec's tests, only because it forgot to test a behavior.","msgtype":"m.text","org.matrix.msc1767.text":"We pass the spec's tests, only because it forgot to test a behavior."},"ts":1652125324166,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$3t7Fbze1iAOSx1KyxAOhj7Yi_cutAIdGq_KneXsPNKs"},
{"content":{"body":"Step 13-15 of https://tc39.es/ecma262/multipage/control-abstraction-objects.html#sec-promise-resolve-functions","msgtype":"m.text","org.matrix.msc1767.text":"Step 13-15 of https://tc39.es/ecma262/multipage/control-abstraction-objects.html#sec-promise-resolve-functions"},"ts":1652125359474,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$fVWpUp4_F0XGnTr1NKnmG7o868hYbHdxpsgEIdbxsj8"},
{"content":{"body":"We create a new job to handle a thenable passed to `resovle` in `new Promise(res => res(thenable))`","format":"org.matrix.custom.html","formatted_body":"We create a new job to handle a thenable passed to <code>resovle</code> in <code>new Promise(res =&gt; res(thenable))</code>","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"We create a new job to handle a thenable passed to `resovle` in `new Promise(res => res(thenable))`","mimetype":"text/plain"},{"body":"We create a new job to handle a thenable passed to <code>resovle</code> in <code>new Promise(res =&gt; res(thenable))</code>","mimetype":"text/html"}]},"ts":1652125393625,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$wCWRt_CEFyEhlvBDav8Te2RIkcHOTHKBwTI8k-tPcOA"},
{"content":{"body":"That's not correct","msgtype":"m.text","org.matrix.msc1767.text":"That's not correct"},"ts":1652125399495,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$RUIhLOW-N8JfDXZcUgzWlto47IZEEZDfNo4K3rO1AE0"},
{"content":{"body":"https://promisesaplus.com/#point-56","msgtype":"m.text","org.matrix.msc1767.text":"https://promisesaplus.com/#point-56"},"ts":1652125423172,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$s2BS6SyAnwOv0_7KWuQTJEsN0rhkZrM801y3x--3O4g"},
{"content":{"body":"> If then is a function, call it with x as this, first argument resolvePromise, and second argument rejectPromise, where...","format":"org.matrix.custom.html","formatted_body":"<blockquote>\n<p>If then is a function, call it with x as this, first argument resolvePromise, and second argument rejectPromise, where...</p>\n</blockquote>\n","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"> If then is a function, call it with x as this, first argument resolvePromise, and second argument rejectPromise, where...","mimetype":"text/plain"},{"body":"<blockquote>\n<p>If then is a function, call it with x as this, first argument resolvePromise, and second argument rejectPromise, where...</p>\n</blockquote>\n","mimetype":"text/html"}]},"ts":1652125456037,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$l3dgnUfPoRQ5GWKDB82OveRsIcVdMfD67uF1-31WVes"},
{"content":{"body":"It makes no mention of a new job for thenables","msgtype":"m.text","org.matrix.msc1767.text":"It makes no mention of a new job for thenables"},"ts":1652125466925,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$_giWrY1o0JsWahj_dQqTklkLLf_McTpaC0dX7lclbwA"},
{"content":{"body":" * It makes no mention of a new job for thenables","m.new_content":{"body":"It makes no mention of a new job for thenables","msgtype":"m.text","org.matrix.msc1767.text":"It makes no mention of a new job for thenables"},"m.relates_to":{"event_id":"$_giWrY1o0JsWahj_dQqTklkLLf_McTpaC0dX7lclbwA","rel_type":"m.replace"},"msgtype":"m.text","org.matrix.msc1767.text":" * It makes no mention of a new job for thenables"},"ts":1652125479977,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$5bamrVRjE-W78gcmA1i4r5pTyIL9BbOPrZbwAkKIiJE"},
{"content":{"body":"This is the root cause of both https://github.com/tc39/ecma262/issues/2770 and https://github.com/tc39/ecma262/issues/1250","msgtype":"m.text","org.matrix.msc1767.text":"This is the root cause of both https://github.com/tc39/ecma262/issues/2770 and https://github.com/tc39/ecma262/issues/1250"},"ts":1652125506223,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$Ok5mRMX5oDxXuCsVR9SYp5x0guc4XFGte9-vd-SCcqQ"},
{"content":{"body":"`thenable.then(resolve)` and `resolve(thenable)` are supposed to take the same number of ticks.","format":"org.matrix.custom.html","formatted_body":"<code>thenable.then(resolve)</code> and <code>resolve(thenable)</code> are supposed to take the same number of ticks.","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"`thenable.then(resolve)` and `resolve(thenable)` are supposed to take the same number of ticks.","mimetype":"text/plain"},{"body":"<code>thenable.then(resolve)</code> and <code>resolve(thenable)</code> are supposed to take the same number of ticks.","mimetype":"text/html"}]},"ts":1652125622452,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$NJoOYf2UyKKauEYvPJJ1vnTfAkgiej36ij0tTC6utts"},
{"content":{"body":"But because `resolve(thenable)` creates a new job for doing the `then.call(prom, onFul, onRej)` and the `then` internally creates a new job before calling `onFul`/`onRej`, we get 2 ticks instead of 1.","format":"org.matrix.custom.html","formatted_body":"But because <code>resolve(thenable)</code> creates a new job for doing the <code>then.call(prom, onFul, onRej)</code> and the <code>then</code> internally creates a new job before calling <code>onFul</code>/<code>onRej</code>, we get 2 ticks instead of 1.","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"But because `resolve(thenable)` creates a new job for doing the `then.call(prom, onFul, onRej)` and the `then` internally creates a new job before calling `onFul`/`onRej`, we get 2 ticks instead of 1.","mimetype":"text/plain"},{"body":"But because <code>resolve(thenable)</code> creates a new job for doing the <code>then.call(prom, onFul, onRej)</code> and the <code>then</code> internally creates a new job before calling <code>onFul</code>/<code>onRej</code>, we get 2 ticks instead of 1.","mimetype":"text/html"}]},"ts":1652125685217,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$kCnssKYZZl4OqwPWC0Fp2uBgGeN0GpN2trgLO1sOr3Y"},
{"content":{"body":" * But because `resolve(thenable)` creates a new job for doing the `then.call(prom, onFul, onRej)` and the `then` internally creates a new job before calling `onFul`/`onRej`, we get 2 ticks instead of 1.","format":"org.matrix.custom.html","formatted_body":" * But because <code>resolve(thenable)</code> creates a new job for doing the <code>then.call(prom, onFul, onRej)</code> and the <code>then</code> internally creates a new job before calling <code>onFul</code>/<code>onRej</code>, we get 2 ticks instead of 1.","m.new_content":{"body":"But because `resolve(thenable)` creates a new job for doing the `then.call(prom, onFul, onRej)` and the `then` internally creates a new job before calling `onFul`/`onRej`, we get 2 ticks instead of 1.","format":"org.matrix.custom.html","formatted_body":"But because <code>resolve(thenable)</code> creates a new job for doing the <code>then.call(prom, onFul, onRej)</code> and the <code>then</code> internally creates a new job before calling <code>onFul</code>/<code>onRej</code>, we get 2 ticks instead of 1.","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"But because `resolve(thenable)` creates a new job for doing the `then.call(prom, onFul, onRej)` and the `then` internally creates a new job before calling `onFul`/`onRej`, we get 2 ticks instead of 1.","mimetype":"text/plain"},{"body":"But because <code>resolve(thenable)</code> creates a new job for doing the <code>then.call(prom, onFul, onRej)</code> and the <code>then</code> internally creates a new job before calling <code>onFul</code>/<code>onRej</code>, we get 2 ticks instead of 1.","mimetype":"text/html"}]},"m.relates_to":{"event_id":"$kCnssKYZZl4OqwPWC0Fp2uBgGeN0GpN2trgLO1sOr3Y","rel_type":"m.replace"},"msgtype":"m.text","org.matrix.msc1767.message":[{"body":" * But because `resolve(thenable)` creates a new job for doing the `then.call(prom, onFul, onRej)` and the `then` internally creates a new job before calling `onFul`/`onRej`, we get 2 ticks instead of 1.","mimetype":"text/plain"},{"body":" * But because <code>resolve(thenable)</code> creates a new job for doing the <code>then.call(prom, onFul, onRej)</code> and the <code>then</code> internally creates a new job before calling <code>onFul</code>/<code>onRej</code>, we get 2 ticks instead of 1.","mimetype":"text/html"}]},"ts":1652125705757,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$UhQc8mckc6nuCxYbj54MkbJQq42bM0E6-FKMN6TBSH8"},
{"content":{"body":"It might be tricky to untangle this. `Promise.resolve()` should most likely not call `.then` in the same tick (It's already unfortunate it does a `[[Get]]` of the `constructor` and `then`). Maybe there is a way to not use a new callback job if we're already inside then callback job? I haven't thought this through yet.","format":"org.matrix.custom.html","formatted_body":"It might be tricky to untangle this. <code>Promise.resolve()</code> should most likely not call <code>.then</code> in the same tick (It's already unfortunate it does a <code>[[Get]]</code> of the <code>constructor</code> and <code>then</code>). Maybe there is a way to not use a new callback job if we're already inside then callback job? I haven't thought this through yet.","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"It might be tricky to untangle this. `Promise.resolve()` should most likely not call `.then` in the same tick (It's already unfortunate it does a `[[Get]]` of the `constructor` and `then`). Maybe there is a way to not use a new callback job if we're already inside then callback job? I haven't thought this through yet.","mimetype":"text/plain"},{"body":"It might be tricky to untangle this. <code>Promise.resolve()</code> should most likely not call <code>.then</code> in the same tick (It's already unfortunate it does a <code>[[Get]]</code> of the <code>constructor</code> and <code>then</code>). Maybe there is a way to not use a new callback job if we're already inside then callback job? I haven't thought this through yet.","mimetype":"text/html"}]},"ts":1652126719891,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$xbH7j0u2uvasyfwIAfnPbhaIY8RxeqPjvt59zSIWxxk"}
]