[
{"content":{"body":"and yes I expected to be called out for that one","m.mentions":{},"msgtype":"m.text"},"ts":1740009606506,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$2YAiFQLQVsAQbNiLVL9S9vzz2ZJJ8iviEHQDbLVuBHw"},
{"content":{"body":"counterpoint: i really want composite keys","m.mentions":{"user_ids":["@ljharb:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$oTBqGwGZaxClHYT0C83jelYM_MYWMS6ys6ypkJ7LnJI"}},"msgtype":"m.text"},"ts":1740009607017,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$DKSZvrJcq6uCfXsa5EKgat-XeD9mDyvCkwsNYeU--lY"},
{"content":{"body":"doesn't matter, we do the right thing","msgtype":"m.text"},"ts":1740009608676,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$XxsmW6j9guCHJjd9CAf4ja1k1uA9Hwwh6my7Uiv7oOw"},
{"content":{"body":"i also want them, but i'm not sure why the two are linked","m.mentions":{"user_ids":["@bakkot:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$DKSZvrJcq6uCfXsa5EKgat-XeD9mDyvCkwsNYeU--lY"}},"msgtype":"m.text"},"ts":1740009625900,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$eTY7NI0A2DJGjW6FwI8BSX7Mqi277G0eMmUV_E6sHvk"},
{"content":{"body":"Manually building tries is a pain","m.mentions":{"user_ids":["@bakkot:matrix.org","@ljharb:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$DKSZvrJcq6uCfXsa5EKgat-XeD9mDyvCkwsNYeU--lY"}},"msgtype":"m.text"},"ts":1740009634486,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$Nygc4z1Kof7qQ9Av-RLnd_VxH9UStB3MeV4alzKogz8"},
{"content":{"body":"this proposal is just composite keys","m.mentions":{},"msgtype":"m.text"},"ts":1740009638230,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$KUsQkvtJuGHbJTZhCG8587UxLd2Ya-3zHLWY_9OM8yw"},
{"content":{"body":"that is the whole proposal","m.mentions":{},"msgtype":"m.text"},"ts":1740009644518,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$CGqlE8fG9U9KZsnQtdfdBy9KEx9phoAE2irljZzi9UQ"},
{"content":{"body":"if I understand correctly","m.mentions":{},"msgtype":"m.text"},"ts":1740009647514,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$n5PcMptBqejDm5qLyxyMPoMGuMpNr20-Vo7vcLxK9V4"},
{"content":{"body":"oh","m.mentions":{},"msgtype":"m.text"},"ts":1740009647689,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$fIm2XVn9Pk-e5CK2PxBRn11uC44vF0JphUfsgKM63kg"},
{"content":{"body":"right, but can't it just, like, do the nested weakmap + a finalization-registered weakref, in the spec?","m.mentions":{},"msgtype":"m.text"},"ts":1740009674631,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$BVL3jwQm5h0RnM5h6XM5NBa3_fM0QCHr1r5-gDSKpeo"},
{"content":{"body":"A goal of the presentation is for delegates to say \"yeah let's just do composite keys\", or \"let's do R&T\"","m.mentions":{},"msgtype":"m.text"},"ts":1740009678547,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$9nLUbTb-Jdu7YT51FFoiTgfHbwxv7BhLiH_3csjC8WA"},
{"content":{"body":"I can't bother my pretty head with `NaN` and `-0`","format":"org.matrix.custom.html","formatted_body":"I can't bother my pretty head with <code>NaN</code> and <code>-0</code>","m.mentions":{},"msgtype":"m.text"},"ts":1740009679743,"senderName":"Jesse (TC39 ðŸ‡ºðŸ‡¸)","senderId":"@jesse:igalia.com","id":"$bS9rRcBaK3vkAsvWtNapVgMUa0IyO3FKouOFZ0KUHQw"},
{"content":{"body":"then a composite key of the same object will never observably be a different object","m.mentions":{},"msgtype":"m.text"},"ts":1740009689392,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$cHTedO40PBn0-1LxUHNPLeFd7ZVAltwczFfBOOiXymo"},
{"content":{"body":"then you can't do a composite key of only primtiives","m.mentions":{"user_ids":["@ljharb:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$BVL3jwQm5h0RnM5h6XM5NBa3_fM0QCHr1r5-gDSKpeo"}},"msgtype":"m.text"},"ts":1740009692122,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$-dCHZ5RqpJNpMWsWMuZBkdMW3wbDRv5coPx6LkszkE8"},
{"content":{"body":"which is bad and dumb","m.mentions":{},"msgtype":"m.text"},"ts":1740009700318,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$-Ko25-vDKtZ2yWvSH3X35gsI2VjZ0CWw6Zt0EUmn1aE"},
{"content":{"body":"have a parallel Map for that?","m.mentions":{},"msgtype":"m.text"},"ts":1740009702966,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$sjas__ZLk3GuXWZDzSAzcbTc2EXhrWg8gpOcwkTB3Pc"},
{"content":{"body":"then you leak","m.mentions":{},"msgtype":"m.text"},"ts":1740009708725,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$OmgETDpHpTQHeODF6gVmqgSRkDfbNHanzj5WltVl7Rc"},
{"content":{"body":"which is bad and dumb","m.mentions":{},"msgtype":"m.text"},"ts":1740009710656,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$9L28q83zU0ghOW0VCN6IJvrAnJ2bDZUa5oKlIdXJnLk"},
{"content":{"body":"only primitives go in the Map","m.mentions":{},"msgtype":"m.text"},"ts":1740009715282,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$8Vj-DrEnLtGU7PUfGsomRWuCyPTTjYhYzsGYvEaNHHM"},
{"content":{"body":"yeah that leaks","m.mentions":{},"msgtype":"m.text"},"ts":1740009723499,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$cg9dLjoI3SZNYKKE0HwoEY8sWHKg1JmIVeAuv7LM-44"},
{"content":{"body":"oh","m.mentions":{},"msgtype":"m.text"},"ts":1740009726068,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$veFN17MJ8qIkKek6bjAh_gFM2AcHeiuIsawEvgBsAFs"},
{"content":{"body":"hm","m.mentions":{},"msgtype":"m.text"},"ts":1740009734443,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$Hn3d2e9EoaUcgyB3Z9D9elmbs76qJIa8Bg2-0eWXrc8"},
{"content":{"body":"this space is well-expored in userland","m.mentions":{},"msgtype":"m.text"},"ts":1740009736370,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$WidR8LbZniN7MuCKgJjh_5TSbQE44jfuTcZS8ARS6sQ"},
{"content":{"body":"you can't ever collect those entries because they're forgable ","m.mentions":{},"msgtype":"m.text"},"ts":1740009741929,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$txvC3DXAiIvEyjH4-2bVde9i8PLZX4RN4-R1QeuA18I"},
{"content":{"body":"then i guess we need `===` overloaded","format":"org.matrix.custom.html","formatted_body":"then i guess we need <code>===</code> overloaded","m.mentions":{},"msgtype":"m.text"},"ts":1740009747118,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$vAStO5JzctnrLliQjZWH-J_pLieldEPI8x3lY5IdnFk"},
{"content":{"body":"the links from the slides have a few different approaches","m.mentions":{},"msgtype":"m.text"},"ts":1740009750609,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$zFX7C2kjsQe6W6Y27ElX2lVkPxXnr347SrsZMYVe0G0"},
{"content":{"body":"* this space is well-explored in userland","m.mentions":{},"m.new_content":{"body":"this space is well-explored in userland","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$WidR8LbZniN7MuCKgJjh_5TSbQE44jfuTcZS8ARS6sQ","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1740009767472,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$xWCBsh9A3nI0su5S03glAOCcN00Vrx8T5IBMUSoXChI"},
{"content":{"body":"if you do the finalizationregistry thing, it does not leak if a composite key of only primitives become unreachable, even with a map, no?","m.mentions":{},"msgtype":"m.text"},"ts":1740009794874,"senderName":"Luca Casonato","senderId":"@lucacasonato:matrix.org","id":"$Bl1qCAeUNty5p0Ox1FC5bZamc_36zrYXg2R-dkmK20o"},
{"content":{"body":"is the implementor worry that it will slow down *all* `===` occurances","format":"org.matrix.custom.html","formatted_body":"is the implementor worry that it will slow down <em>all</em> <code>===</code> occurances","m.mentions":{},"msgtype":"m.text"},"ts":1740009852545,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$V6KjXOOSyFQ6_35ibTwWelVww69d_rjZH1ERMrPrpcA"},
{"content":{"body":"It has to, because the components of the composite key would always be forgeable, the composite of them is forgeable","m.mentions":{},"msgtype":"m.text"},"ts":1740009863561,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$Tf31QF4IH0hrvlwMNyQ_Q8_YwZJdM31xx6dLG9y--yk"},
{"content":{"body":"Yeah, I defined a bunch of collections before Map was added to the language, where you brought your own contentEquals contentCompare, which I suppose is analogous to species.","m.mentions":{},"msgtype":"m.text"},"ts":1740009873774,"senderName":"kriskowal","senderId":"@kriskowal:aelf.land","id":"$HHHrKxRF_S5tz3XBq7iAsEpfvjhIPahNE5WnNJGTSzY"},
{"content":{"body":"> <@devsnek:matrix.org> is the implementor worry that it will slow down *all* `===` occurances\n\nI think that's the claim (in the past)","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw%3Amatrix.org/%24V6KjXOOSyFQ6_35ibTwWelVww69d_rjZH1ERMrPrpcA\">In reply to</a><a href=\"https://matrix.to/#/%40devsnek%3Amatrix.org\">@devsnek:matrix.org</a><br />is the implementor worry that it will slow down <em>all</em> <code>===</code> occurances</blockquote></mx-reply>I think that&#39;s the claim (in the past)","m.relates_to":{"m.in_reply_to":{"event_id":"$V6KjXOOSyFQ6_35ibTwWelVww69d_rjZH1ERMrPrpcA"}},"msgtype":"m.text"},"ts":1740009873791,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$AxGAiQ923RZZGsbjaqBKUAlFfKkpWu5AAmez4PThM2U"},
{"content":{"body":"* It has to leak, because the components of the composite key would always be forgeable, the composite of them is forgeable","m.mentions":{},"m.new_content":{"body":"It has to leak, because the components of the composite key would always be forgeable, the composite of them is forgeable","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$Tf31QF4IH0hrvlwMNyQ_Q8_YwZJdM31xx6dLG9y--yk","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1740009882717,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$NWjUPLhI14ikJc9uugmGOvW8SwcoozfKyeHA-RRsV8k"},
{"content":{"body":"I guess we could in principle say that a composite key of only primitives cannot be held weakly","m.mentions":{},"msgtype":"m.text"},"ts":1740009893727,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$5EvjrjaGfRCVrILMKv0jRp6BShDUSm27TAtNn-H8z3s"},
{"content":{"body":"what is this a response to?","m.mentions":{"user_ids":["@mhofman:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$Tf31QF4IH0hrvlwMNyQ_Q8_YwZJdM31xx6dLG9y--yk"}},"msgtype":"m.text"},"ts":1740009896105,"senderName":"Luca Casonato","senderId":"@lucacasonato:matrix.org","id":"$w0V4WIoVUfpOh6NPjeTU4Wam28sxFNa2OnIs-v8j_eY"},
{"content":{"body":"and maybe that solves the problem?","m.mentions":{},"msgtype":"m.text"},"ts":1740009896933,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$bRx-Wn2LFw1EWB53yGJNH1X0nkpD7A3dBEocH3unbm4"},
{"content":{"body":"oh right yes obviously","m.mentions":{},"msgtype":"m.text"},"ts":1740009916829,"senderName":"Luca Casonato","senderId":"@lucacasonato:matrix.org","id":"$yXaoPolhY1Vuf71-byNBGAh2JoPFVJt3fx0Anr60yDQ"},
{"content":{"body":"that seems perfectly reasonable","m.mentions":{},"msgtype":"m.text"},"ts":1740009917925,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$yrKujYBc-4pwfK4kCqjWqAxP20o3sabsUCExogkFXTo"},
{"content":{"body":"but what if it's an object ?","m.mentions":{"user_ids":["@bakkot:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$5EvjrjaGfRCVrILMKv0jRp6BShDUSm27TAtNn-H8z3s"}},"msgtype":"m.text"},"ts":1740009926889,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$bDmg2c3BSAkbVKnU_m1QyjmM1ZDpu8hwWXFQnuUC1Kw"},
{"content":{"body":"(it makes an even stronger case for a built-in \"isWeakable\" predicate, ofc)","m.mentions":{},"msgtype":"m.text"},"ts":1740009932992,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$9fY373ccyVaXr-aIKA2vHf4MbHknE7UO9_6CrBWn090"},
{"content":{"body":"I was expecting you to say \"this breaks the predicate to check when I can put something in a weakmap)","m.mentions":{"user_ids":["@ljharb:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$yrKujYBc-4pwfK4kCqjWqAxP20o3sabsUCExogkFXTo"}},"msgtype":"m.text"},"ts":1740009939324,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$dhCdv80ktJCUa6pWlUAZO5s5QwvK1__O4M3NIGquanM"},
{"content":{"body":"Oh there it is :)","m.mentions":{},"msgtype":"m.text"},"ts":1740009944949,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$aS8BIA9TGZZbG2DcfbLOYxdYiVkAOkDrAbLF_9RxWk0"},
{"content":{"body":"I do not understand the question","m.mentions":{"user_ids":["@mhofman:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$bDmg2c3BSAkbVKnU_m1QyjmM1ZDpu8hwWXFQnuUC1Kw"}},"msgtype":"m.text"},"ts":1740009945839,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$mk6P4s0xzTK7ALYemxDNINC0wECb2Jx7rzVQMWkBIl0"},
{"content":{"body":"* I was expecting you to say \"this breaks the predicate to check when I can put something in a weakmap\"","m.mentions":{},"m.new_content":{"body":"I was expecting you to say \"this breaks the predicate to check when I can put something in a weakmap\"","m.mentions":{"user_ids":["@ljharb:matrix.org"]},"msgtype":"m.text"},"m.relates_to":{"event_id":"$dhCdv80ktJCUa6pWlUAZO5s5QwvK1__O4M3NIGquanM","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1740009953430,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$csL2-L1lq3MHgCqfRMWXCg1-6ChIVUY8izT_bPgiPkU"},
{"content":{"body":"having a non-weakable object is def weird too","m.mentions":{},"msgtype":"m.text"},"ts":1740009977153,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$09J1nMDaAxY8jd_ikHP0LHFwytruXK1QwdX8U07dXNM"},
{"content":{"body":"See above discussion. An object is currently expected to be usable as a weak map key","m.mentions":{},"msgtype":"m.text"},"ts":1740010006294,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$HPOk3UqE2rbk9cq0qcWLoXxEgDp67MlCrjhcMYyKQ7c"},
{"content":{"body":"> <@ljharb:matrix.org> having a non-weakable object is def weird too\n\nno weirder than registered symbols","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!WgJwmjBNZEXhJnXHXw%3Amatrix.org/%2409J1nMDaAxY8jd_ikHP0LHFwytruXK1QwdX8U07dXNM\">In reply to</a><a href=\"https://matrix.to/#/%40ljharb%3Amatrix.org\">@ljharb:matrix.org</a><br />having a non-weakable object is def weird too</blockquote></mx-reply>no weirder than registered symbols","m.relates_to":{"m.in_reply_to":{"event_id":"$09J1nMDaAxY8jd_ikHP0LHFwytruXK1QwdX8U07dXNM"}},"msgtype":"m.text"},"ts":1740010028410,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$1x4BjOtUNia5kboBUH1v4u2nXDyZ2YtIiwPAS7dyy_4"},
{"content":{"body":"they're both differently weird. which is weirder in aggregate","m.mentions":{},"msgtype":"m.text"},"ts":1740010071311,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$xgH77rHJGR0-qIlwvXaYCazTlb5qUe9Sv9lpDLSlkzs"},
{"content":{"body":"(this would also require the thing from the previous presentation where non-extensible objects could not get stamped with private fields, incidentally)","m.mentions":{},"msgtype":"m.text"},"ts":1740010099633,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$r7PMZzb0orxtK6k2wPQjt1D2zguehm6zHx1Eei9gNmI"},
{"content":{"body":"ooooo composite keys would obviate `Array.prototype.uniqBy` ðŸ˜®","format":"org.matrix.custom.html","formatted_body":"ooooo composite keys would obviate <code data-md=\"`\">Array.prototype.uniqBy</code> ðŸ˜®","msgtype":"m.text"},"ts":1740010185628,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$ESjNqvlB67rZJ6DRvVPUK74Hbqq-Wvd9PiReU7a2pwI"},
{"content":{"body":"god I need this","msgtype":"m.text"},"ts":1740010198208,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$ZN7gLdvVayR4VIpZu9iNQHFX_hX6_qhxxMNd-xVrZgA"}
]