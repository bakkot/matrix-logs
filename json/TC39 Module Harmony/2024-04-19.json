[
{"content":{"body":"I filed https://github.com/nodejs/node/issues/52599 which I hope sums up our discussion yesterday; please let me know if I got anything wrong!","m.mentions":{},"msgtype":"m.text"},"ts":1713546007178,"senderName":"jakebailey","senderId":"@jakebailey:matrix.org","id":"$fmddKX5sXd6KzR00BZwQDhQQDrxnnl0308jxhSMHdjo"},
{"content":{"body":"Relevant here, naugtur has added `loadNow` and `importNowHook` to our `Compartment` shim and cleverly was able to use the same loader logic for both the sync and async drivers. This provides some support for an `import.now` that I think is coherent with Node.js doing a sync ESM import behind CJS require. https://github.com/endojs/endo/pull/2202","format":"org.matrix.custom.html","formatted_body":"Relevant here, <a href=\"https://matrix.to/#/@naugtur:matrix.org\">naugtur</a> has added <code>loadNow</code> and <code>importNowHook</code> to our <code>Compartment</code> shim and cleverly was able to use the same loader logic for both the sync and async drivers. This provides some support for an <code>import.now</code> that I think is coherent with Node.js doing a sync ESM import behind CJS require. https://github.com/endojs/endo/pull/2202","m.mentions":{"user_ids":["@naugtur:matrix.org"]},"msgtype":"m.text"},"ts":1713557062073,"senderName":"kriskowal","senderId":"@kriskowal:aelf.land","id":"$wUPCtPNZuxEZAn92aidbIzSBjLwGA58C_iemJp_njqQ"},
{"content":{"body":"The motivations were similar. LavaMoat needed a way to fall through to a sync import for `.node` modules with computed module specifiers. Endo (the project surrounding our `ses` “Hardened JavaScript shim”) has a loader works a lot like a bundler and keeps CJS and ESM in the same graph. CJS relies on a “virtual module source” protocol as seen in the Compartments proposal.","format":"org.matrix.custom.html","formatted_body":"The motivations were similar. LavaMoat needed a way to fall through to a sync import for <code>.node</code> modules with computed module specifiers. Endo (the project surrounding our <code>ses</code> “Hardened JavaScript shim”) has a loader works a lot like a bundler and keeps CJS and ESM in the same graph. CJS relies on a “virtual module source” protocol as seen in the Compartments proposal.","m.mentions":{},"msgtype":"m.text"},"ts":1713557258005,"senderName":"kriskowal","senderId":"@kriskowal:aelf.land","id":"$Dszv6CaIXbIMqDYfq0W59pazIIkHzeWSJrSXgaj2FO8"}
]