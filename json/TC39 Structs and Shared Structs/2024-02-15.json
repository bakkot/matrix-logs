[
{"content":{"body":"Mathieu Hofman: so i don't see how SABs are normative optional","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@mhofman:matrix.org\">Mathieu Hofman</a>: so i don't see how SABs are normative optional","m.mentions":{"user_ids":["@mhofman:matrix.org"]},"msgtype":"m.text"},"ts":1708036272591,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$WAp9bB0OXrpvXLYhHA5VqnmCrdpkWY_rzSbyIjw-1II"},
{"content":{"body":"mark made that claim earlier today in the call","m.mentions":{},"msgtype":"m.text"},"ts":1708036278551,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$49f7-pNOhitB9q2SVk7fP6zif62kCRv9Z6h2iFJy1Os"},
{"content":{"body":"there's the line \"Whenever a host does not provide concurrent access to SharedArrayBuffers it may omit the \"SharedArrayBuffer\" property of the global object.\"","m.mentions":{},"msgtype":"m.text"},"ts":1708036310664,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$v_28oMPMlRDK-HndM28P2cOKOPV7lkBg0XS8z8GPxdQ"},
{"content":{"body":"but that's slightly different by normative optional","m.mentions":{},"msgtype":"m.text"},"ts":1708036321410,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$v-FYI2EjLeDorPGH0_He0BrrNHpTOCf2IFe2Ah9_2Cw"},
{"content":{"body":"i guess mark just meant it's optional in the layman sense?","m.mentions":{},"msgtype":"m.text"},"ts":1708036328022,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$xhMfehUHqVYT1z2DbwLifeXejd0vqI0QP8eYaLqjD_8"},
{"content":{"body":"How is it different?","m.mentions":{},"msgtype":"m.text"},"ts":1708036346803,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$1lfsFbRQhMvuoI94aGFNCHNTNuCzJaG-YAfjbyKd3jE"},
{"content":{"body":"Richard opened https://github.com/tc39/ecma262/issues/3280 today","m.mentions":{},"msgtype":"m.text"},"ts":1708036360120,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$txZ0ln5f6ZKPmCfwau_4y31z0mYbvVD4G6lecEwqh48"},
{"content":{"body":"it's normative optional because it doesn't have to be present for the environment to be spec-compliant","m.mentions":{},"msgtype":"m.text"},"ts":1708036363845,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$ur6BXPeKwj1tx2Kp92Q7Et0SewNY5vTj2ZY7ScJqJc4"},
{"content":{"body":"anything that's omittable is normative optional","m.mentions":{},"msgtype":"m.text"},"ts":1708036373041,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$pA-tg1dvrJ3673GtnuOnQ1W9Yk70c8OWzZC-QuxJODY"},
{"content":{"body":"so the SAB section is not normative optional","m.mentions":{},"msgtype":"m.text"},"ts":1708036389027,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$DX1Pn9BxmCf739z1ffJYEGtRW7ZwM-42Z47ARVPh8t0"},
{"content":{"body":"I believe the normative optional annotation didn't exist back then","m.mentions":{},"msgtype":"m.text"},"ts":1708036394386,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$JYfqGentVunjlQLXoQ1c4Qy89r7TaqtMUXVVTjQ7RMI"},
{"content":{"body":"the thing that's omittable is the `SharedArrayBuffer` property on the global","format":"org.matrix.custom.html","formatted_body":"the thing that's omittable is the <code>SharedArrayBuffer</code> property on the global","m.mentions":{},"msgtype":"m.text"},"ts":1708036399075,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$rD4tme84Qb_4rYxtLldTQCkuHmUH35JvBs7oqy5uGCc"},
{"content":{"body":"right, the constructor is, exactly","m.mentions":{},"msgtype":"m.text"},"ts":1708036405139,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$ZQ80W77rvxeqhydQ6_GNV0pVZLIDx-7ktXfBv3eMdp8"},
{"content":{"body":"and it's not accessible to JS code otherwise, right?","m.mentions":{},"msgtype":"m.text"},"ts":1708036414794,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$oI8lZLUDUW86hPQ8dIqqBM8vIFb0AvHukgs07ZM_Xrw"},
{"content":{"body":"even on a host that does not provide concurrent access to SABs, you can get it by making a Wasm linear memory that's shared","m.mentions":{},"msgtype":"m.text"},"ts":1708036416243,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$OaVkdEUk1FY9Mezk70edWtj-qDT-JuYyf1AlzHmM1oY"},
{"content":{"body":"and that still has all the right prototypes and methods","m.mentions":{},"msgtype":"m.text"},"ts":1708036424587,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$TO1MYox25AX4FH_pZ-h3qFKT8-y1y2xqRUuL351tCzg"},
{"content":{"body":"ahhh right, ok, gotcha","m.mentions":{},"msgtype":"m.text"},"ts":1708036427564,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$AmmqxL3NIBJ9GFHSGz-g2M2FDTuSWFBrK7BiesDvTq8"},
{"content":{"body":"ok well that's fair. but hosts don't have to have wasm either","m.mentions":{},"msgtype":"m.text"},"ts":1708036438575,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$tSsrVQBgb1Lfuu3fURe6aeZmF4ZAbtNi5_ojBlHfZqk"},
{"content":{"body":"Right, only the constructor is normative optional","m.mentions":{},"msgtype":"m.text"},"ts":1708036443342,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$hgiyTPj01v3QS0VhkvZQEtgk7h4i5Ry6M3dCberIo1A"},
{"content":{"body":" * ok well that's fair. but non-web hosts don't have to have wasm either.","m.mentions":{},"m.new_content":{"body":"ok well that's fair. but non-web hosts don't have to have wasm either.","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$tSsrVQBgb1Lfuu3fURe6aeZmF4ZAbtNi5_ojBlHfZqk","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1708036443562,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$8AYfHjwDGqipFHrdHLlC5tCLOtxGmmdmQusGTGwwedY"},
{"content":{"body":"correct","m.mentions":{},"msgtype":"m.text"},"ts":1708036443738,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$7DmP52Psud2WYlDNYvsSkDvQEiTUq0Pev6q04PIJIYg"},
{"content":{"body":"it's still optional in the layman sense","m.mentions":{},"msgtype":"m.text"},"ts":1708036452747,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$xvci441TOx34T4b8MpvVaglWZ_J1ba0rPc8C47Bxr4g"},
{"content":{"body":"so in browsers, it's just the constructor property. but anywhere else, it's effectively the entire thing as long as wasm is not provided, right?","m.mentions":{},"msgtype":"m.text"},"ts":1708036464855,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$yjpAEp28eeIM0Aqxhq_er91nVMdzRRvrH2J9o7NFC7A"},
{"content":{"body":"right, if there's no other host-provided special way to get one of those things","m.mentions":{},"msgtype":"m.text"},"ts":1708036477883,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$rKaC0buzPsceTePGBD4R2Qzkq5K1FhbJkzXF0wKk9tU"},
{"content":{"body":"I suppose the question is, if there was a GetIntrinsic, would %SharedArrayBuffer% appear in there or not","m.mentions":{},"msgtype":"m.text"},"ts":1708036559183,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$iEmqebVr-9ATA2_9gDPZwf83w_xmoa--A9M-Ffljk8Q"},
{"content":{"body":"agree, if GetIntrinsic exists then it's a bigger distinction","m.mentions":{},"msgtype":"m.text"},"ts":1708036573034,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$4zyU4tCEfloKm5vTL--3EmXi3Lk0IBuWQufMaRcxpZU"},
{"content":{"body":"no","m.mentions":{},"msgtype":"m.text"},"ts":1708036575958,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$udNSSId5PuLtZWDG2loNPqHDjXJK9Dfdn4o71bDaddA"},
{"content":{"body":"well, hm","m.mentions":{},"msgtype":"m.text"},"ts":1708036582730,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$TakGd5oVbBrPTTysafXSaousH9X4f4tVrqLnUpRVGDk"},
{"content":{"body":"well the point of GetIntrinsic is to give access to non-reachable-via-chain-of-property-accesses intrinsics","m.mentions":{},"msgtype":"m.text"},"ts":1708036598586,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$tugeIFpuzW48t2bmMFsZnaeytScJKU-2XRG42v_x2Rw"},
{"content":{"body":"so it's not clear to me it's an obvious \"no\"","m.mentions":{},"msgtype":"m.text"},"ts":1708036606090,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$z5-rHgkhSJUyfuh9R28Yyx8wqahEqpEnniwcTJ1V1PY"},
{"content":{"body":"given that it's a top-level intrinsic, yes. but, i assume we'd alter the wording a bit somewhere to say that the intrinsic must exist if there's any way to access those objects, but must not exist otherwise?","m.mentions":{},"msgtype":"m.text"},"ts":1708036626979,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$EVpgseomDly3tOr9cBW-508yHjJiAB3ZB5XP0ggUfNA"},
{"content":{"body":"ðŸ¤·","m.mentions":{},"msgtype":"m.text"},"ts":1708036640706,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$kFOOa5I9ZU87LgOpJ1bKUSgKDFiAS9E9HLfFGgWOy9Q"},
{"content":{"body":"whatever font element uses for emojis is garbage yo","m.mentions":{},"msgtype":"m.text"},"ts":1708036653798,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$KnObJKamUrpj091G1qvFHHzgpvLKDqtVvcFQKexPkfM"},
{"content":{"body":"i can hardly tell that person is shrugging","m.mentions":{},"msgtype":"m.text"},"ts":1708036657766,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$pvfhe3fP8P6SGVQBZ4jYh5oaUaVM-d-rSr6mCr0kj3Y"},
{"content":{"body":"iow, it'd still be deniable in places where the constructor property was omitted, even if by wrapping getIntrinsic, but it'd be required to exist if there's any way to get at a SAB","m.mentions":{},"msgtype":"m.text"},"ts":1708036669819,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$TV76FbVyZcYvBAZiWjLxa_vfB9WMMdaP1krnNKb_IX0"},
{"content":{"body":"to rephrase Shu's observation, is it spec compliant to omit %SharedArrayBuffer% from getIntrinsic, even if there is no other way to reach it","m.mentions":{},"msgtype":"m.text"},"ts":1708036810239,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$H28QkS9LLlCUSPWFpVcIPah6Mgk3v-rcRjzqavgtP9I"},
{"content":{"body":" * to rephrase Shu's observation, would it be spec compliant to omit %SharedArrayBuffer% from getIntrinsic, even if there is no other way to reach it","m.mentions":{},"m.new_content":{"body":"to rephrase Shu's observation, would it be spec compliant to omit %SharedArrayBuffer% from getIntrinsic, even if there is no other way to reach it","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$H28QkS9LLlCUSPWFpVcIPah6Mgk3v-rcRjzqavgtP9I","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1708036823106,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$drGrN0EFLpXTPUqB1hNYv6GBIopuH4JlCnRfO_bdPXQ"},
{"content":{"body":"...is it? ","m.mentions":{},"msgtype":"m.text"},"ts":1708036838941,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$FdT3Mq-8bp2CmpmQQlZ7C0msxAUpZ6g0c5pkDbGXPGA"},
{"content":{"body":"oh sorry you are asking a question","m.mentions":{},"msgtype":"m.text"},"ts":1708036856940,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$1dJd-BbBSu8dhO8QH3Bn7LkpAMzXKO31EEwJddJHr3A"},
{"content":{"body":"If it was normative optional, it would be. But with the current working, I'm actually not sure","m.mentions":{},"msgtype":"m.text"},"ts":1708036863564,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$vRN2JyqqUvHueGjerD7oExnis8MNwyvHWQZ6eAALOTs"},
{"content":{"body":"my gut says \"it's spec compliant to omit iff there is no other way to reach it in the host\"","m.mentions":{},"msgtype":"m.text"},"ts":1708036870580,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$j5UasS1EJ-HswBw3ZKLb42XKgvxFb5rZhLunOYD3yJc"},
{"content":{"body":" * to rephrase Shu's observation, would it be spec compliant to omit %SharedArrayBuffer% from getIntrinsic, even if there is no other way to reach it?","m.mentions":{},"m.new_content":{"body":"to rephrase Shu's observation, would it be spec compliant to omit %SharedArrayBuffer% from getIntrinsic, even if there is no other way to reach it?","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$H28QkS9LLlCUSPWFpVcIPah6Mgk3v-rcRjzqavgtP9I","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1708036870846,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$HnbRjPpq1CPX-GQYt8-3qMUDNrv0dh981dNfsTXHI5M"},
{"content":{"body":"otherwise because it's not the case that the entire constructor and prototype and all the methods are in a Normative Optional block, it seems not compliant to omit it","m.mentions":{},"msgtype":"m.text"},"ts":1708036890628,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$8VTt0bZs-9u3P204nGtKSj9wNo5afCjwIBvKX3TcjnU"},
{"content":{"body":"i think that's exactly the semantic GetIntrinsic must have, however it's worded","m.mentions":{},"msgtype":"m.text"},"ts":1708036892854,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$mKRb71RjZjgOxGBa9-oj_aQ1mDE54lSpc3x41sK7b70"},
{"content":{"body":"Anyway, I suppose the question stand, and should SAB be normative optional, and maybe Atomics too ?\nAfaik, Atomics.waitAsync is causing some problems in some worklet environments","m.mentions":{},"msgtype":"m.text"},"ts":1708036955149,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$xGoTGjaILfuVkL7GrRJKQvkmQIm24MG5gvUHbPyBHtY"},
{"content":{"body":"haha i saw that","m.mentions":{},"msgtype":"m.text"},"ts":1708036965720,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$4OQFqb8HKdZiB79tAuyf0qF144IKBKBm8yktSyCiP_I"},
{"content":{"body":"i don't think either SAB and Atomics can be truly normative optional","m.mentions":{},"msgtype":"m.text"},"ts":1708037005142,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$Q_j2cqlhaNRtVwrWgyhP7daUgQNTykrtCTfFCZaivNo"},
{"content":{"body":"especially not Atomics because they _do_ work on ABs, just doesn't do anything interesting","format":"org.matrix.custom.html","formatted_body":"especially not Atomics because they <em>do</em> work on ABs, just doesn't do anything interesting","m.mentions":{},"msgtype":"m.text"},"ts":1708037034434,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$TNjwzZveMnvHNB_C55erDPpGIxJ1bXodqoSoDPpM2vo"},
{"content":{"body":"why not?","m.mentions":{},"msgtype":"m.text"},"ts":1708037035499,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$g-DjgGChKL6FEb1HKlrnXK6Dgn5C4Mdaio3sGu-AFh4"},
{"content":{"body":"(except wait)","m.mentions":{},"msgtype":"m.text"},"ts":1708037039722,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$906HYzzUWLkEjgX5VNgVuKCaOCk868xNcdXxE83ryKk"},
{"content":{"body":"because they work on ABs","m.mentions":{},"msgtype":"m.text"},"ts":1708037044729,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$fb5fPxO8XII3upTnOBYa9XERvwN-j4tYR2HMkyPkxkU"},
{"content":{"body":"ok but the question is whether a spec compliant implementation must offer them to the program","m.mentions":{},"msgtype":"m.text"},"ts":1708037081654,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$kkJJewnIz3cycAtXCZTcs08WPV9EAekFKj6bKi86Z78"},
{"content":{"body":"there was a use case from the wasm side iirc that wanted to not share different binaries depending on whether SABs are actually available","m.mentions":{},"msgtype":"m.text"},"ts":1708037090456,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$iKrjhRFTBjD-Xabjbd8BiVC0co9CX9nRxzOAoHusjNk"}
]