[
{"content":{"body":"I'm wondering about Abstract Closures in a post-2547 spec. E.g. CreateListIteratorRecord defines a closure that uses `?`, so it can return an abrupt completion. So when it says `Return *undefined*`, should that  be `Return NormalCompletion(*undefined*)`?","format":"org.matrix.custom.html","formatted_body":"I'm wondering about Abstract Closures in a post-2547 spec. E.g. CreateListIteratorRecord defines a closure that uses <code>?</code>, so it can return an abrupt completion. So when it says <code>Return *undefined*</code>, should that  be <code>Return NormalCompletion(*undefined*)</code>?","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"I'm wondering about Abstract Closures in a post-2547 spec. E.g. CreateListIteratorRecord defines a closure that uses `?`, so it can return an abrupt completion. So when it says `Return *undefined*`, should that  be `Return NormalCompletion(*undefined*)`?","mimetype":"text/plain"},{"body":"I'm wondering about Abstract Closures in a post-2547 spec. E.g. CreateListIteratorRecord defines a closure that uses <code>?</code>, so it can return an abrupt completion. So when it says <code>Return *undefined*</code>, should that  be <code>Return NormalCompletion(*undefined*)</code>?","mimetype":"text/html"}]},"ts":1647822717557,"senderName":"jmdyck","senderId":"@jmdyck:matrix.org","id":"$ionZ_nvQR4fsBjP_e8dVPbD33q5S5N05XpdDqEcUNgY"},
{"content":{"body":"Or should the closure have a return-type, so that the `NormalCompletion()` is implicit?","format":"org.matrix.custom.html","formatted_body":"Or should the closure have a return-type, so that the <code>NormalCompletion()</code> is implicit?","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"Or should the closure have a return-type, so that the `NormalCompletion()` is implicit?","mimetype":"text/plain"},{"body":"Or should the closure have a return-type, so that the <code>NormalCompletion()</code> is implicit?","mimetype":"text/html"}]},"ts":1647822767207,"senderName":"jmdyck","senderId":"@jmdyck:matrix.org","id":"$IQiF4-LX1DOB5V6RexCqRlbmh-Vx-j_UoYzAUcFCEm4"},
{"content":{"body":"(Currently, we don't have a syntax to declare an AC's return-type. Closest is that CompilePattern's return-type is `an Abstract Closure that takes <X> and <Y> and returns a MatchResult`","format":"org.matrix.custom.html","formatted_body":"(Currently, we don't have a syntax to declare an AC's return-type. Closest is that CompilePattern's return-type is <code>an Abstract Closure that takes &lt;X&gt; and &lt;Y&gt; and returns a MatchResult</code>","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"(Currently, we don't have a syntax to declare an AC's return-type. Closest is that CompilePattern's return-type is `an Abstract Closure that takes <X> and <Y> and returns a MatchResult`","mimetype":"text/plain"},{"body":"(Currently, we don't have a syntax to declare an AC's return-type. Closest is that CompilePattern's return-type is <code>an Abstract Closure that takes &lt;X&gt; and &lt;Y&gt; and returns a MatchResult</code>","mimetype":"text/html"}]},"ts":1647823184995,"senderName":"jmdyck","senderId":"@jmdyck:matrix.org","id":"$pogKCvYpE8c29rBI-awU1G137jd24yuBrizN4XAybOI"},
{"content":{"body":" * (Currently, we don't have a syntax to declare an AC's return-type. Closest is that CompilePattern's return-type is `an Abstract Closure that takes <X> and <Y> and returns a MatchResult`)","format":"org.matrix.custom.html","formatted_body":" * (Currently, we don't have a syntax to declare an AC's return-type. Closest is that CompilePattern's return-type is <code>an Abstract Closure that takes &lt;X&gt; and &lt;Y&gt; and returns a MatchResult</code>)","m.new_content":{"body":"(Currently, we don't have a syntax to declare an AC's return-type. Closest is that CompilePattern's return-type is `an Abstract Closure that takes <X> and <Y> and returns a MatchResult`)","format":"org.matrix.custom.html","formatted_body":"(Currently, we don't have a syntax to declare an AC's return-type. Closest is that CompilePattern's return-type is <code>an Abstract Closure that takes &lt;X&gt; and &lt;Y&gt; and returns a MatchResult</code>)","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"(Currently, we don't have a syntax to declare an AC's return-type. Closest is that CompilePattern's return-type is `an Abstract Closure that takes <X> and <Y> and returns a MatchResult`)","mimetype":"text/plain"},{"body":"(Currently, we don't have a syntax to declare an AC's return-type. Closest is that CompilePattern's return-type is <code>an Abstract Closure that takes &lt;X&gt; and &lt;Y&gt; and returns a MatchResult</code>)","mimetype":"text/html"}]},"m.relates_to":{"event_id":"$pogKCvYpE8c29rBI-awU1G137jd24yuBrizN4XAybOI","rel_type":"m.replace"},"msgtype":"m.text","org.matrix.msc1767.message":[{"body":" * (Currently, we don't have a syntax to declare an AC's return-type. Closest is that CompilePattern's return-type is `an Abstract Closure that takes <X> and <Y> and returns a MatchResult`)","mimetype":"text/plain"},{"body":" * (Currently, we don't have a syntax to declare an AC's return-type. Closest is that CompilePattern's return-type is <code>an Abstract Closure that takes &lt;X&gt; and &lt;Y&gt; and returns a MatchResult</code>)","mimetype":"text/html"}]},"ts":1647823213945,"senderName":"jmdyck","senderId":"@jmdyck:matrix.org","id":"$wpi1iMTRJ4RumDF7ZEA4n21m-vW3ZVzhk6rEOin3PMQ"},
{"content":{"body":"> <@jmdyck:matrix.org> I'm wondering about Abstract Closures in a post-2547 spec. E.g. CreateListIteratorRecord defines a closure that uses `?`, so it can return an abrupt completion. So when it says `Return *undefined*`, should that  be `Return NormalCompletion(*undefined*)`?\n\nYeah I believe it should. I guess we should audit Completion Record usage in abstract closures.There's no provision for them to do automatic NormalCompletion wrapping right now.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!nSLHQtIRJQxUJbEuGt:matrix.org/$ionZ_nvQR4fsBjP_e8dVPbD33q5S5N05XpdDqEcUNgY?via=matrix.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@jmdyck:matrix.org\">@jmdyck:matrix.org</a><br>I'm wondering about Abstract Closures in a post-2547 spec. E.g. CreateListIteratorRecord defines a closure that uses <code>?</code>, so it can return an abrupt completion. So when it says <code>Return *undefined*</code>, should that  be <code>Return NormalCompletion(*undefined*)</code>?</blockquote></mx-reply>Yeah I believe it should. I guess we should audit Completion Record usage in abstract closures.There's no provision for them to do automatic NormalCompletion wrapping right now.","m.relates_to":{"m.in_reply_to":{"event_id":"$ionZ_nvQR4fsBjP_e8dVPbD33q5S5N05XpdDqEcUNgY"}},"msgtype":"m.text","org.matrix.msc1767.message":[{"body":"> <@jmdyck:matrix.org> I'm wondering about Abstract Closures in a post-2547 spec. E.g. CreateListIteratorRecord defines a closure that uses `?`, so it can return an abrupt completion. So when it says `Return *undefined*`, should that  be `Return NormalCompletion(*undefined*)`?\n\nYeah I believe it should. I guess we should audit Completion Record usage in abstract closures.There's no provision for them to do automatic NormalCompletion wrapping right now.","mimetype":"text/plain"},{"body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!nSLHQtIRJQxUJbEuGt:matrix.org/$ionZ_nvQR4fsBjP_e8dVPbD33q5S5N05XpdDqEcUNgY?via=matrix.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@jmdyck:matrix.org\">@jmdyck:matrix.org</a><br>I'm wondering about Abstract Closures in a post-2547 spec. E.g. CreateListIteratorRecord defines a closure that uses <code>?</code>, so it can return an abrupt completion. So when it says <code>Return *undefined*</code>, should that  be <code>Return NormalCompletion(*undefined*)</code>?</blockquote></mx-reply>Yeah I believe it should. I guess we should audit Completion Record usage in abstract closures.There's no provision for them to do automatic NormalCompletion wrapping right now.","mimetype":"text/html"}]},"ts":1647883158247,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$aFmeza85Ks7iW8VIZb0WXxf7Ni0wfp6pkBJhIm8YQ2M"},
{"content":{"body":"good catch, we should audit ACs for that","msgtype":"m.text","org.matrix.msc1767.text":"good catch, we should audit ACs for that"},"ts":1647884128018,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$nW65kDowUOW74D1Zutg0X-UwFvfmiDiu8RlVxxH8NAk"},
{"content":{"body":"possibly need to amend the AC creation language to talk about return types as well","msgtype":"m.text","org.matrix.msc1767.text":"possibly need to amend the AC creation language to talk about return types as well"},"ts":1647884138561,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$Iyhe6DP3-kSXwJCumbcREsSexQ0JDlRc-UMmIxaxjWk"},
{"content":{"body":"Syntax possibilities: \"... a new Abstract Closure with parameters <P> that captures <C> and returns <R>, performing the following steps when called:\"","msgtype":"m.text","org.matrix.msc1767.text":"Syntax possibilities: \"... a new Abstract Closure with parameters <P> that captures <C> and returns <R>, performing the following steps when called:\""},"ts":1647886386152,"senderName":"jmdyck","senderId":"@jmdyck:matrix.org","id":"$fRUQDIDRhvq_PqiQ5dqAmmWBai6WgijT0jO-qIFhLuk"},
{"content":{"body":"\"... a new Abstract Closure with parameters <P> that captures <C>, returns <R>, and performs the following steps when called:\"\n","msgtype":"m.text","org.matrix.msc1767.text":"\"... a new Abstract Closure with parameters <P> that captures <C>, returns <R>, and performs the following steps when called:\"\n"},"ts":1647886392485,"senderName":"jmdyck","senderId":"@jmdyck:matrix.org","id":"$3E3V8qbuJp40Dx0949QlAtgkq7gd7ZchJwhaL3DEmBk"},
{"content":{"body":"\"... a new Abstract Closure with parameters <P> that captures <C> and performs the following steps when called, returning <R>:\"\n","msgtype":"m.text","org.matrix.msc1767.text":"\"... a new Abstract Closure with parameters <P> that captures <C> and performs the following steps when called, returning <R>:\"\n"},"ts":1647886535305,"senderName":"jmdyck","senderId":"@jmdyck:matrix.org","id":"$q1Z0D-yuj3L9hzivY9_oAnFcVKqNJv5p7AwMMFOcXEY"},
{"content":{"body":"Given that <R> might be something like \"either a normal completion containing an ECMAScript language value, or a throw completion\", I think I prefer (3), where you don't have to resume parsing the step after getting through <R>. But (1) and (2) wouldn't be *terrible* on that score. ","format":"org.matrix.custom.html","formatted_body":"Given that &lt;R&gt; might be something like &quot;either a normal completion containing an ECMAScript language value, or a throw completion&quot;, I think I prefer (3), where you don't have to resume parsing the step after getting through &lt;R&gt;. But (1) and (2) wouldn't be <em>terrible</em> on that score.","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"Given that <R> might be something like \"either a normal completion containing an ECMAScript language value, or a throw completion\", I think I prefer (3), where you don't have to resume parsing the step after getting through <R>. But (1) and (2) wouldn't be *terrible* on that score. ","mimetype":"text/plain"},{"body":"Given that &lt;R&gt; might be something like &quot;either a normal completion containing an ECMAScript language value, or a throw completion&quot;, I think I prefer (3), where you don't have to resume parsing the step after getting through &lt;R&gt;. But (1) and (2) wouldn't be <em>terrible</em> on that score.","mimetype":"text/html"}]},"ts":1647887193142,"senderName":"jmdyck","senderId":"@jmdyck:matrix.org","id":"$wEymBHLwd7oaUnxHAUWUvzU1Bvh4P9Q_89P02rZQL_I"},
{"content":{"body":"so another criterion might be more decisive.","msgtype":"m.text","org.matrix.msc1767.text":"so another criterion might be more decisive."},"ts":1647887296823,"senderName":"jmdyck","senderId":"@jmdyck:matrix.org","id":"$8g19l5uxW4xWqArN3WCm1MwngAJCjoJD932eMKMLueQ"},
{"content":{"body":" * Syntax possibilities:\n(1) \"... a new Abstract Closure with parameters <P> that captures <C> and returns <R>, performing the following steps when called:\"","m.new_content":{"body":"Syntax possibilities:\n(1) \"... a new Abstract Closure with parameters <P> that captures <C> and returns <R>, performing the following steps when called:\"","msgtype":"m.text","org.matrix.msc1767.text":"Syntax possibilities:\n(1) \"... a new Abstract Closure with parameters <P> that captures <C> and returns <R>, performing the following steps when called:\""},"m.relates_to":{"event_id":"$fRUQDIDRhvq_PqiQ5dqAmmWBai6WgijT0jO-qIFhLuk","rel_type":"m.replace"},"msgtype":"m.text","org.matrix.msc1767.text":" * Syntax possibilities:\n(1) \"... a new Abstract Closure with parameters <P> that captures <C> and returns <R>, performing the following steps when called:\""},"ts":1647887403286,"senderName":"jmdyck","senderId":"@jmdyck:matrix.org","id":"$AXn8mErwOO8-41fCXnD7xeFBRmjRUv_MHNglePO5eL8"},
{"content":{"body":" * (2) \"... a new Abstract Closure with parameters <P> that captures <C>, returns <R>, and performs the following steps when called:\"\n","m.new_content":{"body":"(2) \"... a new Abstract Closure with parameters <P> that captures <C>, returns <R>, and performs the following steps when called:\"\n","msgtype":"m.text","org.matrix.msc1767.text":"(2) \"... a new Abstract Closure with parameters <P> that captures <C>, returns <R>, and performs the following steps when called:\"\n"},"m.relates_to":{"event_id":"$3E3V8qbuJp40Dx0949QlAtgkq7gd7ZchJwhaL3DEmBk","rel_type":"m.replace"},"msgtype":"m.text","org.matrix.msc1767.text":" * (2) \"... a new Abstract Closure with parameters <P> that captures <C>, returns <R>, and performs the following steps when called:\"\n"},"ts":1647887420446,"senderName":"jmdyck","senderId":"@jmdyck:matrix.org","id":"$OpEzhG05-pq0-9_wdYK8QSOIaHduKSIB_9VvPzGxqeY"},
{"content":{"body":" * (3) \"... a new Abstract Closure with parameters <P> that captures <C> and performs the following steps when called, returning <R>:\"\n","m.new_content":{"body":"(3) \"... a new Abstract Closure with parameters <P> that captures <C> and performs the following steps when called, returning <R>:\"\n","msgtype":"m.text","org.matrix.msc1767.text":"(3) \"... a new Abstract Closure with parameters <P> that captures <C> and performs the following steps when called, returning <R>:\"\n"},"m.relates_to":{"event_id":"$q1Z0D-yuj3L9hzivY9_oAnFcVKqNJv5p7AwMMFOcXEY","rel_type":"m.replace"},"msgtype":"m.text","org.matrix.msc1767.text":" * (3) \"... a new Abstract Closure with parameters <P> that captures <C> and performs the following steps when called, returning <R>:\"\n"},"ts":1647887426723,"senderName":"jmdyck","senderId":"@jmdyck:matrix.org","id":"$A-TuKrAhB5vNjHlmN7SBNZerARVQQrgd0xucG26RekE"},
{"content":{"body":"(2) sounds a bit odd to me, like it returns <R> and then performs these steps, which makes no sense.","msgtype":"m.text","org.matrix.msc1767.text":"(2) sounds a bit odd to me, like it returns <R> and then performs these steps, which makes no sense."},"ts":1647887623506,"senderName":"jmdyck","senderId":"@jmdyck:matrix.org","id":"$3yKc07ckbZtHv4JRk7-uWGfCyrt5Qeo-dcu3UaNOAF4"},
{"content":{"body":"agreed, (2) sounds odder than (1) or (3)","msgtype":"m.text","org.matrix.msc1767.text":"agreed, (2) sounds odder than (1) or (3)"},"ts":1647889030753,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$hA1oFxW6tZR75rz3yJHEvux8Ati1YVZwUAx6NEjWvmc"},
{"content":{"body":"(3) is the most radical, but i kind of like it","msgtype":"m.text","org.matrix.msc1767.text":"(3) is the most radical, but i kind of like it"},"ts":1647889035493,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$SzFHQtPDzwmQ_N8iw_AH4nE190pQactSIVo5qvn4lWI"},
{"content":{"body":"it reads naturally","msgtype":"m.text","org.matrix.msc1767.text":"it reads naturally"},"ts":1647889040967,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$D5LuoMCX9gkivrv-RmQtrFnfpq3ZeFwqik5eVslS7M4"},
{"content":{"body":"there's no real reason to have the return type be co-located next to the parameters or anything","msgtype":"m.text","org.matrix.msc1767.text":"there's no real reason to have the return type be co-located next to the parameters or anything"},"ts":1647889055381,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$arUISpjP3ffHOzz_4vbu9qkqTFoXBAJy9APUxsHCHlA"}
]