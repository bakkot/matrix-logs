[
{"content":{"body":"working on RS, having a problem","msgtype":"m.text","org.matrix.msc1767.text":"working on RS, having a problem"},"ts":1655286198023,"senderName":"Jack Works","senderId":"@jackworks:matrix.org","id":"$m7fMsUR8VV2VYvQzsWHYUI_G8WZ0c8e6hz-_SnowmCI"},
{"content":{"body":"for array/object patterns, should we check the length/key first, or check them one by one?","msgtype":"m.text","org.matrix.msc1767.text":"for array/object patterns, should we check the length/key first, or check them one by one?"},"ts":1655286235495,"senderName":"Jack Works","senderId":"@jackworks:matrix.org","id":"$2Ge_LiTptaBweM1QPSAN1Misl4hrLKdVL7kbrTaiB2k"},
{"content":{"body":"```js\nmatch ([ 0, { get a() { } }, 1]) {\n    when ([a, b, \"\"]): void 0\n    // 3rd item check failed\n    \n    when ([, { a }]): void 0\n    // will a triggered?\n    // There're already 3 items cached for the iterator.\n}\n```","format":"org.matrix.custom.html","formatted_body":"<pre><code class=\"language-js\">match ([ 0, { get a() { } }, 1]) {\n    when ([a, b, &quot;&quot;]): void 0\n    // 3rd item check failed\n    \n    when ([, { a }]): void 0\n    // will a triggered?\n    // There're already 3 items cached for the iterator.\n}\n</code></pre>\n","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"```js\nmatch ([ 0, { get a() { } }, 1]) {\n    when ([a, b, \"\"]): void 0\n    // 3rd item check failed\n    \n    when ([, { a }]): void 0\n    // will a triggered?\n    // There're already 3 items cached for the iterator.\n}\n```","mimetype":"text/plain"},{"body":"<pre><code class=\"language-js\">match ([ 0, { get a() { } }, 1]) {\n    when ([a, b, &quot;&quot;]): void 0\n    // 3rd item check failed\n    \n    when ([, { a }]): void 0\n    // will a triggered?\n    // There're already 3 items cached for the iterator.\n}\n</code></pre>\n","mimetype":"text/html"}]},"ts":1655286242444,"senderName":"Jack Works","senderId":"@jackworks:matrix.org","id":"$VrdPxCutKGIOrK3Rx4oLvKoBMTT65XURxAaixRj3Doc"},
{"content":{"body":"https://github.com/tc39/proposal-pattern-matching/pull/258","msgtype":"m.text","org.matrix.msc1767.text":"https://github.com/tc39/proposal-pattern-matching/pull/258"},"ts":1655286269800,"senderName":"Jack Works","senderId":"@jackworks:matrix.org","id":"$zL3ag59hktEdJ_4QdvYzX8qhPPadPiHx0HZfQWzHtAg"},
{"content":{"body":"For object patterns, it is currently one-by-one because it is easier to specify\n\n```js\nmatch ({ get a() {} }) {\n    when ({ a, b }): void 0\n    // getter a _will_ be triggered, even \"b\" is missing.\n    // because I access them by order\n}\n```","format":"org.matrix.custom.html","formatted_body":"<p>For object patterns, it is currently one-by-one because it is easier to specify</p>\n<pre><code class=\"language-js\">match ({ get a() {} }) {\n    when ({ a, b }): void 0\n    // getter a _will_ be triggered, even &quot;b&quot; is missing.\n    // because I access them by order\n}\n</code></pre>\n","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"For object patterns, it is currently one-by-one because it is easier to specify\n\n```js\nmatch ({ get a() {} }) {\n    when ({ a, b }): void 0\n    // getter a _will_ be triggered, even \"b\" is missing.\n    // because I access them by order\n}\n```","mimetype":"text/plain"},{"body":"<p>For object patterns, it is currently one-by-one because it is easier to specify</p>\n<pre><code class=\"language-js\">match ({ get a() {} }) {\n    when ({ a, b }): void 0\n    // getter a _will_ be triggered, even &quot;b&quot; is missing.\n    // because I access them by order\n}\n</code></pre>\n","mimetype":"text/html"}]},"ts":1655295648528,"senderName":"Jack Works","senderId":"@jackworks:matrix.org","id":"$vDC4MTIbCovPGLPBXnTr1ajamxGUjwgy3pd2gxWGlnw"},
{"content":{"body":"It’s iterable not Array, so you can’t check the length first","msgtype":"m.text"},"ts":1655298234912,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$qIt5LfWCpKXI8HWGWQlsf-EVMeVr42nCZaWwDGxSgPo"},
{"content":{"body":"> <@ljharb:matrix.org> It’s iterable not Array, so you can’t check the length first\n\nYou can. If the pattern has 4 items in it, you can try to take 4 items from the iterator and one more call to check if it is done. ","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!XyZDxqjPFLRXDgUzhD:matrix.org/$qIt5LfWCpKXI8HWGWQlsf-EVMeVr42nCZaWwDGxSgPo?via=matrix.org&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@ljharb:matrix.org\">@ljharb:matrix.org</a><br />It’s iterable not Array, so you can’t check the length first</blockquote></mx-reply>You can. If the pattern has 4 items in it, you can try to take 4 items from the iterator and one more call to check if it is done.","m.relates_to":{"m.in_reply_to":{"event_id":"$qIt5LfWCpKXI8HWGWQlsf-EVMeVr42nCZaWwDGxSgPo"}},"msgtype":"m.text"},"ts":1655299182873,"senderName":"Jack Works","senderId":"@jackworks:matrix.org","id":"$W3NqTRVDAS8r6dqIVR3ODgIM-zyCqpa3hk6oI1d4CM0"},
{"content":{"body":"The problem is in which order we should use.\n\nA: Take the 1st element, check if the 1st element matches (if not, go to the next match clause), then do this to the 2nd element, ....\n\nB: Take the 1st element, take the 2nd element, ...\nIf it has less/more elements than expected, go to the next match clause.\nIf length matches, check if the 1st element matches, check if the 2nd element matches...... ","msgtype":"m.text"},"ts":1655299329503,"senderName":"Jack Works","senderId":"@jackworks:matrix.org","id":"$feA9KGM4NKvze-L_xZ_v12p28819baVeFYwCgyVGSG0"},
{"content":{"body":"There are two approaches. ","msgtype":"m.text"},"ts":1655299342609,"senderName":"Jack Works","senderId":"@jackworks:matrix.org","id":"$0ggeYfe8p_9QU-Try4zGPEO4NByKDLhwchpkJ2gOh6g"},
{"content":{"body":"Same question for objects. Check all required keys first, or one-by-one.","msgtype":"m.text"},"ts":1655299479163,"senderName":"Jack Works","senderId":"@jackworks:matrix.org","id":"$AEfv3NnOI4-Om1CafMaqT_oaNWMjJbf_AszIu0YrOA4"},
{"content":{"body":"ah. You check each element at a time","msgtype":"m.text"},"ts":1655304620306,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$auLayJYAlFg-vcP3l_Wl_jwIW9iQ0qmtwyYK1jYQXYI"},
{"content":{"body":"So that we consume as little of an iterator as possible, and also need to cache as little as possible","msgtype":"m.text"},"ts":1655304642519,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$6a9YVSzHvWzIiJpI84ikCmsohjDBweK4b1yKDjQROl8"},
{"content":{"body":"For objects, I’d say the same - just check each property in pattern order","msgtype":"m.text"},"ts":1655304809778,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$Pt5n40576rXTiszhbUABSC0Q38wJZUwD7S4qb-yoX8M"}
]