[
{"content":{"body":"Hey all, I'm taking a look into inlining and scopes for generated code, and I got a bit confused with this example: https://github.com/hbenl/tc39-proposal-scope-mapping/blob/master/test/getOriginalFrames/inline-into-function.test.ts. There we have a call chain of toplevel -> outer -> inner -> log. My confusion is that with the ranges we are using for the scope in this test, we skip inner fully. Which means that if we place a bp on line 3 (first line of log), the stack will have something like log <-outer<-toplevel. Was it intentional to skip inner there?","m.mentions":{},"msgtype":"m.text"},"ts":1772112666751,"senderName":"Caio Lima","senderId":"@caiolima:igalia.com","id":"$jnJZsH3F2BQQJk72Qrl6nDbjkvxhekOg6Xrot3bh2n4"},
{"content":{"body":"I don't think we're skipping inner: the ranges contain two callsites (for inner and log) and getOriginalFrames() does contain a frame for inner: https://github.com/hbenl/tc39-proposal-scope-mapping/blob/50d3c7b7c52a1876100867925f2038b94e04ef31/test/getOriginalFrames/inline-into-function.test.ts#L244-L249","m.mentions":{},"m.relates_to":{"event_id":"$jnJZsH3F2BQQJk72Qrl6nDbjkvxhekOg6Xrot3bh2n4","is_falling_back":true,"m.in_reply_to":{"event_id":"$jnJZsH3F2BQQJk72Qrl6nDbjkvxhekOg6Xrot3bh2n4"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1772113056620,"senderName":"Holger Benl","senderId":"@holger_benl:matrix.org","id":"$tm5Wgw0Jsk9c9VXwcdxwPvUyKVnJuNkBUx5LkpUQ6Xo"},
{"content":{"body":"Or do you mean the input for getOriginalFrames()? That only contains one frame but the test shows that getOriginalFrames() will recreate the frames for inner and log from that.","m.mentions":{},"m.relates_to":{"event_id":"$jnJZsH3F2BQQJk72Qrl6nDbjkvxhekOg6Xrot3bh2n4","is_falling_back":true,"m.in_reply_to":{"event_id":"$tm5Wgw0Jsk9c9VXwcdxwPvUyKVnJuNkBUx5LkpUQ6Xo"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1772113197613,"senderName":"Holger Benl","senderId":"@holger_benl:matrix.org","id":"$9AVJKfRstNvdUGEaH_W1VaMosrgpvIWGxFVxPEQYzM0"},
{"content":{"body":"Hi folks, scopes meeting is starting soon!","m.mentions":{},"msgtype":"m.text"},"ts":1772125177070,"senderName":"asumu","senderId":"@atakikawa:igalia.com","id":"$-3HgRtaZVqZa0IEW9QRqDxVtmkdmzDxT9NkAeWzmagA"},
{"content":{"body":"https://source.chromium.org/chromium/chromium/src/+/main:third_party/devtools-frontend/src/front_end/core/sdk/SourceMapScopesInfo.ts;l=529;drc=0832f0943d8cf75120726045afeea11c577f1ab9","m.mentions":{},"m.relates_to":{"event_id":"$jnJZsH3F2BQQJk72Qrl6nDbjkvxhekOg6Xrot3bh2n4","is_falling_back":true,"m.in_reply_to":{"event_id":"$9AVJKfRstNvdUGEaH_W1VaMosrgpvIWGxFVxPEQYzM0"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1772126633558,"senderName":"Simon Zünd","senderId":"@szuend:matrix.org","id":"$xw2zfM-WkwvM_X1IbO-y2FC1xW7NjW0nr9tN_VOs2as"},
{"content":{"body":"This is the Chrome Impl","m.mentions":{},"m.relates_to":{"event_id":"$jnJZsH3F2BQQJk72Qrl6nDbjkvxhekOg6Xrot3bh2n4","is_falling_back":true,"m.in_reply_to":{"event_id":"$xw2zfM-WkwvM_X1IbO-y2FC1xW7NjW0nr9tN_VOs2as"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1772126639481,"senderName":"Simon Zünd","senderId":"@szuend:matrix.org","id":"$DLgZUgfU1yyrr8tJBrKjnPaeJpFioTPJ21nztqjIkL0"},
{"content":{"body":"```\nconst CALL_CHANCE = 0.5;\n\nfunction log(x) {\n  console.log(x);\n}\n\nfunction inner(x) {\n  log(x);\n}\n\nfunction outer(x) {\n  const shouldCall = Math.random() < CALL_CHANCE;\n  console.log('Do we log?', shouldCall);\n  if (shouldCall) {\n    inner(x);\n  }\n}\n\nouter(42);\nouter(null);\n```","format":"org.matrix.custom.html","formatted_body":"<pre><code>const CALL_CHANCE = 0.5;\n\nfunction log(x) {\n  console.log(x);\n}\n\nfunction inner(x) {\n  log(x);\n}\n\nfunction outer(x) {\n  const shouldCall = Math.random() &lt; CALL_CHANCE;\n  console.log('Do we log?', shouldCall);\n  if (shouldCall) {\n    inner(x);\n  }\n}\n\nouter(42);\nouter(null);\n</code></pre>\n","m.mentions":{},"m.relates_to":{"event_id":"$jnJZsH3F2BQQJk72Qrl6nDbjkvxhekOg6Xrot3bh2n4","is_falling_back":true,"m.in_reply_to":{"event_id":"$DLgZUgfU1yyrr8tJBrKjnPaeJpFioTPJ21nztqjIkL0"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1772126732711,"senderName":"Caio Lima","senderId":"@caiolima:igalia.com","id":"$GF-svrNWF3SZreVBx2QQs5DExNmzUIXqCNKYJiPTFDc"},
{"content":{"body":"As we talked in the meeting, I was just reeding the test wrongly.","m.mentions":{},"m.relates_to":{"event_id":"$jnJZsH3F2BQQJk72Qrl6nDbjkvxhekOg6Xrot3bh2n4","is_falling_back":true,"m.in_reply_to":{"event_id":"$GF-svrNWF3SZreVBx2QQs5DExNmzUIXqCNKYJiPTFDc"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1772127728495,"senderName":"Caio Lima","senderId":"@caiolima:igalia.com","id":"$Dlycj5hVC5MtpM2sGN-X54E8J779Ie3Si0XTpW9u9Is"}
]