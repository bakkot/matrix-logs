[
{"content":{"body":"Justin Ridgewell: can you help me explain Mark's security concern from lunch? I understand it at a high level but I'm struggling to come up with a code example testing our regex","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@jridgewell:matrix.org\">Justin Ridgewell</a>: can you help me explain Mark's security concern from lunch? I understand it at a high level but I'm struggling to come up with a code example testing our regex","m.mentions":{"user_ids":["@jridgewell:matrix.org"]},"msgtype":"m.text"},"ts":1728532666524,"senderName":"jkup","senderId":"@jkup:matrix.org","id":"$YdENgMspuN0RViaE5KhYT6EOSU5Y1cIn_aU0tRx_AHc"},
{"content":{"body":"Mark is concerned with a `//# sourceMappingUrl=…` comment being detected when it’s in fact a template string: ``` `\\n//# sourceMappingUrl=… ` ```","format":"org.matrix.custom.html","formatted_body":"Mark is concerned with a <code data-md=\"`\">//# sourceMappingUrl=…</code> comment being detected when it’s in fact a template string: <code data-md=\"`\">`</code> <code data-md=\"`\">\\n//# sourceMappingUrl=… </code> <code data-md=\"`\">`</code>","msgtype":"m.text"},"ts":1728533566639,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$bmzMqkQpBbgPA2sZz--_-i3frfYPld3eVL2ZI67oQnw"},
{"content":{"body":"* Mark is concerned with a `//# sourceMappingUrl=…` comment being detected when it’s in fact a template string: https://gist.github.com/jridgewell/40dc4e3f43928ecdc2c48b7d6b1c1798","format":"org.matrix.custom.html","formatted_body":"Mark is concerned with a <code data-md=\"`\">//# sourceMappingUrl=…</code> comment being detected when it’s in fact a template string: https://gist.github.com/jridgewell/40dc4e3f43928ecdc2c48b7d6b1c1798","m.new_content":{"body":"Mark is concerned with a `//# sourceMappingUrl=…` comment being detected when it’s in fact a template string: https://gist.github.com/jridgewell/40dc4e3f43928ecdc2c48b7d6b1c1798","format":"org.matrix.custom.html","formatted_body":"Mark is concerned with a <code data-md=\"`\">//# sourceMappingUrl=…</code> comment being detected when it’s in fact a template string: https://gist.github.com/jridgewell/40dc4e3f43928ecdc2c48b7d6b1c1798","msgtype":"m.text"},"m.relates_to":{"event_id":"$bmzMqkQpBbgPA2sZz--_-i3frfYPld3eVL2ZI67oQnw","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1728533652994,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$3zLYxput__4Bot-xecSp5ATqKx64XhkMEVttvuTX6VE"},
{"content":{"body":"Isn't this addressed in the spec?","m.mentions":{},"msgtype":"m.text"},"ts":1728534084396,"senderName":"Simon Zünd","senderId":"@szuend:matrix.org","id":"$JAtGbrsAbFKQTop6RA9uOBiTE-q9s96x4H_0RaFN5cY"},
{"content":{"body":"the concern was about the \"without parsing\" mode","m.mentions":{},"msgtype":"m.text"},"ts":1728534114943,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$yGJ1RdkmWPqZTVIfgJN-GvHY614fn9dcLs-Ym3pfruE"},
{"content":{"body":"Please correct me if I'm wrong here but Mark's concern seems to be:\n\n1. True with the current regex\n2. Impossible to fix with just a regular expression?\n3. Very likely has been true forever in IDEs and other \"non parsing\" source map users","format":"org.matrix.custom.html","formatted_body":"<p>Please correct me if I'm wrong here but Mark's concern seems to be:</p>\n<ol>\n<li>True with the current regex</li>\n<li>Impossible to fix with just a regular expression?</li>\n<li>Very likely has been true forever in IDEs and other \"non parsing\" source map users</li>\n</ol>\n","m.mentions":{},"msgtype":"m.text"},"ts":1728535068989,"senderName":"jkup","senderId":"@jkup:matrix.org","id":"$PfVYPWcBJGSfKTjYnahyq5p5zzr9yBlWNRrFKCdukZ0"},
{"content":{"body":"Side note: Could we do something weird like specify that \"If you don't parse for the magic comment, you can only fetch local or encoded source maps, not go out to the network\"?","m.mentions":{},"msgtype":"m.text"},"ts":1728535120173,"senderName":"jkup","senderId":"@jkup:matrix.org","id":"$bFzN6N3Sw6Fj4WPRcn6dkAmzZgGM-QcfGRGfozaym0Y"},
{"content":{"body":"if it's only about template literals then it _can_ be fixed by something like a regular expression, but probably shouldn't be","format":"org.matrix.custom.html","formatted_body":"if it's only about template literals then it <em>can</em> be fixed by something like a regular expression, but probably shouldn't be","m.mentions":{},"msgtype":"m.text"},"ts":1728535200985,"senderName":"Richard Gibson","senderId":"@gibson042:matrix.org","id":"$mGH71EapRjMxU5dc4CNwg4U1v5y4yKcAGl2ikqiLBQM"},
{"content":{"body":"sorry to interrupt, but we are still good for this topic next?  (and after the break)","m.mentions":{},"msgtype":"m.text"},"ts":1728535214059,"senderName":"Chris de Almeida","senderId":"@softwarechris:matrix.org","id":"$5MMGzR_CBBYvVUOSZ9cYxigjNEkk3X5XyhAWASW-W38"},
{"content":{"body":"> <@softwarechris:matrix.org> sorry to interrupt, but we are still good for this topic next?  (and after the break)\n\nI think yes, but if it's ok, it may exceed the 5 minute limit?","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!GURLmrBmuNjUaqboWr:matrix.org/$5MMGzR_CBBYvVUOSZ9cYxigjNEkk3X5XyhAWASW-W38?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@softwarechris:matrix.org\">@softwarechris:matrix.org</a><br>sorry to interrupt, but we are still good for this topic next?  (and after the break)</blockquote></mx-reply>I think yes, but if it's ok, it may exceed the 5 minute limit?","m.mentions":{"user_ids":["@softwarechris:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$5MMGzR_CBBYvVUOSZ9cYxigjNEkk3X5XyhAWASW-W38"}},"msgtype":"m.text"},"ts":1728535231383,"senderName":"jkup","senderId":"@jkup:matrix.org","id":"$iHxWDG_AqOMzIPgjZMiQN97l85TTJfbg1HfHE2PdeCg"},
{"content":{"body":"yeah","m.mentions":{},"msgtype":"m.text"},"ts":1728535237735,"senderName":"Chris de Almeida","senderId":"@softwarechris:matrix.org","id":"$9r-lKHoMGmxTk7VjEAUE8MUD94l3qFADvgZyO9q0IsE"},
{"content":{"body":"not a problem","m.mentions":{},"msgtype":"m.text"},"ts":1728535240505,"senderName":"Chris de Almeida","senderId":"@softwarechris:matrix.org","id":"$-iv0mGLqUR9x2R0ErkZwwAPoLNonIkBUhaxxWR4-ywg"},
{"content":{"body":"ok so, just chatting with Justin Ridgewell . I'm still not sure that tricking devtools into a network request for a sourceMappingURL in a template literal is any worse than just sticking a malicious URL in a normal sourceMappingURL but it seems like we could easily fix this case by changing our non-parser requirements to:\n\n1. Start at end of file\n2. While last line starts with \"//#\" and also line does not contain a \"`\"\n3. Check for comment, if not found, move up a line","format":"org.matrix.custom.html","formatted_body":"<p>ok so, just chatting with <a href=\"https://matrix.to/#/@jridgewell:matrix.org\">Justin Ridgewell</a> . I'm still not sure that tricking devtools into a network request for a sourceMappingURL in a template literal is any worse than just sticking a malicious URL in a normal sourceMappingURL but it seems like we could easily fix this case by changing our non-parser requirements to:</p>\n<ol>\n<li>Start at end of file</li>\n<li>While last line starts with \"//#\" and also line does not contain a \"`\"</li>\n<li>Check for comment, if not found, move up a line</li>\n</ol>\n","m.mentions":{"user_ids":["@jridgewell:matrix.org"]},"msgtype":"m.text"},"ts":1728538534471,"senderName":"jkup","senderId":"@jkup:matrix.org","id":"$Fo05gpQyChZjgcNpWVSOFeEVKEqqK0eRHjQn_fOQ61o"},
{"content":{"body":"that doesn't even work for https://tc39.es/source-map/2024/#example-5b7659a8 AFAICT","m.mentions":{},"msgtype":"m.text"},"ts":1728538759255,"senderName":"Richard Gibson","senderId":"@gibson042:matrix.org","id":"$NVd79IivpXDhU_Rud57PY8f1G-nuTgaH4jR7-XBnlA4"},
{"content":{"body":"Since the last line contains a ` we would bail out in that case","m.mentions":{},"msgtype":"m.text"},"ts":1728538798170,"senderName":"jkup","senderId":"@jkup:matrix.org","id":"$JH27bzvAb53vvSO2rZ_bb4xILscsKvq5nohjUAZNVRk"},
{"content":{"body":"Mark approves of our solution","msgtype":"m.text"},"ts":1728538865217,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$mTN-P0UjejyTGRhZXLeWn2COzQmDPrhCCEUrhAA8Xv0"},
{"content":{"body":"He also exlpained his exploit case: in hardened JS the program could have locked down network access. But because dev tools is external to the program, it could be tricked into performing a fetch in an otherwise locked down environment","msgtype":"m.text"},"ts":1728538944332,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$6j9qBL93FusYc0_3kCBwWxXuPCh6_poWXZQs1JeKU5M"},
{"content":{"body":"ahhhhh yes ok makes sense... we could add a note about this in the spec!","m.mentions":{},"msgtype":"m.text"},"ts":1728539049165,"senderName":"jkup","senderId":"@jkup:matrix.org","id":"$eLgbssjAHV7b9LptMojddJAesw_kk_2OuvsW1rYVyIQ"},
{"content":{"body":"> <@gibson042:matrix.org> that doesn't even work for https://tc39.es/source-map/2024/#example-5b7659a8 AFAICT\n\nMark’s proposed change makes that case not find a source map","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!GURLmrBmuNjUaqboWr%3Amatrix.org/%24NVd79IivpXDhU_Rud57PY8f1G-nuTgaH4jR7-XBnlA4\">In reply to</a><a href=\"https://matrix.to/#/%40gibson042%3Amatrix.org\">@gibson042:matrix.org</a><br />that doesn&#39;t even work for https://tc39.es/source-map/2024/#example-5b7659a8 AFAICT</blockquote></mx-reply>Mark’s proposed change makes that case not find a source map","m.relates_to":{"m.in_reply_to":{"event_id":"$NVd79IivpXDhU_Rud57PY8f1G-nuTgaH4jR7-XBnlA4"}},"msgtype":"m.text"},"ts":1728539228419,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$sRsIDBUx5m8CVDiGdaFcHw8g5QXNFiVIWSWu545-0Cw"},
{"content":{"body":"note that the WHATWG URL spec will accept ``` ` ``` inside URLs like ```` https://example.com/`/ ``` : https://example.com/`/","format":"org.matrix.custom.html","formatted_body":"note that the WHATWG URL spec will accept <code>`</code> inside URLs like ```` https://example.com/<code>/ ``` : https://example.com/</code>/","m.mentions":{},"msgtype":"m.text"},"ts":1728539232034,"senderName":"Richard Gibson","senderId":"@gibson042:matrix.org","id":"$AA25C8jBTgdrtmgq2b4ANbAJy7MEsdFKdsP-XXVOupg"},
{"content":{"body":" * note that the WHATWG URL spec will accept ````` inside URLs like \\`\\`\\`\\` https://example.com/````/ ``` : https://example.com/````/\n\n```\nhttps://example.com/`/\n```","format":"org.matrix.custom.html","formatted_body":" * <p>note that the WHATWG URL spec will accept ````` inside URLs like ```` https://example.com/<code>/ ``` : https://example.com/</code>/</p>\n<pre><code>https://example.com/`/\n</code></pre>\n","m.mentions":{},"m.new_content":{"body":"note that the WHATWG URL spec will accept ````` inside URLs like \\`\\`\\`\\` https://example.com/````/ ``` : https://example.com/````/\n\n```\nhttps://example.com/`/\n```","format":"org.matrix.custom.html","formatted_body":"<p>note that the WHATWG URL spec will accept ````` inside URLs like ```` https://example.com/<code>/ ``` : https://example.com/</code>/</p>\n<pre><code>https://example.com/`/\n</code></pre>\n","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$AA25C8jBTgdrtmgq2b4ANbAJy7MEsdFKdsP-XXVOupg","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1728539247633,"senderName":"Richard Gibson","senderId":"@gibson042:matrix.org","id":"$_9G72bySulSLhLXF2aABQ2JMlyyPCG2eiszCcTPX-4U"},
{"content":{"body":"Yes, but they are invalid in a base64 data URI","msgtype":"m.text"},"ts":1728539247981,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$b2gqESTAqkNxIELNxP2PeWC1EF94NnrfdRBQ0eSPVTA"},
{"content":{"body":"Can we weaken requirements for tools, or say we don’t have an answer?","msgtype":"m.text"},"ts":1728539274946,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$hVfN3mv7LkZeMU9chn640H24aM2VWKNf_Ve5_dtoAEo"},
{"content":{"body":" * note that the WHATWG URL spec will accept \\` inside URLs like https://example.com/\\`/\n\n```\nhttps://example.com/`/\n```","format":"org.matrix.custom.html","formatted_body":" * <p>note that the WHATWG URL spec will accept ` inside URLs like https://example.com/`/</p>\n<pre><code>https://example.com/`/\n</code></pre>\n","m.mentions":{},"m.new_content":{"body":"note that the WHATWG URL spec will accept \\` inside URLs like https://example.com/\\`/\n\n```\nhttps://example.com/`/\n```","format":"org.matrix.custom.html","formatted_body":"<p>note that the WHATWG URL spec will accept ` inside URLs like https://example.com/`/</p>\n<pre><code>https://example.com/`/\n</code></pre>\n","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$AA25C8jBTgdrtmgq2b4ANbAJy7MEsdFKdsP-XXVOupg","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1728539284338,"senderName":"Richard Gibson","senderId":"@gibson042:matrix.org","id":"$wrg0SMh1MCWFQi1KxxENxhz3TIAF7IWKbtcuXSQ4taE"},
{"content":{"body":"Mark accepts no normative changes, we’ll only state that\n1. Parsing is always preferred\n2. Non-parsing is non-normative, and has an explicit note that there is a bug\n3. A note that we will fix the bug in a future proposal","format":"org.matrix.custom.html","formatted_body":"Mark accepts no normative changes, we’ll only state that<br/><ol data-md=\"1\" start=\"1\"><li><p>Parsing is always preferred</p></li><li><p>Non-parsing is non-normative, and has an explicit note that there is a bug</p></li><li><p>A note that we will fix the bug in a future proposal</p></li></ol>","msgtype":"m.text"},"ts":1728540561281,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$pinZVxOjCNe2ejjl5o9KS1i_tWKI4OqsES6sLWMccug"},
{"content":{"body":"We are (conditionally) approved!! Thank you all so much for the help and flexibility and expertise this week. I love this group!","m.mentions":{},"msgtype":"m.text"},"ts":1728540972773,"senderName":"jkup","senderId":"@jkup:matrix.org","id":"$Ls1Y35Vi07MPrQrG8SPXyKkQslA2PoXSVZJTiGbbfrQ"},
{"content":{"body":"To clarify, the regex-based parsing remains (removing it would be normative!), but with a note that we will need to tweak it","m.mentions":{},"msgtype":"m.text"},"ts":1728541016115,"senderName":"Nic","senderId":"@nribaudo:igalia.com","id":"$pVfV537RBvDk83Bt1L8FcjZnWnhAlB2lXKgkfbIoZrI"},
{"content":{"body":"Stressful but so glad for all the feedback from Mark/Justin/Nic/Richard and all! I feel like this week will lead to a much better TG4 specification.","m.mentions":{},"msgtype":"m.text"},"ts":1728541025154,"senderName":"jkup","senderId":"@jkup:matrix.org","id":"$a6JATEuZyh_GcsY2XTwPt7s5d59jL2pYc5V21TSHM-I"},
{"content":{"body":"Thank you everyone who was in Tokyo and pushed this forward :) Especially Jon for presenting :) Congrats everyone!","m.mentions":{},"msgtype":"m.text"},"ts":1728541217323,"senderName":"Simon Zünd","senderId":"@szuend:matrix.org","id":"$_a5qosL3D6PyoigQgHVXClnB_El63sN2iXr1R2AkPEg"},
{"content":{"body":"👏👏👏👏👏👏👏","m.mentions":{},"msgtype":"m.text"},"ts":1728541273080,"senderName":"Chris de Almeida","senderId":"@softwarechris:matrix.org","id":"$Su1xQqJRaDw_wlvAjh4VGuIbiaNhGXX6EwQz51RB7GM"},
{"content":{"body":"https://github.com/tc39/source-map/pull/137 please take a look :)","m.mentions":{},"msgtype":"m.text"},"ts":1728551863489,"senderName":"Nic","senderId":"@nribaudo:igalia.com","id":"$-Pa0y1iOEmCg3uj59H87oyU6M6NOXr18uWxkoLZPj-k"}
]