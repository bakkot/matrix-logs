[
{"content":{"body":"To answer the last question first: You'd be able to achieve this already with the current source map format. The sourceMappingURL is allowed to be cross-origin.\n\nThe closest thing I can think of are artifact servers for cloud providers. E.g. MS Azure allows you to host source maps (and original source files) for you behind some OAuth, so you can securely debug an app without making the source/source maps publicly available (https://learn.microsoft.com/en-us/microsoft-edge/devtools-guide-chromium/javascript/consume-source-maps-from-azure).\n\nAFAIK there is no package registry purely for source maps yet.","m.mentions":{},"msgtype":"m.text"},"ts":1744085900169,"senderName":"Simon Zünd","senderId":"@szuend:matrix.org","id":"$VH7TqhANGDLJjCwJI2QZ4DHHaUu845JpHUHc6hvelYk"},
{"content":{"body":"should we work together to build one? It could make source maps available in practice more of the time, reduce the incentive for doing a data URL for the source map (which slows down loading time), and reduce the size of npm packages (for installation time)","m.mentions":{},"msgtype":"m.text"},"ts":1744113706008,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$F0JHQwrBrg5i8PYxmgc5kaZlAFgzn3BcrUr1R2aFnGQ"},
{"content":{"body":"ah nice! i didn't realise map URLs can be cross-origin","m.mentions":{},"msgtype":"m.text"},"ts":1744118116499,"senderName":"James","senderId":"@43081j:matrix.org","id":"$uW1565uTOearEcsv3le1y_dYOSDQ4ZbODae3-vrUzpw"},
{"content":{"body":"Nic: the benefit .net and various other languages doing this have is that they don't need to ship debug symbols\nthink of a compiled language, you want to ship the cut down production binary with no debug symbols etc. \nyou then pull those symbols from a separate source if you want to debug said binary\n\nwe could do the same by having a sourcemap registry and pull sourcemaps from there instead of shipping them in our packages","format":"org.matrix.custom.html","formatted_body":"<p><a href=\"https://matrix.to/#/@nribaudo:igalia.com\">Nic</a>: the benefit .net and various other languages doing this have is that they don't need to ship debug symbols<br>think of a compiled language, you want to ship the cut down production binary with no debug symbols etc.<br>you then pull those symbols from a separate source if you want to debug said binary</p>\n<p>we could do the same by having a sourcemap registry and pull sourcemaps from there instead of shipping them in our packages</p>\n","m.mentions":{"user_ids":["@nribaudo:igalia.com"]},"msgtype":"m.text"},"ts":1744118204607,"senderName":"James","senderId":"@43081j:matrix.org","id":"$FG2_bR9l7u2Kyi0ENcfhnLRycyIy6zbxW_F0qWo4dzo"},
{"content":{"body":"e.g. cloudflare recently removed sourcemaps and halved their package size. great for everyone except the couple of people who want to debug it nicely. but if they could pull those maps from some other source, that'd solve it for both sides","m.mentions":{},"msgtype":"m.text"},"ts":1744118245272,"senderName":"James","senderId":"@43081j:matrix.org","id":"$K7X-MUvyJGkZtnYriVPsH1JXPIlSe_ROlBrs7nqzAUU"},
{"content":{"body":"we could do this now by having a build-time transform which sets the sourcemap URL to a remote one and uploads them to the server","m.mentions":{},"msgtype":"m.text"},"ts":1744118345900,"senderName":"James","senderId":"@43081j:matrix.org","id":"$QiT4B6CP9geyQp1EXIDmKL1dHAS3__3A0sZJDgUKTKo"},
{"content":{"body":"Could it be something like we have `@types/foo`, e.g. `@source-map/foo`?","format":"org.matrix.custom.html","formatted_body":"Could it be something like we have <code>@types/foo</code>, e.g. <code>@source-map/foo</code>?","m.mentions":{},"msgtype":"m.text"},"ts":1744119288587,"senderName":"Nic","senderId":"@nribaudo:igalia.com","id":"$llsvdeezHaVj-a-iOKIP3N3LIM6XNKXUad9gpyDBFow"},
{"content":{"body":"i think so yes","m.mentions":{},"msgtype":"m.text"},"ts":1744119705040,"senderName":"James","senderId":"@43081j:matrix.org","id":"$wuqXpU4iM-sDs-qpZh8GYInpyB1sWIl8dKN_F8bLx_U"},
{"content":{"body":"though maybe its more like unpkg or something. as it isn't something you'd pull from npm. if you did host it on npm though, i suppose you could use something like unpkg/jsdelivr/etc to retrieve it","m.mentions":{},"msgtype":"m.text"},"ts":1744119794872,"senderName":"James","senderId":"@43081j:matrix.org","id":"$JORKJvnVGqLhxrtQRDTsVkQbbxsn92Iv1jAoJ9jMNmo"},
{"content":{"body":"i.e. if we publish our map to `@source-map/foo`, our sources link to `somecdn.com/@source-map/foo/lib/index.js.map`","format":"org.matrix.custom.html","formatted_body":"i.e. if we publish our map to <code>@source-map/foo</code>, our sources link to <code>somecdn.com/@source-map/foo/lib/index.js.map</code>","m.mentions":{},"msgtype":"m.text"},"ts":1744119832654,"senderName":"James","senderId":"@43081j:matrix.org","id":"$5lu4HdAqJiDKRAyFH1zcl_A3u5kukt0mpl67uO_cCJw"},
{"content":{"body":"maybe thats how you avoid needing a whole new registry/host","m.mentions":{},"msgtype":"m.text"},"ts":1744119850873,"senderName":"James","senderId":"@43081j:matrix.org","id":"$xZGP7TDdyKcVGEBnJg02ZbQm5sKdhlxvWYAINQlZ4HQ"},
{"content":{"body":"`@types` works because DT manages all those packages - i don't think you'd want to have to manage everyone's source maps and keep them in sync","format":"org.matrix.custom.html","formatted_body":"<code>@types</code> works because DT manages all those packages - i don't think you'd want to have to manage everyone's source maps and keep them in sync","m.mentions":{},"msgtype":"m.text"},"ts":1744129052179,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$gvn6xR34d7XO1Mh7ofQT8Qb8M4BoU2PD_cAGbFLT_9c"},
{"content":{"body":"yeah having your source maps centralized on some cdn seems less risky than actually loading your source from there","m.mentions":{},"msgtype":"m.text"},"ts":1744137834498,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$qo-6FQlY40V3CZCjOSh4-RMYAYoWUqix0Scuzc3Flvs"},
{"content":{"body":"I would like to see it to become common for the stock source map URL to be a content address of the preceding text, and eventually, implicit, so an IDE could be configured to find the sourcemap in whatever storage. At Agoric, we’ve been working toward a solution where our bundler drops source maps in a conventional XDG caches directory, keyed on content address. We believe there’s a solution you can rig up WebPack this way and, in a VSCode launch.json, map content addresses to local physical files, but I simply haven’t found credible documentation for it.","m.mentions":{},"msgtype":"m.text"},"ts":1744138736211,"senderName":"kriskowal","senderId":"@kriskowal:aelf.land","id":"$snZL2ERrIF1VQ128tpeBw4AxOLF5ZAh-1i-tBozSG-0"},
{"content":{"body":"Consider `source-map://${hash}.map.json`.","format":"org.matrix.custom.html","formatted_body":"Consider <code>source-map://${hash}.map.json</code>.","m.mentions":{},"msgtype":"m.text"},"ts":1744138751544,"senderName":"kriskowal","senderId":"@kriskowal:aelf.land","id":"$l8seNTP0H8ahQuMEbNgYarHxXKUXbNTmN4VnZmXAhKE"},
{"content":{"body":"Do you mean using `\"sourceMapPathOverrides\"`? https://code.visualstudio.com/docs/nodejs/nodejs-debugging#_overriding-source-map-paths","format":"org.matrix.custom.html","formatted_body":"Do you mean using <code>\"sourceMapPathOverrides\"</code>? https://code.visualstudio.com/docs/nodejs/nodejs-debugging#_overriding-source-map-paths","m.mentions":{"user_ids":["@kriskowal:aelf.land"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$snZL2ERrIF1VQ128tpeBw4AxOLF5ZAh-1i-tBozSG-0"}},"msgtype":"m.text"},"ts":1744144065104,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$-oaVYWiDAge51xcwKhYjF25a1SvrTsmovePEUYrR1uI"},
{"content":{"body":"There it is!","m.mentions":{"user_ids":["@rbuckton:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$-oaVYWiDAge51xcwKhYjF25a1SvrTsmovePEUYrR1uI"}},"msgtype":"m.text"},"ts":1744144338198,"senderName":"kriskowal","senderId":"@kriskowal:aelf.land","id":"$ER2t1Rc-BaxYl3qGCp39bMfL3SqmKiVn0KWlYcsQNzw"},
{"content":{"body":"So, I believe this is the thing we would use to make `source-map://${hash}.map.json` just work. It doesn’t look particularly fancy, so it’d probably look more like `source-map://b0/b5c0ffeefacade.map.json` so we don’t end up with intractable `readdir` expenses.","format":"org.matrix.custom.html","formatted_body":"So, I believe this is the thing we would use to make <code>source-map://${hash}.map.json</code> just work. It doesn’t look particularly fancy, so it’d probably look more like <code>source-map://b0/b5c0ffeefacade.map.json</code> so we don’t end up with intractable <code>readdir</code> expenses.","m.mentions":{},"msgtype":"m.text"},"ts":1744144529570,"senderName":"kriskowal","senderId":"@kriskowal:aelf.land","id":"$-2CdBslsscM8LaNvIwP_OZulirbfvIbDJ8ul-mUjEnI"},
{"content":{"body":"If that practice became the norm, bundlers, LSP, and registries could conspire to their hearts’ content.","m.mentions":{},"msgtype":"m.text"},"ts":1744144591852,"senderName":"kriskowal","senderId":"@kriskowal:aelf.land","id":"$fOYE1oW3Od6K4HCR2abNnVv2SJgBv0q24aV6Y8t0zTY"},
{"content":{"body":"IIRC, there was an internal hackathon to make sure VSCode supported remote sourcemaps and this kind of wire up so it could use them somewhat like a symbol server. In lieu of a bundler, even tsc lets you specify a URL as the base to use for `sourceMappingURL=` via the `\"mapRoot\"` option, as well as a URL for sources using the `\"sourceRoot\"` option, assuming you don't just use `\"inlineSources\": true`","format":"org.matrix.custom.html","formatted_body":"IIRC, there was an internal hackathon to make sure VSCode supported remote sourcemaps and this kind of wire up so it could use them somewhat like a symbol server. In lieu of a bundler, even tsc lets you specify a URL as the base to use for <code>sourceMappingURL=</code> via the <code>\"mapRoot\"</code> option, as well as a URL for sources using the <code>\"sourceRoot\"</code> option, assuming you don't just use <code>\"inlineSources\": true</code>","m.mentions":{},"msgtype":"m.text"},"ts":1744145052046,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$CYAU3nEtDJQTJMsph8l-nqTDA61pGmJAw7FD0BN9r_c"},
{"content":{"body":"We find that we have to tolerate certain compromises in order to ensure that our bundles produce consistent content regardless of the parent path and as insensitive as possible to the layout of the node_modules tree. We tend to inject a source URL like `.../${nameOfPackageParentDirectory}/${pathWithinPackage}` and tolerate the occasional collision due to “eval twin” packages under `node_modules` or the occasional divergence between the name of the package and the name of the directory containing the package. And, consistent hashes have their own vagaries.","format":"org.matrix.custom.html","formatted_body":"We find that we have to tolerate certain compromises in order to ensure that our bundles produce consistent content regardless of the parent path and as insensitive as possible to the layout of the node_modules tree. We tend to inject a source URL like <code>.../${nameOfPackageParentDirectory}/${pathWithinPackage}</code> and tolerate the occasional collision due to “eval twin” packages under <code>node_modules</code> or the occasional divergence between the name of the package and the name of the directory containing the package. And, consistent hashes have their own vagaries.","m.mentions":{},"msgtype":"m.text"},"ts":1744145835349,"senderName":"kriskowal","senderId":"@kriskowal:aelf.land","id":"$YozHCpK8Wqv2tloY6AxoNVsqTRHBlKwkIYDS0RV-42M"},
{"content":{"body":"kriskowal: Is that a content hash of the source map you're referencing?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@kriskowal:aelf.land\">kriskowal</a>: Is that a content hash of the source map you're referencing?","m.mentions":{"user_ids":["@kriskowal:aelf.land"]},"msgtype":"m.text"},"ts":1744146263966,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$3-igoicVavX94Qw_DKCMhwxs0e8a-TncoYqQG-z2T8Y"},
{"content":{"body":"That’s an open design question. That probably wouldn’t work for our case, because of fully qualified file URLs in the source map varying between users and host systems, which would frustrate the consistency of the hash of the bundle.","m.mentions":{},"msgtype":"m.text"},"ts":1744146483532,"senderName":"kriskowal","senderId":"@kriskowal:aelf.land","id":"$gKqHN5Z9nDHCZ9c0br7KP2wFY5vuzHeZ2-NFkwnCrTY"}
]