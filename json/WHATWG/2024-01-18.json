[
{"content":{"body":"> <@bakkot:matrix.org> maybe it's just that the `arrayBuffer` method predates the more general tendency to prefer `Uint8Array`?\n\nI think this is likely.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$XvjX5fIF8UdZ0evI8Z7PTeIiY7fhuMO-m2eCBegmQYg?via=matrix.org&via=mozilla.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@bakkot:matrix.org\">@bakkot:matrix.org</a><br>maybe it's just that the <code>arrayBuffer</code> method predates the more general tendency to prefer <code>Uint8Array</code>?</blockquote></mx-reply>I think this is likely.","m.mentions":{"user_ids":["@bakkot:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$XvjX5fIF8UdZ0evI8Z7PTeIiY7fhuMO-m2eCBegmQYg"}},"msgtype":"m.text"},"ts":1705555837634,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$FTdtZIq9Bf_dyM8IDBth1CcMtRrp-WtOJ8Py7nzlBj4"},
{"content":{"body":"Figure there's any appetite for adding a `.bytes()` method to get a Uint8Array? It feels a bit unnecessary given that you can just do `new Uint8Array(await body.arrayBuffer())`, but it would be more consistent in allowing people to never think about ArrayBuffers","format":"org.matrix.custom.html","formatted_body":"Figure there's any appetite for adding a <code>.bytes()</code> method to get a Uint8Array? It feels a bit unnecessary given that you can just do <code>new Uint8Array(await body.arrayBuffer())</code>, but it would be more consistent in allowing people to never think about ArrayBuffers","m.mentions":{},"msgtype":"m.text"},"ts":1705556427733,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$neESJV24Kb1Pz9u_n5txD08fa4WZN3gPDZeSVsutFqw"},
{"content":{"body":"I think so. Seems uncontroversial, but also the kind of thing that would benefit from someone being willing to submit patches since it's not exactly fitting into any team's quarterly goals.","m.mentions":{},"msgtype":"m.text"},"ts":1705557361756,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$UhKPLnvVGhFfBxRJsBSnzRkEhGqDRakZhDTRJWXPZy4"},
{"content":{"body":"bakkot: that seems reasonable. We'd have to add it to some other APIs too that copied Fetch. And maybe we should annotate `arrayBuffer()` somehow so it doesn't get copied further.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@bakkot:matrix.org\">bakkot</a>: that seems reasonable. We'd have to add it to some other APIs too that copied Fetch. And maybe we should annotate <code>arrayBuffer()</code> somehow so it doesn't get copied further.","m.mentions":{"user_ids":["@bakkot:matrix.org"]},"msgtype":"m.text"},"ts":1705563905730,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$OOa8i2UxDUM9fr0lpWe_fB--M1IdDjOGRqS4Ocnx7Tg"},
{"content":{"body":"a quick glance through https://dontcallmedom.github.io/webidlpedia/names/ArrayBuffer.html suggests it has been copied only to PushMessageData and Blob, which isn't too bad so far","m.mentions":{},"msgtype":"m.text"},"ts":1705564780770,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$X9lDLVR51qKDdkSUhF1XHdlXCHW-nS-ZQyYb3K2pDnM"},
{"content":{"body":"Yeah, that sounds about right.","m.mentions":{},"msgtype":"m.text"},"ts":1705564810543,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$nKpZgRkmyXKg8h2gMP_iPWx3rcNVfRZL6EspRmuzbTw"},
{"content":{"body":"FileReader also has `readAsArrayBuffer` which is a bit odd","format":"org.matrix.custom.html","formatted_body":"FileReader also has <code>readAsArrayBuffer</code> which is a bit odd","m.mentions":{},"msgtype":"m.text"},"ts":1705564823515,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$wSkKpQLIqDgKLC75Am0Suvja6auR6rA7tRe1fBK8NT4"},
{"content":{"body":"Right, we don't have to care about updating FileReader though. It's kinda like XHR (which also has responseType = \"arrayBuffer\" come to think of it).","m.mentions":{},"msgtype":"m.text"},"ts":1705564858491,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$O7Iwrqzm4KguBHIolrK0bUYRipwoKEr9Xybsvuq_XOw"},
{"content":{"body":"huh, wonder why that doesn't show up on the WebIDLpedia page","m.mentions":{},"msgtype":"m.text"},"ts":1705564903926,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$gqoOi-4AvKlazToZLnkv43qoEwabuJUv4hBlXOreJKg"},
{"content":{"body":"anyway yeah","m.mentions":{},"msgtype":"m.text"},"ts":1705564907320,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$zi8nrO2ROqkKaeW8HfRePw5NhVKHplWze7kM6jTCFM4"},
{"content":{"body":"Probably because it's an enum value?","m.mentions":{},"msgtype":"m.text"},"ts":1705564924920,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$E-5h796CAgiwOeQPGVAaleNYYkACVy09Zxkt6BItY3Y"},
{"content":{"body":" * Right, we don't have to care about updating FileReader though. It's kinda like XHR (which also has responseType = \"arraybuffer\" come to think of it).","m.mentions":{},"m.new_content":{"body":"Right, we don't have to care about updating FileReader though. It's kinda like XHR (which also has responseType = \"arraybuffer\" come to think of it).","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$O7Iwrqzm4KguBHIolrK0bUYRipwoKEr9Xybsvuq_XOw","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1705564939083,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$b633meNieEbmFhyu1b4clrTsOPVkYtGOMd_lpF6T8w0"},
{"content":{"body":"I'd expect it to show up in the algorithm, though. maybe the enum value gets threaded through to Fetch?","m.mentions":{},"msgtype":"m.text"},"ts":1705564962245,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$gis9HOHzfAYeu8Ia_qAIjJBZiipbSC-c62vDsUn4X0E"},
{"content":{"body":"anyway, if \"things which vend bytes should vend Uint8Arrays specifically, not ArrayBuffer\" is indeed a general principle to follow, might also be worth documenting in the design principles?","m.mentions":{},"msgtype":"m.text"},"ts":1705564987458,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$eqM_-9jM3nEh1wncG-YkpOVchB3PqsvtSDJroIskuec"},
{"content":{"body":"bakkot: XHR has responseType (takes an enum) and response (which returns the type corresponding to the enum)","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@bakkot:matrix.org\">bakkot</a>: XHR has responseType (takes an enum) and response (which returns the type corresponding to the enum)","m.mentions":{"user_ids":["@bakkot:matrix.org"]},"msgtype":"m.text"},"ts":1705565676207,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$GOTnepoP7jIQGWEVnu41didIaPGAf_vD1pFtqPV6mvM"}
]