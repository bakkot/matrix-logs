[
{"content":{"body":"foolip: Noam Rosenthal : No wide usage of <!marker> in httparchive https://docs.google.com/spreadsheets/d/1JRDf0k6ZYNa_2UZH5QuQuuTs3tjzOVsmqfz53g1ssKU/edit?usp=sharing","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@foolip:matrix.org\">foolip</a>: <a href=\"https://matrix.to/#/@noamr:matrix.org\">Noam Rosenthal</a> : No wide usage of &lt;!marker&gt; in httparchive https://docs.google.com/spreadsheets/d/1JRDf0k6ZYNa_2UZH5QuQuuTs3tjzOVsmqfz53g1ssKU/edit?usp=sharing","m.mentions":{"user_ids":["@foolip:matrix.org","@noamr:matrix.org"]},"msgtype":"m.text"},"ts":1768821346106,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$KiVc6wq4s4mkm9cGjQ0Y-NmaRg2cQWY_fNaYE62QEyM"},
{"content":{"body":"zcorpan: also seems like most downstream parser can handle bogus comments","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@zcorpan:mozilla.org\">zcorpan</a>: also seems like most downstream parser can handle bogus comments","m.mentions":{"user_ids":["@zcorpan:mozilla.org"]},"msgtype":"m.text"},"ts":1768821385090,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$cAWuKD02j_77QzGATa7wDpZ8cMq64dK1NJBmS-fu5gs"},
{"content":{"body":"zcorpan: main webcompat issue might be with scripts not expecting a new node type after all these years","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@zcorpan:mozilla.org\">zcorpan</a>: main webcompat issue might be with scripts not expecting a new node type after all these years","m.mentions":{"user_ids":["@zcorpan:mozilla.org"]},"msgtype":"m.text"},"ts":1768821408640,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$KfADRaxDRttXZsYk_SY_kpzZrGa8c_-UguBEn-8WyAw"},
{"content":{"body":"Yeah","m.mentions":{},"msgtype":"m.text"},"ts":1768821428781,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$XHLi4ppv-6XsM53OtUDbtHX-BX_SctmciSXAfDYl3PU"},
{"content":{"body":"From this search I noticed that some people use <!link ...> as a way to comment it out. SVG has a <marker> element. But I think it's not common enough to be an issue","m.mentions":{},"msgtype":"m.text"},"ts":1768821491064,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$Lig8LREtMiMpY8dJhD5eqFq8NPqMu-rWwQCmzl_6PYo"},
{"content":{"body":"zcorpan: I think the main open issue is how to deal with \"end\" markers. Are they allowed to be orphaned or does DOM deal with disposing them","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@zcorpan:mozilla.org\">zcorpan</a>: I think the main open issue is how to deal with \"end\" markers. Are they allowed to be orphaned or does DOM deal with disposing them","m.mentions":{"user_ids":["@zcorpan:mozilla.org"]},"msgtype":"m.text"},"ts":1768821680796,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$29RnaQqml0JBtM5NuxpvF32Oe3pLW9hGuoDJvkzrQp0"},
{"content":{"body":"(or something in between, where they are parsed as bogus comments when not in the right place, but DOM can move them)","m.mentions":{},"msgtype":"m.text"},"ts":1768821717417,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$c5qt_qcrkWeGf-39oegLUM1_pSoIqIHTgxlt6gPKGPI"},
{"content":{"body":"keeping them atomic seems compelling for simplicity but perhaps moves some of the complexity to the author","m.mentions":{},"msgtype":"m.text"},"ts":1768821771609,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$Yds7TNOokLjaGK3HNj7rtFg5fFC4HJIE0yIgLjLAQs0"},
{"content":{"body":"I discussed with foolip an idea of yanking both the start and end markers and storing either offsets (like a range) or pointers to the node before start and after end on the container element","m.mentions":{},"msgtype":"m.text"},"ts":1768821884532,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$zt3SWIHygNUtHz5IfnSWUUXjuvTG4K6EPJCVtMvXO0Y"},
{"content":{"body":"yea but then it can lose the state when serializing","m.mentions":{},"msgtype":"m.text"},"ts":1768821936893,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$ilQdWDuSHBM1aBR7in_itUGrvEOYYkI1Uc-d02saajQ"},
{"content":{"body":"or if you add elements in between","m.mentions":{},"msgtype":"m.text"},"ts":1768821952956,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$eyXryAuMPSZMPOFtVgAf0BMaHjH-7tlTiSE97OT2VWo"},
{"content":{"body":"The serializer can write the markers again though?","m.mentions":{},"msgtype":"m.text"},"ts":1768821990237,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$nNnSU7W5kCeKSmvzSqkZFBtExVMP_aTJ7Ejv5axuQgk"},
{"content":{"body":"It breaks the mapping... e.g. if you later prepend HTML to the element with markers you have to recompute what's going on and it's easy to lose track","m.mentions":{},"msgtype":"m.text"},"ts":1768822159468,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$GSI1vmWChz-q4-zxSjdfHJryEFcRj38Af63w9sfzStI"},
{"content":{"body":"(especially if you have more than one range)","m.mentions":{},"msgtype":"m.text"},"ts":1768822265883,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$tiJJWb_4ax601N3tQgJ_F8AqtE3EgJNuNMpWnIT9IIo"},
{"content":{"body":"Do these markers work when within embedded svg or MathML contexts? I'm guessing yes?","msgtype":"m.text"},"ts":1768822290962,"senderName":"Luke Warlow","senderId":"@lwarlow:igalia.com","id":"$P2H0YwaFxLG6QzIsvLcyuVCMBA6LcEw3lwBuNWeJYVk"},
{"content":{"body":"Probably yes. As long as it's a normal container element (not self-closing, not script/style/title/textarea / iframe etc)","m.mentions":{"user_ids":["@lwarlow:igalia.com"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$P2H0YwaFxLG6QzIsvLcyuVCMBA6LcEw3lwBuNWeJYVk"}},"msgtype":"m.text"},"ts":1768822368716,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$Yx2LvNhCstMDmizJRAfynmxo1J5PlFbIGLEM-n4jYo0"},
{"content":{"body":"zcorpan: e.g. problematic issue:\n```\nBefore\n<!start>\n<div id=first></div>\n<!end>\n\n<script>\nfirst.after(\"second\")\n</script>\n```\n\nIf the range state is part of the element it would create an unexpected thing because the new contents would be outside the range","format":"org.matrix.custom.html","formatted_body":"<p><a href=\"https://matrix.to/#/@zcorpan:mozilla.org\">zcorpan</a>: e.g. problematic issue:</p>\n<pre><code>Before\n&lt;!start&gt;\n&lt;div id=first&gt;&lt;/div&gt;\n&lt;!end&gt;\n\n&lt;script&gt;\nfirst.after(\"second\")\n&lt;/script&gt;\n</code></pre>\n<p>If the range state is part of the element it would create an unexpected thing because the new contents would be outside the range</p>\n","m.mentions":{"user_ids":["@zcorpan:mozilla.org"]},"msgtype":"m.text"},"ts":1768822845048,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$z5TnXjK-0xVSFAxKjKjq3wD7T4-B4GeSSa2HCDjlaLU"},
{"content":{"body":"Noam Rosenthal: With the model of storing pointers, the node before start is \"Before\", the node after end is a whitespace text node. Inserting nodes between would be part of the range.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@noamr:matrix.org\">Noam Rosenthal</a>: With the model of storing pointers, the node before start is \"Before\", the node after end is a whitespace text node. Inserting nodes between would be part of the range.","m.mentions":{"user_ids":["@noamr:matrix.org"]},"msgtype":"m.text"},"ts":1768823130771,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$07OPpF9CHpQSYwn3ctrt28kJFn5tVuzPteZfJvpjxMA"},
{"content":{"body":"yea but then it gets weird if `Before` gets moved. maybe we can still parse these as bogus comments and the element keeps the range as a pair of pointers to these comments, serializing them with <! if they match the range","format":"org.matrix.custom.html","formatted_body":"yea but then it gets weird if <code>Before</code> gets moved. maybe we can still parse these as bogus comments and the element keeps the range as a pair of pointers to these comments, serializing them with &lt;! if they match the range","m.mentions":{"user_ids":["@zcorpan:mozilla.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$07OPpF9CHpQSYwn3ctrt28kJFn5tVuzPteZfJvpjxMA"}},"msgtype":"m.text"},"ts":1768823235077,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$J8ioml-kD1GTcaSj4hyztTVzCduF33zUk9WvreOB2Jk"},
{"content":{"body":"I guess that works, yeah","m.mentions":{},"msgtype":"m.text"},"ts":1768823975348,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$1lhpXXBEztb6fXdQxMchsZk4G43dX5L-ISstd5snsCQ"},
{"content":{"body":"Should it be possible to set markers with DOM API?","m.mentions":{},"msgtype":"m.text"},"ts":1768824049792,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$S-Duep6lkPS0XQh3NF_JWyMCbPihp856dPvJIHSafSo"}
]