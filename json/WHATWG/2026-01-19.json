[
{"content":{"body":"foolip: Noam Rosenthal : No wide usage of <!marker> in httparchive https://docs.google.com/spreadsheets/d/1JRDf0k6ZYNa_2UZH5QuQuuTs3tjzOVsmqfz53g1ssKU/edit?usp=sharing","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@foolip:matrix.org\">foolip</a>: <a href=\"https://matrix.to/#/@noamr:matrix.org\">Noam Rosenthal</a> : No wide usage of &lt;!marker&gt; in httparchive https://docs.google.com/spreadsheets/d/1JRDf0k6ZYNa_2UZH5QuQuuTs3tjzOVsmqfz53g1ssKU/edit?usp=sharing","m.mentions":{"user_ids":["@foolip:matrix.org","@noamr:matrix.org"]},"msgtype":"m.text"},"ts":1768821346106,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$KiVc6wq4s4mkm9cGjQ0Y-NmaRg2cQWY_fNaYE62QEyM"},
{"content":{"body":"zcorpan: also seems like most downstream parser can handle bogus comments","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@zcorpan:mozilla.org\">zcorpan</a>: also seems like most downstream parser can handle bogus comments","m.mentions":{"user_ids":["@zcorpan:mozilla.org"]},"msgtype":"m.text"},"ts":1768821385090,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$cAWuKD02j_77QzGATa7wDpZ8cMq64dK1NJBmS-fu5gs"},
{"content":{"body":"zcorpan: main webcompat issue might be with scripts not expecting a new node type after all these years","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@zcorpan:mozilla.org\">zcorpan</a>: main webcompat issue might be with scripts not expecting a new node type after all these years","m.mentions":{"user_ids":["@zcorpan:mozilla.org"]},"msgtype":"m.text"},"ts":1768821408640,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$KfADRaxDRttXZsYk_SY_kpzZrGa8c_-UguBEn-8WyAw"},
{"content":{"body":"Yeah","m.mentions":{},"msgtype":"m.text"},"ts":1768821428781,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$XHLi4ppv-6XsM53OtUDbtHX-BX_SctmciSXAfDYl3PU"},
{"content":{"body":"From this search I noticed that some people use <!link ...> as a way to comment it out. SVG has a <marker> element. But I think it's not common enough to be an issue","m.mentions":{},"msgtype":"m.text"},"ts":1768821491064,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$Lig8LREtMiMpY8dJhD5eqFq8NPqMu-rWwQCmzl_6PYo"},
{"content":{"body":"zcorpan: I think the main open issue is how to deal with \"end\" markers. Are they allowed to be orphaned or does DOM deal with disposing them","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@zcorpan:mozilla.org\">zcorpan</a>: I think the main open issue is how to deal with \"end\" markers. Are they allowed to be orphaned or does DOM deal with disposing them","m.mentions":{"user_ids":["@zcorpan:mozilla.org"]},"msgtype":"m.text"},"ts":1768821680796,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$29RnaQqml0JBtM5NuxpvF32Oe3pLW9hGuoDJvkzrQp0"},
{"content":{"body":"(or something in between, where they are parsed as bogus comments when not in the right place, but DOM can move them)","m.mentions":{},"msgtype":"m.text"},"ts":1768821717417,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$c5qt_qcrkWeGf-39oegLUM1_pSoIqIHTgxlt6gPKGPI"},
{"content":{"body":"keeping them atomic seems compelling for simplicity but perhaps moves some of the complexity to the author","m.mentions":{},"msgtype":"m.text"},"ts":1768821771609,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$Yds7TNOokLjaGK3HNj7rtFg5fFC4HJIE0yIgLjLAQs0"},
{"content":{"body":"I discussed with foolip an idea of yanking both the start and end markers and storing either offsets (like a range) or pointers to the node before start and after end on the container element","m.mentions":{},"msgtype":"m.text"},"ts":1768821884532,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$zt3SWIHygNUtHz5IfnSWUUXjuvTG4K6EPJCVtMvXO0Y"},
{"content":{"body":"yea but then it can lose the state when serializing","m.mentions":{},"msgtype":"m.text"},"ts":1768821936893,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$ilQdWDuSHBM1aBR7in_itUGrvEOYYkI1Uc-d02saajQ"},
{"content":{"body":"or if you add elements in between","m.mentions":{},"msgtype":"m.text"},"ts":1768821952956,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$eyXryAuMPSZMPOFtVgAf0BMaHjH-7tlTiSE97OT2VWo"},
{"content":{"body":"The serializer can write the markers again though?","m.mentions":{},"msgtype":"m.text"},"ts":1768821990237,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$nNnSU7W5kCeKSmvzSqkZFBtExVMP_aTJ7Ejv5axuQgk"},
{"content":{"body":"It breaks the mapping... e.g. if you later prepend HTML to the element with markers you have to recompute what's going on and it's easy to lose track","m.mentions":{},"msgtype":"m.text"},"ts":1768822159468,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$GSI1vmWChz-q4-zxSjdfHJryEFcRj38Af63w9sfzStI"},
{"content":{"body":"(especially if you have more than one range)","m.mentions":{},"msgtype":"m.text"},"ts":1768822265883,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$tiJJWb_4ax601N3tQgJ_F8AqtE3EgJNuNMpWnIT9IIo"},
{"content":{"body":"Do these markers work when within embedded svg or MathML contexts? I'm guessing yes?","msgtype":"m.text"},"ts":1768822290962,"senderName":"Luke Warlow","senderId":"@lwarlow:igalia.com","id":"$P2H0YwaFxLG6QzIsvLcyuVCMBA6LcEw3lwBuNWeJYVk"},
{"content":{"body":"Probably yes. As long as it's a normal container element (not self-closing, not script/style/title/textarea / iframe etc)","m.mentions":{"user_ids":["@lwarlow:igalia.com"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$P2H0YwaFxLG6QzIsvLcyuVCMBA6LcEw3lwBuNWeJYVk"}},"msgtype":"m.text"},"ts":1768822368716,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$Yx2LvNhCstMDmizJRAfynmxo1J5PlFbIGLEM-n4jYo0"},
{"content":{"body":"zcorpan: e.g. problematic issue:\n```\nBefore\n<!start>\n<div id=first></div>\n<!end>\n\n<script>\nfirst.after(\"second\")\n</script>\n```\n\nIf the range state is part of the element it would create an unexpected thing because the new contents would be outside the range","format":"org.matrix.custom.html","formatted_body":"<p><a href=\"https://matrix.to/#/@zcorpan:mozilla.org\">zcorpan</a>: e.g. problematic issue:</p>\n<pre><code>Before\n&lt;!start&gt;\n&lt;div id=first&gt;&lt;/div&gt;\n&lt;!end&gt;\n\n&lt;script&gt;\nfirst.after(\"second\")\n&lt;/script&gt;\n</code></pre>\n<p>If the range state is part of the element it would create an unexpected thing because the new contents would be outside the range</p>\n","m.mentions":{"user_ids":["@zcorpan:mozilla.org"]},"msgtype":"m.text"},"ts":1768822845048,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$z5TnXjK-0xVSFAxKjKjq3wD7T4-B4GeSSa2HCDjlaLU"},
{"content":{"body":"Noam Rosenthal: With the model of storing pointers, the node before start is \"Before\", the node after end is a whitespace text node. Inserting nodes between would be part of the range.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@noamr:matrix.org\">Noam Rosenthal</a>: With the model of storing pointers, the node before start is \"Before\", the node after end is a whitespace text node. Inserting nodes between would be part of the range.","m.mentions":{"user_ids":["@noamr:matrix.org"]},"msgtype":"m.text"},"ts":1768823130771,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$07OPpF9CHpQSYwn3ctrt28kJFn5tVuzPteZfJvpjxMA"},
{"content":{"body":"yea but then it gets weird if `Before` gets moved. maybe we can still parse these as bogus comments and the element keeps the range as a pair of pointers to these comments, serializing them with <! if they match the range","format":"org.matrix.custom.html","formatted_body":"yea but then it gets weird if <code>Before</code> gets moved. maybe we can still parse these as bogus comments and the element keeps the range as a pair of pointers to these comments, serializing them with &lt;! if they match the range","m.mentions":{"user_ids":["@zcorpan:mozilla.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$07OPpF9CHpQSYwn3ctrt28kJFn5tVuzPteZfJvpjxMA"}},"msgtype":"m.text"},"ts":1768823235077,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$J8ioml-kD1GTcaSj4hyztTVzCduF33zUk9WvreOB2Jk"},
{"content":{"body":"I guess that works, yeah","m.mentions":{},"msgtype":"m.text"},"ts":1768823975348,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$1lhpXXBEztb6fXdQxMchsZk4G43dX5L-ISstd5snsCQ"},
{"content":{"body":"Should it be possible to set markers with DOM API?","m.mentions":{},"msgtype":"m.text"},"ts":1768824049792,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$S-Duep6lkPS0XQh3NF_JWyMCbPihp856dPvJIHSafSo"},
{"content":{"body":"Probably with an API on the element rather than manipulating them directly? Note that anyway you'd have to name those ranges in the `sink` attribute or whatnot\nI wonder though if this adds much because you can still end up with junk bogus comments if you move them around yourself","format":"org.matrix.custom.html","formatted_body":"Probably with an API on the element rather than manipulating them directly? Note that anyway you'd have to name those ranges in the <code>sink</code> attribute or whatnot<br>I wonder though if this adds much because you can still end up with junk bogus comments if you move them around yourself","m.mentions":{"user_ids":["@zcorpan:mozilla.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$S-Duep6lkPS0XQh3NF_JWyMCbPihp856dPvJIHSafSo"}},"msgtype":"m.text"},"ts":1768824668088,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$SmHNgSz2uCqGbG6dUu8z3dxez6Eb78kXv9q6Dn9_vSQ"},
{"content":{"body":"... Perhaps this is getting too complicated, and we should keep markers atomic+generic and keep the relationship between markers and patching as an attribute-like thing\n\n```\n<div sink=\"title search-results\">\n   <!marker start=title>Current title<!marker end=title>\n   <!marker name=\"search-results\">\n</div>\n```\n\nThis way it's clear that markers are atomic things that DOM doesn't \"manage\" and error handling is done when patching","format":"org.matrix.custom.html","formatted_body":"<p>... Perhaps this is getting too complicated, and we should keep markers atomic+generic and keep the relationship between markers and patching as an attribute-like thing</p>\n<pre><code>&lt;div sink=\"title search-results\"&gt;\n   &lt;!marker start=title&gt;Current title&lt;!marker end=title&gt;\n   &lt;!marker name=\"search-results\"&gt;\n&lt;/div&gt;\n</code></pre>\n<p>This way it's clear that markers are atomic things that DOM doesn't \"manage\" and error handling is done when patching</p>\n","m.mentions":{},"msgtype":"m.text"},"ts":1768828698133,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$y2koNbRNuTkL_hnd1Y7Za7bG4OPGn_dCeZL3eQ3QeQg"},
{"content":{"body":"zcorpan, foolip I think this is a lot simpler, jotted it down on gist: https://gist.github.com/noamr/4c8b4972d717816f3e8a0dc4c3e3c907\n\nBasically markers are atomic and unopinionated. not opinionated about patches/ranges. Instead, they provide metadata for patches/ranges as attributes. It allows us to extend markers to other uses in the future or to let frameworks be opinionated about them in other ways","format":"org.matrix.custom.html","formatted_body":"<p><a href=\"https://matrix.to/#/@zcorpan:mozilla.org\">zcorpan</a>, <a href=\"https://matrix.to/#/@foolip:matrix.org\">foolip</a> I think this is a lot simpler, jotted it down on gist: https://gist.github.com/noamr/4c8b4972d717816f3e8a0dc4c3e3c907</p>\n<p>Basically markers are atomic and unopinionated. not opinionated about patches/ranges. Instead, they provide metadata for patches/ranges as attributes. It allows us to extend markers to other uses in the future or to let frameworks be opinionated about them in other ways</p>\n","m.mentions":{"user_ids":["@zcorpan:mozilla.org","@foolip:matrix.org"]},"m.relates_to":{"event_id":"$y2koNbRNuTkL_hnd1Y7Za7bG4OPGn_dCeZL3eQ3QeQg","is_falling_back":true,"m.in_reply_to":{"event_id":"$y2koNbRNuTkL_hnd1Y7Za7bG4OPGn_dCeZL3eQ3QeQg"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1768841304346,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$2tG3clwCVcEIuInyvmYUfiaaiya50HwYYEZeYyTSMMI"},
{"content":{"body":"* zcorpan, foolip I think this is a lot simpler, jotted it down on gist: https://gist.github.com/noamr/4c8b4972d717816f3e8a0dc4c3e3c907\n\nBasically markers are atomic and unopinionated about patches/ranges. Instead, they provide metadata for patches/ranges as attributes. It allows us to extend markers to other uses in the future or to let frameworks be opinionated about them in other ways","format":"org.matrix.custom.html","formatted_body":"* <p><a href=\"https://matrix.to/#/@zcorpan:mozilla.org\">zcorpan</a>, <a href=\"https://matrix.to/#/@foolip:matrix.org\">foolip</a> I think this is a lot simpler, jotted it down on gist: https://gist.github.com/noamr/4c8b4972d717816f3e8a0dc4c3e3c907</p>\n<p>Basically markers are atomic and unopinionated about patches/ranges. Instead, they provide metadata for patches/ranges as attributes. It allows us to extend markers to other uses in the future or to let frameworks be opinionated about them in other ways</p>\n","m.mentions":{},"m.new_content":{"body":"zcorpan, foolip I think this is a lot simpler, jotted it down on gist: https://gist.github.com/noamr/4c8b4972d717816f3e8a0dc4c3e3c907\n\nBasically markers are atomic and unopinionated about patches/ranges. Instead, they provide metadata for patches/ranges as attributes. It allows us to extend markers to other uses in the future or to let frameworks be opinionated about them in other ways","format":"org.matrix.custom.html","formatted_body":"<p><a href=\"https://matrix.to/#/@zcorpan:mozilla.org\">zcorpan</a>, <a href=\"https://matrix.to/#/@foolip:matrix.org\">foolip</a> I think this is a lot simpler, jotted it down on gist: https://gist.github.com/noamr/4c8b4972d717816f3e8a0dc4c3e3c907</p>\n<p>Basically markers are atomic and unopinionated about patches/ranges. Instead, they provide metadata for patches/ranges as attributes. It allows us to extend markers to other uses in the future or to let frameworks be opinionated about them in other ways</p>\n","m.mentions":{"user_ids":["@zcorpan:mozilla.org","@foolip:matrix.org"]},"msgtype":"m.text"},"m.relates_to":{"event_id":"$2tG3clwCVcEIuInyvmYUfiaaiya50HwYYEZeYyTSMMI","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1768841317117,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$XOaSyMmGUb7bY4ysgeSpN1RazQUbKGix7Smbe9nmyLM"},
{"content":{"body":"Why is entry global object use discouraged? cc annevk because you mentioned this in a [comment](https://github.com/whatwg/html/pull/11519#discussion_r2410613201) (or anyone who could comment on this is also welcomed as the only info I found is this old issue but )\n\nFor context, I'm working on this PR where I was using entry global object to reference the frame that initiated an action (calling focus) but seems like using it is discouraged in general in new specs https://github.com/whatwg/html/pull/11519","format":"org.matrix.custom.html","formatted_body":"<p>Why is entry global object use discouraged? cc <a href=\"https://matrix.to/#/@annevk:matrix.org\">annevk</a> because you mentioned this in a <a href=\"https://github.com/whatwg/html/pull/11519#discussion_r2410613201\">comment</a> (or anyone who could comment on this is also welcomed as the only info I found is this old issue but )</p>\n<p>For context, I'm working on this PR where I was using entry global object to reference the frame that initiated an action (calling focus) but seems like using it is discouraged in general in new specs https://github.com/whatwg/html/pull/11519</p>\n","m.mentions":{"user_ids":["@annevk:matrix.org"]},"msgtype":"m.text"},"ts":1768866242766,"senderName":"Fernando Fiori","senderId":"@ffiori:matrix.org","id":"$5FY358Mi3492nbDQ3J9w-0cqIMr2LnK9XnqEzN-hl3U"},
{"content":{"body":"* Why is entry global object use discouraged? cc annevk because you mentioned this in a [comment](https://github.com/whatwg/html/pull/11519#discussion_r2410613201) (or anyone who could comment on this is also welcomed as the only info I found is this old issue but I didn't see the reasons https://github.com/whatwg/html/issues/1431)\n\nFor context, I'm working on this PR where I was using entry global object to reference the frame that initiated an action (calling focus) but using it is discouraged in general in new specs https://github.com/whatwg/html/pull/11519","format":"org.matrix.custom.html","formatted_body":"* <p>Why is entry global object use discouraged? cc <a href=\"https://matrix.to/#/@annevk:matrix.org\">annevk</a> because you mentioned this in a <a href=\"https://github.com/whatwg/html/pull/11519#discussion_r2410613201\">comment</a> (or anyone who could comment on this is also welcomed as the only info I found is this old issue but I didn't see the reasons https://github.com/whatwg/html/issues/1431)</p>\n<p>For context, I'm working on this PR where I was using entry global object to reference the frame that initiated an action (calling focus) but using it is discouraged in general in new specs https://github.com/whatwg/html/pull/11519</p>\n","m.mentions":{},"m.new_content":{"body":"Why is entry global object use discouraged? cc annevk because you mentioned this in a [comment](https://github.com/whatwg/html/pull/11519#discussion_r2410613201) (or anyone who could comment on this is also welcomed as the only info I found is this old issue but I didn't see the reasons https://github.com/whatwg/html/issues/1431)\n\nFor context, I'm working on this PR where I was using entry global object to reference the frame that initiated an action (calling focus) but using it is discouraged in general in new specs https://github.com/whatwg/html/pull/11519","format":"org.matrix.custom.html","formatted_body":"<p>Why is entry global object use discouraged? cc <a href=\"https://matrix.to/#/@annevk:matrix.org\">annevk</a> because you mentioned this in a <a href=\"https://github.com/whatwg/html/pull/11519#discussion_r2410613201\">comment</a> (or anyone who could comment on this is also welcomed as the only info I found is this old issue but I didn't see the reasons https://github.com/whatwg/html/issues/1431)</p>\n<p>For context, I'm working on this PR where I was using entry global object to reference the frame that initiated an action (calling focus) but using it is discouraged in general in new specs https://github.com/whatwg/html/pull/11519</p>\n","m.mentions":{"user_ids":["@annevk:matrix.org"]},"msgtype":"m.text"},"m.relates_to":{"event_id":"$5FY358Mi3492nbDQ3J9w-0cqIMr2LnK9XnqEzN-hl3U","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1768866276217,"senderName":"Fernando Fiori","senderId":"@ffiori:matrix.org","id":"$cT1GHzRiqq7OpdQisr9zsv9pLI41OadP-0oAvCXbWdg"}
]