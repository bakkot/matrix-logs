[
{"content":{"body":"Noam Rosenthal: thanks for doing that","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@noamr:matrix.org\">Noam Rosenthal</a>: thanks for doing that","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"Noam Rosenthal: thanks for doing that","mimetype":"text/plain"},{"body":"<a href=\"https://matrix.to/#/@noamr:matrix.org\">Noam Rosenthal</a>: thanks for doing that","mimetype":"text/html"}]},"ts":1662517616607,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$cb7fF2jqd7Sn9D4U8Ye2N_P9ST1ZKzHCcZfn-ptAGVQ"},
{"content":{"body":"AFAICT, https://github.com/web-platform-tests/wpt/blob/master/upgrade-insecure-requests/gen/iframe-blank-inherit.meta/upgrade/fetch.https.html tests that calling `document.open()` on the initial `about:blank` inherits `upgrade-insecure-requests` from the caller to the `open()`ed doc. I don't see this specified in either https://w3c.github.io/webappsec-upgrade-insecure-requests/ or https://html.spec.whatwg.org/#document-open-steps . What am I missing? (Also, Gecko tries to inherit CSP between steps 6 and 7, but evidently, it's not inheriting enough.)","format":"org.matrix.custom.html","formatted_body":"AFAICT, https://github.com/web-platform-tests/wpt/blob/master/upgrade-insecure-requests/gen/iframe-blank-inherit.meta/upgrade/fetch.https.html tests that calling <code>document.open()</code> on the initial <code>about:blank</code> inherits <code>upgrade-insecure-requests</code> from the caller to the <code>open()</code>ed doc. I don't see this specified in either https://w3c.github.io/webappsec-upgrade-insecure-requests/ or https://html.spec.whatwg.org/#document-open-steps . What am I missing? (Also, Gecko tries to inherit CSP between steps 6 and 7, but evidently, it's not inheriting enough.)","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"AFAICT, https://github.com/web-platform-tests/wpt/blob/master/upgrade-insecure-requests/gen/iframe-blank-inherit.meta/upgrade/fetch.https.html tests that calling `document.open()` on the initial `about:blank` inherits `upgrade-insecure-requests` from the caller to the `open()`ed doc. I don't see this specified in either https://w3c.github.io/webappsec-upgrade-insecure-requests/ or https://html.spec.whatwg.org/#document-open-steps . What am I missing? (Also, Gecko tries to inherit CSP between steps 6 and 7, but evidently, it's not inheriting enough.)","mimetype":"text/plain"},{"body":"AFAICT, https://github.com/web-platform-tests/wpt/blob/master/upgrade-insecure-requests/gen/iframe-blank-inherit.meta/upgrade/fetch.https.html tests that calling <code>document.open()</code> on the initial <code>about:blank</code> inherits <code>upgrade-insecure-requests</code> from the caller to the <code>open()</code>ed doc. I don't see this specified in either https://w3c.github.io/webappsec-upgrade-insecure-requests/ or https://html.spec.whatwg.org/#document-open-steps . What am I missing? (Also, Gecko tries to inherit CSP between steps 6 and 7, but evidently, it's not inheriting enough.)","mimetype":"text/html"}]},"ts":1662540022338,"senderName":"hsivonen","senderId":"@hsivonen:mozilla.org","id":"$eMSxm6fm9cYp8GBpQEDqASm9292O6L7xfXmGEMNRzXE"},
{"content":{"body":"hsivonen: seems like a bad test. I can't immediately tell given how many layers of generation seem to be going on but I would doubt that was intentionally tested...","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@hsivonen:mozilla.org\">hsivonen</a>: seems like a bad test. I can't immediately tell given how many layers of generation seem to be going on but I would doubt that was intentionally tested...","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"hsivonen: seems like a bad test. I can't immediately tell given how many layers of generation seem to be going on but I would doubt that was intentionally tested...","mimetype":"text/plain"},{"body":"<a href=\"https://matrix.to/#/@hsivonen:mozilla.org\">hsivonen</a>: seems like a bad test. I can't immediately tell given how many layers of generation seem to be going on but I would doubt that was intentionally tested...","mimetype":"text/html"}]},"ts":1662547748526,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$OgD7g_K2bWdNfDXSlX7kO6SNMJPcL8dqLtaevTlHUMk"},
{"content":{"body":"This code looks totally bogus in Chromium to me... https://source.chromium.org/chromium/chromium/src/+/main:third_party/blink/renderer/core/dom/document.cc;l=3257-3285;drc=6bf619d06ef290056d3e134756c1c4eaa17a2d70","msgtype":"m.text","org.matrix.msc1767.text":"This code looks totally bogus in Chromium to me... https://source.chromium.org/chromium/chromium/src/+/main:third_party/blink/renderer/core/dom/document.cc;l=3257-3285;drc=6bf619d06ef290056d3e134756c1c4eaa17a2d70"},"ts":1662547804482,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$Jgti2nZL0hD8_QYPsRcAuhLfcVoI6r6ZQ4Cyw2NTVAE"},
{"content":{"body":"The test was OK after all. I tracked it down to Gecko's failure to recompute upgrade-insecure-requests upon `document.open`","format":"org.matrix.custom.html","formatted_body":"The test was OK after all. I tracked it down to Gecko's failure to recompute upgrade-insecure-requests upon <code>document.open</code>","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"The test was OK after all. I tracked it down to Gecko's failure to recompute upgrade-insecure-requests upon `document.open`","mimetype":"text/plain"},{"body":"The test was OK after all. I tracked it down to Gecko's failure to recompute upgrade-insecure-requests upon <code>document.open</code>","mimetype":"text/html"}]},"ts":1662547843880,"senderName":"hsivonen","senderId":"@hsivonen:mozilla.org","id":"$iZzi3jvxC5D2LXZOu8E_xzuo8cdleatUhUSAuHKu2sw"},
{"content":{"body":"(Gecko copied the CSP OK, but failed to actually run the function to compute upgrade-insecure-requests out of the CSP)","msgtype":"m.text","org.matrix.msc1767.text":"(Gecko copied the CSP OK, but failed to actually run the function to compute upgrade-insecure-requests out of the CSP)"},"ts":1662547882582,"senderName":"hsivonen","senderId":"@hsivonen:mozilla.org","id":"$ZC5MjSohfYe0yzcEr6fYXtaQKkJ3N22InAy4LTN1bUg"},
{"content":{"body":"Fascinating","msgtype":"m.text","org.matrix.msc1767.text":"Fascinating"},"ts":1662547915523,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$YckCSaol2IhwPaJ9HNXTyP_5CO70aY1pEypDJ9a4naY"},
{"content":{"body":"I am hoping we can avoid inheriting anything, whether it's Gecko's CSP or Blink's renderer-process-only sandbox flags / security origin","msgtype":"m.text","org.matrix.msc1767.text":"I am hoping we can avoid inheriting anything, whether it's Gecko's CSP or Blink's renderer-process-only sandbox flags / security origin"},"ts":1662547938295,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$jwwOxYcWdUg6WekZBegpMVj9Kd1eOaMfNo902-H7Tts"},
{"content":{"body":"(Aside: The way `fetch()` spec-wise inherits CSP from the doc in the `window` that `fetch()` is called on, is specified so abstractly that I wasn't confident how upgrade-insecure-requests should propagate, but it turns out that it should propagate from doc to `fetch()`.)","format":"org.matrix.custom.html","formatted_body":"(Aside: The way <code>fetch()</code> spec-wise inherits CSP from the doc in the <code>window</code> that <code>fetch()</code> is called on, is specified so abstractly that I wasn't confident how upgrade-insecure-requests should propagate, but it turns out that it should propagate from doc to <code>fetch()</code>.)","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"(Aside: The way `fetch()` spec-wise inherits CSP from the doc in the `window` that `fetch()` is called on, is specified so abstractly that I wasn't confident how upgrade-insecure-requests should propagate, but it turns out that it should propagate from doc to `fetch()`.)","mimetype":"text/plain"},{"body":"(Aside: The way <code>fetch()</code> spec-wise inherits CSP from the doc in the <code>window</code> that <code>fetch()</code> is called on, is specified so abstractly that I wasn't confident how upgrade-insecure-requests should propagate, but it turns out that it should propagate from doc to <code>fetch()</code>.)","mimetype":"text/html"}]},"ts":1662548039419,"senderName":"hsivonen","senderId":"@hsivonen:mozilla.org","id":"$mKjw6Ewe70Hg3lC5lcnzKNiTZJ-8BD-Le2gyxh_81l4"},
{"content":{"body":"Fuked https://bugs.chromium.org/p/chromium/issues/detail?id=1360795","msgtype":"m.text","org.matrix.msc1767.text":"Fuked https://bugs.chromium.org/p/chromium/issues/detail?id=1360795"},"ts":1662548096501,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$0VCJI7SHHNd8Au6kkFadg0UYkjuglIURoRq4f7qeMjg"}
]