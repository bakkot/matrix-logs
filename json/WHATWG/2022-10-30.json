[
{"content":{"body":"At https://html.spec.whatwg.org/multipage/parsing.html#parse-error-surrogate-in-input-stream I see this note:\n\n> Surrogates can only find their way into the input stream via script APIs such as document.write()\n\n...but I can't find what part of the parsing algorithm it is that actually prevents surrogates from otherwise finding their way into the input stream.\n\nThere's at least nothing in the parsing algorithm that explicitly checks for surrogates, so I'm not sure what else I should be looking for...","msgtype":"m.text"},"ts":1667112613724,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$e0gMXVSveZvRGpkgZEycDorUL5yZVu4n0TKU1_-3otU"},
{"content":{"body":"* At https://html.spec.whatwg.org/multipage/parsing.html#parse-error-surrogate-in-input-stream I see this note:\n\n> Surrogates can only find their way into the input stream via script APIs such as document.write()\n\n...but I can't find what part of the parsing algorithm it is that actually prevents surrogates from otherwise finding their way into the input stream.\n\nThere's at least nothing in the parsing algorithm that explicitly checks for surrogates, so I'm not sure what else I should be looking for...","m.new_content":{"body":"At https://html.spec.whatwg.org/multipage/parsing.html#parse-error-surrogate-in-input-stream I see this note:\n\n> Surrogates can only find their way into the input stream via script APIs such as document.write()\n\n...but I can't find what part of the parsing algorithm it is that actually prevents surrogates from otherwise finding their way into the input stream.\n\nThere's at least nothing in the parsing algorithm that explicitly checks for surrogates, so I'm not sure what else I should be looking for...","msgtype":"m.text"},"m.relates_to":{"event_id":"$e0gMXVSveZvRGpkgZEycDorUL5yZVu4n0TKU1_-3otU","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1667112676961,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$DIdJD0-XS1sMDknZKjfHI1hTz23iHbkKE6MYFGGRp9k"},
{"content":{"body":"sideshowbarker: byte to code point conversion takes care of that (i.e., the Encoding standard)","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@sideshowbarker:matrix.org\">sideshowbarker</a>: byte to code point conversion takes care of that (i.e., the Encoding standard)","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"sideshowbarker: byte to code point conversion takes care of that (i.e., the Encoding standard)","mimetype":"text/plain"},{"body":"<a href=\"https://matrix.to/#/@sideshowbarker:matrix.org\">sideshowbarker</a>: byte to code point conversion takes care of that (i.e., the Encoding standard)","mimetype":"text/html"}]},"ts":1667118775755,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$vy9plvDFDxpyImD6VS1n7zdfhesSFYqnZhf4hyyYfKs"},
{"content":{"body":"annevk: thanks, yeah, I subsequently at https://html.spec.whatwg.org/multipage/parsing.html#the-input-byte-stream found:\n> Given a character encoding, the bytes in the input byte stream must be converted to characters for the tokenizer's input stream, by passing the input byte stream and character encoding to decode.","format":"org.matrix.custom.html","formatted_body":"<p><a href=\"https://matrix.to/#/@annevk:matrix.org\">annevk</a>: thanks, yeah, I subsequently at https://html.spec.whatwg.org/multipage/parsing.html#the-input-byte-stream found:</p>\n<blockquote>\n<p>Given a character encoding, the bytes in the input byte stream must be converted to characters for the tokenizer's input stream, by passing the input byte stream and character encoding to decode.</p>\n</blockquote>\n","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"annevk: thanks, yeah, I subsequently at https://html.spec.whatwg.org/multipage/parsing.html#the-input-byte-stream found:\n> Given a character encoding, the bytes in the input byte stream must be converted to characters for the tokenizer's input stream, by passing the input byte stream and character encoding to decode.","mimetype":"text/plain"},{"body":"<p><a href=\"https://matrix.to/#/@annevk:matrix.org\">annevk</a>: thanks, yeah, I subsequently at https://html.spec.whatwg.org/multipage/parsing.html#the-input-byte-stream found:</p>\n<blockquote>\n<p>Given a character encoding, the bytes in the input byte stream must be converted to characters for the tokenizer's input stream, by passing the input byte stream and character encoding to decode.</p>\n</blockquote>\n","mimetype":"text/html"}]},"ts":1667119240824,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$_Sd62Of_jKKRB0huzGfs9UW6TWXJ4Q_JcWdVOTF-QpM"},
{"content":{"body":"annevk: so if I have a `style` element in a document that’s already been parsed by a conformant HTML parser, and I want to process the CSS stylesheet that element contains, I should not need to do https://drafts.csswg.org/css-syntax/#input-preprocessing to pre-process that any further, right?\n\nI mean, because the HTML parser has already done all the newline normalization and replacing of U+0000 and replacing of stray surrogates which that CSS preprocessing algorithm would do. Right?","format":"org.matrix.custom.html","formatted_body":"<p><a href=\"https://matrix.to/#/@annevk:matrix.org\">annevk</a>: so if I have a <code>style</code> element in a document that’s already been parsed by a conformant HTML parser, and I want to process the CSS stylesheet that element contains, I should not need to do https://drafts.csswg.org/css-syntax/#input-preprocessing to pre-process that any further, right?</p>\n<p>I mean, because the HTML parser has already done all the newline normalization and replacing of U+0000 and replacing of stray surrogates which that CSS preprocessing algorithm would do. Right?</p>\n","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"annevk: so if I have a `style` element in a document that’s already been parsed by a conformant HTML parser, and I want to process the CSS stylesheet that element contains, I should not need to do https://drafts.csswg.org/css-syntax/#input-preprocessing to pre-process that any further, right?\n\nI mean, because the HTML parser has already done all the newline normalization and replacing of U+0000 and replacing of stray surrogates which that CSS preprocessing algorithm would do. Right?","mimetype":"text/plain"},{"body":"<p><a href=\"https://matrix.to/#/@annevk:matrix.org\">annevk</a>: so if I have a <code>style</code> element in a document that’s already been parsed by a conformant HTML parser, and I want to process the CSS stylesheet that element contains, I should not need to do https://drafts.csswg.org/css-syntax/#input-preprocessing to pre-process that any further, right?</p>\n<p>I mean, because the HTML parser has already done all the newline normalization and replacing of U+0000 and replacing of stray surrogates which that CSS preprocessing algorithm would do. Right?</p>\n","mimetype":"text/html"}]},"ts":1667119693847,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$qKgrZMu2pHZXyK8xzNc3-x1aqy_dfi3qAvOckE_LUsU"},
{"content":{"body":"sideshowbarker: I don't think HTML replaces FF by LF. Do CSS parser actually do that? Seems really weird.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@sideshowbarker:matrix.org\">sideshowbarker</a>: I don't think HTML replaces FF by LF. Do CSS parser actually do that? Seems really weird.","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"sideshowbarker: I don't think HTML replaces FF by LF. Do CSS parser actually do that? Seems really weird.","mimetype":"text/plain"},{"body":"<a href=\"https://matrix.to/#/@sideshowbarker:matrix.org\">sideshowbarker</a>: I don't think HTML replaces FF by LF. Do CSS parser actually do that? Seems really weird.","mimetype":"text/html"}]},"ts":1667125843433,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$lzjTLupxd4h0D1qUPyhHyhfiKX6bdVOb1JoOEX9t1bI"},
{"content":{"body":"HTML does handle U+0000 if memory serves so that step can indeed be skipped","msgtype":"m.text","org.matrix.msc1767.text":"HTML does handle U+0000 if memory serves so that step can indeed be skipped"},"ts":1667125877982,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$prC12UId6puZU_6zHtM90uu2C2AjLIh2_BhZvEpKI_w"},
{"content":{"body":"yeah I don’t know why CSS needs to be doing something different than calling into “decode” from the Encoding standard, the way that the HTML parsing algorithm does","msgtype":"m.text","org.matrix.msc1767.text":"yeah I don’t know why CSS needs to be doing something different than calling into “decode” from the Encoding standard, the way that the HTML parsing algorithm does"},"ts":1667125967156,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$B15ZyPBag6RAMd9VQiUHjRmXuCkff3u6zBKRq7mfZHI"},
{"content":{"body":" * yeah I don’t know why CSS needs to be doing something different than calling into “decode” from the Encoding standard, the way that the HTML parsing algorithm does","m.new_content":{"body":"yeah I don’t know why CSS needs to be doing something different than calling into “decode” from the Encoding standard, the way that the HTML parsing algorithm does","msgtype":"m.text","org.matrix.msc1767.text":"yeah I don’t know why CSS needs to be doing something different than calling into “decode” from the Encoding standard, the way that the HTML parsing algorithm does"},"m.relates_to":{"event_id":"$B15ZyPBag6RAMd9VQiUHjRmXuCkff3u6zBKRq7mfZHI","rel_type":"m.replace"},"msgtype":"m.text","org.matrix.msc1767.text":" * yeah I don’t know why CSS needs to be doing something different than calling into “decode” from the Encoding standard, the way that the HTML parsing algorithm does"},"ts":1667125981934,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$pzZmSgogLvJgGPkNjBeTdq4gjR5STnEwiOjZsjw5YSI"},
{"content":{"body":"sideshowbarker: well this is something they do after they have code points","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@sideshowbarker:matrix.org\">sideshowbarker</a>: well this is something they do after they have code points","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"sideshowbarker: well this is something they do after they have code points","mimetype":"text/plain"},{"body":"<a href=\"https://matrix.to/#/@sideshowbarker:matrix.org\">sideshowbarker</a>: well this is something they do after they have code points","mimetype":"text/html"}]},"ts":1667126010008,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$_85-xzYT4REFtSgzg8uNZcqTZLm5ZKrukwxWSzw547E"},
{"content":{"body":"ah","msgtype":"m.text","org.matrix.msc1767.text":"ah"},"ts":1667126019990,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$wDu2jpBHIWbw47p6I-ybHMmsZNM1H1iphbKNbSJJMK8"},
{"content":{"body":"So it applies to post-parser and script inputs","msgtype":"m.text","org.matrix.msc1767.text":"So it applies to post-parser and script inputs"},"ts":1667126032908,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$H3eU_xuTp1agM73xPamZXKD2_Pi51Dw92MnC5qL87Ek"},
{"content":{"body":"I see. But that takes me back to my question about why it should be necessary to do that at all for the case of `style` element contents that have already been through an HTML parser","format":"org.matrix.custom.html","formatted_body":"I see. But that takes me back to my question about why it should be necessary to do that at all for the case of <code>style</code> element contents that have already been through an HTML parser","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"I see. But that takes me back to my question about why it should be necessary to do that at all for the case of `style` element contents that have already been through an HTML parser","mimetype":"text/plain"},{"body":"I see. But that takes me back to my question about why it should be necessary to do that at all for the case of <code>style</code> element contents that have already been through an HTML parser","mimetype":"text/html"}]},"ts":1667126109399,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$dHRvuMAY6aRd49MiJzDlieuX_L0hgP682IstQnWLees"},
{"content":{"body":"sideshowbarker: well, the FF to LF translation would not have happened. Why that's necessary? Not sure, I don't recall FF being special in CSS.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@sideshowbarker:matrix.org\">sideshowbarker</a>: well, the FF to LF translation would not have happened. Why that's necessary? Not sure, I don't recall FF being special in CSS.","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"sideshowbarker: well, the FF to LF translation would not have happened. Why that's necessary? Not sure, I don't recall FF being special in CSS.","mimetype":"text/plain"},{"body":"<a href=\"https://matrix.to/#/@sideshowbarker:matrix.org\">sideshowbarker</a>: well, the FF to LF translation would not have happened. Why that's necessary? Not sure, I don't recall FF being special in CSS.","mimetype":"text/html"}]},"ts":1667128960323,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$z9Kx2-qCM5WPzLRmk78SNkkOuWFnHpwsUOXkFju8fpg"},
{"content":{"body":"After thinking about it more, I guess what I'm really wondering about is whether browsers actually do that CSS preprocessing for style element contents.\n\nSo I suppose I should look at the browser sources to see","msgtype":"m.text"},"ts":1667129313319,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$k4Xh5DBOYV0ZJYMYzvq9o_kkZvA4WhYpxhHThvArkuo"}
]