[
{"content":{"body":"I’m noticing some unexpected percent-encoding happening with the HTML checker service, and I’m wondering if it’s just some quirk unique to that, or if there’s something about percent-encoding that I’m misunderstanding","m.mentions":{},"msgtype":"m.text"},"ts":1729052565081,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$niSvYsi43ylpLoqWIbX8oVvTsYG2FZjV8LvMGxifE5w"},
{"content":{"body":"If you go to https://validator.w3.org/nu/ and this:\n`data:text/html;charset=utf-8,<%3Fxml-stylesheet type=\"text/css\" href=\"style.css\"?>`\ninto the **Check by address** text input","format":"org.matrix.custom.html","formatted_body":"If you go to https://validator.w3.org/nu/ and this:<br><code>data:text/html;charset=utf-8,&lt;%3Fxml-stylesheet type=\"text/css\" href=\"style.css\"?&gt;</code><br>into the <strong>Check by address</strong> text input","m.mentions":{},"msgtype":"m.text"},"ts":1729052624202,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$9csfT9vHEMfgMK3pGLVMHvEt4a8SJbUnFFXtBgvri2A"},
{"content":{"body":"…then the request URL that the HTML checker uses is this:\n`https://validator.w3.org/nu/?doc=data%3Atext%2Fhtml%3Bcharset%3Dutf-8%2C%3C%253Fxml-stylesheet+type%3D%22text%2Fcss%22+href%3D%22style.css%22%3F%3E`","format":"org.matrix.custom.html","formatted_body":"…then the request URL that the HTML checker uses is this:<br><code>https://validator.w3.org/nu/?doc=data%3Atext%2Fhtml%3Bcharset%3Dutf-8%2C%3C%253Fxml-stylesheet+type%3D%22text%2Fcss%22+href%3D%22style.css%22%3F%3E</code>","m.mentions":{},"msgtype":"m.text"},"ts":1729052674796,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$2POrf6IcX0liI31ud0xBd5u5p_P6BjbUheiltpSXp6g"},
{"content":{"body":"Notice the `%253F`","format":"org.matrix.custom.html","formatted_body":"Notice the <code>%253F</code>","m.mentions":{},"msgtype":"m.text"},"ts":1729052689872,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$Kx8R4nPRKnoyrQPs01VIsbQNoSyWzgNDgWFPGPb1ZYQ"},
{"content":{"body":"If I manually alter that part of the request URL to `%253F`, the HTML checker seems to fail to parse that data URI value as expected","format":"org.matrix.custom.html","formatted_body":"If I manually alter that part of the request URL to <code>%253F</code>, the HTML checker seems to fail to parse that data URI value as expected","m.mentions":{},"msgtype":"m.text"},"ts":1729052757195,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$pjWDnyzfI0flKqrINN6GcQJnHSvq5NKlC9aaEdXjiXs"},
{"content":{"body":" * If you go to https://validator.w3.org/nu/ and enter this:\n`data:text/html;charset=utf-8,<%3Fxml-stylesheet type=\"text/css\" href=\"style.css\"?>`\ninto the **Check by address** text input","format":"org.matrix.custom.html","formatted_body":" * If you go to https://validator.w3.org/nu/ and enter this:<br><code>data:text/html;charset=utf-8,&lt;%3Fxml-stylesheet type=\"text/css\" href=\"style.css\"?&gt;</code><br>into the <strong>Check by address</strong> text input","m.mentions":{},"m.new_content":{"body":"If you go to https://validator.w3.org/nu/ and enter this:\n`data:text/html;charset=utf-8,<%3Fxml-stylesheet type=\"text/css\" href=\"style.css\"?>`\ninto the **Check by address** text input","format":"org.matrix.custom.html","formatted_body":"If you go to https://validator.w3.org/nu/ and enter this:<br><code>data:text/html;charset=utf-8,&lt;%3Fxml-stylesheet type=\"text/css\" href=\"style.css\"?&gt;</code><br>into the <strong>Check by address</strong> text input","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$9csfT9vHEMfgMK3pGLVMHvEt4a8SJbUnFFXtBgvri2A","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1729052885356,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$skJdnAmA7ADy_7t9FHkVt1msfOPeLAnJdwwIDFflDhA"},
{"content":{"body":" * If you go to https://validator.w3.org/nu/ and enter this data URI:\n`data:text/html;charset=utf-8,<%3Fxml-stylesheet type=\"text/css\" href=\"style.css\"?>`\ninto the **Check by address** text input","format":"org.matrix.custom.html","formatted_body":" * If you go to https://validator.w3.org/nu/ and enter this data URI:<br><code>data:text/html;charset=utf-8,&lt;%3Fxml-stylesheet type=\"text/css\" href=\"style.css\"?&gt;</code><br>into the <strong>Check by address</strong> text input","m.mentions":{},"m.new_content":{"body":"If you go to https://validator.w3.org/nu/ and enter this data URI:\n`data:text/html;charset=utf-8,<%3Fxml-stylesheet type=\"text/css\" href=\"style.css\"?>`\ninto the **Check by address** text input","format":"org.matrix.custom.html","formatted_body":"If you go to https://validator.w3.org/nu/ and enter this data URI:<br><code>data:text/html;charset=utf-8,&lt;%3Fxml-stylesheet type=\"text/css\" href=\"style.css\"?&gt;</code><br>into the <strong>Check by address</strong> text input","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$9csfT9vHEMfgMK3pGLVMHvEt4a8SJbUnFFXtBgvri2A","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1729052962156,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$Dtrw40eHqa_VR4KqV8QtM_mmjgrxNljcwby-LmezBG0"},
{"content":{"body":" * If I manually alter that part of the request URL to `%25%3F`, the HTML checker seems to fail to parse that data URI value as expected","format":"org.matrix.custom.html","formatted_body":" * If I manually alter that part of the request URL to <code>%25%3F</code>, the HTML checker seems to fail to parse that data URI value as expected","m.mentions":{},"m.new_content":{"body":"If I manually alter that part of the request URL to `%25%3F`, the HTML checker seems to fail to parse that data URI value as expected","format":"org.matrix.custom.html","formatted_body":"If I manually alter that part of the request URL to <code>%25%3F</code>, the HTML checker seems to fail to parse that data URI value as expected","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$pjWDnyzfI0flKqrINN6GcQJnHSvq5NKlC9aaEdXjiXs","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1729053039630,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$qYOzfX567wdfPUXdUmfdcG7rAGbPc0n2q0bLmgcsosI"},
{"content":{"body":"`%253F` is valid.  that's `%3F` in the original URI, where the `%` itself is encoded as `%25`","format":"org.matrix.custom.html","formatted_body":"<code>%253F</code> is valid.  that's <code>%3F</code> in the original URI, where the <code>%</code> itself is encoded as <code>%25</code>","m.mentions":{},"msgtype":"m.text"},"ts":1729053131573,"senderName":"arai","senderId":"@arai:mozilla.org","id":"$F4-K82u1TSw8EJ8gkZ6yO5ZNi4ZhoJwz3Z06NPv-IVE"}
]