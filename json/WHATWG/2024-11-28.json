[
{"content":{"body":"annevk: https://nastystereo.com/security/cross-site-post-without-content-type.html -- Uh, why are they posting this instead of reporting a bug with browsers? Is that a standards bug, a browser bug or both?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@annevk:matrix.org\">annevk</a>: https://nastystereo.com/security/cross-site-post-without-content-type.html -- Uh, why are they posting this instead of reporting a bug with browsers? Is that a standards bug, a browser bug or both?","msgtype":"m.text"},"ts":1732781318036,"senderName":"freddy","senderId":"@fbraun:mozilla.org","id":"$nD0CUrLex2ghMnLSvG8eR2al1KXZ1KJrFv2USqNklZU"},
{"content":{"body":"zcorpan (OOO 22 Nov): suggested forwarding this here. Copying his take from elsewhere:\n\nhttps://fetch.spec.whatwg.org/#concept-bodyinit-extract\n10. Switch on object:\nBlob\nSet source to object.\nSet length to object’s size.\nIf object’s type attribute is not the empty byte sequence, set type to its value.\n...\n14. Return (body, type).\nthat is called from https://fetch.spec.whatwg.org/#ref-for-concept-bodyinit-extract%E2%91%A1\n4. If type is non-null and https://webidl.spec.whatwg.org/#this’s https://fetch.spec.whatwg.org/#request-headers’s https://fetch.spec.whatwg.org/#concept-headers-header-list https://fetch.spec.whatwg.org/#header-list-contains `Content-Type`, then https://fetch.spec.whatwg.org/#concept-headers-append (`Content-Type`, type) to https://webidl.spec.whatwg.org/#this’s https://fetch.spec.whatwg.org/#request-headers.\n\nI suppose that step could throw if type is null and there's no content-type header, and method is POST (or disallow no content-type for all methods?)","format":"org.matrix.custom.html","formatted_body":"<p><a href=\"https://matrix.to/#/@zcorpan:mozilla.org\">zcorpan (OOO 22 Nov)</a>: suggested forwarding this here. Copying his take from elsewhere:</p>\n<p>https://fetch.spec.whatwg.org/#concept-bodyinit-extract<br />\n10. Switch on object:<br />\nBlob<br />\nSet source to object.<br />\nSet length to object’s size.<br />\nIf object’s type attribute is not the empty byte sequence, set type to its value.<br />\n...<br />\n14. Return (body, type).<br />\nthat is called from https://fetch.spec.whatwg.org/#ref-for-concept-bodyinit-extract%E2%91%A1<br />\n4. If type is non-null and https://webidl.spec.whatwg.org/#this’s https://fetch.spec.whatwg.org/#request-headers’s https://fetch.spec.whatwg.org/#concept-headers-header-list https://fetch.spec.whatwg.org/#header-list-contains <code>Content-Type</code>, then https://fetch.spec.whatwg.org/#concept-headers-append (<code>Content-Type</code>, type) to https://webidl.spec.whatwg.org/#this’s https://fetch.spec.whatwg.org/#request-headers.</p>\n<p>I suppose that step could throw if type is null and there's no content-type header, and method is POST (or disallow no content-type for all methods?)</p>","m.relates_to":{"event_id":"$nD0CUrLex2ghMnLSvG8eR2al1KXZ1KJrFv2USqNklZU","is_falling_back":true,"m.in_reply_to":{"event_id":"$nD0CUrLex2ghMnLSvG8eR2al1KXZ1KJrFv2USqNklZU"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1732781389790,"senderName":"freddy","senderId":"@fbraun:mozilla.org","id":"$jWinoskclaxcdXc_j1JPPBWKYWnj5lJqHNSj1SXQRF4"},
{"content":{"body":"> XMLHttpRequest does the same (per spec). You can also use an ArrayBuffer or ArrayBufferView I think","format":"org.matrix.custom.html","formatted_body":"<blockquote>\n<p>XMLHttpRequest does the same (per spec). You can also use an ArrayBuffer or ArrayBufferView I think</p>\n</blockquote>","m.relates_to":{"event_id":"$nD0CUrLex2ghMnLSvG8eR2al1KXZ1KJrFv2USqNklZU","is_falling_back":true,"m.in_reply_to":{"event_id":"$jWinoskclaxcdXc_j1JPPBWKYWnj5lJqHNSj1SXQRF4"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1732781401390,"senderName":"freddy","senderId":"@fbraun:mozilla.org","id":"$VjcEhGTCknrBwrjNPrMGpA3v49SQ31gGNlEQV2kc-I8"},
{"content":{"body":"Why does Chromium have a layer between its URL parser and the ICU4C IDNA code that introduces non-conforming behaviors? Given that Firefox and Safari work well enough without such a layer suggests that it's not absolutely necessary for Web compat for Chromium to second-guess ICU4C. https://wpt.fyi/results/url/IdnaTestV2.window.html?label=master&label=experimental&aligned&q=%2Furl%2FIdnaTestV2.window.html Now that UTS 46 has an IgnoreInvalidPunycode flag, some folks think that Chromium sets that flag and think that behaviors not actually covered by that flag are legitimate. annevk , might be worthwhile to resolve https://github.com/whatwg/url/issues/821 sooner than later. ","format":"org.matrix.custom.html","formatted_body":"Why does Chromium have a layer between its URL parser and the ICU4C IDNA code that introduces non-conforming behaviors? Given that Firefox and Safari work well enough without such a layer suggests that it's not absolutely necessary for Web compat for Chromium to second-guess ICU4C. https://wpt.fyi/results/url/IdnaTestV2.window.html?label=master&amp;label=experimental&amp;aligned&amp;q=%2Furl%2FIdnaTestV2.window.html Now that UTS 46 has an IgnoreInvalidPunycode flag, some folks think that Chromium sets that flag and think that behaviors not actually covered by that flag are legitimate. <a href=\"https://matrix.to/#/@annevk:matrix.org\">annevk</a> , might be worthwhile to resolve https://github.com/whatwg/url/issues/821 sooner than later.","m.mentions":{"user_ids":["@annevk:matrix.org"]},"msgtype":"m.text"},"ts":1732782231785,"senderName":"hsivonen","senderId":"@hsivonen:mozilla.org","id":"$aZT7FlZ9BipSmyYATeePgfHdyozwxF7Kggza5qk2F4c"},
{"content":{"body":"hsivonen: have you been able to verify \"recent\" UTS46 changes with regards to whether they are a net good? There's https://github.com/web-platform-tests/wpt/pull/48301 and the general Unicode 16.0 issue against URL. I probably need to look into it to see whether all the changes and now failing tests make sense. But we also can't land this now with Interop 2024 almost wrapping up...\n\nWith regards to that flag: I think Firefox and Safari are correct, but I also don't understand why it was introduced. I think it would be better if that flag was not there at all. But I guess while it is, we might as well explicitly set it to false and continue to complain to UTS46 authors on the side... (However, updating the URL standard to set it to false would require dealing with the tests situation I suspect or perhaps we could argue that part is covered by existing tests?)","format":"org.matrix.custom.html","formatted_body":"<p><a href=\"https://matrix.to/#/@hsivonen:mozilla.org\">hsivonen</a>: have you been able to verify \"recent\" UTS46 changes with regards to whether they are a net good? There's https://github.com/web-platform-tests/wpt/pull/48301 and the general Unicode 16.0 issue against URL. I probably need to look into it to see whether all the changes and now failing tests make sense. But we also can't land this now with Interop 2024 almost wrapping up...</p>\n<p>With regards to that flag: I think Firefox and Safari are correct, but I also don't understand why it was introduced. I think it would be better if that flag was not there at all. But I guess while it is, we might as well explicitly set it to false and continue to complain to UTS46 authors on the side... (However, updating the URL standard to set it to false would require dealing with the tests situation I suspect or perhaps we could argue that part is covered by existing tests?)</p>\n","m.mentions":{"user_ids":["@hsivonen:mozilla.org"]},"msgtype":"m.text"},"ts":1732783528492,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$468ghQYjuBuUB-eZ-z3_Pb0f9MqYsB_eNLEneIvOXuU"},
{"content":{"body":"> <@annevk:matrix.org> hsivonen: have you been able to verify \"recent\" UTS46 changes with regards to whether they are a net good? There's https://github.com/web-platform-tests/wpt/pull/48301 and the general Unicode 16.0 issue against URL. I probably need to look into it to see whether all the changes and now failing tests make sense. But we also can't land this now with Interop 2024 almost wrapping up...\n> \n> With regards to that flag: I think Firefox and Safari are correct, but I also don't understand why it was introduced. I think it would be better if that flag was not there at all. But I guess while it is, we might as well explicitly set it to false and continue to complain to UTS46 authors on the side... (However, updating the URL standard to set it to false would require dealing with the tests situation I suspect or perhaps we could argue that part is covered by existing tests?)\n\nI believe the recent changes are good, except IgnoreInvalidPunycode seems unnecessary and I don't understand why it got introduced.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$468ghQYjuBuUB-eZ-z3_Pb0f9MqYsB_eNLEneIvOXuU?via=matrix.org&via=mozilla.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@annevk:matrix.org\">@annevk:matrix.org</a><br><p><a href=\"https://matrix.to/#/@hsivonen:mozilla.org\">hsivonen</a>: have you been able to verify \"recent\" UTS46 changes with regards to whether they are a net good? There's https://github.com/web-platform-tests/wpt/pull/48301 and the general Unicode 16.0 issue against URL. I probably need to look into it to see whether all the changes and now failing tests make sense. But we also can't land this now with Interop 2024 almost wrapping up...</p>\n<p>With regards to that flag: I think Firefox and Safari are correct, but I also don't understand why it was introduced. I think it would be better if that flag was not there at all. But I guess while it is, we might as well explicitly set it to false and continue to complain to UTS46 authors on the side... (However, updating the URL standard to set it to false would require dealing with the tests situation I suspect or perhaps we could argue that part is covered by existing tests?)</p>\n</blockquote></mx-reply>I believe the recent changes are good, except IgnoreInvalidPunycode seems unnecessary and I don't understand why it got introduced.","m.mentions":{"user_ids":["@annevk:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$468ghQYjuBuUB-eZ-z3_Pb0f9MqYsB_eNLEneIvOXuU"}},"msgtype":"m.text"},"ts":1732783608948,"senderName":"hsivonen","senderId":"@hsivonen:mozilla.org","id":"$86Mu8hK47CLcuJ-IOHxDSqD9aT71VJudarND1N3dtUQ"},
{"content":{"body":"That is nothing new? You need to check whether you actually got a Content-Type header.","m.mentions":{},"m.relates_to":{"event_id":"$nD0CUrLex2ghMnLSvG8eR2al1KXZ1KJrFv2USqNklZU","is_falling_back":true,"m.in_reply_to":{"event_id":"$VjcEhGTCknrBwrjNPrMGpA3v49SQ31gGNlEQV2kc-I8"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1732783641025,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$Zz_7C7ni-bDwzyG4NqfPHdwQZt7OjIH8EFspWhjYSKA"},
{"content":{"body":"Firefox implements Unicode 16.0 with IgnoreInvalidPunycode=false on the algorithm level but uses Unicode 15.1 data.","m.mentions":{},"msgtype":"m.text"},"ts":1732783757976,"senderName":"hsivonen","senderId":"@hsivonen:mozilla.org","id":"$YqQtT6PLzgoIOxu8yrI3YbuYbScksxFrDKuY_ZXoomY"},
{"content":{"body":"(Unicode 16.0 data is blocked on ICU4X 2.0, i.e. Real Soon Now.)","m.mentions":{},"msgtype":"m.text"},"ts":1732783781560,"senderName":"hsivonen","senderId":"@hsivonen:mozilla.org","id":"$wJzuV80_PPUUW5bA3z3ZSfo024gEekmb7XsWH6ckxJ4"},
{"content":{"body":"That's good to hear. So maybe we can just swap this in when the Interop 2024 frenzy is over early February (I suspect) and call it a day.","m.mentions":{},"msgtype":"m.text"},"ts":1732783787816,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$giUlkRJwBIasOruheVZvUV2d6GZpAoIWD-BaTB6f6nQ"},
{"content":{"body":"The CVEs they are quoting are not an indication that this is something to be fixed but rather something that sites need to watch out for?","m.mentions":{},"m.relates_to":{"event_id":"$nD0CUrLex2ghMnLSvG8eR2al1KXZ1KJrFv2USqNklZU","is_falling_back":true,"m.in_reply_to":{"event_id":"$Zz_7C7ni-bDwzyG4NqfPHdwQZt7OjIH8EFspWhjYSKA"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1732783985985,"senderName":"freddy","senderId":"@fbraun:mozilla.org","id":"$_lqGf7PwNtbGT5d91TEZ4gp290A_52HyPDN9_JA5kVE"},
{"content":{"body":"The custom element specification has [this wording](https://html.spec.whatwg.org/#custom-element-conformance):\n\n> The element's attributes and children must not be inspected, **as in the non-upgrade case none will be present**, and relying on upgrades makes the element less usable.\n\nWhat is meant by \"non-upgrade case\"? Can someone explain the sense of written?","format":"org.matrix.custom.html","formatted_body":"<p>The custom element specification has <a href=\"https://html.spec.whatwg.org/#custom-element-conformance\">this wording</a>:</p>\n<blockquote>\n<p>The element's attributes and children must not be inspected, <strong>as in the non-upgrade case none will be present</strong>, and relying on upgrades makes the element less usable.</p>\n</blockquote>\n<p>What is meant by \"non-upgrade case\"? Can someone explain the sense of written?</p>\n","m.mentions":{},"msgtype":"m.text"},"ts":1732786695523,"senderName":"Maxim Vaarwel","senderId":"@dmaxim:matrix.org","id":"$RaomqUb1A0_mghNJ2fmdUwm-iRLQCcWTl_6XKBFdGpY"},
{"content":{"body":"Maxim Vaarwel: if you construct a custom element directly it's not upgraded","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@dmaxim:matrix.org\">Maxim Vaarwel</a>: if you construct a custom element directly it's not upgraded","m.mentions":{"user_ids":["@dmaxim:matrix.org"]},"msgtype":"m.text"},"ts":1732786835960,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$d0t1XU9lygpHL3nJJBND1kZdrLsfax7L2JeSCZKkGt0"},
{"content":{"body":"I think he is asking what upgrading is.","m.mentions":{},"msgtype":"m.text"},"ts":1732786972621,"senderName":"Simon☀️","senderId":"@simon_f:mozilla.org","id":"$5GNmzI6AUlc9pNAtX8CKyZzsk34hZx6BOswr5TudnbQ"},
{"content":{"body":"I'm not competent here but https://html.spec.whatwg.org/#custom-elements-upgrades-examples sounds like it is used for progessive enhancements. The definition of the process is here https://html.spec.whatwg.org/#upgrades ","m.mentions":{},"msgtype":"m.text"},"ts":1732787007576,"senderName":"Simon☀️","senderId":"@simon_f:mozilla.org","id":"$S-xdnjJS5MHmWJljZnRfy5rV-6VLFDKkiEUsgKi4Od0"},
{"content":{"body":"@annevk What do you mean by directly? And does customElements.define exist there?","m.mentions":{},"m.relates_to":{"event_id":"$d0t1XU9lygpHL3nJJBND1kZdrLsfax7L2JeSCZKkGt0","is_falling_back":true,"m.in_reply_to":{"event_id":"$d0t1XU9lygpHL3nJJBND1kZdrLsfax7L2JeSCZKkGt0"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1732787906613,"senderName":"Maxim Vaarwel","senderId":"@dmaxim:matrix.org","id":"$MkKk5C6GLYJBOEQ4bg3oqXpHsm1KR6Wj28RenRfN1eU"}
]