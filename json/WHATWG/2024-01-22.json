[
{"content":{"body":"Domenic: I was looking at https://github.com/web-platform-tests/wpt/pull/21041 again and I think they match implementations, but not the spec. The spec grabs the document when calling parseFromString(). But implementations (and the tests) assume it's grabbed as part of the DOMParser invocation.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@domenicdenicola:matrix.org\">Domenic</a>: I was looking at https://github.com/web-platform-tests/wpt/pull/21041 again and I think they match implementations, but not the spec. The spec grabs the document when calling parseFromString(). But implementations (and the tests) assume it's grabbed as part of the DOMParser invocation.","m.mentions":{"user_ids":["@domenicdenicola:matrix.org"]},"msgtype":"m.text"},"ts":1705908655059,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$KP0JQYdMJnc-fKVD6Oobl7rXWbH8vdH5MQsgJsln2OM"},
{"content":{"body":"Domenic: I prototype'd the spec in https://github.com/WebKit/WebKit/pull/22971 and got a number of test failures.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@domenicdenicola:matrix.org\">Domenic</a>: I prototype'd the spec in https://github.com/WebKit/WebKit/pull/22971 and got a number of test failures.","m.mentions":{"user_ids":["@domenicdenicola:matrix.org"]},"msgtype":"m.text"},"ts":1705908699680,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$I4oa3T_gignZo6LT7LYevNlVxIOyMq0aqwBKGGIJOog"},
{"content":{"body":"There's also some differences across implementations from code inspection. Only Gecko seems to carry over the base URL. And Gecko caches the URL when DOMParser is constructed. So pushState() doesn't impact it. (This fails some tests, though a design like that might be simpler in certain ways.)","m.mentions":{},"msgtype":"m.text"},"ts":1705908797835,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$2lUY9wtt_Nw4cD6jtlxDzBO3xTgfBOESeSml8m0rMFo"},
{"content":{"body":"Hmm, good catch. Strange that I added tests specifically for this sort of multi-global madness but didn't match the spec when doing so.","m.mentions":{},"msgtype":"m.text"},"ts":1705908844292,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$3Cnb6WW2qjmod-9TDKhyBOdD_Wvr3pghnmCK9CUGL2o"},
{"content":{"body":"> <@annevk:matrix.org> Domenic: I was looking at https://github.com/web-platform-tests/wpt/pull/21041 again and I think they match implementations, but not the spec. The spec grabs the document when calling parseFromString(). But implementations (and the tests) assume it's grabbed as part of the DOMParser invocation.\n\nWait, no, I think the tests match the spec. \"this's relevant global object's associated Document\" is equivalent to the global at the time `new DOMParser()` was called; `new DOMParser()` creates `this`.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$KP0JQYdMJnc-fKVD6Oobl7rXWbH8vdH5MQsgJsln2OM?via=matrix.org&via=mozilla.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@annevk:matrix.org\">@annevk:matrix.org</a><br><a href=\"https://matrix.to/#/@domenicdenicola:matrix.org\">Domenic</a>: I was looking at https://github.com/web-platform-tests/wpt/pull/21041 again and I think they match implementations, but not the spec. The spec grabs the document when calling parseFromString(). But implementations (and the tests) assume it's grabbed as part of the DOMParser invocation.</blockquote></mx-reply>Wait, no, I think the tests match the spec. \"this's relevant global object's associated Document\" is equivalent to the global at the time <code>new DOMParser()</code> was called; <code>new DOMParser()</code> creates <code>this</code>.","m.mentions":{"user_ids":["@annevk:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$KP0JQYdMJnc-fKVD6Oobl7rXWbH8vdH5MQsgJsln2OM"}},"msgtype":"m.text"},"ts":1705909468933,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$vkVnxsaJqKp-oGdnRAJ2ziHkhLVVH-bofLndK7dArJY"},
{"content":{"body":"Your patch prototypes using the current global object's associated Document, which is not what the spec says.","m.mentions":{},"msgtype":"m.text"},"ts":1705909486084,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$Wfsy5PZZ9FHziHhMgwFc_95wxVjWp6PKFgbUbfRDeH4"},
{"content":{"body":"Domenic: interesting, thanks! So whenever we use relevant I guess we implicitly require the implementation to store a reference in the constructor. I guess that makes sense.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@domenicdenicola:matrix.org\">Domenic</a>: interesting, thanks! So whenever we use relevant I guess we implicitly require the implementation to store a reference in the constructor. I guess that makes sense.","m.mentions":{"user_ids":["@domenicdenicola:matrix.org"]},"msgtype":"m.text"},"ts":1705909764454,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$1_T-miXWBemk5IPy1VScs67_SwIklHtMhd2b4vqKAY0"},
{"content":{"body":"Yeah, I kind of thought all implementations already did that? Web IDL certainly assumes it.","m.mentions":{},"msgtype":"m.text"},"ts":1705909972271,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$JSRz60T9fcHqc0OqbDnY_jGUQuqOJ121auz0IL1ghXA"},
{"content":{"body":"At least a reference to the global, from which you can get the document","m.mentions":{},"msgtype":"m.text"},"ts":1705909982741,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$V0TFrZmZKLneDxZzdRk-tB05477aZXJf_y6ZfPmWQek"},
{"content":{"body":"Domenic: It looks to be manual in all three implementations. Chromium and WebKit even use a WeakPtr which worries me a little bit, but it's hard to force GC in tests so not sure if my concerns are well-founded.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@domenicdenicola:matrix.org\">Domenic</a>: It looks to be manual in all three implementations. Chromium and WebKit even use a WeakPtr which worries me a little bit, but it's hard to force GC in tests so not sure if my concerns are well-founded.","m.mentions":{"user_ids":["@domenicdenicola:matrix.org"]},"msgtype":"m.text"},"ts":1705910054732,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$ci1BAwgucprZQXTrZ-wEQ3OTTVRPp3rDEw_Q6jgc5CQ"},
{"content":{"body":"Hmm yeah, in Chromium there's a variety of easy utility classes and templates you can inherit from I guess, but that makes sense.","m.mentions":{},"msgtype":"m.text"},"ts":1705910132053,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$AnQm9rAnfiUYcn3HeVMeOHOQEv6DXn5_uInl5c-O4J4"},
{"content":{"body":"Or maybe there's just some leftover code in DOMParser that's redundant with more recent IDL developments?","m.mentions":{},"msgtype":"m.text"},"ts":1705910148806,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$rvO12pbLs80gdOqo3dAmXSoYdc1XmQPZLbZbie237qM"},
{"content":{"body":"I see that https://github.com/WICG/identity-credential/blob/main/digital-credentials-2-proposal.md (frontend web-platform API for “Digital Credentials”) seems to have gotten some implementor interest.\n\nI don’t really know much of anything about credentials/identity stuff, except some incidental awareness of the W3C Verifiable Credentials and Decentralized Identifiers (DID) stuff — and only then, because the groups working on those things are at the W3C.\n\nSo is the implementor interest in WICG Digital Credentials also an indicator that implementors now see W3C Verifiable Credentials (and maybe DID also) as something actually possibly relevant for the web platform?\n\nI’ve gleaned that W3C Verifiable Credentials are just one possible data format for Verifiable Credentials — and the WICG Digital Credentials draft cites a protocol spec at https://openid.net/specs/openid-4-verifiable-presentations-1_0.html which mentions W3C VC but also an “ISO mdoc” data format that seems to be for basically the same thing.\n\nAnyway, I’m basically just wondering whether there’s now actually enough browser-implementor interest in this stuff — in integrating it into the web platform through frontend APIs — that I should actually start paying attention to any of it.","m.mentions":{},"msgtype":"m.text"},"ts":1705920421851,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$hUazK0YhYjWCTlVX6wA0BVNfhy7I9KkglTcpTcsxuQc"},
{"content":{"body":"How come https://url.spec.whatwg.org/ isn't WHATWG green?","m.mentions":{},"msgtype":"m.text"},"ts":1705932172725,"senderName":"hsivonen","senderId":"@hsivonen:mozilla.org","id":"$oMtqcQySjXX-WCLwJQyxKGEa3UB3ipKw4YqihVQF24o"},
{"content":{"body":"Refresh? There was a CI issue earlier","msgtype":"m.text"},"ts":1705932314489,"senderName":"Ms2ger","senderId":"@ms2ger:igalia.com","id":"$uscYPr-410SNgJ45ZCudyAtOwurpzNvLDn1X1r2_qSU"},
{"content":{"body":" * <del>Refresh? There was a CI issue earlier</del>","format":"org.matrix.custom.html","formatted_body":" * <del>Refresh? There was a CI issue earlier</del>","m.new_content":{"body":"<del>Refresh? There was a CI issue earlier</del>","format":"org.matrix.custom.html","formatted_body":"<del>Refresh? There was a CI issue earlier</del>","msgtype":"m.text"},"m.relates_to":{"event_id":"$uscYPr-410SNgJ45ZCudyAtOwurpzNvLDn1X1r2_qSU","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1705932334507,"senderName":"Ms2ger","senderId":"@ms2ger:igalia.com","id":"$Ql4nkFTNy1EOB-EE3jM8zyZR-j6cwPtbEREbYtXECM4"},
{"content":{"body":"> <@ms2ger:igalia.com> <del>Refresh? There was a CI issue earlier</del>\n\nDoesn't help. I guess there's a sticky cache somewhere.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$uscYPr-410SNgJ45ZCudyAtOwurpzNvLDn1X1r2_qSU?via=matrix.org&via=mozilla.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@ms2ger:igalia.com\">@ms2ger:igalia.com</a><br><del>Refresh? There was a CI issue earlier</del></blockquote></mx-reply>Doesn't help. I guess there's a sticky cache somewhere.","m.mentions":{"user_ids":["@ms2ger:igalia.com"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$uscYPr-410SNgJ45ZCudyAtOwurpzNvLDn1X1r2_qSU"}},"msgtype":"m.text"},"ts":1705932343801,"senderName":"hsivonen","senderId":"@hsivonen:mozilla.org","id":"$LEzxmSqotpBdMEgXV1rdBI-Wt-ipz4TdDdOBSrWEA1Q"},
{"content":{"body":"I was seeing green from my own cache. Probably the build step needs to run again","msgtype":"m.text"},"ts":1705932359483,"senderName":"Ms2ger","senderId":"@ms2ger:igalia.com","id":"$t_N4Wi5ZVYRNBmy_cltAdtkcE3wFT2XtoCOBhrLxEvY"},
{"content":{"body":"cc annevk ","format":"org.matrix.custom.html","formatted_body":"cc <a href=\"https://matrix.to/#/@annevk:matrix.org\">annevk</a>","msgtype":"m.text"},"ts":1705932471555,"senderName":"Ms2ger","senderId":"@ms2ger:igalia.com","id":"$vskUNaXLkNLpL1k9XkDdRVZuuR11JF4ROy17CZtrYNc"}
]