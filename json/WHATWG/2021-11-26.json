[
{"content":{"body":"I think that is editorial. It doesn't change how the standard is understood.","msgtype":"m.text"},"ts":1637913004143,"senderName":"annevk","senderId":"@annevk:mozilla.org","id":"$wZYzuFTeZfoWONh8MRpwWkgW34whPIvRuF4EpI1KXWQ"},
{"content":{"body":"https://github.com/whatwg/meta/blob/main/COMMITTING.md#title-prefixes has advice, though I'll admit that every now and then Domenic will correct me. It still doesn't come natural to me.","format":"org.matrix.custom.html","formatted_body":"https://github.com/whatwg/meta/blob/main/COMMITTING.md#title-prefixes has advice, though I'll admit that every now and then <a href=\"https://matrix.to/#/@domenicdenicola:matrix.org\">Domenic</a> will correct me. It still doesn't come natural to me.","msgtype":"m.text"},"ts":1637913072859,"senderName":"annevk","senderId":"@annevk:mozilla.org","id":"$vDKpFXMU5pSCgLtjR0FKFMBOwd5mb0m2MEC1ddvIbLA"},
{"content":{"body":"Hello everybody here, You can consider me as someone accidently land out into this room. But I am really exciting to be here. and will really appreciate that if anyone here explain me a bit on its science ?","msgtype":"m.text"},"ts":1637914765966,"senderName":"The Finder","senderId":"@mehboob_101:matrix.org","id":"$anXKfqxgnZ2vqlmPZeShSIgOFz_mxsTMlK3l_CCelRA"},
{"content":{"body":"Domenic: Filed https://bugs.webkit.org/show_bug.cgi?id=233514 & https://bugzilla.mozilla.org/show_bug.cgi?id=1743082 for WebKit & Gecko","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@domenicdenicola:matrix.org\">Domenic</a>: Filed https://bugs.webkit.org/show_bug.cgi?id=233514 &amp; https://bugzilla.mozilla.org/show_bug.cgi?id=1743082 for WebKit &amp; Gecko","msgtype":"m.text"},"ts":1637916938866,"senderName":"ntim","senderId":"@ntim:mozilla.org","id":"$mePwqs1II3t4YW5g8RpUZzdCPPBjUqtjjriyj3-SI0k"},
{"content":{"body":"(also i'm doing the work for WebKit)","msgtype":"m.text"},"ts":1637916953538,"senderName":"ntim","senderId":"@ntim:mozilla.org","id":"$zAE_1nsTJ2BqEe3G5SRylgxVFUCBhPAlSM5EaJnhmso"},
{"content":{"body":"emilio: sefeng ^","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@emilio:mozilla.org\">emilio</a>: <a href=\"https://matrix.to/#/@sefeng:mozilla.org\">sefeng</a> ^","msgtype":"m.text"},"ts":1637916984569,"senderName":"ntim","senderId":"@ntim:mozilla.org","id":"$ISXjQbEFq5gHkQtT6ISQcGP_MKfE89Cq-lwrWLoBpo4"},
{"content":{"body":"So I'm trying to work out how to talk about sandboxes / isolated worlds for WebDriver BiDi (Extensions will need something similar for content scripts). I kind of just want to sketch in the basics of how it works at the moment, but it would be good to start with a model that isn't total nonsense. \n\nSo I'm leaning towards a model where the behaviour is explained as \"in a sandbox, objects are accessed through a transparent wrapper object. When getting a property, if the property is defined on the wrapper, return that. Otherwise check if the property is defined on the wrapped object and, if it is, and the wrapped object is a platform object, and the property is part of the interface definition for the wrapped object, or is an internal slot, return the wrapped property value if it's an object, or the primitive value if it's not. When setting a property, check if the wrapped object is a platform object, and the property is part of the interface for that platform object, then act as if setting the property on the wrapped object. Otherwise set the property on the wrapper.\"\n\nDoes that make any sense whatsoever as a model or is it going to run into insurmountable difficulties (I think it's similar to the actual Gecko implementation, but I'm not an expert)? If it does make sense, how to fit it into the formalism? I don't mind the wrapper objects being \"magical\", but does it make sense to claim that the sandbox itself is a realm and the wrapped objects are part of a different realm? That kind of makes sense at a high level, and matches how we want to expose it in the BiDi protocol but is it going cause problems with some invariants at the spec level?","msgtype":"m.text"},"ts":1637943796245,"senderName":"jgraham","senderId":"@jgraham_:matrix.org","id":"$-7f5-4tXNUiBS_escmMxwUZAmM3lj74pWXGvQjt57ak"},
{"content":{"body":"I kind of realise that this stuff doesn't match the theoretical model of ECMAScript etc. so there is probably going to be some amount of doing things that aren't intended (and maybe people won't like it), but it would be good to avoid unnecessary friction.","msgtype":"m.text"},"ts":1637944005447,"senderName":"jgraham","senderId":"@jgraham_:matrix.org","id":"$dHTdjUyFb8UMPfaQ18W6cfXijW1Ua2K0a1IsnlY9Vik"},
{"content":{"body":"I've been reading the Webstreams spec and working on porting some code running in Node to use webstreams. I came across two obstacles that I think are built into the current design. Would value hearing from others who know more about or have more experience working with this spec. Is this a good place to ask? Would it be ok/better to raise issue on whatwg/streams?","msgtype":"m.text"},"ts":1637944396621,"senderName":"Jim Pryor","senderId":"@dubiousjim:matrix.org","id":"$-NkJ-KJjm8DZ1MMhHrbLAzf7U5LQWNQkW1gLoFYQHMM"},
{"content":{"body":"1. In a Readable/WritableStream's `start()` implementation (also in `read()` or `write()`) I sometimes want to gracefully cancel or abort the stream. For example, if a WritableStream is passed data of a type it doesn't handle, but I want the stream implementation to do some post-processing on the data it already received. One can't use the client-facing `cancel` or `abort` methods on the streams at these points, because the stream is typically locked. You can call `controller.error`, but (at least in Node 17.1.0's implementation and in the current web-streams-polyfill), this throws an error outside the scope of the stream implementation (so it can't be observed/caught by the implementation's `cancel` or `abort` routines). I'd be interested to hear whether this design is deliberate and what kinds of worksarounds I might consider.\n","format":"org.matrix.custom.html","formatted_body":"<ol>\n<li>In a Readable/WritableStream's <code>start()</code> implementation (also in <code>read()</code> or <code>write()</code>) I sometimes want to gracefully cancel or abort the stream. For example, if a WritableStream is passed data of a type it doesn't handle, but I want the stream implementation to do some post-processing on the data it already received. One can't use the client-facing <code>cancel</code> or <code>abort</code> methods on the streams at these points, because the stream is typically locked. You can call <code>controller.error</code>, but (at least in Node 17.1.0's implementation and in the current web-streams-polyfill), this throws an error outside the scope of the stream implementation (so it can't be observed/caught by the implementation's <code>cancel</code> or <code>abort</code> routines). I'd be interested to hear whether this design is deliberate and what kinds of worksarounds I might consider.</li>\n</ol>\n","msgtype":"m.text"},"ts":1637944405157,"senderName":"Jim Pryor","senderId":"@dubiousjim:matrix.org","id":"$Gh3p0K6-tY127GG36_178FOR6hRGbDMHgZxYuimldEI"},
{"content":{"body":"2. There doesn't seem to be any way to observe errors/aborts/cancelations in an existing stream (that my code did not implement itself). Some Node code I'm trying to port calls `webstream.on('error', err => ...)` but I don't see any way to do something similar with webstreams. I considered having my code implement a TransformStream and piping the externally-provided ReadableStream through that. But I don't see any way to make the TransformStream observe errors in another stream piping into it.\n","format":"org.matrix.custom.html","formatted_body":"<ol start=\"2\">\n<li>There doesn't seem to be any way to observe errors/aborts/cancelations in an existing stream (that my code did not implement itself). Some Node code I'm trying to port calls <code>webstream.on('error', err =&gt; ...)</code> but I don't see any way to do something similar with webstreams. I considered having my code implement a TransformStream and piping the externally-provided ReadableStream through that. But I don't see any way to make the TransformStream observe errors in another stream piping into it.</li>\n</ol>\n","msgtype":"m.text"},"ts":1637944411347,"senderName":"Jim Pryor","senderId":"@dubiousjim:matrix.org","id":"$vStRfkEyVEQH1L8NXgIPLaKEd6l012m64e1ekRes2Ds"},
{"content":{"body":"jgraham: at a high-level it sounds reasonable; \"Proxy object\" is the TC39 verbiage. You could look at WindowProxy for some inspiration. Defining that in detail seems quite involved though.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@jgraham_:matrix.org\">jgraham</a>: at a high-level it sounds reasonable; &quot;Proxy object&quot; is the TC39 verbiage. You could look at WindowProxy for some inspiration. Defining that in detail seems quite involved though.","msgtype":"m.text"},"ts":1637944630093,"senderName":"annevk","senderId":"@annevk:mozilla.org","id":"$8yrlxp0KjPvg-EX8Xy8ssOmXPv4h7MDnph2fiBr44-w"},
{"content":{"body":"Domenic: emilio sefeng , I wrote https://github.com/web-platform-tests/wpt/pull/31758 which formalizes the behavior implemented in Chrome/Firefox (though it fails in WebKit), although I'm not sure this is specified anywhere","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@domenicdenicola:matrix.org\">Domenic</a>: <a href=\"https://matrix.to/#/@emilio:mozilla.org\">emilio</a> <a href=\"https://matrix.to/#/@sefeng:mozilla.org\">sefeng</a> , I wrote https://github.com/web-platform-tests/wpt/pull/31758 which formalizes the behavior implemented in Chrome/Firefox (though it fails in WebKit), although I'm not sure this is specified anywhere","msgtype":"m.text"},"ts":1637944643847,"senderName":"ntim","senderId":"@ntim:mozilla.org","id":"$FTPEJC6yZ6Mx3EwLHJ2qFb9Wj372o-sMcxR3kNPMnx0"},
{"content":{"body":"Should ::backdrop receive events from the associated  element ?","msgtype":"m.text"},"ts":1637944748569,"senderName":"ntim","senderId":"@ntim:mozilla.org","id":"$xASlRpNtrPavg07dYDbiBmyNZxI36a5UrXEJxsia49E"},
{"content":{"body":"> <@dubiousjim:matrix.org> 2. There doesn't seem to be any way to observe errors/aborts/cancelations in an existing stream (that my code did not implement itself). Some Node code I'm trying to port calls `webstream.on('error', err => ...)` but I don't see any way to do something similar with webstreams. I considered having my code implement a TransformStream and piping the externally-provided ReadableStream through that. But I don't see any way to make the TransformStream observe errors in another stream piping into it.\n\nWhoops, I mean, it calls `nodestream.on('error', err => ...)`","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$vStRfkEyVEQH1L8NXgIPLaKEd6l012m64e1ekRes2Ds?via=mozilla.org&via=matrix.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@dubiousjim:matrix.org\">@dubiousjim:matrix.org</a><br><ol start=\"2\">\n<li>There doesn't seem to be any way to observe errors/aborts/cancelations in an existing stream (that my code did not implement itself). Some Node code I'm trying to port calls <code>webstream.on('error', err =&gt; ...)</code> but I don't see any way to do something similar with webstreams. I considered having my code implement a TransformStream and piping the externally-provided ReadableStream through that. But I don't see any way to make the TransformStream observe errors in another stream piping into it.</li>\n</ol>\n</blockquote></mx-reply>Whoops, I mean, it calls <code>nodestream.on('error', err =&gt; ...)</code>","m.relates_to":{"m.in_reply_to":{"event_id":"$vStRfkEyVEQH1L8NXgIPLaKEd6l012m64e1ekRes2Ds"}},"msgtype":"m.text"},"ts":1637944779063,"senderName":"Jim Pryor","senderId":"@dubiousjim:matrix.org","id":"$1VZ_PPJCWtcNnIiMafegmBm1BI9_sWvJvrcOom7OMXM"},
{"content":{"body":"Jim Pryor: I think stream.closed ends up rejecting","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@dubiousjim:matrix.org\">Jim Pryor</a>: I think stream.closed ends up rejecting","msgtype":"m.text"},"ts":1637944888266,"senderName":"annevk","senderId":"@annevk:mozilla.org","id":"$KNdNc6uoFcrWzfQe1epAshyY1q83Ipu72-PxSCTOfsI"},
{"content":{"body":"Someone else prolly knows better though","msgtype":"m.text"},"ts":1637944905722,"senderName":"annevk","senderId":"@annevk:mozilla.org","id":"$gdq_Q0s-rhqLtzBrUij6VB6CRmgqkU35ltrL7vsyMQ4"},
{"content":{"body":"annevk: Yeah, I have been looking at WindowProxy, that's pretty much how I ended up with \"oh if we just override all the internal methods…\" :)","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@annevk:mozilla.org\">annevk</a>: Yeah, I have been looking at WindowProxy, that's pretty much how I ended up with &quot;oh if we just override all the internal methods…&quot; :)","msgtype":"m.text"},"ts":1637944981457,"senderName":"jgraham","senderId":"@jgraham_:matrix.org","id":"$15uoFYXr-IcWNVeE_R3y-OgkLoROaErsCoLErDixPu8"},
{"content":{"body":"> <@dubiousjim:matrix.org> Whoops, I mean, it calls `nodestream.on('error', err => ...)`\n\nYou can use `reader.closed.catch(err => { ... })` for that.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$1VZ_PPJCWtcNnIiMafegmBm1BI9_sWvJvrcOom7OMXM?via=matrix.org&via=mozilla.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@dubiousjim:matrix.org\">@dubiousjim:matrix.org</a><br />Whoops, I mean, it calls <code>nodestream.on('error', err =&gt; ...)</code></blockquote></mx-reply>You can use `reader.closed.catch(err => { ... })` for that.","m.relates_to":{"m.in_reply_to":{"event_id":"$1VZ_PPJCWtcNnIiMafegmBm1BI9_sWvJvrcOom7OMXM"}},"msgtype":"m.text"},"ts":1637944982631,"senderName":"Mattias Buelens","senderId":"@mattiasbuelens:matrix.org","id":"$lt-JDiTnK8ADCHjpJJM_APngBQ-s_YMYy0btfGvwNvQ"},
{"content":{"body":"And yes I agree it's quite a lot of work, this is why the aim in the short term is to have something that sketches out the requirements, because in reality browsers already have an implementation of this stuff and they aren't going to change the existing implementation to match the spec anyway","msgtype":"m.text"},"ts":1637945056712,"senderName":"jgraham","senderId":"@jgraham_:matrix.org","id":"$n7QwHTZrxVBYnTVNFPeLcIOEW1IzjJ4aO1R1D6b9ysY"},
{"content":{"body":"jgraham: \"just\" is doing a lot in that sentence","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@jgraham_:matrix.org\">jgraham</a>: &quot;just&quot; is doing a lot in that sentence","msgtype":"m.text"},"ts":1637945061414,"senderName":"annevk","senderId":"@annevk:mozilla.org","id":"$drISua0MAtYrerzwyQUjDpEaUHoOPylNrUnnoppHE8s"},
{"content":{"body":"Fair :)","msgtype":"m.text"},"ts":1637945099932,"senderName":"jgraham","senderId":"@jgraham_:matrix.org","id":"$1MYhnHuTolH7N0c7vkhSuZ4lFK6hOt1QHSoQIYGGLJE"},
{"content":{"body":"jgraham: I wonder if implementations are truly creating proxy objects or if they are creating separate JS objects that point to the same backing IDL object","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@jgraham_:matrix.org\">jgraham</a>: I wonder if implementations are truly creating proxy objects or if they are creating separate JS objects that point to the same backing IDL object","msgtype":"m.text"},"ts":1637945303518,"senderName":"annevk","senderId":"@annevk:mozilla.org","id":"$dJIWp9OmyQULOdmoKicmlgCb_QSX1GeSuenG9xK2PQU"},
{"content":{"body":"jgraham: the former seems kinda painful for perf, especially if you'd also have to do it for website scripts (not sure how you'd avoid expandos leaking to extensions otherwise)","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@jgraham_:matrix.org\">jgraham</a>: the former seems kinda painful for perf, especially if you'd also have to do it for website scripts (not sure how you'd avoid expandos leaking to extensions otherwise)","msgtype":"m.text"},"ts":1637945398241,"senderName":"annevk","senderId":"@annevk:mozilla.org","id":"$4NwWs8OoIuCuTsMApL3dUJe7tLstHdDrQ17zcWd3OIk"},
{"content":{"body":"annevk: I think Gecko and Blink are different here (I assume WebKit matches Blink). Blink basically creates a new JS reflector for each underlying C++ object. But Gecko I think is closer to having a proxy object as described (and a practial implication is that in Gecko you can get to the original JS reflector using `.wrappedJSObject` fram a sandbox)","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@annevk:mozilla.org\">annevk</a>: I think Gecko and Blink are different here (I assume WebKit matches Blink). Blink basically creates a new JS reflector for each underlying C++ object. But Gecko I think is closer to having a proxy object as described (and a practial implication is that in Gecko you can get to the original JS reflector using <code>.wrappedJSObject</code> fram a sandbox)","msgtype":"m.text"},"ts":1637945542161,"senderName":"jgraham","senderId":"@jgraham_:matrix.org","id":"$H4pgPybRjBLSCJLwEzHJZkQWaqfKHmZO2wvJxNa932k"},
{"content":{"body":"> <@dubiousjim:matrix.org> 1. In a Readable/WritableStream's `start()` implementation (also in `read()` or `write()`) I sometimes want to gracefully cancel or abort the stream. For example, if a WritableStream is passed data of a type it doesn't handle, but I want the stream implementation to do some post-processing on the data it already received. One can't use the client-facing `cancel` or `abort` methods on the streams at these points, because the stream is typically locked. You can call `controller.error`, but (at least in Node 17.1.0's implementation and in the current web-streams-polyfill), this throws an error outside the scope of the stream implementation (so it can't be observed/caught by the implementation's `cancel` or `abort` routines). I'd be interested to hear whether this design is deliberate and what kinds of worksarounds I might consider.\n> \n\nHmm, controller.error() does indeed clear the queue, it's supposed to be for an \"immediate\" fatal error. You could do controller.close() for a ReadableStream, but then you can't signal an error. 🤔","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$Gh3p0K6-tY127GG36_178FOR6hRGbDMHgZxYuimldEI?via=matrix.org&via=mozilla.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@dubiousjim:matrix.org\">@dubiousjim:matrix.org</a><br /><ol>\n<li>In a Readable/WritableStream's <code>start()</code> implementation (also in <code>read()</code> or <code>write()</code>) I sometimes want to gracefully cancel or abort the stream. For example, if a WritableStream is passed data of a type it doesn't handle, but I want the stream implementation to do some post-processing on the data it already received. One can't use the client-facing <code>cancel</code> or <code>abort</code> methods on the streams at these points, because the stream is typically locked. You can call <code>controller.error</code>, but (at least in Node 17.1.0's implementation and in the current web-streams-polyfill), this throws an error outside the scope of the stream implementation (so it can't be observed/caught by the implementation's <code>cancel</code> or <code>abort</code> routines). I'd be interested to hear whether this design is deliberate and what kinds of worksarounds I might consider.</li>\n</ol>\n</blockquote></mx-reply>Hmm, controller.error() does indeed clear the queue, it's supposed to be for an \"immediate\" fatal error. You could do controller.close() for a ReadableStream, but then you can't signal an error. 🤔","m.relates_to":{"m.in_reply_to":{"event_id":"$Gh3p0K6-tY127GG36_178FOR6hRGbDMHgZxYuimldEI"}},"msgtype":"m.text"},"ts":1637945557222,"senderName":"Mattias Buelens","senderId":"@mattiasbuelens:matrix.org","id":"$O0hYK-GtV0hKQRK-eliV7uyr65MVZnsNNiWy39uqZZw"},
{"content":{"body":" * annevk: I think Gecko and Blink are different here (I assume WebKit matches Blink). Blink basically creates a new JS reflector for each underlying C++ object. But Gecko I think is closer to having a proxy object as described (and a practial implication is that in Gecko you can get to the original JS reflector using `.wrappedJSObject` fram a sandbox)","format":"org.matrix.custom.html","formatted_body":" * <a href=\"https://matrix.to/#/@annevk:mozilla.org\">annevk</a>: I think Gecko and Blink are different here (I assume WebKit matches Blink). Blink basically creates a new JS reflector for each underlying C++ object. But Gecko I think is closer to having a proxy object as described (and a practial implication is that in Gecko you can get to the original JS reflector using <code>.wrappedJSObject</code> fram a sandbox)","m.new_content":{"body":"annevk: I think Gecko and Blink are different here (I assume WebKit matches Blink). Blink basically creates a new JS reflector for each underlying C++ object. But Gecko I think is closer to having a proxy object as described (and a practial implication is that in Gecko you can get to the original JS reflector using `.wrappedJSObject` fram a sandbox)","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@annevk:mozilla.org\">annevk</a>: I think Gecko and Blink are different here (I assume WebKit matches Blink). Blink basically creates a new JS reflector for each underlying C++ object. But Gecko I think is closer to having a proxy object as described (and a practial implication is that in Gecko you can get to the original JS reflector using <code>.wrappedJSObject</code> fram a sandbox)","msgtype":"m.text"},"m.relates_to":{"event_id":"$H4pgPybRjBLSCJLwEzHJZkQWaqfKHmZO2wvJxNa932k","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1637945557345,"senderName":"jgraham","senderId":"@jgraham_:matrix.org","id":"$NjBC5c3IQrpwAW8XGZIcr7nkLMN6RWFB273sHnWXmcQ"},
{"content":{"body":"jgraham: does that mean you can see expandos in Gecko? I guess one thing that would help me here is to have some examples 🙂","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@jgraham_:matrix.org\">jgraham</a>: does that mean you can see expandos in Gecko? I guess one thing that would help me here is to have some examples 🙂","msgtype":"m.text"},"ts":1637945682089,"senderName":"annevk","senderId":"@annevk:mozilla.org","id":"$Od_5Cf71NOrqQb5LOTLamfRX4K5ZyCOEICSyWEtDI5Y"}
]