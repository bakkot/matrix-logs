[
{"content":{"body":"annevk: ^","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@annevk:matrix.org\">annevk</a>: ^","m.mentions":{"user_ids":["@annevk:matrix.org"]},"msgtype":"m.text"},"ts":1753848624850,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$66AH-BK2C_2SIZlyIC2kXs_ctWW7qHD323ftBU1q5qc"},
{"content":{"body":"jmdyck Domenic: https://github.com/whatwg/html/pull/11504","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@jmdyck:matrix.org\">jmdyck</a> <a href=\"https://matrix.to/#/@domenicdenicola:matrix.org\">Domenic</a>: https://github.com/whatwg/html/pull/11504","m.mentions":{"user_ids":["@jmdyck:matrix.org","@domenicdenicola:matrix.org"]},"msgtype":"m.text"},"ts":1753856217340,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$aSEuAvhSl9-dS0OaGdaONK9JkSVpUaUvstPLfUDab9U"},
{"content":{"body":"Luke Warlow: are you around? I'm planning on pushing a fixup commit to your reflection branch and then land it after you double checked my changes. And thanks for going the extra mile on it!","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@lwarlow:igalia.com\">Luke Warlow</a>: are you around? I'm planning on pushing a fixup commit to your reflection branch and then land it after you double checked my changes. And thanks for going the extra mile on it!","m.mentions":{"user_ids":["@lwarlow:igalia.com"]},"msgtype":"m.text"},"ts":1753876347391,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$dQETLrT8rOPrZ8jke9kREBauq_EqKXQJqeRwrL5wPLs"},
{"content":{"body":"(Mind you, it'll take me a bit of time, but hopefully within 30min or so.)","m.mentions":{},"msgtype":"m.text"},"ts":1753876369852,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$QSjZXsEDcOdnN61g89aVJtzEtY_Cg4xDquyMZkkzVEI"},
{"content":{"body":"Yes I am. Let me know and I'll double check your changes","msgtype":"m.text"},"ts":1753876376019,"senderName":"Luke Warlow","senderId":"@lwarlow:igalia.com","id":"$yd8ymjqfhNMY5cJDvupuz-uiWXStkRLunz4ZYGz7mbE"},
{"content":{"body":"No rush I'll be around for the foreseeable :)","msgtype":"m.text"},"ts":1753876415064,"senderName":"Luke Warlow","senderId":"@lwarlow:igalia.com","id":"$dbYcqwhx2nMhxovtfvIgVGtppgIasR30Q_h1eatTc34"},
{"content":{"body":"Hi! I am currently trying to fix https://github.com/whatwg/html/issues/5117 in Firefox. I have real trouble getting this working, because we would just run out of nodes on the stack. The fragment case always pushes the context element as the first node onto the stack. But that isn't necessarily a html node. Looking at the WebKit parse, I think it has a special case for this: https://searchfox.org/wubkat/source/Source/WebCore/html/parser/HTMLStackItem.h#127-129, which causes this node not be considered. Is this maybe missing from the spec?","m.mentions":{},"msgtype":"m.text"},"ts":1753877325325,"senderName":"evilpie","senderId":"@evilpie:mozilla.org","id":"$ozS2GzvasN5C0AWURHPrY9oCnQVD0hDr-LjSHWJ9khU"},
{"content":{"body":"* Hi! I am currently trying to fix https://github.com/whatwg/html/issues/5117 in Firefox. I have real trouble getting this working, because we would just run out of nodes on the stack. The fragment case always pushes the context element as the first node onto the stack. But that isn't necessarily a html node. Looking at the WebKit parser, I think it has a special case for this: https://searchfox.org/wubkat/source/Source/WebCore/html/parser/HTMLStackItem.h#127-129, which causes this node not be considered. Is this maybe missing from the spec?","m.mentions":{},"m.new_content":{"body":"Hi! I am currently trying to fix https://github.com/whatwg/html/issues/5117 in Firefox. I have real trouble getting this working, because we would just run out of nodes on the stack. The fragment case always pushes the context element as the first node onto the stack. But that isn't necessarily a html node. Looking at the WebKit parser, I think it has a special case for this: https://searchfox.org/wubkat/source/Source/WebCore/html/parser/HTMLStackItem.h#127-129, which causes this node not be considered. Is this maybe missing from the spec?","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$ozS2GzvasN5C0AWURHPrY9oCnQVD0hDr-LjSHWJ9khU","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1753877496244,"senderName":"evilpie","senderId":"@evilpie:mozilla.org","id":"$vUuBa1RBlMAuLIiLNPLG5UrZksuY91gg73PWZkZtdJ0"},
{"content":{"body":"evilpie: at least with HTML fragment parsing there's always an HTML `html` element as root, no?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@evilpie:mozilla.org\">evilpie</a>: at least with HTML fragment parsing there's always an HTML <code>html</code> element as root, no?","m.mentions":{"user_ids":["@evilpie:mozilla.org"]},"msgtype":"m.text"},"ts":1753877609896,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$UpSDekAVALxU643qPHPdvVFZymSQ65K2fHynrd34Km4"},
{"content":{"body":"Luke Warlow: nits pushed.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@lwarlow:igalia.com\">Luke Warlow</a>: nits pushed.","m.mentions":{"user_ids":["@lwarlow:igalia.com"]},"msgtype":"m.text"},"ts":1753877705879,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$u8lvYI4erGjfR1VEOJhirxMaQepgVdyDAqOBn9Nnodc"},
{"content":{"body":"LGTM","m.mentions":{},"msgtype":"m.text"},"ts":1753877809293,"senderName":"Luke Warlow","senderId":"@lwarlow:igalia.com","id":"$HirWiopjjjDcTBgFxw3rGFv_5dY216OKzJL3txmytqs"},
{"content":{"body":"annevk: Ah yes. I believe this problem only occurs if the context node for the fragment parsing is SVG (haven't checked MathML)","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@annevk:matrix.org\">annevk</a>: Ah yes. I believe this problem only occurs if the context node for the fragment parsing is SVG (haven't checked MathML)","m.mentions":{"user_ids":["@annevk:matrix.org"]},"msgtype":"m.text"},"ts":1753877867643,"senderName":"evilpie","senderId":"@evilpie:mozilla.org","id":"$w5XsSKAZBYkFwxQ0U6zOJMGF9T93Qrf7Wq2ixembkag"},
{"content":{"body":"evilpie: but then we would use XML fragment parsing, no?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@evilpie:mozilla.org\">evilpie</a>: but then we would use XML fragment parsing, no?","m.mentions":{"user_ids":["@evilpie:mozilla.org"]},"msgtype":"m.text"},"ts":1753878009090,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$6SalpH72LROZwVjigkt17ujWzvotchYaeRXP6NC0lpw"},
{"content":{"body":"Not for innerHTML","m.mentions":{},"msgtype":"m.text"},"ts":1753878239155,"senderName":"evilpie","senderId":"@evilpie:mozilla.org","id":"$xljKlgVjcdqzb9ngHN-jKgsU11N6byATYtk8ZqDm5TM"},
{"content":{"body":"Concretely I am talking about ```let svg = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\nsvg.innerHTML = `<p></p><foo>`;`` (part of https://wpt.live/html/syntax/parsing/html5lib_innerHTML_foreign-fragment.html)","format":"org.matrix.custom.html","formatted_body":"Concretely I am talking about ```let svg = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");<br>svg.innerHTML = <code>&lt;p&gt;&lt;/p&gt;&lt;foo&gt;</code>;`` (part of https://wpt.live/html/syntax/parsing/html5lib_innerHTML_foreign-fragment.html)","m.mentions":{},"msgtype":"m.text"},"ts":1753878263763,"senderName":"evilpie","senderId":"@evilpie:mozilla.org","id":"$HMTFKG32i7Rk38_E6ywO3hVAuggrqF_4-ne3Xpj7hNY"},
{"content":{"body":"* Concretely I am talking about: \n```\nlet svg = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\nsvg.innerHTML = `<p></p><foo>`;\\`\\` (part of https://wpt.live/html/syntax/parsing/html5lib\\_innerHTML\\_foreign-fragment.html)","format":"org.matrix.custom.html","formatted_body":"* <p>Concretely I am talking about:</p>\n<pre><code>let svg = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\nsvg.innerHTML = `&lt;p&gt;&lt;/p&gt;&lt;foo&gt;`;\\`\\` (part of https://wpt.live/html/syntax/parsing/html5lib\\_innerHTML\\_foreign-fragment.html)\n</code></pre>\n","m.mentions":{},"m.new_content":{"body":"Concretely I am talking about: \n```\nlet svg = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\nsvg.innerHTML = `<p></p><foo>`;\\`\\` (part of https://wpt.live/html/syntax/parsing/html5lib\\_innerHTML\\_foreign-fragment.html)","format":"org.matrix.custom.html","formatted_body":"<p>Concretely I am talking about:</p>\n<pre><code>let svg = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\nsvg.innerHTML = `&lt;p&gt;&lt;/p&gt;&lt;foo&gt;`;\\`\\` (part of https://wpt.live/html/syntax/parsing/html5lib\\_innerHTML\\_foreign-fragment.html)\n</code></pre>\n","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$HMTFKG32i7Rk38_E6ywO3hVAuggrqF_4-ne3Xpj7hNY","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1753878277816,"senderName":"evilpie","senderId":"@evilpie:mozilla.org","id":"$OHUd9bLH9M_MjXvciA9htwrU-0TbtMvX8xVXbOV271s"},
{"content":{"body":"* Concretely I am talking about:\n\n```\nlet svg = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\nsvg.innerHTML = `<p></p><foo>\n```\n (part of https://wpt.live/html/syntax/parsing/html5lib\\_innerHTML\\_foreign-fragment.html)\n","format":"org.matrix.custom.html","formatted_body":"* <p>Concretely I am talking about:</p>\n<pre><code>let svg = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\nsvg.innerHTML = `&lt;p&gt;&lt;/p&gt;&lt;foo&gt;\n</code></pre>\n<p>(part of https://wpt.live/html/syntax/parsing/html5lib_innerHTML_foreign-fragment.html)</p>\n","m.mentions":{},"m.new_content":{"body":"Concretely I am talking about:\n\n```\nlet svg = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\nsvg.innerHTML = `<p></p><foo>\n```\n (part of https://wpt.live/html/syntax/parsing/html5lib\\_innerHTML\\_foreign-fragment.html)\n","format":"org.matrix.custom.html","formatted_body":"<p>Concretely I am talking about:</p>\n<pre><code>let svg = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\nsvg.innerHTML = `&lt;p&gt;&lt;/p&gt;&lt;foo&gt;\n</code></pre>\n<p>(part of https://wpt.live/html/syntax/parsing/html5lib_innerHTML_foreign-fragment.html)</p>\n","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$HMTFKG32i7Rk38_E6ywO3hVAuggrqF_4-ne3Xpj7hNY","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1753878288112,"senderName":"evilpie","senderId":"@evilpie:mozilla.org","id":"$NsmvTpyPmNIuMsYI27jTpEv2MkmKH4B17DOaHPTmWVU"},
{"content":{"body":"Oh it depends on the node document, not the node itself. Interesting.","m.mentions":{},"msgtype":"m.text"},"ts":1753878442372,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$Bg05RPAMUrk46WTOYSnIrm6RsedAn6lAvKd7bM3QeeE"},
{"content":{"body":"But then step 7 of https://html.spec.whatwg.org/#html-fragment-parsing-algorithm guarantees the HTML `html` element root I mentioned above.","format":"org.matrix.custom.html","formatted_body":"But then step 7 of https://html.spec.whatwg.org/#html-fragment-parsing-algorithm guarantees the HTML <code>html</code> element root I mentioned above.","m.mentions":{},"msgtype":"m.text"},"ts":1753878482205,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$5eDuGZDysOZt4ErViq2O_zCg6ne7Ccz5W_AOHBLZPrE"},
{"content":{"body":"Ah you are right of course. There is even a note here: https://html.spec.whatwg.org/multipage/parsing.html#the-stack-of-open-elements","m.mentions":{},"msgtype":"m.text"},"ts":1753882449078,"senderName":"evilpie","senderId":"@evilpie:mozilla.org","id":"$iqCDVbbgc2sfnhTbq4YwHPbzFXiOlOA6ga8UGKDvmBw"}
]