[
{"content":{"body":"I am in favor of treating all nulls the same... the platform has enough null-ish things.","m.mentions":{},"msgtype":"m.text"},"ts":1712796373183,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$DW6nOdi9XESIyYyLlp0JIooG2KQCGLYYiQrla5Tu5DA"},
{"content":{"body":"I think if you need to distinguish two nullish values in those cases you should start out with your variable being undefined. If you really need the equivalent of any-or-nothing I'm not sure. Maybe a side boolean? But maybe also reconsider the general API shape.","m.mentions":{},"msgtype":"m.text"},"ts":1712813316270,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$q7gmGsDTYqAPGYP9EZ4Gt2xQog3_4zxWra2A4PEH5L8"},
{"content":{"body":"> <@annevk:matrix.org> It seems like Google and Mozilla blocked it.\n\nThat's sad. I filed an issue for it. I'll see if it's something Shopify would let me spend time on https://github.com/whatwg/html/issues/10273","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$8BIx8r1AlNCD0tp5UbGzxmhZQnPCRpCiCEYbIgi1sY8?via=matrix.org&via=mozilla.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@annevk:matrix.org\">@annevk:matrix.org</a><br>It seems like Google and Mozilla blocked it.</blockquote></mx-reply>That's sad. I filed an issue for it. I'll see if it's something Shopify would let me spend time on https://github.com/whatwg/html/issues/10273","m.mentions":{"user_ids":["@annevk:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$8BIx8r1AlNCD0tp5UbGzxmhZQnPCRpCiCEYbIgi1sY8"}},"msgtype":"m.text"},"ts":1712825779596,"senderName":"Jake Archibald","senderId":"@jakea:matrix.org","id":"$5ONynrtVlzmiek27ciF7mJr5t1R_Z-2QJcX6O9ft7tU"},
{"content":{"body":"Looking at the term \"similar-origin window agent\" (https://html.spec.whatwg.org/multipage/webappapis.html#similar-origin-window-agent). \nIn a nested cross-origin iframe case like `A1 -> B -> A2`, is there a way where `A1` can get script access to A2's window?","format":"org.matrix.custom.html","formatted_body":"Looking at the term \"similar-origin window agent\" (https://html.spec.whatwg.org/multipage/webappapis.html#similar-origin-window-agent).<br>In a nested cross-origin iframe case like <code>A1 -&gt; B -&gt; A2</code>, is there a way where <code>A1</code> can get script access to A2's window?","m.mentions":{},"msgtype":"m.text"},"ts":1712830360707,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$x3YZku6NrSOT_1aNdEyZFWg2-YA30fN-j1qt6kfDUy4"},
{"content":{"body":"oh I guess `window[name]`. Weird old stuff I forgot about","format":"org.matrix.custom.html","formatted_body":"oh I guess <code>window[name]</code>. Weird old stuff I forgot about","m.mentions":{},"msgtype":"m.text"},"ts":1712830542263,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$cWlyz5U4zkcz5vi8mweRp500CmnGL5WGXr38C-F_y24"},
{"content":{"body":"annevk: what, are you holding me responsible for bugs I introduced now? :)","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@annevk:matrix.org\">annevk</a>: what, are you holding me responsible for bugs I introduced now? :)","m.mentions":{"user_ids":["@annevk:matrix.org"]},"msgtype":"m.text"},"ts":1712830784617,"senderName":"Ms2ger","senderId":"@ms2ger:igalia.com","id":"$_Rf49Q7-_Qr2lkw5d4RxrdC46zJUK5Z61YhQvXS-8jk"},
{"content":{"body":"Ms2ger: git blame is a wonderful thing.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@ms2ger:igalia.com\">Ms2ger</a>: git blame is a wonderful thing.","m.mentions":{"user_ids":["@ms2ger:igalia.com"]},"msgtype":"m.text"},"ts":1712831612032,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$GWYMLi3X1tLKs05zmv-PecJtHyyJGg6eOElxY80_aj8"},
{"content":{"body":"> <@noamr:matrix.org> Looking at the term \"similar-origin window agent\" (https://html.spec.whatwg.org/multipage/webappapis.html#similar-origin-window-agent). \n> In a nested cross-origin iframe case like `A1 -> B -> A2`, is there a way where `A1` can get script access to A2's window?\n\nI would do `window[0][0]` so you don't even have to know the names, just enumerate over integers until you find something that doesn't throw when calling `.document`","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$x3YZku6NrSOT_1aNdEyZFWg2-YA30fN-j1qt6kfDUy4?via=matrix.org&via=mozilla.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@noamr:matrix.org\">@noamr:matrix.org</a><br>Looking at the term \"similar-origin window agent\" (https://html.spec.whatwg.org/multipage/webappapis.html#similar-origin-window-agent).<br />In a nested cross-origin iframe case like <code>A1 -&gt; B -&gt; A2</code>, is there a way where <code>A1</code> can get script access to A2's window?</blockquote></mx-reply>I would do <code>window[0][0]</code> so you don't even have to know the names, just enumerate over integers until you find something that doesn't throw when calling <code>.document</code>","m.mentions":{"user_ids":["@noamr:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$x3YZku6NrSOT_1aNdEyZFWg2-YA30fN-j1qt6kfDUy4"}},"msgtype":"m.text"},"ts":1712848162216,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$r_zHWYmzA4Ni3_NVUXlZpSbK1nhbV1odKC-JM_zgHgs"},
{"content":{"body":"Domenic: yea, I meant in general the `window[...]` feature... thanks","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@domenicdenicola:matrix.org\">Domenic</a>: yea, I meant in general the <code>window[...]</code> feature... thanks","m.mentions":{"user_ids":["@domenicdenicola:matrix.org"]},"msgtype":"m.text"},"ts":1712851227139,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$c5u0NPBecnuFPei2En2QkHj3wD-LlLKhujz0UP9tqhA"},
{"content":{"body":"smaug: see https://source.chromium.org/chromium/chromium/src/+/main:third_party/blink/renderer/core/loader/frame_loader.cc;l=388?q=frame_loader.c","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@smaug:mozilla.org\">smaug</a>: see https://source.chromium.org/chromium/chromium/src/+/main:third_party/blink/renderer/core/loader/frame_loader.cc;l=388?q=frame_loader.c","m.mentions":{"user_ids":["@smaug:mozilla.org"]},"msgtype":"m.text"},"ts":1712853305667,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$qGGc4rPuAJsujeQCRnzeldENHlpu5GS0PVfZga9HbvQ"},
{"content":{"body":"We're unloading the document with `will_commit_new_document_in_this_frame === false`","format":"org.matrix.custom.html","formatted_body":"We're unloading the document with <code>will_commit_new_document_in_this_frame === false</code>","m.mentions":{},"msgtype":"m.text"},"ts":1712853364669,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$0BzPbMhqYfbqGK0RB1a4wAXUVtP-Om_ZfpRR7DKMyVE"},
{"content":{"body":"Noam Rosenthal: and that gets called at what point when iframe is removed from DOM","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@noamr:matrix.org\">Noam Rosenthal</a>: and that gets called at what point when iframe is removed from DOM","m.mentions":{"user_ids":["@noamr:matrix.org"]},"msgtype":"m.text"},"ts":1712853373570,"senderName":"smaug","senderId":"@smaug:mozilla.org","id":"$Mz8dQtE3w8VEtSCpI7b4xyrOS0u1h72TuLQSbDWxM3o"},
{"content":{"body":"smaug: that would happen in https://source.chromium.org/chromium/chromium/src/+/main:third_party/blink/renderer/core/dom/container_node.cc;l=642;bpv=1;bpt=1?q=container_node.cc","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@smaug:mozilla.org\">smaug</a>: that would happen in https://source.chromium.org/chromium/chromium/src/+/main:third_party/blink/renderer/core/dom/container_node.cc;l=642;bpv=1;bpt=1?q=container_node.cc","m.mentions":{"user_ids":["@smaug:mozilla.org"]},"msgtype":"m.text"},"ts":1712853479449,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$DLivmlmdhkq-xJ-k-WFNdPtP7KOIAaVbi7T6wckz9cs"},
{"content":{"body":"thanks!","m.mentions":{},"msgtype":"m.text"},"ts":1712853491375,"senderName":"smaug","senderId":"@smaug:mozilla.org","id":"$YrSNOPtRibG76WNK1uonlNa5Eyo-GPpyApIq0ObaRNw"},
{"content":{"body":"so it's right *before* doing the actual DOM remove. the iframe would still appear connected if you query the parent's DOM during the `pagehide` event listener","format":"org.matrix.custom.html","formatted_body":"so it's right <em>before</em> doing the actual DOM remove. the iframe would still appear connected if you query the parent's DOM during the <code>pagehide</code> event listener","m.mentions":{},"msgtype":"m.text"},"ts":1712853532058,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$WUafSZiCS0eg1sRwCa9i1QrSnt0qyiNWWmdpBwnw6bU"},
{"content":{"body":"looks like the code is pretty much as hacky as in Gecko ðŸ˜› ","m.mentions":{},"msgtype":"m.text"},"ts":1712853606474,"senderName":"smaug","senderId":"@smaug:mozilla.org","id":"$nVGbAH4zWUKs171eaTzOdUkONNR8wHeRJJ4DtCb5S-8"},
{"content":{"body":"vaguely recalls fixing some crashes around iframe removal...maybe 15 years ago","m.mentions":{},"msgtype":"m.emote"},"ts":1712853701814,"senderName":"smaug","senderId":"@smaug:mozilla.org","id":"$oAkGgX68mjn4WJG5naEVKv4sbQIW1V0WIOZf-THvQas"},
{"content":{"body":"yea this synchronous removal stuff is nasty. For the synchronous blur event firing we have so much special-case code","m.mentions":{},"msgtype":"m.text"},"ts":1712853743681,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$F9uQ2eHtiunvh8eJsMAZMnnjrKjQmgaP1a3M-VSZa6g"},
{"content":{"body":"Sorry for dropping out there my headset ran out of battery right as I was going to speak","m.mentions":{},"msgtype":"m.text"},"ts":1712854854546,"senderName":"Luke Warlow","senderId":"@lwarlow:igalia.com","id":"$aTrcsLszIfoNy-SVhHZegrXu8zLCOrpocvjDyGOfjAk"},
{"content":{"body":"I'll need to check all the callers of AddScriptRunner. Gecko has > 100 of those","m.mentions":{},"msgtype":"m.text"},"ts":1712854887639,"senderName":"smaug","senderId":"@smaug:mozilla.org","id":"$5scP7zrVrPOX-MMB4UrxKCZYUzp3bGw5w_RYq5CrtMs"},
{"content":{"body":"(many of them don't affect anything on the web though)","m.mentions":{},"msgtype":"m.text"},"ts":1712854909256,"senderName":"smaug","senderId":"@smaug:mozilla.org","id":"$HfE8eMzKeOjT51m5_7wF0_2a0yviAgMvl6MKnapwdBQ"},
{"content":{"body":"Dominic Farolino: actually, I don't know how the insertion step model works in case of mutations. Say, you have an element and it has 3 child elements.  That subtree root element is inserted to document tree. Now child 1  has insertion steps which run some script which removes the child and adds it to be the last of the child nodes. So child list is now 2, 3, 1.  Do the insertion steps get run on 1 again, because it is now after 2 and 3?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@domfarolino:matrix.org\">Dominic Farolino</a>: actually, I don't know how the insertion step model works in case of mutations. Say, you have an element and it has 3 child elements.  That subtree root element is inserted to document tree. Now child 1  has insertion steps which run some script which removes the child and adds it to be the last of the child nodes. So child list is now 2, 3, 1.  Do the insertion steps get run on 1 again, because it is now after 2 and 3?","m.mentions":{"user_ids":["@domfarolino:matrix.org"]},"msgtype":"m.text"},"ts":1712865215640,"senderName":"smaug","senderId":"@smaug:mozilla.org","id":"$aCvJY_JdVGJw0wAd2xXRADa5IP0hJAWil9Gha5-63cQ"},
{"content":{"body":"The pr doesn't explain this","m.mentions":{},"msgtype":"m.text"},"ts":1712865223882,"senderName":"smaug","senderId":"@smaug:mozilla.org","id":"$yIN296EEqH7y-SvvhCkUM1qQMxB2PkXdZ6Vq2I5Eyq0"},
{"content":{"body":"I mean, the insertion step would certainly run when 1 is added back to DOM, but would insertion step run again when iterating through the children of the subtree root.","m.mentions":{},"msgtype":"m.text"},"ts":1712866471081,"senderName":"smaug","senderId":"@smaug:mozilla.org","id":"$jNm4Wan85f51rP8DiZFbM6c_q1yuCEOGZFhp3nLhQQc"}
]