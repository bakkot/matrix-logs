[
{"content":{"body":"https://source.chromium.org/chromium/chromium/src/+/master:third_party/blink/renderer/core/html/parser/html_meta_charset_parser.h;l=58 indeed looks a lot like Chromium is using the real HTML tokenizer. But not the real tree builder: https://source.chromium.org/chromium/chromium/src/+/master:third_party/blink/renderer/core/html/parser/html_meta_charset_parser.h;l=58","msgtype":"m.text"},"ts":1626420890209,"senderName":"hsivonen","senderId":"@hsivonen:mozilla.org","id":"$b0Erdy3ZaRRjxhmP9efbLHKKT8yKMH1crR1g6hFyl_Y"},
{"content":{"body":"Can anyone think of bad Web compat consequences from using the real tree builder algorithm for figuring out where `body` starts?","format":"org.matrix.custom.html","formatted_body":"Can anyone think of bad Web compat consequences from using the real tree builder algorithm for figuring out where <code>body</code> starts?","msgtype":"m.text"},"ts":1626420946795,"senderName":"hsivonen","senderId":"@hsivonen:mozilla.org","id":"$EyeyZ70x3sJg1zHGqx6vnIbH6MGAlqYKcIVZ9XXsQVw"},
{"content":{"body":"That is, running the tree builder in the scripting enabled mode without actually executing scripts during the `meta` prescan?","format":"org.matrix.custom.html","formatted_body":"That is, running the tree builder in the scripting enabled mode without actually executing scripts during the <code>meta</code> prescan?","msgtype":"m.text"},"ts":1626420988469,"senderName":"hsivonen","senderId":"@hsivonen:mozilla.org","id":"$XUcDuYZ3nVZEbc0uuLrjjqN6AskLY-RN9roKrj7xd30"},
{"content":{"body":"Oops. The second link was supposed to be https://source.chromium.org/chromium/chromium/src/+/master:third_party/blink/renderer/core/html/parser/html_meta_charset_parser.h;l=58","msgtype":"m.text"},"ts":1626421063654,"senderName":"hsivonen","senderId":"@hsivonen:mozilla.org","id":"$7_Uf1XfAX1qI5wwkBdAl5PTrbudiZ0ksPkWzRy8nOM8"},
{"content":{"body":"What","msgtype":"m.text"},"ts":1626421071420,"senderName":"hsivonen","senderId":"@hsivonen:mozilla.org","id":"$y1HRSuKn0N7EUEIGeUJs1G8gDRzklL8G2Gp2-vdc1M0"},
{"content":{"body":"https://source.chromium.org/chromium/chromium/src/+/master:third_party/blink/renderer/core/html/parser/html_meta_charset_parser.cc;l=88","msgtype":"m.text"},"ts":1626421094568,"senderName":"hsivonen","senderId":"@hsivonen:mozilla.org","id":"$8Bd8ws6BphMSJZtAoGzpVcdGlaiFfIU69EQzuL0qzyU"},
{"content":{"body":"Something weird going on with how the copypasteable URL updates.","msgtype":"m.text"},"ts":1626421107803,"senderName":"hsivonen","senderId":"@hsivonen:mozilla.org","id":"$OLBZvh8zs7UrNZEH4WvPyrg5op7vxK_ZB5WtrG5_WXg"},
{"content":{"body":"AFAICT, the biggest risk is probably `meta` inside `script` in a manner that should be honored for compat. Need to write tests...","format":"org.matrix.custom.html","formatted_body":"AFAICT, the biggest risk is probably <code>meta</code> inside <code>script</code> in a manner that should be honored for compat. Need to write tests...","msgtype":"m.text"},"ts":1626421291580,"senderName":"hsivonen","senderId":"@hsivonen:mozilla.org","id":"$YZBVMWNwdk7bQSQ6YGjvrT6dTZjAV4gfMefj5o4U2gc"},
{"content":{"body":"> <@hsivonen:mozilla.org> AFAICT, the biggest risk is probably `meta` inside `script` in a manner that should be honored for compat. Need to write tests...\n\nFWIW, I would be strongly in favour of not allowing this (or `meta` inside `noscript`), if we could get away this from a compat POV","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$YZBVMWNwdk7bQSQ6YGjvrT6dTZjAV4gfMefj5o4U2gc?via=mozilla.org&via=matrix.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@hsivonen:mozilla.org\">@hsivonen:mozilla.org</a><br>AFAICT, the biggest risk is probably <code>meta</code> inside <code>script</code> in a manner that should be honored for compat. Need to write tests...</blockquote></mx-reply>FWIW, I would be strongly in favour of not allowing this (or <code>meta</code> inside <code>noscript</code>), if we could get away this from a compat POV","m.relates_to":{"m.in_reply_to":{"event_id":"$YZBVMWNwdk7bQSQ6YGjvrT6dTZjAV4gfMefj5o4U2gc"}},"msgtype":"m.text"},"ts":1626426312030,"senderName":"Sam Sneddon [:gsnedders]","senderId":"@gsnedders:mozilla.org","id":"$JySB5g0TtjDS9NzKXtLTzGhnLOB59V9lTW9zklNh-ic"},
{"content":{"body":"I don't know the origins of why Hixie spec'd it as allowing it, thoughâ€¦","msgtype":"m.text"},"ts":1626426447244,"senderName":"Sam Sneddon [:gsnedders]","senderId":"@gsnedders:mozilla.org","id":"$LJAq0-4uhJI4M9sHwlNJQe5o5MpBgr8aPa_jLpYrd94"},
{"content":{"body":"Compat is nice and all, but sometimes I understand why people wanted to burn it all to the ground","msgtype":"m.text"},"ts":1626426455486,"senderName":"Ms2ger","senderId":"@ms2ger:igalia.com","id":"$Er7hRnJnqCpE41RF_aPw8aBjV3Ih3KZ5t3eQh07j2jA"},
{"content":{"body":"I guess it's somewhat difficult to avoid the actual parser changing encoding from `document.write`, and probably practically unacceptable :(","format":"org.matrix.custom.html","formatted_body":"I guess it's somewhat difficult to avoid the actual parser changing encoding from <code>document.write</code>, and probably practically unacceptable :(","msgtype":"m.text"},"ts":1626426781823,"senderName":"Sam Sneddon [:gsnedders]","senderId":"@gsnedders:mozilla.org","id":"$Eonw5SbRYV-tOwHyo9Rya3LyPtclfaD38Ep0JqbIjTQ"},
{"content":{"body":"Compat is nice / but compat can stop you / from doing all the things in life you'd like to.","msgtype":"m.text"},"ts":1626426864008,"senderName":"jgraham","senderId":"@jgraham_:matrix.org","id":"$6WpkAaqLOqS55Ax5vvPxAhOvi-_mlb6ThToWzCgf0zA"},
{"content":{"body":"(also I think to quote The Smiths these days, one need to pretend that Morrissey doesn't exist and it's all Johnny Marr)","msgtype":"m.text"},"ts":1626426961608,"senderName":"jgraham","senderId":"@jgraham_:matrix.org","id":"$Rv_e2jt4wbkhvjZZlnIDHMxEZAUdBofNgrKHOI5AIw4"},
{"content":{"body":"Who are The Smiths?","msgtype":"m.text"},"ts":1626426976450,"senderName":"Ms2ger","senderId":"@ms2ger:igalia.com","id":"$eph_ZDdLhoX64f77RBCYsOA_uo293dlXK4WD5w_LSwo"},
{"content":{"body":"gets inspired to put on a far more acceptable band, The Jesus and the Mary Chain","msgtype":"m.emote"},"ts":1626427095628,"senderName":"Sam Sneddon [:gsnedders]","senderId":"@gsnedders:mozilla.org","id":"$4MabETP_ZN2e9LmzXhFw-AiRLc6OTd464L3u6DjCX74"}
]