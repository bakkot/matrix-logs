[
{"content":{"body":"I don't see an entry in the WHATNOT meeting notes for today, the meeting is happening right?","m.mentions":{},"msgtype":"m.text"},"ts":1764231586347,"senderName":"foolip","senderId":"@foolip:matrix.org","id":"$tVGIKUIqOnp7brZffutq5Hxnqf2cxEQ_JajwAWgl4os"},
{"content":{"body":"Yes I think so!","m.mentions":{},"m.relates_to":{"event_id":"$tVGIKUIqOnp7brZffutq5Hxnqf2cxEQ_JajwAWgl4os","is_falling_back":true,"m.in_reply_to":{"event_id":"$tVGIKUIqOnp7brZffutq5Hxnqf2cxEQ_JajwAWgl4os"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1764234031872,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$P0trd_K1HeFZgzPSFoaKLPSyh3DLTgVgoHJ3_rxymDs"},
{"content":{"body":"Deferred scripts inserted with createContextualFragment() are considered \"not parser inserted\"\nhttps://html.spec.whatwg.org/multipage/dynamic-markup-insertion.html#dom-range-createcontextualfragment 8.2\nSo `createContextualFragment` basically ignores the `defer` attribute","format":"org.matrix.custom.html","formatted_body":"Deferred scripts inserted with createContextualFragment() are considered \"not parser inserted\"<br>https://html.spec.whatwg.org/multipage/dynamic-markup-insertion.html#dom-range-createcontextualfragment 8.2<br>So <code>createContextualFragment</code> basically ignores the <code>defer</code> attribute","m.mentions":{},"msgtype":"m.text"},"ts":1764241081710,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$MeVcuoeF9tEG6s-VYfPd51bKFdZQ6E0sj_QVp6PCrU0"},
{"content":{"body":"Noam Rosenthal: OK. Maybe that's good enough for `setHTMLUnsafe`. I wonder though if it would be good to set `async=false` for inline scripts (both for setHTMLUnsafe and createContextualFragment). cc hsivonen ","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@noamr:matrix.org\">Noam Rosenthal</a>: OK. Maybe that's good enough for <code>setHTMLUnsafe</code>. I wonder though if it would be good to set <code>async=false</code> for inline scripts (both for setHTMLUnsafe and createContextualFragment). cc <a href=\"https://matrix.to/#/@hsivonen:mozilla.org\">hsivonen</a>","m.mentions":{"user_ids":["@noamr:matrix.org","@hsivonen:mozilla.org"]},"msgtype":"m.text"},"ts":1764242925934,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$5y8qDbWS43otk5suWwtmI0Vqk6T9YogoJldyvPX4uW4"},
{"content":{"body":"annevk: for creation/insertion difference, I think the sanitizer currently is not set to prevent early image loading, regardless of the inert document in the fragment parsing algorithm.\n\nhttps://wicg.github.io/sanitizer-api/#set-and-filter-html stage 4 adds all the nodes into a fragment in this document, which would trigger image loading before sanitation starts.\n\nNot sure if this is an important use case for the sanitizer\n","format":"org.matrix.custom.html","formatted_body":"<p><a href=\"https://matrix.to/#/@annevk:matrix.org\">annevk</a>: for creation/insertion difference, I think the sanitizer currently is not set to prevent early image loading, regardless of the inert document in the fragment parsing algorithm.</p>\n<p>https://wicg.github.io/sanitizer-api/#set-and-filter-html stage 4 adds all the nodes into a fragment in this document, which would trigger image loading before sanitation starts.</p>\n<p>Not sure if this is an important use case for the sanitizer</p>\n","m.mentions":{"user_ids":["@annevk:matrix.org"]},"msgtype":"m.text"},"ts":1764243642237,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$AW6gBNqMjtt3XkxMIfDbN10gn3u444YTPxAmtxMOyFY"},
{"content":{"body":"... in the same manner that this loads an image:\n  new Range().createContextualFragment('<img src=\"/bla.png\">')","m.mentions":{},"msgtype":"m.text"},"ts":1764243685721,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$cA-S_pIHiNgCMVaWK4UMG3ORFGFRQ2KdW4rvfd3JsDM"},
{"content":{"body":"Noam Rosenthal: I suppose the `setHTML` step should say that a temporary inert document is created and that the DocumentFragment is created for that temporary inert document? Can you file a bug?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@noamr:matrix.org\">Noam Rosenthal</a>: I suppose the <code>setHTML</code> step should say that a temporary inert document is created and that the DocumentFragment is created for that temporary inert document? Can you file a bug?","m.mentions":{"user_ids":["@noamr:matrix.org"]},"msgtype":"m.text"},"ts":1764244672129,"senderName":"freddy","senderId":"@fbraun:mozilla.org","id":"$I_mHdsp-VfH54wwocxT-YpIPKI3K7fJ7xjhckHXFRsY"},
{"content":{"body":"We totally should prevent image loading and [our implementation in Firefox appears to do the right thing](https://searchfox.org/firefox-main/rev/f81fae7890605739dd8dde14755f159fe6beb8aa/dom/base/nsContentUtils.cpp#6159-6184)","format":"org.matrix.custom.html","formatted_body":"We totally should prevent image loading and <a href=\"https://searchfox.org/firefox-main/rev/f81fae7890605739dd8dde14755f159fe6beb8aa/dom/base/nsContentUtils.cpp#6159-6184\">our implementation in Firefox appears to do the right thing</a>","m.mentions":{},"msgtype":"m.text"},"ts":1764244758226,"senderName":"freddy","senderId":"@fbraun:mozilla.org","id":"$-avZLlheseASLtPH1ECk9N6w_h5-7iVnDNzrdvEeIF4"}
]