[
{"content":{"body":"Hi, I'm working on the WebDriver BiDi implementation in Firefox, and I'm looking at the `WebDriver BiDi download started` triggered from the HTML spec (step 5.4.4 of https://html.spec.whatwg.org/#attempt-to-populate-the-history-entry's-document). I have a couple of questions around this (spawned from https://github.com/w3c/webdriver-bidi/issues/980).\n\nFirst, do I understand correctly that this is not triggered when users click on a link with a `download` attribute? (which goes through https://html.spec.whatwg.org/#downloading-hyperlinks). \nThen if that's correct, I would like to change this so that we also trigger the BiDi hook in case of a `download` attribute. But then I'm not sure there would be a navigation id relevant to send to BiDi in this case?\n\n(I can also file an issue on GitHub if preferable to discuss about this)","format":"org.matrix.custom.html","formatted_body":"<p>Hi, I'm working on the WebDriver BiDi implementation in Firefox, and I'm looking at the <code>WebDriver BiDi download started</code> triggered from the HTML spec (step 5.4.4 of https://html.spec.whatwg.org/#attempt-to-populate-the-history-entry's-document). I have a couple of questions around this (spawned from https://github.com/w3c/webdriver-bidi/issues/980).</p>\n<p>First, do I understand correctly that this is not triggered when users click on a link with a <code>download</code> attribute? (which goes through https://html.spec.whatwg.org/#downloading-hyperlinks).<br>Then if that's correct, I would like to change this so that we also trigger the BiDi hook in case of a <code>download</code> attribute. But then I'm not sure there would be a navigation id relevant to send to BiDi in this case?</p>\n<p>(I can also file an issue on GitHub if preferable to discuss about this)</p>\n","m.mentions":{},"msgtype":"m.text"},"ts":1755156622669,"senderName":"Julian Descottes","senderId":"@jdescottes:matrix.org","id":"$kvtcU01vriBEmOad3wITIaU6khYYm2HzDVLkww2hXTA"},
{"content":{"body":"Julian Descottes: there's an existing issue of the `download` attribute not being described in terms of the navigate algorithm. That would fix your issue. Are there other WebDriver callbacks that happen before or after this is called that also require the navigation ID? Because if not I suppose we could just generate a synthetic one in the `download` attribute algorithm as a workaround for now, but it's not great overall.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@jdescottes:matrix.org\">Julian Descottes</a>: there's an existing issue of the <code>download</code> attribute not being described in terms of the navigate algorithm. That would fix your issue. Are there other WebDriver callbacks that happen before or after this is called that also require the navigation ID? Because if not I suppose we could just generate a synthetic one in the <code>download</code> attribute algorithm as a workaround for now, but it's not great overall.","m.mentions":{"user_ids":["@jdescottes:matrix.org"]},"msgtype":"m.text"},"ts":1755156924047,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$p_Lm0NIpcDT6BO2jUTTCtDdnxWeWR1G80VdlGt2VIXM"},
{"content":{"body":"annevk: ok, great. And no the navigation id from this particular event is not really meant to be reused or shared with other events, it's more for completeness. So the workaround would be fine, but we could also make it optional on the BiDi side and omit the info until the HTML spec is fixed.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@annevk:matrix.org\">annevk</a>: ok, great. And no the navigation id from this particular event is not really meant to be reused or shared with other events, it's more for completeness. So the workaround would be fine, but we could also make it optional on the BiDi side and omit the info until the HTML spec is fixed.","m.mentions":{"user_ids":["@annevk:matrix.org"]},"msgtype":"m.text"},"ts":1755157057948,"senderName":"Julian Descottes","senderId":"@jdescottes:matrix.org","id":"$Ades-1KRmSwVA3hfd6CMYo_370K8jB-PORi7Thjaer0"},
{"content":{"body":"do you have a link to the issue about the download attribute?","m.mentions":{},"msgtype":"m.text"},"ts":1755157082243,"senderName":"Julian Descottes","senderId":"@jdescottes:matrix.org","id":"$bRW_14YHbvRXUCMZu-eyxrrF1I2xoNYWQGCAuen2RIY"},
{"content":{"body":"Julian Descottes: https://github.com/whatwg/html/issues/5548 might be the most canonical one, but there's several. ðŸ˜…","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@jdescottes:matrix.org\">Julian Descottes</a>: https://github.com/whatwg/html/issues/5548 might be the most canonical one, but there's several. ðŸ˜…","m.mentions":{"user_ids":["@jdescottes:matrix.org"]},"msgtype":"m.text"},"ts":1755157443030,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$7ulY1NhzDziKvLD5UCxgPMENrG1mGSTZO1Bqg4rVTVM"},
{"content":{"body":"annevk: OK if I resurrect https://github.com/whatwg/html/pull/2480 ?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@annevk:matrix.org\">annevk</a>: OK if I resurrect https://github.com/whatwg/html/pull/2480 ?","m.mentions":{"user_ids":["@annevk:matrix.org"]},"msgtype":"m.text"},"ts":1755164356020,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$ag7bZlgHWVuTdp2TC6ha28io-Gsi2FwMT_gI7GGGa4A"},
{"content":{"body":"zcorpan: ","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@zcorpan:mozilla.org\">zcorpan</a>:","m.mentions":{"user_ids":["@zcorpan:mozilla.org"]},"msgtype":"m.text"},"ts":1755164544580,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$x1EQ8jWHbxkdlT0gCBOvgMO8pyluwpeWFUnf2fzd1Co"},
{"content":{"body":"* zcorpan: please!","format":"org.matrix.custom.html","formatted_body":"* <a href=\"https://matrix.to/#/@zcorpan:mozilla.org\">zcorpan</a>: please!","m.mentions":{},"m.new_content":{"body":"zcorpan: please!","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@zcorpan:mozilla.org\">zcorpan</a>: please!","m.mentions":{"user_ids":["@zcorpan:mozilla.org"]},"msgtype":"m.text"},"m.relates_to":{"event_id":"$x1EQ8jWHbxkdlT0gCBOvgMO8pyluwpeWFUnf2fzd1Co","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1755164552590,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$jQRwu3Di0UrPTLb0V4HOYs4ZvS0m4mq2xqOituOBvu0"},
{"content":{"body":"annevk: do you remember details of this comment? https://github.com/mozilla/standards-positions/issues/466#issuecomment-745120322\n\nIs the no-referrer-based redaction not sufficient?","format":"org.matrix.custom.html","formatted_body":"<p><a href=\"https://matrix.to/#/@annevk:matrix.org\">annevk</a>: do you remember details of this comment? https://github.com/mozilla/standards-positions/issues/466#issuecomment-745120322</p>\n<p>Is the no-referrer-based redaction not sufficient?</p>\n","m.mentions":{"user_ids":["@annevk:matrix.org"]},"msgtype":"m.text"},"ts":1755164639986,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$55ysJyGmkbe8-06kdkjddXEIyt5BP-_iiVwgk_CKbDg"},
{"content":{"body":"zcorpan: I think if the redaction is based on the policies of the embedding elements (with their node document policies as fallback) it's probably good. (Modulo the debate as to whether an HTTP-level policy needs to override, but that can probably be kept as its own issue that might impact the behavior here down the line.)","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@zcorpan:mozilla.org\">zcorpan</a>: I think if the redaction is based on the policies of the embedding elements (with their node document policies as fallback) it's probably good. (Modulo the debate as to whether an HTTP-level policy needs to override, but that can probably be kept as its own issue that might impact the behavior here down the line.)","m.mentions":{"user_ids":["@zcorpan:mozilla.org"]},"msgtype":"m.text"},"ts":1755165033661,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$r-iMmPUQXXrg89u11OCFbCIywk_2RSr9YUG1tYMmqfY"},
{"content":{"body":"zcorpan: ah\n\n> This is even further complicated when an embedded site is navigated as the site being navigated to would never know about its parent (other than that one exists).\n\nis a case where we start exposing more information and also more strongly conveys that referrer policy now has this dual purpose. I think that's probably all okay though and it's relatively straightforward to follow.","format":"org.matrix.custom.html","formatted_body":"<p><a href=\"https://matrix.to/#/@zcorpan:mozilla.org\">zcorpan</a>: ah</p>\n<blockquote>\n<p>This is even further complicated when an embedded site is navigated as the site being navigated to would never know about its parent (other than that one exists).</p>\n</blockquote>\n<p>is a case where we start exposing more information and also more strongly conveys that referrer policy now has this dual purpose. I think that's probably all okay though and it's relatively straightforward to follow.</p>\n","m.mentions":{"user_ids":["@zcorpan:mozilla.org"]},"msgtype":"m.text"},"ts":1755165446685,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$Ko4cbnFEOJiDgHSCLolslolqGzIj5fW43OyFNCFPx70"},
{"content":{"body":"zcorpan: my PR seems wrong in that it stores the referrer rather than some computed version of the referrer policy.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@zcorpan:mozilla.org\">zcorpan</a>: my PR seems wrong in that it stores the referrer rather than some computed version of the referrer policy.","m.mentions":{"user_ids":["@zcorpan:mozilla.org"]},"msgtype":"m.text"},"ts":1755165571925,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$RaDJB3aD0aOAHUg5V47p3QdBR_vHDRKz64vDV0sqHj0"},
{"content":{"body":"annevk: OK thanks. I'll start with rebasing","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@annevk:matrix.org\">annevk</a>: OK thanks. I'll start with rebasing","m.mentions":{"user_ids":["@annevk:matrix.org"]},"msgtype":"m.text"},"ts":1755165622399,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$XBDuZ8LDkHNkdGk6BOKBca2C-iUaxy1qCpLDWjma7Aw"},
{"content":{"body":"Hmm, no spec preview in https://github.com/whatwg/html/pull/11560","m.mentions":{},"msgtype":"m.text"},"ts":1755176932304,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$55y-LfSmoqm9CcQjOhbq8noPHhHXe71Ffo0goAOBwKs"}
]