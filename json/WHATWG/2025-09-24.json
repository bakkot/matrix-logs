[
{"content":{"body":"I tend to feel multiple methods is nicer. Minimizing the number of methods doesn't seem like an important goal to me.","m.mentions":{},"m.relates_to":{"event_id":"$XzLs58NkII4yDCjTavQrxN2qy2QM59USAXaZQyvLpUU","is_falling_back":true,"m.in_reply_to":{"event_id":"$mcau2qVhHJDdWEazDRa2j7baV9U0lretlpoXADAWwFk"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1758678132921,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$mKH_mOZZR-zxknhS7KsvOr8Q4Madm7ZPEIeuj1txt-E"},
{"content":{"body":"If we go all the way with multiple methods, it would be something like this:\n\nsetHTML\nsetHTMLUnsafe\nstreamHTML\nstreamHTMLUnsafe\nhtmlBefore\nhtmlBeforeUnsafe\nstreamHTMLBefore\nstreamHTMLBeforeUnsafe\nappendHTML\nappendHTMLUnsafe\nstreamAppendHTML\nstreamAppendHTMLUnsafe","m.mentions":{},"m.relates_to":{"event_id":"$XzLs58NkII4yDCjTavQrxN2qy2QM59USAXaZQyvLpUU","is_falling_back":true,"m.in_reply_to":{"event_id":"$mKH_mOZZR-zxknhS7KsvOr8Q4Madm7ZPEIeuj1txt-E"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1758697982588,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$WEjoEklnEHGHB8KdRTYxCHjEXiZ6KANHYzJ1ZoWwCvo"},
{"content":{"body":"(not saying it as something good vs bad)","m.mentions":{},"m.relates_to":{"event_id":"$XzLs58NkII4yDCjTavQrxN2qy2QM59USAXaZQyvLpUU","is_falling_back":true,"m.in_reply_to":{"event_id":"$WEjoEklnEHGHB8KdRTYxCHjEXiZ6KANHYzJ1ZoWwCvo"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1758697993551,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$pgOkeHw89AW45C_LF2HQIVPcrZzZa_7jftq10mO8LMw"},
{"content":{"body":"Added this as an alternative in the OP","m.mentions":{},"m.relates_to":{"event_id":"$XzLs58NkII4yDCjTavQrxN2qy2QM59USAXaZQyvLpUU","is_falling_back":true,"m.in_reply_to":{"event_id":"$pgOkeHw89AW45C_LF2HQIVPcrZzZa_7jftq10mO8LMw"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1758699973380,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$eFiqwmquMKra_jZXGkvRk_yZVQzIMTFsxu_l7swEVKs"},
{"content":{"body":"> <@domenicdenicola:matrix.org> I tend to feel multiple methods is nicer. Minimizing the number of methods doesn't seem like an important goal to me.\n\nI think minimising the number of legacy methods we create should be taken into account. .innerHTML had to be replaced for setHTMLUnsafe so it could take arguments. But if we have existing functions upgrading them rather than replacing would seem good.\n\nElse we'll have a lot of widely used but at least partially duplicated methods.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$mKH_mOZZR-zxknhS7KsvOr8Q4Madm7ZPEIeuj1txt-E?via=igalia.com&via=matrix.org&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@domenicdenicola:matrix.org\">@domenicdenicola:matrix.org</a><br />I tend to feel multiple methods is nicer. Minimizing the number of methods doesn't seem like an important goal to me.</blockquote></mx-reply><p>I think minimising the number of legacy methods we create should be taken into account. .innerHTML had to be replaced for setHTMLUnsafe so it could take arguments. But if we have existing functions upgrading them rather than replacing would seem good.</p>\n<p>Else we'll have a lot of widely used but at least partially duplicated methods.</p>","m.relates_to":{"event_id":"$XzLs58NkII4yDCjTavQrxN2qy2QM59USAXaZQyvLpUU","is_falling_back":false,"m.in_reply_to":{"event_id":"$mKH_mOZZR-zxknhS7KsvOr8Q4Madm7ZPEIeuj1txt-E"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1758706886166,"senderName":"Luke Warlow","senderId":"@lwarlow:igalia.com","id":"$TrK8abkHbkhDYLtBm0iQdW5hkfO2g1ew_tJF5oFwOvA"},
{"content":{"body":"Is it also worth considering stuff like https://developer.mozilla.org/en-US/docs/Web/API/HTMLIFrameElement/srcdoc that can't be sanitized yet.\n\nThere's also https://w3c.github.io/editing/docs/execCommand/#the-inserthtml-command which can do a partial replacement.","m.relates_to":{"event_id":"$XzLs58NkII4yDCjTavQrxN2qy2QM59USAXaZQyvLpUU","is_falling_back":true,"m.in_reply_to":{"event_id":"$TrK8abkHbkhDYLtBm0iQdW5hkfO2g1ew_tJF5oFwOvA"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1758707288626,"senderName":"Luke Warlow","senderId":"@lwarlow:igalia.com","id":"$lxGe72qbB4ZWghMR3LWW-BBVUDwXdq5Aqjded6N3jtE"},
{"content":{"body":"Why would we create legacy methods at all? Just create new non-legacy methods.","m.relates_to":{"event_id":"$XzLs58NkII4yDCjTavQrxN2qy2QM59USAXaZQyvLpUU","is_falling_back":true,"m.in_reply_to":{"event_id":"$lxGe72qbB4ZWghMR3LWW-BBVUDwXdq5Aqjded6N3jtE"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1758707780763,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$ptcon8K2zLxu7H2bRSoULmIInZ5DWYDoVYCIDN7nYUk"},
{"content":{"body":"> <@domenicdenicola:matrix.org> Why would we create legacy methods at all? Just create new non-legacy methods.\n\nThat's what I mean, if we create a new non-legacy method we're making the existing method legacy effectively.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$ptcon8K2zLxu7H2bRSoULmIInZ5DWYDoVYCIDN7nYUk?via=igalia.com&via=matrix.org&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@domenicdenicola:matrix.org\">@domenicdenicola:matrix.org</a><br />Why would we create legacy methods at all? Just create new non-legacy methods.</blockquote></mx-reply>That's what I mean, if we create a new non-legacy method we're making the existing method legacy effectively.","m.relates_to":{"event_id":"$XzLs58NkII4yDCjTavQrxN2qy2QM59USAXaZQyvLpUU","is_falling_back":false,"m.in_reply_to":{"event_id":"$ptcon8K2zLxu7H2bRSoULmIInZ5DWYDoVYCIDN7nYUk"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1758708190198,"senderName":"Luke Warlow","senderId":"@lwarlow:igalia.com","id":"$-xpbFpfo2SXI_a9PKXt-szWScucoE5ucy9oW6lKv-rA"},
{"content":{"body":"That would happen regardless of how many methods we're adding though","m.mentions":{"user_ids":["@lwarlow:igalia.com"]},"m.relates_to":{"event_id":"$XzLs58NkII4yDCjTavQrxN2qy2QM59USAXaZQyvLpUU","is_falling_back":false,"m.in_reply_to":{"event_id":"$-xpbFpfo2SXI_a9PKXt-szWScucoE5ucy9oW6lKv-rA"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1758708231950,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$wmhmWrPD2_i6s7-brEljkOoeGfpDrlgwhr3pRp5y29Y"},
{"content":{"body":"Oh I see. I don't personally think that's a great idea, since the existing functions are pretty messy.","m.relates_to":{"event_id":"$XzLs58NkII4yDCjTavQrxN2qy2QM59USAXaZQyvLpUU","is_falling_back":true,"m.in_reply_to":{"event_id":"$wmhmWrPD2_i6s7-brEljkOoeGfpDrlgwhr3pRp5y29Y"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1758708268274,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$spll3siKxajG9XW9AzxS4u83DCTZSvoYx5RRB5coFyM"},
{"content":{"body":"> <@noamr:matrix.org> That would happen regardless of how many methods we're adding though\n\nWell it depends, if we could make insertAdjacentHTML behave better that would be less new ones right?","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$wmhmWrPD2_i6s7-brEljkOoeGfpDrlgwhr3pRp5y29Y?via=igalia.com&via=matrix.org&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@noamr:matrix.org\">@noamr:matrix.org</a><br />That would happen regardless of how many methods we're adding though</blockquote></mx-reply>Well it depends, if we could make insertAdjacentHTML behave better that would be less new ones right?","m.relates_to":{"event_id":"$XzLs58NkII4yDCjTavQrxN2qy2QM59USAXaZQyvLpUU","is_falling_back":false,"m.in_reply_to":{"event_id":"$wmhmWrPD2_i6s7-brEljkOoeGfpDrlgwhr3pRp5y29Y"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1758708271417,"senderName":"Luke Warlow","senderId":"@lwarlow:igalia.com","id":"$WnZwqHQ4lCSWZsp4iwezatYS3gGRO20HGoaes-2MVA0"}
]