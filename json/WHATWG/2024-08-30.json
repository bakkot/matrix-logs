[
{"content":{"body":"Why does the HTML spec fire some events without their defined constructor?\n\nWhat I means is: When specifying firing of events, in some places in the spec it states the event constructor with *“using”,* like this:\n> *fire an event named `hashchange` at document's relevant global object, **using `HashChangeEvent`***\n…and in other places it’s stated without *“using”*\n>  fire an event named `input` at the element, with the `bubbles` and `composed` attributes initialized to true.\n\nSo given that, when that `input` event is fired, the `Event` constructor is used — because the caller doesn’t have a *“using”* statement.\n\nBut the `input` event have an `InputEvent` constructor defined in the UI Events spec at https://w3c.github.io/uievents/#inputevent. Why doesn’t the HTML spec state that constructor must be used when firing the `input` event?\n\n","format":"org.matrix.custom.html","formatted_body":"<p>Why does the HTML spec fire some events without their defined constructor?</p>\n<p>What I means is: When specifying firing of events, in some places in the spec it states the event constructor with <em>“using”,</em> like this:</p>\n<blockquote>\n<p><em>fire an event named <code>hashchange</code> at document's relevant global object, <strong>using <code>HashChangeEvent</code></strong></em><br>…and in other places it’s stated without <em>“using”</em><br>fire an event named <code>input</code> at the element, with the <code>bubbles</code> and <code>composed</code> attributes initialized to true.</p>\n</blockquote>\n<p>So given that, when that <code>input</code> event is fired, the <code>Event</code> constructor is used — because the caller doesn’t have a <em>“using”</em> statement.</p>\n<p>But the <code>input</code> event have an <code>InputEvent</code> constructor defined in the UI Events spec at https://w3c.github.io/uievents/#inputevent. Why doesn’t the HTML spec state that constructor must be used when firing the <code>input</code> event?</p>\n","m.mentions":{},"msgtype":"m.text"},"ts":1724997506698,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$Q80_3m6wD3jDHExxMqNBjyd3VF6LNgWfepHHXd4OQRY"},
{"content":{"body":" * Why does the HTML spec fire some events without their defined constructor?\n\nWhat I means is: When specifying firing of events, in some places in the spec it states the event constructor with _“using”,_ like this:\n\n> _fire an event named `hashchange` at document's relevant global object, **using `HashChangeEvent`**_\n\n…and in other places it’s stated without _“using”_\n\n> fire an event named `input` at the element, with the `bubbles` and `composed` attributes initialized to true.\n\nSo given that, when that `input` event is fired, the `Event` constructor is used — because the caller doesn’t have a _“using”_ statement.\n\nBut the `input` event have an `InputEvent` constructor defined in the UI Events spec at https://w3c.github.io/uievents/#inputevent. Why doesn’t the HTML spec state that constructor must be used when firing the `input` event?","format":"org.matrix.custom.html","formatted_body":" * <p>Why does the HTML spec fire some events without their defined constructor?</p>\n<p>What I means is: When specifying firing of events, in some places in the spec it states the event constructor with <em>“using”,</em> like this:</p>\n<blockquote>\n<p><em>fire an event named <code>hashchange</code> at document's relevant global object, <strong>using <code>HashChangeEvent</code></strong></em></p>\n</blockquote>\n<p>…and in other places it’s stated without <em>“using”</em></p>\n<blockquote>\n<p>fire an event named <code>input</code> at the element, with the <code>bubbles</code> and <code>composed</code> attributes initialized to true.</p>\n</blockquote>\n<p>So given that, when that <code>input</code> event is fired, the <code>Event</code> constructor is used — because the caller doesn’t have a <em>“using”</em> statement.</p>\n<p>But the <code>input</code> event have an <code>InputEvent</code> constructor defined in the UI Events spec at https://w3c.github.io/uievents/#inputevent. Why doesn’t the HTML spec state that constructor must be used when firing the <code>input</code> event?</p>\n","m.mentions":{},"m.new_content":{"body":"Why does the HTML spec fire some events without their defined constructor?\n\nWhat I means is: When specifying firing of events, in some places in the spec it states the event constructor with _“using”,_ like this:\n\n> _fire an event named `hashchange` at document's relevant global object, **using `HashChangeEvent`**_\n\n…and in other places it’s stated without _“using”_\n\n> fire an event named `input` at the element, with the `bubbles` and `composed` attributes initialized to true.\n\nSo given that, when that `input` event is fired, the `Event` constructor is used — because the caller doesn’t have a _“using”_ statement.\n\nBut the `input` event have an `InputEvent` constructor defined in the UI Events spec at https://w3c.github.io/uievents/#inputevent. Why doesn’t the HTML spec state that constructor must be used when firing the `input` event?","format":"org.matrix.custom.html","formatted_body":"<p>Why does the HTML spec fire some events without their defined constructor?</p>\n<p>What I means is: When specifying firing of events, in some places in the spec it states the event constructor with <em>“using”,</em> like this:</p>\n<blockquote>\n<p><em>fire an event named <code>hashchange</code> at document's relevant global object, <strong>using <code>HashChangeEvent</code></strong></em></p>\n</blockquote>\n<p>…and in other places it’s stated without <em>“using”</em></p>\n<blockquote>\n<p>fire an event named <code>input</code> at the element, with the <code>bubbles</code> and <code>composed</code> attributes initialized to true.</p>\n</blockquote>\n<p>So given that, when that <code>input</code> event is fired, the <code>Event</code> constructor is used — because the caller doesn’t have a <em>“using”</em> statement.</p>\n<p>But the <code>input</code> event have an <code>InputEvent</code> constructor defined in the UI Events spec at https://w3c.github.io/uievents/#inputevent. Why doesn’t the HTML spec state that constructor must be used when firing the <code>input</code> event?</p>\n","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$Q80_3m6wD3jDHExxMqNBjyd3VF6LNgWfepHHXd4OQRY","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1724997524585,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$mtyVuSNr1nZdWKR78rNrJGediByp99r3PaTa-jerYTI"},
{"content":{"body":"sideshowbarker: the default is `Event` - are you sure these cases use `InputEvent` in practice? (https://dom.spec.whatwg.org/#firing-events)","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@sideshowbarker:matrix.org\">sideshowbarker</a>: the default is <code>Event</code> - are you sure these cases use <code>InputEvent</code> in practice? (https://dom.spec.whatwg.org/#firing-events)","m.mentions":{"user_ids":["@sideshowbarker:matrix.org"]},"msgtype":"m.text"},"ts":1725000806945,"senderName":"Ms2ger","senderId":"@ms2ger:igalia.com","id":"$lSTXLaTIxL2AzmVPol0B1YvFFup6XPpd_om5Laabxgw"},
{"content":{"body":"sideshowbarker: https://software.hixie.ch/utilities/js/live-dom-viewer/saved/13038 - I suppose `InputEvent` is used for inputting text, and `Event` is used for other cases","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@sideshowbarker:matrix.org\">sideshowbarker</a>: https://software.hixie.ch/utilities/js/live-dom-viewer/saved/13038 - I suppose <code>InputEvent</code> is used for inputting text, and <code>Event</code> is used for other cases","m.mentions":{"user_ids":["@sideshowbarker:matrix.org"]},"msgtype":"m.text"},"ts":1725003487470,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$Tm7-PhEhsaCZB80UcboGlAmLpCFguQaP90pKHPRrvjw"},
{"content":{"body":"> <@ms2ger:igalia.com> sideshowbarker: the default is `Event` - are you sure these cases use `InputEvent` in practice? (https://dom.spec.whatwg.org/#firing-events)\n\nNo, I wasn’t sure — it just seemed odd that https://html.spec.whatwg.org/#text-(type=text)-state-and-search-state-(type=search):user-interaction-task-source has this:\n> [Queue an element task](https://html.spec.whatwg.org/#queue-an-element-task) on the [user interaction task source](https://html.spec.whatwg.org/#user-interaction-task-source) given the element to [fire an event](https://dom.spec.whatwg.org/#concept-event-fire) named [input](https://w3c.github.io/uievents/#event-type-input) at the element, with the [bubbles](https://dom.spec.whatwg.org/#dom-event-bubbles) and [composed](https://dom.spec.whatwg.org/#dom-event-composed) attributes initialized to true.\n…where [input](https://w3c.github.io/uievents/#event-type-input) is a link to the UI events definition of an `input` event with an `InputEvent`. But then despite that, the spec doesn’t state the event must be constructed with that `InputEvent` interface","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$lSTXLaTIxL2AzmVPol0B1YvFFup6XPpd_om5Laabxgw?via=matrix.org&via=mozilla.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@ms2ger:igalia.com\">@ms2ger:igalia.com</a><br><a href=\"https://matrix.to/#/@sideshowbarker:matrix.org\">sideshowbarker</a>: the default is <code>Event</code> - are you sure these cases use <code>InputEvent</code> in practice? (https://dom.spec.whatwg.org/#firing-events)</blockquote></mx-reply><p>No, I wasn’t sure — it just seemed odd that https://html.spec.whatwg.org/#text-(type=text)-state-and-search-state-(type=search):user-interaction-task-source has this:</p>\n<blockquote>\n<p><a href=\"https://html.spec.whatwg.org/#queue-an-element-task\">Queue an element task</a> on the <a href=\"https://html.spec.whatwg.org/#user-interaction-task-source\">user interaction task source</a> given the element to <a href=\"https://dom.spec.whatwg.org/#concept-event-fire\">fire an event</a> named <a href=\"https://w3c.github.io/uievents/#event-type-input\">input</a> at the element, with the <a href=\"https://dom.spec.whatwg.org/#dom-event-bubbles\">bubbles</a> and <a href=\"https://dom.spec.whatwg.org/#dom-event-composed\">composed</a> attributes initialized to true.<br>…where <a href=\"https://w3c.github.io/uievents/#event-type-input\">input</a> is a link to the UI events definition of an <code>input</code> event with an <code>InputEvent</code>. But then despite that, the spec doesn’t state the event must be constructed with that <code>InputEvent</code> interface</p>\n</blockquote>\n","m.mentions":{"user_ids":["@ms2ger:igalia.com"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$lSTXLaTIxL2AzmVPol0B1YvFFup6XPpd_om5Laabxgw"}},"msgtype":"m.text"},"ts":1725004124780,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$lJEc78QuBWvk2xp4N0XB69JH-BWWWN247LE0nqsjTe8"},
{"content":{"body":"> <@ms2ger:igalia.com> sideshowbarker: the default is `Event` - are you sure these cases use `InputEvent` in practice? (https://dom.spec.whatwg.org/#firing-events)\n\n * No, I wasn’t sure — it just seemed odd that https://html.spec.whatwg.org/#text-(type=text)-state-and-search-state-(type=search):user-interaction-task-source has this:\n\n> [Queue an element task](https://html.spec.whatwg.org/#queue-an-element-task) on the [user interaction task source](https://html.spec.whatwg.org/#user-interaction-task-source) given the element to [fire an event](https://dom.spec.whatwg.org/#concept-event-fire) named [input](https://w3c.github.io/uievents/#event-type-input) at the element, with the [bubbles](https://dom.spec.whatwg.org/#dom-event-bubbles) and [composed](https://dom.spec.whatwg.org/#dom-event-composed) attributes initialized to true.\n>\n…where [input](https://w3c.github.io/uievents/#event-type-input) is a link to the UI events definition of an `input` event with an `InputEvent`. But then despite that, the spec doesn’t state the event must be constructed with that `InputEvent` interface","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$lSTXLaTIxL2AzmVPol0B1YvFFup6XPpd_om5Laabxgw?via=matrix.org&amp;via=mozilla.org&amp;via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@ms2ger:igalia.com\">@ms2ger:igalia.com</a><br><a href=\"https://matrix.to/#/@sideshowbarker:matrix.org\">sideshowbarker</a>: the default is <code>Event</code> - are you sure these cases use <code>InputEvent</code> in practice? (https://dom.spec.whatwg.org/#firing-events)</blockquote></mx-reply> * <p>No, I wasn’t sure — it just seemed odd that https://html.spec.whatwg.org/#text-(type=text)-state-and-search-state-(type=search):user-interaction-task-source has this:</p>\n<blockquote>\n<p><a href=\"https://html.spec.whatwg.org/#queue-an-element-task\">Queue an element task</a> on the <a href=\"https://html.spec.whatwg.org/#user-interaction-task-source\">user interaction task source</a> given the element to <a href=\"https://dom.spec.whatwg.org/#concept-event-fire\">fire an event</a> named <a href=\"https://w3c.github.io/uievents/#event-type-input\">input</a> at the element, with the <a href=\"https://dom.spec.whatwg.org/#dom-event-bubbles\">bubbles</a> and <a href=\"https://dom.spec.whatwg.org/#dom-event-composed\">composed</a> attributes initialized to true.</p>\n</blockquote>\n<p>…where <a href=\"https://w3c.github.io/uievents/#event-type-input\">input</a> is a link to the UI events definition of an <code>input</code> event with an <code>InputEvent</code>. But then despite that, the spec doesn’t state the event must be constructed with that <code>InputEvent</code> interface</p>\n","m.mentions":{},"m.new_content":{"body":"No, I wasn’t sure — it just seemed odd that https://html.spec.whatwg.org/#text-(type=text)-state-and-search-state-(type=search):user-interaction-task-source has this:\n\n> [Queue an element task](https://html.spec.whatwg.org/#queue-an-element-task) on the [user interaction task source](https://html.spec.whatwg.org/#user-interaction-task-source) given the element to [fire an event](https://dom.spec.whatwg.org/#concept-event-fire) named [input](https://w3c.github.io/uievents/#event-type-input) at the element, with the [bubbles](https://dom.spec.whatwg.org/#dom-event-bubbles) and [composed](https://dom.spec.whatwg.org/#dom-event-composed) attributes initialized to true.\n>\n…where [input](https://w3c.github.io/uievents/#event-type-input) is a link to the UI events definition of an `input` event with an `InputEvent`. But then despite that, the spec doesn’t state the event must be constructed with that `InputEvent` interface","format":"org.matrix.custom.html","formatted_body":"<p>No, I wasn’t sure — it just seemed odd that https://html.spec.whatwg.org/#text-(type=text)-state-and-search-state-(type=search):user-interaction-task-source has this:</p>\n<blockquote>\n<p><a href=\"https://html.spec.whatwg.org/#queue-an-element-task\">Queue an element task</a> on the <a href=\"https://html.spec.whatwg.org/#user-interaction-task-source\">user interaction task source</a> given the element to <a href=\"https://dom.spec.whatwg.org/#concept-event-fire\">fire an event</a> named <a href=\"https://w3c.github.io/uievents/#event-type-input\">input</a> at the element, with the <a href=\"https://dom.spec.whatwg.org/#dom-event-bubbles\">bubbles</a> and <a href=\"https://dom.spec.whatwg.org/#dom-event-composed\">composed</a> attributes initialized to true.</p>\n</blockquote>\n<p>…where <a href=\"https://w3c.github.io/uievents/#event-type-input\">input</a> is a link to the UI events definition of an <code>input</code> event with an <code>InputEvent</code>. But then despite that, the spec doesn’t state the event must be constructed with that <code>InputEvent</code> interface</p>\n","m.mentions":{"user_ids":["@ms2ger:igalia.com"]},"msgtype":"m.text"},"m.relates_to":{"event_id":"$lJEc78QuBWvk2xp4N0XB69JH-BWWWN247LE0nqsjTe8","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1725004135544,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$Syr1LRIAmQ1pUQwUKvGmLjrJvYaZ1fYUrIo2QREdcq8"},
{"content":{"body":"Ugh, that's needlessly confusing. https://html.spec.whatwg.org/multipage/indices.html#events-2 does say it uses Event, though","m.mentions":{},"msgtype":"m.text"},"ts":1725004245194,"senderName":"Ms2ger","senderId":"@ms2ger:igalia.com","id":"$VGdmUC6HHtg4c6fRVAvkdR0p2fDqHrFcwWdIkDrrcmY"},
{"content":{"body":"Seems worth an issue","m.mentions":{},"msgtype":"m.text"},"ts":1725004298385,"senderName":"Ms2ger","senderId":"@ms2ger:igalia.com","id":"$qDAZhLM3Sew3CJasof6AJSB9bYGGm8F3lp3S9bCNMe0"},
{"content":{"body":"https://html.spec.whatwg.org/#fetching-and-processing-a-resource-from-a-link-element says \"They also have linked resource fetch setup steps which ..., but unless explicitly stated, they use the default fetch and process the linked resource algorithm.\".  How can I see which (or what kind of) case uses the \"default\" one and which case doesn't?  Is there a list of \"non-default\" cases?  I'm currently trying to figure out how `<link rel=\"stylesheet\" ...>` interacts with cache, and investigating how things work in general as a first step.","format":"org.matrix.custom.html","formatted_body":"https://html.spec.whatwg.org/#fetching-and-processing-a-resource-from-a-link-element says \"They also have linked resource fetch setup steps which ..., but unless explicitly stated, they use the default fetch and process the linked resource algorithm.\".  How can I see which (or what kind of) case uses the \"default\" one and which case doesn't?  Is there a list of \"non-default\" cases?  I'm currently trying to figure out how <code>&lt;link rel=\"stylesheet\" ...&gt;</code> interacts with cache, and investigating how things work in general as a first step.","m.mentions":{},"msgtype":"m.text"},"ts":1725008555768,"senderName":"arai","senderId":"@arai:mozilla.org","id":"$d49QMOKqup5StCACLg0CcBYGWJN8PZ3lTueua1_eWps"},
{"content":{"body":"oh, looks like clicking the \" linked resource fetch setup steps\" text shows a popup with references, and there are 3 cases (icon/manifest/stylesheet) listed.  is that all?  or can there be any other cases?","m.mentions":{},"msgtype":"m.text"},"ts":1725008734730,"senderName":"arai","senderId":"@arai:mozilla.org","id":"$K1fn8bhcgrJ3P1d7ZvqHSNGKBLMKxzMwtmPpz9E0P2E"},
{"content":{"body":"arai: that should be exhaustive","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@arai:mozilla.org\">arai</a>: that should be exhaustive","m.mentions":{"user_ids":["@arai:mozilla.org"]},"msgtype":"m.text"},"ts":1725008808432,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$A-XS_LrlDYB7QuBnZIfdZXirSHAk3tpISnCBaCkFQjg"},
{"content":{"body":"okay, thank you :D","m.mentions":{},"msgtype":"m.text"},"ts":1725008821914,"senderName":"arai","senderId":"@arai:mozilla.org","id":"$VS3Yi9zr_XJkMhBIjEFZPDKoAnLpjJuukzAtLuE03Lg"},
{"content":{"body":"So I notice that the Event code in WebKit sets `isTrusted` (to true by default) in the Event _constructor_ — despite the DOM spec making a clear distinction between the “constructing an event” operation and the “creating an event” operation. And the spec states that that `isTrusted` is set to true in the “creating an event” operation, not in the constructing an event” operation.\n\nNevertheless, it’d seem like the observable behavior in WebKit must be conforming to the spec — since WebKit passes whatever the relevant tests in WPT are.\n\nSo… Is it actually expected that setting `isTrusted` in the Event constructor will have the same observable effect at setting in the implementation of the “create an event” operation? And if so, the separation about where `isTrusted` is set is something that exists in the spec for some reason but doesn’t actually get exercised in practice by all calling operations?","format":"org.matrix.custom.html","formatted_body":"<p>So I notice that the Event code in WebKit sets <code>isTrusted</code> (to true by default) in the Event <em>constructor</em> — despite the DOM spec making a clear distinction between the “constructing an event” operation and the “creating an event” operation. And the spec states that that <code>isTrusted</code> is set to true in the “creating an event” operation, not in the constructing an event” operation.</p>\n<p>Nevertheless, it’d seem like the observable behavior in WebKit must be conforming to the spec —&nbsp;since WebKit passes whatever the relevant tests in WPT are.</p>\n<p>So… Is it actually expected that setting <code>isTrusted</code> in the Event constructor will have the same observable effect at setting in the implementation of the “create an event” operation? And if so, the separation about where <code>isTrusted</code> is set is something that exists in the spec for some reason but doesn’t actually get exercised in practice by all calling operations?</p>\n","m.mentions":{},"msgtype":"m.text"},"ts":1725010050957,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$Dygz16F6d7kBmr7Jd0XJtHDSrhz8YXsbcieSHRJdhrs"},
{"content":{"body":"Relevant part of the DOM spec is <https://dom.spec.whatwg.org/#constructing-events>","format":"org.matrix.custom.html","formatted_body":"Relevant part of the DOM spec is <a href=\"https://dom.spec.whatwg.org/#constructing-events\">https://dom.spec.whatwg.org/#constructing-events</a>","m.mentions":{},"msgtype":"m.text"},"ts":1725010095924,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$heUMsz18KXVsXajv4o0jlVmSgpJE8sLmsbjQOrCnSME"},
{"content":{"body":" * So I notice that the Event code in WebKit sets `isTrusted` (to true by default) in the Event _constructor_ — despite the DOM spec making a clear distinction between the “constructing an event” operation and the “creating an event” operation. And the spec states that that `isTrusted` is set to true in the “creating an event” operation, not in the “constructing an event” operation.\n\nNevertheless, it’d seem like the observable behavior in WebKit must be conforming to the spec — since WebKit passes whatever the relevant tests in WPT are.\n\nSo… Is it actually expected that setting `isTrusted` in the Event constructor will have the same observable effect at setting in the implementation of the “create an event” operation? And if so, the separation about where `isTrusted` is set is something that exists in the spec for some reason but doesn’t actually get exercised in practice by all calling operations?","format":"org.matrix.custom.html","formatted_body":" * <p>So I notice that the Event code in WebKit sets <code>isTrusted</code> (to true by default) in the Event <em>constructor</em> — despite the DOM spec making a clear distinction between the “constructing an event” operation and the “creating an event” operation. And the spec states that that <code>isTrusted</code> is set to true in the “creating an event” operation, not in the “constructing an event” operation.</p>\n<p>Nevertheless, it’d seem like the observable behavior in WebKit must be conforming to the spec —&nbsp;since WebKit passes whatever the relevant tests in WPT are.</p>\n<p>So… Is it actually expected that setting <code>isTrusted</code> in the Event constructor will have the same observable effect at setting in the implementation of the “create an event” operation? And if so, the separation about where <code>isTrusted</code> is set is something that exists in the spec for some reason but doesn’t actually get exercised in practice by all calling operations?</p>\n","m.mentions":{},"m.new_content":{"body":"So I notice that the Event code in WebKit sets `isTrusted` (to true by default) in the Event _constructor_ — despite the DOM spec making a clear distinction between the “constructing an event” operation and the “creating an event” operation. And the spec states that that `isTrusted` is set to true in the “creating an event” operation, not in the “constructing an event” operation.\n\nNevertheless, it’d seem like the observable behavior in WebKit must be conforming to the spec — since WebKit passes whatever the relevant tests in WPT are.\n\nSo… Is it actually expected that setting `isTrusted` in the Event constructor will have the same observable effect at setting in the implementation of the “create an event” operation? And if so, the separation about where `isTrusted` is set is something that exists in the spec for some reason but doesn’t actually get exercised in practice by all calling operations?","format":"org.matrix.custom.html","formatted_body":"<p>So I notice that the Event code in WebKit sets <code>isTrusted</code> (to true by default) in the Event <em>constructor</em> — despite the DOM spec making a clear distinction between the “constructing an event” operation and the “creating an event” operation. And the spec states that that <code>isTrusted</code> is set to true in the “creating an event” operation, not in the “constructing an event” operation.</p>\n<p>Nevertheless, it’d seem like the observable behavior in WebKit must be conforming to the spec —&nbsp;since WebKit passes whatever the relevant tests in WPT are.</p>\n<p>So… Is it actually expected that setting <code>isTrusted</code> in the Event constructor will have the same observable effect at setting in the implementation of the “create an event” operation? And if so, the separation about where <code>isTrusted</code> is set is something that exists in the spec for some reason but doesn’t actually get exercised in practice by all calling operations?</p>\n","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$Dygz16F6d7kBmr7Jd0XJtHDSrhz8YXsbcieSHRJdhrs","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1725010125177,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$yCp5VupGOzrrMvtO2tvbo9_Bl7ln261_UbeomPufOHI"},
{"content":{"body":"I ask this because I have found that in writing a new implementation, it‘s a lot easier, implementation-wise, to set `isTrusted` in the code for the Event::Event constructor than it is to set in and Event::create code (“create an event” operation) — which I can imagine is the reason why WebKit implemented that way","format":"org.matrix.custom.html","formatted_body":"I ask this because I have found that in writing a new implementation, it‘s a lot easier, implementation-wise, to set <code>isTrusted</code> in the code for the Event::Event constructor than it is to set in and Event::create code (“create an event” operation) —&nbsp;which I can imagine is the reason why WebKit implemented that way","m.mentions":{},"msgtype":"m.text"},"ts":1725010280007,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$BJK7suB1bkonllIzCAbXE-hpgAOcYkpjMqY3wcg7Tz4"},
{"content":{"body":"Though I can also imagine it was implemented that way in WebKit in a time long ago — and maybe before this separation between the operations existed in the DOM spec, which perhaps got added later","m.mentions":{},"msgtype":"m.text"},"ts":1725010388665,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$CQodLi0rYM-3GIag9U8oiKHBNLzEUuj9s8duwvrE7S4"},
{"content":{"body":" * I ask this because I have found that in writing a new implementation, it‘s a lot easier, implementation-wise, to set `isTrusted` in the code for the Event::Event constructor than it is to set in and Event::create code (“create an event” operation) — which I can imagine is the reason why WebKit implemented that way","format":"org.matrix.custom.html","formatted_body":" * I ask this because I have found that in writing a new implementation, it‘s a lot easier, implementation-wise, to set <code>isTrusted</code> in the code for the Event::Event constructor than it is to set in and Event::create code (“create an event” operation)&nbsp;—&nbsp;which I can imagine is the reason why WebKit implemented that way","m.mentions":{},"m.new_content":{"body":"I ask this because I have found that in writing a new implementation, it‘s a lot easier, implementation-wise, to set `isTrusted` in the code for the Event::Event constructor than it is to set in and Event::create code (“create an event” operation) — which I can imagine is the reason why WebKit implemented that way","format":"org.matrix.custom.html","formatted_body":"I ask this because I have found that in writing a new implementation, it‘s a lot easier, implementation-wise, to set <code>isTrusted</code> in the code for the Event::Event constructor than it is to set in and Event::create code (“create an event” operation)&nbsp;—&nbsp;which I can imagine is the reason why WebKit implemented that way","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$BJK7suB1bkonllIzCAbXE-hpgAOcYkpjMqY3wcg7Tz4","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1725010426337,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$3WcYgy9EqhndGoHS42UhHHWxW_2udH6pT8Wa6oBEIVQ"},
{"content":{"body":"I think it's not observable","m.mentions":{},"msgtype":"m.text"},"ts":1725010584723,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$t3HUa4ecfY4Ww5CoJ0Am-wh_E09JyPC06UDbfc_ld6A"},
{"content":{"body":"OK","m.mentions":{},"msgtype":"m.text"},"ts":1725010595610,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$sY3x3ULiBLFzUtxsyT-Tk6U_V8BNAVAMQ_9NOW_EE70"},
{"content":{"body":"https://software.hixie.ch/utilities/js/live-dom-viewer/?%3Cscript%3E%0Aw(new%20Event(%27x%27).isTrusted)%0A%3C%2Fscript%3E shows it as false, so I suspect what WebKit does is a bit more involved.","m.mentions":{},"msgtype":"m.text"},"ts":1725010627516,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$VjnYCY-Oymdk_Q1bN9PLnj3KAglfwZiZ6nVOu9xmC7k"},
{"content":{"body":"It’s false for synthetic events","m.mentions":{},"msgtype":"m.text"},"ts":1725010657872,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$7JrjgAgvgF3kyaFd9WA5ZSi2jzlDf3lZEatEshkEhhU"},
{"content":{"body":"So in cases where it‘s false in WebKit, the calling code must be setting it to false when constructing","m.mentions":{},"msgtype":"m.text"},"ts":1725010714787,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$gzB1pQBsV7jcFAk5e5CZ3UHp6dApShr-aS5-p_oya04"},
{"content":{"body":"Not sure what you mean by constructor if that case doesn't cover it.","m.mentions":{},"msgtype":"m.text"},"ts":1725010723579,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$9fstL-eCclQL1xf2MKJk6-ghEozFTvDL769eAuB1aPg"},
{"content":{"body":"I guess I could step through it in a debugger in a WebKit build and see","m.mentions":{},"msgtype":"m.text"},"ts":1725010955349,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$VeviRq3RcpzyOkH34LN9-fIXx-eNSDxDj7rCQ2Rm9sc"},
{"content":{"body":"But to put more a bit more context on why I’m asking: For Ladybird, because the project has a policy that the spec requirements should be followed as closely as possible: I’m trying to decide if I should _try_ to implement it strictly the way the spec states it happens — in the “create an event” operation — whether there’s some observable benefit to implementing it that way vs the additional cost/complication which comes from following the spec strictly in this case","format":"org.matrix.custom.html","formatted_body":"But to put more a bit more context on why I’m asking: For Ladybird, because the project has a policy that the spec requirements should be followed as closely as possible: I’m trying to decide if I should <em>try</em> to implement it strictly the way the spec states it&nbsp;happens — in the “create an event” operation — whether there’s some observable benefit to implementing it that way vs the additional cost/complication which comes from following the spec strictly in this case","m.mentions":{},"msgtype":"m.text"},"ts":1725011170660,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$72KAefulwfkdjQUErlHiwZDRr3DFZgG-HZVAbFBEg8c"},
{"content":{"body":"And I mean, assuming I figure out how to get `new Event('x')` to end up setting `isTrusted` to false, the way WebKit manages to","format":"org.matrix.custom.html","formatted_body":"And I mean, assuming I figure out how to get <code>new Event('x')</code> to end up setting <code>isTrusted</code> to false, the way WebKit manages to","m.mentions":{},"msgtype":"m.text"},"ts":1725011560346,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$XSeWA9F6X3ieKycJxVj6AOj_mcHEJr_cdni9I9V1vaY"},
{"content":{"body":"`static Ref<Event> create(const AtomString& type, const EventInit&, IsTrusted = IsTrusted::No);` What makes you think it defaults to true?","format":"org.matrix.custom.html","formatted_body":"<code>static Ref&lt;Event&gt; create(const AtomString&amp; type, const EventInit&amp;, IsTrusted = IsTrusted::No);</code> What makes you think it defaults to true?","m.mentions":{},"msgtype":"m.text"},"ts":1725011679022,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$kpahcbTZSzwc2SoP5UeAHJE4yYfEq2I42rhu7gMJMWc"},
{"content":{"body":"Because in the constructor code at  https://github.com/WebKit/WebKit/blob/e4d6852ee20ff3dfcd3a59fe241d84f662abb234/Source/WebCore/dom/Event.cpp#L45-L55 I see:\n\n```c++\n, m_isTrusted { isTrusted == IsTrusted::Yes }\n```\n\n…and the `create` signatures I see are:\n\n```\nRef<Event> Event::create(const AtomString& type, CanBubble canBubble, IsCancelable isCancelable, IsComposed isComposed)\n{\n    return adoptRef(*new Event(EventInterfaceType::Event, type, canBubble, isCancelable, isComposed));\n}\n```\n…so if that’s called, then it defaults to `IsTrusted::Yes`\n\nAnd then the other `create` signature is:\n\n```\nRef<Event> Event::create(const AtomString& type, const EventInit& initializer, IsTrusted isTrusted)\n{\n    return adoptRef(*new Event(EventInterfaceType::Event, type, initializer, isTrusted));\n}\n```\n\n…for callers that need to set `IsTrusted::No`","format":"org.matrix.custom.html","formatted_body":"<p>Because in the constructor code at  https://github.com/WebKit/WebKit/blob/e4d6852ee20ff3dfcd3a59fe241d84f662abb234/Source/WebCore/dom/Event.cpp#L45-L55 I see:</p>\n<pre><code class=\"language-c++\">, m_isTrusted { isTrusted == IsTrusted::Yes }\n</code></pre>\n<p>…and the <code>create</code> signatures I see are:</p>\n<pre><code>Ref&lt;Event&gt; Event::create(const AtomString&amp; type, CanBubble canBubble, IsCancelable isCancelable, IsComposed isComposed)\n{\n    return adoptRef(*new Event(EventInterfaceType::Event, type, canBubble, isCancelable, isComposed));\n}\n</code></pre>\n<p>…so if that’s called, then it defaults to <code>IsTrusted::Yes</code></p>\n<p>And then the other <code>create</code> signature is:</p>\n<pre><code>Ref&lt;Event&gt; Event::create(const AtomString&amp; type, const EventInit&amp; initializer, IsTrusted isTrusted)\n{\n    return adoptRef(*new Event(EventInterfaceType::Event, type, initializer, isTrusted));\n}\n</code></pre>\n<p>…for callers that need to set <code>IsTrusted::No</code></p>\n","m.mentions":{},"msgtype":"m.text"},"ts":1725014506352,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$aePMgqZPal3tY50siPaMRQEdR2PXNoUOQQ-AfdK4b1E"},
{"content":{"body":"There are indeed various defaults so it depends which internal constructor you call. However, note that `m_isTrusted { isTrusted == IsTrusted::Yes }` is not itself not setting a default. It just sets it to whatever the value of `isTrusted` is. It's a way to convert from a class enum to a boolean.","format":"org.matrix.custom.html","formatted_body":"There are indeed various defaults so it depends which internal constructor you call. However, note that <code>m_isTrusted { isTrusted == IsTrusted::Yes }</code> is not itself not setting a default. It just sets it to whatever the value of <code>isTrusted</code> is. It's a way to convert from a class enum to a boolean.","m.mentions":{},"msgtype":"m.text"},"ts":1725016118987,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$a1Kfu08ZjWEzMu4SzPhG2wivTrr5SuqSQSWIkYQhw7A"},
{"content":{"body":" * There are indeed various defaults so it depends which internal constructor you call. However, note that `m_isTrusted { isTrusted == IsTrusted::Yes }` is not setting a default. It just sets `m_isTrusted` to whatever the value of `isTrusted` is. It's a way to convert from a class enum to a boolean.","format":"org.matrix.custom.html","formatted_body":" * There are indeed various defaults so it depends which internal constructor you call. However, note that <code>m_isTrusted { isTrusted == IsTrusted::Yes }</code> is not setting a default. It just sets <code>m_isTrusted</code> to whatever the value of <code>isTrusted</code> is. It's a way to convert from a class enum to a boolean.","m.mentions":{},"m.new_content":{"body":"There are indeed various defaults so it depends which internal constructor you call. However, note that `m_isTrusted { isTrusted == IsTrusted::Yes }` is not setting a default. It just sets `m_isTrusted` to whatever the value of `isTrusted` is. It's a way to convert from a class enum to a boolean.","format":"org.matrix.custom.html","formatted_body":"There are indeed various defaults so it depends which internal constructor you call. However, note that <code>m_isTrusted { isTrusted == IsTrusted::Yes }</code> is not setting a default. It just sets <code>m_isTrusted</code> to whatever the value of <code>isTrusted</code> is. It's a way to convert from a class enum to a boolean.","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$a1Kfu08ZjWEzMu4SzPhG2wivTrr5SuqSQSWIkYQhw7A","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1725016147444,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$ROKTS-FtIpGVQDtY02whFWQBgkZ2M4DXlK1-lHYt4Xo"},
{"content":{"body":"I see","m.mentions":{},"msgtype":"m.text"},"ts":1725016750559,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$0Uauv0MR4OqCD9ylvf30LXazTTEqxXm5kxGf_qedVjY"},
{"content":{"body":"Luca Casonato: regarding https://github.com/whatwg/html/pull/10593 , how does tihs interact with the closebehavior/closedby etc. proposed for https://github.com/whatwg/html/issues/9373 ?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@lucacasonato:matrix.org\">Luca Casonato</a>: regarding https://github.com/whatwg/html/pull/10593 , how does tihs interact with the closebehavior/closedby etc. proposed for https://github.com/whatwg/html/issues/9373 ?","m.mentions":{"user_ids":["@lucacasonato:matrix.org"]},"msgtype":"m.text"},"ts":1725035951791,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$78QVCFYwS7iD0jNdiEnOmYiOOm8bgyfONIIYy16YG9g"},
{"content":{"body":"I guess I should ask this question on the issue since I am about to go to lunch","m.mentions":{},"msgtype":"m.text"},"ts":1725035986218,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$5AnlfsJ6ufY8fJKodhjjWNZqHm7hjNFeqMq1kG5dD54"},
{"content":{"body":"Domenic: I've got a question about this line right here: https://streams.spec.whatwg.org/#readable-stream-from-iterable:~:text=Let%20nextPromise%20be%20a%20promise%20resolved%20with%20nextResult.%5B%5BValue%5D%5D. nextResult.[[Value]] is expected to be a Promise, right? But we wrap it in a Promise just in case it's not a Promise, so that reacting to it is always async? Is that right?","m.mentions":{},"msgtype":"m.text"},"ts":1725043937703,"senderName":"Dominic Farolino","senderId":"@domfarolino:matrix.org","id":"$i-Beg8C1LpoNj2rkeTKuEZ36J-IOTMOxHHPTcO297lI"},
{"content":{"body":" * Domenic:  I've got a question about this line right here: https://streams.spec.whatwg.org/#readable-stream-from-iterable:~:text=Let%20nextPromise%20be%20a%20promise%20resolved%20with%20nextResult.%5B%5BValue%5D%5D. nextResult.\\[\\[Value\\]\\] is expected to be a Promise, right? But we wrap it in a Promise just in case it's not a Promise, so that reacting to it is always async? Is that right?","format":"org.matrix.custom.html","formatted_body":" * <a href=\"https://matrix.to/#/@domenicdenicola:matrix.org\">Domenic</a>:  I've got a question about this line right here: https://streams.spec.whatwg.org/#readable-stream-from-iterable:~:text=Let%20nextPromise%20be%20a%20promise%20resolved%20with%20nextResult.%5B%5BValue%5D%5D. nextResult.[[Value]] is expected to be a Promise, right? But we wrap it in a Promise just in case it's not a Promise, so that reacting to it is always async? Is that right?","m.mentions":{"user_ids":["@domenicdenicola:matrix.org"]},"m.new_content":{"body":"Domenic:  I've got a question about this line right here: https://streams.spec.whatwg.org/#readable-stream-from-iterable:~:text=Let%20nextPromise%20be%20a%20promise%20resolved%20with%20nextResult.%5B%5BValue%5D%5D. nextResult.\\[\\[Value\\]\\] is expected to be a Promise, right? But we wrap it in a Promise just in case it's not a Promise, so that reacting to it is always async? Is that right?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@domenicdenicola:matrix.org\">Domenic</a>:  I've got a question about this line right here: https://streams.spec.whatwg.org/#readable-stream-from-iterable:~:text=Let%20nextPromise%20be%20a%20promise%20resolved%20with%20nextResult.%5B%5BValue%5D%5D. nextResult.[[Value]] is expected to be a Promise, right? But we wrap it in a Promise just in case it's not a Promise, so that reacting to it is always async? Is that right?","m.mentions":{"user_ids":["@domenicdenicola:matrix.org"]},"msgtype":"m.text"},"m.relates_to":{"event_id":"$i-Beg8C1LpoNj2rkeTKuEZ36J-IOTMOxHHPTcO297lI","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1725044612626,"senderName":"Dominic Farolino","senderId":"@domfarolino:matrix.org","id":"$7ZlSnFdv0wFkP8yl6ZsmAwBNKnoO-MS0TASGAcR_Fn8"},
{"content":{"body":"I believe that's right. That sort of wrapping is pretty pervasive when dealing with potentially-user code.","m.mentions":{},"msgtype":"m.text"},"ts":1725044786859,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$b3gY4b6sSTRxMyrKHOSQrpPuEwxc5rk6qZqTVtdE0nI"}
]