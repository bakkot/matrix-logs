[
{"content":{"body":"annevk: About https://github.com/WebKit/WebKit/pull/19093, I hope to add a spec citation to the code comment and commit message — citing whatever spec statement requires setting the `Referer` of a request initiated by `location.replace()` call on an `iframe`","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@annevk:matrix.org\">annevk</a>: About https://github.com/WebKit/WebKit/pull/19093, I hope to add a spec citation to the code comment and commit message — citing whatever spec statement requires setting the <code>Referer</code> of a request initiated by <code>location.replace()</code> call on an <code>iframe</code>","m.mentions":{"user_ids":["@annevk:matrix.org"]},"msgtype":"m.text"},"ts":1697364107499,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$Gd9Nd88Q1qbo2ntyLaE4vsAMajoGJnAoRz2fxXG4Wrc"},
{"content":{"body":" * annevk: About https://github.com/WebKit/WebKit/pull/19093, I hope to add a spec citation to the code comment and commit message — citing whatever spec statement requires setting the `Referer` of a request initiated by a `location.replace()` call on an `iframe`","format":"org.matrix.custom.html","formatted_body":" * <a href=\"https://matrix.to/#/@annevk:matrix.org\">annevk</a>: About https://github.com/WebKit/WebKit/pull/19093, I hope to add a spec citation to the code comment and commit message — citing whatever spec statement requires setting the <code>Referer</code> of a request initiated by a <code>location.replace()</code> call on an <code>iframe</code>","m.mentions":{},"m.new_content":{"body":"annevk: About https://github.com/WebKit/WebKit/pull/19093, I hope to add a spec citation to the code comment and commit message — citing whatever spec statement requires setting the `Referer` of a request initiated by a `location.replace()` call on an `iframe`","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@annevk:matrix.org\">annevk</a>: About https://github.com/WebKit/WebKit/pull/19093, I hope to add a spec citation to the code comment and commit message — citing whatever spec statement requires setting the <code>Referer</code> of a request initiated by a <code>location.replace()</code> call on an <code>iframe</code>","m.mentions":{"user_ids":["@annevk:matrix.org"]},"msgtype":"m.text"},"m.relates_to":{"event_id":"$Gd9Nd88Q1qbo2ntyLaE4vsAMajoGJnAoRz2fxXG4Wrc","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1697364136270,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$aH1wIa4balXiOj4lBvHYiX79pex_k_ytkfuR8KQTyW8"},
{"content":{"body":"sideshowbarker: I'm pretty sure it's derived from _sourceDocument_. I've done an initial review and provided a pointer.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@sideshowbarker:matrix.org\">sideshowbarker</a>: I'm pretty sure it's derived from <em>sourceDocument</em>. I've done an initial review and provided a pointer.","m.mentions":{"user_ids":["@sideshowbarker:matrix.org"]},"msgtype":"m.text"},"ts":1697379293118,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$UGbcqCDZXlxxrWCM3onfU1gZWdzgTp0U3rKobfqxLBs"},
{"content":{"body":"annevk: In the WebKit sources, the first parameter to all the public `Location` member functions is named `incumbentWindow` — _except_ in the case of `assign()` and `replace()` and `reload()`, where for some reason it’s instead named `activeWindow`. But in all cases — for all those `Location` member functions —  it seems to be the same `LocalDOMWindow` that’s getting passed in.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@annevk:matrix.org\">annevk</a>: In the WebKit sources, the first parameter to all the public <code>Location</code> member functions is named <code>incumbentWindow</code> — <em>except</em> in the case of <code>assign()</code> and <code>replace()</code> and <code>reload()</code>, where for some reason it’s instead named <code>activeWindow</code>. But in all cases — for all those <code>Location</code> member functions —&nbsp; it seems to be the same <code>LocalDOMWindow</code> that’s getting passed in.","m.mentions":{"user_ids":["@annevk:matrix.org"]},"msgtype":"m.text"},"ts":1697380226992,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$BKolqpjwc2rurNMHg6sbYvIaBPpihV8Q4jyF8MIlP7k"},
{"content":{"body":"…and that gets passed on to `setLocation()` (in the cases of the functions that cases that lead to the location getting set)","format":"org.matrix.custom.html","formatted_body":"…and that gets passed on to <code>setLocation()</code> (in the cases of the functions that cases that lead to the location getting set)","m.mentions":{},"msgtype":"m.text"},"ts":1697380288766,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$CW82eg9xOUopf24fQsJ5AcQ8t_jOMoaA5PyOcYidF8c"},
{"content":{"body":"sideshowbarker: that would suggest it's not the parent either, but it's the document itself that's the referrer, no?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@sideshowbarker:matrix.org\">sideshowbarker</a>: that would suggest it's not the parent either, but it's the document itself that's the referrer, no?","m.mentions":{"user_ids":["@sideshowbarker:matrix.org"]},"msgtype":"m.text"},"ts":1697380291959,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$IpSXnO_-rE5_JK2iRZUi1-9CVv8BZvIjkIbzlkhiX1k"},
{"content":{"body":"sideshowbarker: matching that seems like a reasonable MVP, figuring out incumbent some unattainable v2 :p","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@sideshowbarker:matrix.org\">sideshowbarker</a>: matching that seems like a reasonable MVP, figuring out incumbent some unattainable v2 :p","m.mentions":{"user_ids":["@sideshowbarker:matrix.org"]},"msgtype":"m.text"},"ts":1697380326414,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$e-1vfzWyOx8Kmw1yJPipxJfnNQGt0P8JfQNOq1gO7w0"},
{"content":{"body":"Yeah the Location code overall doesn’t seem to map directly to the spec — it doesn’t clearly use the same abstractions as defined in the spec — so it’s it a bit hard to understand sometimes what exactly it’s operating in, in terms of the spec.","m.mentions":{},"msgtype":"m.text"},"ts":1697380528806,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$8e9CZmPBtPYjh-6YUVMvYhP4WtozrO3HfbAOoq7BTOQ"},
{"content":{"body":"And until recently the code was not even getting the location from a Window but instead from a Frame — which appears to be what the code uses for representing a browsing context.","m.mentions":{},"msgtype":"m.text"},"ts":1697380650529,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$6kXQZ6PYq7blHOcNmaiOarXs4AG41LwTFDVbxfvF1dQ"}
]