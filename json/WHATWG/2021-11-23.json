[
{"content":{"body":"Domenic: should https://github.com/web-platform-tests/wpt/blob/628af0fd55db95d785a63484882998343e3a069e/html/semantics/interactive-elements/the-dialog-element/dialog-focus-shadow.html#L40-L47 focus an element inside the shadow dom?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@domenicdenicola:matrix.org\">Domenic</a>: should https://github.com/web-platform-tests/wpt/blob/628af0fd55db95d785a63484882998343e3a069e/html/semantics/interactive-elements/the-dialog-element/dialog-focus-shadow.html#L40-L47 focus an element inside the shadow dom?","msgtype":"m.text"},"ts":1637633861584,"senderName":"sefeng","senderId":"@sefeng:mozilla.org","id":"$k8D-frig1S9NHzrrtxgM4rcrCEb0YVPkeRxghv9plEY"},
{"content":{"body":"because the shadow dom is before the `focus-me`?","format":"org.matrix.custom.html","formatted_body":"because the shadow dom is before the <code>focus-me</code>?","msgtype":"m.text"},"ts":1637633937980,"senderName":"sefeng","senderId":"@sefeng:mozilla.org","id":"$DMbKJ8g7PPx_K8a7sqTNKEVQxV8Yxf74lliSKonW6sw"},
{"content":{"body":"sefeng: Yes I think you are right","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@sefeng:mozilla.org\">sefeng</a>: Yes I think you are right","msgtype":"m.text"},"ts":1637633980808,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$Ff_sdTk-yZrl61RRgfQU9K3vbffbJtB1liFdl3kxUzY"},
{"content":{"body":"focus-me should be moved to the very first button","msgtype":"m.text"},"ts":1637634002853,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$N0TeNJJfcXlWQGGgBme0eI3UoZtyDXXNXtEse1pEMAc"},
{"content":{"body":"Domenic: we don't need to move this one, because the one before this template does that already, I think?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@domenicdenicola:matrix.org\">Domenic</a>: we don't need to move this one, because the one before this template does that already, I think?","msgtype":"m.text"},"ts":1637634063230,"senderName":"sefeng","senderId":"@sefeng:mozilla.org","id":"$hMzOj9mg6HfCMxgVtuEd1DyDv2WBW97Jqpmy_mQ84d0"},
{"content":{"body":"Not sure what you mean? I think the test would still be valuable since it shows that autofocus=\"\" is ignored","msgtype":"m.text"},"ts":1637634132154,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$-4qfeu_9oCl1axD1ewkdDIR-DMsFyMX9mIwVKuRcZPM"},
{"content":{"body":"yeah, sorry, I misunderstood ","msgtype":"m.text"},"ts":1637634147095,"senderName":"sefeng","senderId":"@sefeng:mozilla.org","id":"$b45i1J5D4-cnr2f2Nc0Erpa_Hv2ghUkZ2N8bwoMMfHU"},
{"content":{"body":"I'll fix it and ping you for review ","msgtype":"m.text"},"ts":1637634170384,"senderName":"sefeng","senderId":"@sefeng:mozilla.org","id":"$huEN6YFda0yhrwpXKj0fxo2JV55q72mZtbyCRynbUFo"},
{"content":{"body":"Great, thank you for spotting!","msgtype":"m.text"},"ts":1637634198977,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$6t1wJe6jihhdURyPGhYisUwd9nulcgUKVVZN9VuB7uE"},
{"content":{"body":"Domenic: so before all these generic focus delegates algorithm, when there's a nested shadow dom host with no delegates focus, we don't delegate the focus to this shadow dom. ","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@domenicdenicola:matrix.org\">Domenic</a>: so before all these generic focus delegates algorithm, when there's a nested shadow dom host with no delegates focus, we don't delegate the focus to this shadow dom.","msgtype":"m.text"},"ts":1637635076846,"senderName":"sefeng","senderId":"@sefeng:mozilla.org","id":"$wNCVG9GZGw-n0oemp2XwwYuUt3cqjWEfSj9-jVg_-Rg"},
{"content":{"body":"but now it seems that we can delegate the focus to this shadow dom ","msgtype":"m.text"},"ts":1637635115472,"senderName":"sefeng","senderId":"@sefeng:mozilla.org","id":"$DQuFsdP-6I0-y8kjQ_qPkyJtosjs-nx3ukBoqsr9vXI"},
{"content":{"body":"I am looking at these two tests https://github.com/web-platform-tests/wpt/blob/628af0fd55db95d785a63484882998343e3a069e/shadow-dom/focus/focus-method-delegatesFocus.html#L271-L284 and wondering which step makes the behaviour different ","msgtype":"m.text"},"ts":1637635735919,"senderName":"sefeng","senderId":"@sefeng:mozilla.org","id":"$uFDq3GMbGiQQWxF0cnwBzzlbob-wLfhMZDBRe5tGkJs"},
{"content":{"body":"Hi. I have a couple questions on how to integrate the URL standard in a specification (ping annevk I guess ðŸ˜Š)","format":"org.matrix.custom.html","formatted_body":"Hi. I have a couple questions on how to integrate the URL standard in a specification (ping <a href=\"https://matrix.to/#/@annevk:mozilla.org\">annevk</a> I guess ðŸ˜Š)","msgtype":"m.text"},"ts":1637659738325,"senderName":"rdeltour","senderId":"@rdeltour:matrix.org","id":"$WCnHU2PsOpwCo3a-WfnOLce9O_UxssVp8qxezHowzww"},
{"content":{"body":"In EPUB, we're now refer to the URL standard. \nEPUB is basically a collection of web resources in an container (called \"Abstract OCF Container\"); practically, it's a ZIP.\nIn this container, files refer to each other using relative URL strings (with optional fragments)","msgtype":"m.text"},"ts":1637659975107,"senderName":"rdeltour","senderId":"@rdeltour:matrix.org","id":"$6QWxH9pEJIGsKlpg_xMJdxNPuDPypszog0RYLDRVzjs"},
{"content":{"body":"What we'd like to do, is normatively disallow relative URL strings that \"leak\" outside the container. For instance \"../../../../secret\"","msgtype":"m.text"},"ts":1637660048903,"senderName":"rdeltour","senderId":"@rdeltour:matrix.org","id":"$ddyaKVxaNKSU6MzoI4cp4k92RBOAOS1aNzDFm3eKqSE"},
{"content":{"body":"So we're trying to define what is a valid relative URL string in the contexts of EPUB.","msgtype":"m.text"},"ts":1637660181161,"senderName":"rdeltour","senderId":"@rdeltour:matrix.org","id":"$sKI0vRlYKpJW404JvVyt4Zwg9k8WCLoRK016I1A951A"},
{"content":{"body":"My question is: is it OK to say something along the lines of \"in an EPUB container, a **relative-URL string** MUST be a **container-relative URL string**\", and then define what we mean by **container-relative URL string**.\n\nIn other words, we're trying to override the definition of \"relative-URL string\" of the URL standard by:\n- disallowing path-absolute URL strings\n- disallowing scheme-relative URL strings\n- further constraining path-relative-scheme-less-URL strings to ensure dot-dot path segments are balanced by other segments","format":"org.matrix.custom.html","formatted_body":"<p>My question is: is it OK to say something along the lines of &quot;in an EPUB container, a <strong>relative-URL string</strong> MUST be a <strong>container-relative URL string</strong>&quot;, and then define what we mean by <strong>container-relative URL string</strong>.</p>\n<p>In other words, we're trying to override the definition of &quot;relative-URL string&quot; of the URL standard by:</p>\n<ul>\n<li>disallowing path-absolute URL strings</li>\n<li>disallowing scheme-relative URL strings</li>\n<li>further constraining path-relative-scheme-less-URL strings to ensure dot-dot path segments are balanced by other segments</li>\n</ul>\n","msgtype":"m.text"},"ts":1637660451819,"senderName":"rdeltour","senderId":"@rdeltour:matrix.org","id":"$wZHsdqqripJvVXiLBl3sH-QII8BdpMr9p7C5SmohZhw"},
{"content":{"body":"In some way it has a smell of monkey patching, but I can't see how to do otherwise. That's why I'm asking for advice to y'all ðŸ˜Š","msgtype":"m.text"},"ts":1637660528741,"senderName":"rdeltour","senderId":"@rdeltour:matrix.org","id":"$__XyqaHcHpT9b5Rm2e6slhKfHu63vAhmQl8vtu8wbkw"},
{"content":{"body":" * In EPUB, we now refer to the URL standard. \nEPUB is basically a collection of web resources in an container (called \"Abstract OCF Container\"); practically, it's a ZIP.\nIn this container, files refer to each other using relative URL strings (with optional fragments)","m.new_content":{"body":"In EPUB, we now refer to the URL standard. \nEPUB is basically a collection of web resources in an container (called \"Abstract OCF Container\"); practically, it's a ZIP.\nIn this container, files refer to each other using relative URL strings (with optional fragments)","msgtype":"m.text"},"m.relates_to":{"event_id":"$6QWxH9pEJIGsKlpg_xMJdxNPuDPypszog0RYLDRVzjs","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1637660582311,"senderName":"rdeltour","senderId":"@rdeltour:matrix.org","id":"$jQEs7g-103hmCmMvIVsln4rmkmmAHXrUAWzgwHJE-Fc"},
{"content":{"body":" * So we're trying to define what is a valid relative URL string in the context of EPUB.","m.new_content":{"body":"So we're trying to define what is a valid relative URL string in the context of EPUB.","msgtype":"m.text"},"m.relates_to":{"event_id":"$sKI0vRlYKpJW404JvVyt4Zwg9k8WCLoRK016I1A951A","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1637660619581,"senderName":"rdeltour","senderId":"@rdeltour:matrix.org","id":"$lpwibo_1LkEU2zQyVUQxzxFNe9X4LMnyC7msT14mrcQ"},
{"content":{"body":"see also https://github.com/w3c/epub-specs/issues/1912","msgtype":"m.text"},"ts":1637660645519,"senderName":"rdeltour","senderId":"@rdeltour:matrix.org","id":"$qBWzInG8LLrwIEhsM5iuZkeV0IjBaa3bQ1DdX-quzbE"},
{"content":{"body":"rdeltour: have you checked what implementations do? If there is some kind of base URL in play I'd expect it to work similarly to `https://example.com/../`","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@rdeltour:matrix.org\">rdeltour</a>: have you checked what implementations do? If there is some kind of base URL in play I'd expect it to work similarly to <code>https://example.com/../</code>","msgtype":"m.text"},"ts":1637661024535,"senderName":"annevk","senderId":"@annevk:mozilla.org","id":"$eY222Pbq3xcqv78DStIpClHKlTXWrgdc_aQi_SWtebU"},
{"content":{"body":"I suppose you could still have a desire to say that's invalid, but it isn't invalid for similar URLs in other contexts (if I remember correctly)","msgtype":"m.text"},"ts":1637661078030,"senderName":"annevk","senderId":"@annevk:mozilla.org","id":"$7mSxeyS8ALyBd0SXbBhtTR4VRDnCLFsxBH4VKA9v2Sw"},
{"content":{"body":"so, implementations vary (EPUB is old and this was largely unspecified so far). We added a UA conformance criteria to specify how the implementation-specific base URL must be. But here we're trying to define authoring requirements (what string is conforming or not, before parsing)","msgtype":"m.text"},"ts":1637661155144,"senderName":"rdeltour","senderId":"@rdeltour:matrix.org","id":"$nBCNEEoMOKGU32yjAsYgCLBX_3eykQ1VzZTrdxfLBIU"},
{"content":{"body":"a conforming UA will parse '../../secret'  to the same URL record as 'secret', but we'd still like to disallow the former, for better interop with legacy or non-conforming UAs.","msgtype":"m.text"},"ts":1637661249260,"senderName":"rdeltour","senderId":"@rdeltour:matrix.org","id":"$2iBNPkfRJIaEVo-1VeIXOvhbLk82S1v1U_gHJuRS2Gk"},
{"content":{"body":"It seems somewhat reasonable to write such a requirement the way you proposed above. The one quibble is that URL validity is also part of the URL parser and you wouldn't really be able to change that. (It's written in two different ways for different audiences.)","msgtype":"m.text"},"ts":1637661376297,"senderName":"annevk","senderId":"@annevk:mozilla.org","id":"$RBJ-A8a0pxkn5Ga13MtPNsSBVo1QJ4uc9Rnhb3hRVec"},
{"content":{"body":"It also seems that long term the requirement would be moot, so maybe it's easier to just explain the situation in a note and strongly encourage folks not to create such URL strings.","msgtype":"m.text"},"ts":1637661438506,"senderName":"annevk","senderId":"@annevk:mozilla.org","id":"$54uJrbGoYoaI5uxTcMY43_ZnwT4DbxvCT6xIlTlhOuQ"},
{"content":{"body":"OK good. Yeah, we're only talking of subsetting valid URL strings, so the URL parser would still return an expected result. That it doesn't produce a validation error on some of EPUB-non-conforming strings is acceptable.\n\nAs for explaining all that in a note: that's what we do in the current WD; but that requirement was normative before, and EPUB is a slow world so I believe we a normative definition makes more sense.","msgtype":"m.text"},"ts":1637661816646,"senderName":"rdeltour","senderId":"@rdeltour:matrix.org","id":"$0tZVmot_SH5FjUvPhAlX277nXQcRiikFTeMafjSFg4k"},
{"content":{"body":"I have another question if I may.\nEssentially for testing if a URL string is conforming I'm proposing the following (simplified) algo:\n1. if not a path-relative-scheme-less-URL string, return false\n2. if the result of parsing _url_ with \"http://example.org/A/\" does not start with \"http://example.org/A/\", return false\n3. 2. if the result of parsing _url_ with \"http://example.org/B/\" does not start with \"http://example.org/B/\", return false\n4. return true","format":"org.matrix.custom.html","formatted_body":"<p>I have another question if I may.<br>Essentially for testing if a URL string is conforming I'm proposing the following (simplified) algo:</p>\n<ol>\n<li>if not a path-relative-scheme-less-URL string, return false</li>\n<li>if the result of parsing <em>url</em> with &quot;http://example.org/A/&quot; does not start with &quot;http://example.org/A/&quot;, return false</li>\n<li>\n<ol start=\"2\">\n<li>if the result of parsing <em>url</em> with &quot;http://example.org/B/&quot; does not start with &quot;http://example.org/B/&quot;, return false</li>\n</ol>\n</li>\n<li>return true</li>\n</ol>\n","msgtype":"m.text"},"ts":1637662050166,"senderName":"rdeltour","senderId":"@rdeltour:matrix.org","id":"$Ow0Fu8iy-kw4w8jnHO-FB4QM71Z88cpYXCULQLzUr-E"},
{"content":{"body":"the use of test URLs is somewhat inelegant, but is simpler than redefining a custom parsing algo for counting that dot-dot path segments are balanced by other segments.","msgtype":"m.text"},"ts":1637662124661,"senderName":"rdeltour","senderId":"@rdeltour:matrix.org","id":"$SgYiRGda8ooDYEEcjflTfggzb4I2JyZ8XwXG4Pq8aYI"},
{"content":{"body":"any advice or comment ?","msgtype":"m.text"},"ts":1637662173924,"senderName":"rdeltour","senderId":"@rdeltour:matrix.org","id":"$sPZzgfYavvCa2eCbASRF5Xu4EpEgpp9G4CH4H5zllQg"},
{"content":{"body":" * I have another question if I may.\nEssentially for testing if a URL string is conforming I'm proposing the following (simplified) algo:\n1. if not a path-relative-scheme-less-URL string, return false\n2. if the result of parsing _url_ with \"http://example.org/A/\" does not start with \"http://example.org/A/\", return false\n3.  if the result of parsing _url_ with \"http://example.org/B/\" does not start with \"http://example.org/B/\", return false\n4. return true","format":"org.matrix.custom.html","formatted_body":" * <p>I have another question if I may.<br>Essentially for testing if a URL string is conforming I'm proposing the following (simplified) algo:</p>\n<ol>\n<li>if not a path-relative-scheme-less-URL string, return false</li>\n<li>if the result of parsing <em>url</em> with &quot;http://example.org/A/&quot; does not start with &quot;http://example.org/A/&quot;, return false</li>\n<li>if the result of parsing <em>url</em> with &quot;http://example.org/B/&quot; does not start with &quot;http://example.org/B/&quot;, return false</li>\n<li>return true</li>\n</ol>\n","m.new_content":{"body":"I have another question if I may.\nEssentially for testing if a URL string is conforming I'm proposing the following (simplified) algo:\n1. if not a path-relative-scheme-less-URL string, return false\n2. if the result of parsing _url_ with \"http://example.org/A/\" does not start with \"http://example.org/A/\", return false\n3.  if the result of parsing _url_ with \"http://example.org/B/\" does not start with \"http://example.org/B/\", return false\n4. return true","format":"org.matrix.custom.html","formatted_body":"<p>I have another question if I may.<br>Essentially for testing if a URL string is conforming I'm proposing the following (simplified) algo:</p>\n<ol>\n<li>if not a path-relative-scheme-less-URL string, return false</li>\n<li>if the result of parsing <em>url</em> with &quot;http://example.org/A/&quot; does not start with &quot;http://example.org/A/&quot;, return false</li>\n<li>if the result of parsing <em>url</em> with &quot;http://example.org/B/&quot; does not start with &quot;http://example.org/B/&quot;, return false</li>\n<li>return true</li>\n</ol>\n","msgtype":"m.text"},"m.relates_to":{"event_id":"$Ow0Fu8iy-kw4w8jnHO-FB4QM71Z88cpYXCULQLzUr-E","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1637662326544,"senderName":"rdeltour","senderId":"@rdeltour:matrix.org","id":"$4Me3Og1eB6GkNRe-FyrcLN8Hyt6JX8FnnNHZjftdBkc"},
{"content":{"body":" * OK good. Yeah, we're only talking of subsetting valid URL strings, so the URL parser would still return an expected result. That it doesn't produce a validation error on some of EPUB-non-conforming strings is acceptable.\n\nAs for explaining all that in a note: that's what we do in the current WD; but that requirement was normative before, and EPUB is a slow world so I believe a normative definition makes more sense.","m.new_content":{"body":"OK good. Yeah, we're only talking of subsetting valid URL strings, so the URL parser would still return an expected result. That it doesn't produce a validation error on some of EPUB-non-conforming strings is acceptable.\n\nAs for explaining all that in a note: that's what we do in the current WD; but that requirement was normative before, and EPUB is a slow world so I believe a normative definition makes more sense.","msgtype":"m.text"},"m.relates_to":{"event_id":"$0tZVmot_SH5FjUvPhAlX277nXQcRiikFTeMafjSFg4k","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1637662541488,"senderName":"rdeltour","senderId":"@rdeltour:matrix.org","id":"$SUltFOACOQkYu0CwTMVEBhtX_MMwKzkq-0vdFLVNbqc"},
{"content":{"body":"That seems okay, perhaps with a comment explaining the setup. You'll need to do more serializing if you want to compare strings, but you did say it was simplified.","msgtype":"m.text"},"ts":1637662720419,"senderName":"annevk","senderId":"@annevk:mozilla.org","id":"$jB-qxOuRhA8oLJMeCMzIa-wYyFTY6S4lq7vaZaKyk7s"},
{"content":{"body":"OK thanks!\n(and yes the non-simplified version does serialization)","msgtype":"m.text"},"ts":1637662771066,"senderName":"rdeltour","senderId":"@rdeltour:matrix.org","id":"$ymojSJ24aKBqScEd96CiuOrZISKkXBlIQ956vqKRQx0"},
{"content":{"body":"Well, thank you annevk for the help. Much appreciated!","format":"org.matrix.custom.html","formatted_body":"Well, thank you <a href=\"https://matrix.to/#/@annevk:mozilla.org\">annevk</a> for the help. Much appreciated!","msgtype":"m.text"},"ts":1637662825367,"senderName":"rdeltour","senderId":"@rdeltour:matrix.org","id":"$6sVYaQE9qUFmiHnqplLyGBALlUlPFqeezMJUbPQDE2c"},
{"content":{"body":"Domenic: apologies for becoming a grumpy old man yesterday, I'll blame lack of sleep and the fact that this has been grinding for a long time lol","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@domenicdenicola:matrix.org\">Domenic</a>: apologies for becoming a grumpy old man yesterday, I'll blame lack of sleep and the fact that this has been grinding for a long time lol","msgtype":"m.text"},"ts":1637679587041,"senderName":"zcorpan","senderId":"@zcorpan_:matrix.org","id":"$CugU4Ao5zuPXY05aMEVs0Wa9VpRIIRY6wBf9YaTDF1w"}
]