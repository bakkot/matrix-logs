[
{"content":{"body":"So I just reported one of the weirdest bugs I ever encountered: https://bugzilla.mozilla.org/show_bug.cgi?id=1781724","msgtype":"m.text","org.matrix.msc1767.text":"So I just reported one of the weirdest bugs I ever encountered: https://bugzilla.mozilla.org/show_bug.cgi?id=1781724"},"ts":1658900397553,"senderName":"Ondřej Žára","senderId":"@ondr4s:matrix.org","id":"$VO2BtFgJsVGl4hPcQvDb7ntL-yrEnkz1VxvV6ZcLSIg"},
{"content":{"body":"In general, Gecko seems to have some fun quirks with string handling.. I have a vague feeling of having seen something very similar to this  this bug before","m.relates_to":{"event_id":"$VO2BtFgJsVGl4hPcQvDb7ntL-yrEnkz1VxvV6ZcLSIg","is_falling_back":true,"m.in_reply_to":{"event_id":"$VO2BtFgJsVGl4hPcQvDb7ntL-yrEnkz1VxvV6ZcLSIg"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1658900925333,"senderName":"sideshowbarker","senderId":"@sideshowbarker:mozilla.org","id":"$BB45bJZ3tOMYbyK59tNN30w7jI1rcoJ8ZkRBOMrNP1o"},
{"content":{"body":"smaug: emilio: ⬆️ ","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@smaug:mozilla.org\">smaug</a>: <a href=\"https://matrix.to/#/@emilio:mozilla.org\">emilio</a>: ⬆️ ","msgtype":"m.text"},"ts":1658900998119,"senderName":"sideshowbarker","senderId":"@sideshowbarker:mozilla.org","id":"$GSIJXWDI9XG0Misi_t_O4leFVTAWHDgRKu5cv8lUKyA"},
{"content":{"body":"> <@ondr4s:matrix.org> So I just reported one of the weirdest bugs I ever encountered: https://bugzilla.mozilla.org/show_bug.cgi?id=1781724\n\nWill look, thanks, it's probably a weird interaction between JSString representation and our utf8 conversion code","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$VO2BtFgJsVGl4hPcQvDb7ntL-yrEnkz1VxvV6ZcLSIg?via=mozilla.org&via=matrix.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@ondr4s:matrix.org\">@ondr4s:matrix.org</a><br />So I just reported one of the weirdest bugs I ever encountered: https://bugzilla.mozilla.org/show_bug.cgi?id=1781724</blockquote></mx-reply>Will look, thanks, it's probably a weird interaction between JSString representation and our utf8 conversion code","m.relates_to":{"m.in_reply_to":{"event_id":"$VO2BtFgJsVGl4hPcQvDb7ntL-yrEnkz1VxvV6ZcLSIg"}},"msgtype":"m.text"},"ts":1658904659815,"senderName":"emilio","senderId":"@emilio:mozilla.org","id":"$ktLJb1QTp5K-1AX7nH4DlxV8NHThc3Aah0OTV_tVa-g"},
{"content":{"body":"emilio: FWIW, I suspect hsivonen (away from Matrix until 2022-08-08) will be able to identify the cause. He added some fast paths between JS and C++ that I would expect are the cause here.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@emilio:mozilla.org\">emilio</a>: FWIW, I suspect <a href=\"https://matrix.to/#/@hsivonen:mozilla.org\">hsivonen (away from Matrix until 2022-08-08)</a> will be able to identify the cause. He added some fast paths between JS and C++ that I would expect are the cause here.","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"emilio: FWIW, I suspect hsivonen (away from Matrix until 2022-08-08) will be able to identify the cause. He added some fast paths between JS and C++ that I would expect are the cause here.","mimetype":"text/plain"},{"body":"<a href=\"https://matrix.to/#/@emilio:mozilla.org\">emilio</a>: FWIW, I suspect <a href=\"https://matrix.to/#/@hsivonen:mozilla.org\">hsivonen (away from Matrix until 2022-08-08)</a> will be able to identify the cause. He added some fast paths between JS and C++ that I would expect are the cause here.","mimetype":"text/html"}]},"ts":1658905848652,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$QyKZjNp0-IzTLO9Q1-rFAYeGMA6oACTL6c1jKe44LBE"},
{"content":{"body":"> <@annevk:matrix.org> emilio: FWIW, I suspect hsivonen (away from Matrix until 2022-08-08) will be able to identify the cause. He added some fast paths between JS and C++ that I would expect are the cause here.\n\nI removed the encode() one here hah: https://bugzilla.mozilla.org/show_bug.cgi?id=1607083","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$QyKZjNp0-IzTLO9Q1-rFAYeGMA6oACTL6c1jKe44LBE?via=mozilla.org&via=matrix.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@annevk:matrix.org\">@annevk:matrix.org</a><br /><a href=\"https://matrix.to/#/@emilio:mozilla.org\">emilio</a>: FWIW, I suspect <a href=\"https://matrix.to/#/@hsivonen:mozilla.org\">hsivonen (away from Matrix until 2022-08-08)</a> will be able to identify the cause. He added some fast paths between JS and C++ that I would expect are the cause here.</blockquote></mx-reply>I removed the encode() one here hah: https://bugzilla.mozilla.org/show_bug.cgi?id=1607083","m.relates_to":{"m.in_reply_to":{"event_id":"$QyKZjNp0-IzTLO9Q1-rFAYeGMA6oACTL6c1jKe44LBE"}},"msgtype":"m.text"},"ts":1658906307255,"senderName":"emilio","senderId":"@emilio:mozilla.org","id":"$km5SpUpez5OUPppqoKtjslCf48bWVoaQlm5JvVF6fQY"},
{"content":{"body":"Because UTF8String effectively behaved like the manual code","msgtype":"m.text"},"ts":1658906335265,"senderName":"emilio","senderId":"@emilio:mozilla.org","id":"$HNcq0Xfa6tX2XkezH-hojFytL2DqrVRWdgO5RBWLGj4"}
]