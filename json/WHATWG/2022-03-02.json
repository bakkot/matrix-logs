[
{"content":{"body":"annevk: https://stackoverflow.com/questions/71311305/how-to-prevent-safari-from-dropping-the-authorization-header-when-following-a-re\n> Safari seems to drop the `Authorization` header when following a [same-origin] 301 redirect... Chrome (98) and Firefox (97) both follow the redirect and include the `Authorization` header in the subsequent `GET` request.\n\nWonder what behavior the spec requires here","format":"org.matrix.custom.html","formatted_body":"<p><a href=\"https://matrix.to/#/@annevk:mozilla.org\">annevk</a>: https://stackoverflow.com/questions/71311305/how-to-prevent-safari-from-dropping-the-authorization-header-when-following-a-re</p>\n<blockquote>\n<p>Safari seems to drop the <code>Authorization</code> header when following a [same-origin] 301 redirect... Chrome (98) and Firefox (97) both follow the redirect and include the <code>Authorization</code> header in the subsequent <code>GET</code> request.</p>\n</blockquote>\n<p>Wonder what behavior the spec requires here</p>\n","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"annevk: https://stackoverflow.com/questions/71311305/how-to-prevent-safari-from-dropping-the-authorization-header-when-following-a-re\n> Safari seems to drop the `Authorization` header when following a [same-origin] 301 redirect... Chrome (98) and Firefox (97) both follow the redirect and include the `Authorization` header in the subsequent `GET` request.\n\nWonder what behavior the spec requires here","mimetype":"text/plain"},{"body":"<p><a href=\"https://matrix.to/#/@annevk:mozilla.org\">annevk</a>: https://stackoverflow.com/questions/71311305/how-to-prevent-safari-from-dropping-the-authorization-header-when-following-a-re</p>\n<blockquote>\n<p>Safari seems to drop the <code>Authorization</code> header when following a [same-origin] 301 redirect... Chrome (98) and Firefox (97) both follow the redirect and include the <code>Authorization</code> header in the subsequent <code>GET</code> request.</p>\n</blockquote>\n<p>Wonder what behavior the spec requires here</p>\n","mimetype":"text/html"}]},"ts":1646183266284,"senderName":"sideshowbarker","senderId":"@sideshowbarker:mozilla.org","id":"$ztE1uu4TV9DFoma-V5BJSVcZsb4vbTYO-6OtIoKDpvA"},
{"content":{"body":"and https://stackoverflow.com/questions/57974176/safari-does-not-persist-the-authorization-header-on-redirect is another 2-year-old question about the same thing","msgtype":"m.text","org.matrix.msc1767.text":"and https://stackoverflow.com/questions/57974176/safari-does-not-persist-the-authorization-header-on-redirect is another 2-year-old question about the same thing"},"ts":1646183349809,"senderName":"sideshowbarker","senderId":"@sideshowbarker:mozilla.org","id":"$v_ngyjVId0Q8CEX5mImhBZl6HTBVTXo_RIl-i2kijOE"},
{"content":{"body":"> <@domenicdenicola:matrix.org> Yoav Weiss: Noam Rosenthal : what is the cross-origin redirects case for unload timing protecting against? It's basically saying if you go x.com -> y.com --redirects to-> x.com/bar, x.com/bar does not get unload timing for x.com. Why? No information about y.com leaked.\n\nI checked, and the specific scenario (same->cross->same redirect, check that unload is not available) is tested in WPT and passes all 3 browsers... https://github.com/web-platform-tests/wpt/blob/master/navigation-timing/unload-event-same-origin-check.html#L57\nhttps://wpt.fyi/results/navigation-timing/unload-event-same-origin-check.html?label=experimental&label=master&aligned","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$Eub-Y9YeUY1HnYK4ufho6fzvmtW3Q8DeopACXgSSLe8?via=mozilla.org&via=matrix.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@domenicdenicola:matrix.org\">@domenicdenicola:matrix.org</a><br><a href=\"https://matrix.to/#/@yoavweiss:matrix.org\">Yoav Weiss</a>: <a href=\"https://matrix.to/#/@noamr:matrix.org\">Noam Rosenthal</a> : what is the cross-origin redirects case for unload timing protecting against? It's basically saying if you go x.com -&gt; y.com --redirects to-&gt; x.com/bar, x.com/bar does not get unload timing for x.com. Why? No information about y.com leaked.</blockquote></mx-reply>I checked, and the specific scenario (same-&gt;cross-&gt;same redirect, check that unload is not available) is tested in WPT and passes all 3 browsers... https://github.com/web-platform-tests/wpt/blob/master/navigation-timing/unload-event-same-origin-check.html#L57<br>https://wpt.fyi/results/navigation-timing/unload-event-same-origin-check.html?label=experimental&amp;label=master&amp;aligned","m.relates_to":{"m.in_reply_to":{"event_id":"$Eub-Y9YeUY1HnYK4ufho6fzvmtW3Q8DeopACXgSSLe8"}},"msgtype":"m.text","org.matrix.msc1767.message":[{"body":"> <@domenicdenicola:matrix.org> Yoav Weiss: Noam Rosenthal : what is the cross-origin redirects case for unload timing protecting against? It's basically saying if you go x.com -> y.com --redirects to-> x.com/bar, x.com/bar does not get unload timing for x.com. Why? No information about y.com leaked.\n\nI checked, and the specific scenario (same->cross->same redirect, check that unload is not available) is tested in WPT and passes all 3 browsers... https://github.com/web-platform-tests/wpt/blob/master/navigation-timing/unload-event-same-origin-check.html#L57\nhttps://wpt.fyi/results/navigation-timing/unload-event-same-origin-check.html?label=experimental&label=master&aligned","mimetype":"text/plain"},{"body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$Eub-Y9YeUY1HnYK4ufho6fzvmtW3Q8DeopACXgSSLe8?via=mozilla.org&via=matrix.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@domenicdenicola:matrix.org\">@domenicdenicola:matrix.org</a><br><a href=\"https://matrix.to/#/@yoavweiss:matrix.org\">Yoav Weiss</a>: <a href=\"https://matrix.to/#/@noamr:matrix.org\">Noam Rosenthal</a> : what is the cross-origin redirects case for unload timing protecting against? It's basically saying if you go x.com -&gt; y.com --redirects to-&gt; x.com/bar, x.com/bar does not get unload timing for x.com. Why? No information about y.com leaked.</blockquote></mx-reply>I checked, and the specific scenario (same-&gt;cross-&gt;same redirect, check that unload is not available) is tested in WPT and passes all 3 browsers... https://github.com/web-platform-tests/wpt/blob/master/navigation-timing/unload-event-same-origin-check.html#L57<br>https://wpt.fyi/results/navigation-timing/unload-event-same-origin-check.html?label=experimental&amp;label=master&amp;aligned","mimetype":"text/html"}]},"ts":1646197935255,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$4PoGIEgPNzOfMUpYNIAUu_SQTEGdOyXkhH7yr3TopS0"},
{"content":{"body":"to me it seems like an unnecessary security measure or I don't understand it. Yoav Weiss ?","format":"org.matrix.custom.html","formatted_body":"to me it seems like an unnecessary security measure or I don't understand it. <a href=\"https://matrix.to/#/@yoavweiss:matrix.org\">Yoav Weiss</a> ?","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"to me it seems like an unnecessary security measure or I don't understand it. Yoav Weiss ?","mimetype":"text/plain"},{"body":"to me it seems like an unnecessary security measure or I don't understand it. <a href=\"https://matrix.to/#/@yoavweiss:matrix.org\">Yoav Weiss</a> ?","mimetype":"text/html"}]},"ts":1646197989653,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$_BBU5-nyFQOWUSw-VM5FFk9O4Y7CwgIY9k0sGVl7MIY"},
{"content":{"body":"It's possible that this is overly strict. It used to be TAO protected and have the same rules as TAO, but at some point we realized that it's not really protecting anything (it's not the origin which information was exposed that was opting in), so moved to a same origin check. The same=>cross=>same scenario was one that we protected against in TAO, so maybe that logic sticked around through the move to same origin checks.","msgtype":"m.text","org.matrix.msc1767.text":"It's possible that this is overly strict. It used to be TAO protected and have the same rules as TAO, but at some point we realized that it's not really protecting anything (it's not the origin which information was exposed that was opting in), so moved to a same origin check. The same=>cross=>same scenario was one that we protected against in TAO, so maybe that logic sticked around through the move to same origin checks."},"ts":1646199356574,"senderName":"Yoav Weiss","senderId":"@yoavweiss:matrix.org","id":"$_gSzKZi1W0xEkad4KZ75OjsG6T9vTQiDXoQeiJ0Rkv8"},
{"content":{"body":"Maybe annevk has reasons as to why we should keep it, but I tend to agree with y'all that if the previous origin is the same as the destination origin, we could expose the data ","format":"org.matrix.custom.html","formatted_body":"Maybe <a href=\"https://matrix.to/#/@annevk:mozilla.org\">annevk</a> has reasons as to why we should keep it, but I tend to agree with y'all that if the previous origin is the same as the destination origin, we could expose the data","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"Maybe annevk has reasons as to why we should keep it, but I tend to agree with y'all that if the previous origin is the same as the destination origin, we could expose the data ","mimetype":"text/plain"},{"body":"Maybe <a href=\"https://matrix.to/#/@annevk:mozilla.org\">annevk</a> has reasons as to why we should keep it, but I tend to agree with y'all that if the previous origin is the same as the destination origin, we could expose the data","mimetype":"text/html"}]},"ts":1646199450182,"senderName":"Yoav Weiss","senderId":"@yoavweiss:matrix.org","id":"$8A9HFAQv1E5efg8UOPWq3y5-BmKHhNg7ZLEzTBXVEmA"},
{"content":{"body":"I think Referer and Sec-Fetch-Site are impacted so I think this ought to be impacted as well. What might leak is if y.com does a further redirect based on a cookie. Now x.com could conspire with subsequent x.com, but given that Referer and Sec-Fetch-Site are impacted it might not entirely be clear whether it's the result of a redirect or a subsequent visit. Especially with more navigation tracking mitigation down the line.","msgtype":"m.text","org.matrix.msc1767.text":"I think Referer and Sec-Fetch-Site are impacted so I think this ought to be impacted as well. What might leak is if y.com does a further redirect based on a cookie. Now x.com could conspire with subsequent x.com, but given that Referer and Sec-Fetch-Site are impacted it might not entirely be clear whether it's the result of a redirect or a subsequent visit. Especially with more navigation tracking mitigation down the line."},"ts":1646207307553,"senderName":"annevk","senderId":"@annevk:mozilla.org","id":"$sK8dWdZu4ZEl8m-ToTgZQNgH-H6GCQdnjUdVEqKE2wM"},
{"content":{"body":"Noam Rosenthal: Yoav Weiss: Domenic: ^^","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@noamr:matrix.org\">Noam Rosenthal</a>: <a href=\"https://matrix.to/#/@yoavweiss:matrix.org\">Yoav Weiss</a>: <a href=\"https://matrix.to/#/@domenicdenicola:matrix.org\">Domenic</a>: ^^","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"Noam Rosenthal: Yoav Weiss: Domenic: ^^","mimetype":"text/plain"},{"body":"<a href=\"https://matrix.to/#/@noamr:matrix.org\">Noam Rosenthal</a>: <a href=\"https://matrix.to/#/@yoavweiss:matrix.org\">Yoav Weiss</a>: <a href=\"https://matrix.to/#/@domenicdenicola:matrix.org\">Domenic</a>: ^^","mimetype":"text/html"}]},"ts":1646207322817,"senderName":"annevk","senderId":"@annevk:mozilla.org","id":"$xfIYM0BgdssUz0ashzEI3rtMAW5lUK9Wk2mRXtUfmXw"},
{"content":{"body":" * I think Referer and Sec-Fetch-Site are impacted so I think this ought to be impacted as well. What might leak is if y.com does a further redirect based on a cookie. Now x.com could conspire with subsequent x.com, but given that Referer and Sec-Fetch-Site are impacted it might not entirely be clear whether it's the result of a redirect or a subsequent visit. Especially with more navigation tracking mitigation down the line.","m.new_content":{"body":"I think Referer and Sec-Fetch-Site are impacted so I think this ought to be impacted as well. What might leak is if y.com does a further redirect based on a cookie. Now x.com could conspire with subsequent x.com, but given that Referer and Sec-Fetch-Site are impacted it might not entirely be clear whether it's the result of a redirect or a subsequent visit. Especially with more navigation tracking mitigation down the line.","msgtype":"m.text","org.matrix.msc1767.text":"I think Referer and Sec-Fetch-Site are impacted so I think this ought to be impacted as well. What might leak is if y.com does a further redirect based on a cookie. Now x.com could conspire with subsequent x.com, but given that Referer and Sec-Fetch-Site are impacted it might not entirely be clear whether it's the result of a redirect or a subsequent visit. Especially with more navigation tracking mitigation down the line."},"m.relates_to":{"event_id":"$sK8dWdZu4ZEl8m-ToTgZQNgH-H6GCQdnjUdVEqKE2wM","rel_type":"m.replace"},"msgtype":"m.text","org.matrix.msc1767.text":" * I think Referer and Sec-Fetch-Site are impacted so I think this ought to be impacted as well. What might leak is if y.com does a further redirect based on a cookie. Now x.com could conspire with subsequent x.com, but given that Referer and Sec-Fetch-Site are impacted it might not entirely be clear whether it's the result of a redirect or a subsequent visit. Especially with more navigation tracking mitigation down the line."},"ts":1646207337667,"senderName":"annevk","senderId":"@annevk:mozilla.org","id":"$btPOki4hYA_0R_6EzQ9tB0ufvm6aF7C_Gi-1n1slyik"},
{"content":{"body":"> <@annevk:mozilla.org> I think Referer and Sec-Fetch-Site are impacted so I think this ought to be impacted as well. What might leak is if y.com does a further redirect based on a cookie. Now x.com could conspire with subsequent x.com, but given that Referer and Sec-Fetch-Site are impacted it might not entirely be clear whether it's the result of a redirect or a subsequent visit. Especially with more navigation tracking mitigation down the line.\n\nOK so this hides the fact that the unload and the new document are the same visit, which is otherwise a hidden fact. This also brings back the https://github.com/w3c/navigation-timing/issues/160 thing...","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$sK8dWdZu4ZEl8m-ToTgZQNgH-H6GCQdnjUdVEqKE2wM?via=mozilla.org&via=matrix.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@annevk:mozilla.org\">@annevk:mozilla.org</a><br>I think Referer and Sec-Fetch-Site are impacted so I think this ought to be impacted as well. What might leak is if y.com does a further redirect based on a cookie. Now x.com could conspire with subsequent x.com, but given that Referer and Sec-Fetch-Site are impacted it might not entirely be clear whether it&#39;s the result of a redirect or a subsequent visit. Especially with more navigation tracking mitigation down the line.</blockquote></mx-reply>OK so this hides the fact that the unload and the new document are the same visit, which is otherwise a hidden fact. This also brings back the https://github.com/w3c/navigation-timing/issues/160 thing...","m.relates_to":{"m.in_reply_to":{"event_id":"$sK8dWdZu4ZEl8m-ToTgZQNgH-H6GCQdnjUdVEqKE2wM"}},"msgtype":"m.text","org.matrix.msc1767.message":[{"body":"> <@annevk:mozilla.org> I think Referer and Sec-Fetch-Site are impacted so I think this ought to be impacted as well. What might leak is if y.com does a further redirect based on a cookie. Now x.com could conspire with subsequent x.com, but given that Referer and Sec-Fetch-Site are impacted it might not entirely be clear whether it's the result of a redirect or a subsequent visit. Especially with more navigation tracking mitigation down the line.\n\nOK so this hides the fact that the unload and the new document are the same visit, which is otherwise a hidden fact. This also brings back the https://github.com/w3c/navigation-timing/issues/160 thing...","mimetype":"text/plain"},{"body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$sK8dWdZu4ZEl8m-ToTgZQNgH-H6GCQdnjUdVEqKE2wM?via=mozilla.org&via=matrix.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@annevk:mozilla.org\">@annevk:mozilla.org</a><br>I think Referer and Sec-Fetch-Site are impacted so I think this ought to be impacted as well. What might leak is if y.com does a further redirect based on a cookie. Now x.com could conspire with subsequent x.com, but given that Referer and Sec-Fetch-Site are impacted it might not entirely be clear whether it&#39;s the result of a redirect or a subsequent visit. Especially with more navigation tracking mitigation down the line.</blockquote></mx-reply>OK so this hides the fact that the unload and the new document are the same visit, which is otherwise a hidden fact. This also brings back the https://github.com/w3c/navigation-timing/issues/160 thing...","mimetype":"text/html"}]},"ts":1646207449582,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$hY68srpChdRD5pcjwh8K2ZOxoyhnKqytOE-duupoxVE"},
{"content":{"body":"Noam Rosenthal: yeah, though I'd argue that case is worse.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@noamr:matrix.org\">Noam Rosenthal</a>: yeah, though I'd argue that case is worse.","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"Noam Rosenthal: yeah, though I'd argue that case is worse.","mimetype":"text/plain"},{"body":"<a href=\"https://matrix.to/#/@noamr:matrix.org\">Noam Rosenthal</a>: yeah, though I'd argue that case is worse.","mimetype":"text/html"}]},"ts":1646207798240,"senderName":"annevk","senderId":"@annevk:mozilla.org","id":"$-X3VWsV3BK5ElrUJYMeN7fUCwgcdFn-B8iIo_SMrHuE"},
{"content":{"body":"sideshowbarker: left a reply. Not sure if Safari has an open bug for this, maybe you want to file one?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@sideshowbarker:mozilla.org\">sideshowbarker</a>: left a reply. Not sure if Safari has an open bug for this, maybe you want to file one?","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"sideshowbarker: left a reply. Not sure if Safari has an open bug for this, maybe you want to file one?","mimetype":"text/plain"},{"body":"<a href=\"https://matrix.to/#/@sideshowbarker:mozilla.org\">sideshowbarker</a>: left a reply. Not sure if Safari has an open bug for this, maybe you want to file one?","mimetype":"text/html"}]},"ts":1646207821077,"senderName":"annevk","senderId":"@annevk:mozilla.org","id":"$UMT7ztPYav1Ac1unyaS1WJOANdMOaqXBYdDgUMSs3BU"},
{"content":{"body":"> <@annevk:mozilla.org> sideshowbarker: left a reply. Not sure if Safari has an open bug for this, maybe you want to file one?\n\nI'll ask the OP if they can file a bug","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$UMT7ztPYav1Ac1unyaS1WJOANdMOaqXBYdDgUMSs3BU?via=mozilla.org&via=matrix.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@annevk:mozilla.org\">@annevk:mozilla.org</a><br /><a href=\"https://matrix.to/#/@sideshowbarker:mozilla.org\">sideshowbarker</a>: left a reply. Not sure if Safari has an open bug for this, maybe you want to file one?</blockquote></mx-reply>I'll ask the OP if they can file a bug","m.relates_to":{"m.in_reply_to":{"event_id":"$UMT7ztPYav1Ac1unyaS1WJOANdMOaqXBYdDgUMSs3BU"}},"msgtype":"m.text"},"ts":1646207921459,"senderName":"sideshowbarker","senderId":"@sideshowbarker:mozilla.org","id":"$pERg9g8cjxmrVBThuoy6rVjPn8Hfl0Bt0t9WChukTuo"},
{"content":{"body":"any webkit/gecko people feeling inspired? https://github.com/whatwg/websockets/issues/20","msgtype":"m.text","org.matrix.msc1767.text":"any webkit/gecko people feeling inspired? https://github.com/whatwg/websockets/issues/20"},"ts":1646234929654,"senderName":"devsnek","senderId":"@devsnek:matrix.org","id":"$tiXvGRcj7pP7OHGxXDPqijzbT5utS4Z8-ztaBFzW3_0"},
{"content":{"body":"annevk: you seemed to not hate this, in the past at least. do you think mozilla would accept contribution for this?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@annevk:mozilla.org\">annevk</a>: you seemed to not hate this, in the past at least. do you think mozilla would accept contribution for this?","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"annevk: you seemed to not hate this, in the past at least. do you think mozilla would accept contribution for this?","mimetype":"text/plain"},{"body":"<a href=\"https://matrix.to/#/@annevk:mozilla.org\">annevk</a>: you seemed to not hate this, in the past at least. do you think mozilla would accept contribution for this?","mimetype":"text/html"}]},"ts":1646234965324,"senderName":"devsnek","senderId":"@devsnek:matrix.org","id":"$NEdWP7iFs8fbkZ5DAE1WJNESuNSu3p8QLiFtVpAMwrg"}
]