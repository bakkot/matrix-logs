[
{"content":{"body":"https://x.com/filpizlo/status/2017074082249048347","m.mentions":{},"msgtype":"m.text"},"ts":1769750401698,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$oAOpJSzSE7waUz98X3eJrI8nuU8duBYah00znv_powA"},
{"content":{"body":"Commented. Thanks","m.mentions":{},"m.relates_to":{"event_id":"$n87fNeNL_5aey_5CZcAhBZLdeBUwlNhZZH-7g6523U0","is_falling_back":true,"m.in_reply_to":{"event_id":"$lR8C7xnHwKTBW77PMCBTCqCPs8IJD6JPw--oMd4qzVA"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1769757261715,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$qW4bypDftNpTn-lLnS7qnjNMRvTy4zYjir7LEiMd3aA"},
{"content":{"body":"zcorpan: We were talking on the whattnot call about the *“Why not just use PIs instead of minting a new exclamation point syntax?”* question for the marker thing, and Noam mentioned you had expressed some rationale for why. What was that? Or could you give a link(s) to your comment(s) on that?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@zcorpan:mozilla.org\">zcorpan</a>: We were talking on the whattnot call about the <em>“Why not just use PIs instead of minting a new exclamation point syntax?”</em> question for the marker thing, and Noam mentioned you had expressed some rationale for why. What was that? Or could you give a link(s) to your comment(s) on that?","m.mentions":{"user_ids":["@zcorpan:mozilla.org"]},"msgtype":"m.text"},"ts":1769757555348,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$KHrvF7AztEGmSVkRsgp30GipvMUqbJinVl958UvVVe0"},
{"content":{"body":"IMHO Henri makes a pretty strong case for why we should just use PIs — unless there’s some really compelling reason not to.","m.mentions":{},"msgtype":"m.text"},"ts":1769757642326,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$dtjc14XwORTD3F4gAOoND2haVFwUxA_qLoGQb1lxJR0"},
{"content":{"body":"> <@sideshowbarker:matrix.org> IMHO Henri makes a pretty strong case for why we should just use PIs — unless there’s some really compelling reason not to.\n\nFWIW I was convinced especially by the arguments that extensions might be incompat; I think we can have something like ProcessingInstruction.prototype.marker that points to the actual clean marker data, not even a subclass, and can respond to mutations of the PI's data. This allows zero modifications to DOM and makes marker inspection and manipulation agnostic of whether its xml or HTML ","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$dtjc14XwORTD3F4gAOoND2haVFwUxA_qLoGQb1lxJR0?via=matrix.org&via=mozilla.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@sideshowbarker:matrix.org\">@sideshowbarker:matrix.org</a><br />IMHO Henri makes a pretty strong case for why we should just use PIs — unless there’s some really compelling reason not to.</blockquote></mx-reply>FWIW I was convinced especially by the arguments that extensions might be incompat; I think we can have something like ProcessingInstruction.prototype.marker that points to the actual clean marker data, not even a subclass, and can respond to mutations of the PI's data. This allows zero modifications to DOM and makes marker inspection and manipulation agnostic of whether its xml or HTML","m.relates_to":{"m.in_reply_to":{"event_id":"$dtjc14XwORTD3F4gAOoND2haVFwUxA_qLoGQb1lxJR0"}},"msgtype":"m.text"},"ts":1769758404380,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$nM5TxpGfbFmRbaBgaWy3E2u-2u8JIRHpGKn_PHWk-0A"},
{"content":{"body":"sideshowbarker: I proposed it in https://github.com/whatwg/html/issues/11542#issuecomment-3759955087\n\nThe main benefit I think is less confusion about the end of the \"tag\" in the syntax. In XML PIs end with ?> but in the HTML parser it ends with >. But the compat with XML tooling and DOM traversal scripts is more important, so I think now we should use PIs and live with mutability. We can trim a trailing \"?\" in the parser so polyglot is still possible.","format":"org.matrix.custom.html","formatted_body":"<p><a href=\"https://matrix.to/#/@sideshowbarker:matrix.org\">sideshowbarker</a>: I proposed it in https://github.com/whatwg/html/issues/11542#issuecomment-3759955087</p>\n<p>The main benefit I think is less confusion about the end of the \"tag\" in the syntax. In XML PIs end with ?&gt; but in the HTML parser it ends with &gt;. But the compat with XML tooling and DOM traversal scripts is more important, so I think now we should use PIs and live with mutability. We can trim a trailing \"?\" in the parser so polyglot is still possible.</p>\n","m.mentions":{"user_ids":["@sideshowbarker:matrix.org"]},"msgtype":"m.text"},"ts":1769759134110,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$YEEzT-VnmVs04BT8hdGAiQs7Wj7vRGaK473jVJVK5-Q"},
{"content":{"body":"Ah I see:\n\n> _If we're going to use a new node type instead of ProcessingInstruction, there's no need to use the syntax for processing instructions._\n\nSo yeah, objectively it’d make sense _if_ we did have a very good reason to use a new node type. Which takes it back more to just being about the question of whether we need to use a new node type. And yeah the _“the compat with XML tooling and DOM traversal scripts”_ argument seems to weigh things more heavily toward not doing that.","format":"org.matrix.custom.html","formatted_body":"<p>Ah I see:</p>\n<blockquote>\n<p><em>If we're going to use a new node type instead of ProcessingInstruction, there's no need to use the syntax for processing instructions.</em></p>\n</blockquote>\n<p>So yeah, objectively it’d make sense <em>if</em> we did have a very good reason to use a new node type. Which takes it back more to just being about the question of whether we need to use a new node type. And yeah the <em>“the compat with XML tooling and DOM traversal scripts”</em> argument seems to weigh things more heavily toward not doing that.</p>\n","m.mentions":{},"msgtype":"m.text"},"ts":1769759513829,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$00Worvo6HYPAO9viohKWkbhz6swDSHmQSTFcVWbhFkE"},
{"content":{"body":"Note that `ProcessingInstruction`'s \"target\" is immutable, so at least the marker type can remain immutable and mutating the data only affects the name and whatever attributes future usages of this process","format":"org.matrix.custom.html","formatted_body":"Note that <code>ProcessingInstruction</code>'s \"target\" is immutable, so at least the marker type can remain immutable and mutating the data only affects the name and whatever attributes future usages of this process","m.mentions":{"user_ids":["@zcorpan:mozilla.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$YEEzT-VnmVs04BT8hdGAiQs7Wj7vRGaK473jVJVK5-Q"}},"msgtype":"m.text"},"ts":1769759671145,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$CbiCIDzzUFp53-Ph0PCvPHMLjB-NOPVsxyW_xdxYgTY"},
{"content":{"body":"Noam Rosenthal: ah yes. Simplest would be to not have pseudo-attributes but just take the data and treat as the name. If we want fail-open future compat: no have pseudo-attributes for now, but let the name be the part in the data before any whitespace.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@noamr:matrix.org\">Noam Rosenthal</a>: ah yes. Simplest would be to not have pseudo-attributes but just take the data and treat as the name. If we want fail-open future compat: no have pseudo-attributes for now, but let the name be the part in the data before any whitespace.","m.mentions":{"user_ids":["@noamr:matrix.org"]},"msgtype":"m.text"},"ts":1769760202756,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$YQc6m5r9B3G7WI3z58enZoErT5Qt3RZJLVCvAePT8j4"},
{"content":{"body":"> <@zcorpan:mozilla.org> Noam Rosenthal: ah yes. Simplest would be to not have pseudo-attributes but just take the data and treat as the name. If we want fail-open future compat: no have pseudo-attributes for now, but let the name be the part in the data before any whitespace.\n\nYes I think the latter. There are already emerging cases for pseudo attributes, eg for using this for css custom highlights ","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$YQc6m5r9B3G7WI3z58enZoErT5Qt3RZJLVCvAePT8j4?via=matrix.org&via=mozilla.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@zcorpan:mozilla.org\">@zcorpan:mozilla.org</a><br /><a href=\"https://matrix.to/#/@noamr:matrix.org\">Noam Rosenthal</a>: ah yes. Simplest would be to not have pseudo-attributes but just take the data and treat as the name. If we want fail-open future compat: no have pseudo-attributes for now, but let the name be the part in the data before any whitespace.</blockquote></mx-reply>Yes I think the latter. There are already emerging cases for pseudo attributes, eg for using this for css custom highlights","m.relates_to":{"m.in_reply_to":{"event_id":"$YQc6m5r9B3G7WI3z58enZoErT5Qt3RZJLVCvAePT8j4"}},"msgtype":"m.text"},"ts":1769760258087,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$exTlQNWBjVipZplshfhpnvCI4TMo8UysmuGwpAoysGI"},
{"content":{"body":"I wonder if it's important to have it as a property of a PI rather than a subclass. HTML elements are subclasses despite not being known to XML","msgtype":"m.text"},"ts":1769760311846,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$v-BINTwLvzjhdNyjiz7pIPbe1tFOAjGSpRf79AvvMUI"},
{"content":{"body":"Hmm yeah, subclass seems like it should be compatible enough. I think it would only break checks like `node.constructor.name` but probably scripts usually use `nodeType`","format":"org.matrix.custom.html","formatted_body":"Hmm yeah, subclass seems like it should be compatible enough. I think it would only break checks like <code>node.constructor.name</code> but probably scripts usually use <code>nodeType</code>","m.mentions":{},"msgtype":"m.text"},"ts":1769761199238,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$3Gt42ZmPp7GCgODU67e2EGXmmZHjHMg-d_PfRDKKEFk"}
]