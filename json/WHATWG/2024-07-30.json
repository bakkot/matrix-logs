[
{"content":{"body":"> <@yoavweiss:matrix.org> Hey folks! I'm playing around with module scripts and I see that a module script struct is being passed to EcmaScript and back through a ParseModule.\\[\\[HostDefined\\]\\] item. I'm wondering if that is done by value or by reference. More explicitly, if I later change the module script struct, would that change be reflected when grabbing that ParseModule.\\[\\[HostDefined\\]\\]?\n\nWe generally treat these things as \"by reference\". On the other hand, I'm not sure what fields of module scripts are meant to be mutable...","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$pqyVvoxflu_-sPmaifhS9evGrE95UTlsVEhYGOAT4nM?via=matrix.org&via=mozilla.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@yoavweiss:matrix.org\">@yoavweiss:matrix.org</a><br>Hey folks! I'm playing around with module scripts and I see that a module script struct is being passed to EcmaScript and back through a ParseModule.[[HostDefined]] item. I'm wondering if that is done by value or by reference. More explicitly, if I later change the module script struct, would that change be reflected when grabbing that ParseModule.[[HostDefined]]?</blockquote></mx-reply>We generally treat these things as \"by reference\". On the other hand, I'm not sure what fields of module scripts are meant to be mutable...","m.mentions":{"user_ids":["@yoavweiss:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$pqyVvoxflu_-sPmaifhS9evGrE95UTlsVEhYGOAT4nM"}},"msgtype":"m.text"},"ts":1722302807203,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$9gqqvvs_nYrQ-CAHBhCjJoRY1Wyf48etLfy81VaEn8E"},
{"content":{"body":"Domenic: I'm adding a new item that contains the resolved URL. I'll upload a draft for early review soonish","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@domenicdenicola:matrix.org\">Domenic</a>: I'm adding a new item that contains the resolved URL. I'll upload a draft for early review soonish","m.mentions":{"user_ids":["@domenicdenicola:matrix.org"]},"msgtype":"m.text"},"ts":1722313571473,"senderName":"Yoav Weiss","senderId":"@yoavweiss:matrix.org","id":"$FY-u60C07ZeOMTc1coWkEcgX92cnS7PbWhQzSyh74jQ"},
{"content":{"body":"Is there a way to run conformance checks locally? I'm seeing them failing on the bots.. https://github.com/whatwg/html/actions/runs/10158385321/job/28090331154?pr=10528","m.mentions":{},"msgtype":"m.text"},"ts":1722327729326,"senderName":"Yoav Weiss","senderId":"@yoavweiss:matrix.org","id":"$s4VR-C0j321ltOe4zC-ltJOMZ9BSlLWENZ3-PDUI1QY"},
{"content":{"body":"I tried to run `java -Xmx1g -jar ./vnu.jar --skip-non-html \"$HTML_OUTPUT\"` directly but that fails due to lack of Java installed.. I guess I can get it running through the docker build?","format":"org.matrix.custom.html","formatted_body":"I tried to run <code>java -Xmx1g -jar ./vnu.jar --skip-non-html \"$HTML_OUTPUT\"</code> directly but that fails due to lack of Java installed.. I guess I can get it running through the docker build?","m.mentions":{},"msgtype":"m.text"},"ts":1722327786750,"senderName":"Yoav Weiss","senderId":"@yoavweiss:matrix.org","id":"$DstLGoIdNAbY3dYt218H7bjNgi_K3AER8sS-sDc823Y"},
{"content":{"body":"https://github.com/validator/validator/releases has standalone binaries you can download that don’t require a Java environment","m.mentions":{},"msgtype":"m.text"},"ts":1722327982151,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$ouU4i-Q2IyRDKCOzceM3-uTaTv-L0oICjefLE1zD6_I"},
{"content":{"body":"but you can also use `curl` to send the document to the web-based checker","format":"org.matrix.custom.html","formatted_body":"but you can also use <code>curl</code> to send the document to the web-based checker","m.mentions":{},"msgtype":"m.text"},"ts":1722328015317,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$E3falCUU1EnIwPO_lJNun9JNVnaiGT3bLZtyayTo3Fg"},
{"content":{"body":"https://github.com/validator/validator/wiki/Service-»-Input-»-POST-body#examples","m.mentions":{},"msgtype":"m.text"},"ts":1722328085851,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$7WedsGQEwDDlHj0XsLD_sCmTqudm9BHpszr9KRd1HOY"},
{"content":{"body":"```\ncurl -H \"Content-Type: text/html; charset=utf-8\" \\\n    --data-binary @FILE.html \\\n    https://validator.w3.org/nu/?out=gnu\n```","format":"org.matrix.custom.html","formatted_body":"<pre><code>curl -H \"Content-Type: text/html; charset=utf-8\" \\\n    --data-binary @FILE.html \\\n    https://validator.w3.org/nu/?out=gnu\n</code></pre>\n","m.mentions":{},"msgtype":"m.text"},"ts":1722328111889,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$FKVp4iumTUvEGdZUIhnTUeyiLP1uf14ymwycW_MZRNw"},
{"content":{"body":"I'm getting a 502..","m.mentions":{},"msgtype":"m.text"},"ts":1722328413619,"senderName":"Yoav Weiss","senderId":"@yoavweiss:matrix.org","id":"$3j3ypnpRuVX4CMulWcuGJKVcONum9T4G17sdqmC5FvA"},
{"content":{"body":"for `curl -v -H \"Content-Type: text/html; charset=utf-8\"  --data-binary \"@output/index.html\" \"https://validator.w3.org/nu/?out=gnu`","format":"org.matrix.custom.html","formatted_body":"for <code>curl -v -H \"Content-Type: text/html; charset=utf-8\"  --data-binary \"@output/index.html\" \"https://validator.w3.org/nu/?out=gnu</code>","m.mentions":{},"msgtype":"m.text"},"ts":1722328438774,"senderName":"Yoav Weiss","senderId":"@yoavweiss:matrix.org","id":"$aUPbHUA-_1SQzkkljO0pJWBvx2UeJ3oW46spvCzSsG8"},
{"content":{"body":"hmm, it’s working for me","m.mentions":{},"msgtype":"m.text"},"ts":1722328601812,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$A7DdOS4LACtL-kqwhQVtBGW1veTuaWMPNrVI21bTEnU"},
{"content":{"body":"maybe open https://validator.w3.org/nu/ in a browser first?","m.mentions":{},"msgtype":"m.text"},"ts":1722328620521,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$bg_PtWjnPzQHZyjLx7JLBvLfvGEMV6XKSDhp8bBHjPE"},
{"content":{"body":"W3C has some Cloudflare abuse-mitigation thing in place","m.mentions":{},"msgtype":"m.text"},"ts":1722328666549,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$jM1jkFZY4CLjk0005Q3tHbv8bONZbIJTXJ6RenXHwPM"},
{"content":{"body":"if you have your source committed to a PR branch, I can try checking that out","m.mentions":{},"msgtype":"m.text"},"ts":1722328708985,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$5P3FXVagoPbjXKqjnNM8_MAIfZbB34ppcy0jmQoqiDE"},
{"content":{"body":"In the browser I'm getting a \"HTTP ERROR 400 Resource size exceeds limit.\"","m.mentions":{},"msgtype":"m.text"},"ts":1722328716254,"senderName":"Yoav Weiss","senderId":"@yoavweiss:matrix.org","id":"$HjyJ7ox8NI6gAtnwPsXSCdXAcUuC4FBr8ALbr2Zad8I"},
{"content":{"body":"https://github.com/whatwg/html/pull/10528/files","m.mentions":{},"msgtype":"m.text"},"ts":1722328741283,"senderName":"Yoav Weiss","senderId":"@yoavweiss:matrix.org","id":"$E7uLXnv6qQ8-SNSiQBCB9B8e-mBPWM0qqtiAJ5tdQAg"},
{"content":{"body":"tries now","m.mentions":{},"msgtype":"m.emote"},"ts":1722328761810,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$hvaysZTjC0mKa06D8ZRe74-OckbUDNPuq3AnZCtyaiA"},
{"content":{"body":"building from your patch now","m.mentions":{},"msgtype":"m.text"},"ts":1722328833605,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$8FE01D8O9KO7bxbtOY0v3dMaW_N_mmpCYAyCxCMzhIo"},
{"content":{"body":"I already found a few issues based on the CI messages, just wanted to iterate over fixing them locally, rather than on the bots","m.mentions":{},"msgtype":"m.text"},"ts":1722328975723,"senderName":"Yoav Weiss","senderId":"@yoavweiss:matrix.org","id":"$CuXfnAigDqaswxFs6jheCE2riSq4bD-CXX2CODHHbi8"},
{"content":{"body":"It may be that I need to bump the size limit","m.mentions":{},"msgtype":"m.text"},"ts":1722329091597,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$ahww52ThOwAuLThC83_KgqDt-n30Zp7ClAIdlJ9r8cc"},
{"content":{"body":"lord, what is all this stuff?\n```\n   Compiling proc-macro2 v1.0.60\n   Compiling quote v1.0.28\n   Compiling libc v0.2.146\n   Compiling parking_lot_core v0.9.8\n   Compiling lock_api v0.4.10\n   Compiling serde v1.0.164\n   Compiling syn v1.0.109\n   Compiling memchr v2.5.0\n   Compiling tokio v1.28.2\n```\nWhat part of the build needs to be compiling binaries?","format":"org.matrix.custom.html","formatted_body":"<p>lord, what is all this stuff?</p>\n<pre><code>   Compiling proc-macro2 v1.0.60\n   Compiling quote v1.0.28\n   Compiling libc v0.2.146\n   Compiling parking_lot_core v0.9.8\n   Compiling lock_api v0.4.10\n   Compiling serde v1.0.164\n   Compiling syn v1.0.109\n   Compiling memchr v2.5.0\n   Compiling tokio v1.28.2\n</code></pre>\n<p>What part of the build needs to be compiling binaries?</p>\n","m.mentions":{},"msgtype":"m.text"},"ts":1722329134542,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$ZSYVEUjyX7oYY42zUo6fqtazF5t7FFdS8BzNFUXhXwM"},
{"content":{"body":"Due to whatever that stuff is, my local spec build is failing:\n```\n  = note: ld: library 'System' not found\n          cc: error: linker command failed with exit code 1 (use -v to see invocation)\n```\nSo, trying a remote spec build now","format":"org.matrix.custom.html","formatted_body":"<p>Due to whatever that stuff is, my local spec build is failing:</p>\n<pre><code>  = note: ld: library 'System' not found\n          cc: error: linker command failed with exit code 1 (use -v to see invocation)\n</code></pre>\n<p>So, trying a remote spec build now</p>\n","m.mentions":{},"msgtype":"m.text"},"ts":1722329246488,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$or3b9gc75GPJxeyw4kNS897vKQsqh1obIerg4zQQKcI"},
{"content":{"body":"Uploading a few fixes soonish..","m.mentions":{},"msgtype":"m.text"},"ts":1722329328438,"senderName":"Yoav Weiss","senderId":"@yoavweiss:matrix.org","id":"$SB5TUPV_cjElh0g1r--zO2VPnepkUOWBeb1CASxVOsk"},
{"content":{"body":"What’s the size of your local `output/index.html` file?","format":"org.matrix.custom.html","formatted_body":"What’s the size of your local <code>output/index.html</code> file?","m.mentions":{},"msgtype":"m.text"},"ts":1722329363655,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$99S609sYXX3jt3yEJNWNmydipguaRL0va1MXY2Yawx8"},
{"content":{"body":"I currently have the maximum file size for the web-based checker set to 12MB","m.mentions":{},"msgtype":"m.text"},"ts":1722329440596,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$cfLpOEMwzLp-p-xnXbMuGcWelILkm-LnsICt2UaEVnU"},
{"content":{"body":"13.7MB","m.mentions":{},"msgtype":"m.text"},"ts":1722329530636,"senderName":"Yoav Weiss","senderId":"@yoavweiss:matrix.org","id":"$js09LDFFg932JQYcXHPxqHQ-PPYNZ1U76fr7vCHIN-s"},
{"content":{"body":"aha","m.mentions":{},"msgtype":"m.text"},"ts":1722329543157,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$uG6TpeImVvUUo4jxXDTeDYFOnuQU368OhWSJ5GZ0t1M"},
{"content":{"body":"yeah..","m.mentions":{},"msgtype":"m.text"},"ts":1722329548813,"senderName":"Yoav Weiss","senderId":"@yoavweiss:matrix.org","id":"$MV52PSOwo29TZtds6wt6w-eBtHcdt6hqW4qT_pYjVUQ"},
{"content":{"body":"OK, gimme a minute","m.mentions":{},"msgtype":"m.text"},"ts":1722329548970,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$sUZ7DkzHP9FR84cWmvFRjErn0M3-8z56C9G_HGzDxZE"},
{"content":{"body":"Yoav Weiss: please try with curl again now","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@yoavweiss:matrix.org\">Yoav Weiss</a>: please try with curl again now","m.mentions":{"user_ids":["@yoavweiss:matrix.org"]},"msgtype":"m.text"},"ts":1722329975017,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$kmCYlq-_vnegHq5cHoQ9ITG_McgpeMXqlrp4BLN1pUo"},
{"content":{"body":"Yay! (I'm still getting conformance errors, now to fix them) ","m.mentions":{},"msgtype":"m.text"},"ts":1722330092089,"senderName":"Yoav Weiss","senderId":"@yoavweiss:matrix.org","id":"$G59Kbin_M261eCDjv8RB68y2D8gX_V5ZqUL8n-tlA_8"},
{"content":{"body":"Might be worthwhile to document that curl command in the html-build instructions","m.mentions":{},"msgtype":"m.text"},"ts":1722330121316,"senderName":"Yoav Weiss","senderId":"@yoavweiss:matrix.org","id":"$q8JJwT8_p_2w-jqyYNaXz5VSHlM20fUBR32yzVhpRNQ"},
{"content":{"body":"OK, the remaining conformance issues seem to be non-blocking and aren't related to my change, but to \"  <table class=jake-diagram><thead><tr><td><th class=step>0<th class=\"step current\">1<th class=step>2<th class=step>3<th class=step>4<tbody><tr><th><code>top</code><td colspan=3 class=\"doc-0 current next-is-same-doc\">/t-a<td colspan=1 class=\"doc-0 prev-is-same-doc\">/t-a#foo<td colspan=1 class=doc-1>/t-b<tr><th><code>frames[0]</code><td colspan=1 class=doc-2>/i-0-a<td colspan=3 class=\"doc-3 current\">/i-0-b<tr><th><code>frames[1]</code><td colspan=2 class=\"doc-4 current\">/i-1-a<td colspan=2 class=doc-5>/i-1-b</table>\"","m.mentions":{},"msgtype":"m.text"},"ts":1722330467343,"senderName":"Yoav Weiss","senderId":"@yoavweiss:matrix.org","id":"$F4V74SD7cft55_kvfTlVEYHM5tJ2jaPULeD6Ql-8AP0"},
{"content":{"body":"One of the rows has 5 columns rather than 6","m.mentions":{},"msgtype":"m.text"},"ts":1722330525479,"senderName":"Yoav Weiss","senderId":"@yoavweiss:matrix.org","id":"$7Yr7TeQ23VJftROJC7sc7bsWeEzTEhVd15NBeHOUZFk"},
{"content":{"body":"That's potentially WAI: https://html.spec.whatwg.org/multipage/document-sequences.html#jake-diagrams","m.mentions":{},"msgtype":"m.text"},"ts":1722330794574,"senderName":"Yoav Weiss","senderId":"@yoavweiss:matrix.org","id":"$9cvQvtw2zJGLCu_sFjevlAdCuA25XLZhEXaLEQ8WBvA"},
{"content":{"body":"but maybe you can tell a table that a certain cell is empty. Dunno tables well enough","m.mentions":{},"msgtype":"m.text"},"ts":1722330823060,"senderName":"Yoav Weiss","senderId":"@yoavweiss:matrix.org","id":"$hM9L7C9nDPRMxmmzPNiJiHsarAKgWZmysmPwVafDVpg"}
]