[
{"content":{"body":"Chrome has started development on Private Network Access for WebSockets, which is going to require a preflight. As discussed in the following few messages after https://github.com/whatwg/websockets/issues/16#issuecomment-1926609805, we will probably need new `Access-Control-Allow-WebSocket` and `Access-Control-Request-WebSocket` headers. What's the right forum to propose and discuss those?","format":"org.matrix.custom.html","formatted_body":"Chrome has started development on Private Network Access for WebSockets, which is going to require a preflight. As discussed in the following few messages after https://github.com/whatwg/websockets/issues/16#issuecomment-1926609805, we will probably need new <code>Access-Control-Allow-WebSocket</code> and <code>Access-Control-Request-WebSocket</code> headers. What's the right forum to propose and discuss those?","m.mentions":{},"msgtype":"m.text"},"ts":1711351885271,"senderName":"Adam Rice","senderId":"@ricea:matrix.org","id":"$gvb4Cr0NIpWR5h75CE48cR97wKgcFRyUElvjR2fx5KM"},
{"content":{"body":"Adam Rice: Any reason not to just use the https://github.com/whatwg/fetch/issues tracker?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@ricea:matrix.org\">Adam Rice</a>: Any reason not to just use the https://github.com/whatwg/fetch/issues tracker?","m.mentions":{"user_ids":["@ricea:matrix.org"]},"msgtype":"m.text"},"ts":1711352221180,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$eC61uBuP6aAf5hXbJlRoN77W8lAlSlSBYQxzcgelzyc"},
{"content":{"body":"TabAtkins: algorithm=\"...\" values in Bikeshed are just for disambiguation purposes, right?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@tabatkins:matrix.org\">TabAtkins</a>: algorithm=\"...\" values in Bikeshed are just for disambiguation purposes, right?","m.mentions":{"user_ids":["@tabatkins:matrix.org"]},"msgtype":"m.text"},"ts":1711363060896,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$HgkDOS5vjY2VjpHZTuA8XxAAETvsW0OLDZ_XbBIxLe4"},
{"content":{"body":" * TabAtkins: algorithm=\"...\" values in Bikeshed are just for disambiguation purposes, right? See https://github.com/whatwg/url/pull/826 for context. I guess I'll leave it unmerged for a bit so you can review. Fortunately adding these didn't reveal any variable name errors.","format":"org.matrix.custom.html","formatted_body":" * <a href=\"https://matrix.to/#/@tabatkins:matrix.org\">TabAtkins</a>: algorithm=\"...\" values in Bikeshed are just for disambiguation purposes, right? See https://github.com/whatwg/url/pull/826 for context. I guess I'll leave it unmerged for a bit so you can review. Fortunately adding these didn't reveal any variable name errors.","m.mentions":{},"m.new_content":{"body":"TabAtkins: algorithm=\"...\" values in Bikeshed are just for disambiguation purposes, right? See https://github.com/whatwg/url/pull/826 for context. I guess I'll leave it unmerged for a bit so you can review. Fortunately adding these didn't reveal any variable name errors.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@tabatkins:matrix.org\">TabAtkins</a>: algorithm=\"...\" values in Bikeshed are just for disambiguation purposes, right? See https://github.com/whatwg/url/pull/826 for context. I guess I'll leave it unmerged for a bit so you can review. Fortunately adding these didn't reveal any variable name errors.","m.mentions":{"user_ids":["@tabatkins:matrix.org"]},"msgtype":"m.text"},"m.relates_to":{"event_id":"$HgkDOS5vjY2VjpHZTuA8XxAAETvsW0OLDZ_XbBIxLe4","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1711363168074,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$RWJX9qzlJlMLPxAHV59iWGFDB_BklTIah6umo6TYn2o"},
{"content":{"body":"> <@annevk:matrix.org> TabAtkins: algorithm=\"...\" values in Bikeshed are just for disambiguation purposes, right?\n\nYes, tho they're also required to have variable colors kick in","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$HgkDOS5vjY2VjpHZTuA8XxAAETvsW0OLDZ_XbBIxLe4?via=matrix.org&via=mozilla.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@annevk:matrix.org\">@annevk:matrix.org</a><br /><a href=\"https://matrix.to/#/@tabatkins:matrix.org\">TabAtkins</a>: algorithm=\"...\" values in Bikeshed are just for disambiguation purposes, right?</blockquote></mx-reply>Yes, tho they're also required to have variable colors kick in","m.relates_to":{"m.in_reply_to":{"event_id":"$HgkDOS5vjY2VjpHZTuA8XxAAETvsW0OLDZ_XbBIxLe4"}},"msgtype":"m.text"},"ts":1711374927089,"senderName":"TabAtkins","senderId":"@tabatkins:matrix.org","id":"$eCqY-NqblsgMcXKCiQXTtaytMKru1fuU_R03bO_GQcw"},
{"content":{"body":"TabAtkins: right, that's why it's worth adding them. (Although I also added them for algorithms that don't contain any variables, mainly for consistency.)","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@tabatkins:matrix.org\">TabAtkins</a>: right, that's why it's worth adding them. (Although I also added them for algorithms that don't contain any variables, mainly for consistency.)","m.mentions":{"user_ids":["@tabatkins:matrix.org"]},"msgtype":"m.text"},"ts":1711376515158,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$sz2j6-RPVEFURHM6g9FNYSufJ0U3cHvnohJLpj9a9ks"},
{"content":{"body":"I also use them for some useful styling, the little gray border, which I'm planning to add to the bikeshed stylesheet. Might want to look into putting it in whatwg as well","msgtype":"m.text"},"ts":1711376967634,"senderName":"TabAtkins","senderId":"@tabatkins:matrix.org","id":"$FtjLApBL3VkL4yoNc6CQ_ElIapwaRQf7cqnpVO8PDMc"},
{"content":{"body":"Seems to really help in algorithm heavy sections to know the bounds of the text","msgtype":"m.text"},"ts":1711376987960,"senderName":"TabAtkins","senderId":"@tabatkins:matrix.org","id":"$c3uxTSmGtQ6a4Jy5laCCYMpyyBDXSuigkbCsVAJz1oE"},
{"content":{"body":"TabAtkins: does the PR look okay btw?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@tabatkins:matrix.org\">TabAtkins</a>: does the PR look okay btw?","m.mentions":{"user_ids":["@tabatkins:matrix.org"]},"msgtype":"m.text"},"ts":1711377668210,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$b1eKhsPiUaBUaMW_sTKCxpiSZixwMoTlKOQxC2vntGA"},
{"content":{"body":"> <@annevk:matrix.org> TabAtkins: does the PR look okay btw?\n\nLooks reasonable to me with a quick scan","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$b1eKhsPiUaBUaMW_sTKCxpiSZixwMoTlKOQxC2vntGA?via=matrix.org&via=mozilla.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@annevk:matrix.org\">@annevk:matrix.org</a><br /><a href=\"https://matrix.to/#/@tabatkins:matrix.org\">TabAtkins</a>: does the PR look okay btw?</blockquote></mx-reply>Looks reasonable to me with a quick scan","m.relates_to":{"m.in_reply_to":{"event_id":"$b1eKhsPiUaBUaMW_sTKCxpiSZixwMoTlKOQxC2vntGA"}},"msgtype":"m.text"},"ts":1711378953037,"senderName":"TabAtkins","senderId":"@tabatkins:matrix.org","id":"$5ZLY0neBTdzeMN8CVfR0jjcSunuf2L3PjRH0Ud583Y8"},
{"content":{"body":"I think at one point I was down to <25 issues for whatwg/url. Now it's 79.","m.mentions":{},"msgtype":"m.text"},"ts":1711380731707,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$jPr4PUQBsJtqQZrOpnJZEAoHnWl6iJEmE0EWhpp7_is"},
{"content":{"body":"Just checking my sanity here... Is there any case where a Fetch-compliant browser would include multiple `Access-Control-Request-Headers` headers in a preflight request? My understanding of [CORS-preflight fetch](https://fetch.spec.whatwg.org/#cors-preflight-fetch-0) (specifically step 5.2) tells me no, but I'd appreciate confirmation üôè","format":"org.matrix.custom.html","formatted_body":"Just checking my sanity here... Is there any case where a Fetch-compliant browser would include multiple <code>Access-Control-Request-Headers</code> headers in a preflight request? My understanding of <a href=\"https://fetch.spec.whatwg.org/#cors-preflight-fetch-0\">CORS-preflight fetch</a> (specifically step 5.2) tells me no, but I'd appreciate confirmation üôè","m.mentions":{},"msgtype":"m.text"},"ts":1711385585251,"senderName":"jub0bs","senderId":"@jub0bs:matrix.org","id":"$dovWmp-d-GYxeV7Y7CsLM7Jylhdl6MEvWN58aaWOyCE"},
{"content":{"body":"For context, the reason I'm asking is that some libraries assume the presence of an arbitrary number of ACRH headers and do... funky things with them, leading to many unnecessary heap allocations. üò¨","m.mentions":{},"msgtype":"m.text"},"ts":1711385764400,"senderName":"jub0bs","senderId":"@jub0bs:matrix.org","id":"$IfGL-0HCtOkSiNWAgc9dH3Kd1uI95dXNJIzpczFwP68"},
{"content":{"body":"jub0bs: I guess middleware is not allowed to do the reverse of combine? And I guess with multiple headers you mean the equivalent of multiple H1 header lines for the same header name. If so, I don't think so.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@jub0bs:matrix.org\">jub0bs</a>: I guess middleware is not allowed to do the reverse of combine? And I guess with multiple headers you mean the equivalent of multiple H1 header lines for the same header name. If so, I don't think so.","m.mentions":{"user_ids":["@jub0bs:matrix.org"]},"msgtype":"m.text"},"ts":1711386653603,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$I0ArzLfYqegz4bKi8tbVAt380QOF3ehHnKAbqY0UGOg"},
{"content":{"body":"annevk: Thanks for your reply. üòÉ\nI'm actually asking regardless of what a middleware is \"allowed\" to do (I'm guessing you mean according to the HTTP spec).\nAnd I'm not sure what you mean by \"H1 header\", but what I mean by multiple ACRH header is something like\n\n```http\nOrigin: https://example.com\nAccess-Control-Request-Headers: foo\nAccess-Control-Request-Headers: bar\nAccess-Control-Request-Headers: baz\n```\n\nI'd like to rely on the guarantee that there be at most one `Access-Control-Request-Headers` in the preflight request.","format":"org.matrix.custom.html","formatted_body":"<p><a href=\"https://matrix.to/#/@annevk:matrix.org\">annevk</a>: Thanks for your reply. üòÉ<br>I'm actually asking regardless of what a middleware is \"allowed\" to do (I'm guessing you mean according to the HTTP spec).<br>And I'm not sure what you mean by \"H1 header\", but what I mean by multiple ACRH header is something like</p>\n<pre><code class=\"language-http\">Origin: https://example.com\nAccess-Control-Request-Headers: foo\nAccess-Control-Request-Headers: bar\nAccess-Control-Request-Headers: baz\n</code></pre>\n<p>I'd like to rely on the guarantee that there be at most one <code>Access-Control-Request-Headers</code> in the preflight request.</p>\n","m.mentions":{"user_ids":["@annevk:matrix.org"]},"msgtype":"m.text"},"ts":1711386999277,"senderName":"jub0bs","senderId":"@jub0bs:matrix.org","id":"$CZKi6q-sf5q_A-z6aWjn-ynJCeNVJxNRRT5OcrNWmCo"},
{"content":{"body":" * annevk: Thanks for your reply. üòÉ\nI'm actually asking regardless of what a middleware is \"allowed\" to do (I'm guessing you mean according to the HTTP spec).\nAnd I'm not sure what you mean by \"H1 header\", but what I mean by multiple ACRH header is something like\n\n```http\nOrigin: https://example.com\nAccess-Control-Request-Headers: foo\nAccess-Control-Request-Headers: bar\nAccess-Control-Request-Headers: baz\n```\n\nI'd like to rely on the guarantee that there be at most one `Access-Control-Request-Headers` in the preflight request. I would just like confirmation that this guarantee is provided by the Fetch standard.","format":"org.matrix.custom.html","formatted_body":" * <p><a href=\"https://matrix.to/#/@annevk:matrix.org\">annevk</a>: Thanks for your reply. üòÉ<br>I'm actually asking regardless of what a middleware is \"allowed\" to do (I'm guessing you mean according to the HTTP spec).<br>And I'm not sure what you mean by \"H1 header\", but what I mean by multiple ACRH header is something like</p>\n<pre><code class=\"language-http\">Origin: https://example.com\nAccess-Control-Request-Headers: foo\nAccess-Control-Request-Headers: bar\nAccess-Control-Request-Headers: baz\n</code></pre>\n<p>I'd like to rely on the guarantee that there be at most one <code>Access-Control-Request-Headers</code> in the preflight request. I would just like confirmation that this guarantee is provided by the Fetch standard.</p>\n","m.mentions":{},"m.new_content":{"body":"annevk: Thanks for your reply. üòÉ\nI'm actually asking regardless of what a middleware is \"allowed\" to do (I'm guessing you mean according to the HTTP spec).\nAnd I'm not sure what you mean by \"H1 header\", but what I mean by multiple ACRH header is something like\n\n```http\nOrigin: https://example.com\nAccess-Control-Request-Headers: foo\nAccess-Control-Request-Headers: bar\nAccess-Control-Request-Headers: baz\n```\n\nI'd like to rely on the guarantee that there be at most one `Access-Control-Request-Headers` in the preflight request. I would just like confirmation that this guarantee is provided by the Fetch standard.","format":"org.matrix.custom.html","formatted_body":"<p><a href=\"https://matrix.to/#/@annevk:matrix.org\">annevk</a>: Thanks for your reply. üòÉ<br>I'm actually asking regardless of what a middleware is \"allowed\" to do (I'm guessing you mean according to the HTTP spec).<br>And I'm not sure what you mean by \"H1 header\", but what I mean by multiple ACRH header is something like</p>\n<pre><code class=\"language-http\">Origin: https://example.com\nAccess-Control-Request-Headers: foo\nAccess-Control-Request-Headers: bar\nAccess-Control-Request-Headers: baz\n</code></pre>\n<p>I'd like to rely on the guarantee that there be at most one <code>Access-Control-Request-Headers</code> in the preflight request. I would just like confirmation that this guarantee is provided by the Fetch standard.</p>\n","m.mentions":{"user_ids":["@annevk:matrix.org"]},"msgtype":"m.text"},"m.relates_to":{"event_id":"$CZKi6q-sf5q_A-z6aWjn-ynJCeNVJxNRRT5OcrNWmCo","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1711387038844,"senderName":"jub0bs","senderId":"@jub0bs:matrix.org","id":"$Fd57t24MSTvv6Z2xk42opionkiT1gHy5wyefx2qJW1s"},
{"content":{"body":"More context: in one of those CORS middleware library, a single malicious 1Mb preflight request can cause 100+Mb of heap allocations, in part because they cater for multiple ACRH headers in preflight requests.","m.mentions":{},"msgtype":"m.text"},"ts":1711387131525,"senderName":"jub0bs","senderId":"@jub0bs:matrix.org","id":"$nbM19oowgkBedok_Pbk5JLgtzOzCcXMaCHUMhWIqiMY"},
{"content":{"body":" * More context: in one of those CORS middleware library, a single malicious/spoofed 1Mb preflight request can cause 100+Mb of heap allocations, in part because they cater for multiple ACRH headers in preflight requests.","m.mentions":{},"m.new_content":{"body":"More context: in one of those CORS middleware library, a single malicious/spoofed 1Mb preflight request can cause 100+Mb of heap allocations, in part because they cater for multiple ACRH headers in preflight requests.","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$nbM19oowgkBedok_Pbk5JLgtzOzCcXMaCHUMhWIqiMY","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1711387144031,"senderName":"jub0bs","senderId":"@jub0bs:matrix.org","id":"$NutmJuoCQmzsXTnYZuGJoFrvaqTcm-COqklfrs7wLcQ"},
{"content":{"body":" * More context: in one of those CORS middleware library, a single malicious/spoofed 1Mb preflight request can cause 100+Mb of heap allocations, in part because that library caters for multiple ACRH headers in preflight requests.","m.mentions":{},"m.new_content":{"body":"More context: in one of those CORS middleware library, a single malicious/spoofed 1Mb preflight request can cause 100+Mb of heap allocations, in part because that library caters for multiple ACRH headers in preflight requests.","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$nbM19oowgkBedok_Pbk5JLgtzOzCcXMaCHUMhWIqiMY","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1711387160948,"senderName":"jub0bs","senderId":"@jub0bs:matrix.org","id":"$Q5It_VxpBv96dK1p_jP8kYbXUiR-V-tp8ikxe0Ba8GQ"},
{"content":{"body":"I understood the question.","m.mentions":{},"msgtype":"m.text"},"ts":1711387170716,"senderName":"annevk","senderId":"@annevk:matrix.org","id":"$ku6ZNnjVY4aO2QBd0p8IhVcp7ZoEYcSp64-48IMM1OY"},
{"content":{"body":" * More context: in one of those CORS middleware libraries, a single malicious/spoofed 1Mb preflight request can cause 100+Mb of heap allocations, in part because that library caters for multiple ACRH headers in preflight requests.","m.mentions":{},"m.new_content":{"body":"More context: in one of those CORS middleware libraries, a single malicious/spoofed 1Mb preflight request can cause 100+Mb of heap allocations, in part because that library caters for multiple ACRH headers in preflight requests.","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$nbM19oowgkBedok_Pbk5JLgtzOzCcXMaCHUMhWIqiMY","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1711387175124,"senderName":"jub0bs","senderId":"@jub0bs:matrix.org","id":"$qQ6qy7rx4APN1YJ5uaMhftJNhL3nnjSbm6AswWezPaU"},
{"content":{"body":"Thanks!","m.mentions":{},"msgtype":"m.text"},"ts":1711387236467,"senderName":"jub0bs","senderId":"@jub0bs:matrix.org","id":"$OJkukhWuOin3N4erV2bNFK7Eq7ftzWnTENetCIN1Plw"}
]