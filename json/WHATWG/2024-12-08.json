[
{"content":{"body":"I don't think specs are expected to optimize for this non-observable behavior","m.mentions":{},"msgtype":"m.text"},"ts":1733646471952,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$lOZeKYvEu9-eNEYqPNfc8GC2Z1xoTR2AiI5jAx6NDb4"},
{"content":{"body":"(regarding the double-promise thing)","m.mentions":{},"msgtype":"m.text"},"ts":1733646488227,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$cPOKSxOQTrVFs1IwndvU07nGG2exnARudAVLcK9yJNU"},
{"content":{"body":"Sounds like you've violated this line: `Public API must not be used: while reading or writing, or performing any of the operations below, the JavaScript-modifiable reader, writer, and stream APIs (i.e. methods on the appropriate prototypes) must not be used. Instead, the streams must be manipulated directly.`","format":"org.matrix.custom.html","formatted_body":"Sounds like you've violated this line: <code>Public API must not be used: while reading or writing, or performing any of the operations below, the JavaScript-modifiable reader, writer, and stream APIs (i.e. methods on the appropriate prototypes) must not be used. Instead, the streams must be manipulated directly.</code>","m.mentions":{"user_ids":["@akaster:serenityos.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$KRw2xjEB48rnlb9ikDVe9pn8_zLoCPOHEVTHZL3bC_U"}},"msgtype":"m.text"},"ts":1733646630184,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$9iP8FyE-VfRRPDG4m-3pBkt63oMY0IoBS3lB6ZhfxFA"},
{"content":{"body":"... which would explain this whole thread :)","m.mentions":{},"msgtype":"m.text"},"ts":1733646656595,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$5PftWXRz7z8MxYbNvXR9rL3sqw4ZioQZZKQHTJ5V8wo"},
{"content":{"body":"It seems so! It took quite a bit of digging to find the \"massive fixme but it's probably fine\" comment ","msgtype":"m.text"},"ts":1733646702265,"senderName":"akaster","senderId":"@akaster:serenityos.org","id":"$jGU_qhU6RwsMmp04mjAXTkQaj3O1tsQWcF1BYe2_G6A"},
{"content":{"body":"> <@noamr:matrix.org> Sounds like you've violated this line: `Public API must not be used: while reading or writing, or performing any of the operations below, the JavaScript-modifiable reader, writer, and stream APIs (i.e. methods on the appropriate prototypes) must not be used. Instead, the streams must be manipulated directly.`\n\nThe real issue seems to be we didn't have a facility to set the internal response's body when appropriate on Response. So in the cases that we had a subclass of Response, we were setting a body that nobody used ðŸ˜…. Some class refactoring is in order","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$9iP8FyE-VfRRPDG4m-3pBkt63oMY0IoBS3lB6ZhfxFA?via=serenityos.org&via=matrix.org&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@noamr:matrix.org\">@noamr:matrix.org</a><br />Sounds like you've violated this line: <code>Public API must not be used: while reading or writing, or performing any of the operations below, the JavaScript-modifiable reader, writer, and stream APIs (i.e. methods on the appropriate prototypes) must not be used. Instead, the streams must be manipulated directly.</code></blockquote></mx-reply>The real issue seems to be we didn't have a facility to set the internal response's body when appropriate on Response. So in the cases that we had a subclass of Response, we were setting a body that nobody used ðŸ˜…. Some class refactoring is in order","m.relates_to":{"m.in_reply_to":{"event_id":"$9iP8FyE-VfRRPDG4m-3pBkt63oMY0IoBS3lB6ZhfxFA"}},"msgtype":"m.text"},"ts":1733685773535,"senderName":"akaster","senderId":"@akaster:serenityos.org","id":"$sfK4UOD96vnGGIWkeXZ2UD0_BG7rMfpmOLOFqXfnMD4"}
]