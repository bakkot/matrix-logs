[
{"content":{"body":"jmdyck: I believe it is correct albeit not clear, the Text nodes are being excluded, they are the descendants of <script> or <svg:script> that are descendants of the <legend>. So they're indeed \"descendants of descendants\".","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@jmdyck:matrix.org\">jmdyck</a>: I believe it is correct albeit not clear, the Text nodes are being excluded, they are the descendants of &lt;script&gt; or <a href=\"svg:script\">svg:script</a> that are descendants of the &lt;legend&gt;. So they're indeed \"descendants of descendants\".","m.mentions":{"user_ids":["@jmdyck:matrix.org"]},"msgtype":"m.text"},"ts":1770351169029,"senderName":"Kaiido","senderId":"@kaiido:matrix.org","id":"$OnO4XpljzgwKzXL4WWrwVPqF2uIt44n9cNG1UYMovog"},
{"content":{"body":"Phil Pizlo finally putting his Fil-C work to good use: https://yoshell.ai ðŸ˜€","m.mentions":{},"msgtype":"m.text"},"ts":1770365199951,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$ZG2gwL21Wn1G6YtROOlQv6eEWdHqb3fGa2pm6s4btUo"},
{"content":{"body":"zcorpan: I'm trying to understand how `<script>console.log(\"</script>\")</script>` manages to \"back up\" when it sees the \">\" inside the console.log string so that the script element text is just 'console.log(\"'. Do you know what tokenizer state this is? It looks to me like \"Script data double escape start state\" or \"Script data double escape end state\", but it looks like 'console.log(\"</script' has already been emitted as character tokens at that point. How does the tokenizer \"take back\" what's already been emitted?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@zcorpan:mozilla.org\">zcorpan</a>: I'm trying to understand how <code>&lt;script&gt;console.log(\"&lt;/script&gt;\")&lt;/script&gt;</code> manages to \"back up\" when it sees the \"&gt;\" inside the console.log string so that the script element text is just 'console.log(\"'. Do you know what tokenizer state this is? It looks to me like \"Script data double escape start state\" or \"Script data double escape end state\", but it looks like 'console.log(\"&lt;/script' has already been emitted as character tokens at that point. How does the tokenizer \"take back\" what's already been emitted?","m.mentions":{"user_ids":["@zcorpan:mozilla.org"]},"msgtype":"m.text"},"ts":1770376926843,"senderName":"foolip","senderId":"@foolip:matrix.org","id":"$8kOkfKA0v0JOGK-VAXB9vGD6YNpruEBLLtplehZG2P8"},
{"content":{"body":"foolip: it doesn't back up it just closes the script element there. \nhttps://html.spec.whatwg.org/#script-data-state\nhttps://html.spec.whatwg.org/#script-data-less-than-sign-state\nhttps://html.spec.whatwg.org/#script-data-end-tag-open-state\nhttps://html.spec.whatwg.org/#script-data-end-tag-name-state\n","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@foolip:matrix.org\">foolip</a>: it doesn't back up it just closes the script element there.<br>https://html.spec.whatwg.org/#script-data-state<br>https://html.spec.whatwg.org/#script-data-less-than-sign-state<br>https://html.spec.whatwg.org/#script-data-end-tag-open-state<br>https://html.spec.whatwg.org/#script-data-end-tag-name-state","m.mentions":{"user_ids":["@foolip:matrix.org"]},"msgtype":"m.text"},"ts":1770377527219,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$RiXx5nbGtvojU5TiDCjawiUrbZoqailjV0s0RSgzge4"},
{"content":{"body":"foolip: you need <script><!-- to enter https://html.spec.whatwg.org/#script-data-escaped-state","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@foolip:matrix.org\">foolip</a>: you need &lt;script&gt;&lt;!-- to enter https://html.spec.whatwg.org/#script-data-escaped-state","m.mentions":{"user_ids":["@foolip:matrix.org"]},"msgtype":"m.text"},"ts":1770377609335,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$Vmk3z-irTWkM8WRZmNchRzx_d17yINcVQOZ71qHQX0Y"},
{"content":{"body":"foolip: and <script><!--<script> to enter https://html.spec.whatwg.org/#script-data-escaped-state (which causes a single </script> to not close the element)","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@foolip:matrix.org\">foolip</a>: and &lt;script&gt;&lt;!--&lt;script&gt; to enter https://html.spec.whatwg.org/#script-data-escaped-state (which causes a single &lt;/script&gt; to not close the element)","m.mentions":{"user_ids":["@foolip:matrix.org"]},"msgtype":"m.text"},"ts":1770377704194,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$R2_xKxBwJ9YIhunHIDgv_ERQ8QnjqRHzDQjbgrWd-LE"},
{"content":{"body":"* foolip: and \\<script>\\<!--\\<script> to enter https://html.spec.whatwg.org/#script-data-double-escaped-state (which causes a single \\</script> to not close the element)","format":"org.matrix.custom.html","formatted_body":"* <a href=\"https://matrix.to/#/@foolip:matrix.org\">foolip</a>: and &lt;script&gt;&lt;!--&lt;script&gt; to enter https://html.spec.whatwg.org/#script-data-double-escaped-state (which causes a single &lt;/script&gt; to not close the element)","m.mentions":{},"m.new_content":{"body":"foolip: and \\<script>\\<!--\\<script> to enter https://html.spec.whatwg.org/#script-data-double-escaped-state (which causes a single \\</script> to not close the element)","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@foolip:matrix.org\">foolip</a>: and &lt;script&gt;&lt;!--&lt;script&gt; to enter https://html.spec.whatwg.org/#script-data-double-escaped-state (which causes a single &lt;/script&gt; to not close the element)","m.mentions":{"user_ids":["@foolip:matrix.org"]},"msgtype":"m.text"},"m.relates_to":{"event_id":"$R2_xKxBwJ9YIhunHIDgv_ERQ8QnjqRHzDQjbgrWd-LE","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1770377802224,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$sRy05H-WJFvFAF-OqQrFoA3VyD95c0jzSfZ3lZE7V60"},
{"content":{"body":"https://html.spec.whatwg.org/#script-data-double-escape-end-state handling > is where </script> is sometimes \"ignored\"","m.mentions":{},"msgtype":"m.text"},"ts":1770377893389,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$UxK8YoyE1wXGx4iBVOY6rF24ybcaW5LMA8KNowQd5OI"},
{"content":{"body":"Thanks, the `<script>console.log(\"</script>\")</script>` case is clear now. It does use the temp buffer and if that > inside the string isn't there, it emits a character token for each char in the temp buffer.","format":"org.matrix.custom.html","formatted_body":"Thanks, the <code>&lt;script&gt;console.log(\"&lt;/script&gt;\")&lt;/script&gt;</code> case is clear now. It does use the temp buffer and if that &gt; inside the string isn't there, it emits a character token for each char in the temp buffer.","m.mentions":{},"msgtype":"m.text"},"ts":1770377899887,"senderName":"foolip","senderId":"@foolip:matrix.org","id":"$X35jL03LuXqcdNypd8pqYAZZdtZkZNO1WCfXIK7lK0o"},
{"content":{"body":"That explains how the parallel lowercase + original case is handled in that case.","m.mentions":{},"msgtype":"m.text"},"ts":1770377943677,"senderName":"foolip","senderId":"@foolip:matrix.org","id":"$IwLZHMPst9JQ2NSwYhzHM9T-wD1nXXNxv-2aCx32Dyo"},
{"content":{"body":"The context is I did https://whatpr.org/html/12118/parsing.html#processing-instruction-target-state yesterday and although it's readable, I think it's an unusual use of the temp buffer that maybe I should undo.","m.mentions":{},"msgtype":"m.text"},"ts":1770378006628,"senderName":"foolip","senderId":"@foolip:matrix.org","id":"$r4iZuwJc0yT8ttw0FYxjecbWXPV07XFhjdLrW4Bs4V0"},
{"content":{"body":"is there a way to have a \"back\" button/link without js?","m.mentions":{},"msgtype":"m.text"},"ts":1770378030167,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$KziH23tx32t0TjgWAbi7UqLJoBsh0s-dHJuJ3_fMePw"},
{"content":{"body":"The motivation was to avoid saying \"discard the current token\" which the tokenizer never does elsewhere (including in Blink's implementation).","m.mentions":{},"msgtype":"m.text"},"ts":1770378043550,"senderName":"foolip","senderId":"@foolip:matrix.org","id":"$Y-Nupg1a_ytsALpBJU8Vvp6VisBP7T_rh1lpwqilJHM"},
{"content":{"body":"i was hoping there would be some obsecure href target or button command or something, but i couldn't find anything","m.mentions":{},"msgtype":"m.text"},"ts":1770378060587,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$lgYOzxrFqzHg8qHUT_S706gH5BnnoTZooDCce5lrslA"},
{"content":{"body":"The problem is there might be unbounded buffering before we know whether we're going to create a PI or a bogus comment, and that we need the data lowercase for the first but the original for the latter...","m.mentions":{},"msgtype":"m.text"},"ts":1770378093822,"senderName":"foolip","senderId":"@foolip:matrix.org","id":"$GWCoo0eVpNmJzHc5yEZ5pvVkS0hNcvhq7WNz4XQWNlA"},
{"content":{"body":"Hmm right. Maybe the target should preserve case?","m.mentions":{},"msgtype":"m.text"},"ts":1770378260798,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$74h9qSdijWgpf9hxPcWcZouTcO8xizg1xXhzMaBtf4M"},
{"content":{"body":"Huh, I didn't even think about that.","m.mentions":{},"msgtype":"m.text"},"ts":1770378284308,"senderName":"foolip","senderId":"@foolip:matrix.org","id":"$L6W-p44JA5BU5hUUxdUZbZPb30gV6xAq9FXvwHUlnhM"},
{"content":{"body":"What I did consider was letting tree construction lowercase the target.","m.mentions":{},"msgtype":"m.text"},"ts":1770378336509,"senderName":"foolip","senderId":"@foolip:matrix.org","id":"$lc2rXjWqmWaoEo_8vTNCaiZNkQEqjOM53JpfVUjuyrg"},
{"content":{"body":"But preserving case is very un-HTML-y isn't it?","m.mentions":{},"msgtype":"m.text"},"ts":1770378375385,"senderName":"foolip","senderId":"@foolip:matrix.org","id":"$Czf63yvIjMwSCBLognr1EOi8eE-nSsViaU-VFyKAB6A"},
{"content":{"body":"foolip: though https://html.spec.whatwg.org/#script-data-escaped-end-tag-name-state creates an end tag with arbitrary length and then throws it away","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@foolip:matrix.org\">foolip</a>: though https://html.spec.whatwg.org/#script-data-escaped-end-tag-name-state creates an end tag with arbitrary length and then throws it away","m.mentions":{"user_ids":["@foolip:matrix.org"]},"msgtype":"m.text"},"ts":1770378519614,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$VJKuKp8xhGfbYYZVS0y8yAAxq_56mOrDTb0tlyEx0xQ"},
{"content":{"body":"Except implementations could have a state to check what's up after temporary buffer > \"script\".length","m.mentions":{},"msgtype":"m.text"},"ts":1770378591222,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$bMQIjRJF-zEvfnwbZxE8p9NJwbqifVUzQQxIXx2Z93U"},
{"content":{"body":"Hmm, but it never says \"discard the token\" or something like, it just emit another token.","m.mentions":{},"msgtype":"m.text"},"ts":1770378608752,"senderName":"foolip","senderId":"@foolip:matrix.org","id":"$v_OBbWTb_qLCLBEn_V0ccHfqTNaEweRpMWAgEvQSGQg"},
{"content":{"body":"foolip: anything else","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@foolip:matrix.org\">foolip</a>: anything else","m.mentions":{"user_ids":["@foolip:matrix.org"]},"msgtype":"m.text"},"ts":1770378645167,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$nXk1rg4WTUVojestfwlheIVMAyJZb8K66VTm9WVwTHA"},
{"content":{"body":"or > when temporary buffer != \"script\"","m.mentions":{},"msgtype":"m.text"},"ts":1770378669302,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$sAgGuNlo57hV5ugls57CVHKM8mfevz9v6ecPEUjdtzk"},
{"content":{"body":"Right, but seemingly not explicitly saying that the current tag token is no longer current, right?","m.mentions":{},"msgtype":"m.text"},"ts":1770378738993,"senderName":"foolip","senderId":"@foolip:matrix.org","id":"$mpDyonaWazXmA3UBOXLYAaerVD7HTMjWhTiCnTy-RSE"},
{"content":{"body":"Maybe something else is guaranteed to say \"create a bla token\" before anything can get confused.","m.mentions":{},"msgtype":"m.text"},"ts":1770378765244,"senderName":"foolip","senderId":"@foolip:matrix.org","id":"$dK2xoohTX-aAbGW52c6RC14vhSDG071EE8fGmRNQ30g"},
{"content":{"body":"Right the end tag token is created but then nothing happens with it","m.mentions":{},"msgtype":"m.text"},"ts":1770378809100,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$SJ878TQupwNvAyvMiiFAIN3SWJWzSj6oD0TXGJBM_bY"},
{"content":{"body":"I see that in Blink, for this case, there's a special `buffered_end_tag_name_`, so the token is only created once we know what it's going to be.","format":"org.matrix.custom.html","formatted_body":"I see that in Blink, for this case, there's a special <code>buffered_end_tag_name_</code>, so the token is only created once we know what it's going to be.","m.mentions":{},"msgtype":"m.text"},"ts":1770378863660,"senderName":"foolip","senderId":"@foolip:matrix.org","id":"$9VzPMZ9W5FhBqkmfMWx9D0j6fLanJUgeVIgE9wFpjSo"}
]