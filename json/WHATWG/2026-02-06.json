[
{"content":{"body":"jmdyck: I believe it is correct albeit not clear, the Text nodes are being excluded, they are the descendants of <script> or <svg:script> that are descendants of the <legend>. So they're indeed \"descendants of descendants\".","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@jmdyck:matrix.org\">jmdyck</a>: I believe it is correct albeit not clear, the Text nodes are being excluded, they are the descendants of &lt;script&gt; or <a href=\"svg:script\">svg:script</a> that are descendants of the &lt;legend&gt;. So they're indeed \"descendants of descendants\".","m.mentions":{"user_ids":["@jmdyck:matrix.org"]},"msgtype":"m.text"},"ts":1770351169029,"senderName":"Kaiido","senderId":"@kaiido:matrix.org","id":"$OnO4XpljzgwKzXL4WWrwVPqF2uIt44n9cNG1UYMovog"},
{"content":{"body":"Phil Pizlo finally putting his Fil-C work to good use: https://yoshell.ai ðŸ˜€","m.mentions":{},"msgtype":"m.text"},"ts":1770365199951,"senderName":"sideshowbarker","senderId":"@sideshowbarker:matrix.org","id":"$ZG2gwL21Wn1G6YtROOlQv6eEWdHqb3fGa2pm6s4btUo"},
{"content":{"body":"zcorpan: I'm trying to understand how `<script>console.log(\"</script>\")</script>` manages to \"back up\" when it sees the \">\" inside the console.log string so that the script element text is just 'console.log(\"'. Do you know what tokenizer state this is? It looks to me like \"Script data double escape start state\" or \"Script data double escape end state\", but it looks like 'console.log(\"</script' has already been emitted as character tokens at that point. How does the tokenizer \"take back\" what's already been emitted?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@zcorpan:mozilla.org\">zcorpan</a>: I'm trying to understand how <code>&lt;script&gt;console.log(\"&lt;/script&gt;\")&lt;/script&gt;</code> manages to \"back up\" when it sees the \"&gt;\" inside the console.log string so that the script element text is just 'console.log(\"'. Do you know what tokenizer state this is? It looks to me like \"Script data double escape start state\" or \"Script data double escape end state\", but it looks like 'console.log(\"&lt;/script' has already been emitted as character tokens at that point. How does the tokenizer \"take back\" what's already been emitted?","m.mentions":{"user_ids":["@zcorpan:mozilla.org"]},"msgtype":"m.text"},"ts":1770376926843,"senderName":"foolip","senderId":"@foolip:matrix.org","id":"$8kOkfKA0v0JOGK-VAXB9vGD6YNpruEBLLtplehZG2P8"},
{"content":{"body":"foolip: it doesn't back up it just closes the script element there. \nhttps://html.spec.whatwg.org/#script-data-state\nhttps://html.spec.whatwg.org/#script-data-less-than-sign-state\nhttps://html.spec.whatwg.org/#script-data-end-tag-open-state\nhttps://html.spec.whatwg.org/#script-data-end-tag-name-state\n","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@foolip:matrix.org\">foolip</a>: it doesn't back up it just closes the script element there.<br>https://html.spec.whatwg.org/#script-data-state<br>https://html.spec.whatwg.org/#script-data-less-than-sign-state<br>https://html.spec.whatwg.org/#script-data-end-tag-open-state<br>https://html.spec.whatwg.org/#script-data-end-tag-name-state","m.mentions":{"user_ids":["@foolip:matrix.org"]},"msgtype":"m.text"},"ts":1770377527219,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$RiXx5nbGtvojU5TiDCjawiUrbZoqailjV0s0RSgzge4"},
{"content":{"body":"foolip: you need <script><!-- to enter https://html.spec.whatwg.org/#script-data-escaped-state","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@foolip:matrix.org\">foolip</a>: you need &lt;script&gt;&lt;!-- to enter https://html.spec.whatwg.org/#script-data-escaped-state","m.mentions":{"user_ids":["@foolip:matrix.org"]},"msgtype":"m.text"},"ts":1770377609335,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$Vmk3z-irTWkM8WRZmNchRzx_d17yINcVQOZ71qHQX0Y"},
{"content":{"body":"foolip: and <script><!--<script> to enter https://html.spec.whatwg.org/#script-data-escaped-state (which causes a single </script> to not close the element)","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@foolip:matrix.org\">foolip</a>: and &lt;script&gt;&lt;!--&lt;script&gt; to enter https://html.spec.whatwg.org/#script-data-escaped-state (which causes a single &lt;/script&gt; to not close the element)","m.mentions":{"user_ids":["@foolip:matrix.org"]},"msgtype":"m.text"},"ts":1770377704194,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$R2_xKxBwJ9YIhunHIDgv_ERQ8QnjqRHzDQjbgrWd-LE"},
{"content":{"body":"* foolip: and \\<script>\\<!--\\<script> to enter https://html.spec.whatwg.org/#script-data-double-escaped-state (which causes a single \\</script> to not close the element)","format":"org.matrix.custom.html","formatted_body":"* <a href=\"https://matrix.to/#/@foolip:matrix.org\">foolip</a>: and &lt;script&gt;&lt;!--&lt;script&gt; to enter https://html.spec.whatwg.org/#script-data-double-escaped-state (which causes a single &lt;/script&gt; to not close the element)","m.mentions":{},"m.new_content":{"body":"foolip: and \\<script>\\<!--\\<script> to enter https://html.spec.whatwg.org/#script-data-double-escaped-state (which causes a single \\</script> to not close the element)","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@foolip:matrix.org\">foolip</a>: and &lt;script&gt;&lt;!--&lt;script&gt; to enter https://html.spec.whatwg.org/#script-data-double-escaped-state (which causes a single &lt;/script&gt; to not close the element)","m.mentions":{"user_ids":["@foolip:matrix.org"]},"msgtype":"m.text"},"m.relates_to":{"event_id":"$R2_xKxBwJ9YIhunHIDgv_ERQ8QnjqRHzDQjbgrWd-LE","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1770377802224,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$sRy05H-WJFvFAF-OqQrFoA3VyD95c0jzSfZ3lZE7V60"},
{"content":{"body":"https://html.spec.whatwg.org/#script-data-double-escape-end-state handling > is where </script> is sometimes \"ignored\"","m.mentions":{},"msgtype":"m.text"},"ts":1770377893389,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$UxK8YoyE1wXGx4iBVOY6rF24ybcaW5LMA8KNowQd5OI"},
{"content":{"body":"Thanks, the `<script>console.log(\"</script>\")</script>` case is clear now. It does use the temp buffer and if that > inside the string isn't there, it emits a character token for each char in the temp buffer.","format":"org.matrix.custom.html","formatted_body":"Thanks, the <code>&lt;script&gt;console.log(\"&lt;/script&gt;\")&lt;/script&gt;</code> case is clear now. It does use the temp buffer and if that &gt; inside the string isn't there, it emits a character token for each char in the temp buffer.","m.mentions":{},"msgtype":"m.text"},"ts":1770377899887,"senderName":"foolip","senderId":"@foolip:matrix.org","id":"$X35jL03LuXqcdNypd8pqYAZZdtZkZNO1WCfXIK7lK0o"},
{"content":{"body":"That explains how the parallel lowercase + original case is handled in that case.","m.mentions":{},"msgtype":"m.text"},"ts":1770377943677,"senderName":"foolip","senderId":"@foolip:matrix.org","id":"$IwLZHMPst9JQ2NSwYhzHM9T-wD1nXXNxv-2aCx32Dyo"},
{"content":{"body":"The context is I did https://whatpr.org/html/12118/parsing.html#processing-instruction-target-state yesterday and although it's readable, I think it's an unusual use of the temp buffer that maybe I should undo.","m.mentions":{},"msgtype":"m.text"},"ts":1770378006628,"senderName":"foolip","senderId":"@foolip:matrix.org","id":"$r4iZuwJc0yT8ttw0FYxjecbWXPV07XFhjdLrW4Bs4V0"},
{"content":{"body":"is there a way to have a \"back\" button/link without js?","m.mentions":{},"msgtype":"m.text"},"ts":1770378030167,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$KziH23tx32t0TjgWAbi7UqLJoBsh0s-dHJuJ3_fMePw"},
{"content":{"body":"The motivation was to avoid saying \"discard the current token\" which the tokenizer never does elsewhere (including in Blink's implementation).","m.mentions":{},"msgtype":"m.text"},"ts":1770378043550,"senderName":"foolip","senderId":"@foolip:matrix.org","id":"$Y-Nupg1a_ytsALpBJU8Vvp6VisBP7T_rh1lpwqilJHM"},
{"content":{"body":"i was hoping there would be some obsecure href target or button command or something, but i couldn't find anything","m.mentions":{},"msgtype":"m.text"},"ts":1770378060587,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$lgYOzxrFqzHg8qHUT_S706gH5BnnoTZooDCce5lrslA"},
{"content":{"body":"The problem is there might be unbounded buffering before we know whether we're going to create a PI or a bogus comment, and that we need the data lowercase for the first but the original for the latter...","m.mentions":{},"msgtype":"m.text"},"ts":1770378093822,"senderName":"foolip","senderId":"@foolip:matrix.org","id":"$GWCoo0eVpNmJzHc5yEZ5pvVkS0hNcvhq7WNz4XQWNlA"},
{"content":{"body":"Hmm right. Maybe the target should preserve case?","m.mentions":{},"msgtype":"m.text"},"ts":1770378260798,"senderName":"zcorpan","senderId":"@zcorpan:mozilla.org","id":"$74h9qSdijWgpf9hxPcWcZouTcO8xizg1xXhzMaBtf4M"},
{"content":{"body":"Huh, I didn't even think about that.","m.mentions":{},"msgtype":"m.text"},"ts":1770378284308,"senderName":"foolip","senderId":"@foolip:matrix.org","id":"$L6W-p44JA5BU5hUUxdUZbZPb30gV6xAq9FXvwHUlnhM"}
]