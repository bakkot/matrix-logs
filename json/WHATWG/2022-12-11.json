[
{"content":{"body":"howdy folks! I'm working on implementing <link> on top of fetch primitives, and I've hit a problem:","msgtype":"m.text","org.matrix.msc1767.text":"howdy folks! I'm working on implementing <link> on top of fetch primitives, and I've hit a problem:"},"ts":1670762226847,"senderName":"Andreas Kling","senderId":"@awesomekling:matrix.org","id":"$o3eUifiSSw3PlS8BCrZZVmpYLU2wuRjuNtPSl54q56I"},
{"content":{"body":"fast-forwarding through all the setup and most of fetch itself, once we get to `fully read` (https://fetch.spec.whatwg.org/#body-fully-read) step 5, we're asked to `react` (https://webidl.spec.whatwg.org/#dfn-perform-steps-once-promise-is-settled) which ends up calling `PerformPromiseThen` (https://tc39.es/ecma262/#sec-performpromisethen) which calls `HostMakeJobCallback` (https://html.spec.whatwg.org/multipage/webappapis.html#hostmakejobcallback)","format":"org.matrix.custom.html","formatted_body":"fast-forwarding through all the setup and most of fetch itself, once we get to <code>fully read</code> (https://fetch.spec.whatwg.org/#body-fully-read) step 5, we're asked to <code>react</code> (https://webidl.spec.whatwg.org/#dfn-perform-steps-once-promise-is-settled) which ends up calling <code>PerformPromiseThen</code> (https://tc39.es/ecma262/#sec-performpromisethen) which calls <code>HostMakeJobCallback</code> (https://html.spec.whatwg.org/multipage/webappapis.html#hostmakejobcallback)","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"fast-forwarding through all the setup and most of fetch itself, once we get to `fully read` (https://fetch.spec.whatwg.org/#body-fully-read) step 5, we're asked to `react` (https://webidl.spec.whatwg.org/#dfn-perform-steps-once-promise-is-settled) which ends up calling `PerformPromiseThen` (https://tc39.es/ecma262/#sec-performpromisethen) which calls `HostMakeJobCallback` (https://html.spec.whatwg.org/multipage/webappapis.html#hostmakejobcallback)","mimetype":"text/plain"},{"body":"fast-forwarding through all the setup and most of fetch itself, once we get to <code>fully read</code> (https://fetch.spec.whatwg.org/#body-fully-read) step 5, we're asked to <code>react</code> (https://webidl.spec.whatwg.org/#dfn-perform-steps-once-promise-is-settled) which ends up calling <code>PerformPromiseThen</code> (https://tc39.es/ecma262/#sec-performpromisethen) which calls <code>HostMakeJobCallback</code> (https://html.spec.whatwg.org/multipage/webappapis.html#hostmakejobcallback)","mimetype":"text/html"}]},"ts":1670762249634,"senderName":"Andreas Kling","senderId":"@awesomekling:matrix.org","id":"$rIbS18lvSFbdhZ9m8ZXqMj6Nt3MhUYD8wboz5prldlM"},
{"content":{"body":"in `HostMakeJobCallback` it wants the incumbent settings object, but since I'm just reacting to the HTML tree-build, there's no script-having execution context present. this breaks the assertion in `incumbent settings object` step 2.1 (https://html.spec.whatwg.org/multipage/webappapis.html#incumbent-settings-object)","format":"org.matrix.custom.html","formatted_body":"in <code>HostMakeJobCallback</code> it wants the incumbent settings object, but since I'm just reacting to the HTML tree-build, there's no script-having execution context present. this breaks the assertion in <code>incumbent settings object</code> step 2.1 (https://html.spec.whatwg.org/multipage/webappapis.html#incumbent-settings-object)","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"in `HostMakeJobCallback` it wants the incumbent settings object, but since I'm just reacting to the HTML tree-build, there's no script-having execution context present. this breaks the assertion in `incumbent settings object` step 2.1 (https://html.spec.whatwg.org/multipage/webappapis.html#incumbent-settings-object)","mimetype":"text/plain"},{"body":"in <code>HostMakeJobCallback</code> it wants the incumbent settings object, but since I'm just reacting to the HTML tree-build, there's no script-having execution context present. this breaks the assertion in <code>incumbent settings object</code> step 2.1 (https://html.spec.whatwg.org/multipage/webappapis.html#incumbent-settings-object)","mimetype":"text/html"}]},"ts":1670762257314,"senderName":"Andreas Kling","senderId":"@awesomekling:matrix.org","id":"$3Q3hZJGKJdCmWOeerxZKAgQyocIT2T7_p-RPkmL1lzY"},
{"content":{"body":"what am I missing here? was something above supposed to do a \"prepare to run callback\" (and thus populating the backup incumbent settings object stack)? or could this be a spec issue? (if the spec assumes that fetch operations always happen within some kind of JS execution context)","msgtype":"m.text","org.matrix.msc1767.text":"what am I missing here? was something above supposed to do a \"prepare to run callback\" (and thus populating the backup incumbent settings object stack)? or could this be a spec issue? (if the spec assumes that fetch operations always happen within some kind of JS execution context)"},"ts":1670762266403,"senderName":"Andreas Kling","senderId":"@awesomekling:matrix.org","id":"$lDcTlxAZTipKEasFlZjCd1bqM8CZ_CPa2bPwy1umoLw"}
]