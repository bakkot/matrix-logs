[
{"content":{"body":"Domenic: FYI: https://github.com/whatwg/storage/pull/130 also failed participation check (I usually fix these by just telling participate to update the PR)","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@domenicdenicola:matrix.org\">Domenic</a>: FYI: https://github.com/whatwg/storage/pull/130 also failed participation check (I usually fix these by just telling participate to update the PR)","msgtype":"m.text"},"ts":1637767465127,"senderName":"annevk","senderId":"@annevk:mozilla.org","id":"$2YwfNtwCeb36J1oXzU8_8PID3p8y_LV322Jwpxc2H2g"},
{"content":{"body":"Domenic: we should maybe have a better endpoint for that. E.g., I can browse to https://participate.whatwg.org/agreement-status?user=annevk&repo=storage and submit the URL of that PR there and it all works out, but it's a lil weird to have to fill in a (random) user and repo.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@domenicdenicola:matrix.org\">Domenic</a>: we should maybe have a better endpoint for that. E.g., I can browse to https://participate.whatwg.org/agreement-status?user=annevk&amp;repo=storage and submit the URL of that PR there and it all works out, but it's a lil weird to have to fill in a (random) user and repo.","msgtype":"m.text"},"ts":1637767546490,"senderName":"annevk","senderId":"@annevk:mozilla.org","id":"$UFUy9iaHLB0J0VcVQMrZIqe2w4yU60z7MUgkQXZPkiQ"},
{"content":{"body":"The logs look fine... the webhook payload was delivered and the server sent back a 204","msgtype":"m.text"},"ts":1637767614221,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$UVlFWoRfSgI12yc1mjLY-xZDISVuR_wzMy4-carWQHI"},
{"content":{"body":"I guess we could add more logging, and maybe send that back instead of a 204","msgtype":"m.text"},"ts":1637767622575,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$GnTmMm7GUeAZeElbaJFeVMv-wq_YDkUao7rnHUFp2zw"},
{"content":{"body":"Like maybe some random thing happened which caused one of the early bailouts in this function to be hit before we got to createCommitStatus(): https://github.com/whatwg/participate.whatwg.org/blob/main/lib/pr-webhook.js#L6-L40","msgtype":"m.text"},"ts":1637767686984,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$lERrzqkm7Dj3SY8tT9nZAmxzm54WDK-f4dE3Ia37yYg"},
{"content":{"body":"Domenic: wdyt of a spec change to prevent focusing steps on disconnected <dialog>? This is already what we ship in STP fwiw: https://wpt.fyi/results/html/semantics/interactive-elements/the-dialog-element/dialog-focusing-steps-disconnected.html?label=master&label=experimental&product=chrome&product=firefox&product=safari&aligned&q=the-dialog-element","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@domenicdenicola:matrix.org\">Domenic</a>: wdyt of a spec change to prevent focusing steps on disconnected &lt;dialog&gt;? This is already what we ship in STP fwiw: https://wpt.fyi/results/html/semantics/interactive-elements/the-dialog-element/dialog-focusing-steps-disconnected.html?label=master&amp;label=experimental&amp;product=chrome&amp;product=firefox&amp;product=safari&amp;aligned&amp;q=the-dialog-element","msgtype":"m.text"},"ts":1637768164235,"senderName":"ntim","senderId":"@ntim:mozilla.org","id":"$swddE4lnZ7R3tmVceciLf7MDDRgHbAxGP8HgLLDeSz0"},
{"content":{"body":"https://html.spec.whatwg.org/multipage/interactive-elements.html#dialog-focusing-steps","msgtype":"m.text"},"ts":1637768245153,"senderName":"ntim","senderId":"@ntim:mozilla.org","id":"$pI66mZW13MJ78T4NpOdDMrTaA3lPPOoXOQo0LHiv7Vw"},
{"content":{"body":"ntim: I think the spec already does that. Or rather, it runs the focusing steps, but because it finds nothing focusable, the focusing steps are a no-op.","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@ntim:mozilla.org\">ntim</a>: I think the spec already does that. Or rather, it runs the focusing steps, but because it finds nothing focusable, the focusing steps are a no-op.","msgtype":"m.text"},"ts":1637768261397,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$8yTJcLqdYW5p-9f1UmZLBTSAUIFtdago-wGTXkP5T4Q"},
{"content":{"body":"\"If subject is inert, return.\" -> \"If subject is disconnected or inert, return.","msgtype":"m.text"},"ts":1637768266273,"senderName":"ntim","senderId":"@ntim:mozilla.org","id":"$1iSN7MTsX_6AlzvuNzcmBZhtzZjTUUOohxd1JC2SWD8"},
{"content":{"body":"The spec even has a note: \"If control is not focusable, this will do nothing. For modal dialogs, this means that any earlier modifications to the focused area of the document will apply.\"","msgtype":"m.text"},"ts":1637768297089,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$FeHH1AKQREcqJcmG8kWZ7HghOQDlTfxoPUgLspVj7h8"},
{"content":{"body":"(But, disconnected modal dialogs already threw in step 3 of showModal())","msgtype":"m.text"},"ts":1637768313906,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$ELstQcwVy-S8Qd7GzS0VNQl49itEgc6gwyGAlMmaspY"},
{"content":{"body":" * (But, disconnected modal dialogs already threw in step 3 of showModal())","m.new_content":{"body":"(But, disconnected modal dialogs already threw in step 3 of showModal())","msgtype":"m.text"},"m.relates_to":{"event_id":"$ELstQcwVy-S8Qd7GzS0VNQl49itEgc6gwyGAlMmaspY","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1637768325217,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$wnGz_pP0rHP8c4_EBO_tWGbWj7mwq8eE1EKSaykEt9U"},
{"content":{"body":"wondering why the test fails in Chrome & FF","msgtype":"m.text"},"ts":1637768353542,"senderName":"ntim","senderId":"@ntim:mozilla.org","id":"$w70aUTnVcAoOXzZbZOTvR6mWjtjF8Ip0v2pWwiYf8II"},
{"content":{"body":"Yeah fair question","msgtype":"m.text"},"ts":1637768366829,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$6IRbGzoGMrmtfbyHt1dUTB-zgQAMFE8JUcwFWaNdmjM"},
{"content":{"body":"Looks like Chrome resets focus to body","msgtype":"m.text"},"ts":1637768415443,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$iz1mAEYJwuV42z-yd0sQAPyiC4FBcpKFlehSENcJm6w"},
{"content":{"body":"yeah, it could have worked this way as well in STP, it was an intentional choice from me to just skip focusing steps","msgtype":"m.text"},"ts":1637768514998,"senderName":"ntim","senderId":"@ntim:mozilla.org","id":"$qLlk-r_uBszUMUAHKHijAWfBKkrfuWH4ZKuQmAJjueI"},
{"content":{"body":"Domenic: I think \"Run the focusing steps for control.\" means focusing the body when control is disconnected for current implementations","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@domenicdenicola:matrix.org\">Domenic</a>: I think &quot;Run the focusing steps for control.&quot; means focusing the body when control is disconnected for current implementations","msgtype":"m.text"},"ts":1637768548170,"senderName":"ntim","senderId":"@ntim:mozilla.org","id":"$byopn7t1yjHEHAyC5ygz0ppW4RmACoonhQFn63Mbpro"},
{"content":{"body":"Oh, that's weird","msgtype":"m.text"},"ts":1637768566046,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$AhgYIPfMxTZ19gSKYTgbE7bRQAwzqj28sDsFnIJvdas"},
{"content":{"body":"(FF included)","msgtype":"m.text"},"ts":1637768569102,"senderName":"ntim","senderId":"@ntim:mozilla.org","id":"$UA8Dz4aNAVhPFrSHrRlSptEeOel8fR3KRhC3SvWHi6g"},
{"content":{"body":"ntim: not per my testing, in FF and Chrome: https://jsbin.com/fokusafumi/edit?html,console,output","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@ntim:mozilla.org\">ntim</a>: not per my testing, in FF and Chrome: https://jsbin.com/fokusafumi/edit?html,console,output","msgtype":"m.text"},"ts":1637768659516,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$FT3irmpe_-VBuohUtTqKrioKzkvSn7uBkFlkXlhCpM8"},
{"content":{"body":"that's weird","msgtype":"m.text"},"ts":1637768724768,"senderName":"ntim","senderId":"@ntim:mozilla.org","id":"$avSas8PoQ-rKHCG83Ma0cr2TpbAcN_npQVIV0ZSv17E"},
{"content":{"body":"if I remove https://webkit-search.igalia.com/webkit/source/Source/WebCore/html/HTMLDialogElement.cpp#126-127 from webkit, it also does the same as ff and chrome","msgtype":"m.text"},"ts":1637768766116,"senderName":"ntim","senderId":"@ntim:mozilla.org","id":"$MGbHs1DRQwZKYoDJHNfWBWnB5vS_RlJcP2omRdbLAcU"},
{"content":{"body":"Domenic: oh, the old version of the spec had this: https://webkit-search.igalia.com/webkit/source/Source/WebCore/html/HTMLDialogElement.cpp#154-155","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@domenicdenicola:matrix.org\">Domenic</a>: oh, the old version of the spec had this: https://webkit-search.igalia.com/webkit/source/Source/WebCore/html/HTMLDialogElement.cpp#154-155","msgtype":"m.text"},"ts":1637769136512,"senderName":"ntim","senderId":"@ntim:mozilla.org","id":"$UjI9P2cCuK11y5qFpsbtkkH-RkPwz22N_hdTmKVrN_Y"},
{"content":{"body":"which basically sets focus to body","msgtype":"m.text"},"ts":1637769150333,"senderName":"ntim","senderId":"@ntim:mozilla.org","id":"$K1WVJnVUbO5XAu06GVWiXyJ1su_3hk2sTTb3MUuajoQ"},
{"content":{"body":"Ah, fascinating","msgtype":"m.text"},"ts":1637769186926,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$MiKdsTQI1e_af76SePMNbMT-Dd3cjvVT4H0ok3mAtuw"},
{"content":{"body":"Our earliest commit snapshot (i.e. the first version of the spec after the move to GitHub, in 2015) doesn't seem to have such a step: https://html.spec.whatwg.org/commit-snapshots/c9e804f04d03a0658bfa689cb0f368a4d2e37936/#dialog-focusing-steps","msgtype":"m.text"},"ts":1637769255188,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$tLb6mBRTzCutP8Q8Wp4TVLWJ6ZvQwiKUXErhJM0nwtc"},
{"content":{"body":"https://source.chromium.org/chromium/chromium/src/+/main:third_party/blink/renderer/core/html/html_dialog_element.cc;l=73-77;drc=de68be3f18ba99cc01d75903e167ca09bade253c?q=html_dialog_element&ss=chromium","msgtype":"m.text"},"ts":1637769503517,"senderName":"ntim","senderId":"@ntim:mozilla.org","id":"$Qo8O1TgkExdk0w4L4US-K-ccrDxAMJ7qPcObVhew7bk"},
{"content":{"body":"chromium does this too","msgtype":"m.text"},"ts":1637769506994,"senderName":"ntim","senderId":"@ntim:mozilla.org","id":"$QWIBICNnVJjQHOsqCrmbP9MuiVF17qAsF2UPJxcH6DU"},
{"content":{"body":"let me remember the context","msgtype":"m.text"},"ts":1637769526774,"senderName":"ntim","senderId":"@ntim:mozilla.org","id":"$fQXTrAPlm8VMg-H7jUM8nk4cpw-b8TkHT2cVFIqVgA8"},
{"content":{"body":"similar stuff in FF: https://searchfox.org/mozilla-central/source/dom/html/HTMLDialogElement.cpp#186-197","msgtype":"m.text"},"ts":1637769655709,"senderName":"ntim","senderId":"@ntim:mozilla.org","id":"$Yfr7-0nk9WkfaknLoG5lMTyEwA7kPTYvUFn8B6aXBVI"},
{"content":{"body":"Domenic: from what I recall, that made sense to me because otherwise focus would stay on an inert element in the showModal case","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@domenicdenicola:matrix.org\">Domenic</a>: from what I recall, that made sense to me because otherwise focus would stay on an inert element in the showModal case","msgtype":"m.text"},"ts":1637769781362,"senderName":"ntim","senderId":"@ntim:mozilla.org","id":"$BPCYLWp49U9Fz5UV9cV7Bxu9x1UAOfO-fEDOIfFTu8c"},
{"content":{"body":"but yeah right it's not part of the spec","msgtype":"m.text"},"ts":1637769791103,"senderName":"ntim","senderId":"@ntim:mozilla.org","id":"$kLSE8uB7eIgTuPfwVNFLdZNdUDxxVPD_UYZcpytPbus"},
{"content":{"body":"Hmm interesting to think about the showModal case","msgtype":"m.text"},"ts":1637769837574,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$hEF_IElfgkdFoOuu06Gf3IthHM181fWxTy90LjjW16I"},
{"content":{"body":"I'm happy to just fix Chromium to pass the test you pointed out since it seems more correct anyway... but yeah I wonder what the consequences would be of deleting that line.","msgtype":"m.text"},"ts":1637769873644,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$ROIKUGPSeitNyyCfzKXfm5qgn_XXBF9gfEnjVABkoas"},
{"content":{"body":"I think the risk is to keep focus on an element behind the dialog","msgtype":"m.text"},"ts":1637769927556,"senderName":"ntim","senderId":"@ntim:mozilla.org","id":"$BLpzCo-l2F95ZqchfjTa4lEEm1W41bADWBKPi8hjco4"},
{"content":{"body":"in the event that the control is not focusable","msgtype":"m.text"},"ts":1637769942424,"senderName":"ntim","senderId":"@ntim:mozilla.org","id":"$OntrjAzHx-DDAk9rjyQ1Dr-0QoaFrD7b6GfW77dotC4"},
{"content":{"body":"and in the showModal case that might be bogus","msgtype":"m.text"},"ts":1637769964722,"senderName":"ntim","senderId":"@ntim:mozilla.org","id":"$9HUlgjKtqsUGy740EW57dPQBeu24urngUM3GEt3gMcs"},
{"content":{"body":"So the spec solves that in another way, which is the focus fixup rule","msgtype":"m.text"},"ts":1637770227266,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$npbV52VLy6SWwobl3K22v4xsm4aY_6jbmL5aXlM-gmA"},
{"content":{"body":"When the modal dialog makes everything inert, we hit https://html.spec.whatwg.org/#focus-fixup-rule","msgtype":"m.text"},"ts":1637770242242,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$E9qaWM_cnXyO6nSeV2X0eesMt38ghgTvjSNZwvIb8-A"},
{"content":{"body":"See https://html.spec.whatwg.org/#dom-dialog-showmodal step 6","msgtype":"m.text"},"ts":1637770249579,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$yfMPR1cQhNTjQinBAK5q_RnFznbbyhGopk8jU_MIo6I"},
{"content":{"body":"But focus fixup rule is very \"action at a distance\" so I can easily believe implementations need more special code for that","msgtype":"m.text"},"ts":1637770269766,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$MKlKsfke71JEqDD96D-0SNcDP1tWy-hd-p9NbYicb5o"},
{"content":{"body":"I think I remember adding that paragraph explaining the focus fixup rule connection so hopefully we added tests at the same time...","msgtype":"m.text"},"ts":1637770292615,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$ok-k4Y4wRwR6QctnQxIgQzx_sxzNODfyLdT9S1nfYhs"},
{"content":{"body":"Domenic: so I guess the right logic should be `else if (is_modal) { setFocusedElement(nullptr) }`","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@domenicdenicola:matrix.org\">Domenic</a>: so I guess the right logic should be <code>else if (is_modal) { setFocusedElement(nullptr) }</code>","msgtype":"m.text"},"ts":1637783140863,"senderName":"ntim","senderId":"@ntim:mozilla.org","id":"$8Hs2itgLXUQ0W5hrAcuWSvDfvJg3HtSX4ElnF0v6JYI"},
{"content":{"body":"I guess those specific LoC were specifically to implement the fixup rule","msgtype":"m.text"},"ts":1637783192744,"senderName":"ntim","senderId":"@ntim:mozilla.org","id":"$Np7sjLOXl6IMTd4dLwz_0-IW0oV31ONMhM1tap3J0v0"},
{"content":{"body":"Yes, sounds right to me","msgtype":"m.text"},"ts":1637783992591,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$lm5hZRjU60mFzG-OKksY0iPKLkiZLHEbt6cl8lQiwPk"},
{"content":{"body":"Domenic: cool, are you planning to fix this in Chromium?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@domenicdenicola:matrix.org\">Domenic</a>: cool, are you planning to fix this in Chromium?","msgtype":"m.text"},"ts":1637784508597,"senderName":"ntim","senderId":"@ntim:mozilla.org","id":"$al1dtGwtjb3TqXxe9KCQlv6TVFKfA7scMAt-ZbIZM0o"},
{"content":{"body":"ntim: yeah, we have a bunch of changes queued up for after https://github.com/whatwg/html/pull/7361 lands","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@ntim:mozilla.org\">ntim</a>: yeah, we have a bunch of changes queued up for after https://github.com/whatwg/html/pull/7361 lands","msgtype":"m.text"},"ts":1637784537093,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$LXM8GIfX1a_DU-49kKqnrTB9kXpe3AoNVTR9nd9FiTQ"},
{"content":{"body":"just wondering if i should write WPTs ","msgtype":"m.text"},"ts":1637784558326,"senderName":"ntim","senderId":"@ntim:mozilla.org","id":"$p_uHwdSkIm4T1dm6VORymFqKt_V_xcVsDVe-QWBJSIE"},
{"content":{"body":"Domenic: oh I see you have a WPT PR: https://github.com/web-platform-tests/wpt/pull/31724","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@domenicdenicola:matrix.org\">Domenic</a>: oh I see you have a WPT PR: https://github.com/web-platform-tests/wpt/pull/31724","msgtype":"m.text"},"ts":1637784596032,"senderName":"ntim","senderId":"@ntim:mozilla.org","id":"$jQebOJsqqDmeQylLzkDV0yltlnhTZL-ARWHiBl6hIRE"}
]