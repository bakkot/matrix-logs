[
{"content":{"body":"> <@annevk:matrix.org> https://twitter.com/robpalmer2/status/1658914059578744835 made me think of a similar request I had seen for `AbortSignal` but I can't find it. Something like `AbortSignal.withAborter() -> { signal, aborter }`.\n\nI think AbortController is that object: it has { signal, abort } properties. Promise only wants that because it followed the revealing constructor pattern; AbortSignal is not constructible.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$UgG8QNzMSHjCiYwxTV4WihnLFhsSmIeEZnRUs3yRrSo?via=matrix.org&via=mozilla.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@annevk:matrix.org\">@annevk:matrix.org</a><br>https://twitter.com/robpalmer2/status/1658914059578744835 made me think of a similar request I had seen for <code>AbortSignal</code> but I can't find it. Something like <code>AbortSignal.withAborter() -&gt; { signal, aborter }</code>.</blockquote></mx-reply>I think AbortController is that object: it has { signal, abort } properties. Promise only wants that because it followed the revealing constructor pattern; AbortSignal is not constructible.","m.relates_to":{"m.in_reply_to":{"event_id":"$UgG8QNzMSHjCiYwxTV4WihnLFhsSmIeEZnRUs3yRrSo"}},"msgtype":"m.text"},"ts":1684459197980,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$4J9SgRHXH8ptdO5AqArQXQw3ZXdQPowPRF6HTAdfDjw"},
{"content":{"body":"> <@jyasskin:matrix.org> Is the advice in https://webidl.spec.whatwg.org/#idl-USVString that \"Specifications should only use USVString for APIs that perform text processing .... When in doubt, use DOMString.\" still the state of the art? In cases where we expect most of the input to be text instead of 16-bit numbers, it feels like a recipe for subtle implementation bugs if an implementation round-trips a lone surrogate through UTF-8 instead of WTF-8.\n\nThe advice is state of the art. I don't understand your last point. Strings are 16-bit number collections from the JavaScript engine onward, so you're more likely to get subtle implementation bugs if you ignore that.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$xyAAxj5i4PP2XR9K6jVWBuI_l6Dy0VSD1ROJehpVcKo?via=matrix.org&via=mozilla.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@jyasskin:matrix.org\">@jyasskin:matrix.org</a><br>Is the advice in https://webidl.spec.whatwg.org/#idl-USVString that &quot;Specifications should only use USVString for APIs that perform text processing .... When in doubt, use DOMString.&quot; still the state of the art? In cases where we expect most of the input to be text instead of 16-bit numbers, it feels like a recipe for subtle implementation bugs if an implementation round-trips a lone surrogate through UTF-8 instead of WTF-8.<br/><br/></blockquote></mx-reply>The advice is state of the art. I don't understand your last point. Strings are 16-bit number collections from the JavaScript engine onward, so you're more likely to get subtle implementation bugs if you ignore that.","m.relates_to":{"m.in_reply_to":{"event_id":"$xyAAxj5i4PP2XR9K6jVWBuI_l6Dy0VSD1ROJehpVcKo"}},"msgtype":"m.text"},"ts":1684459258002,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$aY24au1CtMzzIdMsgujqx7CJ32jw24Ph1swwif2679E"},
{"content":{"body":"> <@domenicdenicola:matrix.org> The advice is state of the art. I don't understand your last point. Strings are 16-bit number collections from the JavaScript engine onward, so you're more likely to get subtle implementation bugs if you ignore that.\n\nI'm happy to live with it given that confirmation, but I'm thinking of the fact that while strings are 16-bit sequences in Javascript, Chrome's Mojo system (https://chromium.googlesource.com/chromium/src/+/master/mojo/public/tools/bindings/README.md#primitive-types) pretty implicitly translates them to UTF-8 on their way to the browser process. ","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$aY24au1CtMzzIdMsgujqx7CJ32jw24Ph1swwif2679E?via=matrix.org&via=mozilla.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@domenicdenicola:matrix.org\">@domenicdenicola:matrix.org</a><br>The advice is state of the art. I don't understand your last point. Strings are 16-bit number collections from the JavaScript engine onward, so you're more likely to get subtle implementation bugs if you ignore that.</blockquote></mx-reply>I'm happy to live with it given that confirmation, but I'm thinking of the fact that while strings are 16-bit sequences in Javascript, Chrome's Mojo system (https://chromium.googlesource.com/chromium/src/+/master/mojo/public/tools/bindings/README.md#primitive-types) pretty implicitly translates them to UTF-8 on their way to the browser process.","m.relates_to":{"m.in_reply_to":{"event_id":"$aY24au1CtMzzIdMsgujqx7CJ32jw24Ph1swwif2679E"}},"msgtype":"m.text"},"ts":1684469987944,"senderName":"Jeffrey Yasskin","senderId":"@jyasskin:matrix.org","id":"$Q_U7bEgaRsbKwfWq5JIhWI4xAUT6NKZhDoPw2ldyN1c"},
{"content":{"body":"> <@jyasskin:matrix.org> I'm happy to live with it given that confirmation, but I'm thinking of the fact that while strings are 16-bit sequences in Javascript, Chrome's Mojo system (https://chromium.googlesource.com/chromium/src/+/master/mojo/public/tools/bindings/README.md#primitive-types) pretty implicitly translates them to UTF-8 on their way to the browser process.\n\nOh wow, that's kind of scary...","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$Q_U7bEgaRsbKwfWq5JIhWI4xAUT6NKZhDoPw2ldyN1c?via=matrix.org&via=mozilla.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@jyasskin:matrix.org\">@jyasskin:matrix.org</a><br>I'm happy to live with it given that confirmation, but I'm thinking of the fact that while strings are 16-bit sequences in Javascript, Chrome's Mojo system (https://chromium.googlesource.com/chromium/src/+/master/mojo/public/tools/bindings/README.md#primitive-types) pretty implicitly translates them to UTF-8 on their way to the browser process.</blockquote></mx-reply>Oh wow, that's kind of scary...","m.relates_to":{"m.in_reply_to":{"event_id":"$Q_U7bEgaRsbKwfWq5JIhWI4xAUT6NKZhDoPw2ldyN1c"}},"msgtype":"m.text"},"ts":1684470243939,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$5l05CzcNPaKYhF4yRDLD0IW2C0Zs9wmd2ymNGB-ABMc"},
{"content":{"body":":-D","msgtype":"m.text"},"ts":1684470259955,"senderName":"Jeffrey Yasskin","senderId":"@jyasskin:matrix.org","id":"$ETDxr7AVPH1WFfNWPp506CzYX4R7S-qONA2sZDqTaqs"},
{"content":{"body":"https://w3ctag.github.io/design-principles/#idl-string-types is a bit related","msgtype":"m.text"},"ts":1684470276255,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$HOowZgxX_qU9pHkPywU2rIdovLqCJ4PUrQX7fhQVZlQ"},
{"content":{"body":"\"or operations which canâ€™t handle surrogates in input (such as APIs that pass strings through to native platform APIs), USVString should be used\"","msgtype":"m.text"},"ts":1684470296143,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$hPZOwPbLuo7wSfjuXCzhXFnW70obHVC1r3uUhXAYVhs"},
{"content":{"body":"But I don't think that everything-Mojo is the intent of the \"native platform APIs\" clause","msgtype":"m.text"},"ts":1684470317975,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$XXkWGC4WKfP5QdmSLziq5TTkfSDreP9vigPiUKlKu4E"},
{"content":{"body":"It's more meant, like, displaying in a Window title bar or something","msgtype":"m.text"},"ts":1684470341515,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$d9IoLBbffkqfEovp__bmrbHjVQPJ4eYQc3TcgA1gR64"},
{"content":{"body":"Yeah. And Gecko + WebKit might be more consistent about keeping things in UTF-16, so they would be affected in different circumstances.","msgtype":"m.text"},"ts":1684470384234,"senderName":"Jeffrey Yasskin","senderId":"@jyasskin:matrix.org","id":"$fQzBXBMEXqOzVynYMEPcYEx5Yw7WFP_6UrjhQhoOIqE"},
{"content":{"body":"I did notice that URL uses USVString, when the guidance would seem to imply DOMString.","msgtype":"m.text"},"ts":1684470419214,"senderName":"Jeffrey Yasskin","senderId":"@jyasskin:matrix.org","id":"$tZ8XdiInHGIhDg1Pbu9d0BA-CR6PJwZ5BqEJYpBq87U"},
{"content":{"body":"URL uses USVString because percent encoding ","msgtype":"m.text"},"ts":1684470477054,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$qdALtBFC5ay8VBJHlfHZdQ_oXfvdff-VD8hAJDVHliE"},
{"content":{"body":"Note also CSS just kinda decided not to do interop because it was more convenient for Gecko to use USVStrings in Stylo. And nothing has blown up yet...","msgtype":"m.text"},"ts":1684470523343,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$faQQM_qM67N4MJB_dWND-_SUK7sSqwk_rinxOi4aSMA"},
{"content":{"body":"(Search for \"CSSOMString\")","msgtype":"m.text"},"ts":1684470552121,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$nYx9yavfHqAe4wdA726nAgJhgeFD4UesaltaSsDr4XA"}
]