[
{"content":{"body":"annevk: I think this is what we said? https://github.com/whatwg/html/pull/9452/commits does it help?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@annevk:matrix.org\">annevk</a>: I think this is what we said? https://github.com/whatwg/html/pull/9452/commits does it help?","msgtype":"m.text"},"ts":1687392583180,"senderName":"bkardell","senderId":"@bkardell:igalia.com","id":"$Sz-ZadAWqEv-gS3ed8OaU_n5QMWznC53x50XjRzMu-c"},
{"content":{"body":"> <@bkardell:igalia.com> interesting... does the html build use Prince XML?\n\nThe full version that runs on CI does, to produce the PDF","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$e-nRGdtV2dzNcFyhiagKClieNsWmHOyGO_VGfDDMS2U?via=matrix.org&via=mozilla.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@bkardell:igalia.com\">@bkardell:igalia.com</a><br>interesting... does the html build use Prince XML?</blockquote></mx-reply>The full version that runs on CI does, to produce the PDF","m.relates_to":{"m.in_reply_to":{"event_id":"$e-nRGdtV2dzNcFyhiagKClieNsWmHOyGO_VGfDDMS2U"}},"msgtype":"m.text"},"ts":1687398053381,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$MynAuWvHExieApfNutA1bW2MWDsaughJK4yZxtAuX0I"},
{"content":{"body":"> <@jyasskin:matrix.org> https://wicg.github.io/turtledove/ has a couple fields that are passed to the browser in one realm, stored for a while, and then passed to a function in another realm. The spec currently uses JSON for this, where it might be able to use  StructuredSerializeForStorage() instead, but my question for this group is whether there's a good WebIDL pattern for documenting that restriction on types and creating the resulting objects in the right realm? \n> \n> https://w3c.github.io/IndexedDB/ does it all manually, but maybe something better has come along since then...\n\nInteresting, I would have used structs with manual serialize/deserialize. Reusing structured clone or JSON is a neat trick, I guess.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$5n1Xz__5yMcNoa6F7eiT_CMs7mXot_Zif1G40LYyJJg?via=matrix.org&via=mozilla.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@jyasskin:matrix.org\">@jyasskin:matrix.org</a><br>https://wicg.github.io/turtledove/ has a couple fields that are passed to the browser in one realm, stored for a while, and then passed to a function in another realm. The spec currently uses JSON for this, where it might be able to use  StructuredSerializeForStorage() instead, but my question for this group is whether there&#39;s a good WebIDL pattern for documenting that restriction on types and creating the resulting objects in the right realm? <br/><br/>https://w3c.github.io/IndexedDB/ does it all manually, but maybe something better has come along since then...</blockquote></mx-reply>Interesting, I would have used structs with manual serialize/deserialize. Reusing structured clone or JSON is a neat trick, I guess.","m.relates_to":{"m.in_reply_to":{"event_id":"$5n1Xz__5yMcNoa6F7eiT_CMs7mXot_Zif1G40LYyJJg"}},"msgtype":"m.text"},"ts":1687398098901,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$D-HJJQSPiPLdZnUNPgDtV4BRhnn4c6N6ZJgw2IJSkjo"},
{"content":{"body":"Not sure what you mean by Web IDL pattern. Generally IDL object instances are restricted by realm?","msgtype":"m.text"},"ts":1687398125921,"senderName":"Domenic","senderId":"@domenicdenicola:matrix.org","id":"$Gix0S8QCv0ybPOAIrInBH9PTlkTjZj8ciDeIhxTQGnM"},
{"content":{"body":"> <@domenicdenicola:matrix.org> The full version that runs on CI does, to produce the PDF\n\nInteresting!","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$MynAuWvHExieApfNutA1bW2MWDsaughJK4yZxtAuX0I?via=igalia.com&via=matrix.org&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@domenicdenicola:matrix.org\">@domenicdenicola:matrix.org</a><br />The full version that runs on CI does, to produce the PDF</blockquote></mx-reply>Interesting!","m.relates_to":{"m.in_reply_to":{"event_id":"$MynAuWvHExieApfNutA1bW2MWDsaughJK4yZxtAuX0I"}},"msgtype":"m.text"},"ts":1687399668702,"senderName":"bkardell","senderId":"@bkardell:igalia.com","id":"$3uncpc0mMbseCiFEt28uL1fWQPxOZ9D2vbiLXxi2scE"},
{"content":{"body":"> <@domenicdenicola:matrix.org> Not sure what you mean by Web IDL pattern. Generally IDL object instances are restricted by realm?\n\nWell, if you take a WebIDL DOMString, you can safely pass that to a different realm even if the DOMString was initialized from a non-string object, because DOMStrings are defined as Infra strings (https://webidl.spec.whatwg.org/#idl-DOMString). It would be straightforward to define a JSONObject WebIDL type whose 'converted to an IDL value' steps ran https://infra.spec.whatwg.org/#serialize-a-javascript-value-to-a-json-string, and then it'd be safe to pass those instances across realms too.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!AGetWbsMpFPdSgUrbs:matrix.org/$Gix0S8QCv0ybPOAIrInBH9PTlkTjZj8ciDeIhxTQGnM?via=matrix.org&via=mozilla.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@domenicdenicola:matrix.org\">@domenicdenicola:matrix.org</a><br>Not sure what you mean by Web IDL pattern. Generally IDL object instances are restricted by realm?</blockquote></mx-reply>Well, if you take a WebIDL DOMString, you can safely pass that to a different realm even if the DOMString was initialized from a non-string object, because DOMStrings are defined as Infra strings (https://webidl.spec.whatwg.org/#idl-DOMString). It would be straightforward to define a JSONObject WebIDL type whose 'converted to an IDL value' steps ran https://infra.spec.whatwg.org/#serialize-a-javascript-value-to-a-json-string, and then it'd be safe to pass those instances across realms too.","m.relates_to":{"m.in_reply_to":{"event_id":"$Gix0S8QCv0ybPOAIrInBH9PTlkTjZj8ciDeIhxTQGnM"}},"msgtype":"m.text"},"ts":1687403828986,"senderName":"Jeffrey Yasskin","senderId":"@jyasskin:matrix.org","id":"$Jm-l-lCFXEoDCDX3TNJ3LOh2opRFk4f6dEEldlBxRtw"}
]