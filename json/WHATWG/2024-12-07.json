[
{"content":{"body":"Any chance we can get some more eyes on <https://github.com/whatwg/fetch/issues/1754> ? Resolving it would unblock a ton of fetch progress for ladybird. ","msgtype":"m.text"},"ts":1733594651794,"senderName":"akaster","senderId":"@akaster:serenityos.org","id":"$P7hNGQNGF3EN1X1xMIIhfupyTMTX_xn190hq87SZAKw"},
{"content":{"body":"I believe this comment has the most minimized reproducer of the problem https://github.com/LadybirdBrowser/ladybird/pull/2162#issuecomment-2521178568","msgtype":"m.text"},"ts":1733594808607,"senderName":"akaster","senderId":"@akaster:serenityos.org","id":"$CuniwSKjWiry5DoOkPHyRjmZLI64-gWmRKhFOvhwwpI"},
{"content":{"body":"akaster: when we \"fully read\" the body, we get it as bytes, and then \"safely extracting\" bytes creates a new stream. It's not the same stream that you've read","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@akaster:serenityos.org\">akaster</a>: when we \"fully read\" the body, we get it as bytes, and then \"safely extracting\" bytes creates a new stream. It's not the same stream that you've read","m.mentions":{"user_ids":["@akaster:serenityos.org"]},"msgtype":"m.text"},"ts":1733604655049,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$xdDk11umroKosZgOM2TrZn3DRBP6nlYd-2kvoArqcvA"},
{"content":{"body":"... The act of \"fully reading\" a stream turns it into bytes and creates a fresh stream with no readers. Later hand over pipes that fresh stream for the \"end of body\" callback","m.mentions":{},"msgtype":"m.text"},"ts":1733605099731,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$lF3WqnOMnSuR1HKH2_KmTbF6CFXQvrs0H2dxj3b6TOk"},
{"content":{"body":"This way, you can \"fully read\" a body multiple times :)","m.mentions":{},"msgtype":"m.text"},"ts":1733605107550,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$G2JCMH-YQpyrM6AlzrW-4uS3vaSNDuxb2pCFkhmHoLw"},
{"content":{"body":"(I added the exact algo steps on the github issue, but of course there could always be missing bits and bobs)","m.mentions":{},"msgtype":"m.text"},"ts":1733605166284,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$LZLKS_YOvGkcF75Hu7rX3ljP4EjCsy3Q9dVncvJfYDw"},
{"content":{"body":"Thanks! I'll take a look. Hopefully that's something we can slot in to our implementation, because that sounds like it would avoid the issue as I've had it described to me ","msgtype":"m.text"},"ts":1733605302864,"senderName":"akaster","senderId":"@akaster:serenityos.org","id":"$8PxQt_DSd8q10eGZ7_rhRD5b8uDlnO8T5hQuhsz509o"},
{"content":{"body":"Good luck!","m.mentions":{},"msgtype":"m.text"},"ts":1733605341990,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$eHOzoGfbGt2Cfoj-fTdrzjLDTrhT8aocFV5BQKddEik"},
{"content":{"body":" * ... The act of \"fully reading\" a body turns it into bytes and creates a fresh stream with no readers. Later hand over pipes that fresh stream for the \"end of body\" callback","m.mentions":{},"m.new_content":{"body":"... The act of \"fully reading\" a body turns it into bytes and creates a fresh stream with no readers. Later hand over pipes that fresh stream for the \"end of body\" callback","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$lF3WqnOMnSuR1HKH2_KmTbF6CFXQvrs0H2dxj3b6TOk","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1733605478963,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$NxPnidEiVT7j9p_z1_R5U2hAzGFRMPewV1l6Rk9_B8g"},
{"content":{"body":"well, I rebased the branch that folks were working on and the issue from the reproducer is still there. The steps you mentioned for how fetch_response_handover gets its own stream seem to be followed to the letter of the spec, so something else must be going on","m.mentions":{},"msgtype":"m.text"},"ts":1733613576535,"senderName":"akaster","senderId":"@akaster:serenityos.org","id":"$Yr8o9DfnfPyYpfbO_LYH4PQjuNtTKEjseqAJEegCzcU"}
]