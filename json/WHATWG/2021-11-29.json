[
{"content":{"body":"Jake Archibald: good morning! I have a couple of SW patches waiting for review when you get a chance... https://github.com/w3c/ServiceWorker/pull/1620 and https://github.com/w3c/ServiceWorker/pull/1621","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@jakea:matrix.org\">Jake Archibald</a>: good morning! I have a couple of SW patches waiting for review when you get a chance... https://github.com/w3c/ServiceWorker/pull/1620 and https://github.com/w3c/ServiceWorker/pull/1621","msgtype":"m.text"},"ts":1638175286556,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$6tBAf5rk_MqrIZ-5mYxUU-3FjpM2cuHC-CNWGY9GZSY"},
{"content":{"body":"Hi annevk: We found some existing issue with `process response donein this comment: https://github.com/whatwg/fetch/pull/1311/files#r737407947","format":"org.matrix.custom.html","formatted_body":"Hi <a href=\"https://matrix.to/#/@annevk:mozilla.org\">annevk</a>: We found some existing issue with `process response donein this comment: https://github.com/whatwg/fetch/pull/1311/files#r737407947","msgtype":"m.text"},"ts":1638176971618,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$henIC43Hicq-I1Ath0ST8I6AopzxqwHWLL3bi3knYEk"},
{"content":{"body":"basically we call \"done\" when the network is done, but we never call it for http-cache/SW. For http-cache it's simple, but not sure yet how to integrate it with SW","msgtype":"m.text"},"ts":1638177012608,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$UNvWeBhwmLHQ0RAWvjwQIh-QGYMluhVLkS41qmi1b18"},
{"content":{"body":"annevk:  Maybe `network read complete` flag should be on a response instead of on the fetch, I think that would solve it","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@annevk:mozilla.org\">annevk</a>:  Maybe <code>network read complete</code> flag should be on a response instead of on the fetch, I think that would solve it","msgtype":"m.text"},"ts":1638177308105,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$00wpxiGYa_jsKSeAYFXNyHFr17XKWqmHbBrw22Fc6oc"},
{"content":{"body":"How would it get set is the problem, no? It's interesting how the lack of progress events for streams is making a lot of this hard","msgtype":"m.text"},"ts":1638177385385,"senderName":"annevk","senderId":"@annevk:mozilla.org","id":"$uq0AqcSetNlXt7EF2-g7L0IeYDcYcHZsV0qnNIJuubk"},
{"content":{"body":"yea","msgtype":"m.text"},"ts":1638177396996,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$-RmWaaoD1AJ6yDMO83cV1w37qvE9JCXNPXDRtOgacB4"},
{"content":{"body":"ideally this should all be related to the streams","msgtype":"m.text"},"ts":1638177408990,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$5LaBSPdpNvrFqgHwNHOqvJajOqxRJ77NZ0UC1BtKDlw"},
{"content":{"body":"Perhaps the solution would be to have some kind of transform stream that reports when EOF is pushed and otherwise forwards","msgtype":"m.text"},"ts":1638177413049,"senderName":"annevk","senderId":"@annevk:mozilla.org","id":"$cLNW5t-MJ5ru2sQC7nRXhcp3geqPNYhB5BhnLO1qGcY"},
{"content":{"body":"isn't that equivalent to \"teeing\" the stream and fully reading one side of the tee?","msgtype":"m.text"},"ts":1638177442794,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$cJqE2tCUVhfaJfoMNUu-1ZHYQ-4EK9xCuQG7yIJaHkY"},
{"content":{"body":"I thought reading had side effects, such as possibly influencing the speed of transfer","msgtype":"m.text"},"ts":1638177495652,"senderName":"annevk","senderId":"@annevk:mozilla.org","id":"$1cRj_vAqlvwIJwxD9DxrVOdj0ezAWskjMT11Gxqrr2A"},
{"content":{"body":"yea but not observable side effects","msgtype":"m.text"},"ts":1638177521755,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$fc_vY6iRMTlvoaPnt2X1owZpS5-u85e4BBBqD_6lhCU"},
{"content":{"body":"as far as observable behavior is concerned it should be equivalent, of course implementations can do something \"faster\"","msgtype":"m.text"},"ts":1638177547449,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$yMyocf3-sBn3WxhNqG_VPfn8sbXDknwzzIbneLBbCIc"},
{"content":{"body":"Maybe, I'm not too well-versed in this. It seems rather wasteful, but perhaps with an explanation of what it is doing it could work","msgtype":"m.text"},"ts":1638177628582,"senderName":"annevk","senderId":"@annevk:mozilla.org","id":"$j9blFw_EWUG1Gp0nu1Jsaj2NFbl6XuR2tJBA4GDZ4D0"},
{"content":{"body":"but maybe a cleaner solution would be to add some \"control-flow\" reader to a stream like you suggested","msgtype":"m.text"},"ts":1638177629054,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$TNAUJmhlvHcB1cOAww3VK4jyGxA644qGdFw4Xl495eI"},
{"content":{"body":"Mattias Buelens do you have thoughts on any of this?","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@mattiasbuelens:matrix.org\">Mattias Buelens</a> do you have thoughts on any of this?","msgtype":"m.text"},"ts":1638177677276,"senderName":"annevk","senderId":"@annevk:mozilla.org","id":"$5UZ-JJhoExsKIjNNBr1Un-rSLbjLvrf7dpkjJoKzNE0"},
{"content":{"body":"Seems like maybe the cleanest thing would be that FETCH adds a transform stream that implements flush (https://streams.spec.whatwg.org/#dom-transformer-flush) but that is otherwise an identity transform stream","msgtype":"m.text"},"ts":1638178132827,"senderName":"Noam Rosenthal","senderId":"@noamr:matrix.org","id":"$MkqIGttWoyyjKsvyy1nRwrmaNKPPoaGOIJpeb3i4rs4"}
]