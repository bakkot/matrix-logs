[
{"content":{"body":"FWIW, I do not buy this use case. I'm willing to be convinced with concrete worked examples, but conversion isn't even part of Amount right now, and infinite values are just not well-behaved like that (e.g., what would one do with ∞ degrees?)","m.mentions":{"user_ids":["@sffc:mozilla.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$5WZmpX-wDCxJGiVW8KWNmSldPkf7hcHWdzraNhhppls"}},"msgtype":"m.text"},"ts":1753846277434,"senderName":"Richard Gibson","senderId":"@gibson042:matrix.org","id":"$b1o4Kyjar6sH7FPc6Ts6OPOUE42acFtON0KhSV-j9NU"},
{"content":{"body":"yeah i don't really buy this either, infinity isn't an amount","m.mentions":{},"msgtype":"m.text"},"ts":1753853272991,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$ZB3ArHG0zqCys4cy96kJvwIahZER89_oa-4SomMipDU"},
{"content":{"body":"the word \"amount\" is intrinsically finite/discrete","m.mentions":{},"msgtype":"m.text"},"ts":1753853281509,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$omS6IqIZzxFi4j2xn0c6fIkcdOTakiHE2w9F7kpqBUw"},
{"content":{"body":"if you want infinity (or NaN) you could use ±`Infinity` on its own","format":"org.matrix.custom.html","formatted_body":"if you want infinity (or NaN) you could use ±<code>Infinity</code> on its own","m.mentions":{},"msgtype":"m.text"},"ts":1753853304387,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$l1NUbkjK0_X1kDQY-kBBb2DKTN7Z25F-j0nZrhv-KA4"},
{"content":{"body":"* if you want infinity (or NaN) you could use ±`Infinity` on its own, alongside an Amount","format":"org.matrix.custom.html","formatted_body":"* if you want infinity (or NaN) you could use ±<code>Infinity</code> on its own, alongside an Amount","m.mentions":{},"m.new_content":{"body":"if you want infinity (or NaN) you could use ±`Infinity` on its own, alongside an Amount","format":"org.matrix.custom.html","formatted_body":"if you want infinity (or NaN) you could use ±<code>Infinity</code> on its own, alongside an Amount","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$l1NUbkjK0_X1kDQY-kBBb2DKTN7Z25F-j0nZrhv-KA4","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1753853310551,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$svQxg-TLHbMXLUKsvtu0KVISwNgzqQu6lDkr8jJfNzw"},
{"content":{"body":"Is infinity a valid \"measure\", but not \"amount\"?","m.mentions":{},"msgtype":"m.text"},"ts":1753855379249,"senderName":"sffc","senderId":"@sffc:mozilla.org","id":"$OWAXYQmom15nPVdDBvCK4ORqjXybHR5NF3iN8S-Hk8g"},
{"content":{"body":"please don't take things in that direction. We don't need synonyms, we need concrete worked examples. And like I said, I _am_ willing to be convinced... it's certainly possible to have an infinite estimated duration due to total lack of progress for e.g. file transfers at 0 bytes/s or speed of 0 m/s, so it's not like the concept is impossible or incomprehensible. But it does also cause problems like lack of valid decimal (and hence JSON number) representation, and we should try to avoid inclusion doing more harm than good—especially since support could be added later, but can never be removed.","format":"org.matrix.custom.html","formatted_body":"please don't take things in that direction. We don't need synonyms, we need concrete worked examples. And like I said, I <em>am</em> willing to be convinced... it's certainly possible to have an infinite estimated duration due to total lack of progress for e.g. file transfers at 0 bytes/s or speed of 0 m/s, so it's not like the concept is impossible or incomprehensible. But it does also cause problems like lack of valid decimal (and hence JSON number) representation, and we should try to avoid inclusion doing more harm than good—especially since support could be added later, but can never be removed.","m.mentions":{},"msgtype":"m.text"},"ts":1753862338841,"senderName":"Richard Gibson","senderId":"@gibson042:matrix.org","id":"$aHXTwAzjZUiVMeKNtZ2WTFWPe0GdSy0ZcEeqPiJkUKc"},
{"content":{"body":"Amount's internal-slot access from Intl.NF was raised as a concern by at least KG and MM. If we want to avoid that, I think we may need to add a `.value: string` readonly property or a `.valueOf(): string` method on Amount instances. At the moment, the only full-precision accessor for the value that's guaranteed to only contain the numeric value is `.toString({ displayUnit: 'never' })`, which doesn't seem like it'd be a sensible thing to encode in a protocol.\n\nAnother alternative would be to have Intl.NF be able to parse the serialized form `1.5[kg]` to a value+unit.\n\nAre there other choices here? The proposal's spec text currently looks for the [[Value]] and [[FractionDigits]] internal slots.","format":"org.matrix.custom.html","formatted_body":"<p>Amount's internal-slot access from Intl.NF was raised as a concern by at least KG and MM. If we want to avoid that, I think we may need to add a <code>.value: string</code> readonly property or a <code>.valueOf(): string</code> method on Amount instances. At the moment, the only full-precision accessor for the value that's guaranteed to only contain the numeric value is <code>.toString({ displayUnit: 'never' })</code>, which doesn't seem like it'd be a sensible thing to encode in a protocol.</p>\n<p>Another alternative would be to have Intl.NF be able to parse the serialized form <code>1.5[kg]</code> to a value+unit.</p>\n<p>Are there other choices here? The proposal's spec text currently looks for the [[Value]] and [[FractionDigits]] internal slots.</p>\n","m.mentions":{},"msgtype":"m.text"},"ts":1753876001920,"senderName":"eemeli","senderId":"@eemeli:mozilla.org","id":"$_kU9LBYGrQDpwrfHQKMgQOmu_H65CSyLHhzrDQhjZPs"},
{"content":{"body":"I'm glad MM and KG brought up the internal slot issue. I like the idea that Intl.NF do lightweight parsing (grabbing the substring of `toString()` up to the first `[`, if any). Having `.valueof()` return a string also strikes me as intuitively appropriate though I wonder if we might be painting ourselves into a corner somehow","format":"org.matrix.custom.html","formatted_body":"I'm glad MM and KG brought up the internal slot issue. I like the idea that Intl.NF do lightweight parsing (grabbing the substring of <code>toString()</code> up to the first <code>[</code>, if any). Having <code>.valueof()</code> return a string also strikes me as intuitively appropriate though I wonder if we might be painting ourselves into a corner somehow","m.mentions":{},"msgtype":"m.text"},"ts":1753879801703,"senderName":"Jesse","senderId":"@jesse:igalia.com","id":"$C9cUFLYN95E-_xe33MDOdsGvAtkd7NzlZ5LQF2ZtwXE"},
{"content":{"body":"Shane posted an interesting example: https://github.com/tc39/proposal-measure/issues/50#issuecomment-3134873158","m.mentions":{"user_ids":["@gibson042:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$aHXTwAzjZUiVMeKNtZ2WTFWPe0GdSy0ZcEeqPiJkUKc"}},"msgtype":"m.text"},"ts":1753879962839,"senderName":"Jesse","senderId":"@jesse:igalia.com","id":"$DxY7_Fjh2KdnIhja9LrZLaQveDqMux9nt334UPmUJEw"},
{"content":{"body":"so far I think the example uses of infinite amounts arise not from direct use of infinity, but inferred/calculated infinity like division by zero. This makes me wonder whether we should support infinity out-of-the-box, now, or defer the discussion to proposal-smart-units, which is concerned with the kinds of examples we've seen so far","m.mentions":{},"msgtype":"m.text"},"ts":1753880189378,"senderName":"Jesse","senderId":"@jesse:igalia.com","id":"$riTts8a9eYtjrl_F096Z2g5TG7wjyxCgFBcskSlR_9A"},
{"content":{"body":"regarding Ashley's request for `BigInt(new Amount(bigint))`, I guess that would be solved by having Amount's `valueOf` return a string (without unit)?","format":"org.matrix.custom.html","formatted_body":"regarding Ashley's request for <code>BigInt(new Amount(bigint))</code>, I guess that would be solved by having Amount's <code>valueOf</code> return a string (without unit)?","m.mentions":{},"msgtype":"m.text"},"ts":1753880565101,"senderName":"Jesse","senderId":"@jesse:igalia.com","id":"$EKpFjibG6YXQ0AugNhSejOqlmaqIZr7nnXbt2-ALQ18"},
{"content":{"body":"(hmm, maybe not, nvm)","m.mentions":{},"msgtype":"m.text"},"ts":1753880809032,"senderName":"Jesse","senderId":"@jesse:igalia.com","id":"$xdGGQN1JV0Otx4i9T1sdlnFKURgibNZVOCCdahaMINw"},
{"content":{"body":"how feasible would it be to add a new `bigint` hint to `ToPrimitive`?","format":"org.matrix.custom.html","formatted_body":"how feasible would it be to add a new <code>bigint</code> hint to <code>ToPrimitive</code>?","m.mentions":{},"msgtype":"m.text"},"ts":1753880835186,"senderName":"Jesse","senderId":"@jesse:igalia.com","id":"$XCXwpXbjDFcCJ63v9Qzpa1A1OBaPtOFSDFSYJ_QYi6U"},
{"content":{"body":"What if we just didn't add toPrimitive on amount ","msgtype":"m.text"},"ts":1753880933025,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$fk8sPOlypQzmM5XA5a5fWH6vzcTdj4QpKc1f_Vyq6p0"},
{"content":{"body":"And made valueOf return the string","msgtype":"m.text"},"ts":1753880957776,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$UMsyrZqTgU5qrJSNuJx0hkXvWF9HgbsvShbmipYYp9Q"},
{"content":{"body":"It means that amount+amount would do string concatenation, but that seems fine","msgtype":"m.text"},"ts":1753881033677,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$hmuGIbnd9h_vRUluIkV3EhbI0HJJanrxgjBk5V3hMLo"},
{"content":{"body":"You should extract the numbers before doing math anyway ","msgtype":"m.text"},"ts":1753881042526,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$Zrq1gJt7uqFsvcxGJRmtk4RHXt7IOqhQEegbFNwoLB4"}
]