[
{"content":{"body":"do we want Amount to support NaN, -0, and infinity?","m.mentions":{},"msgtype":"m.text"},"ts":1744702154917,"senderName":"Jesse","senderId":"@jesse:igalia.com","id":"$s89pfXiDbv-Lw5d01aDnCXMQkiHSwQOBPdRqKaW1mPI"},
{"content":{"body":"thinking about measurements or financial quantities, I think you could say that all of those shouldn't be there","m.mentions":{},"msgtype":"m.text"},"ts":1744702190547,"senderName":"Jesse","senderId":"@jesse:igalia.com","id":"$p9MWe-Zxfs04wpUjj1vPS7ikMZmywHZBOIk1yCNdoB0"},
{"content":{"body":"we could easily support those since decimal supports them. Intl also supports them, so we'd be on solid ground. But we can nonetheless ask whether amount should support them","m.mentions":{},"msgtype":"m.text"},"ts":1744702476127,"senderName":"Jesse","senderId":"@jesse:igalia.com","id":"$d3fkAIQmuKnkL7VMSg6alcQiEq2_j2prqCKHDKsdyMQ"},
{"content":{"body":"if we do support NaN etc. do also want Amount to have predicates like `isNaN` etc. that decimal has, or do we require the user to query the underlying decimal?","format":"org.matrix.custom.html","formatted_body":"if we do support NaN etc. do also want Amount to have predicates like <code>isNaN</code> etc. that decimal has, or do we require the user to query the underlying decimal?","m.mentions":{},"msgtype":"m.text"},"ts":1744702578140,"senderName":"Jesse","senderId":"@jesse:igalia.com","id":"$DGEzb9kfX8Z5Bq0RZGNIzOxcW0-azb5jbnom19rFI8U"},
{"content":{"body":"> <@jesse:igalia.com> if we do support NaN etc. do also want Amount to have predicates like `isNaN` etc. that decimal has, or do we require the user to query the underlying decimal?\n\nI think doing `x.decimal.isNaN()` is fine ","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!NnKyFxSjabKpyjbPcL:matrix.org/$DGEzb9kfX8Z5Bq0RZGNIzOxcW0-azb5jbnom19rFI8U?via=matrix.org&via=igalia.com&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@jesse:igalia.com\">@jesse:igalia.com</a><br />if we do support NaN etc. do also want Amount to have predicates like <code>isNaN</code> etc. that decimal has, or do we require the user to query the underlying decimal?</blockquote></mx-reply>I think doing <code>x.decimal.isNaN()</code> is fine","m.relates_to":{"m.in_reply_to":{"event_id":"$DGEzb9kfX8Z5Bq0RZGNIzOxcW0-azb5jbnom19rFI8U"}},"msgtype":"m.text"},"ts":1744704327952,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$pl7GQnjHs2PxQJp5abXgWKvE0tuKgfdmLfRd3CsFw-8"},
{"content":{"body":"Does the IEEE spec allow defining things like \"infinity with a precision of 3\"?","msgtype":"m.text"},"ts":1744704380886,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$LWSNwVQr7tAsAi3dAdvcKXGHTABzr_U-Qw7kYFKUuIg"},
{"content":{"body":"For -0 I think it makes sense to support it. -0.0 and -0.000 seem to me like different numbers (the first one is less than 0 and more that -0.005, the second one less than 0 and more than -0.0005)","msgtype":"m.text"},"ts":1744704445404,"senderName":"nicolo-ribaudo","senderId":"@nicolo-ribaudo:matrix.org","id":"$yTUd0GiXhamYpMtPXdsbUL0YTvB7M0gjcpcgJpQBx9M"},
{"content":{"body":"in IEEE there's no precision for NaN or the infinities","m.mentions":{},"msgtype":"m.text"},"ts":1744704662384,"senderName":"Jesse","senderId":"@jesse:igalia.com","id":"$q8JChbIGd9zmeQB6gMC6gWCvNaS8zQaRCCEBaZjwbQs"},
{"content":{"body":"but there is precision for -0","m.mentions":{},"msgtype":"m.text"},"ts":1744704668992,"senderName":"Jesse","senderId":"@jesse:igalia.com","id":"$kPCTnT8Xh5vVZEc4ab9o2Z9jQixs-kOUbzZKP0FkXGA"},
{"content":{"body":"Are example _non-formatting_ use cases for decimal-with-precision available anywhere? I can only find a [wrapper](https://github.com/nicolo-ribaudo/proposal-numeric-with-precision?tab=readme-ov-file#examples) for IEE754 precision propagation in nicolo-ribaudo's proposal-numeric-with-precision, but nothing e.g. within the proposal-decimal repo.\n\nI think the _formatting_ case for a decimal-with-precision is quite clear, but if the intent is to not have that as the only reason for something like Decimal.Amount, then I think the we ought to say something a bit more that the presentation's current assertion:\n> For data exchange, we may need to store exact numeric information we receive (the digits, not just the mathematical value)\n\nIs that an actual demonstrated need, or a theoretical one that might exist?","format":"org.matrix.custom.html","formatted_body":"<p>Are example <em>non-formatting</em> use cases for decimal-with-precision available anywhere? I can only find a <a href=\"https://github.com/nicolo-ribaudo/proposal-numeric-with-precision?tab=readme-ov-file#examples\">wrapper</a> for IEE754 precision propagation in <a href=\"https://matrix.to/#/@nicolo-ribaudo:matrix.org\">nicolo-ribaudo</a>'s proposal-numeric-with-precision, but nothing e.g. within the proposal-decimal repo.</p>\n<p>I think the <em>formatting</em> case for a decimal-with-precision is quite clear, but if the intent is to not have that as the only reason for something like Decimal.Amount, then I think the we ought to say something a bit more that the presentation's current assertion:</p>\n<blockquote>\n<p>For data exchange, we may need to store exact numeric information we receive (the digits, not just the mathematical value)</p>\n</blockquote>\n<p>Is that an actual demonstrated need, or a theoretical one that might exist?</p>\n","m.mentions":{"user_ids":["@nicolo-ribaudo:matrix.org"]},"msgtype":"m.text"},"ts":1744708726513,"senderName":"eemeli","senderId":"@eemeli:mozilla.org","id":"$ZYI9A39hGjhzV6CA-6Jk7dVsDrNUdHmJKhDY2bJQcRY"},
{"content":{"body":"those use cases in N-ic's proposal should be integrated into decimal; much of the thinking there maps over into amount","m.mentions":{},"msgtype":"m.text"},"ts":1744709955484,"senderName":"Jesse","senderId":"@jesse:igalia.com","id":"$helGrrN3KaaAFESS1l3Vj1id8jekGkdALv4YU3SpJdk"},
{"content":{"body":"looking ahead (or sideways?) to the measure proposal, the need to have all digits is more clearly motivated","m.mentions":{},"msgtype":"m.text"},"ts":1744710258997,"senderName":"Jesse","senderId":"@jesse:igalia.com","id":"$3R2mvmhS-LmxUIn62LT63cbsz8tzm_deNN7GVQRcPVk"},
{"content":{"body":"if one temporarily ignores measure, the need for out-of-the-box round-trippability is a nice invariant","m.mentions":{},"msgtype":"m.text"},"ts":1744710374591,"senderName":"Jesse","senderId":"@jesse:igalia.com","id":"$-sO3CAo5Pd0IYyP-YqRHAkde2OXBK1v1njYQzizVApc"},
{"content":{"body":"btw \"amount\" is currently not the best name; I've updated the slides to use a placeholder name","m.mentions":{},"msgtype":"m.text"},"ts":1744710499194,"senderName":"Jesse","senderId":"@jesse:igalia.com","id":"$5VaPXjfH18gAlCOEmFdhu7UiCyKX5Eu3fNmH6sqalaI"},
{"content":{"body":"suggestions welcome","m.mentions":{},"msgtype":"m.text"},"ts":1744710502877,"senderName":"Jesse","senderId":"@jesse:igalia.com","id":"$H7fVW3LD5vAoDRsjrt43ibbpc4GMT00sbW5l_L81M1Y"},
{"content":{"body":"we've thrown around a few ideas here but haven't really settled on one","m.mentions":{},"msgtype":"m.text"},"ts":1744710560397,"senderName":"Jesse","senderId":"@jesse:igalia.com","id":"$Y66ru9hXRycbqZzW6PtEeU8Sz3Jfca8qYgyBZGxJCDU"},
{"content":{"body":"What does this mean? What's the use case here?","m.mentions":{"user_ids":["@jesse:igalia.com"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$-sO3CAo5Pd0IYyP-YqRHAkde2OXBK1v1njYQzizVApc"}},"msgtype":"m.text"},"ts":1744720696045,"senderName":"eemeli","senderId":"@eemeli:mozilla.org","id":"$sZ_6J1zTYkzRcEx9U186fPUCXcWF_TUDVGHBZpq_m70"},
{"content":{"body":"something like `Decimal.Something.from(x, 3. \"fractionalDigits\").toString() === x` for all digit strings `x` with up to 3 decimal digits (where 3 is known out-of-band)","format":"org.matrix.custom.html","formatted_body":"something like <code>Decimal.Something.from(x, 3. \"fractionalDigits\").toString() === x</code> for all digit strings <code>x</code> with up to 3 decimal digits (where 3 is known out-of-band)","m.mentions":{},"msgtype":"m.text"},"ts":1744720884056,"senderName":"Jesse","senderId":"@jesse:igalia.com","id":"$rNQ4mCjCgXid5UGYhFt3bwVnUWyk_oJTGNB49uASM6Y"},
{"content":{"body":"* something like `Decimal.Something.from(x, 3. \"fractionalDigits\").toString() === x` for all digit strings `x` with 3 fractional digits (where 3 is known out-of-band)","format":"org.matrix.custom.html","formatted_body":"* something like <code>Decimal.Something.from(x, 3. \"fractionalDigits\").toString() === x</code> for all digit strings <code>x</code> with 3 fractional digits (where 3 is known out-of-band)","m.mentions":{},"m.new_content":{"body":"something like `Decimal.Something.from(x, 3. \"fractionalDigits\").toString() === x` for all digit strings `x` with 3 fractional digits (where 3 is known out-of-band)","format":"org.matrix.custom.html","formatted_body":"something like <code>Decimal.Something.from(x, 3. \"fractionalDigits\").toString() === x</code> for all digit strings <code>x</code> with 3 fractional digits (where 3 is known out-of-band)","m.mentions":{},"msgtype":"m.text"},"m.relates_to":{"event_id":"$rNQ4mCjCgXid5UGYhFt3bwVnUWyk_oJTGNB49uASM6Y","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1744721017316,"senderName":"Jesse","senderId":"@jesse:igalia.com","id":"$76IP5-9gf2hEm-Dzy98u8UVwSM-OuEsBTrN55Yd_H4Q"},
{"content":{"body":"this could be used for e.g. currency, where a number of fractional digits is known in advance","m.mentions":{},"msgtype":"m.text"},"ts":1744721064621,"senderName":"Jesse","senderId":"@jesse:igalia.com","id":"$2QRGveUtpfDjEMg6roloVbS_0QhJNwk0h3VtXvd5lFs"},
{"content":{"body":"If that's important in particular for currency values, then we ought to be quite explicit about it, as this has significant implications for the `.toString()` output once we start to consider including a `currency` field as a part of proposal-measure.","format":"org.matrix.custom.html","formatted_body":"If that's important in particular for currency values, then we ought to be quite explicit about it, as this has significant implications for the <code>.toString()</code> output once we start to consider including a <code>currency</code> field as a part of proposal-measure.","m.mentions":{},"msgtype":"m.text"},"ts":1744722473371,"senderName":"eemeli","senderId":"@eemeli:mozilla.org","id":"$DQzuraNAk_Vp5hrv6_H0jS59X76YaeW2N15Je8JWoRQ"},
{"content":{"body":"As in, I think it means that either:\n1. `toString()` only encodes the numerical value,\n2. we ought to include a parser for a number+currency or number+unit string format,\n3. we strongly recommend that anyone with a non-formatting reason to represent a number together with a currency or unit not actually do so, or\n4. we reconsider a 3-class solution.\n\nPresuming, of course, that we agree that this sort of round-tripping is important.","format":"org.matrix.custom.html","formatted_body":"<p>As in, I think it means that either:</p>\n<ol>\n<li><code>toString()</code> only encodes the numerical value,</li>\n<li>we ought to include a parser for a number+currency or number+unit string format,</li>\n<li>we strongly recommend that anyone with a non-formatting reason to represent a number together with a currency or unit not actually do so, or</li>\n<li>we reconsider a 3-class solution.</li>\n</ol>\n<p>Presuming, of course, that we agree that this sort of round-tripping is important.</p>\n","m.mentions":{},"msgtype":"m.text"},"ts":1744722814528,"senderName":"eemeli","senderId":"@eemeli:mozilla.org","id":"$VxqaP4d8AjoWHVqPa9wYQSVuYvTnDSIYUtGM9zidCJk"},
{"content":{"body":"Hence my question earlier: Is there an actual demonstrated need for non-formatting use cases for decimal-with-precision that is significant enough that we need to account for it in this API design, or do we only strongly care about the formatting use cases?","m.mentions":{},"msgtype":"m.text"},"ts":1744722956284,"senderName":"eemeli","senderId":"@eemeli:mozilla.org","id":"$KAAT1I7D3ULUxlR4xgayUqH-yKpSvOV_g7J3XzmiQ0I"},
{"content":{"body":"I'm having trouble following; are we proposing having a parser for Decimal.Amount?","m.mentions":{"user_ids":["@eemeli:mozilla.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$VxqaP4d8AjoWHVqPa9wYQSVuYvTnDSIYUtGM9zidCJk"}},"msgtype":"m.text"},"ts":1744722997303,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$nvZJ_H-ucr3BodIr6VoDf4aijsJ4D8x8awTK_a2BqXE"},
{"content":{"body":"let's follow the decision for Decimal. The counterarguments are the same in both cases. If we're going with it, let's stick with it for Decimal.Amount","m.mentions":{"user_ids":["@jesse:igalia.com"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$s89pfXiDbv-Lw5d01aDnCXMQkiHSwQOBPdRqKaW1mPI"}},"msgtype":"m.text"},"ts":1744723024177,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$O9DkQIURjdcrsB316X2BXioOVNHBKFWA0wLd32bDMbM"},
{"content":{"body":"the most visible usage of a name is on the title slide; you might want to change that","m.mentions":{"user_ids":["@jesse:igalia.com"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$5VaPXjfH18gAlCOEmFdhu7UiCyKX5Eu3fNmH6sqalaI"}},"msgtype":"m.text"},"ts":1744723054977,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$2Cv66m7dItPRVb_QoLSnuwhRhwgybDYVCQaIQ2eoKI8"},
{"content":{"body":"I don't think we ought to have one, but if we seriously care about round-tripping, then that's something we need ot consider.","m.mentions":{"user_ids":["@littledan:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$nvZJ_H-ucr3BodIr6VoDf4aijsJ4D8x8awTK_a2BqXE"}},"msgtype":"m.text"},"ts":1744723059376,"senderName":"eemeli","senderId":"@eemeli:mozilla.org","id":"$7qubdP5Q6zLindRWpjiBb8V8bqhmRJekrFfom2R3tLU"},
{"content":{"body":"my understanding was that the driving motivation was around the formatting use case","m.mentions":{"user_ids":["@eemeli:mozilla.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$KAAT1I7D3ULUxlR4xgayUqH-yKpSvOV_g7J3XzmiQ0I"}},"msgtype":"m.text"},"ts":1744723081612,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$Ksck6RQ1uEP4vt-e7gNpyxO-dUTViV8pPpYgXiYBGUk"},
{"content":{"body":"That's my understanding as well, but e.g. the slides first mention the non-formatting case.","m.mentions":{},"msgtype":"m.text"},"ts":1744723121217,"senderName":"eemeli","senderId":"@eemeli:mozilla.org","id":"$2L-Pp2V8d-17Mr4ZEJYbFTYddPvClnbZ6kuxmUCAcBU"},
{"content":{"body":"atm there's no parser for Decimal.Something; using the `.from` static constructor method, the 1st argument is a decimal string, which gets passed to Decimal, which does have a parser","format":"org.matrix.custom.html","formatted_body":"atm there's no parser for Decimal.Something; using the <code>.from</code> static constructor method, the 1st argument is a decimal string, which gets passed to Decimal, which does have a parser","m.mentions":{},"msgtype":"m.text"},"ts":1744723122471,"senderName":"Jesse","senderId":"@jesse:igalia.com","id":"$zqy0AWv8cTBRtuCudb44enqt7D57bCVUdOHqw1MfPc0"},
{"content":{"body":"where did the demand for round-tripping come from?","m.mentions":{},"msgtype":"m.text"},"ts":1744723143670,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$GtOLDIrIfKMvk1Ve6LeAJh068Ug6ay4daAMVJAVzIFs"}
]