[
{"content":{"body":"I'm a bit wary of overlooking the expressiveness argument.  It's really easy to miss important cases and then those use cases end up high and dry with a non-solution.  As an example, I'm working on a use case right now where registration context would be a huge problem - it's (again) a tracing use case: our data service allows registering interceptors for incoming data and the interceptors are what actually trigger the UI update (possibly via a signal reaction, which is another callback registration that would need to preserve call-time semantics instead of registration semantics for this all to work).  If _either_ the RPC interceptors _or_ the signal reactions use registration context, we're sunk and there's no way to trace an interaction from the initiating event all the way to the UI update, given how loosely-coupled all the reactions in the framework are.","format":"org.matrix.custom.html","formatted_body":"I'm a bit wary of overlooking the expressiveness argument.  It's really easy to miss important cases and then those use cases end up high and dry with a non-solution.  As an example, I'm working on a use case right now where registration context would be a huge problem - it's (again) a tracing use case: our data service allows registering interceptors for incoming data and the interceptors are what actually trigger the UI update (possibly via a signal reaction, which is another callback registration that would need to preserve call-time semantics instead of registration semantics for this all to work).  If <em>either</em> the RPC interceptors <em>or</em> the signal reactions use registration context, we're sunk and there's no way to trace an interaction from the initiating event all the way to the UI update, given how loosely-coupled all the reactions in the framework are.","m.mentions":{},"msgtype":"m.text"},"ts":1712016649615,"senderName":"Steve Hicks","senderId":"@stephenhicks:matrix.org","id":"$TQjFwAdq9-9pCTS0dM1kpz9Oh5ayG1ygCHxYm8KJH8U"},
{"content":{"body":"> <@stephenhicks:matrix.org> I'm a bit wary of overlooking the expressiveness argument.  It's really easy to miss important cases and then those use cases end up high and dry with a non-solution.  As an example, I'm working on a use case right now where registration context would be a huge problem - it's (again) a tracing use case: our data service allows registering interceptors for incoming data and the interceptors are what actually trigger the UI update (possibly via a signal reaction, which is another callback registration that would need to preserve call-time semantics instead of registration semantics for this all to work).  If _either_ the RPC interceptors _or_ the signal reactions use registration context, we're sunk and there's no way to trace an interaction from the initiating event all the way to the UI update, given how loosely-coupled all the reactions in the framework are.\n\nCan you make an example case in code?","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!eQuZUAhGqudVFPodUG%3Amatrix.org/%24TQjFwAdq9-9pCTS0dM1kpz9Oh5ayG1ygCHxYm8KJH8U\">In reply to</a> <a href=\"https://matrix.to/#/@stephenhicks:matrix.org\">@stephenhicks:matrix.org</a><br>I'm a bit wary of overlooking the expressiveness argument.  It's really easy to miss important cases and then those use cases end up high and dry with a non-solution.  As an example, I'm working on a use case right now where registration context would be a huge problem - it's (again) a tracing use case: our data service allows registering interceptors for incoming data and the interceptors are what actually trigger the UI update (possibly via a signal reaction, which is another callback registration that would need to preserve call-time semantics instead of registration semantics for this all to work).  If <em>either</em> the RPC interceptors <em>or</em> the signal reactions use registration context, we're sunk and there's no way to trace an interaction from the initiating event all the way to the UI update, given how loosely-coupled all the reactions in the framework are.</blockquote></mx-reply>Can you make an example case in code?","m.relates_to":{"m.in_reply_to":{"event_id":"$TQjFwAdq9-9pCTS0dM1kpz9Oh5ayG1ygCHxYm8KJH8U"}},"msgtype":"m.text"},"ts":1712023069223,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$eQIbhXi44OkiX9AQVFPXWzfcZo6Gd-WAlj7PS9s2hyI"},
{"content":{"body":"Yeah sorry I don’t mean that I disagree with the expressiveness argument everywhere, just more like I would want to hear about concrete applications like what you are raising, rather than just the abstract form. Thanks for bringing this up.","msgtype":"m.text"},"ts":1712024227405,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$YkjEAJgXu3V7mEqyg_V1pTry04HaCW2vHlTWfP_NNRs"},
{"content":{"body":"What is the context of the call-time of `MessagePort.p.onmessage`? Is it an empty context?","format":"org.matrix.custom.html","formatted_body":"What is the context of the call-time of <code>MessagePort.p.onmessage</code>? Is it an empty context?","m.mentions":{},"m.relates_to":{"event_id":"$wT6K5_vefgTYws30RZoxnfJ5ZbeUWEk9NTbTg4gUk4E","is_falling_back":true,"m.in_reply_to":{"event_id":"$wT6K5_vefgTYws30RZoxnfJ5ZbeUWEk9NTbTg4gUk4E"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1712044195633,"senderName":"Chengzhong Wu","senderId":"@legendecas:matrix.org","id":"$n9p0dvFLz9RbsrUMda0feabYRZM4VVNUEaXrbSTKEeY"},
{"content":{"body":"yeah","m.mentions":{},"m.relates_to":{"event_id":"$wT6K5_vefgTYws30RZoxnfJ5ZbeUWEk9NTbTg4gUk4E","is_falling_back":true,"m.in_reply_to":{"event_id":"$n9p0dvFLz9RbsrUMda0feabYRZM4VVNUEaXrbSTKEeY"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1712044228614,"senderName":"Andreu Botella","senderId":"@abotella:igalia.com","id":"$ayjp86-F15NQG2W5ZaFLG0_iEXzpg3IbgiGBi0t13lc"},
{"content":{"body":"Hmm, how is it useful if it is an empty context? Or, this is a case of inconsistency in zone.js, I assume","m.mentions":{},"m.relates_to":{"event_id":"$wT6K5_vefgTYws30RZoxnfJ5ZbeUWEk9NTbTg4gUk4E","is_falling_back":true,"m.in_reply_to":{"event_id":"$ayjp86-F15NQG2W5ZaFLG0_iEXzpg3IbgiGBi0t13lc"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1712044285053,"senderName":"Chengzhong Wu","senderId":"@legendecas:matrix.org","id":"$Q3-WrOmfYT21qAlrpNRETzmy6wijVh-CKJ0f8BQXxI0"},
{"content":{"body":"I'm not sure why they do this, but I think zone.js does give you a way to make `onmessage` be registration-time, it's just not enabled by default","format":"org.matrix.custom.html","formatted_body":"I'm not sure why they do this, but I think zone.js does give you a way to make <code>onmessage</code> be registration-time, it's just not enabled by default","m.mentions":{},"m.relates_to":{"event_id":"$wT6K5_vefgTYws30RZoxnfJ5ZbeUWEk9NTbTg4gUk4E","is_falling_back":true,"m.in_reply_to":{"event_id":"$Q3-WrOmfYT21qAlrpNRETzmy6wijVh-CKJ0f8BQXxI0"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1712044351925,"senderName":"Andreu Botella","senderId":"@abotella:igalia.com","id":"$Ag9varUgkxxJB0VotPbhoel8fReA62SVsYxpFsWq1RI"},
{"content":{"body":"I'm not sure why that is though","m.mentions":{},"m.relates_to":{"event_id":"$wT6K5_vefgTYws30RZoxnfJ5ZbeUWEk9NTbTg4gUk4E","is_falling_back":true,"m.in_reply_to":{"event_id":"$Ag9varUgkxxJB0VotPbhoel8fReA62SVsYxpFsWq1RI"},"rel_type":"m.thread"},"msgtype":"m.text"},"ts":1712044362221,"senderName":"Andreu Botella","senderId":"@abotella:igalia.com","id":"$NselcgTOB9xDbuhhXmYXSRkYw7jVHwITzk3aOHYISkY"},
{"content":{"body":"I am on the trip and will not be able to join the call today","m.mentions":{},"msgtype":"m.text"},"ts":1712068260601,"senderName":"Chengzhong Wu","senderId":"@legendecas:matrix.org","id":"$plzkR0ZYdMpymyftdiK5fTKjHnXbqeGnQS5_Sgi0fx8"},
{"content":{"body":"Ping!","msgtype":"m.text"},"ts":1712073912675,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$vNzq6g9e0j7SqzP-mBWpjRsvscevQMjjKtAg3cjngMQ"},
{"content":{"body":"Interesting discussion about retrieving the call-time context today. Will post a GH issue later today.","msgtype":"m.text"},"ts":1712078845799,"senderName":"Justin Ridgewell","senderId":"@jridgewell:matrix.org","id":"$Rfg6WUYVT-wd-8hM_WYzyRiswiKfIUrjvROMgR_Jx1o"},
{"content":{"body":"I had a nice chat with Qard here in London about the generator concerns. Ultimately this relates to Koa’s use of generators, but that makes me think that our save-and-restore-across-yield semantics would actually be *better*. We were unable to come to a concrete case which is made worse by the semantics, though there will be some differences vs today’s Node AsyncLocalStorage. IMO, until I hear further evidence, I think this is a good tradeoff and we should stick with the current generator design.","format":"org.matrix.custom.html","formatted_body":"I had a nice chat with Qard here in London about the generator concerns. Ultimately this relates to Koa’s use of generators, but that makes me think that our save-and-restore-across-yield semantics would actually be <em>better</em>. We were unable to come to a concrete case which is made worse by the semantics, though there will be some differences vs today’s Node AsyncLocalStorage. IMO, until I hear further evidence, I think this is a good tradeoff and we should stick with the current generator design.","msgtype":"m.text"},"ts":1712101381757,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$oEmdBStKfHexgx1XopHHX6sEZZ8yNcaxNJ_6LfFs_zk"}
]