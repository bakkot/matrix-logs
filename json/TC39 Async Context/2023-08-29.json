[
{"content":{"body":"OK, thanks for explaining, Andreu: the core issue is, if you do `p.then(cb)`, and p is an unhandled rejection, do we get this run in the snapshot of `p`'s rejection, or the callsite of `.then`. If we don't store something extra, it'd be the callsite of `.then`.","format":"org.matrix.custom.html","formatted_body":"OK, thanks for explaining, Andreu: the core issue is, if you do <code>p.then(cb)</code>, and p is an unhandled rejection, do we get this run in the snapshot of <code>p</code>'s rejection, or the callsite of <code>.then</code>. If we don't store something extra, it'd be the callsite of <code>.then</code>.","msgtype":"m.text"},"ts":1693269092220,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$BwFUJrEUSKql3r9G_zb4wfKfvYW1zp8hVgBuBW3OfY8"},
{"content":{"body":"I guess this would generally also apply whenever you await a rejection, which is always like a `.then` call (and not even with a trivial second callback!)","format":"org.matrix.custom.html","formatted_body":"I guess this would generally also apply whenever you await a rejection, which is always like a <code>.then</code> call (and not even with a trivial second callback!)","msgtype":"m.text"},"ts":1693269217070,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$v_1YVWZWqLlthx0u-TmxmKOTe7c-fzLua-mljaU89_o"},
{"content":{"body":"but... this is also pretty similar to the async context where the promise was allocated, isn't it? the same issue exists when you have a bunch of async functions calling each other and there's a rejection on the inside. Isn't it the outermost promise that's the \"unhandled rejection\"?","msgtype":"m.text"},"ts":1693269295948,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$oFiwiY1-ee1Leb7rHXwdRguv_G9vgs065cQUQgXl1os"}
]