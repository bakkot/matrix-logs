[
{"content":{"body":"> <@jiali.passion:matrix.org> So there are two cases.\n> 1. User registered the click event handler in zone1, and user click the button with mouse, the click behavior happens in a noop zone (the default zone), and the handler should run in the registered zone.\n> 2. User registered the click event handler in zone1, and user trigger the zone programmatically with something like dispatchEvent in zone2, so in this case, it is confusing that which zone should the handler run into, from the zone.js unified policy perspective, it should be zone1, otherwise in the 1st usecase, the handler should run in the noop zone,  but some user may want to see zone2 in some scenario.\n> I still belive the current policy (run callback in the register zone) make more senses, and maybe in some cases let use can also access both the register zone and the trigger zone will be better.\n\nI agree that the inconsistency of falling back is troubling. But I guess I don't see what the problem is with having interactions trigger in the null zone? Out of the three options (fall back with inconsistency, always registration but no reasonable way to access the trigger, or always trigger but sometimes/often that's the null zone) I'm happiest with the trade-off of sometimes exposing the null zone.","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!eQuZUAhGqudVFPodUG:matrix.org/$G-Lsfeqtn7UXEUhZ9aX90W5l8f4bKlDrUXRZGUUXVMI?via=matrix.org&via=mozilla.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@jiali.passion:matrix.org\">@jiali.passion:matrix.org</a><br /><p>So there are two cases.</p>\n<ol>\n<li>User registered the click event handler in zone1, and user click the button with mouse, the click behavior happens in a noop zone (the default zone), and the handler should run in the registered zone.</li>\n<li>User registered the click event handler in zone1, and user trigger the zone programmatically with something like dispatchEvent in zone2, so in this case, it is confusing that which zone should the handler run into, from the zone.js unified policy perspective, it should be zone1, otherwise in the 1st usecase, the handler should run in the noop zone,  but some user may want to see zone2 in some scenario.</li>\n</ol>\n<p>I still belive the current policy (run callback in the register zone) make more senses, and maybe in some cases let use can also access both the register zone and the trigger zone will be better.</p></blockquote></mx-reply>I agree that the inconsistency of falling back is troubling. But I guess I don't see what the problem is with having interactions trigger in the null zone? Out of the three options (fall back with inconsistency, always registration but no reasonable way to access the trigger, or always trigger but sometimes/often that's the null zone) I'm happiest with the trade-off of sometimes exposing the null zone.","m.relates_to":{"m.in_reply_to":{"event_id":"$G-Lsfeqtn7UXEUhZ9aX90W5l8f4bKlDrUXRZGUUXVMI"}},"msgtype":"m.text"},"ts":1716515829254,"senderName":"Steve Hicks","senderId":"@stephenhicks:matrix.org","id":"$GqF7ammevyKUiAcNjmuHCJja1POMJjC9aOwrlHW_YKw"},
{"content":{"body":"When is the null zone what you want?","msgtype":"m.text"},"ts":1716518229347,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$_v6j-GL2JVgKo7_oVMHNuDYDDszW9fnvRaZHbURhcCI"},
{"content":{"body":"The registration time zone is often what you want, on the other hand, eg for onload, setTimeout, etc. I donâ€™t see how we could have any sort of consistent principle that you never get the registration context.","msgtype":"m.text"},"ts":1716518277054,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$dhRGS8kp0RvgHGl1UlLvlzGyLqP5gfnBv_dzyI2W5LA"},
{"content":{"body":"It's a spectrum. \"Never registration\" is one extreme end, and I don't think it's tenable. But for any _given_ API (e.g. events as a whole, or possibly split-out per event emitter/type) I'm very wary of a zalgoesque situation where the callback might run in one of two different contexts depending on unpredictable future conditions. I think that in the same way that it's important to know precisely whether a callback will run synchronously or not, it's similarly important to know ahead of time which context it will run in, and having a fallback muddies it and is (in my view) a worse trade-off than running in a \"useless\" context by default.","msgtype":"m.text"},"ts":1716519746483,"senderName":"Steve Hicks","senderId":"@stephenhicks:matrix.org","id":"$1Vz8Atz0BJSsYX1qfZHPJGKQDbTsPhkMDXc6MbV3czw"},
{"content":{"body":"For something like onclick, the normal case is that it was triggered by the mouse, and the exceptional case is where JS dispatched the event. What should happen for that?","msgtype":"m.text"},"ts":1716519998819,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$j10Ss4fG-N15QdwHuWW04RafEkpkXvo1V2pTzY6xonY"},
{"content":{"body":"I would prefer to never expose a null context. If we can avoid that, then the value of all of your variables is always derived from previous code which triggered this one. Sorry, that is a theoretical argument and not a use-case-driven one, but it feels like an important property to preserve.","msgtype":"m.text"},"ts":1716520088567,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$uKvdFUPa4s1soUchNLP3EFTHxXDk-bIFXG3kzgPsLSM"},
{"content":{"body":"I can relate to the vague Zalgo concern but am not sure if that is the overriding, most important thing to drive the decision ","format":"org.matrix.custom.html","formatted_body":"I can relate to the vague Zalgo concern but am not sure if that is the overriding, most important thing to drive the decision","msgtype":"m.text"},"ts":1716520136270,"senderName":"littledan","senderId":"@littledan:matrix.org","id":"$xLA4gw7OgaxofPeJa7ezFbyTOB2gSBYRn1j_yjYyceA"}
]