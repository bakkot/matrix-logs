[
{"content":{"body":"* We have a similar thing in https://www.npmjs.com/package/@endo/trampoline","m.new_content":{"body":"> <@bakkot:matrix.org> I guess this is not all that common, but e.g. I have this helper where I want a function to be sync when passed a sync callback and async when passed an async callback\n> \n> ```\n> function split(genFn) {\n>   function runSync(...args) {\n>     const it = genFn(...args);\n>     let next = it.next();\n>     while (true) {\n>       if (next.done) return next.value;\n>       next = it.next(next.value);\n>     }\n>   }\n> \n>   async function runAsync(...args) {\n>     const it = genFn(...args);\n>     let next = it.next();\n>     while (true) {\n>       if (next.done) {\n>         return await next.value;\n>       }\n>       try {\n>         next = it.next(await next.value);\n>       } catch (err) {\n>         next = it.throw(err);\n>       }\n>     }\n>   }\n> \n>   return { sync: runSync, async: runAsync };\n> }\n> ```\n\nWe have a similar thing in https://www.npmjs.com/package/@endo/trampoline","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!eQuZUAhGqudVFPodUG:matrix.org/$CN4n-_wQhEbGSIEynmgIbrXNF-pGBBk_4VKsiIDRerQ?via=matrix.org&via=mozilla.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@bakkot:matrix.org\">bakkot</a><br /><p>I guess this is not all that common, but e.g. I have this helper where I want a function to be sync when passed a sync callback and async when passed an async callback</p>\n<pre><code>function split(genFn) {\n  function runSync(...args) {\n    const it = genFn(...args);\n    let next = it.next();\n    while (true) {\n      if (next.done) return next.value;\n      next = it.next(next.value);\n    }\n  }\n\n  async function runAsync(...args) {\n    const it = genFn(...args);\n    let next = it.next();\n    while (true) {\n      if (next.done) {\n        return await next.value;\n      }\n      try {\n        next = it.next(await next.value);\n      } catch (err) {\n        next = it.throw(err);\n      }\n    }\n  }\n\n  return { sync: runSync, async: runAsync };\n}\n</code></pre>\n</blockquote></mx-reply>We have a similar thing in https://www.npmjs.com/package/@endo/trampoline","msgtype":"m.text"},"m.relates_to":{"event_id":"$FDr7aGqYWkLgf23MwJ25bqqfeYlNwirCRvafKB2BRR8","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1758672105045,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$g89kfNnbg_oxmCBS5VINqEZbLJwa1PBn4HabjLHTBfk"}
]