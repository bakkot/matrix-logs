[
{"content":{"body":"Anyone have any idea regarding the wait(Async)/notify thing above? I'm planning on just writing my implementation as a Futex syscall wrapper, and thus doing the \"fail-fast\" path outside of the critical section. Of course, the syscall will also perform the same read inside its critical section (presumably) so rather than moving anything, I'm just adding an extra read of the SAB to check if a syscall should be made or not.","m.mentions":{},"msgtype":"m.text"},"ts":1763532969476,"senderName":"Aapo Alasuutari","senderId":"@aapo.alasuutari:matrix.org","id":"$cbh9LcxaTgp4GPTub0EoxdOq8IQuvPLOOkFSgvK640k"},
{"content":{"body":"Uhh, am I crazy or is the `DoWait`'s timeout handling text just plain wrong? This is the text:\n\n> 8. Let q be ? ToNumber(timeout).\n> 9. If q is either NaN or +âˆğ”½, let t be +âˆ; else if q is -âˆğ”½, let t be 0; else let t be max(â„(q), 0).\n\nBut then there's a bunch of tests testing that passing `undefined` as `timeout` coerces to 0. `ToNumber(undefined)` returns `NaN` so we should go into the first branch and set t as +âˆ.","format":"org.matrix.custom.html","formatted_body":"<p>Uhh, am I crazy or is the <code>DoWait</code>'s timeout handling text just plain wrong? This is the text:</p>\n<blockquote>\n<ol start=\"8\">\n<li>Let q be ? ToNumber(timeout).</li>\n<li>If q is either NaN or +âˆğ”½, let t be +âˆ; else if q is -âˆğ”½, let t be 0; else let t be max(â„(q), 0).</li>\n</ol>\n</blockquote>\n<p>But then there's a bunch of tests testing that passing <code>undefined</code> as <code>timeout</code> coerces to 0. <code>ToNumber(undefined)</code> returns <code>NaN</code> so we should go into the first branch and set t as +âˆ.</p>\n","m.mentions":{},"msgtype":"m.text"},"ts":1763585683528,"senderName":"Aapo Alasuutari","senderId":"@aapo.alasuutari:matrix.org","id":"$5P7Eu2vgxkSfqlIzN8cKg_wpGLbmjqZARU0SoyaF6BE"},
{"content":{"body":"But presumably the tests are the correct source here.","m.mentions":{},"msgtype":"m.text"},"ts":1763585706625,"senderName":"Aapo Alasuutari","senderId":"@aapo.alasuutari:matrix.org","id":"$mJlSJQzRvZIxz0A1TXz_2QaJlsNBYEbAN3vPsDNJftA"},
{"content":{"body":"https://github.com/tc39/test262/blob/main/test/built-ins/Atomics/waitAsync/bigint/undefined-for-timeout.js\nhttps://github.com/tc39/test262/blob/main/test/built-ins/Atomics/waitAsync/undefined-for-timeout.js\nhttps://github.com/tc39/test262/blob/main/test/built-ins/Atomics/wait/undefined-for-timeout.js","m.mentions":{},"msgtype":"m.text"},"ts":1763585941599,"senderName":"Aapo Alasuutari","senderId":"@aapo.alasuutari:matrix.org","id":"$DCR_ssGv4jtP_CXgsfuWAItG5n2drB-Q2ZymuU0OFwg"},
{"content":{"body":"I guess it's just the few tests that are wrong after all.","m.mentions":{},"msgtype":"m.text"},"ts":1763586005396,"senderName":"Aapo Alasuutari","senderId":"@aapo.alasuutari:matrix.org","id":"$PxB2qhz14pLQR8doKc0DLVh7GXztwh_4PF6Nu3X_XiE"}
]