[
{"content":{"body":"> <@aclaymore:matrix.org> PSA: There is the monthly Records&Tuples call tomorrow, 16th, 7pm UTC \n\nRecord&Tuple monthly call starts in 1hr. Informal (not an official TC39 meeting) so open to the community: https://meet.google.com/iym-znhi-zno","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!wbACpffbfxANskIFZq%3Amatrix.org/%24hEchPp_gA_gTJcYpgGW4nwL-1b9mPscXuAQ_bBjh-60\">In reply to</a> <a href=\"https://matrix.to/#/@aclaymore:matrix.org\">@aclaymore:matrix.org</a><br>PSA: There is the monthly Records&Tuples call tomorrow, 16th, 7pm UTC </blockquote></mx-reply>Record&amp;Tuple monthly call starts in 1hr. Informal (not an official TC39 meeting) so open to the community: https://meet.google.com/iym-znhi-zno","m.relates_to":{"m.in_reply_to":{"event_id":"$hEchPp_gA_gTJcYpgGW4nwL-1b9mPscXuAQ_bBjh-60"}},"msgtype":"m.text"},"ts":1637085778306,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$bvcA3udd-wWTnDUhbf0mNOMuREKLKHoATZf4t6-1kmc"},
{"content":{"body":"shu you may be interested in this thread on liveness on es-discourse: https://es.discourse.group/t/liveness-barriers-and-finalization/1082/","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@shuyuguo:matrix.org\">shu</a> you may be interested in this thread on liveness on es-discourse: https://es.discourse.group/t/liveness-barriers-and-finalization/1082/","msgtype":"m.text"},"ts":1637095524497,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$ERkbA0OrKCx_dJ2VZLNMUBsJPeK9_pGEXk140RpYDk4"},
{"content":{"body":"interesting","msgtype":"m.text"},"ts":1637095931595,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$JkoBkrOxl5od8zbGN3TMX7bQSuCcVwqOcGkZBPGyk7I"},
{"content":{"body":"felix wants a portable liveness fence","msgtype":"m.text"},"ts":1637095952060,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$wFvzJf3xFJT-Jvh-JRueTUADB7vPtlz5oeckaGk13iA"},
{"content":{"body":"i don't think that exists","msgtype":"m.text"},"ts":1637095954203,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$HcjghyDOp2gCA8bJMXfhgZx9G7QccKvRYES5-DIHey0"},
{"content":{"body":"(for the reasons that they point out, basically)","msgtype":"m.text"},"ts":1637095969255,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$rnqwnPRqQ6UgI4HJqTOz17t_70KmFpaqjxwA4nsW5Nk"},
{"content":{"body":"well let me think about it some more","msgtype":"m.text"},"ts":1637096011914,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$XADLsLP3SGQ9B3PxFsVXRP6noNbBOUod9jGSM0XOQqY"},
{"content":{"body":"one probably does exist for any given program (and a closed world assumption)","msgtype":"m.text"},"ts":1637096027588,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$att2r-kYoJ1jXwF_DKG6SPaA34he3vONNXEZc-oY50Y"},
{"content":{"body":"but i'm not sure one exists for all implementations for all given programs","msgtype":"m.text"},"ts":1637096035574,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$dxm7fMb93UXNpFf0nheslASnsfp9lKB_Fj-CYwB5HVc"},
{"content":{"body":" * but i'm not sure one exists for all implementations for all given programs","m.new_content":{"body":"but i'm not sure one exists for all implementations for all given programs","msgtype":"m.text"},"m.relates_to":{"event_id":"$dxm7fMb93UXNpFf0nheslASnsfp9lKB_Fj-CYwB5HVc","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1637096042611,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$_JzuMUoNno_qbdjz_uKXTknzbm1Ftev7usnY60lny8Y"},
{"content":{"body":"> <@shuyuguo:matrix.org> one probably does exist for any given program (and a closed world assumption)\n\nUsing `eval` to try and disable all optimisations would be cheating right?..","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!wbACpffbfxANskIFZq%3Amatrix.org/%24att2r-kYoJ1jXwF_DKG6SPaA34he3vONNXEZc-oY50Y\">In reply to</a> <a href=\"https://matrix.to/#/@shuyuguo:matrix.org\">@shuyuguo:matrix.org</a><br>one probably does exist for any given program (and a closed world assumption)</blockquote></mx-reply>Using <code>eval</code> to try and disable all optimisations would be cheating right?..","m.relates_to":{"m.in_reply_to":{"event_id":"$att2r-kYoJ1jXwF_DKG6SPaA34he3vONNXEZc-oY50Y"}},"msgtype":"m.text"},"ts":1637097201361,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$kgyUb4PuahzzLW8HM1mh_xg6A9oOvNOXejc4FqLCBU4"},
{"content":{"body":"`new WeakRef(obj)` actually is a liveness fence, by my reading","format":"org.matrix.custom.html","formatted_body":"<code>new WeakRef(obj)</code> actually is a liveness fence, by my reading","msgtype":"m.text"},"ts":1637097347401,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$0wrUtkx-acCPigB1_A5UMCE8CYF6ln_BgykQke7ixw4"},
{"content":{"body":"since it adds `obj` to `KeptAlive`","format":"org.matrix.custom.html","formatted_body":"since it adds <code>obj</code> to <code>KeptAlive</code>","msgtype":"m.text"},"ts":1637097370606,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$x9NciMDhjqxSaFSahO2cHBrUKIkeeslrcu-LoNlRet0"},
{"content":{"body":"well, for one turn","msgtype":"m.text"},"ts":1637097772745,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$FaNLVdjfJWJUic42D0lRcrz7EsW1bHcrO3CWQ2LHTyE"},
{"content":{"body":"oh, like, constantly creating new WeakRefs?","msgtype":"m.text"},"ts":1637097794570,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$aowzvAYo-3zOcoPVGj4U0y-Nrdp4i_qOuHPLh8GwYKQ"},
{"content":{"body":"in practice i agree that is a fence","msgtype":"m.text"},"ts":1637097805004,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$kre6ToF02hCg0AVeL8Eq2mg-bo9cjcwznf_6_vsdH14"},
{"content":{"body":"but we hung all of this on observability which we also agreed to be too hard to pin down","msgtype":"m.text"},"ts":1637097824023,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$yLJd0Q4IWNX2bQjlUoBDDL1uMHHgwRq7FuMMdhRWWd8"},
{"content":{"body":"if the `new WeakRef(obj)` itself is unobservable, i'd imagine its effects to also be up for as-if DCE","format":"org.matrix.custom.html","formatted_body":"if the <code>new WeakRef(obj)</code> itself is unobservable, i'd imagine its effects to also be up for as-if DCE","msgtype":"m.text"},"ts":1637097848445,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$2KmXAt7plE2IKpSbzQhnVE8esXu4k1rBPOU5UCmAniY"},
{"content":{"body":"(though in practice of course nobody does that)","msgtype":"m.text"},"ts":1637097858665,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$2mutXWSFzQRcr6_JaQxP651goecfXG6ytMT_BlqsQ1Y"},
{"content":{"body":"i guess it's not that the `new WeakRef(obj)` would be unobservable, but whether the [[KeptAlive]] addition is unobservable","format":"org.matrix.custom.html","formatted_body":"i guess it's not that the <code>new WeakRef(obj)</code> would be unobservable, but whether the [[KeptAlive]] addition is unobservable","msgtype":"m.text"},"ts":1637098128507,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$ssnd_6wyBb_4XbQw-oH7pY8Sa0tH8E1CVpJZN3kuSDs"},
{"content":{"body":"right, and it is in fact observable, because addition to [[KeptAlive]] prevents collecting on the current turn","msgtype":"m.text"},"ts":1637098422698,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$Q6CWYyzvVp7fV2y8jVFC6VUK6aLib6Kywp8UxCY8Nkw"},
{"content":{"body":" * right, and it is in fact observable, because addition to [[KeptAlive]] prevents collecting on the current turn","m.new_content":{"body":"right, and it is in fact observable, because addition to [[KeptAlive]] prevents collecting on the current turn","msgtype":"m.text"},"m.relates_to":{"event_id":"$Q6CWYyzvVp7fV2y8jVFC6VUK6aLib6Kywp8UxCY8Nkw","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1637098448118,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$7jU9w5eLRgHkGG6kPsZP8B6f9KVvdxo_upcY7LJYZGo"},
{"content":{"body":"i think there are cases that could be unobservable, but only theoretically","msgtype":"m.text"},"ts":1637098481838,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$FDYksNjY2GnvjRhaG-oaRmTH-ExpeUSPNHeQopO2jvs"},
{"content":{"body":"like, if you have no `FinalizationRegistry`s or if the finalizer functions themselves are unobservable","format":"org.matrix.custom.html","formatted_body":"like, if you have no <code>FinalizationRegistry</code>s or if the finalizer functions themselves are unobservable","msgtype":"m.text"},"ts":1637098551946,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$pEGIqFoPRTuNwPWRJnvq62vckTBInwOacj7rSczGAnQ"},
{"content":{"body":"cause, like, are `malloc` and `free` observable? with an oracle i could stack allocate it","format":"org.matrix.custom.html","formatted_body":"cause, like, are <code>malloc</code> and <code>free</code> observable? with an oracle i could stack allocate it","msgtype":"m.text"},"ts":1637098608260,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$fNlVzS-JBBf9rXs7QGZiOjvmkk8BAqCzXUNragppKqM"},
{"content":{"body":"well, sure, but then you can't tell it's _not_ acting as a fence","format":"org.matrix.custom.html","formatted_body":"well, sure, but then you can't tell it's <em>not</em> acting as a fence","msgtype":"m.text"},"ts":1637098624222,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$3-vYQUhmhM9CVNAKyUu9N_PnrjKfxb2avHvMpi1XUPA"},
{"content":{"body":"by definition","msgtype":"m.text"},"ts":1637098625978,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$QerbJg7AL99cCxuw8U9YyKScnLqRL14eyRY5ielIcf4"},
{"content":{"body":"you can, because there's always an observability gap between the debugging tools and the optimizer","msgtype":"m.text"},"ts":1637098663658,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$_jaJhWR66FeQ7h_KYl_wU-FrIFfPnYT7cojbIsONQAI"},
{"content":{"body":"debugging tool (looking at RSS size or whatever) has the assumption all memory in a process is observable","msgtype":"m.text"},"ts":1637098687579,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$8OU7ppgjyZEfGCgPtab3oDPVxxTAccJ86rCYD9ncZR8"},
{"content":{"body":"the optimizer obviously does not have that assumption","msgtype":"m.text"},"ts":1637098691709,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$prVvkg5TfPxbs8urNi3EdR8ppGQB1PWFs1r75F-NYmo"},
{"content":{"body":"if there is no gap, then i'd agree","msgtype":"m.text"},"ts":1637098694531,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$1A357-Ly5Y7WlwXmlH-I2ylfaZO91zLaX82jmi8RM7I"},
{"content":{"body":"again this is academic, in practice it is a universal fence because we'll never be that optimized","msgtype":"m.text"},"ts":1637098714727,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$zarhtQG5BLIXLqxHRt_2IiV7Xh4corn501Ntbo77mYA"},
{"content":{"body":"well, ok, ignoring the debugger","msgtype":"m.text"},"ts":1637098724923,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$L27Nr4z8Ao4cozOIKox0hhwGuvMbTaUUU6sR2TOh8cw"},
{"content":{"body":"but how else do you observe that your finalizers are firing?","msgtype":"m.text"},"ts":1637098742057,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$Ak3pbR68u9W_EkX5DKh4sHoKjhUemK38jcARCMfXHgY"},
{"content":{"body":"like practically speaking","msgtype":"m.text"},"ts":1637098747947,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$d186IdHp-t73QRztAONByfhrt2gjPsjinMh46c9B648"},
{"content":{"body":"they have side effects?","msgtype":"m.text"},"ts":1637098750248,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$uRRloTnWNyQGEUGrrpVXh5pp0Ue5KIVmo7SatnsgHZY"},
{"content":{"body":"yeah, they consider freeing up memory or a resource a side effect","msgtype":"m.text"},"ts":1637098761082,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$fP2F552oOLQEipW3wt87BvitDx0ouC66a9brj8DATHY"},
{"content":{"body":"no, I mean, you can have a finalizer which has side effects","msgtype":"m.text"},"ts":1637098778140,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$SnOTy7VzbIhAEd2w_LiSl_yufoVLQ9B84c2v1864N74"},
{"content":{"body":"in javascript","msgtype":"m.text"},"ts":1637098779484,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$tTLyCNFjYMEvW-ri8xZHGQInw5UyaBR-ktC9gJWJdOg"},
{"content":{"body":"right","msgtype":"m.text"},"ts":1637098793150,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$INSdxtxwOYNCI9wORaMLUzgU9__7P70EgD3RUWFINh0"},
{"content":{"body":"like, actual program-level side effects, not just freeing memory or whatever","msgtype":"m.text"},"ts":1637098798089,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$6K0mHO68Kje_6_YbXK3JNzX9Be7OyfwhiJ-fJoeQk-o"},
{"content":{"body":"i'm saying, _if_ the finalizer is observable","format":"org.matrix.custom.html","formatted_body":"i'm saying, <em>if</em> the finalizer is observable","msgtype":"m.text"},"ts":1637098799556,"senderName":"shu","senderId":"@shuyuguo:matrix.org","id":"$wo1zLsqPEhyQIUdlThUawiCwOqMSHw4eUXmlGs4kJzU"}
]