[
{"content":{"body":"> <@ljharb:matrix.org> Promise has the brand checks but no non-side-effect way to check it; and error sadly has no way to do the brand check, yes. Yet.\n\nWe did discuss this on matrix a [few months ago](https://matrixlogs.bakkot.com/TC39_General/2022-05-11#L9). The inability to brand check a promise without side effects (in particular triggering proxy traps) is a major pain for us, and I would very much would like to find a way to make this possible. But a lot of people expressed concerns with revealing such a power, mostly about users doing conditional work based on the result type (promise or not, aka releasing Zalgo)","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!wbACpffbfxANskIFZq:matrix.org/$WOZVLGo9zM5uh9eCPutzFCgbpXG8eru_IiFZFtuu2E4?via=matrix.org&via=mozilla.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@ljharb:matrix.org\">@ljharb:matrix.org</a><br>Promise has the brand checks but no non-side-effect way to check it; and error sadly has no way to do the brand check, yes. Yet.</blockquote></mx-reply>We did discuss this on matrix a <a href=\"https://matrixlogs.bakkot.com/TC39_General/2022-05-11#L9\">few months ago</a>. The inability to brand check a promise without side effects (in particular triggering proxy traps) is a major pain for us, and I would very much would like to find a way to make this possible. But a lot of people expressed concerns with revealing such a power, mostly about users doing conditional work based on the result type (promise or not, aka releasing Zalgo)","m.relates_to":{"m.in_reply_to":{"event_id":"$WOZVLGo9zM5uh9eCPutzFCgbpXG8eru_IiFZFtuu2E4"}},"msgtype":"m.text","org.matrix.msc1767.message":[{"body":"> <@ljharb:matrix.org> Promise has the brand checks but no non-side-effect way to check it; and error sadly has no way to do the brand check, yes. Yet.\n\nWe did discuss this on matrix a [few months ago](https://matrixlogs.bakkot.com/TC39_General/2022-05-11#L9). The inability to brand check a promise without side effects (in particular triggering proxy traps) is a major pain for us, and I would very much would like to find a way to make this possible. But a lot of people expressed concerns with revealing such a power, mostly about users doing conditional work based on the result type (promise or not, aka releasing Zalgo)","mimetype":"text/plain"},{"body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!wbACpffbfxANskIFZq:matrix.org/$WOZVLGo9zM5uh9eCPutzFCgbpXG8eru_IiFZFtuu2E4?via=matrix.org&via=mozilla.org&via=igalia.com\">In reply to</a> <a href=\"https://matrix.to/#/@ljharb:matrix.org\">@ljharb:matrix.org</a><br>Promise has the brand checks but no non-side-effect way to check it; and error sadly has no way to do the brand check, yes. Yet.</blockquote></mx-reply>We did discuss this on matrix a <a href=\"https://matrixlogs.bakkot.com/TC39_General/2022-05-11#L9\">few months ago</a>. The inability to brand check a promise without side effects (in particular triggering proxy traps) is a major pain for us, and I would very much would like to find a way to make this possible. But a lot of people expressed concerns with revealing such a power, mostly about users doing conditional work based on the result type (promise or not, aka releasing Zalgo)","mimetype":"text/html"}]},"ts":1672626415326,"senderName":"Mathieu Hofman","senderId":"@mhofman:matrix.org","id":"$G-Iog_-Cp1quKoiX4v5tBduU8bkS6qvl8h5Ah-rsApg"},
{"content":{"body":"Yes, and my recommendation is that our stance should be to enable and help people to avoid releasing Zalgo, not prevent people from releasing Zalgo. The latter is not possible. The former is possible while still revealing a brand check. It’s not the same magnitude of hazard as, say, an API to synchronously query the state of a promise.","msgtype":"m.text","org.matrix.msc1767.text":"Yes, and my recommendation is that our stance should be to enable and help people to avoid releasing Zalgo, not prevent people from releasing Zalgo. The latter is not possible. The former is possible while still revealing a brand check. It’s not the same magnitude of hazard as, say, an API to synchronously query the state of a promise."},"ts":1672626882565,"senderName":"Kris Kowal","senderId":"@kriskowal:matrix.org","id":"$xyvHyLBmVKsicay1UY7rzvuMM4EIXSjQhOAopPf0aw4"},
{"content":{"body":"Since we're talking about this stuff, reminder that https://github.com/tc39/proposal-faster-promise-adoption exists","msgtype":"m.text","org.matrix.msc1767.text":"Since we're talking about this stuff, reminder that https://github.com/tc39/proposal-faster-promise-adoption exists"},"ts":1672633917810,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$p-MpT-7z0IYwpuwxT4ohWf8CiAwjIx-kT82SAKsSS6s"},
{"content":{"body":"Hello everyone. I've been trying to understand https://tc39.es/ecma262/#sec-functiondeclarationinstantiation.\n\nSay I have the function:\n\n```JavaScript\nfunction f() {\n      const x = 2;\n      let y = 3;\n      var z = 4;\n  }\n```\n\nIs a single Lexical Environment created for x,y,z or is z stored on the first LE and x,y on another one with Outer Environment set to the first LE...or something else I didn't think of?","format":"org.matrix.custom.html","formatted_body":"<p>Hello everyone. I've been trying to understand https://tc39.es/ecma262/#sec-functiondeclarationinstantiation.</p>\n<p>Say I have the function:</p>\n<pre><code class=\"language-JavaScript\">function f() {\n      const x = 2;\n      let y = 3;\n      var z = 4;\n  }\n</code></pre>\n<p>Is a single Lexical Environment created for x,y,z or is z stored on the first LE and x,y on another one with Outer Environment set to the first LE...or something else I didn't think of?</p>\n","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"Hello everyone. I've been trying to understand https://tc39.es/ecma262/#sec-functiondeclarationinstantiation.\n\nSay I have the function:\n\n```JavaScript\nfunction f() {\n      const x = 2;\n      let y = 3;\n      var z = 4;\n  }\n```\n\nIs a single Lexical Environment created for x,y,z or is z stored on the first LE and x,y on another one with Outer Environment set to the first LE...or something else I didn't think of?","mimetype":"text/plain"},{"body":"<p>Hello everyone. I've been trying to understand https://tc39.es/ecma262/#sec-functiondeclarationinstantiation.</p>\n<p>Say I have the function:</p>\n<pre><code class=\"language-JavaScript\">function f() {\n      const x = 2;\n      let y = 3;\n      var z = 4;\n  }\n</code></pre>\n<p>Is a single Lexical Environment created for x,y,z or is z stored on the first LE and x,y on another one with Outer Environment set to the first LE...or something else I didn't think of?</p>\n","mimetype":"text/html"}]},"ts":1672676024011,"senderName":"voide","senderId":"@voide:matrix.org","id":"$d4zqKYcws-QVfXKADp5iwmeMZMmEA8TVteHe9x4ML2c"},
{"content":{"body":" * Hello everyone. I've been trying to understand https://tc39.es/ecma262/#sec-functiondeclarationinstantiation.\n\nSay I have the function:\n\n```JavaScript\nfunction f() {\n      const x = 2;\n      let y = 3;\n      var z = 4;\n  }\n```\n\nIs a single Lexical Environment created for x,y,z or is z stored on the first LE and x,y on another one with Outer Environment set to the first LE...or something else I didn't think of?","format":"org.matrix.custom.html","formatted_body":" * <p>Hello everyone. I've been trying to understand https://tc39.es/ecma262/#sec-functiondeclarationinstantiation.</p>\n<p>Say I have the function:</p>\n<pre><code class=\"language-JavaScript\">function f() {\n      const x = 2;\n      let y = 3;\n      var z = 4;\n  }\n</code></pre>\n<p>Is a single Lexical Environment created for x,y,z or is z stored on the first LE and x,y on another one with Outer Environment set to the first LE...or something else I didn't think of?</p>\n","m.new_content":{"body":"Hello everyone. I've been trying to understand https://tc39.es/ecma262/#sec-functiondeclarationinstantiation.\n\nSay I have the function:\n\n```JavaScript\nfunction f() {\n      const x = 2;\n      let y = 3;\n      var z = 4;\n  }\n```\n\nIs a single Lexical Environment created for x,y,z or is z stored on the first LE and x,y on another one with Outer Environment set to the first LE...or something else I didn't think of?","format":"org.matrix.custom.html","formatted_body":"<p>Hello everyone. I've been trying to understand https://tc39.es/ecma262/#sec-functiondeclarationinstantiation.</p>\n<p>Say I have the function:</p>\n<pre><code class=\"language-JavaScript\">function f() {\n      const x = 2;\n      let y = 3;\n      var z = 4;\n  }\n</code></pre>\n<p>Is a single Lexical Environment created for x,y,z or is z stored on the first LE and x,y on another one with Outer Environment set to the first LE...or something else I didn't think of?</p>\n","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"Hello everyone. I've been trying to understand https://tc39.es/ecma262/#sec-functiondeclarationinstantiation.\n\nSay I have the function:\n\n```JavaScript\nfunction f() {\n      const x = 2;\n      let y = 3;\n      var z = 4;\n  }\n```\n\nIs a single Lexical Environment created for x,y,z or is z stored on the first LE and x,y on another one with Outer Environment set to the first LE...or something else I didn't think of?","mimetype":"text/plain"},{"body":"<p>Hello everyone. I've been trying to understand https://tc39.es/ecma262/#sec-functiondeclarationinstantiation.</p>\n<p>Say I have the function:</p>\n<pre><code class=\"language-JavaScript\">function f() {\n      const x = 2;\n      let y = 3;\n      var z = 4;\n  }\n</code></pre>\n<p>Is a single Lexical Environment created for x,y,z or is z stored on the first LE and x,y on another one with Outer Environment set to the first LE...or something else I didn't think of?</p>\n","mimetype":"text/html"}]},"m.relates_to":{"event_id":"$d4zqKYcws-QVfXKADp5iwmeMZMmEA8TVteHe9x4ML2c","rel_type":"m.replace"},"msgtype":"m.text","org.matrix.msc1767.message":[{"body":" * Hello everyone. I've been trying to understand https://tc39.es/ecma262/#sec-functiondeclarationinstantiation.\n\nSay I have the function:\n\n```JavaScript\nfunction f() {\n      const x = 2;\n      let y = 3;\n      var z = 4;\n  }\n```\n\nIs a single Lexical Environment created for x,y,z or is z stored on the first LE and x,y on another one with Outer Environment set to the first LE...or something else I didn't think of?","mimetype":"text/plain"},{"body":" * <p>Hello everyone. I've been trying to understand https://tc39.es/ecma262/#sec-functiondeclarationinstantiation.</p>\n<p>Say I have the function:</p>\n<pre><code class=\"language-JavaScript\">function f() {\n      const x = 2;\n      let y = 3;\n      var z = 4;\n  }\n</code></pre>\n<p>Is a single Lexical Environment created for x,y,z or is z stored on the first LE and x,y on another one with Outer Environment set to the first LE...or something else I didn't think of?</p>\n","mimetype":"text/html"}]},"ts":1672676059416,"senderName":"voide","senderId":"@voide:matrix.org","id":"$pAJkKoBQF6b5z5hPdROnEy2ahV7_5RoznATbbR_GDtg"},
{"content":{"body":" * Hello everyone. I've been trying to understand https://tc39.es/ecma262/#sec-functiondeclarationinstantiation.\n\nSay I have the function:\n\n```JavaScript\nfunction f() {\n      const x = 2;\n      let y = 3;\n      var z = 4;\n  }\n```\n\nIs a single Lexical Environment created for x,y,z or is z stored on the first LE and x,y on another one with Outer Environment set to the first LE...or something else I didn't think of?\n\nI'm excluding the VE because there's only 1 reference (20d) and it looks only related to either a strict function or a function with Parameter Expressions.","format":"org.matrix.custom.html","formatted_body":" * <p>Hello everyone. I've been trying to understand https://tc39.es/ecma262/#sec-functiondeclarationinstantiation.</p>\n<p>Say I have the function:</p>\n<pre><code class=\"language-JavaScript\">function f() {\n      const x = 2;\n      let y = 3;\n      var z = 4;\n  }\n</code></pre>\n<p>Is a single Lexical Environment created for x,y,z or is z stored on the first LE and x,y on another one with Outer Environment set to the first LE...or something else I didn't think of?</p>\n<p>I'm excluding the VE because there's only 1 reference (20d) and it looks only related to either a strict function or a function with Parameter Expressions.</p>\n","m.new_content":{"body":"Hello everyone. I've been trying to understand https://tc39.es/ecma262/#sec-functiondeclarationinstantiation.\n\nSay I have the function:\n\n```JavaScript\nfunction f() {\n      const x = 2;\n      let y = 3;\n      var z = 4;\n  }\n```\n\nIs a single Lexical Environment created for x,y,z or is z stored on the first LE and x,y on another one with Outer Environment set to the first LE...or something else I didn't think of?\n\nI'm excluding the VE because there's only 1 reference (20d) and it looks only related to either a strict function or a function with Parameter Expressions.","format":"org.matrix.custom.html","formatted_body":"<p>Hello everyone. I've been trying to understand https://tc39.es/ecma262/#sec-functiondeclarationinstantiation.</p>\n<p>Say I have the function:</p>\n<pre><code class=\"language-JavaScript\">function f() {\n      const x = 2;\n      let y = 3;\n      var z = 4;\n  }\n</code></pre>\n<p>Is a single Lexical Environment created for x,y,z or is z stored on the first LE and x,y on another one with Outer Environment set to the first LE...or something else I didn't think of?</p>\n<p>I'm excluding the VE because there's only 1 reference (20d) and it looks only related to either a strict function or a function with Parameter Expressions.</p>\n","msgtype":"m.text","org.matrix.msc1767.message":[{"body":"Hello everyone. I've been trying to understand https://tc39.es/ecma262/#sec-functiondeclarationinstantiation.\n\nSay I have the function:\n\n```JavaScript\nfunction f() {\n      const x = 2;\n      let y = 3;\n      var z = 4;\n  }\n```\n\nIs a single Lexical Environment created for x,y,z or is z stored on the first LE and x,y on another one with Outer Environment set to the first LE...or something else I didn't think of?\n\nI'm excluding the VE because there's only 1 reference (20d) and it looks only related to either a strict function or a function with Parameter Expressions.","mimetype":"text/plain"},{"body":"<p>Hello everyone. I've been trying to understand https://tc39.es/ecma262/#sec-functiondeclarationinstantiation.</p>\n<p>Say I have the function:</p>\n<pre><code class=\"language-JavaScript\">function f() {\n      const x = 2;\n      let y = 3;\n      var z = 4;\n  }\n</code></pre>\n<p>Is a single Lexical Environment created for x,y,z or is z stored on the first LE and x,y on another one with Outer Environment set to the first LE...or something else I didn't think of?</p>\n<p>I'm excluding the VE because there's only 1 reference (20d) and it looks only related to either a strict function or a function with Parameter Expressions.</p>\n","mimetype":"text/html"}]},"m.relates_to":{"event_id":"$d4zqKYcws-QVfXKADp5iwmeMZMmEA8TVteHe9x4ML2c","rel_type":"m.replace"},"msgtype":"m.text","org.matrix.msc1767.message":[{"body":" * Hello everyone. I've been trying to understand https://tc39.es/ecma262/#sec-functiondeclarationinstantiation.\n\nSay I have the function:\n\n```JavaScript\nfunction f() {\n      const x = 2;\n      let y = 3;\n      var z = 4;\n  }\n```\n\nIs a single Lexical Environment created for x,y,z or is z stored on the first LE and x,y on another one with Outer Environment set to the first LE...or something else I didn't think of?\n\nI'm excluding the VE because there's only 1 reference (20d) and it looks only related to either a strict function or a function with Parameter Expressions.","mimetype":"text/plain"},{"body":" * <p>Hello everyone. I've been trying to understand https://tc39.es/ecma262/#sec-functiondeclarationinstantiation.</p>\n<p>Say I have the function:</p>\n<pre><code class=\"language-JavaScript\">function f() {\n      const x = 2;\n      let y = 3;\n      var z = 4;\n  }\n</code></pre>\n<p>Is a single Lexical Environment created for x,y,z or is z stored on the first LE and x,y on another one with Outer Environment set to the first LE...or something else I didn't think of?</p>\n<p>I'm excluding the VE because there's only 1 reference (20d) and it looks only related to either a strict function or a function with Parameter Expressions.</p>\n","mimetype":"text/html"}]},"ts":1672676374557,"senderName":"voide","senderId":"@voide:matrix.org","id":"$k9rmuey1YIAhNVNT1aXyml-VqAZAB1LjXvnYfR7UwtA"}
]