[
{"content":{"body":"the issue is great, it'll get fixed, thanks","m.mentions":{},"msgtype":"m.text"},"ts":1753078820990,"senderName":"ljharb","senderId":"@ljharb:matrix.org","id":"$sFGVtYnT2wqe6C5tDl6IOwBAffqgpWkYRZXVq-k10RQ"},
{"content":{"body":"is there a clean way to un-using something","m.mentions":{},"msgtype":"m.text"},"ts":1753104136436,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$jqUtlF_wIULDwD_IHV-p5A5v2He5p2t4YpCx2JeVBP8"},
{"content":{"body":"r/BrandNewSentence","m.mentions":{"user_ids":["@devsnek:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$jqUtlF_wIULDwD_IHV-p5A5v2He5p2t4YpCx2JeVBP8"}},"msgtype":"m.text"},"ts":1753107507222,"senderName":"Aki","senderId":"@akirose:matrix.org","id":"$t4Wz8JhcVG7iEuiijvSr-CbAE1PLIz8XUmbewB1Rjng"},
{"content":{"body":"...`delete`? ü§∑‚Äç‚ôÇÔ∏è","format":"org.matrix.custom.html","formatted_body":"...<code data-md=\"`\">delete</code>? ü§∑‚Äç‚ôÇÔ∏è","m.mentions":{"user_ids":["@devsnek:matrix.org"]},"m.relates_to":{"m.in_reply_to":{"event_id":"$jqUtlF_wIULDwD_IHV-p5A5v2He5p2t4YpCx2JeVBP8"}},"msgtype":"m.text"},"ts":1753109220310,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$klLEpKoFAnnt_tIK_uM2uRm9XGDbFRj9kTTgwydxdjo"},
{"content":{"body":"@rbuckton:matrix.org make it work","format":"org.matrix.custom.html","formatted_body":"<a href=\"https://matrix.to/#/@rbuckton:matrix.org\">@rbuckton</a> make it work","m.mentions":{"user_ids":["@rbuckton:matrix.org"]},"msgtype":"m.text"},"ts":1753109722793,"senderName":"Michael Ficarra","senderId":"@michaelficarra:matrix.org","id":"$ngdum6Q5-qv182ZbOIa0felj-I945NPqz4rgGChzPoY"},
{"content":{"body":"un-using? That's what DisposableStack is for","msgtype":"m.text"},"ts":1753109785179,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$Rxa9iEZK7JpkNPmgmEu-u0VCRgi6OVu8e0UjLw4Yn8A"},
{"content":{"body":"```js\n{\n  using resource = getResource();\n} // always disposes resource\n\n// vs.\n\n{\n  using stack = new DisposableStack();\n  const resource = stack.use(getResource());\n  stack.move(); // move resource out of `stack`\n} // stack disposed but resource isn't\n```","format":"org.matrix.custom.html","formatted_body":"<pre><code class=\"language-js\">{\n  using resource = getResource();\n} // always disposes resource\n\n// vs.\n\n{\n  using stack = new DisposableStack();\n  const resource = stack.use(getResource());\n  stack.move(); // move resource out of `stack`\n} // stack disposed but resource isn't\n</code></pre>\n","m.mentions":{},"msgtype":"m.text"},"ts":1753109916725,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$A03-B3IIZVkvz8QiZX2I2HliEJywkmxAmUcWxTYQDs0"},
{"content":{"body":"One of its uses is with class constructors, where you want the resources to be disposed if the constructor throws, but tracked with the class if everything succeeds:\n\n```js\nclass MyResource {\n  #disposables;\n  #resource1;\n  #resource2;\n  constructor(options) {\n    using stack = new DisposableStack();\n    this.#resource1 = stack.use(getResource1(options));\n    this.#resource2 = stack.use(getResource2(options));\n    // both succeeded\n    this.#disposables = stack.move(); // move out of stack to store in #disposables\n  } // stack is disposed\n\n  [Symbol.dispose]() {\n    this.#disposables.dispose();\n  }\n}\n```","format":"org.matrix.custom.html","formatted_body":"<p>One of its uses is with class constructors, where you want the resources to be disposed if the constructor throws, but tracked with the class if everything succeeds:</p>\n<pre><code class=\"language-js\">class MyResource {\n  #disposables;\n  #resource1;\n  #resource2;\n  constructor(options) {\n    using stack = new DisposableStack();\n    this.#resource1 = stack.use(getResource1(options));\n    this.#resource2 = stack.use(getResource2(options));\n    // both succeeded\n    this.#disposables = stack.move(); // move out of stack to store in #disposables\n  } // stack is disposed\n\n  [Symbol.dispose]() {\n    this.#disposables.dispose();\n  }\n}\n</code></pre>\n","m.mentions":{},"msgtype":"m.text"},"ts":1753110182929,"senderName":"rbuckton","senderId":"@rbuckton:matrix.org","id":"$wKNx2lHKR9Ke14gjV_yPZVH2MK8n6AZ7UxWqSpYU8H4"}
]