[
{"content":{"body":"Does anyone know why ScriptEvaluation asserts that the execution context stack (on exit and presumably entry) isn't empty?","m.mentions":{},"msgtype":"m.text"},"ts":1706581174856,"senderName":"jmdyck","senderId":"@jmdyck:matrix.org","id":"$1gFfIWx4V-3e8ESrKlKjdPiPsQkHw-Vvxsp1OrRzfBU"},
{"content":{"body":"I can understand why HTML might want it to be the case, but that's HTML's problem.","m.mentions":{},"msgtype":"m.text"},"ts":1706581222652,"senderName":"jmdyck","senderId":"@jmdyck:matrix.org","id":"$hhMH94gj3r7cqibmmewQVjMHTtDvc94j8v7awgZh8vc"},
{"content":{"body":"Why does EcmaScript care whether it's empty or not?","m.mentions":{},"msgtype":"m.text"},"ts":1706581264894,"senderName":"jmdyck","senderId":"@jmdyck:matrix.org","id":"$b-c0hSjsvgL_0BLqXX1SyN4e0bmLBMzep__bEgBJtCA"},
{"content":{"body":"I would guess it is just there as a consistency check: every time a context is added, it is later removed","m.mentions":{},"msgtype":"m.text"},"ts":1706582100238,"senderName":"bakkot","senderId":"@bakkot:matrix.org","id":"$7ia0QcRrvqaEpdjl5fT7w6ueRQ7TWSmjKLxJykhE4sk"},
{"content":{"body":"i think the spec assumes you have an outer execution context that is kept with the realm","m.mentions":{},"msgtype":"m.text"},"ts":1706582240147,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$ybpNx7UnfObYJ1CYtKHPejqO0WcVhh50GdRuG8oiJhY"},
{"content":{"body":"but","m.mentions":{},"msgtype":"m.text"},"ts":1706582253577,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$8FnIiZZRZMxtk2rWodEgBxwmAtSHhFn6ysGxUv4W4w8"},
{"content":{"body":"i don't think its really necessary ","m.mentions":{},"msgtype":"m.text"},"ts":1706582268761,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$ta73Ok4eRekYaTkv-I01vlW3Z7uTRfQWYIvuC1Q1yJM"},
{"content":{"body":"@bakkot: Hm, asserting non-empty on exit isn't a very good way to achieve that consistency check.","m.mentions":{},"msgtype":"m.text"},"ts":1706582316268,"senderName":"jmdyck","senderId":"@jmdyck:matrix.org","id":"$zjNL3qDN_OcHiUUP-VmFWMvDh3u4bQSA86K34VbBXTs"},
{"content":{"body":"we already have that consistency check built into the stack operation itself","m.mentions":{},"msgtype":"m.text"},"ts":1706582345985,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$SLT1Ox66NqOWz3iuVLz_b_F7WxSbr2Ow_iBeiOZB52w"},
{"content":{"body":"> Suspend scriptContext and remove it from the execution context stack.\n\npresumably if this is a stack, there's only one thing you can remove ","format":"org.matrix.custom.html","formatted_body":"<blockquote>\n<p>Suspend scriptContext and remove it from the execution context stack.</p>\n</blockquote>\n<p>presumably if this is a stack, there's only one thing you can remove</p>\n","m.mentions":{},"msgtype":"m.text"},"ts":1706582407839,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$-9Ay5aLIWTLqdMrx2osdi5MSwfJMvZWzNPNvDVeoD8o"},
{"content":{"body":"I don't think there was a suggestion of ambiguity as to what to remove","m.mentions":{},"msgtype":"m.text"},"ts":1706582491591,"senderName":"jmdyck","senderId":"@jmdyck:matrix.org","id":"$7V7XPGMG_cTkB4XA_HdGAIifHuhefIBUUD6Isd1FASQ"},
{"content":{"body":"It would be useful to assert, e.g. that ScriptEvaluation leaves the EC stack the way it found it.","m.mentions":{},"msgtype":"m.text"},"ts":1706582564298,"senderName":"jmdyck","senderId":"@jmdyck:matrix.org","id":"$xFsr2IazH3caNwvQbWBd9NRv61WK8u4SvMp7r5gqA1I"},
{"content":{"body":"idk if it would be more useful than any other op that modifies the stack","m.mentions":{},"msgtype":"m.text"},"ts":1706582599991,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$aVm8UUsh3A8qiYr_hzKnAdYNmw-d5WzM6n5UakJscrk"},
{"content":{"body":"(which is not to say it wouldn't be useful)","m.mentions":{},"msgtype":"m.text"},"ts":1706582626543,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$JYXwBH0lZJ5bYtjFEtnr1MdvZl3RowZoR1oA0WnqE6U"},
{"content":{"body":"Some stack-manipulating AOs do this by grabbing the running execution context before pushing, then after popping, saying that the pop restores the former running EC.","m.mentions":{},"msgtype":"m.text"},"ts":1706582675950,"senderName":"jmdyck","senderId":"@jmdyck:matrix.org","id":"$7NwgYE846dgOP5r66yiLFnscNqWn2TNa0TS2YqeJVyY"},
{"content":{"body":"But that's not what ScriptEvaluation does.","m.mentions":{},"msgtype":"m.text"},"ts":1706582694456,"senderName":"jmdyck","senderId":"@jmdyck:matrix.org","id":"$e3v3p6hM6ybyZQ4TF4WPPEoviDZMstQe4AH5V5I_k-w"},
{"content":{"body":"Merely asserting a non-empty stack on exit doesn't achieve that at all.","m.mentions":{},"msgtype":"m.text"},"ts":1706582757678,"senderName":"jmdyck","senderId":"@jmdyck:matrix.org","id":"$Qqnxk61RAJP1oT8qipuVzfTXsN1eOpfWMkuCt7P5ymA"},
{"content":{"body":"can i just say how much i love that SS and RS are grouped together now","m.mentions":{},"msgtype":"m.text"},"ts":1706582774491,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$RORYa_HeRrJ37WUQWc82WCp-a6GR0RK6KNENrIUv4qA"},
{"content":{"body":"i think \"Resume the context that is now on the top of the execution context stack as the running execution context.\" is pretty standard","m.mentions":{},"msgtype":"m.text"},"ts":1706582844067,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$xgObt7KpIfYc6mL-982seWjhmEBbU09ZYSKDjSPMjzo"},
{"content":{"body":"the assertion is not though","m.mentions":{},"msgtype":"m.text"},"ts":1706582870356,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$0rrFX3Hbbrfs4fbRE8gbZvifx1APa5HHOV4xkklhbWg"},
{"content":{"body":"There are 7 occurrences of \"Remove _X_ from the EC stack and restore _Y_ as the running EC.\"","format":"org.matrix.custom.html","formatted_body":"There are 7 occurrences of \"Remove <em>X</em> from the EC stack and restore <em>Y</em> as the running EC.\"","m.mentions":{},"msgtype":"m.text"},"ts":1706583041351,"senderName":"jmdyck","senderId":"@jmdyck:matrix.org","id":"$2dnMs9pypeHB5KSZpxNB7rKLE0m8x27EIrVzG_w1p0I"},
{"content":{"body":"\"restore\" ðŸ¤”","m.mentions":{},"msgtype":"m.text"},"ts":1706583089497,"senderName":"snek","senderId":"@devsnek:matrix.org","id":"$GCMiZEt9rlvzuVBOpbGXXEFHvtvERZkJ6Sd172g1xpI"},
{"content":{"body":"(Actually, they're all literally `Remove _calleeContext_ from the execution context stack and restore _callerContext_ as the running execution context.`)","format":"org.matrix.custom.html","formatted_body":"(Actually, they're all literally <code>Remove _calleeContext_ from the execution context stack and restore _callerContext_ as the running execution context.</code>)","m.mentions":{},"msgtype":"m.text"},"ts":1706583229828,"senderName":"jmdyck","senderId":"@jmdyck:matrix.org","id":"$V0DBCRG1ie51BmWgNd0ooJnQlVCNG-5UoOw6QJQUhVo"}
]