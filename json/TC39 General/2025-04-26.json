[
{"content":{"body":"Anyone know whether any VMs GC registered symbols? My impression is that none do but also that they could without observable differences. ","format":"org.matrix.custom.html","formatted_body":"Anyone know whether any VMs GC registered symbols? My impression is that none do but also that they could without observable differences.","msgtype":"m.text"},"ts":1745641764259,"senderName":"kriskowal","senderId":"@kriskowal:aelf.land","id":"$xEoVvJwDAkOkOsq-aBrRkEqcpU-aV_VXbyoveSci5k8"},
{"content":{"body":"> <@kriskowal:aelf.land> Anyone know whether any VMs GC registered symbols? My impression is that none do but also that they could without observable differences. \n\nIs your question whether any JS implementations put primitive Symbol objects on their GC heap? Because LibJS (ladybird) has always done that. <https://github.com/LadybirdBrowser/ladybird/blob/master/Libraries/LibJS/Runtime/Symbol.h>","format":"org.matrix.custom.html","formatted_body":"<mx-reply><blockquote><a href=\"https://matrix.to/#/!wbACpffbfxANskIFZq:matrix.org/$xEoVvJwDAkOkOsq-aBrRkEqcpU-aV_VXbyoveSci5k8?via=serenityos.org&via=matrix.org&via=mozilla.org\">In reply to</a> <a href=\"https://matrix.to/#/@kriskowal:aelf.land\">@kriskowal:aelf.land</a><br />Anyone know whether any VMs GC registered symbols? My impression is that none do but also that they could without observable differences.</blockquote></mx-reply>Is your question whether any JS implementations put primitive Symbol objects on their GC heap? Because LibJS (ladybird) has always done that. <a href=\"https://github.com/LadybirdBrowser/ladybird/blob/master/Libraries/LibJS/Runtime/Symbol.h\">https://github.com/LadybirdBrowser/ladybird/blob/master/Libraries/LibJS/Runtime/Symbol.h</a>","m.relates_to":{"m.in_reply_to":{"event_id":"$xEoVvJwDAkOkOsq-aBrRkEqcpU-aV_VXbyoveSci5k8"}},"msgtype":"m.text"},"ts":1745675305354,"senderName":"akaster","senderId":"@akaster:serenityos.org","id":"$eTxKnw1YGrapxFDkrTwNXbJOqdHRb_hzvfNCq5f7kp8"},
{"content":{"body":"Oh, GC registered symbols meaning, \"remove unreferenced symbols\"? ","msgtype":"m.text"},"ts":1745676037906,"senderName":"akaster","senderId":"@akaster:serenityos.org","id":"$Z0J2_65KfbJDw8Bq6dcvtFIZpipgsC18cgPSq-2rwc4"},
{"content":{"body":"In that case we don't do anything to remove global symbols from the global symbol registry. We don't even destroy the VM at process exit. https://github.com/search?q=repo%3ALadybirdBrowser%2Fladybird%20GlobalSymbolRegistry&type=code","msgtype":"m.text"},"ts":1745676200091,"senderName":"akaster","senderId":"@akaster:serenityos.org","id":"$TpbiOlF2TMliaqf82jh6WesPK71ImQemgwcUU2eFFH4"},
{"content":{"body":"Yeah, I do mean the latter. It’s technically possible to drop entries from the registry since that is not an observable outcome. But that requires ephemeral book-keeping that I doubt any engine considers worth-while. That informs whether it’s a good idea to use registered symbols to reïfy distributed symbols over a network protocol. There’s a potential registry stuffing hazard and attack. So, I’ve been advising folks against using registered symbols to reflect the analogous interned symbols in scheme over OCapN. Just here to check my premises.","m.mentions":{},"msgtype":"m.text"},"ts":1745679830484,"senderName":"kriskowal","senderId":"@kriskowal:aelf.land","id":"$UIpygFAZu5_JxyCtyvMRKmWEYYpSFzR5PW6of_SmPAs"},
{"content":{"body":"(It’s also my understanding that Guile scheme does collect unreferenced interned symbols, so there’s no corresponding risk in that language.)","m.mentions":{},"msgtype":"m.text"},"ts":1745679921054,"senderName":"kriskowal","senderId":"@kriskowal:aelf.land","id":"$UvsLMIqVLSoqCjuPm_Y7WUy12oPHWNoIZd-KBYGyMtQ"},
{"content":{"body":"Well. Not really familiar with your use case at all. But at least in LibJS, the spec's distinction between \"global\" and \"not global\" symbols is taken to heart. Calling the Symbol constructor creates a local symbol that will be GC'd. Calling Symbol.for (https://tc39.es/ecma262/#sec-symbol.for) will create a global symbol attached to the VM that outlives even the realm that was executing when it was created.","msgtype":"m.text"},"ts":1745680114320,"senderName":"akaster","senderId":"@akaster:serenityos.org","id":"$h5P5sXWD7W7Wv2TtLMv7bFqSO7O9GmV2h0gMMC1iykA"},
{"content":{"body":"I thought SpiderMonkey does too","format":"org.matrix.custom.html","formatted_body":"I thought SpiderMonkey does too","msgtype":"m.text"},"ts":1745697831440,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$ZpL0ncRQBAr2lnnRuCVUPAADh_0aRM14rMQSq11D4ak"},
{"content":{"body":"* I thought SpiderMonkey does collect registered symbols ","format":"org.matrix.custom.html","formatted_body":"* I thought SpiderMonkey does collect registered symbols ","m.new_content":{"body":"I thought SpiderMonkey does collect registered symbols ","format":"org.matrix.custom.html","formatted_body":"I thought SpiderMonkey does collect registered symbols ","msgtype":"m.text"},"m.relates_to":{"event_id":"$ZpL0ncRQBAr2lnnRuCVUPAADh_0aRM14rMQSq11D4ak","rel_type":"m.replace"},"msgtype":"m.text"},"ts":1745697863659,"senderName":"Ashley Claymore","senderId":"@aclaymore:matrix.org","id":"$dzIz4-M9CCR0uHqpHwLya4Hf-3vKoOWpaoBvRzBlkcU"}
]