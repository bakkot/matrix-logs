[
{"content":{"body":"thoughts on a normative PR for https://github.com/tc39/ecma262/pull/2160#issuecomment-683926639 ?","msgtype":"m.text"},"ts":1599157900000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"Opposed","msgtype":"m.text"},"ts":1599158845000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"That has runtime cost and web-compat risk for no user benefit that I can see","msgtype":"m.text"},"ts":1599158872000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"it'd only have runtime cost if a user directly called that method","msgtype":"m.text"},"ts":1599158890000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"assuming a sufficiently clever implementation, sure","msgtype":"m.text"},"ts":1599158909000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"engines almost certainly don't actually invoke that method when it's unmodified and they're normally coercing a symbol to a primitive","msgtype":"m.text"},"ts":1599158910000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"web compat risk, i suppose that's true","msgtype":"m.text"},"ts":1599158920000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"but if we can ignore core-js, i'm pretty confident it's zero risk","msgtype":"m.text"},"ts":1599158933000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"ljharb: i have no interest testing the hypothesis fwiw","msgtype":"m.text"},"ts":1599163148000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"so agree with Bakkot here","msgtype":"m.text"},"ts":1599163154000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"would you agree that for any new toPrimitive method, they should all check the hint and throw, even if this one isn't worth changing?","msgtype":"m.text"},"ts":1599163226000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"not necessarily, the split seems to be whether or not the hint is actually used which seems reasonable to me","msgtype":"m.text"},"ts":1599163404000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"that is, i see no principled reason to be restrictive in an argument that is unused","msgtype":"m.text"},"ts":1599163422000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"we're not striving that these methods be given the same type where the argument must be statically knowable to \"default\"|\"number\"|\"string\"","msgtype":"m.text"},"ts":1599163472000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"hm, ok","msgtype":"m.text"},"ts":1599163490000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"though i'd need to figure out the history of why Symbol's @@toPrimitive takes an argument at all","msgtype":"m.text"},"ts":1599163492000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"i suppose for .length consistency or something","msgtype":"m.text"},"ts":1599163499000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"i can see if it didn't take any arg, then it wouldn't use it","msgtype":"m.text"},"ts":1599163511000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"but if .length consistency matters then so should validation consistency","msgtype":"m.text"},"ts":1599163520000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"yeah, the bigger question to me is why was it specced to take the arg","msgtype":"m.text"},"ts":1599163523000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":".length consistency definitely doesn't imply validation consistency to me","msgtype":"m.text"},"ts":1599163539000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":".length has *so much* less information than validation","msgtype":"m.text"},"ts":1599163545000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"true","msgtype":"m.text"},"ts":1599163609000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"lol what about a normative PR to make its length 0?","msgtype":"m.text"},"ts":1599163620000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"and drop the arg, obv","msgtype":"m.text"},"ts":1599163624000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"that is also a web compat question i have no interest in testing the hypothesis of","msgtype":"m.text"},"ts":1599163641000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"though i suspect it's fine","msgtype":"m.text"},"ts":1599163644000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"i don't see any impetus to change things here","msgtype":"m.text"},"ts":1599163656000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"noted","msgtype":"m.text"},"ts":1599163708000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"i see where you're coming from, since we're in this weird world where there's a weird middle ground","msgtype":"m.text"},"ts":1599163740000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"(fwiw i would bet money that the only web compat risk would be that one of the two symbol polyfills patches the native method unnecessarily, but it'd still work the same)","msgtype":"m.text"},"ts":1599163746000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"we're not as consistent as we would be if this were a typed language","msgtype":"m.text"},"ts":1599163746000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"and we're not maximally flexible either because of .length","msgtype":"m.text"},"ts":1599163753000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"i don't see a good design reason for this weird middle ground, but i don't see it even approaching the bar to do any work on","msgtype":"m.text"},"ts":1599163788000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"fair","msgtype":"m.text"},"ts":1599163848000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"a design question this raises is, how eagerly do we validate arguments?","msgtype":"m.text"},"ts":1599163878000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"do we always eagerly validate them, or only when they're used?","msgtype":"m.text"},"ts":1599163886000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"i'd say generally (and ideally) we always eagerly validate them","msgtype":"m.text"},"ts":1599163914000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"yeah that must be generally true, because if nothing else we should very rarely spec unused parameters","msgtype":"m.text"},"ts":1599164104000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"i also think we rarely do that and ideally should never","msgtype":"m.text"},"ts":1599164124000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"i'd be willing to argue my case in plenary on \"it's worth the time\" grounds, but there's no point arguing it if browsers aren't willing to test the web compat risk for any reason :-) so, thanks, noted","msgtype":"m.text"},"ts":1599164170000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"well, i wouldn't say *any* reason","msgtype":"m.text"},"ts":1599164215000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"but usually, my litmus tests are like","msgtype":"m.text"},"ts":1599164222000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"- does it improve maintainability, security, performance, etc","msgtype":"m.text"},"ts":1599164235000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"i mean, we're all a bit hostage to browsers here","msgtype":"m.text"},"ts":1599164238000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"- are there anecdotes of this actively confusing developers","msgtype":"m.text"},"ts":1599164249000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"we have no way to force a browser to test compat of something short of all the other browsers pushing it","msgtype":"m.text"},"ts":1599164254000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"nah","msgtype":"m.text"},"ts":1599164254000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"someone just noticed the inconsistency","msgtype":"m.text"},"ts":1599164267000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"(there's an editorial PR to fix a note; my alternative was to make a normative change and make the note true)","msgtype":"m.text"},"ts":1599164285000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"right, and those usually aren't enough for me to find compelling to staff an effort","msgtype":"m.text"},"ts":1599164304000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"understood","msgtype":"m.text"},"ts":1599164347000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"though, i'd like some chance to defend my and chrome's viewpoint, i'm fairly open to even very risky compat changes if there's a material improvement","msgtype":"m.text"},"ts":1599164348000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"oh sure, i realize that on the scale of \"matters\" this one's low","msgtype":"m.text"},"ts":1599164482000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"inconsistencies are death by a thousand cuts tho, so i think it's worth exploring removing any we find","msgtype":"m.text"},"ts":1599164515000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"i always bristle at the comparison of browsers holding folks hostage on this point -- we try pretty hard to serve the users here","msgtype":"m.text"},"ts":1599164536000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"i didn't mean to imply hostility","msgtype":"m.text"},"ts":1599165015000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"but given that implementors get to apply subjective \"worth it\" criteria, i'm not sure there's a better phrasing","msgtype":"m.text"},"ts":1599165040000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"iow there's no way for any outsiders to make the validation happen if a browser doesn't think it's worth doing, even in the highly unlikely event that an outsider is capable of doing all the coding work","msgtype":"m.text"},"ts":1599165081000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"i'm saying it's not purely subjective, i do think through the cost benefit","msgtype":"m.text"},"ts":1599165287000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"and i've given you some litmus tests just now. thee test, at the most abstract, is if it improves the product","msgtype":"m.text"},"ts":1599165331000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"whether through making the platform easier to use given demonstrated pain points, or a faster, more secure implementation, what have you","msgtype":"m.text"},"ts":1599165362000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"sure","msgtype":"m.text"},"ts":1599165478000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"the one i apply here tho is \"consistency\" and that alone is often deemed to not pass muster","msgtype":"m.text"},"ts":1599165502000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"right, that alone isn't enough imo","msgtype":"m.text"},"ts":1599165552000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"so even tho you/browsers are being fair and reasonable and communicating clearly what the rubric is, we're still held hostage to that rubric ¯\\_(ツ)_/¯","msgtype":"m.text"},"ts":1599165592000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"i... don't know what to say to that","msgtype":"m.text"},"ts":1599165695000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"i'm not ascribing ill intent","msgtype":"m.text"},"ts":1599165711000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"\"held hostage\" is pretty negative language?","msgtype":"m.text"},"ts":1599165720000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"yeah true, i don't know of how to say it without a negative connotation :-/","msgtype":"m.text"},"ts":1599165739000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"i mean, one side of the relationship has power the other doesn't","msgtype":"m.text"},"ts":1599165777000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"but even tho i don't want to say something negative, i don't think it's reasonable to pretend the imbalance doesn't exist","msgtype":"m.text"},"ts":1599165813000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"anyways i'm sorry that there's a negative connotation to that wording and that it makes you bristle :-( it's a reasonable position that this change isn't worth the effort obv","msgtype":"m.text"},"ts":1599165923000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"i am certainly not disputing that browsers can make decisions about their products and may disreegard external requests","msgtype":"m.text"},"ts":1599166025000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"the thing i am confused by is the implication that they... ought not to do that?","msgtype":"m.text"},"ts":1599166141000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"like, that's a description of the reality of products","msgtype":"m.text"},"ts":1599166153000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"ah ok, i'm not implying they shouldn't","msgtype":"m.text"},"ts":1599166210000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"but i am saying it's unfortunate that that's the reality","msgtype":"m.text"},"ts":1599166216000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"i see, what would you like the ideal to be?","msgtype":"m.text"},"ts":1599166315000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"i guess it'd be great if there was a way for anyone to do web compat tests without adding to the burden on implementors. that way i'd just do the tests i wanted, and i'd only bring these kinds of things to the committee that i knew were likely to be compatible.","msgtype":"m.text"},"ts":1599166485000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"altho it's not my personal beef, it'd also be great if feature/impl roadmaps were publicly influenceable, but i haven't thought enough about how that's practical","msgtype":"m.text"},"ts":1599166520000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"to the first point, i'd like that too tbh","msgtype":"m.text"},"ts":1599166560000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"but pretty hard without actually affecting millions+ of users","msgtype":"m.text"},"ts":1599166579000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"to the second point, i only have philosophical musings","msgtype":"m.text"},"ts":1599166625000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"on a macro (i.e. company) level, that's what shareholders are supposed to be, and it's fascinating how now, that power actually doesn't really exist that much anymore of activist hedge funds because of 1) the huge rise of index funds, where everybody owns everything and 2) the rise in tech specifically of shares that have no voting power","msgtype":"m.text"},"ts":1599166742000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"on a micro level, i can only eenvision chaos","msgtype":"m.text"},"ts":1599166755000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"in breaking changes *i'd* personally love to make but seems like we can't: https://chromestatus.com/metrics/feature/timeline/popularity/3304","msgtype":"m.text"},"ts":1599167378000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"what's that one?","msgtype":"m.text"},"ts":1599167781000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"`catch (e) { var e; }` is allowed","msgtype":"m.text"},"ts":1599167901000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"and everyone has special handling of it in their parser and it's just gross","msgtype":"m.text"},"ts":1599167913000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"but looks like a lot of pages use it :(","msgtype":"m.text"},"ts":1599167918000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"by \"use it\" you mean rely on it being a noop?","msgtype":"m.text"},"ts":1599167995000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"yeah, rely on its not being an early error","msgtype":"m.text"},"ts":1599168085000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"well, \"rely\" is a strong word, but pages where we hit that path in the parser","msgtype":"m.text"},"ts":1599168129000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"and did not throw an early error today, so assuming those pages don't have other broken JS, changing this behavior would break them","msgtype":"m.text"},"ts":1599168145000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"right","msgtype":"m.text"},"ts":1599168326000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"is that allowed only in sloppy mode?","msgtype":"m.text"},"ts":1599168343000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"yeah","msgtype":"m.text"},"ts":1599168365000,"senderName":"shu","senderId":"shu@irc"},
{"content":{"body":"ah k","msgtype":"m.text"},"ts":1599168373000,"senderName":"ljharb","senderId":"ljharb@irc"}
]