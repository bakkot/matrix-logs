[
{"content":{"body":"heycam: !","msgtype":"m.text"},"ts":1371774314000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"TabAtkins, hi :)","msgtype":"m.text"},"ts":1371774320000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"[MapClass]?","msgtype":"m.text"},"ts":1371774325000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"yes yes, I know :)","msgtype":"m.text"},"ts":1371774331000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"^_^","msgtype":"m.text"},"ts":1371774334000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"still has a few days left in the week to make good","msgtype":"m.emote"},"ts":1371774355000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"I saw the thread on www-style","msgtype":"m.text"},"ts":1371774367000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"(so I guess the implementation work is why you'd like it looked at soon)","msgtype":"m.text"},"ts":1371774383000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"Yup!","msgtype":"m.text"},"ts":1371774714000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"Was talking with the implementor a few minutes ago.","msgtype":"m.text"},"ts":1371774723000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"cool","msgtype":"m.text"},"ts":1371774772000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"Hixie: Yo, are the W3C versions of PostMessage/SSE/WebWorkers/etc all still accurate?  Are they genned off of the current WHATWG spec, or what?","msgtype":"m.text"},"ts":1371775945000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"TabAtkins: sequence<Node> won't have .find and .findAll on it, so I think arv is wrong","msgtype":"m.text"},"ts":1371783515000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"TabAtkins: i think the ones in dev.w3.org are, but i wouldn't bet on it","msgtype":"m.text"},"ts":1371785053000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"TabAtkins: certainly the canonical material as far as i'm concerned is the material in whatwg.org/c","msgtype":"m.text"},"ts":1371785072000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"damn who fuglied up the desktop notifications in the Chromium trunk, and why","msgtype":"m.text"},"ts":1371797356000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"https://www.w3.org/Bugs/Public/show_bug.cgi?id=22422 is pretty ugly :/","msgtype":"m.text"},"ts":1371799798000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Maybe Hixie already handles that for images in HTML... But that wouldn't cover CSS so I guess not","msgtype":"m.text"},"ts":1371799821000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Doesn't seem to be handled. I wonder if the HTTP gods are aware of this.","msgtype":"m.text"},"ts":1371800688000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"hallvors: so, 304 is a very distinct case from redirects","msgtype":"m.text"},"ts":1371803676000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"hallvors: I'm sure the HTTP gods had some interesting reason to mix it in with them, but when it comes down to it, the logic for it is different and it needs to be handled separately","msgtype":"m.text"},"ts":1371803710000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"you're right","msgtype":"m.text"},"ts":1371803727000,"senderName":"hallvors","senderId":"hallvors@irc"},
{"content":{"body":"is curious about Anne's religion","msgtype":"m.emote"},"ts":1371803773000,"senderName":"hallvors","senderId":"hallvors@irc"},
{"content":{"body":"I should rather investigate how much of that header stuff is implemented","msgtype":"m.text"},"ts":1371803808000,"senderName":"hallvors","senderId":"hallvors@irc"},
{"content":{"body":"#stilsleepy","msgtype":"m.emote"},"ts":1371803866000,"senderName":"hallvors","senderId":"hallvors@irc"},
{"content":{"body":"hallvors: I don't believe in the HTTP gods, but they do exist","msgtype":"m.text"},"ts":1371804052000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"X-Anne-Faith: HTTP-Conditional","msgtype":"m.text"},"ts":1371804129000,"senderName":"hallvors","senderId":"hallvors@irc"},
{"content":{"body":"Well, at least Chrome supports the 304 stuff in the spec as written","msgtype":"m.text"},"ts":1371804147000,"senderName":"hallvors","senderId":"hallvors@irc"},
{"content":{"body":"according to your test","msgtype":"m.text"},"ts":1371804157000,"senderName":"hallvors","senderId":"hallvors@irc"},
{"content":{"body":"I'm a bit surprised Opera didn't support it according to that test - because we did some work on behaving like a \"caching proxy\" for XHR a while back","msgtype":"m.text"},"ts":1371804196000,"senderName":"hallvors","senderId":"hallvors@irc"},
{"content":{"body":"That bug was still open when I still had an account :)","msgtype":"m.text"},"ts":1371804223000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"(but there may also still be some magic somewhere that makes requests with query less caching)","msgtype":"m.text"},"ts":1371804228000,"senderName":"hallvors","senderId":"hallvors@irc"},
{"content":{"body":"hm.. I thought some work was done on it, maybe not enough to actually ship a fix though","msgtype":"m.text"},"ts":1371804258000,"senderName":"hallvors","senderId":"hallvors@irc"},
{"content":{"body":"It's a bit unclear to me what the spec says is actionable enough. I feel like maybe we should turn that into some kind of flag too...","msgtype":"m.text"},"ts":1371804260000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"I should look up the bug","msgtype":"m.text"},"ts":1371804274000,"senderName":"hallvors","senderId":"hallvors@irc"},
{"content":{"body":"E.g. if you set header 1 or 2, set the \"pass 304 through flag\". If that flag is set, don't change 304 into 200.","msgtype":"m.text"},"ts":1371804291000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Or more likely, if it's unset, change 304 into 200 :)","msgtype":"m.text"},"ts":1371804420000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"http://m.itworld.com/361807/foxconn-hire-3000-support-firefox-os-and-software-development","msgtype":"m.text"},"ts":1371804565000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"wow, they went from .5-1 Mozilla to 3 Mozillas pretty quickly","msgtype":"m.text"},"ts":1371804601000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"hallvors: CORE-37327","msgtype":"m.text"},"ts":1371804654000,"senderName":"karlcow","senderId":"karlcow@irc"},
{"content":{"body":"maybe","msgtype":"m.text"},"ts":1371804659000,"senderName":"karlcow","senderId":"karlcow@irc"},
{"content":{"body":"\"It's looking for software engineers with skills in HTML5 operating systems\"","msgtype":"m.text"},"ts":1371804700000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"All 20 of them?","msgtype":"m.text"},"ts":1371804708000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"what if i have skills in 15 - 18 HTML5 OSes, do i get the job?","msgtype":"m.text"},"ts":1371804946000,"senderName":"miketaylr","senderId":"miketaylr@irc"},
{"content":{"body":"I think Ms2ger meant there's only 20 people with the relevant skills","msgtype":"m.text"},"ts":1371805218000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Like that now decade old IBM job listing. Might as well list them by name","msgtype":"m.text"},"ts":1371805249000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"thought of the same thing","msgtype":"m.emote"},"ts":1371805346000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"boo, thanks for ruining my joke annevk","msgtype":"m.text"},"ts":1371805393000,"senderName":"miketaylr","senderId":"miketaylr@irc"},
{"content":{"body":":)","msgtype":"m.text"},"ts":1371805421000,"senderName":"karlcow","senderId":"karlcow@irc"},
{"content":{"body":"karlcow: thanks - that's the fixed one, CORE-1033 is the still open one","msgtype":"m.text"},"ts":1371805584000,"senderName":"hallvors","senderId":"hallvors@irc"},
{"content":{"body":"damned, I was not subscribed to this one. Not in my mail archive. :)","msgtype":"m.text"},"ts":1371805636000,"senderName":"karlcow","senderId":"karlcow@irc"},
{"content":{"body":"hixie: appears the mutlipage and the one page of the whatwg spec are out of phase the multi-page is a day behind","msgtype":"m.text"},"ts":1371808304000,"senderName":"SteveF","senderId":"SteveF@irc"},
{"content":{"body":"Hixie: appears the mutlipage and the one page of the whatwg spec are out of phase the multi-page is a day behind (once again with right nick)","msgtype":"m.text"},"ts":1371808486000,"senderName":"SteveF","senderId":"SteveF@irc"},
{"content":{"body":"hixie==hixie","msgtype":"m.text"},"ts":1371825284000,"senderName":"zewt","senderId":"zewt@irc"},
{"content":{"body":"good morning, Whatwg!","msgtype":"m.text"},"ts":1371828917000,"senderName":"dglazkov","senderId":"dglazkov@irc"},
{"content":{"body":"annevk: What. The. Fuck.  Jeezus, the webidl situation up in here is *fucked up* if all I want is freaking array of nodes with useful functions.","msgtype":"m.text"},"ts":1371830416000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"annevk: On the other hand, going with NodeList means you don't get .filter or .map.","msgtype":"m.text"},"ts":1371830504000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"This shouldn't be a choice we have to make.","msgtype":"m.text"},"ts":1371830510000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"FYI: am migrating remaining html5lib-python issues from Google Code.","msgtype":"m.text"},"ts":1371832912000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"I read \"to\"","msgtype":"m.text"},"ts":1371832934000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"Zero issues remaining on GCode.","msgtype":"m.text"},"ts":1371836171000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"I tried to write a proposal that would let you connect to a remote window in a similar way to how you can connect to a shared worker: http://wiki.whatwg.org/wiki/RemoteDocumentMessaging","msgtype":"m.text"},"ts":1371840641000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"how badly did I screw it up?  :)","msgtype":"m.text"},"ts":1371840649000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"i guess folks aren't around.  I'll ask on the mailing list","msgtype":"m.text"},"ts":1371840981000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"remote in what sense?","msgtype":"m.text"},"ts":1371841453000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"not in the same unit of related browsing contexts","msgtype":"m.text"},"ts":1371841479000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"e.g., you don't already have a JavaScript reference to the window object","msgtype":"m.text"},"ts":1371841498000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"why not just use a shared worker? that's what they're for :-)","msgtype":"m.text"},"ts":1371841503000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"they consume resources","msgtype":"m.text"},"ts":1371841513000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"e.g., memory","msgtype":"m.text"},"ts":1371841519000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"hmm","msgtype":"m.text"},"ts":1371841550000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"as far as I can tell, all the mechanisms exist in the platform","msgtype":"m.text"},"ts":1371841607000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"so much as to be prohibitive? what are y'all putting in these workers? :-P","msgtype":"m.text"},"ts":1371841609000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"consider the use case in the wiki page","msgtype":"m.text"},"ts":1371841628000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"i'm not sure window.name would be the best way to identify a target, but other than that this could work","msgtype":"m.text"},"ts":1371841636000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"should the word processing site always spin up a shared worker just in case?","msgtype":"m.text"},"ts":1371841645000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"if they're cheap, yeah","msgtype":"m.text"},"ts":1371841658000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"if they're not, i'd have gone more for a \"broadcast message to same origin pages\" approach, where you tell everyone \"hey anyone out there?\" and see if anyone responds","msgtype":"m.text"},"ts":1371841683000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"why not broadcast to some name within an origin?","msgtype":"m.text"},"ts":1371841723000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"if you've got a large origin with lots of different stuff","msgtype":"m.text"},"ts":1371841731000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"sits down rather than typing over the desk","msgtype":"m.emote"},"ts":1371841760000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"you don't want them have to bring all the pages out of swap","msgtype":"m.text"},"ts":1371841761000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"just to send them a message they don't care about","msgtype":"m.text"},"ts":1371841769000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"yeah, that's fair enough","msgtype":"m.text"},"ts":1371841773000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"window.name isn't unique","msgtype":"m.text"},"ts":1371841785000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"in particular, what you really want in the case you mentioned on the wiki page is to broadcast to other instances of yourself","msgtype":"m.text"},"ts":1371841805000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"yeah","msgtype":"m.text"},"ts":1371841814000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"so window.name would be awkward","msgtype":"m.text"},"ts":1371841817000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"but you could register to receive messages on a particular topic, for instance","msgtype":"m.text"},"ts":1371841830000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"we should use a different name","msgtype":"m.text"},"ts":1371841830000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"window.subscribeTo(\"the-topic\")","msgtype":"m.text"},"ts":1371841846000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"another solution might be to make shared workers much cheaper by having a way to delay the actual shared worker creation until such time as multiple connections are attempted","msgtype":"m.text"},"ts":1371841869000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"window.broadcastMessage(\"hi there\", \"the-topic\") ?","msgtype":"m.text"},"ts":1371841870000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"but i'm not sure the shared worker being expensive is that big a deal. wouldn't an editor want a worker to be doing all the work in the background anyway?","msgtype":"m.text"},"ts":1371841901000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"in which case, making it shared is a non-issue","msgtype":"m.text"},"ts":1371841907000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"brb, oqne sec","msgtype":"m.text"},"ts":1371841918000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"I agree with you that if shared workers were free, web sites could build this mechanism themselves","msgtype":"m.text"},"ts":1371842209000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"but they're not free :)","msgtype":"m.text"},"ts":1371842213000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"back","msgtype":"m.text"},"ts":1371842287000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"yeah, but in the case of an editor, isn't it a sunk cost anyway?","msgtype":"m.text"},"ts":1371842295000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"I'm not sure I follow?","msgtype":"m.text"},"ts":1371842309000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"wouldn't an editor want to put its networking and stuff in a worker?","msgtype":"m.text"},"ts":1371842325000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"this feature request is coming from the tech lead of an editor, and he says wouldn't need a shared worker anymore if we had this feature","msgtype":"m.text"},"ts":1371842387000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"currently, his shared worker is eating 70 MB of memory on my machine :)","msgtype":"m.text"},"ts":1371842401000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"why wouldn't they use a worker, that's weird","msgtype":"m.text"},"ts":1371842404000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"wait, wtf is he doing in his worker","msgtype":"m.text"},"ts":1371842411000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"just to send messages takes 70 MB?!","msgtype":"m.text"},"ts":1371842418000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"how about we fix that, rather than adding more features","msgtype":"m.text"},"ts":1371842426000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"that's absurd","msgtype":"m.text"},"ts":1371842428000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"the problem is that shared workers are long-lived","msgtype":"m.text"},"ts":1371842442000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"so they accumulate resources","msgtype":"m.text"},"ts":1371842449000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"that's... not how that works","msgtype":"m.text"},"ts":1371842464000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"what are they accumulating?","msgtype":"m.text"},"ts":1371842479000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"e.g., the object graph grows if you're not careful to drop all references, and the heap fragments","msgtype":"m.text"},"ts":1371842480000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"dunno","msgtype":"m.text"},"ts":1371842487000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"all he's doing is sending messages back and forth, how hard can it possibly be","msgtype":"m.text"},"ts":1371842495000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"by the way, I currently have zero documents open :)","msgtype":"m.text"},"ts":1371842525000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"one of the nice properties of the web is that resources are scoped to tabs","msgtype":"m.text"},"ts":1371842579000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"so you naturally clear them out as you browse around","msgtype":"m.text"},"ts":1371842590000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"shared workers are persistent, so they tend to accumulate cruft","msgtype":"m.text"},"ts":1371842602000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"maybe i'm not understanding how this is going to work. when you open three of these tabs on the same document, is one of the tabs going to get promoted to master tab or something?","msgtype":"m.text"},"ts":1371842624000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"which means they require much higher skill levels use correctly","msgtype":"m.text"},"ts":1371842625000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"and the others act as slaves?","msgtype":"m.text"},"ts":1371842628000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"it just seems silly to me not to use a shared worker in this case. it's made for this precise thing.","msgtype":"m.text"},"ts":1371842645000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"if it doesn't work for this, then we've failed and should just scrap shared workers.","msgtype":"m.text"},"ts":1371842663000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"Sounds like it's time to land the Gecko implementation, then","msgtype":"m.text"},"ts":1371842691000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"if there's only one document open, and the shared worker is only used for managing multiple documents, then we can make the shared worker take zero resources until another tab attempts to connect to it","msgtype":"m.text"},"ts":1371842717000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"by having an API that says \"but don't actually create it until there's another client\"","msgtype":"m.text"},"ts":1371842733000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"which is to say, i understand that if there's just one client, having a shared worker is more expensive than necessary. but with multiple clients, especially N > 2, it seems just silly to avoid them.","msgtype":"m.text"},"ts":1371842777000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"I guess I don't understand why you need something as complicated as a shared worker just to do cross-document messaging","msgtype":"m.text"},"ts":1371842786000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"i don't understand why you think shared workers are complicated","msgtype":"m.text"},"ts":1371842802000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"I just want to send a message from one document to another.  it seems unnecessary to make me write a third entity just to route the messages","msgtype":"m.text"},"ts":1371842849000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"should we make all cross-document messages flow through a shared worker?","msgtype":"m.text"},"ts":1371842889000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"why are cross-document messages in a single unit of related browsing contexts special and get to avoid the shared worker?","msgtype":"m.text"},"ts":1371842910000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"you agree it would be crazy to require a document to spin up a shared worker just to postMessage to one of its iframes, right?","msgtype":"m.text"},"ts":1371842936000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"or two iframes on the same page","msgtype":"m.text"},"ts":1371842957000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"so, why require a shared worker if the two iframes are in different windows?","msgtype":"m.text"},"ts":1371842974000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"if it's 1:1, sure. but this use case isn't 1:1. it's n:n, with shared networking and shared document state, and with conflict resolution.","msgtype":"m.text"},"ts":1371842981000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"that's not just 1:1 communication.","msgtype":"m.text"},"ts":1371842987000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"I don't understand how the \"two iframes in the same window\" case is different from the \"two frames in different windows\" case","msgtype":"m.text"},"ts":1371843032000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"my point is just that a shared worker is massive overkill for this use case","msgtype":"m.text"},"ts":1371843095000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"i'm not saying it is, i'm saying this use case isn't that","msgtype":"m.text"},"ts":1371843105000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"let me connect this back to my original use case","msgtype":"m.text"},"ts":1371843191000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"there are two ways of opening word processing documents","msgtype":"m.text"},"ts":1371843219000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"you can go to the list of all your documents and open them","msgtype":"m.text"},"ts":1371843228000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"or you can make a new tab, and open it by pasting in the URL","msgtype":"m.text"},"ts":1371843237000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"double click on it in Finder? :)","msgtype":"m.emote"},"ts":1371843237000,"senderName":"hober","senderId":"hober@irc"},
{"content":{"body":"yes :)","msgtype":"m.text"},"ts":1371843246000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"in the first case, all the documents are in the same unit of related browsing contexts","msgtype":"m.text"},"ts":1371843258000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"and can communicate easily","msgtype":"m.text"},"ts":1371843269000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"in the second case, they can't because they don't have a script connection","msgtype":"m.text"},"ts":1371843284000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"so, just because they were opened by pasting in the URL, now they need to spin up a shared worker","msgtype":"m.text"},"ts":1371843300000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"you're assuming that the user didn't open the list again to open the second doc","msgtype":"m.text"},"ts":1371843304000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"(which i almost always do)","msgtype":"m.text"},"ts":1371843314000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"there are many ways they can end up without a script connection","msgtype":"m.text"},"ts":1371843331000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"but there are also cases where they share a script connection, depending on how you ended up opening the documents","msgtype":"m.text"},"ts":1371843361000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"in the common case, there is no script connection. yes.","msgtype":"m.text"},"ts":1371843364000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"what does it matter if there's a script connection or not?","msgtype":"m.text"},"ts":1371843381000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"why is a shared worker required in the second case but not in the first case?","msgtype":"m.text"},"ts":1371843386000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"i'd use one if the first case too","msgtype":"m.text"},"ts":1371843399000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"the shared worker makes this problem like a zillion times easier","msgtype":"m.text"},"ts":1371843413000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"in what way?","msgtype":"m.text"},"ts":1371843425000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"the shared worker seems like massively more complexity than I need here","msgtype":"m.text"},"ts":1371843437000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"you don't have to implement a \"slave\" mode for the tab and \"master\" mode for the tab.","msgtype":"m.text"},"ts":1371843454000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"why do should I need to author a separate script just to route messages?","msgtype":"m.text"},"ts":1371843456000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"you don't have to worry, e.g., about your \"master\" tab getting killed half-way through synchronising a complicated merge.","msgtype":"m.text"},"ts":1371843463000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"why do I have to elect a master?","msgtype":"m.text"},"ts":1371843476000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"i'm confused","msgtype":"m.text"},"ts":1371843480000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"you want to try to do n-way edit merges using some sort of cooperative algorithm??","msgtype":"m.text"},"ts":1371843508000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"who should be in charge of sending the edits to the server, if not a master tab?","msgtype":"m.text"},"ts":1371843531000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"this is just begging for a master-slave organisation.","msgtype":"m.text"},"ts":1371843543000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"which is exactly what shared workers are for.","msgtype":"m.text"},"ts":1371843553000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"you're saying that one needs to be in charge of persisting the document to stable storage","msgtype":"m.text"},"ts":1371843618000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"normally, the server is in charge of that","msgtype":"m.text"},"ts":1371843642000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"if you're online, this is just a latency optimization to avoid round-tripping with the server","msgtype":"m.text"},"ts":1371843656000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"one of them needs to be in charge of telling the server what the edits are","msgtype":"m.text"},"ts":1371843660000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"well, the edits originate in one window","msgtype":"m.text"},"ts":1371843690000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"the same problem occurs if the two documents are open on two different computers","msgtype":"m.text"},"ts":1371843702000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"or the same computer in different browsers, sure. but in that case, they're not coordinating.","msgtype":"m.text"},"ts":1371843723000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"just in that case, you'll tolerate more latency to round-trip with the server","msgtype":"m.text"},"ts":1371843724000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"you could imagine being able to message between browsers, but that's a bit of an obscure case","msgtype":"m.text"},"ts":1371843758000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"thanks for the feedback.  /me needs to get some lunch","msgtype":"m.text"},"ts":1371843853000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"I'll give it some more thought","msgtype":"m.text"},"ts":1371843863000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"https://code.google.com/p/chromium/issues/detail?id=161070   <--- If you're interested in this topic, you can CC yourself on this bug, which is the original feature request from the document editing folks","msgtype":"m.text"},"ts":1371843955000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"separate from whether this use case should be solved that way, i don't a priori see anything wrong with a broadcast mechanism, fwiw.","msgtype":"m.text"},"ts":1371844037000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"especially if we don't provide a zero-cost way to defer-start a shared worker.","msgtype":"m.text"},"ts":1371844051000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"then i could see it as a way to coordinate when to start one, for instance.","msgtype":"m.text"},"ts":1371844062000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"this is related to the distributed locking proposal that fishd sent to the whatwg list a while ago","msgtype":"m.text"},"ts":1371844101000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"that's a sort of \"one bit\" coordination approach","msgtype":"m.text"},"ts":1371844113000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"(not sure about using window.name, though. although maybe tha's better than having yet another registration mechanism.)","msgtype":"m.text"},"ts":1371844128000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"window.open(\"...\", \"the-channel\")","msgtype":"m.text"},"ts":1371844191000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"has similar properties","msgtype":"m.text"},"ts":1371844203000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"in that you either create a new window or get back a way to communicate with an existing window of that name","msgtype":"m.text"},"ts":1371844224000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"but the security is screwed up because the names aren't scoped to an origin","msgtype":"m.text"},"ts":1371844247000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"it's the current \"discovery\" mechanism","msgtype":"m.text"},"ts":1371844275000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"but yeah, I'm not sure window.name is the right thing either","msgtype":"m.text"},"ts":1371844298000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"i'll be back in a bit after I get some lunch","msgtype":"m.text"},"ts":1371844312000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"later.","msgtype":"m.text"},"ts":1371844414000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"I reworked the proposal to be a broadcast channel: http://wiki.whatwg.org/wiki/RemoteDocumentMessaging","msgtype":"m.text"},"ts":1371847688000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"there's still the question of whether a shared worker is a better fit for the use case, but I agree with you that the broadcast formulation is much cleaner","msgtype":"m.text"},"ts":1371847721000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"abarth: Looks nice and simple!  At least, it seems to basically  just be a super-simple pre-provided Shared Worker that just forwards messages to all connected pages.","msgtype":"m.text"},"ts":1371848686000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"In fact, maybe we can just do it like that?  Define a browser-provided (about:?) link that starts up a forwarding Worker.","msgtype":"m.text"},"ts":1371848730000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"you'd still want to have channel names","msgtype":"m.text"},"ts":1371848752000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"Yeah, deifnitely.","msgtype":"m.text"},"ts":1371848760000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"Bake that into the urls as an extension point.","msgtype":"m.text"},"ts":1371848766000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"var port = new SharedWorker(\"about:bouncer/foo\").port;","msgtype":"m.text"},"ts":1371848780000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"You need domain magic to make this work, I guess.","msgtype":"m.text"},"ts":1371848813000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"the other nice thing about a channel name is that you can use a nonce","msgtype":"m.text"},"ts":1371848848000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"and have something like a private channel","msgtype":"m.text"},"ts":1371848854000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"I'm agreeing with you. ^_^","msgtype":"m.text"},"ts":1371848864000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"sorry, I was just thinking outloud","msgtype":"m.text"},"ts":1371848879000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"I don't understand how this stuff interacts with transferable objects","msgtype":"m.text"},"ts":1371848906000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"like, does this support zero-copy sending of ArrayBuffers?","msgtype":"m.text"},"ts":1371848926000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"Hm, neuterable objects wouldn't work, since it's multi-cast.","msgtype":"m.text"},"ts":1371848935000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"Only things that could by copied.","msgtype":"m.text"},"ts":1371848939000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"so, can I send a MessagePort through the BroadcastChannel?","msgtype":"m.text"},"ts":1371848958000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"i guess only one listener would be able to receive it","msgtype":"m.text"},"ts":1371848967000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"Those are copyable, no?","msgtype":"m.text"},"ts":1371848975000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"Maybe not.","msgtype":"m.text"},"ts":1371848982000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"doesn't know.","msgtype":"m.emote"},"ts":1371848985000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"abarth: You could have two types of bouncers - one that's multicast and accepts as many channels as you want, and one that's singlecast and only accepts two connections at a time.","msgtype":"m.text"},"ts":1371851898000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"abarth: Dunno how to indicate that the connection limit has been hit - immediately send a message back saying that it's full?","msgtype":"m.text"},"ts":1371851924000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"that's sort of like the async lock proposal","msgtype":"m.text"},"ts":1371851951000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"except the limit is 1","msgtype":"m.text"},"ts":1371851956000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"so, you're suggesting something more like a semaphore","msgtype":"m.text"},"ts":1371851969000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"Yeah, but when you're trying to do a zero-copy transfer, that's exactly what you need.","msgtype":"m.text"},"ts":1371851976000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"Two pages in an origin can use a multicast bouncer to coordinate with each other and agree on a singlecast channel name to use for transfer communication.","msgtype":"m.text"},"ts":1371852063000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"about:bouncer and about:transferer?","msgtype":"m.text"},"ts":1371852073000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"Reusing SharedWorker literally might not be the best idea - it may still be better to provide dedicated constructors - but I think explaining them in terms of browser-provided shared workers is pretty interesting.","msgtype":"m.text"},"ts":1371852223000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"If we did use dedicated constructors, I like your BroadcastChannel name, and we can augment it with a TransferChannel name for the singlecast variant.","msgtype":"m.text"},"ts":1371852263000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"i'd have to think about how the transfer channel would handle error cases","msgtype":"m.text"},"ts":1371853203000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"you might want something that just hands off a message port to the parties","msgtype":"m.text"},"ts":1371853225000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"e.g., MessageChannel","msgtype":"m.text"},"ts":1371853242000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"you could imagine giving one of the message ports to the broadcast channel","msgtype":"m.text"},"ts":1371853279000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"and the first one to grab it wins","msgtype":"m.text"},"ts":1371853286000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"Hmm, yeah, that's just as correct I guess.","msgtype":"m.text"},"ts":1371853497000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"You'd need some way to explicitly open the port, or something like that.","msgtype":"m.text"},"ts":1371853523000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"First to attach an onMessage handler?","msgtype":"m.text"},"ts":1371853531000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"there's a start() function","msgtype":"m.text"},"ts":1371853559000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"so, you could claim it by doing that","msgtype":"m.text"},"ts":1371853576000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"Ah, indeed there is.","msgtype":"m.text"},"ts":1371853578000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"I'd missed that.","msgtype":"m.text"},"ts":1371853583000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"So that's just a matter of adding a constructor to MessagePort, which is nice and elegant.","msgtype":"m.text"},"ts":1371853642000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"Well, kinda.","msgtype":"m.text"},"ts":1371853663000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"You need to get a pair of them.","msgtype":"m.text"},"ts":1371853680000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"that's what MessageChannel does for you","msgtype":"m.text"},"ts":1371853690000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"So yeah, MessageChannel.","msgtype":"m.text"},"ts":1371853696000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"it has port1 and port2","msgtype":"m.text"},"ts":1371853697000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"Oh, durp, I should really read this whole Workers chapter again.","msgtype":"m.text"},"ts":1371853710000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"the missing piece is a way to hand one of the ports to the remote document","msgtype":"m.text"},"ts":1371853719000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"without a script connection","msgtype":"m.text"},"ts":1371853723000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"my first draft went after that problem directly","msgtype":"m.text"},"ts":1371853733000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"but letting you trigger a \"connect\" event on the remote document","msgtype":"m.text"},"ts":1371853743000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"with the message port","msgtype":"m.text"},"ts":1371853750000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"Yeah, and the BroadcastChannel works well.  I like it's elegance - the way it can be described as a browser-defined \"bouncer\" SharedWorker.","msgtype":"m.text"},"ts":1371853758000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"but that felt a bit like electing a leader","msgtype":"m.text"},"ts":1371853767000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"Yeah.","msgtype":"m.text"},"ts":1371853777000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"since there's a distinguished instance that gets the connect event","msgtype":"m.text"},"ts":1371853781000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"and if you're going to elect a leader, you probably should be using a shared worker","msgtype":"m.text"},"ts":1371853794000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"so the leader can outlive all the followers","msgtype":"m.text"},"ts":1371853800000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"BroadcastChannel is more symmetric","msgtype":"m.text"},"ts":1371853816000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"Yup.","msgtype":"m.text"},"ts":1371853842000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"abarth: Problem with just transferring the port is that it gets neutered as it is transferred.  You can't have the broadcast channel send it to multiple other senders.","msgtype":"m.text"},"ts":1371854406000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"Maybe BroadcastChannel could allow transferrable if there's only one listener?","msgtype":"m.text"},"ts":1371854458000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"so, you could agree with someone what channel name to use","msgtype":"m.text"},"ts":1371854471000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"and then hop onto that channel","msgtype":"m.text"},"ts":1371854495000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"e.g., one channel is used for signaling and the other is used for data","msgtype":"m.text"},"ts":1371854523000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"That does mean that it's possible to be DOSed by something else on your origin, but that's probably a sufficiently okay problem - you can already have lots of bad things happen from your own origin.","msgtype":"m.text"},"ts":1371854528000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"if they want to DOS you, they can just make a sync XHR :)","msgtype":"m.text"},"ts":1371854551000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"they don't even have to be in your origin","msgtype":"m.text"},"ts":1371854555000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"I meant that something else on your origin, which knows your signaling channel, can listen in and connect to any ports you attempt to use for data.","msgtype":"m.text"},"ts":1371854581000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"But they're already within your origin, so you're screwed.","msgtype":"m.text"},"ts":1371854594000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"And I don't see how that's possible to solve without a direct connection anyway.  You *must* use a spoofable token to identify the channel, precisely so that the other side can spoof it.","msgtype":"m.text"},"ts":1371854673000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"TabAtkins: you could make up a nonce on the server","msgtype":"m.text"},"ts":1371855521000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"and send it to the two pages","msgtype":"m.text"},"ts":1371855529000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"and they could use it as the channel name","msgtype":"m.text"},"ts":1371855536000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"Sure, there are ways to avoid it if you bring in a trusted third party.","msgtype":"m.text"},"ts":1371855562000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"Anyway, I dont' think it's a real concern.","msgtype":"m.text"},"ts":1371855569000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"If an attacker is inside your origin, you're already screwed.","msgtype":"m.text"},"ts":1371855578000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"I wonder if NamedChannel would be a better name","msgtype":"m.text"},"ts":1371855585000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"Hm, maybe.","msgtype":"m.text"},"ts":1371855596000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"you might even subclass MessageChannel","msgtype":"m.text"},"ts":1371855598000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"and the ports could null themselves out as they were grabbed","msgtype":"m.text"},"ts":1371855607000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"i guess that doesn't work as well for the broadcast case","msgtype":"m.text"},"ts":1371855696000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"and there's a race condition","msgtype":"m.text"},"ts":1371855700000,"senderName":"abarth","senderId":"abarth@irc"},
{"content":{"body":"Yeah.","msgtype":"m.text"},"ts":1371855713000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"You'd have to agree on which port each should take.","msgtype":"m.text"},"ts":1371855741000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"}
]