[
{"content":{"body":"Hixie: Re: an alt+etc. respecting version of textContent; yes please for use cases such as making a table of contents (or trying to extract any user-displayed string from a non-CDATA element, really)","msgtype":"m.text"},"ts":1217157300000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"hsivonen: http://validator.nu/?doc=http://forums.whatwg.org/&showsource=yes has some extracts missing and others ending at the wrong place","msgtype":"m.text"},"ts":1217164260000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"hsivonen: (or starting at the wrong place)","msgtype":"m.text"},"ts":1217164320000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"hsivonen: starting with error 95","msgtype":"m.text"},"ts":1217164380000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"zcorpan: thanks. I'll investigate.","msgtype":"m.text"},"ts":1217169720000,"senderName":"hsivonen","senderId":"hsivonen@irc"},
{"content":{"body":"hsivonen: xml:lang attributes didn't use to be fatal in v.nu, did they?","msgtype":"m.text"},"ts":1217173860000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"The Settlers' II is awesome.","msgtype":"m.text"},"ts":1217173980000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"yeah i remember that game","msgtype":"m.text"},"ts":1217174220000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"looks up Widelands","msgtype":"m.emote"},"ts":1217174340000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"I've just gone back to playing it for more or less the first time since the '90s.","msgtype":"m.text"},"ts":1217174400000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Really primitive graphics, but its hard to find much flaw with the gameplay itself","msgtype":"m.text"},"ts":1217174460000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"anyone played The Settlers II 10th Anniversary Edition?","msgtype":"m.text"},"ts":1217174461000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"downloads the demo","msgtype":"m.emote"},"ts":1217174580000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"ack, I'll go back to not writing docs, and playing Settlers II","msgtype":"m.text"},"ts":1217176560000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"finally drags himself away from it","msgtype":"m.emote"},"ts":1217184240000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Is the behaviour described at <http://hg.gsnedders.com/spec-gen/raw-file/tip/README.html#table-of-contents/section-numbering> for when there is no heading sane enough?","msgtype":"m.text"},"ts":1217188680000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Hixie: ^^","msgtype":"m.text"},"ts":1217188740000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"looks fine to me","msgtype":"m.text"},"ts":1217188980000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"Wow.","msgtype":"m.text"},"ts":1217190240000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"608 sections in HTML 5","msgtype":"m.text"},"ts":1217190300000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"(approx)","msgtype":"m.text"},"ts":1217190420000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Yeah, 609.","msgtype":"m.text"},"ts":1217190480000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"finds he can save a couple of thousands of a second by using a deque","msgtype":"m.emote"},"ts":1217190540000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"thinks that's ever so slightly pointless","msgtype":"m.emote"},"ts":1217190541000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"does a different optimization, and cuts buildToc on HTML 5 down from 16.702s to 0.635s","msgtype":"m.emote"},"ts":1217190660000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"That's probably more noticeable","msgtype":"m.text"},"ts":1217190661000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Running an XPath statement once is not noticeable. Running it 608 times is.","msgtype":"m.text"},"ts":1217190780000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"SAX for perf!","msgtype":"m.text"},"ts":1217190900000,"senderName":"hsivonen","senderId":"hsivonen@irc"},
{"content":{"body":"hsivonen: I'm not even doing that. I'm just manually iterating over the element and doing what the XPath did manually :P","msgtype":"m.text"},"ts":1217190960000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Besides, the thing that I really need to make a large difference to perf is a quicker parser/serializer :P","msgtype":"m.text"},"ts":1217191080000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"gsnedders: if your tree API works with Jython...","msgtype":"m.text"},"ts":1217191440000,"senderName":"hsivonen","senderId":"hsivonen@irc"},
{"content":{"body":"gsnedders: (adding tree API glue layers to the validator.nu parser is easy)","msgtype":"m.text"},"ts":1217191500000,"senderName":"hsivonen","senderId":"hsivonen@irc"},
{"content":{"body":"hsivonen: For most purposes libxml2's HTML parser works fine, and I'd rather work on finishing the spec-gen than getting more parsers working","msgtype":"m.text"},"ts":1217191560000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Hmm. I can't see any easy way to remove //text()[contains(normalize-space(translate(., 'AEILNORSTV', 'aeilnorstv')), 'latest version') or contains(., 'http://www.w3.org/TR/')]","msgtype":"m.text"},"ts":1217191620000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"I can't check .text and .tail at the same time, as I need the text nodes in document order","msgtype":"m.text"},"ts":1217191680000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"I can't use etree.iterwalk() because I need the tail of comments, PIs, and the like","msgtype":"m.text"},"ts":1217191740000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"could do with annevk being on IRC","msgtype":"m.emote"},"ts":1217193180000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"gsnedders: What's wrong with using d.iter() (assuming d is an etree tree)","msgtype":"m.text"},"ts":1217193240000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"jgraham: I need text nodes in document order. I can't get that from d.iteR()","msgtype":"m.text"},"ts":1217193241000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"(as opposed to iterwalk, not as opposed to annevk who is on holiday for a while)","msgtype":"m.text"},"ts":1217193242000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"gsnedders: Oh well you'd have to iterate by hand I guess, or you could use the html5lib lxml treewalker which does what you want","msgtype":"m.text"},"ts":1217193420000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"jgraham: Or just use XPath, which is what I do now","msgtype":"m.text"},"ts":1217193421000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"jgraham: I probably won't get quicker than that :(","msgtype":"m.text"},"ts":1217193422000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"gsnedders: I thouht you were trying to replace the XPath","msgtype":"m.text"},"ts":1217193423000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"jgraham: For the sake of being quicker. Iterating by hand will be slow.","msgtype":"m.text"},"ts":1217193480000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"gsnedders: use regexp on the source","msgtype":"m.text"},"ts":1217193481000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"zcorpan: It has to only be text nodes for compat. with existing docs","msgtype":"m.text"},"ts":1217193540000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"gsnedders: I thought you had claimed that iterating by hand was surprisingly fast ","msgtype":"m.text"},"ts":1217193541000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"but maybe I was mistaken","msgtype":"m.text"},"ts":1217193600000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"gsnedders: which docs?","msgtype":"m.text"},"ts":1217193601000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"jgraham: I claimed that the built-in iterators could be surprisingly quick compared with things like .find","msgtype":"m.text"},"ts":1217193602000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Oh OK. I guess using a built in iterator + a stack wouldn't help?","msgtype":"m.text"},"ts":1217193660000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"Not really","msgtype":"m.text"},"ts":1217193720000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"goes against his original plan and implements something for anne in spec-gen 1.0","msgtype":"m.emote"},"ts":1217194500000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"http://stuff.gsnedders.com/spec-gen/html5.html#the-a-element â€” note where the xref for \"a\" now points","msgtype":"m.text"},"ts":1217195340000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"(i.e., not #a)","msgtype":"m.text"},"ts":1217196180000,"senderName":"gsnedders","senderId":"gsnedders@irc"}
]