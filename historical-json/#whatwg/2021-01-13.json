[
{"content":{"body":"TIL: Chrome/Safari block style sheets without an ok status...","msgtype":"m.text"},"ts":1610532138000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: non-2xx status you mean?","msgtype":"m.text"},"ts":1610535333000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"they won’t follow 3xx’s?","msgtype":"m.text"},"ts":1610535351000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"MikeSmith: at the point where the relevant algorithm gets a response, redirects have been handled","msgtype":"m.text"},"ts":1610535389000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"When rendering an <object> element I would need to set the Authorization header to be used for fetching its data. Is this possible to do \"directly\"?","msgtype":"m.text"},"ts":1610545860000,"senderName":"croraf","senderId":"croraf@irc"},
{"content":{"body":"I'm not sure I understand the question, but I'm pretty sure the answer is no","msgtype":"m.text"},"ts":1610545941000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"What is not clear in the question? annevk","msgtype":"m.text"},"ts":1610546047000,"senderName":"croraf","senderId":"croraf@irc"},
{"content":{"body":"I have <object data='https://my.url.com/path' />","msgtype":"m.text"},"ts":1610546090000,"senderName":"croraf","senderId":"croraf@irc"},
{"content":{"body":"This will make a request for the object (a pdf) to this url. But the url won't allow unauthorized requests.","msgtype":"m.text"},"ts":1610546117000,"senderName":"croraf","senderId":"croraf@irc"},
{"content":{"body":"So in the request additional headers should be specified.","msgtype":"m.text"},"ts":1610546135000,"senderName":"croraf","senderId":"croraf@irc"},
{"content":{"body":"The <image src='...' >  is a similar example that I saw people are struggling with.","msgtype":"m.text"},"ts":1610546181000,"senderName":"croraf","senderId":"croraf@irc"},
{"content":{"body":"Is this possible? If it is not possible why not add this capability to the standard?","msgtype":"m.text"},"ts":1610546209000,"senderName":"croraf","senderId":"croraf@irc"},
{"content":{"body":"I think everyone removed that (you could use the username/password fields of a URL) because it would allow for dictionary attacks","msgtype":"m.text"},"ts":1610546308000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: so what does “without an ok status” mean? what other status is there that would not also cause all browsers to not load the stylesheet either?","msgtype":"m.text"},"ts":1610546463000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"MikeSmith: Firefox applies a style sheet whose status is 600","msgtype":"m.text"},"ts":1610546559000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"MikeSmith: can I rename the default branch on whatwg/misc-server?","msgtype":"m.text"},"ts":1610546574000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk, what do you mean by \"everyone removed that\", you mean every browser? does this mean some browsers supported something like that?","msgtype":"m.text"},"ts":1610547005000,"senderName":"croraf","senderId":"croraf@irc"},
{"content":{"body":"yes","msgtype":"m.text"},"ts":1610547222000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Why not add to the standard to add some header fields to the img or object elements?","msgtype":"m.text"},"ts":1610549432000,"senderName":"croraf","senderId":"croraf@irc"},
{"content":{"body":"would really come handy in situations like this, and a lot of people are wondering this over the internet","msgtype":"m.text"},"ts":1610549452000,"senderName":"croraf","senderId":"croraf@irc"},
{"content":{"body":"As annevk said, letting some script on some random website manipulate the Authentication header would be a big security risk","msgtype":"m.text"},"ts":1610549709000,"senderName":"andreubotella","senderId":"andreubotella@irc"},
{"content":{"body":"annevk: IIRC Opera blocked everything !ok as part of the cross-origin stylesheet snooping fixes, IIRC","msgtype":"m.text"},"ts":1610549712000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"gsnedders: well, they didn't standardize it","msgtype":"m.text"},"ts":1610549751000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: hence WebKit/Blink (quite possibly pre-fork) blocking them doesn't seem super surprising?","msgtype":"m.text"},"ts":1610549754000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"annevk: none of that cross-origin protection stuff was standardised for a long time after, AFAIK :|","msgtype":"m.text"},"ts":1610549793000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"and wasn't there some quirks mode scoping of some of it, at least the text/css check, originally?","msgtype":"m.text"},"ts":1610549880000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"The main things about being strict on text/css has been standardized for a long time","msgtype":"m.text"},"ts":1610549885000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"(this is CVE-2010-0654 I'm referring to)","msgtype":"m.text"},"ts":1610549909000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"So if !ok was part of that I would have expected that to have come up, but it hasn't and Firefox doesn't implement it","msgtype":"m.text"},"ts":1610549921000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"andreubotella, annevk how would it be a security risk, and what does it have to do with dictionary attacks?","msgtype":"m.text"},"ts":1610550288000,"senderName":"croraf","senderId":"croraf@irc"},
{"content":{"body":"What does allowing Authentication header have anything to do with a dictionary attack?","msgtype":"m.text"},"ts":1610550316000,"senderName":"croraf","senderId":"croraf@irc"},
{"content":{"body":"croraf: https://gist.github.com/andreubotella/04e617f15af88125597d842c40e2edba","msgtype":"m.text"},"ts":1610550440000,"senderName":"andreubotella","senderId":"andreubotella@irc"},
{"content":{"body":"I'm not actually sure that img.decode works that way – this is an example, not a proof of concept","msgtype":"m.text"},"ts":1610550492000,"senderName":"andreubotella","senderId":"andreubotella@irc"},
{"content":{"body":"And what possible workaround offers protection by such attacks?","msgtype":"m.text"},"ts":1610550812000,"senderName":"croraf","senderId":"croraf@irc"},
{"content":{"body":"I always confuse atob and btoa","msgtype":"m.text"},"ts":1610550828000,"senderName":"andreubotella","senderId":"andreubotella@irc"},
{"content":{"body":"This is silly I think. Why is having Authorization header in the image making site less secure than not having.","msgtype":"m.text"},"ts":1610550860000,"senderName":"croraf","senderId":"croraf@irc"},
{"content":{"body":"croraf: the point is not having the header, it's letting scripts from other sites modify it","msgtype":"m.text"},"ts":1610550889000,"senderName":"andreubotella","senderId":"andreubotella@irc"},
{"content":{"body":"An attacker can try dictionary attacks on everything, it can try to access the same resource using fetch and with dictionary attack.","msgtype":"m.text"},"ts":1610550889000,"senderName":"croraf","senderId":"croraf@irc"},
{"content":{"body":"huh, right","msgtype":"m.text"},"ts":1610550907000,"senderName":"andreubotella","senderId":"andreubotella@irc"},
{"content":{"body":"with fetch probably not because of cors","msgtype":"m.text"},"ts":1610550928000,"senderName":"andreubotella","senderId":"andreubotella@irc"},
{"content":{"body":"but an attacker could use any non-browser http client","msgtype":"m.text"},"ts":1610550953000,"senderName":"andreubotella","senderId":"andreubotella@irc"},
{"content":{"body":"This is the usual problem","msgtype":"m.text"},"ts":1610550960000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"You cannot use fetch to access internal (e.g. intranet) resources, because of CORS","msgtype":"m.text"},"ts":1610550975000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"You can use <img> to do so","msgtype":"m.text"},"ts":1610550978000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"I see.","msgtype":"m.text"},"ts":1610550983000,"senderName":"croraf","senderId":"croraf@irc"},
{"content":{"body":"So <img> with arbitrary headers can be used for attacks on intranets","msgtype":"m.text"},"ts":1610550985000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Why is cors not applied to images?","msgtype":"m.text"},"ts":1610551023000,"senderName":"croraf","senderId":"croraf@irc"},
{"content":{"body":"Because it wasn't in Netscape 1.0 :(","msgtype":"m.text"},"ts":1610551032000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"\"don't break the web\" is an important principle, and that means if something used to work, it must keep working unless the risks would be huge","msgtype":"m.text"},"ts":1610551069000,"senderName":"andreubotella","senderId":"andreubotella@irc"},
{"content":{"body":"Arguably the risks are pretty bad these days, but we've gone with less strict mitigations than full CORS. E.g. CORB is such a mitigation.","msgtype":"m.text"},"ts":1610551099000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"annevk: oh, https://trac.webkit.org/changeset/72743/webkit might be the change that made this happen in WebKit, which makes it look accidental?","msgtype":"m.text"},"ts":1610551112000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"gsnedders: isn't that for images? Pretty sure that it's important to ignore status there","msgtype":"m.text"},"ts":1610551211000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: it changes WebCore/loader/cache/CachedResource.h and WebCore/loader/loader.cpp to make < 400 a failure by default, except where things opt-in to it being okay (like images)","msgtype":"m.text"},"ts":1610551298000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Domenic: with \"these days\" you mean because of Spectre, right?","msgtype":"m.text"},"ts":1610551337000,"senderName":"andreubotella","senderId":"andreubotella@irc"},
{"content":{"body":"annevk: basically anywhere that didn't explicitly check \"has an error occured\" started being strict about this","msgtype":"m.text"},"ts":1610551338000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"gsnedders: I guess that means I should check media as well, at least for ORB purposes","msgtype":"m.text"},"ts":1610551394000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"andreubotella: indeed","msgtype":"m.text"},"ts":1610551396000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"gsnedders: there's a bunch of other things like text tracks that might then also need to be checked, but I care less about those","msgtype":"m.text"},"ts":1610551414000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"I still need slight clarification. So scripts on website A loaded from any origin can access the <image>. Or the issue is that scripts from any origin can create the <image> element with some URL and access that data?","msgtype":"m.text"},"ts":1610551504000,"senderName":"croraf","senderId":"croraf@irc"},
{"content":{"body":"croraf: some of the CORS-related restrictions that were put on the <img> element means you can't access the contents of the image from a website in a different origin, because those capabilities were only added after CORS, but you can see if the image loads or not","msgtype":"m.text"},"ts":1610551608000,"senderName":"andreubotella","senderId":"andreubotella@irc"},
{"content":{"body":"so if you can change the Authorization header, just create an <img> element in any origin that points to a resource in the intranet, and see if it loads","msgtype":"m.text"},"ts":1610551643000,"senderName":"andreubotella","senderId":"andreubotella@irc"},
{"content":{"body":"Domenic: are there server aspects that depend on the default branch name? Or would that all be documented in misc-server in which case I should find it shortly?","msgtype":"m.text"},"ts":1610551696000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: my guess is if you do a full-text search on misc-server for \"master\" you'll find all such dependencies.","msgtype":"m.text"},"ts":1610551737000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"great","msgtype":"m.text"},"ts":1610551744000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"(assuming you are only talking about renaming misc-server)","msgtype":"m.text"},"ts":1610551747000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Domenic: I'm talking about renaming all repos, but I'm also grepping all repos","msgtype":"m.text"},"ts":1610551772000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Domenic: so the main question is if we have stuff that's outside repos I suppose","msgtype":"m.text"},"ts":1610551786000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"andreubotella, how can you see that it loads?","msgtype":"m.text"},"ts":1610551787000,"senderName":"croraf","senderId":"croraf@irc"},
{"content":{"body":"annevk: OK, I can't think of anything outside repos then. We'll see...","msgtype":"m.text"},"ts":1610551823000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"croraf: my example was using the img.decode() method, that I believe returns a promise that rejects if the image doesn't load. but you can also listen for an \"error\" event","msgtype":"m.text"},"ts":1610551836000,"senderName":"andreubotella","senderId":"andreubotella@irc"},
{"content":{"body":"If anything breaks down it should be easy to fix, not planning on switching today though","msgtype":"m.text"},"ts":1610551844000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Maybe Tuesday would be a good day after we get the RDs out","msgtype":"m.text"},"ts":1610551872000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"andreubotella, I see","msgtype":"m.text"},"ts":1610551957000,"senderName":"croraf","senderId":"croraf@irc"},
{"content":{"body":"I'm also confused now with this <object> element, it loads a document in my example, but I cannot apply Network latency in Chome devtools to it.","msgtype":"m.text"},"ts":1610552016000,"senderName":"croraf","senderId":"croraf@irc"},
{"content":{"body":"<object type='application/pdf' data={url} />","msgtype":"m.text"},"ts":1610552120000,"senderName":"croraf","senderId":"croraf@irc"},
{"content":{"body":"I'm so confused with this <object_","msgtype":"m.text"},"ts":1610552190000,"senderName":"croraf","senderId":"croraf@irc"},
{"content":{"body":"croraf: <object> and <embed> used to be elements that allowed you to integrate plugins like flash into a page","msgtype":"m.text"},"ts":1610552289000,"senderName":"andreubotella","senderId":"andreubotella@irc"},
{"content":{"body":"So I should use Iframe for pdf's?","msgtype":"m.text"},"ts":1610552306000,"senderName":"croraf","senderId":"croraf@irc"},
{"content":{"body":"yeah","msgtype":"m.text"},"ts":1610552331000,"senderName":"andreubotella","senderId":"andreubotella@irc"},
{"content":{"body":":thumbs-up:","msgtype":"m.text"},"ts":1610552342000,"senderName":"croraf","senderId":"croraf@irc"},
{"content":{"body":"I mean I know there are subtle differences between the three.","msgtype":"m.text"},"ts":1610552358000,"senderName":"croraf","senderId":"croraf@irc"},
{"content":{"body":"see https://github.com/whatwg/html/issues/6003, which will make object and embed more similar to iframe now that flash is deprecated","msgtype":"m.text"},"ts":1610552366000,"senderName":"andreubotella","senderId":"andreubotella@irc"},
{"content":{"body":"I'm wondering if the latency will be applied on the iframe","msgtype":"m.text"},"ts":1610552422000,"senderName":"croraf","senderId":"croraf@irc"},
{"content":{"body":"it is not :(","msgtype":"m.text"},"ts":1610552441000,"senderName":"croraf","senderId":"croraf@irc"},
{"content":{"body":"that sounds like a chrome devtools issue, rather than something the spec would require","msgtype":"m.text"},"ts":1610552474000,"senderName":"andreubotella","senderId":"andreubotella@irc"},
{"content":{"body":"yes","msgtype":"m.text"},"ts":1610552481000,"senderName":"croraf","senderId":"croraf@irc"},
{"content":{"body":"Can I apply custom headers to Iframe, I guess not :( ?","msgtype":"m.text"},"ts":1610552497000,"senderName":"croraf","senderId":"croraf@irc"},
{"content":{"body":"https://bugs.chromium.org/p/chromium/issues/detail?id=1113722&q=devtools%20latency%20iframe&can=2 I guess that's the bug","msgtype":"m.text"},"ts":1610552580000,"senderName":"croraf","senderId":"croraf@irc"},
{"content":{"body":"Damn, thats from 2012, and still open","msgtype":"m.text"},"ts":1610552788000,"senderName":"croraf","senderId":"croraf@irc"},
{"content":{"body":"But even on FF it is not throttled","msgtype":"m.text"},"ts":1610552886000,"senderName":"croraf","senderId":"croraf@irc"},
{"content":{"body":"annevk: I think I'll file a PR for https://github.com/whatwg/html/issues/6247 and see what the folks from the different browsers think","msgtype":"m.text"},"ts":1610553598000,"senderName":"andreubotella","senderId":"andreubotella@irc"},
{"content":{"body":"andreubotella: sounds reasonable, unfortunate that people are not more proactive, but that's pretty common I'm afraid","msgtype":"m.text"},"ts":1610553656000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"hits that all the time","msgtype":"m.emote"},"ts":1610553661000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Domenic: if you're okay with it I think I'm also happy to switch tomorrow","msgtype":"m.text"},"ts":1610555027000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Domenic: it doesn't seem like we have many dependencies on the default branch name so all the PRs have been rather straightforward","msgtype":"m.text"},"ts":1610555057000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Domenic: misc-server doesn't need updating at all; participate.whatwg.org does though","msgtype":"m.text"},"ts":1610555091000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"And whatwg.org of course","msgtype":"m.text"},"ts":1610555103000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: sounds good to me","msgtype":"m.text"},"ts":1610555574000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Domenic: cool, I think I'll do it around this time and then watch the fireworks for a one or two hours, assuming you don't find anything problematic","msgtype":"m.text"},"ts":1610555640000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Is there any way to put <iframe> into loading state?","msgtype":"m.text"},"ts":1610556658000,"senderName":"croraf","senderId":"croraf@irc"}
]