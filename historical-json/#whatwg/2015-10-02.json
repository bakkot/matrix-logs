[
{"content":{"body":"annevk: http://stackoverflow.com/questions/32897921/why-does-this-cors-request-to-a-google-drive-sheet-fail-in-firefox-works-in-c","msgtype":"m.text"},"ts":1443748193000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"what the holy shit","msgtype":"m.text"},"ts":1443752554000,"senderName":"zewt","senderId":"zewt@irc"},
{"content":{"body":"adblock hijacked new window on chrome to show an ad for itself","msgtype":"m.text"},"ts":1443752568000,"senderName":"zewt","senderId":"zewt@irc"},
{"content":{"body":"google should kill the extension outright for that level of abuse","msgtype":"m.text"},"ts":1443752588000,"senderName":"zewt","senderId":"zewt@irc"},
{"content":{"body":"time to try ublock","msgtype":"m.text"},"ts":1443752685000,"senderName":"zewt","senderId":"zewt@irc"},
{"content":{"body":"jgraham: i nominate cvrebert for push access to web-platform-tests","msgtype":"m.text"},"ts":1443768886000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"zcorpan: seconded","msgtype":"m.text"},"ts":1443769172000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"MikeSmith: seems like a security bug in Chrome","msgtype":"m.text"},"ts":1443770561000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"MikeSmith: they're not requiring CORS headers on redirects","msgtype":"m.text"},"ts":1443770571000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: oh","msgtype":"m.text"},"ts":1443770678000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"I would have thought that would be covered by the testsuite though","msgtype":"m.text"},"ts":1443770744000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"But perhaps Chrome is not really trying to conform to it","msgtype":"m.text"},"ts":1443770752000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Ms2ger: > zcorpan: jgraham: i nominate cvrebert for push access to web-platform-tests","msgtype":"m.text"},"ts":1443771124000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"Ms2ger: > MikeSmith: zcorpan: seconded","msgtype":"m.text"},"ts":1443771136000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"thirded","msgtype":"m.text"},"ts":1443771139000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"k","msgtype":"m.text"},"ts":1443771146000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"Ms2ger: so we can either wait to get confirmation from jgraham or one of us can just flip on his push perms now","msgtype":"m.text"},"ts":1443771207000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"Go for it","msgtype":"m.text"},"ts":1443771247000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"done","msgtype":"m.text"},"ts":1443771420000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"annevk: Good morning! Would you prefer that I specify `frame-ancestors` as a network error in Fetch, or as a something something for Documents in HTML?","msgtype":"m.text"},"ts":1443774601000,"senderName":"mkwst","senderId":"mkwst@irc"},
{"content":{"body":"MikeSmith: I think that CORS issue is an artifact of Chrome's HSTS handling.","msgtype":"m.text"},"ts":1443774620000,"senderName":"mkwst","senderId":"mkwst@irc"},
{"content":{"body":"MikeSmith: docs.google.com is preloaded in Chrome, so the redirect never really happens.","msgtype":"m.text"},"ts":1443774675000,"senderName":"mkwst","senderId":"mkwst@irc"},
{"content":{"body":"mkwst: I'm not sure","msgtype":"m.text"},"ts":1443774753000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: Me neither. :)","msgtype":"m.text"},"ts":1443774878000,"senderName":"mkwst","senderId":"mkwst@irc"},
{"content":{"body":"Fetch is appealing, because it seems straightforward and avoids the work necessary to figure out _where_ in HTML to do the check.","msgtype":"m.text"},"ts":1443774917000,"senderName":"mkwst","senderId":"mkwst@irc"},
{"content":{"body":"mkwst: sounds reasonable","msgtype":"m.text"},"ts":1443774965000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"mkwst: if it's trivial to do in Fetch, just do it there I guess","msgtype":"m.text"},"ts":1443774981000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: I'll type it up and then we can go back and decide it was a bad idea later.","msgtype":"m.text"},"ts":1443774983000,"senderName":"mkwst","senderId":"mkwst@irc"},
{"content":{"body":"mkwst: can always refactor","msgtype":"m.text"},"ts":1443774988000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"mkwst: either way it needs to behave as a network error","msgtype":"m.text"},"ts":1443774997000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Actually, we have a CSP hook at the bottom of main fetch anyway. I'll just do it there. Ha.","msgtype":"m.text"},"ts":1443775089000,"senderName":"mkwst","senderId":"mkwst@irc"},
{"content":{"body":"But it might be reasonable to have a check for `x-frame-options` as well?","msgtype":"m.text"},"ts":1443775176000,"senderName":"mkwst","senderId":"mkwst@irc"},
{"content":{"body":"Hrm.","msgtype":"m.text"},"ts":1443775177000,"senderName":"mkwst","senderId":"mkwst@irc"},
{"content":{"body":"mkwst: can't CSP also handle x-frame-options?","msgtype":"m.text"},"ts":1443776263000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"mkwst: seems like the easiest for CSP to just define both headers","msgtype":"m.text"},"ts":1443776273000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"mkwst: and handle them in the same algorithm","msgtype":"m.text"},"ts":1443776286000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"mkwst: presumably that's what implementations do too","msgtype":"m.text"},"ts":1443776296000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"If only they acted the same.","msgtype":"m.text"},"ts":1443776339000,"senderName":"mkwst","senderId":"mkwst@irc"},
{"content":{"body":"x-frame-options is a bit broken, as it only checks the top-level origin.","msgtype":"m.text"},"ts":1443776355000,"senderName":"mkwst","senderId":"mkwst@irc"},
{"content":{"body":"But sure. *shrug* Isn't there an RFC?","msgtype":"m.text"},"ts":1443776366000,"senderName":"mkwst","senderId":"mkwst@irc"},
{"content":{"body":"there is http://tools.ietf.org/html/rfc7034 it seems but that's kind of useless without integration","msgtype":"m.text"},"ts":1443776404000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"also very verbose...","msgtype":"m.text"},"ts":1443776424000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Well, let me finish the things I know I need to do before I grab more work. :)","msgtype":"m.text"},"ts":1443776454000,"senderName":"mkwst","senderId":"mkwst@irc"},
{"content":{"body":"if you don't specify it please file an issue on Fetch","msgtype":"m.text"},"ts":1443776545000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"seems like a shame to not define how that header actually interacts with Fetch","msgtype":"m.text"},"ts":1443776558000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk_: yes. it ought to be defined. if i have time, i'll do it.","msgtype":"m.text"},"ts":1443778461000,"senderName":"mkwst","senderId":"mkwst@irc"},
{"content":{"body":"\\o/","msgtype":"m.text"},"ts":1443778484000,"senderName":"annevk_","senderId":"annevk_@irc"},
{"content":{"body":"annevk_: can you take a look at https://github.com/whatwg/fetch/pull/128?","msgtype":"m.text"},"ts":1443779909000,"senderName":"yhirano_","senderId":"yhirano_@irc"},
{"content":{"body":"yhirano_: will do today, sorry","msgtype":"m.text"},"ts":1443781080000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: thank you","msgtype":"m.text"},"ts":1443781482000,"senderName":"yhirano_","senderId":"yhirano_@irc"},
{"content":{"body":"I think I understand mounir's feelings about reviewing a little better now","msgtype":"m.text"},"ts":1443783271000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"It's no fun","msgtype":"m.text"},"ts":1443783284000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: tell me more about that :)","msgtype":"m.text"},"ts":1443783871000,"senderName":"mounir","senderId":"mounir@irc"},
{"content":{"body":"will do","msgtype":"m.text"},"ts":1443783871000,"senderName":"botie","senderId":"botie@irc"},
{"content":{"body":"slaps botie","msgtype":"m.emote"},"ts":1443784000000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"mounir: reviewing PRs to standards is not the most fun thing to do","msgtype":"m.text"},"ts":1443787766000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"mounir: but it's necessary to grow the set of folks who can write them","msgtype":"m.text"},"ts":1443787804000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Domenic: basically, the problem is that if you assign a blob URL to a number of elements, you want to know which one ends up using it","msgtype":"m.text"},"ts":1443788139000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Domenic: if I assign a blob URL to two <a> elements, and it sorta depends which one ends up getting the reference to the blob as to where the user clicks, that'd be suboptimal","msgtype":"m.text"},"ts":1443788175000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"(or of which you ended up checking another member)","msgtype":"m.text"},"ts":1443788192000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: how is clicking involved? I don't see any steps in the spec that invoke cloning when you click a hyperlink","msgtype":"m.text"},"ts":1443788198000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Domenic: presumably that would lazily figure out the url, no?","msgtype":"m.text"},"ts":1443788219000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Domenic: I mean if we don't figure out the url immediately, we'd have to figure it out later","msgtype":"m.text"},"ts":1443788237000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: right now I believe it just lazily consults the internal URL. It doesn't call re-initialise or anything.","msgtype":"m.text"},"ts":1443788244000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Domenic: during hover perhaps?","msgtype":"m.text"},"ts":1443788246000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"bbiab","msgtype":"m.text"},"ts":1443788320000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Mean I really don't want to write all the domintro garbage","msgtype":"m.text"},"ts":1443788461000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"I should probably just get over it, but given the long list of important bugs to fix I'm finding it hard to justify","msgtype":"m.text"},"ts":1443788496000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Authors will appreciate it!","msgtype":"m.text"},"ts":1443789413000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Domenic: well, as long as we're not generating that developer edition","msgtype":"m.text"},"ts":1443790184000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":":(","msgtype":"m.text"},"ts":1443790330000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Also, not all specifications do this so I have some worries about the longevity of all this","msgtype":"m.text"},"ts":1443790336000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"_That_ would be a good intern project...","msgtype":"m.text"},"ts":1443790338000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"http://caitp.github.io/spidermonkey-wks-security/  wip thing to try to figure out cross-browser cross-origin access to well-known symbol-named properties, just for fun.","msgtype":"m.text"},"ts":1443790348000,"senderName":"caitp","senderId":"caitp@irc"},
{"content":{"body":"I really want to work on this meta-language thing for standards","msgtype":"m.text"},"ts":1443790363000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Having that defined could simplify the decision making process when defining something new so much","msgtype":"m.text"},"ts":1443790387000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"But it should really be in IDL and IDL is well...","msgtype":"m.text"},"ts":1443790398000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"caitp: SyntaxError in Chrome, blank page in Firefox?","msgtype":"m.text"},"ts":1443790422000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"nightly is a syntax error for all 3 supported symbols","msgtype":"m.text"},"ts":1443790445000,"senderName":"caitp","senderId":"caitp@irc"},
{"content":{"body":"FF nightly*","msgtype":"m.text"},"ts":1443790448000,"senderName":"caitp","senderId":"caitp@irc"},
{"content":{"body":"chrome with --harmony is all security errors, but the behaviour Toon wants is very different","msgtype":"m.text"},"ts":1443790471000,"senderName":"caitp","senderId":"caitp@irc"},
{"content":{"body":"Oh HTTPS everywhere is screwing me","msgtype":"m.text"},"ts":1443790473000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"er, nightly is not a syntax error, it's a security error*","msgtype":"m.text"},"ts":1443790490000,"senderName":"caitp","senderId":"caitp@irc"},
{"content":{"body":"which more or less matches current Chrome","msgtype":"m.text"},"ts":1443790507000,"senderName":"caitp","senderId":"caitp@irc"},
{"content":{"body":"annevk: meta-language thing?","msgtype":"m.text"},"ts":1443790625000,"senderName":"mkwst","senderId":"mkwst@irc"},
{"content":{"body":"caitp: you are aware of https://etherpad-mozilla.org/html5-cross-origin-objects and such, right?","msgtype":"m.text"},"ts":1443790641000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"mkwst: yeah, a more formal definition of what we're doing, including a bunch of convenient shorthands","msgtype":"m.text"},"ts":1443790697000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: for example?","msgtype":"m.text"},"ts":1443790712000,"senderName":"mkwst","senderId":"mkwst@irc"},
{"content":{"body":"mkwst: e.g., ECMAScript is much better at having precise language","msgtype":"m.text"},"ts":1443790718000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"i've read the etherpad previously, yeah","msgtype":"m.text"},"ts":1443790718000,"senderName":"caitp","senderId":"caitp@irc"},
{"content":{"body":"mkwst: but ECMAScript is quite verbose","msgtype":"m.text"},"ts":1443790726000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"mkwst: Domenic and others came up with a bunch of constructs that make that better","msgtype":"m.text"},"ts":1443790738000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"bterlson wants to get rid of ReturnIfAbrupt in ES, which would make it even better.","msgtype":"m.text"},"ts":1443790756000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"mkwst: however, since we're not defining JavaScript, but IDL, we cannot really reuse that","msgtype":"m.text"},"ts":1443790759000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"from bugmail it just sounds like SM is getting further along with matching the etherpad semantics","msgtype":"m.text"},"ts":1443790774000,"senderName":"caitp","senderId":"caitp@irc"},
{"content":{"body":"mkwst: so what I'd like is for IDL to define that kind of language, that specifications can then use, so they all read the same more or less and it becomes easier to spot bugs","msgtype":"m.text"},"ts":1443790798000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"mkwst: and also hopefully becomes easier to write them","msgtype":"m.text"},"ts":1443790804000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: makes sense. I'm sure there are constructs that get cargo-culted everywhere. Formalizing them might be helpful.","msgtype":"m.text"},"ts":1443790830000,"senderName":"mkwst","senderId":"mkwst@irc"},
{"content":{"body":"MikeSmith: reporting the error for the correct line just saved me going through a 100 lines of HTML","msgtype":"m.text"},"ts":1443790916000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Domenic: added domintro to a/area","msgtype":"m.text"},"ts":1443790956000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"very basic","msgtype":"m.text"},"ts":1443790964000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: will re-review in a few hours","msgtype":"m.text"},"ts":1443790992000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"TabAtkins: can you have a look at https://github.com/tabatkins/bikeshed/pull/498 ?","msgtype":"m.text"},"ts":1443791068000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"annevk: glad the line-number reporting is working","msgtype":"m.text"},"ts":1443791276000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"I need to finish up the remaining changes to the build script","msgtype":"m.text"},"ts":1443791293000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"https://developer.apple.com/library/safari/releasenotes/General/WhatsNewInSafari/Articles/Safari_9.html <link rel=\"icon\" sizes=\"any\" mask href=\"website_icon.svg\"> :-(","msgtype":"m.text"},"ts":1443792722000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"Hmm I thought they fixed that","msgtype":"m.text"},"ts":1443794149000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"zcorpan: annevk: probably just out-of-date documentation, twitter and pinterest uses rel=\"mask-icon\"","msgtype":"m.text"},"ts":1443794358000,"senderName":"hasather","senderId":"hasather@irc"},
{"content":{"body":"hasather: was thinking that too","msgtype":"m.text"},"ts":1443794391000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"hasather: hober also put himself on the hook for writing a PR for mask-icon so I'm guessing all is fine","msgtype":"m.text"},"ts":1443794422000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"there's a feeback link at the bottom, I'll use that","msgtype":"m.text"},"ts":1443794469000,"senderName":"hasather","senderId":"hasather@irc"},
{"content":{"body":"Yeah hober where's our PR :)","msgtype":"m.text"},"ts":1443795789000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"is scared of the <meta> area of the spec","msgtype":"m.emote"},"ts":1443795817000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"annevk: ping","msgtype":"m.text"},"ts":1443795921000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"or anyone else who can help with relative URLs in stylesheet subresources","msgtype":"m.text"},"ts":1443795950000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"if window a.com loads stylesheet a.com/foo.css which is redirected to b.com/foo.css, and there is a bg-image with URL \"./bg.jpg\"... is that bg-image URL relative to a.com or b.com?","msgtype":"m.text"},"ts":1443796026000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"See #content :)","msgtype":"m.text"},"ts":1443796258000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"wanderview: I would expect b.com","msgtype":"m.text"},"ts":1443796395000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"wanderview: however, even with workers browsers differ on this apparently","msgtype":"m.text"},"ts":1443796421000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: apparently gecko is loading a.com/bg.jpg according to this test I wrote","msgtype":"m.text"},"ts":1443796430000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"wanderview: wow, that's very magical","msgtype":"m.text"},"ts":1443796452000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"wanderview: is that without service workers?","msgtype":"m.text"},"ts":1443796457000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"where is the css spec?","msgtype":"m.text"},"ts":1443796459000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"Which one?","msgtype":"m.text"},"ts":1443796469000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"annevk: I have a service worker, but its not calling .respondWith()","msgtype":"m.text"},"ts":1443796474000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"the latest/best one for defining how bg-image is handled","msgtype":"m.text"},"ts":1443796489000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"well, I guess it is calling .respondWith(), but it doesn't matter... since gecko decided this before triggering the FetchEvent","msgtype":"m.text"},"ts":1443796526000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"CSS doesn't exactly define much here","msgtype":"m.text"},"ts":1443796528000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"Complain at TabAtkins :)","msgtype":"m.text"},"ts":1443796532000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"wanderview: the stylesheet is not served through a service worker?","msgtype":"m.text"},"ts":1443796556000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"isn't there a github repo for the css specs now?","msgtype":"m.text"},"ts":1443796572000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"I can't find it","msgtype":"m.text"},"ts":1443796575000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"wanderview: because a service worker can have effect on what the URL of the stylesheet becomes, but I guess that might not be play","msgtype":"m.text"},"ts":1443796577000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"wanderview: https://drafts.csswg.org/","msgtype":"m.text"},"ts":1443796588000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"wanderview: doesn't really define any of this though","msgtype":"m.text"},"ts":1443796600000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: I am intercepting the stylesheet, but its just passing the url through to fetch()","msgtype":"m.text"},"ts":1443796608000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"annevk: I want to write an issue :-)","msgtype":"m.text"},"ts":1443796615000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"wanderview: right, so fetch() ends up eating the redirect","msgtype":"m.text"},"ts":1443796628000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"oh...","msgtype":"m.text"},"ts":1443796640000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"wanderview: which means the base URL becomes the request URL","msgtype":"m.text"},"ts":1443796642000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"right","msgtype":"m.text"},"ts":1443796658000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"hmm","msgtype":"m.text"},"ts":1443796660000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"I guess I could make it not call .respondWith()","msgtype":"m.text"},"ts":1443796696000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"actually, I can't","msgtype":"m.text"},"ts":1443796733000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"since I need to perform async work in the fetchevent handler","msgtype":"m.text"},"ts":1443796754000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"mumbles something about coffee.","msgtype":"m.emote"},"ts":1443796769000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"annevk: thanks","msgtype":"m.text"},"ts":1443796771000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"wanderview: it seemed too unlikely that Gecko would not use the \"final\" stylesheet URL","msgtype":"m.text"},"ts":1443796837000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: actually, isn't this bad?","msgtype":"m.text"},"ts":1443797081000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"annevk: it seems this is a case where installing a service worker that just does e.respondWith(fetch(e.request)) changes or breaks the website","msgtype":"m.text"},"ts":1443797114000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"annevk: since suddenly the website stops loading b.com/bg.jpg and tries to load a.com/bg.jpg which might not exist","msgtype":"m.text"},"ts":1443797140000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"wanderview: I defer to JakeA and slightlyoff","msgtype":"m.text"},"ts":1443797216000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"wanderview: too much other stuff going on, but fetch() is not without side effects, even if we change this somehow","msgtype":"m.text"},"ts":1443797257000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: I'll write an issue","msgtype":"m.text"},"ts":1443797300000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"annevk: seems \"manual\" RequestRedirect could solve it","msgtype":"m.text"},"ts":1443797890000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"annevk: but I wrote the issue here: https://github.com/slightlyoff/ServiceWorker/issues/757","msgtype":"m.text"},"ts":1443797895000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"wanderview: no that wouldn't solve it","msgtype":"m.text"},"ts":1443797934000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"why not? then the stylesheet would see the final URL?","msgtype":"m.text"},"ts":1443797946000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"wanderview: we cannot expose redirects to the service worker, remember","msgtype":"m.text"},"ts":1443797948000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: well, yea, that would be a side-effect, but whats the problem with it?","msgtype":"m.text"},"ts":1443797980000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"wanderview: security vulnerability?","msgtype":"m.text"},"ts":1443797993000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"wanderview: https://fetch.spec.whatwg.org/#atomic-http-redirect-handling","msgtype":"m.text"},"ts":1443798005000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"wanderview: there's a reason it's an \"opaqueredirect\"; making it non-opaque is not okay","msgtype":"m.text"},"ts":1443798026000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: I guess the same problem exists for other resources anyway... like a script that uses a relative importScripts()","msgtype":"m.text"},"ts":1443798027000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"annevk: wait... it would still be an opaqueredirect... just passed immediately to .respondWith()","msgtype":"m.text"},"ts":1443798047000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"wanderview: those URLs are resolved against the base URL of the global","msgtype":"m.text"},"ts":1443798052000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"wanderview: and then always go to the network with no way of making it work offline?","msgtype":"m.text"},"ts":1443798073000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: why wouldn't it get intercepted again?","msgtype":"m.text"},"ts":1443798082000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"wanderview: how would the CSS loader handle this manual redirect?","msgtype":"m.text"},"ts":1443798088000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"wanderview: bypass the SW?","msgtype":"m.text"},"ts":1443798097000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"wanderview: or reveal secrets?","msgtype":"m.text"},"ts":1443798108000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: if its same origin within scope, then yes same SW... otherwise other controlling service worker might handle it","msgtype":"m.text"},"ts":1443798128000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"wanderview: that's how navigation works, that's not how subresources work","msgtype":"m.text"},"ts":1443798152000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: for script case... where top level script is redirected and we do e.respondWith(fetch(e.request)), what is the global base URL?  the original script URL or the final URL?","msgtype":"m.text"},"ts":1443798187000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"wanderview: so yes, if you feed the redirect-to URL into a SW you created a security vulnerability","msgtype":"m.text"},"ts":1443798204000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"wonders if http://test.csswg.org/suites/css21_dev/nightly-unstable/xhtml1/root-box-003.xht is correct","msgtype":"m.emote"},"ts":1443798207000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"(pass condition in <title>)","msgtype":"m.text"},"ts":1443798214000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"I guess its defined by the document or worker, and both those have the manual redirect mode","msgtype":"m.text"},"ts":1443798226000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"wanderview: the base URL of the document","msgtype":"m.text"},"ts":1443798227000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"wanderview: workers don't have manual mode","msgtype":"m.text"},"ts":1443798240000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: whats the global base URL for a worker, then","msgtype":"m.text"},"ts":1443798266000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"?","msgtype":"m.text"},"ts":1443798267000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"Ms2ger: I think it might be invalid now","msgtype":"m.text"},"ts":1443798336000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"wanderview: the final URL","msgtype":"m.text"},"ts":1443798345000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: unless a service worker eats the redirect and then its the same problem as the stylesheet","msgtype":"m.text"},"ts":1443798371000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"wanderview: ah yeah, for workers that's true","msgtype":"m.text"},"ts":1443798390000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"wanderview: I'm just saying that manual is not the solution here","msgtype":"m.text"},"ts":1443798422000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"wanderview: if you want this different we actually need to change the model","msgtype":"m.text"},"ts":1443798432000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"wanderview: which not be a bad idea, but it's a bit late","msgtype":"m.text"},"ts":1443798471000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"wanderview: I tried to get this nailed down at some point, but sicking and slightlyoff didn't really want to discuss it much back then","msgtype":"m.text"},"ts":1443798520000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"wanderview: and we still had this fetch() vs event.default() thing which was weird","msgtype":"m.text"},"ts":1443798530000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: I won't be too upset if people say \"corner case... wontfix\"... I just want people to be aware of it","msgtype":"m.text"},"ts":1443798544000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"fair","msgtype":"m.text"},"ts":1443798563000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"its a definite footgun for developers, though","msgtype":"m.text"},"ts":1443798578000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"Yeah, I think we should maybe try to change it","msgtype":"m.text"},"ts":1443798588000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"We've changed a lot of things in fetch() so that it doesn't break defaults","msgtype":"m.text"},"ts":1443798611000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"E.g., referrer was a recent one","msgtype":"m.text"},"ts":1443798624000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"zcorpan: merged","msgtype":"m.text"},"ts":1443798642000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"annevk: like this example would break: https://jakearchibald.com/2014/offline-cookbook/#on-network-response","msgtype":"m.text"},"ts":1443798649000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"wanderview: added a comment","msgtype":"m.text"},"ts":1443798724000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"thanks","msgtype":"m.text"},"ts":1443798729000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"WHATWG aka DOM WG","msgtype":"m.text"},"ts":1443803331000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"beverloo: http://stackoverflow.com/questions/32908826/multiple-chrome-push-notifications-automatically-closes-except-the-last-one","msgtype":"m.text"},"ts":1443813227000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"MikeSmith, 'morning :)","msgtype":"m.text"},"ts":1443813311000,"senderName":"beverloo","senderId":"beverloo@irc"},
{"content":{"body":"I haven't heard of that before","msgtype":"m.text"},"ts":1443813322000,"senderName":"beverloo","senderId":"beverloo@irc"},
{"content":{"body":"howdy beverloo","msgtype":"m.text"},"ts":1443813650000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"MikeSmith, ah I got it","msgtype":"m.text"},"ts":1443813924000,"senderName":"beverloo","senderId":"beverloo@irc"},
{"content":{"body":"he sets the `tag` as the beginning of the event, and then fetches multiple notifications from his server, displaying them with the same tag","msgtype":"m.text"},"ts":1443813948000,"senderName":"beverloo","senderId":"beverloo@irc"},
{"content":{"body":"solution is to not use `tag` except for his error notification","msgtype":"m.text"},"ts":1443813963000,"senderName":"beverloo","senderId":"beverloo@irc"},
{"content":{"body":"let me create an account (way overdue anyway) and reply","msgtype":"m.text"},"ts":1443813969000,"senderName":"beverloo","senderId":"beverloo@irc"},
{"content":{"body":"thanks for the pointer :)","msgtype":"m.text"},"ts":1443813971000,"senderName":"beverloo","senderId":"beverloo@irc"},
{"content":{"body":"annevk: so where do we stuff things that we want to put on the global now?","msgtype":"m.text"},"ts":1443814817000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"i can't actually find any examples of putting things on the environment settings object","msgtype":"m.text"},"ts":1443814828000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Domenic: I've been thinking a bit more about this and putting things on the global instead of document might actually be problematic due to document.open() (which replaces the global)","msgtype":"m.text"},"ts":1443814881000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Domenic: but I guess it depends","msgtype":"m.text"},"ts":1443814892000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: so i guess my immediate confusion is that settings objects only have algorithms right now, whereas I want to put a couple data structures on them","msgtype":"m.text"},"ts":1443814930000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"where does HTML put all its global state??","msgtype":"m.text"},"ts":1443814943000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Domenic: document","msgtype":"m.text"},"ts":1443814951000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Domenic: mostly","msgtype":"m.text"},"ts":1443814954000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: what about in workers? :(","msgtype":"m.text"},"ts":1443814961000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Domenic: the environment settings object","msgtype":"m.text"},"ts":1443814982000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Domenic: and now a bit on the global too","msgtype":"m.text"},"ts":1443814995000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: any examples? I think I am just searching wrong.","msgtype":"m.text"},"ts":1443815004000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Domenic: HTTPS state?","msgtype":"m.text"},"ts":1443815012000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"HTTPS state is poorly defined. I don't think it's in HTML yet. I'm hedging mkwst's bets. :)","msgtype":"m.text"},"ts":1443815012000,"senderName":"botie","senderId":"botie@irc"},
{"content":{"body":"Domenic: also WorkerGlobalObject's url","msgtype":"m.text"},"ts":1443815049000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: meh, I don't want an algorithm for obtaining a list, I want a list...","msgtype":"m.text"},"ts":1443815051000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"I'm not really following I'm afraid","msgtype":"m.text"},"ts":1443815071000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"I also gotta go, so maybe tomorrow","msgtype":"m.text"},"ts":1443815084000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"WorkerGlobalScope's URL is better","msgtype":"m.text"},"ts":1443815085000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"I'll try to follow that model.","msgtype":"m.text"},"ts":1443815091000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"beverloo: thanks much! (and upvoted)","msgtype":"m.text"},"ts":1443815651000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"}
]