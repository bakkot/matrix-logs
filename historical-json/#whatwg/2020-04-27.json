[
{"content":{"body":"annevk, I'm trying to spec the suggestion in https://github.com/whatwg/html/pull/4571#discussion_r373270764 but it seems like the \"runnable\" check in step 2 of https://html.spec.whatwg.org/multipage/webappapis.html#event-loop-processing-model will break the latter case","msgtype":"m.text"},"ts":1587990112000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"Thoughts?","msgtype":"m.text"},"ts":1587990114000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"Ms2ger: not really, I see bz left a number of comments there that appear unaddressed as well","msgtype":"m.text"},"ts":1587990429000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Like what? Entry globals are defined, incumbent is explicitly marked as no consensus, and everything else is about dealing with documents that are not \"fully active\", afaict","msgtype":"m.text"},"ts":1587990538000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"Ms2ger: about confirming what is implemented","msgtype":"m.text"},"ts":1587990594000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"JakeA: https://github.com/whatwg/html/issues/5484#issuecomment-620015579 I don't see how this works given that discarding is currently synchronous, involves script execution, etc.","msgtype":"m.text"},"ts":1587997210000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"JakeA: websites will rely on that","msgtype":"m.text"},"ts":1587997223000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"JakeA: and engines do too","msgtype":"m.text"},"ts":1587997240000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: fwiw, I was thinking about this more for <portal>, so there wouldn't be a backwards compatibility issue there. I suppose there could be <iframe keepalive> or something","msgtype":"m.text"},"ts":1587997329000,"senderName":"JakeA","senderId":"JakeA@irc"},
{"content":{"body":"JakeA: well, it depends on how much logic from frames is reused internally","msgtype":"m.text"},"ts":1587997374000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"JakeA: I'm guessing <portal> doesn't define browsing context et al from scratch","msgtype":"m.text"},"ts":1587997390000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"JakeA: but removal is much more involved than that","msgtype":"m.text"},"ts":1587997412000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: I haven't thought too much about this, but my feeling is iframe & portal should extend something common, in the way audio & video have a common ancestor","msgtype":"m.text"},"ts":1587997452000,"senderName":"JakeA","senderId":"JakeA@irc"},
{"content":{"body":"JakeA: as Ryosuke noted multiple elements can be removed at once, script will execute (ideally from a queue as discussed in the various linked PRs)","msgtype":"m.text"},"ts":1587997457000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: what kind of script are we talking about here? Unload?","msgtype":"m.text"},"ts":1587997488000,"senderName":"JakeA","senderId":"JakeA@irc"},
{"content":{"body":"Yeah, though I'm not sure if that's the full extent of things; again, the status quo is not defined and not interoperable","msgtype":"m.text"},"ts":1587997531000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"First it has to be defined before you can realistically make a change here as otherwise too much will be unclear","msgtype":"m.text"},"ts":1587997557000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"I recommend reading the issue I linked and perhaps encourage people on Chrome to help solve it as thus far it's been somewhat tricky to get interest from browsers","msgtype":"m.text"},"ts":1587997587000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Yeah, I'm reading through it, the script execution bit just wasn't clear to me","msgtype":"m.text"},"ts":1587997874000,"senderName":"JakeA","senderId":"JakeA@irc"},
{"content":{"body":"I think the basic problem is also clear without that, in that you remove the iframe, but it still has a browsing context and so a bunch of things that branch on that break down because it has a browsing context but it's not in the tree, etc.","msgtype":"m.text"},"ts":1587997996000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"The only way to get rid of that is by having an atomic move operation","msgtype":"m.text"},"ts":1587998025000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"And even then it might be tricky given rniwa's comments, though I'm not sure to what extent those things still apply with atomic move","msgtype":"m.text"},"ts":1587998055000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"It's kind of hard to imagine they do, but who knows","msgtype":"m.text"},"ts":1587998095000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"I'll need to dig into the issues more. Bfcache pages seem to survive going away & coming back, so it feels like there's some kind of mechanism.","msgtype":"m.text"},"ts":1587998134000,"senderName":"JakeA","senderId":"JakeA@irc"},
{"content":{"body":"JakeA: that's top-level browsing contexts only and I think only those without reference to them","msgtype":"m.text"},"ts":1587998208000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"JakeA: not entirely sure about no reference though, that'd be good to confirm","msgtype":"m.text"},"ts":1587998288000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"seems likely tbh","msgtype":"m.text"},"ts":1587998305000,"senderName":"JakeA","senderId":"JakeA@irc"},
{"content":{"body":"Any idea which APIs rely on their nested browsing context's iframe being connected? Or, an example of one","msgtype":"m.text"},"ts":1587998364000,"senderName":"JakeA","senderId":"JakeA@irc"},
{"content":{"body":"Also that too is undefined","msgtype":"m.text"},"ts":1587998463000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Gotta stop with swamp-based designs","msgtype":"m.text"},"ts":1587998481000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"JakeA: maybe search for discard? There’s a bunch I wrote tests for a while back, but I don’t recall offhand","msgtype":"m.text"},"ts":1587998547000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"In wpt, or html issues?","msgtype":"m.text"},"ts":1587998574000,"senderName":"JakeA","senderId":"JakeA@irc"},
{"content":{"body":"That too = bfcache","msgtype":"m.text"},"ts":1587998577000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"In HTML itself; things like .parent or .frameElement iirc","msgtype":"m.text"},"ts":1587998610000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"From a quick scan, `.parent` relies on getting the iframe's document, which should still be correct. But yeah, I'm sure there's stuff that doesn't work.","msgtype":"m.text"},"ts":1587998857000,"senderName":"JakeA","senderId":"JakeA@irc"},
{"content":{"body":"MikeSmith, I noticed that https://www.w3.org/TR/dom/ redirects to dom.s.w.o, but https://www.w3.org/TR/domcore/ doesn't. Is that intentional?","msgtype":"m.text"},"ts":1588001726000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"TabAtkins: is https://github.com/tabatkins/highlighter/ Python3 friendly?","msgtype":"m.text"},"ts":1588012356000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Ooh, good question. Probably not, but I'm happy to update.","msgtype":"m.text"},"ts":1588012371000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"That'd be nice; we've got some html-build issues","msgtype":"m.text"},"ts":1588012441000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"np, i'll see if i can work on that today","msgtype":"m.text"},"ts":1588012472000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"}
]