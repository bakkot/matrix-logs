[
{"content":{"body":"annevk: Hey! Trying something out to see if we can reasonably show long-standing PR diffs in a reasonable way. Is there a way to \"auto collapse\" the commit-snapshot warning?","msgtype":"m.text"},"ts":1552638389000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"yoav: no","msgtype":"m.text"},"ts":1552639312000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"It is OK if I add something like that?","msgtype":"m.text"},"ts":1552639333000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"I don't think so, that design is quite intentional","msgtype":"m.text"},"ts":1552639347000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"I understand why that design is the way it is, but want to show the diff in a concise way, so want iframes showing bits and pieces of it","msgtype":"m.text"},"ts":1552639495000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"having to click collapse on every iframe would defeat the purpose","msgtype":"m.text"},"ts":1552639515000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"If we provided a workaround, how would that not open us to abuse?","msgtype":"m.text"},"ts":1552639583000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"I guess I could drive the same with JS","msgtype":"m.text"},"ts":1552639594000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"nm","msgtype":"m.text"},"ts":1552639606000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"annevk: would you be comfortable with a postMessage based mechanism that tells the preview to scroll to a certain anchor?","msgtype":"m.text"},"ts":1552643356000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"changing the src from the outside seems to trigger a new navigation","msgtype":"m.text"},"ts":1552643383000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"(at least in my initial testing. Maybe there's a way around that)","msgtype":"m.text"},"ts":1552643403000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"that's wasteful + after a certain point I'm getting 403s, presumably for requesting the same preview too many times","msgtype":"m.text"},"ts":1552643501000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"yoav: it'd be helpful to have an issue somewhere with a problem description or some such","msgtype":"m.text"},"ts":1552643564000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"sure, but wondered what your initial thoughts would be before I go to fully document it","msgtype":"m.text"},"ts":1552643602000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"yoav: somewhere between maybe and wondering if we need X-Frame-Options: deny ðŸ˜Š","msgtype":"m.text"},"ts":1552643736000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"my immediate goal is to make PRs like https://github.com/whatwg/fetch/pull/773 and https://github.com/whatwg/html/pull/3774 more comprehensible to casual reviewers","msgtype":"m.text"},"ts":1552643767000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"So I won't need to create a separate monkey patching document","msgtype":"m.text"},"ts":1552643826000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"so I'm trying to create a document which frames the PR preview, talks about what each change in it does and when the user clicks on a link, I want the PR preview to scroll to the relevant section","msgtype":"m.text"},"ts":1552643906000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"I can open an issue, but not 100% sure where that issue should go to. Fetch? HTML? PR preview?","msgtype":"m.text"},"ts":1552643948000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"yoav: https://github.com/whatwg/whatwg.org I suspect","msgtype":"m.text"},"ts":1552643991000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"ok","msgtype":"m.text"},"ts":1552644027000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"yoav: it's not possible to explain the set of changes and link to them?","msgtype":"m.text"},"ts":1552644039000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"It's possible, but will force the person doing the casual reviewing to hop back and forth between the explanation and the spec language","msgtype":"m.text"},"ts":1552644085000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"having both side by side seems better","msgtype":"m.text"},"ts":1552644108000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"annevk: https://github.com/whatwg/whatwg.org/issues/241","msgtype":"m.text"},"ts":1552644995000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"nox: so for <script> Chrome and Firefox presumably only disagree on details?","msgtype":"m.text"},"ts":1552658288000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"nox: as both have the defer mechanism","msgtype":"m.text"},"ts":1552658301000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: Seems like a huge detail to me.","msgtype":"m.text"},"ts":1552658320000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"nox: I guess I can run the tests","msgtype":"m.text"},"ts":1552658334000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: If you insert 2 scripts and modify the second from the first,","msgtype":"m.text"},"ts":1552658343000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"the second will be executed at the time it is modified in Chrome,","msgtype":"m.text"},"ts":1552658352000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"whereas in Firefox it will not execute immediately.","msgtype":"m.text"},"ts":1552658371000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"annevk: I described what FIrefox does in a comment, let me find it.","msgtype":"m.text"},"ts":1552658380000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"annevk: https://github.com/whatwg/html/pull/4354#issuecomment-463566900","msgtype":"m.text"},"ts":1552658391000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"nox: okay, is either solution better in some way?","msgtype":"m.text"},"ts":1552669680000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"nox: the Firefox solution seems a little cleaner in that original ordering is preserved","msgtype":"m.text"},"ts":1552669706000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: I personally prefer the Chrome behaviour because itâ€™s more in line with what I expected.","msgtype":"m.text"},"ts":1552669773000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"nox: are there any tradeoffs you see?","msgtype":"m.text"},"ts":1552669845000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"nox: if it's just edge cases I don't care strongly I suppose","msgtype":"m.text"},"ts":1552669860000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"nox: maybe I should run your stuff in Safari","msgtype":"m.text"},"ts":1552669866000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: Itâ€™s only ever exhibited in rare edge cases yeah.","msgtype":"m.text"},"ts":1552669880000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"annevk: Safari doesnâ€™t defer anything AFAIK, especially with fragments given it inserts children separately as if you had called insertBefore repeatedly yourself.","msgtype":"m.text"},"ts":1552669943000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"Yeah, Safari seems out there with these tests","msgtype":"m.text"},"ts":1552670035000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"nox: a problem I have with reviewing is that the alternatives are not written down in one place, so it's hard to judge things","msgtype":"m.text"},"ts":1552670099000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: Iâ€™m also not sure what happens if you insert two scripts and the first removes the second in Firefox","msgtype":"m.text"},"ts":1552670107000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"nox: tkent wrote some changes down, but they don't really concern what Chrome does with respect to script insertion","msgtype":"m.text"},"ts":1552670116000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"nox: I'd epxect the second to not execute based on what I know","msgtype":"m.text"},"ts":1552670136000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Specifically, is the already-started flag reset?","msgtype":"m.text"},"ts":1552670137000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"Ah never mind yeah it will be cleared out ultimately given itâ€™s not removed from the queue of deferred things.","msgtype":"m.text"},"ts":1552670196000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"nox: so is \"text content changed\" misleadingly named? What you set node.data only?","msgtype":"m.text"},"ts":1552670982000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"I don't understand the second question and it's Friday evening so I don't really want to think about the first one hah.","msgtype":"m.text"},"ts":1552671029000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"It's not misleadingly named, it's also called when you set node.data","msgtype":"m.text"},"ts":1552671113000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"interesting api from node: https://github.com/nodejs/node/pull/26686","msgtype":"m.text"},"ts":1552671125000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"Could still be a single \"children changed\" callback though","msgtype":"m.text"},"ts":1552671137000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: AFAIK inserting non-Text nodes in a style doesn't reset the stylesheet.","msgtype":"m.text"},"ts":1552671625000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"Yeah, I think Domenic tested this too perhaps; I wonder what browsers do in that case, have some kind of filter","msgtype":"m.text"},"ts":1552671734000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"A thing they might do is simply compare input to the parser to previous input and return early, though it seems somewhat wasteful to keep all of that around","msgtype":"m.text"},"ts":1552671770000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"goes to look for tests","msgtype":"m.emote"},"ts":1552671797000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Hmm, so when the concept was added to DOM no tests were added because only textarea was considered at the time","msgtype":"m.text"},"ts":1552672179000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"So whether node.normalize() affects <style> is unclear","msgtype":"m.text"},"ts":1552672192000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"And per https://github.com/whatwg/html/pull/3024 we did not add tests when this was also adopted by <style>","msgtype":"m.text"},"ts":1552672364000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"what is importing html supposed to do","msgtype":"m.text"},"ts":1552672366000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"Okay, at least that makes it clear what needs to be done","msgtype":"m.text"},"ts":1552672381000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"from the explainer it looks like content is an element and default is a vdom?","msgtype":"m.text"},"ts":1552672382000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"devsnek: HTML modules?","msgtype":"m.text"},"ts":1552672400000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"yeah","msgtype":"m.text"},"ts":1552672405000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"devsnek: it's a fancy xhr.responseXML","msgtype":"m.text"},"ts":1552672420000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"aha","msgtype":"m.text"},"ts":1552672442000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"thank you","msgtype":"m.text"},"ts":1552672444000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"I'm surprised that worked ðŸ˜Š","msgtype":"m.text"},"ts":1552672469000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: i was just trying to figure out if html modules would be affected by the (non)existence of top level await","msgtype":"m.text"},"ts":1552672551000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"nox: I created the most basic test","msgtype":"m.text"},"ts":1552673146000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"nox: inserting a comment node into a <style>","msgtype":"m.text"},"ts":1552673155000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"nox: sheet changed","msgtype":"m.text"},"ts":1552673160000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Ah, then I don't remember why I kept the distinction.","msgtype":"m.text"},"ts":1552673317000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"https://github.com/web-platform-tests/wpt/pull/15871","msgtype":"m.text"},"ts":1552673364000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: Oh, the opposite.","msgtype":"m.text"},"ts":1552673374000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"I might add some more tests next week, but I'm convinced now that we should only have \"children changed\" and not both of these concepts","msgtype":"m.text"},"ts":1552673399000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"I'm pretty sure I kept it for a reason but I could be wrong.","msgtype":"m.text"},"ts":1552673559000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"annevk: Ah now I remember.","msgtype":"m.text"},"ts":1552673649000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"annevk: The text content changed stuff is also called when changing Text nodes' contents and whatnot,","msgtype":"m.text"},"ts":1552673664000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"annevk: changing the contents of a Text node in a script element doesn't do anything to the script element.","msgtype":"m.text"},"ts":1552673677000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"script doesn't define any \"child text content change steps\", but it does say to prepare it whenever \"The script element is connected and a node or document fragment is inserted into the script element, after any script elements inserted at that time.\"","msgtype":"m.text"},"ts":1552673756000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"nox: interesting, I want to see if we can change that if true or perhaps we can make that a parameter","msgtype":"m.text"},"ts":1552673885000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: Meh, I would rather avoid ad-hoc use-once boolean parameters.","msgtype":"m.text"},"ts":1552673912000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"nox: Iâ€™d much rather avoid two subtly different callbacks with one only used once","msgtype":"m.text"},"ts":1552673963000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"I wouldn't call the difference subtle at all.","msgtype":"m.text"},"ts":1552673979000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"Not sure what you mean by \"used only once\" though.","msgtype":"m.text"},"ts":1552674028000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"nox: for scripts","msgtype":"m.text"},"ts":1552674100000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"nox: itâ€™d be good to see that test though","msgtype":"m.text"},"ts":1552674115000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"And please donâ€™t cite the current spec in support of anything as impls are all over ðŸ˜Š","msgtype":"m.text"},"ts":1552674211000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"I'm pretty sure I verified the thing about changing a text child, but yeah didn't write a test.","msgtype":"m.text"},"ts":1552674848000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"Where's the statement in HTML that UAs are allowed to fail due to resource constraints whenever they want?","msgtype":"m.text"},"ts":1552674885000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"Eh, nm, I just cited it as a general principle instead.","msgtype":"m.text"},"ts":1552675118000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"TabAtkins: https://html.spec.whatwg.org/#killing-scripts at least if you're talking about running scripts","msgtype":"m.text"},"ts":1552677461000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"That is indeed what I was looking for, but I didn't realize it was so limited to just scripts.","msgtype":"m.text"},"ts":1552677706000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"Yeah I couldn't find anything more general. It might be hiding, but I Ctrl+F'ed \"constraints\" and \"resources\" and didn't see anything early in the spec","msgtype":"m.text"},"ts":1552677836000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Asking here too, as w3c#testing is quiet right now: how do you test something that's just \"don't let me do X enough times to make the browser crash\"?","msgtype":"m.text"},"ts":1552677903000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"(Context is a Billion-Laughs attack via CSS variables; the spec now mandates that browsers must protect themselves from it, but doesn't specify a specific maximum length.)","msgtype":"m.text"},"ts":1552677999000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"TabAtkins: I think you write a test with no asserts and if it crashes the harness/infra will call that a failure. If it doesn't crash then a no-assert test is a pass.","msgtype":"m.text"},"ts":1552678111000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"TabAtkins: Infra might say that? About resource limits","msgtype":"m.text"},"ts":1552680866000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Domenic: Thanks, https://github.com/web-platform-tests/wpt/pull/15875 is committed now, and does indeed crash/fail in Chrome. ^_^","msgtype":"m.text"},"ts":1552685450000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"Amazing","msgtype":"m.text"},"ts":1552685483000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"that's a good test :)","msgtype":"m.text"},"ts":1552685497000,"senderName":"astearns","senderId":"astearns@irc"},
{"content":{"body":"Domenic: FYI, apparently a vacuous test without an assert is *not* a pass; it just times out and counts as a failure.","msgtype":"m.text"},"ts":1552689799000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"TabAtkins: I said \"without asserts\", not \"without tests\" :)","msgtype":"m.text"},"ts":1552689943000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"(I certainly could have been clearer)","msgtype":"m.text"},"ts":1552689952000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Bah!","msgtype":"m.text"},"ts":1552689954000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"^_^","msgtype":"m.text"},"ts":1552689956000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"well, you don't need explicit tests or asserts, you just need to call done() if you have neither (https://web-platform-tests.org/writing-tests/testharness-api.html#single-page-tests)","msgtype":"m.text"},"ts":1552690247000,"senderName":"Mek","senderId":"Mek@irc"}
]