[
{"content":{"body":"domfarolino: FWIW, https://github.com/whatwg/html/pull/4048#issuecomment-451187554 sounds good, I was just wondering how it was all fitting together","msgtype":"m.text"},"ts":1546531325000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"domfarolino: the more specific pieces look good though","msgtype":"m.text"},"ts":1546531333000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: Cool, thanks for checking it out. Yeah, the \"fitting together\" pieces are sort of in limbo currently","msgtype":"m.text"},"ts":1546531400000,"senderName":"domfarolino","senderId":"domfarolino@irc"},
{"content":{"body":"Domenic: WRT a \"script-blocking style sheet\" counter on Documents for #4031, it occurred to me that when a sheet is loaded, we cannot just decrement the counter, because the decremeter needs to know whether or not the conditions to increment the counter when the loading began, were once met (i.e., a \"blocking\" ss was loaded).","msgtype":"m.text"},"ts":1546547156000,"senderName":"domfarolino","senderId":"domfarolino@irc"},
{"content":{"body":"I'm wondering if we should make the conditions under https://html.spec.whatwg.org/multipage/semantics.html#a-style-sheet-that-is-blocking-scripts something callable, so we can increment and decrement explicitly. Let me know what you think of this sketch: https://gist.github.com/domfarolino/3fa29b31800e2203c8ce12b22cf8eba9","msgtype":"m.text"},"ts":1546547299000,"senderName":"domfarolino","senderId":"domfarolino@irc"},
{"content":{"body":"domfarolino: what about having a set, instead of just a counter? Then removing (if it's not present) is a no-op","msgtype":"m.text"},"ts":1546547343000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Your version seems good to though at first glance, reading in more detail now...","msgtype":"m.text"},"ts":1546547368000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"I don't know how my counter version^ integrates with XML style sheets at all though, since it seems their processing would have to explicitly try and increment said counter, which it does not do currently.","msgtype":"m.text"},"ts":1546547429000,"senderName":"domfarolino","senderId":"domfarolino@irc"},
{"content":{"body":"RE a set, I was thinking about something similar, however we can't have a set of style sheets, because as per spec, the style sheet isn't \"Created\" (and added simultaneously) until it is finished loading, and we want scripting to be blocked before then. That brought be back to the counter idea","msgtype":"m.text"},"ts":1546547492000,"senderName":"domfarolino","senderId":"domfarolino@irc"},
{"content":{"body":"Set of elements?","msgtype":"m.text"},"ts":1546547532000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"(Refreshing myself on what XML stylesheets do :-/)","msgtype":"m.text"},"ts":1546547556000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Oh duh, set of elements might be nice.","msgtype":"m.text"},"ts":1546547625000,"senderName":"domfarolino","senderId":"domfarolino@irc"},
{"content":{"body":"Or a set of \"things\" if we need to handle XML stylesheets/Link headers...","msgtype":"m.text"},"ts":1546547649000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"It does seem like we'll need to have something hand-wavey for those two","msgtype":"m.text"},"ts":1546547661000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Yeah I started thinking about how to handle Linke headers in the future too","msgtype":"m.text"},"ts":1546547665000,"senderName":"domfarolino","senderId":"domfarolino@irc"},
{"content":{"body":"I'm just concerned about not regressing the current vague text into precise but incorrect text","msgtype":"m.text"},"ts":1546547679000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"So I think we want to have precise for link + style, plus vague for Link + XMLSS","msgtype":"m.text"},"ts":1546547691000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"So either the counter or set versions, plus a sentence that says like \"when you see an XMLSS or Link header, increment the counter/add to the set; when X happens, decrement/remove from the set\"","msgtype":"m.text"},"ts":1546547730000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Medium-term we should investigate whether browsers actually allow Link or XMLSS style sheets to block script","msgtype":"m.text"},"ts":1546547862000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"That makes sense, I can add that to the interactions of styling and scripting section","msgtype":"m.text"},"ts":1546547874000,"senderName":"domfarolino","senderId":"domfarolino@irc"},
{"content":{"body":"But right now I'm just aiming for minimum work to maintain current text's normative requirements","msgtype":"m.text"},"ts":1546547875000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"SGTM","msgtype":"m.text"},"ts":1546547922000,"senderName":"domfarolino","senderId":"domfarolino@irc"},
{"content":{"body":"(although as you note the current requirements are pretty iffy, e.g. \"the element\" is often referenced but that doesn't make sense for Link headers)","msgtype":"m.text"},"ts":1546547923000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Maybe longer-term we'd want \"contributes a script-blocking style sheet\" to be called not with an element, but with some abstract \"Link properties\" obj is produced by `Link` headers, `<style>`, and `<link>` elements. Not sure yet though","msgtype":"m.text"},"ts":1546548062000,"senderName":"domfarolino","senderId":"domfarolino@irc"},
{"content":{"body":"But yeah for now I can go with a counter or set approach and add a sentence to sort of hand-wave over XMLSS+Headers interacting with said construct","msgtype":"m.text"},"ts":1546548154000,"senderName":"domfarolino","senderId":"domfarolino@irc"},
{"content":{"body":"My hope is that nobody bothered to implement blocking for XMLSSs and Link headers...","msgtype":"m.text"},"ts":1546548157000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"That would be nice","msgtype":"m.text"},"ts":1546548171000,"senderName":"domfarolino","senderId":"domfarolino@irc"},
{"content":{"body":"Will check","msgtype":"m.text"},"ts":1546548188000,"senderName":"domfarolino","senderId":"domfarolino@irc"},
{"content":{"body":"We could just put those into the set no? No need to make it a set of elements per se","msgtype":"m.text"},"ts":1546548290000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: Could you elaborate what \"those\" is?","msgtype":"m.text"},"ts":1546548441000,"senderName":"domfarolino","senderId":"domfarolino@irc"},
{"content":{"body":"domfarolino: Link header and PI node","msgtype":"m.text"},"ts":1546548467000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Ok, can we insert the XSLT PI nodes in via HTML spec, or would updating the XSLT spec be necessary if thatâ€™s even an option","msgtype":"m.text"},"ts":1546548850000,"senderName":"domfarolino","senderId":"domfarolino@irc"},
{"content":{"body":"Domenic: FWIW it appears that xml style sheets and link headers support blocking styles","msgtype":"m.text"},"ts":1546553499000,"senderName":"domfarolino","senderId":"domfarolino@irc"},
{"content":{"body":":(","msgtype":"m.text"},"ts":1546554424000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Oddly enough Chrome won't even fetch a style sheet that appears as a `Link` header unless it is rel=preload","msgtype":"m.text"},"ts":1546555461000,"senderName":"domfarolino","senderId":"domfarolino@irc"},
{"content":{"body":"I guess Safari too: https://crbug.com/19237 + https://bugs.webkit.org/show_bug.cgi?id=20018","msgtype":"m.text"},"ts":1546555491000,"senderName":"domfarolino","senderId":"domfarolino@irc"},
{"content":{"body":"Ah right, I forgot that that feature was only on Firefox","msgtype":"m.text"},"ts":1546556083000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"I think it was annevk who uses that to make their page's CSS/JS files look pretty","msgtype":"m.text"},"ts":1546556095000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Or something like that","msgtype":"m.text"},"ts":1546556099000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"(Cannot reproduce, but I swear I saw it at one time.)","msgtype":"m.text"},"ts":1546556162000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"(Also https://annevankesteren.nl/js/global is a funny file)","msgtype":"m.text"},"ts":1546556172000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Lol","msgtype":"m.text"},"ts":1546556381000,"senderName":"domfarolino","senderId":"domfarolino@irc"}
]