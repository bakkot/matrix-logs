[
{"content":{"body":"How is the infra \"ordered map\" usually implemented in browsers? Just an dynamically resized array or a combination of that and a hashmap?","msgtype":"m.text"},"ts":1511751096000,"senderName":"TimothyGu","senderId":"TimothyGu@irc"},
{"content":{"body":"or something else?","msgtype":"m.text"},"ts":1511751115000,"senderName":"TimothyGu","senderId":"TimothyGu@irc"},
{"content":{"body":"TimothyGu: https://github.com/Tessil/ordered-map/blob/master/README.md is the basic technique","msgtype":"m.text"},"ts":1511756187000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"https://docs.oracle.com/javase/7/docs/api/java/util/LinkedHashMap.html also","msgtype":"m.text"},"ts":1511756386000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Domenic: interesting, thanks","msgtype":"m.text"},"ts":1511756700000,"senderName":"TimothyGu","senderId":"TimothyGu@irc"},
{"content":{"body":"Huh, didn't expect this: https://chromium.googlesource.com/chromium/src/+/4c9a7b51c37e742e24f36b5d47680bce3361fb96%5E%21/","msgtype":"m.text"},"ts":1511782376000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"Ms2ger: what's unexpected about that?","msgtype":"m.text"},"ts":1511782774000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"That my \"better error message\" change actually found bugs","msgtype":"m.text"},"ts":1511782797000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"hah","msgtype":"m.text"},"ts":1511782832000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"yhirano__: heya are you around?","msgtype":"m.text"},"ts":1511785362000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"hi","msgtype":"m.text"},"ts":1511785375000,"senderName":"yhirano__","senderId":"yhirano__@irc"},
{"content":{"body":"yhirano__: I saw you've been patching some stuff around MIME types recently and was wondering if we should coordinate first somehow","msgtype":"m.text"},"ts":1511785453000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"yhirano__: e.g., Chrome not preserving the case of \"utf-8\" in XMLHttpRequest and always replacing might actually be better","msgtype":"m.text"},"ts":1511785482000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"yhirano__: especially given that Firefox seems to do that a lot if utf-8 is found inside a double-quoted parameter value","msgtype":"m.text"},"ts":1511785503000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"First, I agree with your last comment at https://github.com/whatwg/mimesniff/issues/39","msgtype":"m.text"},"ts":1511785618000,"senderName":"yhirano__","senderId":"yhirano__@irc"},
{"content":{"body":"Regarding case (in)sensitivity, I don't have a strong opinion, but I \"fixed\" the behavior recently: https://chromium-review.googlesource.com/c/chromium/src/+/773942","msgtype":"m.text"},"ts":1511785691000,"senderName":"yhirano__","senderId":"yhirano__@irc"},
{"content":{"body":"You can observe the new behavior on Chrome canary.","msgtype":"m.text"},"ts":1511785751000,"senderName":"yhirano__","senderId":"yhirano__@irc"},
{"content":{"body":"annvevk: ^","msgtype":"m.text"},"ts":1511785781000,"senderName":"yhirano__","senderId":"yhirano__@irc"},
{"content":{"body":"yhirano__: a couple days ago I thought I'd seen some kind of fluke, but then today I noticed that changeset in a Chromium issue","msgtype":"m.text"},"ts":1511785802000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"yhirano__: that is, in https://github.com/w3c/web-platform-tests/pull/8422#issuecomment-346847683 I thought Chrome always replaced with UTF-8 and then I looked again later and I couldn't reproduce ðŸ˜ƒ","msgtype":"m.text"},"ts":1511785841000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"yhirano__: the other question I have is whether we want to further restrict what are valid MIME types","msgtype":"m.text"},"ts":1511785920000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"yhirano__: e.g., should the parser reject \"?/?\" or not","msgtype":"m.text"},"ts":1511785931000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"yhirano__: Chrome currently only enforces this in overrideMimeType, due to an \"is a valid MIME type\" check, but it seems to me the implementation should always use the parser and not verify if the string is valid part of the time...","msgtype":"m.text"},"ts":1511785983000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"yhirano__: e.g., a weird thing in Chrome because of that is that Chrome will accept \"text/html;\" in most cases, but won't accept it for overrideMimeType","msgtype":"m.text"},"ts":1511786030000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: The check is relatively new (https://chromium-review.googlesource.com/547918). Previously there was no check at all.","msgtype":"m.text"},"ts":1511786168000,"senderName":"yhirano__","senderId":"yhirano__@irc"},
{"content":{"body":"annevk: I with we will be able to define one  \"validity\" for the web plat and use it everywhere.","msgtype":"m.text"},"ts":1511786235000,"senderName":"yhirano__","senderId":"yhirano__@irc"},
{"content":{"body":"yhirano__: yeah, so I suppose that's flexible still (though I owe you a beverage of your choosing for all the extra work whenever we next meet)","msgtype":"m.text"},"ts":1511786255000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: agreed, we can change the check in overrideMimetype() a bit.","msgtype":"m.text"},"ts":1511786379000,"senderName":"yhirano__","senderId":"yhirano__@irc"},
{"content":{"body":"annevk: s/I with/I wish/, sorry for the typo...","msgtype":"m.text"},"ts":1511786417000,"senderName":"yhirano__","senderId":"yhirano__@irc"},
{"content":{"body":"yhirano__: I guess to determine to which code points we can restrict MIME types we need to know what code points are used...","msgtype":"m.text"},"ts":1511786471000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"yhirano__: it seems that at least for type/subtype we can restrict to whatever \"token\" means, but I'm a little worried about parameters","msgtype":"m.text"},"ts":1511786498000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: for example?","msgtype":"m.text"},"ts":1511786526000,"senderName":"yhirano__","senderId":"yhirano__@irc"},
{"content":{"body":"yhirano__: \"text/html;x=?\"","msgtype":"m.text"},"ts":1511786548000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"yhirano__: should we reject that entirely, or accept it as text/html with no parameters, or as text/html with x=? as parameter","msgtype":"m.text"},"ts":1511786578000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"yhirano__: same for something like text/html;charset=â€ ","msgtype":"m.text"},"ts":1511786590000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"yhirano__: my inclination would be failure for \"?/?\", and dropping parameters for \"x/x;?=?\" or \"x/x;x=?;charset=utf-8\" (becomes x/x;charset=utf-8 in that case)","msgtype":"m.text"},"ts":1511786727000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: I guess allowing non-ascii will bring case issues (Kelvin/K/k)","msgtype":"m.text"},"ts":1511786763000,"senderName":"yhirano__","senderId":"yhirano__@irc"},
{"content":{"body":"yhirano__: so the existing text/xml;charset=â€  overrideMimeType case would instead expect \"text/xml\" as MIME type","msgtype":"m.text"},"ts":1511786763000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"yhirano__: non-ASCII brings quite a few issues as MIME types are sometimes restricted to \"latin1\" (e.g., HTTP)","msgtype":"m.text"},"ts":1511786804000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"yhirano__: so if you allowed non-ASCII you have to be very careful at the boundaries (think Response / Request objects)","msgtype":"m.text"},"ts":1511786836000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"yhirano__: so I'd definitely want to restrict non-ASCII personally","msgtype":"m.text"},"ts":1511786853000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"(that is, ensure it doesn't end up serialized)","msgtype":"m.text"},"ts":1511786869000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: your inclination sounds reasonable.","msgtype":"m.text"},"ts":1511787018000,"senderName":"yhirano__","senderId":"yhirano__@irc"},
{"content":{"body":"annevk: sorry I have to leave office, can we chat tomorrow?","msgtype":"m.text"},"ts":1511787050000,"senderName":"yhirano__","senderId":"yhirano__@irc"},
{"content":{"body":"yhirano__: sounds good, thanks thus far!","msgtype":"m.text"},"ts":1511787078000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: thanks","msgtype":"m.text"},"ts":1511787088000,"senderName":"yhirano__","senderId":"yhirano__@irc"},
{"content":{"body":"yhirano__: I'll try to make some progress on new tests and an updated spec to take all this into account","msgtype":"m.text"},"ts":1511787090000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"mathiasbynens: https://github.com/annevk/webvtt/pull/10","msgtype":"m.text"},"ts":1511791406000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"jgraham: should I squash commits before landing reviewed WPT test case upstream?  what is the standard for the repo?","msgtype":"m.text"},"ts":1511801075000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"squashed or unsquashed?","msgtype":"m.text"},"ts":1511801081000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"wanderview: A series of logical commits","msgtype":"m.text"},"ts":1511801212000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"Can be one if that makes sense, or more if that's going to be easier to understand later","msgtype":"m.text"},"ts":1511801229000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"jgraham: is a \"fix review feedback\" a logical commit?","msgtype":"m.text"},"ts":1511801235000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"wanderview: No","msgtype":"m.text"},"ts":1511801240000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"ok","msgtype":"m.text"},"ts":1511801242000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"wanderview: you wrote your code correct first time! nobody needs to know otherwise!","msgtype":"m.text"},"ts":1511802164000,"senderName":"gsnedders","senderId":"gsnedders@irc"}
]