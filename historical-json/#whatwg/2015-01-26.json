[
{"content":{"body":"morning","msgtype":"m.text"},"ts":1422258566000,"senderName":"ondras","senderId":"ondras@irc"},
{"content":{"body":"inside an attribute event handler, the element is added to the scope?","msgtype":"m.text"},"ts":1422258590000,"senderName":"ondras","senderId":"ondras@irc"},
{"content":{"body":"ondras: you mean <p onclick=\"\">? (not .onclick = function(){})","msgtype":"m.text"},"ts":1422259806000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"zcorpan: yeah, already found out: https://html.spec.whatwg.org/multipage/webappapis.html#internal-raw-uncompiled-handler","msgtype":"m.text"},"ts":1422260010000,"senderName":"ondras","senderId":"ondras@irc"},
{"content":{"body":"zcorpan: I was puzzled by body onclick having \"body\" in scope, while body onload NOT having body in scope","msgtype":"m.text"},"ts":1422260030000,"senderName":"ondras","senderId":"ondras@irc"},
{"content":{"body":"apparently onload does not belong to body :)","msgtype":"m.text"},"ts":1422260049000,"senderName":"ondras","senderId":"ondras@irc"},
{"content":{"body":"ah, yeah","msgtype":"m.text"},"ts":1422260054000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"hsivonen: MikeSmith: ping https://github.com/validator/validator/pull/25","msgtype":"m.text"},"ts":1422261093000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"Is the execution order of messages posted with `postMessage` guaranteed with regards to other scheduled tasks?","msgtype":"m.text"},"ts":1422262877000,"senderName":"benjamingr","senderId":"benjamingr@irc"},
{"content":{"body":"for example - is the result of the following guaranteed to always be one thing? http://jsfiddle.net/f45a5pdx/","msgtype":"m.text"},"ts":1422262887000,"senderName":"benjamingr","senderId":"benjamingr@irc"},
{"content":{"body":"Domenic: you'd probably know ^","msgtype":"m.text"},"ts":1422262899000,"senderName":"benjamingr","senderId":"benjamingr@irc"},
{"content":{"body":"hsivonen: it seems MS have now done what you suggested they do back in the days. http://www.smashingmagazine.com/2015/01/26/inside-microsofts-new-rendering-engine-project-spartan/ https://hsivonen.fi/ie6/ (except not for ie6, just ie5.5, 7, 8, 9, 10, 11)","msgtype":"m.text"},"ts":1422271466000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"(maybe \"enterprise mode\" was already a thing in ie11)","msgtype":"m.text"},"ts":1422271846000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"zcorpan: merged the validator change","msgtype":"m.text"},"ts":1422275684000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"thanks","msgtype":"m.text"},"ts":1422275688000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"cheers","msgtype":"m.text"},"ts":1422275698000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"sorry for not getting to it sooner","msgtype":"m.text"},"ts":1422275700000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"no worries","msgtype":"m.text"},"ts":1422275714000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"Hm, Presto had navigator.appMinorVersion?","msgtype":"m.text"},"ts":1422276834000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"seems so","msgtype":"m.text"},"ts":1422278105000,"senderName":"zcorpan_","senderId":"zcorpan_@irc"},
{"content":{"body":"also browserLanguage, userLanguage","msgtype":"m.text"},"ts":1422278389000,"senderName":"zcorpan_","senderId":"zcorpan_@irc"},
{"content":{"body":"browserLanguage only if navigator.appName == \"Microsoft Internet Explorer\"","msgtype":"m.text"},"ts":1422278457000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"looks like both of those have some usage on github","msgtype":"m.text"},"ts":1422278545000,"senderName":"zcorpan_","senderId":"zcorpan_@irc"},
{"content":{"body":"return (navigator.browserLanguage || navigator.language || navigator.userLanguage).substr(0,2)","msgtype":"m.text"},"ts":1422278650000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"\"navigator.language\" 138,088 \"navigator.userLanguage\" 51,830 \"navigator.browserLanguage\" 14,089","msgtype":"m.text"},"ts":1422278650000,"senderName":"zcorpan_","senderId":"zcorpan_@irc"},
{"content":{"body":"\"navigator.languages\" 991","msgtype":"m.text"},"ts":1422278685000,"senderName":"zcorpan_","senderId":"zcorpan_@irc"},
{"content":{"body":"Are any specs in the works that improve upon addEventListener?","msgtype":"m.text"},"ts":1422284417000,"senderName":"JonathanNeal","senderId":"JonathanNeal@irc"},
{"content":{"body":"How so?","msgtype":"m.text"},"ts":1422284771000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"@Ms2ger, how so to improve upon addEventListener? Returning an event object that could disable itself. Promisified like fetch or streamed or whatever the word is. Integrated delegation (without mimicing via .closest).","msgtype":"m.text"},"ts":1422286361000,"senderName":"JonathanNeal","senderId":"JonathanNeal@irc"},
{"content":{"body":"benjamingr: I don't believe so. UAs can pick from any of multiple queues when it's time to execute a task, at their discretion. That is how e.g. painting gets priority over setTimeout IIRC.","msgtype":"m.text"},"ts":1422293715000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"more confusion between promises and event listeners, sigh, when will it ever end.","msgtype":"m.text"},"ts":1422293776000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"What goes into which queue should be defined, though","msgtype":"m.text"},"ts":1422293859000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"Not sure if Promises do","msgtype":"m.text"},"ts":1422293865000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"Hmm?","msgtype":"m.text"},"ts":1422294164000,"senderName":"jgraham_","senderId":"jgraham_@irc"},
{"content":{"body":"Domenic: that's what I thought - thanks!","msgtype":"m.text"},"ts":1422297050000,"senderName":"benjamingr","senderId":"benjamingr@irc"},
{"content":{"body":"Anyone have any experience with python html5lib?","msgtype":"m.text"},"ts":1422307655000,"senderName":"nicholasserra","senderId":"nicholasserra@irc"},
{"content":{"body":"nicholasserra: dont ask to ask, just as your actual question","msgtype":"m.text"},"ts":1422307703000,"senderName":"boogyman","senderId":"boogyman@irc"},
{"content":{"body":"boogyman: Wasn't sure, as this channel seems to have a pretty broad purpose. Thanks","msgtype":"m.text"},"ts":1422307729000,"senderName":"nicholasserra","senderId":"nicholasserra@irc"},
{"content":{"body":"If it's a question about #python or ##python that would probably be a better place to ask, but if its a question about the HTML specs, here is appropriate.","msgtype":"m.text"},"ts":1422307783000,"senderName":"boogyman","senderId":"boogyman@irc"},
{"content":{"body":"Well, i'm using the python html5lib package to sanitize some html, but it seems to be escaping ampersands inside of an href attribute, which seems like a bug to me. Not sure if i'm not passing a correct flag. The source is pretty hard to dig into. https://gist.github.com/nicholasserra/6bd1ff7650e398127f19","msgtype":"m.text"},"ts":1422307841000,"senderName":"nicholasserra","senderId":"nicholasserra@irc"},
{"content":{"body":"that's a #python or ##python question","msgtype":"m.text"},"ts":1422307873000,"senderName":"boogyman","senderId":"boogyman@irc"},
{"content":{"body":"Gotcha thanks","msgtype":"m.text"},"ts":1422307894000,"senderName":"nicholasserra","senderId":"nicholasserra@irc"},
{"content":{"body":"cheers","msgtype":"m.text"},"ts":1422307906000,"senderName":"boogyman","senderId":"boogyman@irc"},
{"content":{"body":"to be fair the html5lib authors hang out here","msgtype":"m.text"},"ts":1422308997000,"senderName":"SimonSapin","senderId":"SimonSapin@irc"},
{"content":{"body":"You're supposed to escape ampersands inside of attribute values, tho.","msgtype":"m.text"},"ts":1422311202000,"senderName":"TabAtkins","senderId":"TabAtkins@irc"},
{"content":{"body":"nicholasserra: That is a #whatwg question, not a #python question","msgtype":"m.text"},"ts":1422311654000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":":)","msgtype":"m.text"},"ts":1422311655000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"nicholasserra: The rules around escaping ampersands in attributes are somewhat complicated, but in general it should always be OK to escape them","msgtype":"m.text"},"ts":1422311778000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"Is it causing you an actual problem?","msgtype":"m.text"},"ts":1422311802000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"jgraham: Yes, as it is in an href, and the link is no longer valid","msgtype":"m.text"},"ts":1422312682000,"senderName":"nicholasserra","senderId":"nicholasserra@irc"},
{"content":{"body":"I opened up an issue with all the details too: https://github.com/html5lib/html5lib-python/issues/180","msgtype":"m.text"},"ts":1422312734000,"senderName":"nicholasserra","senderId":"nicholasserra@irc"},
{"content":{"body":"nicholasserra: So afaict when you parse the output of that you get the same as when you parse the input i.e. everything is working as expected","msgtype":"m.text"},"ts":1422313860000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"jgraham: What do you mean? To clarify my issue, if I try to sanitize an anchor tag with href like google.com/?key=1&key=2, the href will be changed to ?key=1&amp;key=2","msgtype":"m.text"},"ts":1422314007000,"senderName":"nicholasserra","senderId":"nicholasserra@irc"},
{"content":{"body":"dpm","msgtype":"m.text"},"ts":1422314370000,"senderName":"zewt_","senderId":"zewt_@irc"},
{"content":{"body":"typing hard","msgtype":"m.text"},"ts":1422314375000,"senderName":"zewt_","senderId":"zewt_@irc"},
{"content":{"body":"don't suppose there's a magic setting to un-break chrome user scripts","msgtype":"m.text"},"ts":1422314384000,"senderName":"zewt_","senderId":"zewt_@irc"},
{"content":{"body":"one day google decided to just kill off user scripts saying \"not from chrome web store\"","msgtype":"m.text"},"ts":1422314413000,"senderName":"zewt_","senderId":"zewt_@irc"},
{"content":{"body":"nicholasserra: The output will yes. But reparsing that output will give you the same DOM as your original input","msgtype":"m.text"},"ts":1422314416000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"So I don't see why it's a problem","msgtype":"m.text"},"ts":1422314431000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"The DOM is fine, but now I have an href with an invalid link","msgtype":"m.text"},"ts":1422314553000,"senderName":"nicholasserra","senderId":"nicholasserra@irc"},
{"content":{"body":"jgraham: ^","msgtype":"m.text"},"ts":1422314558000,"senderName":"nicholasserra","senderId":"nicholasserra@irc"},
{"content":{"body":"Unless html entities are parsed by the browser. I don't think that's the case though.","msgtype":"m.text"},"ts":1422314595000,"senderName":"nicholasserra","senderId":"nicholasserra@irc"},
{"content":{"body":"tldr <a href=\"test.com/&\"> goes in, <a href=\"test.com/&amp;\"> comes out. Different href attrs","msgtype":"m.text"},"ts":1422314693000,"senderName":"nicholasserra","senderId":"nicholasserra@irc"},
{"content":{"body":"that looks right to me","msgtype":"m.text"},"ts":1422314725000,"senderName":"zewt_","senderId":"zewt_@irc"},
{"content":{"body":"nicholasserra: It is the case. See e.g. http://software.hixie.ch/utilities/js/live-dom-viewer/saved/3384","msgtype":"m.text"},"ts":1422314748000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"it's not going to remember which characters were escaped in the input, you just always escape going out","msgtype":"m.text"},"ts":1422314794000,"senderName":"zewt","senderId":"zewt@irc"},
{"content":{"body":"it could probably figure out when escaping isn't needed, but nobody would risk escaping-related security bugs just to prettify html a little","msgtype":"m.text"},"ts":1422314834000,"senderName":"zewt","senderId":"zewt@irc"},
{"content":{"body":"(for some value of nobody)","msgtype":"m.text"},"ts":1422314862000,"senderName":"zewt","senderId":"zewt@irc"},
{"content":{"body":"Nice. I guess I never knew that the browser would treat html special chars as their regular character counterparts when parsing the attribute. Still seems generally wrong to me though.","msgtype":"m.text"},"ts":1422314865000,"senderName":"nicholasserra","senderId":"nicholasserra@irc"},
{"content":{"body":"I would expect those URI attrs to be excluded from any parsing or treatment in general.","msgtype":"m.text"},"ts":1422314889000,"senderName":"nicholasserra","senderId":"nicholasserra@irc"},
{"content":{"body":"(you mean URL)","msgtype":"m.text"},"ts":1422314894000,"senderName":"zewt","senderId":"zewt@irc"},
{"content":{"body":"how would you put a quote in the string?","msgtype":"m.text"},"ts":1422314904000,"senderName":"zewt","senderId":"zewt@irc"},
{"content":{"body":"nicholasserra: The spec and all browsers disagree with your expectations, though :)","msgtype":"m.text"},"ts":1422314913000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"i guess you're thinking that you could URL-escape but not HTML-escape, which I guess is fair, but incorrect","msgtype":"m.text"},"ts":1422314965000,"senderName":"zewt","senderId":"zewt@irc"},
{"content":{"body":"Not all attributes are URLs","msgtype":"m.text"},"ts":1422314980000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"The code from html5lib refers to them as URI. But yeah.","msgtype":"m.text"},"ts":1422314987000,"senderName":"nicholasserra","senderId":"nicholasserra@irc"},
{"content":{"body":"since the ... yeah that's a shorter way of typing what i was about to type","msgtype":"m.text"},"ts":1422314990000,"senderName":"zewt","senderId":"zewt@irc"},
{"content":{"body":"Yeah, I guess I would imagine that urlencoding it would make more sense","msgtype":"m.text"},"ts":1422315015000,"senderName":"nicholasserra","senderId":"nicholasserra@irc"},
{"content":{"body":"It probably shouldn't say URI but it's hard to change the API now","msgtype":"m.text"},"ts":1422315017000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"Weird stuff","msgtype":"m.text"},"ts":1422315032000,"senderName":"nicholasserra","senderId":"nicholasserra@irc"},
{"content":{"body":"thanks for sorting it out with me zewt and jgraham","msgtype":"m.text"},"ts":1422315065000,"senderName":"nicholasserra","senderId":"nicholasserra@irc"},
{"content":{"body":"nicholasserra: np","msgtype":"m.text"},"ts":1422315071000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"Im going to leave my issue open to see if anyone else has an opinion on it","msgtype":"m.text"},"ts":1422315077000,"senderName":"nicholasserra","senderId":"nicholasserra@irc"},
{"content":{"body":"not really good practice","msgtype":"m.text"},"ts":1422315113000,"senderName":"zewt","senderId":"zewt@irc"},
{"content":{"body":"since it's forcing somebody somewhere to spend time on it (and just repeating what we just said)","msgtype":"m.text"},"ts":1422315175000,"senderName":"zewt","senderId":"zewt@irc"},
{"content":{"body":"While you're both right that it will work, I still don't think URL attributes should even be parsed. It's probably a wontfix issue, but i'm curious if the authors have any more input.","msgtype":"m.text"},"ts":1422315259000,"senderName":"nicholasserra","senderId":"nicholasserra@irc"},
{"content":{"body":"given that that's not what browsers actually do, that's frankly just not a valid thing to think :)","msgtype":"m.text"},"ts":1422315316000,"senderName":"zewt","senderId":"zewt@irc"},
{"content":{"body":"better off posting to a mailing list if you want to ask for opinions--filing a bug is sort of like demanding them","msgtype":"m.text"},"ts":1422315389000,"senderName":"zewt","senderId":"zewt@irc"},
{"content":{"body":"(anyway, i'm not the one who has to respond to the bug report)","msgtype":"m.text"},"ts":1422315412000,"senderName":"zewt","senderId":"zewt@irc"},
{"content":{"body":"That's fair. The google group for html5lib is pretty dead. Any suggestions on where to ask that question?","msgtype":"m.text"},"ts":1422315480000,"senderName":"nicholasserra","senderId":"nicholasserra@irc"},
{"content":{"body":"nicholasserra: FWIW I am one of the principal authors of html5lib","msgtype":"m.text"},"ts":1422315540000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"it's not really html5lib-specific, you could ask anywhere html-related, eg. stackoverflow","msgtype":"m.text"},"ts":1422315544000,"senderName":"zewt","senderId":"zewt@irc"},
{"content":{"body":"since you're asking about html parsing, html5lib is just one implementation of that","msgtype":"m.text"},"ts":1422315561000,"senderName":"zewt","senderId":"zewt@irc"},
{"content":{"body":"Gotcha. Thanks. I closed my issue. Maybe i'll bring it up elsewhere. jgraham zewt","msgtype":"m.text"},"ts":1422315606000,"senderName":"nicholasserra","senderId":"nicholasserra@irc"},
{"content":{"body":"(another reason what you're suggesting is incorrect: browsers don't know whether an attribute contains a url in advance; it might be a polyfilled attribute that it doesn't know about yet)","msgtype":"m.text"},"ts":1422315631000,"senderName":"zewt","senderId":"zewt@irc"},
{"content":{"body":"I guess my gripe is more with the parser than the browser. Mainly: If the browser will just read the html special character as its regular character counterpart, and the parser knows that it's in a URL attribute, when why bother escaping it?","msgtype":"m.text"},"ts":1422315745000,"senderName":"nicholasserra","senderId":"nicholasserra@irc"},
{"content":{"body":"the parser doesn't necessarily know anything about the contents of an attribute","msgtype":"m.text"},"ts":1422315769000,"senderName":"zewt","senderId":"zewt@irc"},
{"content":{"body":"In html5lib, it has a list of attrs that are marked as URL attributes","msgtype":"m.text"},"ts":1422315785000,"senderName":"nicholasserra","senderId":"nicholasserra@irc"},
{"content":{"body":"(and it shouldn't have to--that's bad layering)","msgtype":"m.text"},"ts":1422315786000,"senderName":"zewt","senderId":"zewt@irc"},
{"content":{"body":"and that's not exhaustive: when a new attribute is added to HTML that contains a URL, it won't know about it","msgtype":"m.text"},"ts":1422315823000,"senderName":"zewt","senderId":"zewt@irc"},
{"content":{"body":"which means HTML would parse differently as attributes are added","msgtype":"m.text"},"ts":1422315836000,"senderName":"zewt","senderId":"zewt@irc"},
{"content":{"body":"So basically you're saying it should sanitize everything just in case?","msgtype":"m.text"},"ts":1422315856000,"senderName":"nicholasserra","senderId":"nicholasserra@irc"},
{"content":{"body":"nothing to do with sanitizing, if you say <foo srcurl=\"http://google.com/&amp;\">, and you look at srcurl in javascript on the page, some browsers would say \"http://google.com&amp;\" and others would say \"http://google.com&\"","msgtype":"m.text"},"ts":1422315955000,"senderName":"zewt","senderId":"zewt@irc"}
]