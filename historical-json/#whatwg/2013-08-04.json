[
{"content":{"body":"Hixie, my irc bouncer sometimes loses track of whether it has marked me away when I disconnect from it abnormally","msgtype":"m.text"},"ts":1375578447000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"hehe","msgtype":"m.text"},"ts":1375578476000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"heycam: for the incumbent script thing","msgtype":"m.text"},"ts":1375578520000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"heycam: i'd like this algorithm to be invoked when you call a callback: http://whatwg.org/html#jump-to-a-code-entry-point","msgtype":"m.text"},"ts":1375578566000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"looks","msgtype":"m.emote"},"ts":1375578580000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"heycam: it handles things like script getting disabled, the document no longer being active, and marking the entry script","msgtype":"m.text"},"ts":1375578587000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"heycam: and invoking microtasks, etc","msgtype":"m.text"},"ts":1375578594000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"heycam: you got any ideas on how to hook this up?","msgtype":"m.text"},"ts":1375578618000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"Hixie, ah so you'll handle all the pushing and popping to the stack","msgtype":"m.text"},"ts":1375578641000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"Hixie, so I don't really understand the relationship between the Function object that I have in my callback invoking algorithm and the \"code entry-point\"","msgtype":"m.text"},"ts":1375578743000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"yeah, there's no relationship (any more, i broke that yesterday when i realised i never invoked callbacks, before realising you did and we needed this still)","msgtype":"m.text"},"ts":1375578783000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"but we can fix that by renaming the algorithm or something","msgtype":"m.text"},"ts":1375578796000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"Hixie, actually, do you want Web IDL to push/pop the incumbent script stack or not?","msgtype":"m.text"},"ts":1375578808000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"heycam: well, you still have to push when you're invoking things that aren't script","msgtype":"m.text"},"ts":1375578825000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"e.g. in setTimeout(window.alert, 100, s)","msgtype":"m.text"},"ts":1375578838000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"when you call window.alert","msgtype":"m.text"},"ts":1375578843000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"I see","msgtype":"m.text"},"ts":1375578855000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"but I think I need to push/pop even for Function objects that come from a script, because Web IDL has the stashed away script to push/pop","msgtype":"m.text"},"ts":1375578883000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"can't just call in to \"jump to a code entry-point\", unless I pass that script in to that algorithm","msgtype":"m.text"},"ts":1375578896000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"or is that what \"for a script\" means","msgtype":"m.text"},"ts":1375578910000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"in \"When a user agent is to jump to a code entry-point for a script, ...\"","msgtype":"m.text"},"ts":1375578918000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"yeah, this will need some work on both ends","msgtype":"m.text"},"ts":1375578994000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"(i'm not actually able to work right now, just wanted to give you a brain dump since you were online)","msgtype":"m.text"},"ts":1375579015000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"ok","msgtype":"m.text"},"ts":1375579024000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"so if I can just pass in to you the Function object, the arguments to pass to it (and the this value to use), and the script I've stashed away, that should work","msgtype":"m.text"},"ts":1375579054000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"sounds good to me. pass it to a new algorithm and i'll hook it all up on monday.","msgtype":"m.text"},"ts":1375579084000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"then I can remove the pushing/popping that I do","msgtype":"m.text"},"ts":1375579146000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"heycam: just make sure you still do it when the thing you're calling is a host thingy and not a script","msgtype":"m.text"},"ts":1375580120000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"Hixie, ok. the two shouldn't be handled differently in Web IDL currently.","msgtype":"m.text"},"ts":1375580180000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"heycam: i mean, still do it on your side (not call into the html algorithm)","msgtype":"m.text"},"ts":1375580810000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"Hixie, oh ok. so in that case I should be the one invoking [[Call]]?  but for Function objects from a script, your algorithm will invoke [[Call]]?","msgtype":"m.text"},"ts":1375580857000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"well my algorithm has no idea how to handle \"call window.alert()\", as in the setTimeout(window.alert, 100, s) case, where the callback is a host thing","msgtype":"m.text"},"ts":1375580890000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"hmm","msgtype":"m.text"},"ts":1375580941000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"what's the difference? does the step 4 you've currently got there do anything special?","msgtype":"m.text"},"ts":1375580973000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"well there's no script","msgtype":"m.text"},"ts":1375580995000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"i guess that's what you meant by you have a script and an entry point, though, hm","msgtype":"m.text"},"ts":1375581015000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"but does step 4 just mean \"invoke [[Call]]\"?","msgtype":"m.text"},"ts":1375581032000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"yeah i guess if you force feed me the info i need, that works","msgtype":"m.text"},"ts":1375581038000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"i've no idea what step 4 really means","msgtype":"m.text"},"ts":1375581045000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"heh","msgtype":"m.text"},"ts":1375581048000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"it's trying to vaguely be language-agnostic","msgtype":"m.text"},"ts":1375581050000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"ah","msgtype":"m.text"},"ts":1375581053000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"though that may be a lost cause","msgtype":"m.text"},"ts":1375581064000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"i think we're likely to see a return to people caring about that shortly, though","msgtype":"m.text"},"ts":1375581075000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"like, in the coming years","msgtype":"m.text"},"ts":1375581078000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"with asm.js and so forth","msgtype":"m.text"},"ts":1375581084000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"we'll see I guess","msgtype":"m.text"},"ts":1375581089000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"ok I'll write some text and I'll send you an email","msgtype":"m.text"},"ts":1375581113000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"oh one thing","msgtype":"m.text"},"ts":1375581125000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"this algorithm can abort in certain situations where it can't call the function","msgtype":"m.text"},"ts":1375581146000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"on the Web IDL side, I'm expecting to return a value of a particular Web IDL type. for example if it's a callback function with a particular return type","msgtype":"m.text"},"ts":1375581175000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"so in that situation I can't just return nothing. feels like I should be throwing an exception in that case.","msgtype":"m.text"},"ts":1375581210000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"though not sure what exception it should be","msgtype":"m.text"},"ts":1375581256000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"only if the script is disabled, right?","msgtype":"m.text"},"ts":1375581260000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"what would you do with the exception?","msgtype":"m.text"},"ts":1375581268000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"propagate it out?","msgtype":"m.text"},"ts":1375581275000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"to what? if script is disabled...","msgtype":"m.text"},"ts":1375581294000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"is script being disabled the only situation where you don't invoke callbacks like this?","msgtype":"m.text"},"ts":1375581311000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"the document not being active","msgtype":"m.text"},"ts":1375581320000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"i think that's it, no?","msgtype":"m.text"},"ts":1375581325000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"i'd just treat the return value as \"void\"","msgtype":"m.text"},"ts":1375581331000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"and pretend it ran a no-op","msgtype":"m.text"},"ts":1375581344000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"if my callback is a `callback Something = Node ();`","msgtype":"m.text"},"ts":1375581399000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"I guess I could pretend the function returned undefined, try to convert that, and throw as a result","msgtype":"m.text"},"ts":1375581427000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"but as you say this might not be user visible anyway","msgtype":"m.text"},"ts":1375581432000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"i would treat it as if the script had been   function () { }","msgtype":"m.text"},"ts":1375581464000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"ok","msgtype":"m.text"},"ts":1375581474000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"so when you do these preparatory steps of checking if scripting is disabled for the script's browsing context, is that not for the script that's currently on the top of the stack, but the script the Function object actually comes from?","msgtype":"m.text"},"ts":1375581544000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"does it make sense if you do `setTimeout(window.alert, …)` to look at the incumbent script that was associated with window.alert, when you passed it in as a callback?","msgtype":"m.text"},"ts":1375581577000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"it's for the script you're about to run","msgtype":"m.text"},"ts":1375581578000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"in that particular case, i doubt it matters exactly who you're checking","msgtype":"m.text"},"ts":1375581603000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"hmm","msgtype":"m.text"},"ts":1375581608000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"oh, it should matter actually","msgtype":"m.text"},"ts":1375581611000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"it should be the script that called window.setTimeout()","msgtype":"m.text"},"ts":1375581620000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"aha","msgtype":"m.text"},"ts":1375581627000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"though i think for timeout we actually already have mechanisms in place to stall them if the window is not active","msgtype":"m.text"},"ts":1375581699000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"so it doesn't much matter","msgtype":"m.text"},"ts":1375581702000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"would that be ok in general though? do these preparatory steps on the script that's on top of the stack, if it's a host object thing, and the actual script the Function object is from if it's a user thing?","msgtype":"m.text"},"ts":1375581762000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"i guess?","msgtype":"m.text"},"ts":1375582462000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"maybe we don't even do them for host things","msgtype":"m.text"},"ts":1375582470000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"the step 3 where we push on to the incumbent script stack, is it right that we push the actual script the Function object came from, if it is a user thing, but we need to push the \"whatever was at the top of the stack at the time we passed in the callback\" script for a host thing?","msgtype":"m.text"},"ts":1375582662000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"I think I got that bit wrong with my initial edits","msgtype":"m.text"},"ts":1375582673000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"i'm not sure","msgtype":"m.text"},"ts":1375582982000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"i do know that if it's not an author script, we don't want to be setting the candidate entry script flag thing","msgtype":"m.text"},"ts":1375583000000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"though it may not matter...","msgtype":"m.text"},"ts":1375583010000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"i don't know","msgtype":"m.text"},"ts":1375583011000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"sorry dude, not awake right now :-)","msgtype":"m.text"},"ts":1375583018000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"heh fair enough ;)","msgtype":"m.text"},"ts":1375583038000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"has no idea what candidate entry script flag is for","msgtype":"m.emote"},"ts":1375583061000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"anyway, I'll write something up and you can look at it later","msgtype":"m.text"},"ts":1375583068000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"it sets the entry script, which is used for security","msgtype":"m.text"},"ts":1375583108000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"e","msgtype":"m.text"},"ts":1375594527000,"senderName":"treehau55","senderId":"treehau55@irc"},
{"content":{"body":"Hixie: what's the rationale for the http://html5.org/r/8109 change?","msgtype":"m.text"},"ts":1375608508000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"(it's also got a typo)","msgtype":"m.text"},"ts":1375608551000,"senderName":"heycam","senderId":"heycam@irc"},
{"content":{"body":"MikeSmith, \"Requiring the Encoding Standard preferred name is too strict for no good reason\" thread on whatwg?","msgtype":"m.text"},"ts":1375608654000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"Ms2ger: oh thanks","msgtype":"m.text"},"ts":1375608672000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"(And the aone typo is fixed)","msgtype":"m.text"},"ts":1375608682000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"oK","msgtype":"m.text"},"ts":1375608690000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"is way behind on reading list mail","msgtype":"m.emote"},"ts":1375608707000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"in other news http://html5.org/r/8108 is a pretty significant implementation change","msgtype":"m.text"},"ts":1375608770000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"would be good to hear what hsivonen_ thinks of it","msgtype":"m.text"},"ts":1375608793000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"Ms2ger: think I should open a mozilla bug for that one?","msgtype":"m.text"},"ts":1375608827000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"against the HTML parse","msgtype":"m.text"},"ts":1375608842000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"*parser","msgtype":"m.text"},"ts":1375608845000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"MikeSmith, that would probably be good","msgtype":"m.text"},"ts":1375608884000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"ok","msgtype":"m.text"},"ts":1375609028000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"Though I believe there's a bunch of other parser changes too","msgtype":"m.text"},"ts":1375609069000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"oh?","msgtype":"m.text"},"ts":1375609238000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"ah yeah","msgtype":"m.text"},"ts":1375609257000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"Ms2ger: just raised https://bugzilla.mozilla.org/show_bug.cgi?id=901319 for the AAA change","msgtype":"m.text"},"ts":1375609469000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"Thanks","msgtype":"m.text"},"ts":1375609487000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"okay this is like the third site i've seen that tries to keep me from pasting my email address in","msgtype":"m.text"},"ts":1375629009000,"senderName":"zewt","senderId":"zewt@irc"},
{"content":{"body":"i don't know why but i'm still surprised by the imaginative ways people are complete idiots","msgtype":"m.text"},"ts":1375629045000,"senderName":"zewt","senderId":"zewt@irc"},
{"content":{"body":"there's a fascinating one: submitting a form on a website broke because I had a newline in a textarea, with a \"JSON.parse: bad control character in string literal\" error","msgtype":"m.text"},"ts":1375633083000,"senderName":"zewt","senderId":"zewt@irc"},
{"content":{"body":"so I can only guess that somebody out there is actually constructing JSON by going '\"' + text + '\"'","msgtype":"m.text"},"ts":1375633112000,"senderName":"zewt","senderId":"zewt@irc"},
{"content":{"body":"Surprise level: 0.","msgtype":"m.text"},"ts":1375633708000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"yep. heh","msgtype":"m.text"},"ts":1375633793000,"senderName":"zewt","senderId":"zewt@irc"},
{"content":{"body":"there must be space between doctype and html element?","msgtype":"m.text"},"ts":1375643759000,"senderName":"teoss","senderId":"teoss@irc"},
{"content":{"body":"teoss: No, there's no need. But note that the DOCTYPE is the whole string, \"<!doctype html>\"; any html start tag must follow that.","msgtype":"m.text"},"ts":1375644013000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"yep thanks gsnedders  but here I think it says I must put white space? http://www.w3.org/html/wg/drafts/html/master/syntax.html#syntax-doctype","msgtype":"m.text"},"ts":1375644083000,"senderName":"teoss","senderId":"teoss@irc"},
{"content":{"body":"teoss: No, it says nothing about what comes after the DOCTYPE, just the syntax of the DOCTYPE itself.","msgtype":"m.text"},"ts":1375644187000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"yes sorry gsnedders I ment affter html in doctype there must be space? like this: <!doctype html > or it can like this> <!doctype html> ?","msgtype":"m.text"},"ts":1375644520000,"senderName":"teoss","senderId":"teoss@irc"},
{"content":{"body":"teoss: As I said, there's no html element there. And the spec says \"Zero or more space characters\" after the \"html\", so zero space characters is fine.","msgtype":"m.text"},"ts":1375644588000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"ah yes zero or more lol","msgtype":"m.text"},"ts":1375644621000,"senderName":"teoss","senderId":"teoss@irc"},
{"content":{"body":"ok thanks and sorry","msgtype":"m.text"},"ts":1375644625000,"senderName":"teoss","senderId":"teoss@irc"},
{"content":{"body":"gsnedders, can I put paragraph in paragraph?","msgtype":"m.text"},"ts":1375644635000,"senderName":"teoss","senderId":"teoss@irc"},
{"content":{"body":"teoss: Only in XHTML, though why do you want to?","msgtype":"m.text"},"ts":1375644795000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"web page is valid without head and body elements?","msgtype":"m.text"},"ts":1375657273000,"senderName":"teoss","senderId":"teoss@irc"}
]