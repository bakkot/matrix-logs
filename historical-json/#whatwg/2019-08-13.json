[
{"content":{"body":"annevk: Is there a standard way to escape , in header values? As in, if I want , to be considered part of a value, not separating multiple values","msgtype":"m.text"},"ts":1565698237000,"senderName":"JakeA","senderId":"JakeA@irc"},
{"content":{"body":"JakeA: use quotes","msgtype":"m.text"},"ts":1565699560000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"JakeA: quoted string, that is","msgtype":"m.text"},"ts":1565699565000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"JakeA: and the quoted string parser from Fetch","msgtype":"m.text"},"ts":1565699574000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"ta!","msgtype":"m.text"},"ts":1565699741000,"senderName":"JakeA","senderId":"JakeA@irc"},
{"content":{"body":"JakeA: so we're kinda stuck with Background Sync btw and I guess a similar thing applies to Background Fetch","msgtype":"m.text"},"ts":1565699787000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: Because of https://github.com/WICG/BackgroundSync/issues/152?","msgtype":"m.text"},"ts":1565699870000,"senderName":"JakeA","senderId":"JakeA@irc"},
{"content":{"body":"JakeA: and for Background Sync it also seems there's not much uptake so it's a bit unclear how much to invest","msgtype":"m.text"},"ts":1565699875000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"JakeA: well, the issues mentioned therein, not the note ðŸ˜ƒ","msgtype":"m.text"},"ts":1565699891000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"(I'll try to dig up some stats on bg sync)","msgtype":"m.text"},"ts":1565700047000,"senderName":"JakeA","senderId":"JakeA@irc"},
{"content":{"body":"annevk: Is the issue that Firefox would like to show a permission prompt on first usage? I think background fetch has that covered, unless I'm missing something","msgtype":"m.text"},"ts":1565700140000,"senderName":"JakeA","senderId":"JakeA@irc"},
{"content":{"body":"JakeA: we're not sure there's sufficient value for a prompt or what exactly the prompt would say","msgtype":"m.text"},"ts":1565700335000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: I get it with bg sync, but Firefox already allows downloads without prompts, so I don't see the issue with bg fetch","msgtype":"m.text"},"ts":1565700401000,"senderName":"JakeA","senderId":"JakeA@irc"},
{"content":{"body":"JakeA: I might have missed how bg fetch is different from bg sync","msgtype":"m.text"},"ts":1565700504000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"JakeA: I guess bg fetch is effectively keepalive + storage?","msgtype":"m.text"},"ts":1565700563000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"JakeA: it might be diff then","msgtype":"m.text"},"ts":1565700575000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"JakeA: might also benefit of a name that more clearly illustrates that","msgtype":"m.text"},"ts":1565700594000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: bg fetch is more like `Content-Disposition: attachment`, in terms of resuming, visibility, user control. The difference is the developer has a little more control over what appears in the download notification (eg an icon), and the result isn't written to a place of the user's choosing, it goes into origin storage","msgtype":"m.text"},"ts":1565700687000,"senderName":"JakeA","senderId":"JakeA@irc"},
{"content":{"body":"annevk: If naming is the blocker I'm sure we can do something about that, if we can get consensus around an alternative","msgtype":"m.text"},"ts":1565700735000,"senderName":"JakeA","senderId":"JakeA@irc"},
{"content":{"body":"JakeA: do browsers resume downloads after a connection is cut and the new connection is from a different wi-fi spot?","msgtype":"m.text"},"ts":1565700927000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"JakeA: if they do that kinda seems problematic to me","msgtype":"m.text"},"ts":1565700954000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"JakeA: cause you could just start a slow download and track the user as they travel around","msgtype":"m.text"},"ts":1565700990000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: I haven't tested across wifi spots (https://resumable-downloads-test.glitch.me/ might be useful here). But there's a sticky notification throughout the download.","msgtype":"m.text"},"ts":1565701282000,"senderName":"JakeA","senderId":"JakeA@irc"},
{"content":{"body":"annevk: We see ~2.5 billion/week uses of bg sync fwiw","msgtype":"m.text"},"ts":1565701309000,"senderName":"JakeA","senderId":"JakeA@irc"},
{"content":{"body":"JakeA: Firefox does show a prompt for the download there to me","msgtype":"m.text"},"ts":1565701423000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"JakeA: I guess that means a few popular sites have to use it, if there was some way to talk to them about a flow that involves a dialog that'd be good","msgtype":"m.text"},"ts":1565701510000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: I get a prompt on Desktop, but I think it's configurable. The bg fetch spec supports starting downloads in a \"paused\" state, so this behaviour is fully compatible (aside from asking the user where to save the file)","msgtype":"m.text"},"ts":1565701760000,"senderName":"JakeA","senderId":"JakeA@irc"},
{"content":{"body":"annevk: The reason it starts in a paused state, rather than using a permission prompt, is it means the download can be accepted after the page has closed","msgtype":"m.text"},"ts":1565701793000,"senderName":"JakeA","senderId":"JakeA@irc"},
{"content":{"body":"JakeA: yeah so with explicit UI there's much less of an issue for bg fetch, but maybe it shouldn't be \"background\" then ðŸ˜ƒ","msgtype":"m.text"},"ts":1565701874000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"JakeA: anyway, thanks for the personal explanation, much appreciated","msgtype":"m.text"},"ts":1565701894000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: that's fair. It's 'background' because it doesn't require any active client to complete. Maybe naming similar to keepalive is better? Renaming and aliasing until usage drops doesn't feel like a huge deal if we can all agree on a new name","msgtype":"m.text"},"ts":1565701976000,"senderName":"JakeA","senderId":"JakeA@irc"},
{"content":{"body":"JakeA: \"Origin Downloads\" is a thing that popped into my head, but not sure how great that is","msgtype":"m.text"},"ts":1565702025000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: They can be cross-origin URLs though (as long as they're CORS)","msgtype":"m.text"},"ts":1565702051000,"senderName":"JakeA","senderId":"JakeA@irc"},
{"content":{"body":"JakeA: I'm also not sure if we need to rename APIs for this and to what extent Fx wants to implement at this point (I'd need to ask around a bit more)","msgtype":"m.text"},"ts":1565702062000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"JakeA: I meant Origin for the destination, but I see how that's confusing","msgtype":"m.text"},"ts":1565702080000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"JakeA: maybe Storage Downloads then","msgtype":"m.text"},"ts":1565702087000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: I've avoided 'downloads' because it can also be used to eg upload a gallery of images. Naming is hard.","msgtype":"m.text"},"ts":1565702129000,"senderName":"JakeA","senderId":"JakeA@irc"},
{"content":{"body":"JakeA: and in that case there's no storage happening either?","msgtype":"m.text"},"ts":1565702266000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: The storage part of bg fetch is only for the duration of the fetch, once the fetch is complete it goes \"here's your responses\" and if you don't do anything with them, they're gone.","msgtype":"m.text"},"ts":1565702361000,"senderName":"JakeA","senderId":"JakeA@irc"},
{"content":{"body":"JakeA: but I assume you tell it ahead of time what to do?","msgtype":"m.text"},"ts":1565702399000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: you give it the requests ahead of time, but you don't say what happens with the responses until the \"complete\" event","msgtype":"m.text"},"ts":1565702447000,"senderName":"JakeA","senderId":"JakeA@irc"},
{"content":{"body":"JakeA: oh, so code is run, hmm","msgtype":"m.text"},"ts":1565702474000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: yeah, that's true. If that's a sticking point we could look at stuff like deferring that event until the user revisits the site. That might be doable.","msgtype":"m.text"},"ts":1565702521000,"senderName":"JakeA","senderId":"JakeA@irc"},
{"content":{"body":"I'm not sure if it is","msgtype":"m.text"},"ts":1565702571000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"JakeA: why not only have this and also have bg sync?","msgtype":"m.text"},"ts":1565702581000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: bg sync is invisible, but won't stay alive long enough for larger fetches","msgtype":"m.text"},"ts":1565702638000,"senderName":"JakeA","senderId":"JakeA@irc"},
{"content":{"body":"annevk: I guess you could still use bg fetch for posting a chat message, but maybe a notification is overkill?","msgtype":"m.text"},"ts":1565702679000,"senderName":"JakeA","senderId":"JakeA@irc"},
{"content":{"body":"JakeA: the problem is the \"evil\" sites","msgtype":"m.text"},"ts":1565702783000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"JakeA: if we always had visual UI for activity beyond the lifetime of a tab I think the whole thing is much more acceptable","msgtype":"m.text"},"ts":1565702822000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"JakeA: if the user closes mail.example and sees that bar (or something appear) that'd likely be fine with them and if it appears after visiting game.example they might close it down","msgtype":"m.text"},"ts":1565702876000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"JakeA: this also makes it fully transparent when sites are using your battery or are potentially tracking you, which bg sync fails at","msgtype":"m.text"},"ts":1565702926000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"JakeA: I rather like those aspects","msgtype":"m.text"},"ts":1565702943000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: it seems reasonable for UAs to show a notification or something while there's a pending bg sync from an origin. Also seems reasonable for that notification to be cancellable. But yeah, it starts to merge with bg fetch at that point. Might not be a bad thing.","msgtype":"m.text"},"ts":1565703039000,"senderName":"JakeA","senderId":"JakeA@irc"},
{"content":{"body":"Yeah, not sure we need both though","msgtype":"m.text"},"ts":1565703159000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: if I had to pick one for Moz to implement, it'd be bg fetch, especially if a notification would be used for both.","msgtype":"m.text"},"ts":1565703243000,"senderName":"JakeA","senderId":"JakeA@irc"},
{"content":{"body":"Yeah, in terms of how that works it seems much more aligned with how Mozilla \"thinks\" about these kind of things","msgtype":"m.text"},"ts":1565703421000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: ping on https://github.com/whatwg/html/pull/4759 review, should be pretty straightforward","msgtype":"m.text"},"ts":1565719520000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Domenic: I cannot r+ from here, but looks good","msgtype":"m.text"},"ts":1565720412000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Domenic: does seem like we need an abstraction for hyperlink elements as we also forgot SVG a for :link and such right?","msgtype":"m.text"},"ts":1565720487000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Yeah, I mean, it's kind of unclear how much of that is our responsibility, but that's probably the right move","msgtype":"m.text"},"ts":1565720530000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"I doubt anyone else will take it on, but that would be nice","msgtype":"m.text"},"ts":1565724888000,"senderName":"annevk","senderId":"annevk@irc"}
]