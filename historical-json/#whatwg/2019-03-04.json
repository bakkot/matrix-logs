[
{"content":{"body":"nox: Yes, the manifest is a good RIIR candidate and I started doing that (in a half-hearted way) at some point. But jdm's point is also true; we would either need to keep the Python stuff working or have a really good story for how to make it work for users (and projects) without rustc","msgtype":"m.text"},"ts":1551699782000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"Does the manifest file format change often?","msgtype":"m.text"},"ts":1551699803000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"It's not documented, though.","msgtype":"m.text"},"ts":1551699817000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"If you are still seeing dozens of seconds to work out it has nothing to do then give us a profile please because dozens seems high; it should be under 5","msgtype":"m.text"},"ts":1551699819000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"(on reasonable but not exceptional hardware)","msgtype":"m.text"},"ts":1551699836000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"nox: Not often but ocasionally. gsnedders is doing some (Python) perf work on it at the moment","msgtype":"m.text"},"ts":1551699876000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"nox: (although based on the rest of your timeline I guess really if we'd just written it in lisp that would have solved all our problems)","msgtype":"m.text"},"ts":1551699965000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"LOL","msgtype":"m.text"},"ts":1551699973000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"jgraham: Yeah I had not realised it's way faster than it used to be now, I checked that a few days after my initial tweet and forgot to follow-up.","msgtype":"m.text"},"ts":1551700001000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"nox: OK. I am kind of hoping we find time to replace the HTML parsing parts with html5ever at some point, so we might need to figure out the rust dependency thing anyway (but that can probably be a binary wheel, which I hope porjects can cope with). But yeah it's generally accepted that the performance of that tool is bad and also important","msgtype":"m.text"},"ts":1551700285000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"jgraham: AFAIK TabAtkins doesn't think we can use html5ever given they want to mix HTML and Markdown parsing in one pass and whatnot.","msgtype":"m.text"},"ts":1551700346000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"nox: Yeah, for Bikeshed it's probably harder than for the manifest itself","msgtype":"m.text"},"ts":1551700390000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"Ah right, I'm mixing stuff.","msgtype":"m.text"},"ts":1551700407000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"whatâ€™s a binary wheel?","msgtype":"m.text"},"ts":1551700415000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"(but the distribution requirements on bikeshed are also pretty different since no one is using it in CI afaik)","msgtype":"m.text"},"ts":1551700418000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"MikeSmith: A Python thing for distributing precompiled binaries","msgtype":"m.text"},"ts":1551700440000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"ah OK","msgtype":"m.text"},"ts":1551700448000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"littledan: since we were talking about PR habits earlier, why do you force push a lot?","msgtype":"m.text"},"ts":1551702710000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: Oh, sorry about this, would you prefer a follow-on PR?","msgtype":"m.text"},"ts":1551702723000,"senderName":"littledan","senderId":"littledan@irc"},
{"content":{"body":"I guess it's because, in TC39, they don't end up squashing the patches, and it shows up poorly in the commit history if I don't squash them in advance","msgtype":"m.text"},"ts":1551702746000,"senderName":"littledan","senderId":"littledan@irc"},
{"content":{"body":"annevk: What would you prefer to make it easy to review?","msgtype":"m.text"},"ts":1551702754000,"senderName":"littledan","senderId":"littledan@irc"},
{"content":{"body":"not follow-on PR, but rather a stacked patch","msgtype":"m.text"},"ts":1551702769000,"senderName":"littledan","senderId":"littledan@irc"},
{"content":{"body":"littledan: in WHATWG land we squash (or rebase & merge in exceptional cases) and generally do \"feedback/nit/typo\" commits following the initial one","msgtype":"m.text"},"ts":1551702799000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"littledan: in the PR, so that the reviewer can review deltas","msgtype":"m.text"},"ts":1551702813000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"right, makes sense, I'll switch to that","msgtype":"m.text"},"ts":1551702823000,"senderName":"littledan","senderId":"littledan@irc"},
{"content":{"body":"thanks for explaining","msgtype":"m.text"},"ts":1551702826000,"senderName":"littledan","senderId":"littledan@irc"},
{"content":{"body":"and sorry for the noise","msgtype":"m.text"},"ts":1551702832000,"senderName":"littledan","senderId":"littledan@irc"},
{"content":{"body":"no worries","msgtype":"m.text"},"ts":1551702840000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"jgraham, nox: also manifest regen isn't a huge deal, IMO, because we rarely do a full rebuild of the manifest, and that's what's really slow","msgtype":"m.text"},"ts":1551702863000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"I really wonder why they prefer merge commits. Linear history is so nice...","msgtype":"m.text"},"ts":1551702871000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"(in TC39)","msgtype":"m.text"},"ts":1551702875000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"yeah, I don't really know who \"they\" is there; the editor group has its calls very late, and they don't seem to be publishing their notes or rationale anywhere. They've pushed back against people who raised these kinds of concerns.","msgtype":"m.text"},"ts":1551702909000,"senderName":"littledan","senderId":"littledan@irc"},
{"content":{"body":"we used to do that","msgtype":"m.text"},"ts":1551702923000,"senderName":"littledan","senderId":"littledan@irc"},
{"content":{"body":"jgraham, nox: and html5ever still has the problem of being UTF-8 only","msgtype":"m.text"},"ts":1551702980000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"gsnedders: sounds like a feature to me","msgtype":"m.text"},"ts":1551703103000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"gsnedders: though I guess not for parsing tests if that's the goal here ðŸ˜ƒ","msgtype":"m.text"},"ts":1551703120000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: as long as web-platform-tests needs to test documents in other encodings, which it likely does as long as we support other encodingsâ€¦","msgtype":"m.text"},"ts":1551703133000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"annevk: and probably not great for web compat in Servo either :)","msgtype":"m.text"},"ts":1551703145000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"littledan: okay, hopefully they'll elaborate in response to your question; if not I'll try to help out by prodding too","msgtype":"m.text"},"ts":1551703160000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"gsnedders: Yeah it needs some rework to be able to cope with other encodings :(","msgtype":"m.text"},"ts":1551703205000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"yeah, thanks","msgtype":"m.text"},"ts":1551703239000,"senderName":"littledan","senderId":"littledan@irc"},
{"content":{"body":"notices \"document family\" in HTML","msgtype":"m.emote"},"ts":1551710529000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Domenic: so a Window object needs to hold a reference to a WindowProxy object","msgtype":"m.text"},"ts":1551712596000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"This seems likely","msgtype":"m.text"},"ts":1551712607000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Domenic: otherwise someWindowObject.self crashes (it currently does in the spec)","msgtype":"m.text"},"ts":1551712616000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"(can crash, when browsing context is null)","msgtype":"m.text"},"ts":1551712634000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"I think at least some browsers will return null or undefined for that.","msgtype":"m.text"},"ts":1551712698000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Domenic: right you are","msgtype":"m.text"},"ts":1551712751000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"I guess there's a bigger question of what happens to someWindowObject's [[Window]] internal slot on BC discard","msgtype":"m.text"},"ts":1551712763000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"In some browsers I think they null it out and start returning undefined/null all over the place","msgtype":"m.text"},"ts":1551712772000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"But in others not so much","msgtype":"m.text"},"ts":1551712778000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Domenic: nulling that seems fine since there should be no way to get to it?","msgtype":"m.text"},"ts":1551712790000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Well if you null [[Window]] then e.g. someWindowObject.Array is undefined","msgtype":"m.text"},"ts":1551712812000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"oh wait, no, that's not fine","msgtype":"m.text"},"ts":1551712813000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Which might be the case in Safari IIRC","msgtype":"m.text"},"ts":1551712823000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"But this is treading close to an area where I recall Edge saying that it was web-interop-pain for them being over-aggressive on cutting references.","msgtype":"m.text"},"ts":1551712844000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"I guess that warrants further testing","msgtype":"m.text"},"ts":1551712858000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"I'm now -1 on adding a ref from Window to WindowProxy though; I'd like to see Firefox return null for self/frames/window","msgtype":"m.text"},"ts":1551712880000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Seems nice, although unclear how much it helps in general","msgtype":"m.text"},"ts":1551712911000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Because if you have someOtherWindowObject you're holding on to the WindowProxy anyway.","msgtype":"m.text"},"ts":1551712937000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"yeah, it's just one pointer less","msgtype":"m.text"},"ts":1551713009000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: so what is stopping us from saying `fetch(\"https://example.com/\", { credentials: \"omit\" })`, i.e. no-credentials HTTPS fetches, can return non-opaque responses with no CORS needed?","msgtype":"m.text"},"ts":1551729383000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Domenic: secrets in intranets with IP-based access?","msgtype":"m.text"},"ts":1551732615000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"That are accessible over https://?","msgtype":"m.text"},"ts":1551732628000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Not sure","msgtype":"m.text"},"ts":1551732680000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"Domenic: maybe nothing eventually, depends a bit on how things play out and whether that is indeed as secure as I hope it is","msgtype":"m.text"},"ts":1551734752000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"That'd be crazy... all these years making developers deal with CORS and they could have just done that...","msgtype":"m.text"},"ts":1551734780000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Domenic: well, itâ€™s complicated","msgtype":"m.text"},"ts":1551734803000,"senderName":"annevk","senderId":"annevk@irc"}
]