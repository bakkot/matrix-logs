[
{"content":{"body":"Hmm, still no review","msgtype":"m.text"},"ts":1446536246000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"jgraham: https://github.com/w3c/web-platform-tests/pull/2283","msgtype":"m.text"},"ts":1446538969000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"jgraham: changes seem correct","msgtype":"m.text"},"ts":1446539016000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: You don't have the ability to merge?","msgtype":"m.text"},"ts":1446540721000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"jgraham: no","msgtype":"m.text"},"ts":1446540742000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: Fixed that, thanks for the review","msgtype":"m.text"},"ts":1446540796000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"annevk: Domenic: do you have an objection to changing the return value for add() in https://www.w3.org/Bugs/Public/show_bug.cgi?id=29061 ?","msgtype":"m.text"},"ts":1446546284000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"is not convinced","msgtype":"m.emote"},"ts":1446546572000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"Ms2ger: why not?","msgtype":"m.text"},"ts":1446546839000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"zcorpan: the known tokens approach seems better","msgtype":"m.text"},"ts":1446547681000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: pointer to that approach?","msgtype":"m.text"},"ts":1446547749000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"yoav: it's explained in the issue","msgtype":"m.text"},"ts":1446547763000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"So the approach outlined in comment 8?","msgtype":"m.text"},"ts":1446547833000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"annevk: it makes legacy browsers go into the \"supported\" branch","msgtype":"m.text"},"ts":1446547908000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"iframe.sandbox.add('foo'); /* ignore */ if (iframe.sandbox.has('foo')) { /* supported, or legacy browser */ }","msgtype":"m.text"},"ts":1446548048000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"i don't mind doing what comment 8 says (sans throwing), but it seems nice to have legacy browsers go into the unsupported branch, which is what boolean return value for add() does","msgtype":"m.text"},"ts":1446548164000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"i.e. if (iframe.sandbox.add('foo')) { /* supported */ } else { /* unsupported or legacy browser */ }","msgtype":"m.text"},"ts":1446548215000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"+1 to the latter","msgtype":"m.text"},"ts":1446548293000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"zcorpan: the `toggle()` case https://dom.spec.whatwg.org/#dom-domtokenlist-toggle seems more complicated to handle then `add()`, since it already returns false in various cases","msgtype":"m.text"},"ts":1446548708000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"we could also add that it returns false when trying to add an invalid token","msgtype":"m.text"},"ts":1446548747000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"So add to https://dom.spec.whatwg.org/#dom-domtokenlist-toggle before step 4.2 \"if token is invalid, return false\"","msgtype":"m.text"},"ts":1446548832000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"so the semantic right now for toggle is to return false if the token was removed, and return true if it's added, afaict","msgtype":"m.text"},"ts":1446548889000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"maybe we should think about what remove() should do, and then toggle() becomes clearer what it should do","msgtype":"m.text"},"ts":1446548986000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"i think remove/contains don't need to validate. and toggle should then only validate just before adding, not for removing","msgtype":"m.text"},"ts":1446549065000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"but that is mostly arm-chair reasoning on my part. would be nice to walk though a real example that uses toggle","msgtype":"m.text"},"ts":1446549147000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"zcorpan: FWIW, I agree with your arm-chair reasoning","msgtype":"m.text"},"ts":1446549335000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"since if an invalid token would never get in, there's no point in validating on the way out","msgtype":"m.text"},"ts":1446549355000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"and for feature detection purposes, a single method is enough","msgtype":"m.text"},"ts":1446549382000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"I think it would be really weird if add() only worked on some strings","msgtype":"m.text"},"ts":1446549428000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"Btw, how does this scale to classList?","msgtype":"m.text"},"ts":1446549445000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"classList won't implement a validation algorithm, which means everything is valid","msgtype":"m.text"},"ts":1446549520000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"yoav: invalid things could get in from the html parser or .rel = 'foo bar'; or setAttribute and so on","msgtype":"m.text"},"ts":1446549695000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"zcorpan: good point","msgtype":"m.text"},"ts":1446549720000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"still, if all we need is feature detection (which is the use case at hand for both iframe and link), add/toggle would be enough","msgtype":"m.text"},"ts":1446549787000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"also, being unable to remove invalid values added elsewhere would be weird","msgtype":"m.text"},"ts":1446549844000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"Note that toggle already returns a boolean","msgtype":"m.text"},"ts":1446549903000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"Ms2ger: right","msgtype":"m.text"},"ts":1446550096000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"only finds test cases using toggle()","msgtype":"m.emote"},"ts":1446550272000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"so back at the armchair, the boolean return value would be consistent with current toggle: if the token is added, return true, otherwise return false","msgtype":"m.text"},"ts":1446550415000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"and we only add the token in add() and toggle() if it's valid","msgtype":"m.text"},"ts":1446550432000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"Why?","msgtype":"m.text"},"ts":1446550457000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"I think that would be very surprising, and I'm not convinced it","msgtype":"m.text"},"ts":1446550514000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"'d be compatible","msgtype":"m.text"},"ts":1446550519000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"so that you can check if a keyword is supported, and have current browsers fall into the \"unsupported\" branch","msgtype":"m.text"},"ts":1446550527000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"That's what the return value is for","msgtype":"m.text"},"ts":1446550554000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"I don't see a use case for dropping the token on the floor too","msgtype":"m.text"},"ts":1446550568000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"Ms2ger: oh, do you just find the validation thing surprising?","msgtype":"m.text"},"ts":1446550573000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"ok","msgtype":"m.text"},"ts":1446550579000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"i can live with that, but anne and dominic argued for that, to be consistent with \"limited to only known values\"","msgtype":"m.text"},"ts":1446550607000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"Doesn't that still setAttribute()?","msgtype":"m.text"},"ts":1446550739000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"pulls up the spec","msgtype":"m.emote"},"ts":1446550749000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"parse error","msgtype":"m.emote"},"ts":1446550758000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"\"and on setting, the content attribute must be set to the specified new value.\"","msgtype":"m.text"},"ts":1446550772000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"So what I suggested is more in line with \"limited to only known values\"","msgtype":"m.text"},"ts":1446550800000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"....yes, yes you're right","msgtype":"m.text"},"ts":1446550817000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"Ms2ger: makes sense to me","msgtype":"m.text"},"ts":1446551685000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"Always nice if existing practice agrees with you :)","msgtype":"m.text"},"ts":1446551736000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"should DOMTokenList be ascii-case-insensitive for <link rel> and <iframe sandbox>?","msgtype":"m.text"},"ts":1446554961000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"And classList in quirks?","msgtype":"m.text"},"ts":1446555496000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"Ms2ger: not really sure if that is more in line","msgtype":"m.text"},"ts":1446556067000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Ms2ger: perhaps if you're only comparing the setter and add()","msgtype":"m.text"},"ts":1446556090000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"These seem the relevant things to compare","msgtype":"m.text"},"ts":1446556179000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"Ms2ger: so would then compare the getter with the iterator?","msgtype":"m.text"},"ts":1446556314000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Ms2ger: it's a rather incomplete model","msgtype":"m.text"},"ts":1446556349000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Sure","msgtype":"m.text"},"ts":1446556384000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"But there doesn't seem to be much precedent for dropping changes to content attributes","msgtype":"m.text"},"ts":1446556430000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"It just wouldn't propagate to the content attribute","msgtype":"m.text"},"ts":1446556446000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"There isn't much precedent for this kind of API either way","msgtype":"m.text"},"ts":1446556473000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Took a stab at adding the hooks: https://github.com/whatwg/dom/pull/103","msgtype":"m.text"},"ts":1446556919000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"yoav: I think only doing something with add() is really weird","msgtype":"m.text"},"ts":1446558893000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: do you think we need to add something similar to toggle()?","msgtype":"m.text"},"ts":1446558938000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"or also remove and contains?","msgtype":"m.text"},"ts":1446558946000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"I can think of a way to easily add a false return for toggle, less so for remove and contains","msgtype":"m.text"},"ts":1446558988000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"yoav: the other problem I see is that this doesn't deal with case-sensitivity","msgtype":"m.text"},"ts":1446559078000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: yeah, I saw the discussion here after I sent the PR. I'll add case sensitivity to the validation algo","msgtype":"m.text"},"ts":1446559221000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"But in general this design just seems rather weird","msgtype":"m.text"},"ts":1446559284000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: something in particular that bothers you, outside of the issues you already mentioned?","msgtype":"m.text"},"ts":1446559376000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"gotta go now, but will check logs in a short while","msgtype":"m.emote"},"ts":1446559395000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"yoav: I can't quite put my finger on it :-/","msgtype":"m.text"},"ts":1446559401000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Something with having this new internal slot and only add() using it for a return value that indicates support and not wether something got added or not","msgtype":"m.text"},"ts":1446559458000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"It just seems rather confusing","msgtype":"m.text"},"ts":1446559463000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"And by not tying that \"supported list\" to values that can actually be added there's a fair chance implementations will not keep the two in lockstep","msgtype":"m.text"},"ts":1446559521000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Which the getter/setter design of \"known values\" does not have in the slightest","msgtype":"m.text"},"ts":1446559565000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"wanderview: good morning!","msgtype":"m.text"},"ts":1446561784000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"wanderview: and also: https://github.com/whatwg/fetch/pull/146 😊","msgtype":"m.text"},"ts":1446561796000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: looking","msgtype":"m.text"},"ts":1446561957000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"wanderview: ta","msgtype":"m.text"},"ts":1446562435000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"np... kind of nit picky I guess","msgtype":"m.text"},"ts":1446562450000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"wanderview: nooo I think you found a problem","msgtype":"m.text"},"ts":1446562459000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: did you guys ever get to discuss foreign fetch at tpac?","msgtype":"m.text"},"ts":1446562530000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"annevk: ms2ger raised concerns that changing the behavior of \"add()\" is likely to result in web compat issues https://www.w3.org/Bugs/Public/show_bug.cgi?id=29061#c17","msgtype":"m.text"},"ts":1446562626000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"I'm fine with it either way","msgtype":"m.text"},"ts":1446562642000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"wanderview: we did briefly","msgtype":"m.text"},"ts":1446562733000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Not sure about \"likely\", just \"more likely\"","msgtype":"m.text"},"ts":1446562737000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"wanderview: but not in detail","msgtype":"m.text"},"ts":1446562737000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"hsivonen: https://twitter.com/ken_lunde/status/661351862155669506","msgtype":"m.text"},"ts":1446565039000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: so basically the f2f was still focused on \"v1\" things?","msgtype":"m.text"},"ts":1446565123000,"senderName":"wanderview","senderId":"wanderview@irc"},
{"content":{"body":"wanderview: yes","msgtype":"m.text"},"ts":1446565138000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: :-(","msgtype":"m.text"},"ts":1446566592000,"senderName":"hsivonen","senderId":"hsivonen@irc"},
{"content":{"body":"wonders how to sanely UA sniff IE9–11","msgtype":"m.emote"},"ts":1446570356000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Purely visual bug, so no way to check it. <_<","msgtype":"m.text"},"ts":1446570371000,"senderName":"gsnedders","senderId":"gsnedders@irc"}
]