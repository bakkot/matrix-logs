[
{"content":{"body":"I assume https://html.spec.whatwg.org/multipage/browsers.html#auxiliary-browsing-context means in practice something like there is opener relationship","msgtype":"m.text"},"ts":1589889560000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"\"are related to\" without any linking is a tad vague","msgtype":"m.text"},"ts":1589889602000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"smaug____: yeah, popups","msgtype":"m.text"},"ts":1589891033000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"smaug____: including <a target=test>","msgtype":"m.text"},"ts":1589891042000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"and noopener is supposed to break that relation?","msgtype":"m.text"},"ts":1589891070000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"smaug____: noopener causes a new top-level browsing context to be created, which doesn't have the field","msgtype":"m.text"},"ts":1589891115000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"smaug____: see rules for choosing a browsing context or some such","msgtype":"m.text"},"ts":1589891127000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"\"the field\" ?","msgtype":"m.text"},"ts":1589891142000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"smaug____: the opener field","msgtype":"m.text"},"ts":1589891148000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"right, but https://html.spec.whatwg.org/multipage/browsers.html#auxiliary-browsing-context doesn't talk about that","msgtype":"m.text"},"ts":1589891159000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"no, that's just at type definition","msgtype":"m.text"},"ts":1589891186000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"a*","msgtype":"m.text"},"ts":1589891190000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: I assume https://github.com/whatwg/html/pull/5560 (Storage refactor) is not yet ready for review?","msgtype":"m.text"},"ts":1589906267000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Domenic: it doesn't actually call into the Storage Standard yet for a bottle map and doesn't clone sessionStorage data across browsing sessions, apart from that I consider it good","msgtype":"m.text"},"ts":1589906856000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Should I wait on those parts, or would it make sense to land in stages?","msgtype":"m.text"},"ts":1589906881000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Domenic: I don't think we can land, but if you feel like you can review already that might help","msgtype":"m.text"},"ts":1589906899000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Domenic: I hope that given how I layered things those to be fairly incremental commits","msgtype":"m.text"},"ts":1589906919000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"The one interesting architectural question I noticed is how much tasks we should use when broadcasting. If a bunch of tasks end up running in the same agent, should they be one task? (Not sure if it's observable though as these are event callbacks when the stack is empty. But I guess you can tell if they got interleaved.)","msgtype":"m.text"},"ts":1589908047000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"I would like to specify some algorithms in terms of streams (have some other spec provide a readable stream to my algorithm, apply some transformations to that, and eventually expose the output of that through some non-stream API). But I'm not sure if this actually makes sense, or if this will be very weird since all the streams algorithm operate on actual javascript objects...","msgtype":"m.text"},"ts":1589908067000,"senderName":"Mek","senderId":"Mek@irc"},
{"content":{"body":"Mek: does the other spec provide a `ReadableStream`, or a conceptual \"readable stream\"?","msgtype":"m.text"},"ts":1589908249000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"neither part is written yet, but my idea is that it will provide a conceptual \"readable stream\". I.e. it'll define some way of producing data.","msgtype":"m.text"},"ts":1589908296000,"senderName":"Mek","senderId":"Mek@irc"},
{"content":{"body":"In that case I would avoid using the Streams Standard machinery, as the JS objects aspects of it will cause you some pain.","msgtype":"m.text"},"ts":1589908327000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"We're cleaning that up a bit, but it's still not super-pleasant.","msgtype":"m.text"},"ts":1589908352000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"hmm, having to reinvent a lot of it will be somewhat painfull as well...","msgtype":"m.text"},"ts":1589908357000,"senderName":"Mek","senderId":"Mek@irc"},
{"content":{"body":"Well, how much would you reinvent?","msgtype":"m.text"},"ts":1589908376000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Like, if this is all behind the scenes, it feels like you could get away without needing too much...","msgtype":"m.text"},"ts":1589908388000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Mek: looking at Encoding and see if you could generalize that?","msgtype":"m.text"},"ts":1589908474000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"I would be willing to help with putting some of that into Infra","msgtype":"m.text"},"ts":1589908491000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"We've had other requests","msgtype":"m.text"},"ts":1589908502000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"looking at encoding gave me headaches trying to figure out what exactly it is doing (with streams-within-streams, i.e. every chunk in its encode algorithm is treated as another conceptual stream) :) But yeah, something like that perhaps...","msgtype":"m.text"},"ts":1589908572000,"senderName":"Mek","senderId":"Mek@irc"},
{"content":{"body":"Mek: I meant everything in this section: https://encoding.spec.whatwg.org/#terminology","msgtype":"m.text"},"ts":1589908618000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Mek: wrapping that in Streams doesn't seem like a concern you have","msgtype":"m.text"},"ts":1589908666000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"I don't think that quite works for what I want. I really want more of the \"pull algorithm\" style that streams provide. But I guess I can just have specs provide just the required algorithms rather than an actual stream.","msgtype":"m.text"},"ts":1589908687000,"senderName":"Mek","senderId":"Mek@irc"},
{"content":{"body":"(context, trying to define Blob read behavior better; in particular how IndexedDB (or Native File System) provides/invalidates data that can be read via a Blob.","msgtype":"m.text"},"ts":1589908717000,"senderName":"Mek","senderId":"Mek@irc"},
{"content":{"body":"Mek: maybe also look into the blob store scoping issue?","msgtype":"m.text"},"ts":1589908874000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"oh yes, sorry I forgot to reply to that","msgtype":"m.text"},"ts":1589908886000,"senderName":"Mek","senderId":"Mek@irc"},
{"content":{"body":"No good ideas for invalidation as I'm not very familiar unfortunately","msgtype":"m.text"},"ts":1589908911000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Mek: Chunks are not streams. You might be getting confused with how Encoding overloads the term \"stream\", though.","msgtype":"m.text"},"ts":1589909010000,"senderName":"andreubotella","senderId":"andreubotella@irc"},
{"content":{"body":"There was an issue about renaming it to \"token queues\" and moving it to Infra, which I thought I could take on, but now I can't find it.","msgtype":"m.text"},"ts":1589909078000,"senderName":"andreubotella","senderId":"andreubotella@irc"},
{"content":{"body":"andreubotella: yeah, that's what I meant. In the en/decode and enqueue a chunk algorithms, Encoding creates a conceptual stream out of the chunk (where the chunk was a chunk written to the actual WritableStream). And it took me a few readings to figure out there were two stream concepts.","msgtype":"m.text"},"ts":1589909108000,"senderName":"Mek","senderId":"Mek@irc"},
{"content":{"body":"andreubotella: be my guest ðŸ™‚; https://github.com/whatwg/encoding/issues/180","msgtype":"m.text"},"ts":1589909133000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: Oh, right. The title confused me.","msgtype":"m.text"},"ts":1589909159000,"senderName":"andreubotella","senderId":"andreubotella@irc"},
{"content":{"body":"thanks","msgtype":"m.text"},"ts":1589909160000,"senderName":"andreubotella","senderId":"andreubotella@irc"},
{"content":{"body":"like, a TextEncoderStream is a GenericTransformStream, but it also has a conceptual stream, and those are unrelated :)","msgtype":"m.text"},"ts":1589909161000,"senderName":"Mek","senderId":"Mek@irc"},
{"content":{"body":"andreubotella: although I think initially we should just keep it in Encoding until we have another more serious consumer","msgtype":"m.text"},"ts":1589909165000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"that makes sense","msgtype":"m.text"},"ts":1589909180000,"senderName":"andreubotella","senderId":"andreubotella@irc"},
{"content":{"body":"Mek: turtles all the way down","msgtype":"m.text"},"ts":1589909230000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Mek: I'm not as familiar with the stream parts of Encoding as with the rest, and that threw me off a bit ðŸ˜…","msgtype":"m.text"},"ts":1589909362000,"senderName":"andreubotella","senderId":"andreubotella@irc"},
{"content":{"body":"Yeah, encoding is not a paragon of clarity. Renaming will help.","msgtype":"m.text"},"ts":1589909717000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Well, I'm not sure I agree with that statement","msgtype":"m.text"},"ts":1589909797000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"I tend to think it's one of the more polished things we publish, but I'm biased ðŸ™‚","msgtype":"m.text"},"ts":1589909829000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Hmm yeah I think my complaints were misremembering... the problem is more in the fetch/streams interaction. https://github.com/whatwg/fetch/issues/661","msgtype":"m.text"},"ts":1589911473000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Oh right, but the problem is that encoding operations on \"streams\", but often specs feed it byte sequences.","msgtype":"m.text"},"ts":1589911503000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"The chunks in Encoding streams are code points for decoding and bytes for decoding.","msgtype":"m.text"},"ts":1589911807000,"senderName":"andreubotella","senderId":"andreubotella@irc"},
{"content":{"body":"The string â†’ \"stream\" of code points and byte sequence â†’ \"stream\" of bytes conversion is implicit and perhaps shouldn't be.","msgtype":"m.text"},"ts":1589911846000,"senderName":"andreubotella","senderId":"andreubotella@irc"},
{"content":{"body":"It's the opposite direction I'm particularly concerned with","msgtype":"m.text"},"ts":1589911976000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Since I believe encoding feeds things into the \"stream\"s of code points/bytes incrementally, but specs often expect them to be one-shot strings/byte sequences.","msgtype":"m.text"},"ts":1589912004000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"I guess, since I'm renaming \"streams\" in encoding#180, I could specify that strings/byte sequences can be converted into \"streams\" implicitly, but not vice versa.","msgtype":"m.text"},"ts":1589912181000,"senderName":"andreubotella","senderId":"andreubotella@irc"},
{"content":{"body":"That sounds great; it would also be good to write down what we think we would ultimately want in an issue to keep that in mind as things change","msgtype":"m.text"},"ts":1589912962000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"hmm, does wpt have some way to close a tab/window which can't be closed using window.close() ?","msgtype":"m.text"},"ts":1589913086000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"smaug____: let me know if you find out","msgtype":"m.text"},"ts":1589916396000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"smaug____: Not at the moment afaik, although I think it could","msgtype":"m.text"},"ts":1589916889000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"ok","msgtype":"m.text"},"ts":1589916904000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"smaug____: To elaborate a little, the problem is usually knowing which window to close","msgtype":"m.text"},"ts":1589923000000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"WebDriver specifies a way to serialize window handles, but afaik no one supports it yet","msgtype":"m.text"},"ts":1589923023000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"So you couldn't trivially do something like testdriver.close(window)","msgtype":"m.text"},"ts":1589923043000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"There could be some hack to make it work like adding a property on the window and then cycling through all of them until you find the one where the property exists","msgtype":"m.text"},"ts":1589923088000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"right","msgtype":"m.text"},"ts":1589923106000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"I was thinking some helper method in window object to forceClose it","msgtype":"m.text"},"ts":1589923117000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"Well we can also specify test-only apis of course but it feels like maybe overkill for this case","msgtype":"m.text"},"ts":1589923146000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"I keep meaning to figure out how to specify a test-only gc api for wpt","msgtype":"m.text"},"ts":1589923162000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"But so far didn't manage","msgtype":"m.text"},"ts":1589923170000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"away","msgtype":"m.emote"},"ts":1589923172000,"senderName":"jgraham","senderId":"jgraham@irc"}
]