[
{"content":{"body":"interesting. Blink leaks closed shadow DOM via focus event's relatedTarget","msgtype":"m.text"},"ts":1519690688000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"it also propagates focus event from shadow DOM","msgtype":"m.text"},"ts":1519690778000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"hayato: ^","msgtype":"m.text"},"ts":1519691051000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"some old Safari version has similar issues, but I should update my macbook (which I boot perhaps twice a year :)).","msgtype":"m.text"},"ts":1519691765000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"(except that apparently I can't update it. oh well)","msgtype":"m.text"},"ts":1519691954000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"discovers https://timothygu.me/es-howto/","msgtype":"m.emote"},"ts":1519695571000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"bravo TimothyGu","msgtype":"m.text"},"ts":1519695616000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"smaug____:  That's bad news for us. :( Could you share a test case?  Does it happen only for focus events?","msgtype":"m.text"},"ts":1519702206000,"senderName":"hayato","senderId":"hayato@irc"},
{"content":{"body":"I am assuming it is not spec's issue. It's the bug of the implementation.","msgtype":"m.text"},"ts":1519702229000,"senderName":"hayato","senderId":"hayato@irc"},
{"content":{"body":"Krinkle: it is","msgtype":"m.text"},"ts":1519710551000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: Thx, also, it seems it didn't actually switch protocols. Or at least I couldn't reproduce it.","msgtype":"m.text"},"ts":1519712191000,"senderName":"Krinkle","senderId":"Krinkle@irc"},
{"content":{"body":"So http:foo is the same as 'foo', and ignores http vs https.","msgtype":"m.text"},"ts":1519712206000,"senderName":"Krinkle","senderId":"Krinkle@irc"},
{"content":{"body":"Krinkle: oh yeah, that is right, no switch in scheme","msgtype":"m.text"},"ts":1519712639000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"gotta love Crockfordâ€™s commit message for the related change","msgtype":"m.text"},"ts":1519716249000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"https://github.com/douglascrockford/JSLint/commit/0e5065a51a7602499aa500c1db4125145f5dbeb3","msgtype":"m.text"},"ts":1519716256000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"one letter","msgtype":"m.text"},"ts":1519716259000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"That whole commit log is performance art","msgtype":"m.text"},"ts":1519716405000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"heh","msgtype":"m.text"},"ts":1519716413000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"And rather useless for future maintainers","msgtype":"m.text"},"ts":1519716414000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"style trumps utility","msgtype":"m.text"},"ts":1519716434000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"anyway I hope he can make time to write a new/updated essay about how to fix HTML","msgtype":"m.text"},"ts":1519716572000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"(speaking of performance art)","msgtype":"m.text"},"ts":1519716590000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"finds https://www.crockford.com/html/","msgtype":"m.emote"},"ts":1519716747000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"holy god itâ€™s been 10 years","msgtype":"m.text"},"ts":1519716791000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"hard to believe","msgtype":"m.text"},"ts":1519716794000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"definitely overdue for new one","msgtype":"m.text"},"ts":1519716863000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"I never realised until now that gzip eliminates the size argument against UTF-8. Obvious in retrospect.","msgtype":"m.text"},"ts":1519717666000,"senderName":"ricea","senderId":"ricea@irc"},
{"content":{"body":"It seems we did adopt that one, restricting things to UTF-8","msgtype":"m.text"},"ts":1519720454000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Although it's not enforced","msgtype":"m.text"},"ts":1519720471000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"ricea: btw, I'm in Tokyo most of next week; I don't think we need to discuss anything in person, but since I'll be at the Google office on Monday and Tuesday for the Web Components meeting maybe we should try and say hi","msgtype":"m.text"},"ts":1519720537000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"looks like Safari preview leaks closed shadow dom too via focus event's relatedTarget","msgtype":"m.text"},"ts":1519722795000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"or am I testing something wrong http://mozilla.pettay.fi/shadow_focus.html","msgtype":"m.text"},"ts":1519722801000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"smaug____: yeah, seems like a bug","msgtype":"m.text"},"ts":1519722987000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"happens in blink too","msgtype":"m.text"},"ts":1519723001000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"smaug____: you raised a bug against DOM too about that needing to be redesigned, right?","msgtype":"m.text"},"ts":1519723005000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"smaug____: that is, more computation ahead of time or some such","msgtype":"m.text"},"ts":1519723019000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"https://github.com/whatwg/dom/issues/562","msgtype":"m.text"},"ts":1519723041000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"hmm, was it about this","msgtype":"m.text"},"ts":1519723041000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"no","msgtype":"m.text"},"ts":1519723054000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"there is the issue related to touch.target","msgtype":"m.text"},"ts":1519723058000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"just related","msgtype":"m.text"},"ts":1519723060000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"I'm still trying to understand how focus should work","msgtype":"m.text"},"ts":1519723061000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"webkit and blink seem to do something very different what is in the specs","msgtype":"m.text"},"ts":1519723130000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"Sigh, I thought all this had tests","msgtype":"m.text"},"ts":1519723177000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Not enough I guess","msgtype":"m.text"},"ts":1519723186000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"smaug____: if there are no tests for this, feel free to file it as a whatwg/dom issue","msgtype":"m.text"},"ts":1519723212000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"well, relatedTarget should be just not exposing shadow DOM","msgtype":"m.text"},"ts":1519723237000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"and","msgtype":"m.text"},"ts":1519723238000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"where does it say that focus event is composed?","msgtype":"m.text"},"ts":1519723246000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"smaug____: I guess maybe there aren't tests because it's hard to automate these","msgtype":"m.text"},"ts":1519723250000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"perhaps I'm missing the latter thing somewhere","msgtype":"m.text"},"ts":1519723262000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"smaug____: it should be composed because it's a UI event, but not sure if that's explicitly stated atm","msgtype":"m.text"},"ts":1519723280000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"DOM spec explicitly says event shouldn't be composed by default","msgtype":"m.text"},"ts":1519723311000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"smaug____: yeah, I'll file a bug against HTML to make focus events composed","msgtype":"m.text"},"ts":1519723337000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"and https://html.spec.whatwg.org/multipage/interaction.html#fire-a-focus-event doesn't make focus event composed","msgtype":"m.text"},"ts":1519723348000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"thanks","msgtype":"m.text"},"ts":1519723354000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"smaug____: also added you to the whatwg/components team","msgtype":"m.text"},"ts":1519723540000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"k","msgtype":"m.text"},"ts":1519723552000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"whatever that means :)","msgtype":"m.text"},"ts":1519723561000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"smaug____: you get more GitHub notifications about custom elements / shadow tree related issues","msgtype":"m.text"},"ts":1519723646000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"(your welcome)","msgtype":"m.text"},"ts":1519723659000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"ðŸ˜›","msgtype":"m.text"},"ts":1519723670000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Hmm, now I'm reminded we still haven't defined focusin/out","msgtype":"m.text"},"ts":1519723707000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"there we'll need to follow the broken model now implemented I guess in all the engines","msgtype":"m.text"},"ts":1519723752000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"and not the reasonable model IE had","msgtype":"m.text"},"ts":1519723759000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"At least everyone agrees they are composed","msgtype":"m.text"},"ts":1519723923000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"smaug____: any idea why onfocusin/onfocusout do not exist?","msgtype":"m.text"},"ts":1519723969000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"perhaps because focusin/out bubble, but focus/blur don't","msgtype":"m.text"},"ts":1519724281000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"and onfoo are added to bubble phase","msgtype":"m.text"},"ts":1519724293000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"just guessing","msgtype":"m.text"},"ts":1519724297000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"might be confusing to get focusins/outs not targeted to your element using event handlers... I don't know.","msgtype":"m.text"},"ts":1519724361000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"I think we have lots of events like that which do have event handlers","msgtype":"m.text"},"ts":1519724412000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"This is probably just an oversight as they haven't been properly standardized thus far","msgtype":"m.text"},"ts":1519724433000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"well, I was thinking the focus not bubbling and focusin bubbling difference in particular, not random event handler","msgtype":"m.text"},"ts":1519724961000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"but yeah, dunno","msgtype":"m.text"},"ts":1519724965000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"smaug____: in Firefox if I invoke .focus() and then .remove() an element in the same task I don't seem to be getting both a focus and a blur event for it","msgtype":"m.text"},"ts":1519725255000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"smaug____: this works in Chrome (also fails in Safari)","msgtype":"m.text"},"ts":1519725265000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"there is existing bug, IIRC, to dispatch events if focused element is removed from DOM","msgtype":"m.text"},"ts":1519725307000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"okay","msgtype":"m.text"},"ts":1519725319000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"I guess I'll just use .blur() for now","msgtype":"m.text"},"ts":1519725324000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"smaug____: so in https://searchfox.org/mozilla-central/source/dom/base/nsFocusManager.cpp#2254 we dispatch focus/focusin and blur/focusout","msgtype":"m.text"},"ts":1519726638000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"smaug____: focus/blur are done as script runner so presumably fire later therefore","msgtype":"m.text"},"ts":1519726654000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"smaug____: are there any other effects of them being added as a script runner?","msgtype":"m.text"},"ts":1519726668000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"well, they don't technically fire sync, but just once the stack has unwound enough","msgtype":"m.text"},"ts":1519727262000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"but no, there shouldn't be other differences","msgtype":"m.text"},"ts":1519727269000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"except, if there are other scriptrunners waiting to be executed","msgtype":"m.text"},"ts":1519727288000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"smaug____: hmm, it seems focus fires before focusin","msgtype":"m.text"},"ts":1519727302000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"the model is all broken","msgtype":"m.text"},"ts":1519727320000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"isn't is explained in some github issue","msgtype":"m.text"},"ts":1519727328000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"smaug____: I guess https://w3c.github.io/uievents/#events-focusevent-event-order is not really implemented","msgtype":"m.text"},"ts":1519727330000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"https://github.com/w3c/uievents/issues/88","msgtype":"m.text"},"ts":1519727339000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"Thanks, I only knew about https://www.w3.org/Bugs/Public/show_bug.cgi?id=25897","msgtype":"m.text"},"ts":1519727348000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"I think we should just move all of focus into HTML","msgtype":"m.text"},"ts":1519727359000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"oh, maybe https://github.com/jquery/jquery/issues/3123","msgtype":"m.text"},"ts":1519727364000,"senderName":"smaug____","senderId":"smaug____@irc"},
{"content":{"body":"foolip: can you r+ https://github.com/w3c/web-platform-tests/pull/5188?","msgtype":"m.text"},"ts":1519742195000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"I'd love to cite \"Please leave your sense of logic at the door, thanks!\" with a preferred URL. Currently using https://blog.whatwg.org/","msgtype":"m.text"},"ts":1519749347000,"senderName":"csarven","senderId":"csarven@irc"},
{"content":{"body":"AFAIK, the statement is pretty old, but if anyone has a better URL, that'd be great","msgtype":"m.text"},"ts":1519749375000,"senderName":"csarven","senderId":"csarven@irc"},
{"content":{"body":"csarven: I don't think there's a canonical URL, it started here as a topic","msgtype":"m.text"},"ts":1519751021000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"(iirc)","msgtype":"m.text"},"ts":1519751024000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"zcorpan: about https://github.com/validator/validator/issues/195, whatâ€™s the expected result for checking <input pattern=\"foo\\'bar\" name=x>","msgtype":"m.text"},"ts":1519751184000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"mathiasbynens: you're the regex expert :D ^","msgtype":"m.text"},"ts":1519751285000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"MikeSmith: \"ES6 requires more strict syntax when \"u\" flag is specified for RegExp (see the difference between [+U] and [~U] there), and it rejects some patterns that was working without \"u\" flag.\" from https://github.com/whatwg/html/issues/439","msgtype":"m.text"},"ts":1519751413000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"MikeSmith: so \\' should be a syntax error","msgtype":"m.text"},"ts":1519751440000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"OK","msgtype":"m.text"},"ts":1519751449000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"well if the JS parser is supposed to throw/reject for `new RegExp(\"foo\\'bar\", \"u\")`, no parser Iâ€™ve tested actually does that","msgtype":"m.text"},"ts":1519751504000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"https://mathiasbynens.be/notes/es6-unicode-regex#support seems to indicate that Firefox, Chrome, and WebKit all should","msgtype":"m.text"},"ts":1519751574000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"or maybe doing just `new RegExp(\"foo\\'bar\", \"u\")` is not the way to test it?","msgtype":"m.text"},"ts":1519751631000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"annevk: Thanks. I suppose I could use an irc: URL ;) The http: URL is nice though given a snapshot of the blog from Internet Archive","msgtype":"m.text"},"ts":1519751635000,"senderName":"csarven","senderId":"csarven@irc"},
{"content":{"body":"MikeSmith: are you sure you aren't wanting \"foo\\\\'bar\"?","msgtype":"m.text"},"ts":1519752030000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"MikeSmith: because \"foo\\'bar\" is the same as \"foo'bar\"?","msgtype":"m.text"},"ts":1519752043000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"oh","msgtype":"m.text"},"ts":1519752048000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"can't remember much about ES6 regexps tho","msgtype":"m.emote"},"ts":1519752054000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"gsnedders: OK, thanks, yeah Firefox, Chrome, and WebKit all throw for `new RegExp(\"foo\\\\'bar\", \"u\")`","msgtype":"m.text"},"ts":1519752485000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"(I can't remember what the semantics of /foo\\'bar/u would be, I think that would also throw?)","msgtype":"m.text"},"ts":1519752568000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"dunno","msgtype":"m.text"},"ts":1519753001000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"Are there constants on globals beyond window.TEMPORARY and window.PERSISTENT?","msgtype":"m.text"},"ts":1519756319000,"senderName":"tobie","senderId":"tobie@irc"},
{"content":{"body":"MikeSmith: thanks! please let as many people know about it as possible. it's difficult","msgtype":"m.text"},"ts":1519756333000,"senderName":"TimothyGu","senderId":"TimothyGu@irc"},
{"content":{"body":"annevk: done and merged!","msgtype":"m.text"},"ts":1519758252000,"senderName":"foolip","senderId":"foolip@irc"},
{"content":{"body":"tobie: depends on what you'd classify as a constant. window.offscreenBuffering is always true","msgtype":"m.text"},"ts":1519758296000,"senderName":"foolip","senderId":"foolip@irc"},
{"content":{"body":"foolip: IDL constants.","msgtype":"m.text"},"ts":1519758362000,"senderName":"tobie","senderId":"tobie@irc"},
{"content":{"body":"tobie: I know of no others. Mark Dittmer might be able to search to confirm absence more widely","msgtype":"m.text"},"ts":1519758437000,"senderName":"foolip","senderId":"foolip@irc"},
{"content":{"body":"Iâ€™ll give searchfox a spin too.","msgtype":"m.text"},"ts":1519758478000,"senderName":"tobie","senderId":"tobie@irc"},
{"content":{"body":"MikeSmith: yeah `new RegExp(\"foo\\\\'bar\", \"u\")` is the right test","msgtype":"m.text"},"ts":1519758993000,"senderName":"zcorpan","senderId":"zcorpan@irc"},
{"content":{"body":"zcorpan: OK, thanks","msgtype":"m.text"},"ts":1519768059000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"}
]