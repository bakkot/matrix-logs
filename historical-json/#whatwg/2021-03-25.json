[
{"content":{"body":"Rik`: ah wow those both look very useful","msgtype":"m.text"},"ts":1616630702000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"the second one, I wish make supported that natively","msgtype":"m.text"},"ts":1616630719000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"I use bash completion with make a lot, but of course that’s just for the target names — doesn’t tell you what the targets actually do","msgtype":"m.text"},"ts":1616630817000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"I think that \"auto documented makefile\" is kinda missing a point by using `make` as a script runner.","msgtype":"m.text"},"ts":1616658095000,"senderName":"ondras","senderId":"ondras@irc"},
{"content":{"body":"if you \"only\" want to run scripts, you have probably many more better options","msgtype":"m.text"},"ts":1616658111000,"senderName":"ondras","senderId":"ondras@irc"},
{"content":{"body":"ondras: such as ?","msgtype":"m.text"},"ts":1616658161000,"senderName":"Rik`","senderId":"Rik`@irc"},
{"content":{"body":"such as a package.json script or a shellscript or basically anything","msgtype":"m.text"},"ts":1616658175000,"senderName":"ondras","senderId":"ondras@irc"},
{"content":{"body":"make's power lies elsewhere","msgtype":"m.text"},"ts":1616658186000,"senderName":"ondras","senderId":"ondras@irc"},
{"content":{"body":"people often translate their \"run this-script\" needs 1:1 to Makefile","msgtype":"m.text"},"ts":1616658218000,"senderName":"ondras","senderId":"ondras@irc"},
{"content":{"body":"the conversation started with that article \"Why I Prefer Makefiles Over package.json Scripts\"","msgtype":"m.text"},"ts":1616658258000,"senderName":"Rik`","senderId":"Rik`@irc"},
{"content":{"body":"but make's true advantage is the automatic dependency tracking and graph sub-path selection via automatic rules, such as \"%.svg: %.dot\" etc","msgtype":"m.text"},"ts":1616658290000,"senderName":"ondras","senderId":"ondras@irc"},
{"content":{"body":"yes, it is nice to see package.json scripts replaced with something more robust","msgtype":"m.text"},"ts":1616658377000,"senderName":"ondras","senderId":"ondras@irc"},
{"content":{"body":"but the article's point is \"package.json sucks for non-trivial tasks\", and not \"make is an ideal replacement\" IMHO :)","msgtype":"m.text"},"ts":1616658410000,"senderName":"ondras","senderId":"ondras@irc"},
{"content":{"body":"because using make *only* as a task runner... well... whatever.","msgtype":"m.text"},"ts":1616658431000,"senderName":"ondras","senderId":"ondras@irc"},
{"content":{"body":"(the article is correctly mentioning that in the \"Avoid Extra Work\" chapter)","msgtype":"m.text"},"ts":1616658628000,"senderName":"ondras","senderId":"ondras@irc"},
{"content":{"body":"Hey noamr, I gave things a bit more thought and I think I understand the time values better now, but I still have some questions","msgtype":"m.text"},"ts":1616661046000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"noamr: in the case where there are no redirects, is there a meaningful difference between start time and fetch start time or would it be okay to define those as identical?","msgtype":"m.text"},"ts":1616661072000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: they are identical by defiintion when there are no redirects","msgtype":"m.text"},"ts":1616661100000,"senderName":"noamr","senderId":"noamr@irc"},
{"content":{"body":"noamr: well, we set fetch start time twice, first in fetch and then in main fetch; we could make them identical by guarding the second setter by _recursive_ having to be true, I think","msgtype":"m.text"},"ts":1616661140000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"is checking","msgtype":"m.emote"},"ts":1616661166000,"senderName":"noamr","senderId":"noamr@irc"},
{"content":{"body":"noamr: also, in that case, why doesn't https://whatpr.org/fetch/1185.html#finalize-and-report-timing use start time rather than fetch start time as the reset value?","msgtype":"m.text"},"ts":1616661203000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: we don't set the fetch start time twice","msgtype":"m.text"},"ts":1616661263000,"senderName":"noamr","senderId":"noamr@irc"},
{"content":{"body":"annevk: we set it only in main fetch","msgtype":"m.text"},"ts":1616661271000,"senderName":"noamr","senderId":"noamr@irc"},
{"content":{"body":"noamr: it seems that going through the redirect start time isn't really needed there (I'm not sure if redirect start time can be set to start time however, I guess if you have a 401 and then authenticate and then get a redirect it would be different...)","msgtype":"m.text"},"ts":1616661283000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"noamr: oh wait, so where do we set start time?","msgtype":"m.text"},"ts":1616661350000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"noamr: it seems like we should set start time and fetch start time together in https://whatpr.org/fetch/1185.html#concept-fetch step 5 or so","msgtype":"m.text"},"ts":1616661395000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"noamr: and then update fetch start time in main fetch on recursive invocations","msgtype":"m.text"},"ts":1616661409000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"noamr: I have some more questions/suggestions; I could also try to write them up if that would be easier","msgtype":"m.text"},"ts":1616661587000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"I summarized my issues in a new comment","msgtype":"m.text"},"ts":1616662362000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"I'm happy to help address them; I'd be interested in knowing if it's intentional that fetchStart doesn't update for 401s and CORS preflights and such; i.e., that it only updates with redirects","msgtype":"m.text"},"ts":1616662445000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: I replied to the comments. I would be happy if some of the smaller details were done in a follow up, if needed.","msgtype":"m.text"},"ts":1616662877000,"senderName":"noamr","senderId":"noamr@irc"},
{"content":{"body":"noamr: as I said, I'm happy to help with the edits, but I do think it's important to get this right","msgtype":"m.text"},"ts":1616663224000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: ok, I now understand all your proposals, can you suggest them as edits?","msgtype":"m.text"},"ts":1616663455000,"senderName":"noamr","senderId":"noamr@irc"},
{"content":{"body":"noamr: yeah I can push a commit later, if that's what you mean; I have to do something else first, but shouldn't take long","msgtype":"m.text"},"ts":1616663514000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: that's what I mean. thanks!","msgtype":"m.text"},"ts":1616663551000,"senderName":"noamr","senderId":"noamr@irc"},
{"content":{"body":"noamr: the one final subtlety that seems hard to convey is that while post-redirect start time works well for fetchStart, we cannot really use the same term for network request start time as that would update with a 401 scenario","msgtype":"m.text"},"ts":1616663627000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"noamr: and if we did \"final network request/response start time\" it might be misleading with 1xx, but maybe not enough and it's still clear enough?","msgtype":"m.text"},"ts":1616663681000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: it's true for most of those connection-based metrics though, no? secure connection start etc, all depends on timings that are affected by the different protocol s","msgtype":"m.text"},"ts":1616663689000,"senderName":"noamr","senderId":"noamr@irc"},
{"content":{"body":"noamr: yeah, I was thinking that maybe that should be \"final connection timing info\" too","msgtype":"m.text"},"ts":1616663730000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: I'm ok with that","msgtype":"m.text"},"ts":1616663748000,"senderName":"noamr","senderId":"noamr@irc"},
{"content":{"body":"noamr: as we only hand back details from the final connection","msgtype":"m.text"},"ts":1616663750000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"yup","msgtype":"m.text"},"ts":1616663774000,"senderName":"noamr","senderId":"noamr@irc"},
{"content":{"body":"okay, so I'll use \"final\" for all of those that just record the last instance","msgtype":"m.text"},"ts":1616663810000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"and post-redirect start time for fetchStart","msgtype":"m.text"},"ts":1616663843000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: sounds good! I like that FETCH uses more accurate naming, and the backwards capability concerns can remain inside Resource Timing spec","msgtype":"m.text"},"ts":1616663977000,"senderName":"noamr","senderId":"noamr@irc"},
{"content":{"body":"noamr: I pushed a commit, I also ended up being able to simplify a few things as a result of this discussion; it looks very solid now, but I might be missing something of course","msgtype":"m.text"},"ts":1616668442000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Thanks annevk. Giving it another look","msgtype":"m.text"},"ts":1616668470000,"senderName":"noamr","senderId":"noamr@irc"},
{"content":{"body":"yoav: you should probably have another look as well; nothing substantive should have changed, but a few things got correct and streamlined","msgtype":"m.text"},"ts":1616668476000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"yoav: and we adjusted the spec-internal names to be as clear as they could be","msgtype":"m.text"},"ts":1616668502000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"SG, looking","msgtype":"m.text"},"ts":1616668515000,"senderName":"yoav","senderId":"yoav@irc"},
{"content":{"body":"corrected*","msgtype":"m.text"},"ts":1616668515000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: lgtm for last two commits","msgtype":"m.text"},"ts":1616669842000,"senderName":"noamr","senderId":"noamr@irc"},
{"content":{"body":"noamr: alright, step 1 is done \\o/ https://github.com/whatwg/fetch/commit/73f01f7b7e51626231e1911390b8dee669090b6d congrats","msgtype":"m.text"},"ts":1616676728000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"noamr: though looking at older Fetch issues I wonder if what we did with processResponseDone is correct, in particular https://bugs.chromium.org/p/chromium/issues/detail?id=805069 suggests you do need to invoke arrayBuffer() for it to be created?","msgtype":"m.text"},"ts":1616677145000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: yay! thanks for helping get this to the finish line (of the first step)","msgtype":"m.text"},"ts":1616677509000,"senderName":"noamr","senderId":"noamr@irc"},
{"content":{"body":"annevk: fetch() definitely creates RT without calling relying on a call to `arrayBuffer()`. not sure about the specifics of that bug, yoav?","msgtype":"m.text"},"ts":1616677556000,"senderName":"noamr","senderId":"noamr@irc"},
{"content":{"body":"noamr: I guess if there's backpressure the current approach would end up delaying creation of the entry as well, so maybe all is fine","msgtype":"m.text"},"ts":1616677957000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: yes, I believe so","msgtype":"m.text"},"ts":1616677996000,"senderName":"noamr","senderId":"noamr@irc"},
{"content":{"body":"noamr: if I do fetch(\"https://www.google.com\") and then check the last entry of window.performance.getEntriesByType(\"resource\") it's there, so network errors do result in entries afaict","msgtype":"m.text"},"ts":1616695987000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: yes, network errors do, but not CORS errors","msgtype":"m.text"},"ts":1616696518000,"senderName":"noamr","senderId":"noamr@irc"},
{"content":{"body":"noamr: but that’s a CORS error","msgtype":"m.text"},"ts":1616700229000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: will look at the details on Sunday... Passover time starting here in Israel ☺️","msgtype":"m.text"},"ts":1616702508000,"senderName":"noamr","senderId":"noamr@irc"},
{"content":{"body":"Yeah, I’ll be off for two weeks, we can clean this up after; might investigate a bit more tomorrow","msgtype":"m.text"},"ts":1616704208000,"senderName":"annevk","senderId":"annevk@irc"}
]