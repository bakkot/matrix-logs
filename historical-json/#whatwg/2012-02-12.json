[
{"content":{"body":"gah","msgtype":"m.text"},"ts":1329017700000,"senderName":"zewt","senderId":"zewt@irc"},
{"content":{"body":"does amazon use sync xhr? heh","msgtype":"m.text"},"ts":1329017701000,"senderName":"zewt","senderId":"zewt@irc"},
{"content":{"body":"tethering on my phone and having chrome freeze randomly searching on amazon","msgtype":"m.text"},"ts":1329017760000,"senderName":"zewt","senderId":"zewt@irc"},
{"content":{"body":">> \"check ecma\"","msgtype":"m.text"},"ts":1329025740000,"senderName":"smartie2","senderId":"smartie2@irc"},
{"content":{"body":"Taggnostr: I can't imagine that making a Python 3 port of tml5lib would take more than a day or two. Maybe \"make a Python 3 port and an API that acts a a drop-in replacement for HTMLParser\" would be more reasonable. Well I imagine that adding that would also be pretty trivial, but enabling the parser to work with a streaming API for minimal memory consumption would be a little harder. Still seems like it would be ~10 days work including learning all ","msgtype":"m.text"},"ts":1329047460000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"(note that possibly for streaming you may have to buffer the whole document)","msgtype":"m.text"},"ts":1329047520000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"(as nodes can be moved and inserted earlier in the tree)","msgtype":"m.text"},"ts":1329047521000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Well looking at it, it seems that HTMLParser doesn't tell you where nodes were inserted","msgtype":"m.text"},"ts":1329047820000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"So the only thing that you need the treebuilder for is to handle things like <script><div></script> and <sircle/><svg><circle/>","msgtype":"m.text"},"ts":1329048000000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"s/sircle/circle/","msgtype":"m.text"},"ts":1329048001000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"It is prety tempting to just hook into the tokenizer, ignore the treebuilder and say that it is an application-level concern to realise that if you just saw a <script>, a <div> tag is actually text","msgtype":"m.text"},"ts":1329048120000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"jgraham: But the treebuilder changes tokenizer state.","msgtype":"m.text"},"ts":1329048300000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"gsnedders: I know","msgtype":"m.text"},"ts":1329048360000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"blames foreign content :(","msgtype":"m.emote"},"ts":1329048361000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"But the existing implementation seems to be horribly broken","msgtype":"m.text"},"ts":1329048362000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"<script><div> -> 1 start tag","msgtype":"m.text"},"ts":1329048363000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"<xmp><div> -> 2 start tags","msgtype":"m.text"},"ts":1329048364000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"It seems quite possible to just find all the special cases that the existing implementation knows about, hardcode them in to the HTMLParser api, use that to change the tokenizer state, and accept that there are probably some corner cases where everything will break","msgtype":"m.text"},"ts":1329048480000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"So far the list of special cases seems to be \"script\", \"style\"","msgtype":"m.text"},"ts":1329048600000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"In fact that is exactly the list of special cases","msgtype":"m.text"},"ts":1329048660000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"those two tags can't contain markup","msgtype":"m.text"},"ts":1329048720000,"senderName":"StoneCypher","senderId":"StoneCypher@irc"},
{"content":{"body":"so that's not actually broken","msgtype":"m.text"},"ts":1329048721000,"senderName":"StoneCypher","senderId":"StoneCypher@irc"},
{"content":{"body":"that's correct","msgtype":"m.text"},"ts":1329048722000,"senderName":"StoneCypher","senderId":"StoneCypher@irc"},
{"content":{"body":"there are others too","msgtype":"m.text"},"ts":1329048723000,"senderName":"StoneCypher","senderId":"StoneCypher@irc"},
{"content":{"body":"<object>, <embed>","msgtype":"m.text"},"ts":1329048724000,"senderName":"StoneCypher","senderId":"StoneCypher@irc"},
{"content":{"body":"et cetera","msgtype":"m.text"},"ts":1329048725000,"senderName":"StoneCypher","senderId":"StoneCypher@irc"},
{"content":{"body":"anything that contains <!cdata[[","msgtype":"m.text"},"ts":1329048726000,"senderName":"StoneCypher","senderId":"StoneCypher@irc"},
{"content":{"body":"or whatever it is","msgtype":"m.text"},"ts":1329048727000,"senderName":"StoneCypher","senderId":"StoneCypher@irc"},
{"content":{"body":"StoneCypher: Right, script and style switching the tokenizer state is right. What's wrong is e.g. xmp *not* doing it","msgtype":"m.text"},"ts":1329048840000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"oh somebody uses xml islands","msgtype":"m.text"},"ts":1329048841000,"senderName":"bga","senderId":"bga@irc"},
{"content":{"body":"bga: not since like 2004","msgtype":"m.text"},"ts":1329048900000,"senderName":"StoneCypher","senderId":"StoneCypher@irc"},
{"content":{"body":"bga: i mean, back in the dark ages, sure","msgtype":"m.text"},"ts":1329048901000,"senderName":"StoneCypher","senderId":"StoneCypher@irc"},
{"content":{"body":"jgraham: ah.  (i don't actually know what xmp does_)","msgtype":"m.text"},"ts":1329048902000,"senderName":"StoneCypher","senderId":"StoneCypher@irc"},
{"content":{"body":"jgraham: sorry if i misunderstood :)","msgtype":"m.text"},"ts":1329048960000,"senderName":"StoneCypher","senderId":"StoneCypher@irc"},
{"content":{"body":"StoneCypher but https://developer.mozilla.org/en/Using_XML_Data_Islands_in_Mozilla","msgtype":"m.text"},"ts":1329048961000,"senderName":"bga","senderId":"bga@irc"},
{"content":{"body":"wow.","msgtype":"m.text"},"ts":1329049380000,"senderName":"StoneCypher","senderId":"StoneCypher@irc"},
{"content":{"body":"so xml islands are back-ish, as a legit standard now?","msgtype":"m.text"},"ts":1329049381000,"senderName":"StoneCypher","senderId":"StoneCypher@irc"},
{"content":{"body":"eenteresting.","msgtype":"m.text"},"ts":1329049440000,"senderName":"StoneCypher","senderId":"StoneCypher@irc"},
{"content":{"body":"i bet the microformats people adore this.","msgtype":"m.text"},"ts":1329049441000,"senderName":"StoneCypher","senderId":"StoneCypher@irc"},
{"content":{"body":"gsnedders, Taggnostr: Something like https://gist.github.com/1808356","msgtype":"m.text"},"ts":1329051540000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"Not production quality ofc, but more or less does the same as HTMLParser, but using the html5lib tokenizer","msgtype":"m.text"},"ts":1329051541000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"(the hard part would be making the incremental feeding work)","msgtype":"m.text"},"ts":1329052020000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"BTW, it is interesting that Ian Hickson and Chris Wilson works at the same company now.","msgtype":"m.text"},"ts":1329084180000,"senderName":"yuhong","senderId":"yuhong@irc"}
]