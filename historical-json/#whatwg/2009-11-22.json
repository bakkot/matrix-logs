[
{"content":{"body":"hi everyone! I'm playing around with the html5lib 0.11 python implementation, and is wondering if I might have hit a bug: http://dpaste.com/hold/123513/","msgtype":"m.text"},"ts":1258852080000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"I'm parsning the HTML of swedish newspapers, which seems to we one of the worst messes in the world :(","msgtype":"m.text"},"ts":1258852081000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"or, I could be doing something wrong, it would not be the first time :)","msgtype":"m.text"},"ts":1258852140000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"the same error occurs on www.unt.se, and www.uhp.se too","msgtype":"m.text"},"ts":1258853640000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"Huvet: 0.11 is very old - you should try it with the latest source version","msgtype":"m.text"},"ts":1258890000000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"thanks, I will","msgtype":"m.text"},"ts":1258890420000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"gah, \"hg\" needed to download the latest source version? what happened to the good old svn days :(","msgtype":"m.text"},"ts":1258892040000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"The good old svn days turned into the better new hg days","msgtype":"m.text"},"ts":1258892220000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"It's basically the same as SVN except you use the command \"hg\" instead of \"svn\" :-)","msgtype":"m.text"},"ts":1258892280000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"...although I suppose it might be a bit more painful on Windows","msgtype":"m.text"},"ts":1258892281000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"well, not really, seems to work exactly like it should","msgtype":"m.text"},"ts":1258892820000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"hmm... strange, it checked out the whole tree, even though I requested a subdirectory","msgtype":"m.text"},"ts":1258892940000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"hmm... \"... you cannot check out only one directory of a repository\"","msgtype":"m.text"},"ts":1258893180000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"hmm... I guess I can't clone the default repository and use that? seems that is 0.11 still. Maybe the 0.2 branch? *figures out how to clone a branch*","msgtype":"m.text"},"ts":1258893540000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"is that the latest version? or should I look into some other branch?","msgtype":"m.text"},"ts":1258893780000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"ah, fuck it, beautifulsoup seems deprecated anyways","msgtype":"m.text"},"ts":1258893960000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"Huvet: Yeah, Hg doesn't support partial checkouts - you just clone the entire repository","msgtype":"m.text"},"ts":1258894020000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"yeah, I figured that out","msgtype":"m.text"},"ts":1258894021000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"which includes all the branches and everything","msgtype":"m.text"},"ts":1258894022000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"ah","msgtype":"m.text"},"ts":1258894023000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"how do I know which the latest branch is?","msgtype":"m.text"},"ts":1258894080000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"You should just use the default branch","msgtype":"m.text"},"ts":1258894081000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"ok","msgtype":"m.text"},"ts":1258894082000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"since the others were for temporary experiments","msgtype":"m.text"},"ts":1258894083000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"I think the BS code is still included and should work better than the 0.11 release, though I could be wrong about that","msgtype":"m.text"},"ts":1258894140000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"seems I still get the same error there","msgtype":"m.text"},"ts":1258894200000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"but there are fundamental problems in BS that mean it can't work properly in html5lib, and nobody has been interested in spending a great deal of effort on it","msgtype":"m.text"},"ts":1258894201000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"but with an extra DataLossWarning","msgtype":"m.text"},"ts":1258894202000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"I'll just use something else then I guess","msgtype":"m.text"},"ts":1258894203000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"Okay, so maybe it doesn't work much better than the 0.11 release :-(","msgtype":"m.text"},"ts":1258894260000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"lxml is usually the recommended treebuilder","msgtype":"m.text"},"ts":1258894320000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"ok, i saw the remark in the docs about lxml being an \"excellent library\" :)","msgtype":"m.text"},"ts":1258894380000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"or something in those terms","msgtype":"m.text"},"ts":1258894381000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"oh great, the lxml parser crashes on those sites too :(","msgtype":"m.text"},"ts":1258894800000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"Hmm, seems to work okay for me with lxml","msgtype":"m.text"},"ts":1258894801000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"(I can't test BS yet since I don't have it installed)","msgtype":"m.text"},"ts":1258894860000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"are you parsning http://www.allehanda.se ?","msgtype":"m.text"},"ts":1258894861000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"http://dpaste.com/123628/","msgtype":"m.text"},"ts":1258894920000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"No, because that timed out when I first tried downloading it","msgtype":"m.text"},"ts":1258894921000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"but now I see the problem :-/","msgtype":"m.text"},"ts":1258894922000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"ihatexml.py lives up to its name","msgtype":"m.text"},"ts":1258895040000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"heh, great name for a file, what does it do?","msgtype":"m.text"},"ts":1258895041000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"http://code.google.com/p/html5lib/issues/detail?id=125","msgtype":"m.text"},"ts":1258895220000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"ah, that seems it","msgtype":"m.text"},"ts":1258895221000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"It tries to modify the names returned by the HTML parser so they're compatible with APIs that enforce XML's name requirements","msgtype":"m.text"},"ts":1258895222000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"(and similar things)","msgtype":"m.text"},"ts":1258895280000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"Huvet: <a><div><div><a> seems to be the pattern the BS treebuilder dislikes","msgtype":"m.text"},"ts":1258895520000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"heh, I can understand that","msgtype":"m.text"},"ts":1258895580000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"Huvet: It's the same as http://code.google.com/p/html5lib/issues/detail?id=80","msgtype":"m.text"},"ts":1258895700000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"ah, good detective work","msgtype":"m.text"},"ts":1258895701000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"should have remembered it sooner because he looked into that bug when it was new","msgtype":"m.emote"},"ts":1258895760000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"(At least that's the problem on www.unt.se, I assume the others are the same)","msgtype":"m.text"},"ts":1258895820000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"heh, next horrendous HTML that crashes the html5 parser: http://7-harad.nu/","msgtype":"m.text"},"ts":1258923000000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"What error message do you get?","msgtype":"m.text"},"ts":1258923060000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"http://dpaste.com/123783/","msgtype":"m.text"},"ts":1258923061000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"Hmm","msgtype":"m.text"},"ts":1258923240000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"What treebuilder are you using?","msgtype":"m.text"},"ts":1258923241000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"dom","msgtype":"m.text"},"ts":1258923242000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"beautifulsoup crashed on some sites, lxml on some other ones, so I'm on dom now :)","msgtype":"m.text"},"ts":1258923300000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"I guess it's all the advertising code on these sites that make them so badly formatted","msgtype":"m.text"},"ts":1258923360000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"http://code.google.com/p/html5lib/issues/detail?id=123 sounds like it could be relevant","msgtype":"m.text"},"ts":1258923361000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"but I'm not really sure","msgtype":"m.text"},"ts":1258923420000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"It'd be good if you could produce a minimal testcase","msgtype":"m.text"},"ts":1258923421000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"yeah, I'm not sure how to go about that... save the sourcecode locally and start stipping stuff out?","msgtype":"m.text"},"ts":1258923422000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"by starting with the markup from the site that causes problems, then deleting half of it and seeing if the problem is still there, else delete the other half instead, and repeat until there's not much left","msgtype":"m.text"},"ts":1258923423000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"Yeah, basically what you said :-)","msgtype":"m.text"},"ts":1258923480000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"ok, I'll get to work right away","msgtype":"m.text"},"ts":1258923481000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":":)","msgtype":"m.text"},"ts":1258923482000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"oh, there's a new error","msgtype":"m.text"},"ts":1258924740000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"http://dpaste.com/123797/","msgtype":"m.text"},"ts":1258924741000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"but one thing at the time","msgtype":"m.text"},"ts":1258924800000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"Testing on real content is a good way to find bugs :-)","msgtype":"m.text"},"ts":1258924920000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"wonders how many pages Huvet is running through it","msgtype":"m.emote"},"ts":1258924980000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"351 :)","msgtype":"m.text"},"ts":1258924981000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"I'm scaping swedish news sites for RSS urls","msgtype":"m.text"},"ts":1258924982000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"seems that's a bit harder than I first thouht :P","msgtype":"m.text"},"ts":1258925040000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"seems that's a bit harder than I first thouht :","msgtype":"m.text"},"ts":1258925041000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"this is the smallest I can get it: <table><td><span><font></span><span>","msgtype":"m.text"},"ts":1258925100000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"first one","msgtype":"m.text"},"ts":1258925101000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"ehm... strange... the other error is if I have a file with just <table> in it :)","msgtype":"m.text"},"ts":1258925220000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"That's quite minimal :-)","msgtype":"m.text"},"ts":1258925460000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"Huvet: I think you could fix the processEOF easily by removing the 'token' in html5parser.py lines 1689, 1692 (the processEOF declaration/call)","msgtype":"m.text"},"ts":1258925700000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"but it'd be good to post a new issue on the Google Code site, so someone can add a test case and fix the code and make sure it works","msgtype":"m.text"},"ts":1258925760000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"and also for the other bug (which looks like a scary adoption agency thing)","msgtype":"m.text"},"ts":1258925820000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"I will","msgtype":"m.text"},"ts":1258925880000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"here's the first bug: http://code.google.com/p/html5lib/issues/detail?id=126","msgtype":"m.text"},"ts":1258926960000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"and here's the other one: http://code.google.com/p/html5lib/issues/detail?id=127","msgtype":"m.text"},"ts":1258927260000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"\"Such a subset does not, in general, include inline script elements.\"","msgtype":"m.text"},"ts":1258927440000,"senderName":"AryehGregor","senderId":"AryehGregor@irc"},
{"content":{"body":"Why can't you include inline script in polyglots?  Can't you fudge things using <!CDATA[ or whatnot?","msgtype":"m.text"},"ts":1258927441000,"senderName":"AryehGregor","senderId":"AryehGregor@irc"},
{"content":{"body":"yay, another bug :)","msgtype":"m.text"},"ts":1258930860000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"I'll do the drill","msgtype":"m.text"},"ts":1258930920000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"Yours is the drill that will pierce bugzilla","msgtype":"m.text"},"ts":1258931100000,"senderName":"Dashiva","senderId":"Dashiva@irc"},
{"content":{"body":":)","msgtype":"m.text"},"ts":1258931340000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"<form><table></form><form></table></form>","msgtype":"m.text"},"ts":1258931341000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"wonderful code","msgtype":"m.text"},"ts":1258931342000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"I'll post a bug for it","msgtype":"m.text"},"ts":1258931343000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"\"ValueError: list.remove(x): x not in list\"","msgtype":"m.text"},"ts":1258931344000,"senderName":"Huvet","senderId":"Huvet@irc"},
{"content":{"body":"Here's the bug, for those interested: http://code.google.com/p/html5lib/issues/detail?id=128","msgtype":"m.text"},"ts":1258931640000,"senderName":"Huvet","senderId":"Huvet@irc"}
]