[
{"content":{"body":"annevk: Progress woohoo https://github.com/whatwg/html/pull/4354#issuecomment-463566900","msgtype":"m.text"},"ts":1550138489000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"nox: \\o/","msgtype":"m.text"},"ts":1550139166000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: So where am I supposed to look at in the spec for focus handling? :D","msgtype":"m.text"},"ts":1550139312000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"nox: HTML defines some of it","msgtype":"m.text"},"ts":1550139380000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"nox: search for \"focusing steps\"","msgtype":"m.text"},"ts":1550139414000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"nox: I guess the main question is whether blur is dispatched if you remove an element that's focused (or insert it elsewhere)","msgtype":"m.text"},"ts":1550139465000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: Aren't they always invoked through a queued task?","msgtype":"m.text"},"ts":1550139482000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"Ah no, ok.","msgtype":"m.text"},"ts":1550139525000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"annevk: https://html.spec.whatwg.org/multipage/interaction.html#focus-processing-model:unfocusing-steps This is the important thing you want me to test right?","msgtype":"m.text"},"ts":1550139718000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"nox: <input>.focus() getting unfocused by removal and maybe <input autofocus> potentially getting focused by insertion? Though I think the latter does use a task","msgtype":"m.text"},"ts":1550139895000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"nox: I'm having a hard time coming up with other scenarios for this","msgtype":"m.text"},"ts":1550139913000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Yeah the latter definitely uses a task.","msgtype":"m.text"},"ts":1550139918000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"So nobody ever created tests for <iframe name>","msgtype":"m.text"},"ts":1550155182000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"I should not be surprised, but I am","msgtype":"m.text"},"ts":1550155198000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: So what I need to try to test for is when blur/focus events are fired, is that right?","msgtype":"m.text"},"ts":1550159107000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"I need to test that https://html.spec.whatwg.org/multipage/links.html#link-type-stylesheet:fetch-and-process-the-linked-resource","msgtype":"m.text"},"ts":1550160236000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"When the spec says \"Wait until algorithm asynchronously completes with result\", that means we block, right?","msgtype":"m.text"},"ts":1550160523000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"nox: that step \"blocks\", yes","msgtype":"m.text"},"ts":1550160589000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"nox: such a \"Wait\" statement should only be found in stuff that's \"in parallel\", except perhaps if it's legacy","msgtype":"m.text"},"ts":1550160634000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: When is link.sheet updated?","msgtype":"m.text"},"ts":1550160692000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"(For <link rel=stylesheet>)","msgtype":"m.text"},"ts":1550160700000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"nox: the set of steps that dispatches load, before it's dispatched","msgtype":"m.text"},"ts":1550160749000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: Do you have a spec link for that? I lost myself.","msgtype":"m.text"},"ts":1550160769000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"nox: domfarolino has been refactoring","msgtype":"m.text"},"ts":1550160783000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"and I'm not sure that was ever super well-defined","msgtype":"m.text"},"ts":1550160794000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: Also not sure whether that matters or not but in https://html.spec.whatwg.org/multipage/custom-elements.html#custom-element-reactions we may understand that the callback is immediately invoked, but that's not what happens right?","msgtype":"m.text"},"ts":1550160835000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"nox: look for \"process the linked resource\" and how it's defined for stylesheet","msgtype":"m.text"},"ts":1550160864000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Ok thanks.","msgtype":"m.text"},"ts":1550160869000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"nox: scroll down to [CEReactions] for the exact timing on custom element reactions","msgtype":"m.text"},"ts":1550160927000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"nox: they're basically run at the point when IDL returns to JS","msgtype":"m.text"},"ts":1550160942000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Yeah that's what I gathered, so that can't interfere with the insertion algo.","msgtype":"m.text"},"ts":1550161000000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"nox: yeah, if you do insertBefore() or appendChild() it's be 1) \"actual insert\" 2) \"this new queue you're working on \" 3) \"custom element reactions\"","msgtype":"m.text"},"ts":1550161160000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"it'd be*","msgtype":"m.text"},"ts":1550161170000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"https://twitter.com/nokusu/status/1096081486082723841 wtf","msgtype":"m.text"},"ts":1550161182000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"https://github.com/whatwg/html/pull/4354#issuecomment-463693419 My brain is on fire so I'll do something else for the rest of the day.","msgtype":"m.text"},"ts":1550161761000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"nox, go home, eat a baguette","msgtype":"m.text"},"ts":1550161835000,"senderName":"Ms2ger","senderId":"Ms2ger@irc"},
{"content":{"body":"nox: heh","msgtype":"m.text"},"ts":1550161842000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"nox: so I think most of those are not a problem","msgtype":"m.text"},"ts":1550161848000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"nox: and done at insertion time","msgtype":"m.text"},"ts":1550161852000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"nox: except for those that depend on some external resource and are therefore done async","msgtype":"m.text"},"ts":1550161872000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: You mean before scripts run then, right?","msgtype":"m.text"},"ts":1550162314000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"annevk: But I think Gecko uses their AddScriptRunner stuff for some of them, hence why I listed them.","msgtype":"m.text"},"ts":1550162331000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"nox: aye","msgtype":"m.text"},"ts":1550162340000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"nox: interesting","msgtype":"m.text"},"ts":1550162343000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: See bz's link https://searchfox.org/mozilla-central/search?q=AddScriptRunner&case=true","msgtype":"m.text"},"ts":1550162367000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"(Cursed link tbh)","msgtype":"m.text"},"ts":1550162377000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"Hmm yeah, maybe I need to reread the thread at some point","msgtype":"m.text"},"ts":1550162439000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"But I'm pretty sure I tested <iframe> at least","msgtype":"m.text"},"ts":1550162457000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: At the very least,","msgtype":"m.text"},"ts":1550162465000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"I'm pretty confident that the DOM part of my set of PRs is solid.","msgtype":"m.text"},"ts":1550162476000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"As in, it is enough to encode whatever way Firefox uses their script runner stuff.","msgtype":"m.text"},"ts":1550162499000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"annevk: stupid question, how can a Window not have a browsing context?","msgtype":"m.text"},"ts":1550164046000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Domenic: see test, hold ref, remove iframe","msgtype":"m.text"},"ts":1550164076000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: that discards the BC, but doesn't remove the reference from Window -> BC","msgtype":"m.text"},"ts":1550164143000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Discarding only removes the reference from UA -> BC, but if there's a JS -> Window -> BC reference, the BC still exists","msgtype":"m.text"},"ts":1550164196000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Domenic: hmm I thought it removed all refs as we don’t really deal with such a bc","msgtype":"m.text"},"ts":1550164207000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Domenic: so we’d need discarded checks instead? Seems worse, but maybe this is indeed not clear currently","msgtype":"m.text"},"ts":1550164255000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"I guess per the tests UAs clear out the name, instead of keeping it?","msgtype":"m.text"},"ts":1550164277000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"I'm just a little worried about how much else might assume that every Window has a BC. But those things might be broken in other ways, indeed.","msgtype":"m.text"},"ts":1550164323000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Domenic: i think the tests support the notion of the bc not being there, if you look at the setter","msgtype":"m.text"},"ts":1550164328000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Sigh, fractal brokenness.","msgtype":"m.text"},"ts":1550164365000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Domenic: stuff either needs to branch on it being there or it being discarded; everything that doesn’t is broken","msgtype":"m.text"},"ts":1550164373000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Well, \"being discarded\" isn't a well-defined concept (there's no discarded boolean), so removing the reference makes some sense. I'll comment and solicit bz's opinion.","msgtype":"m.text"},"ts":1550164407000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"closed branch on discarded, but I agree that nulling is our normal way","msgtype":"m.text"},"ts":1550164441000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"branches*","msgtype":"m.text"},"ts":1550164452000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"And also agree that branching on discarded is rather silly","msgtype":"m.text"},"ts":1550164475000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: I assume the tests passed in all browsers?","msgtype":"m.text"},"ts":1550164483000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Domenic: yeah, though initially I set name after insertion, which explains the other PR 😊","msgtype":"m.text"},"ts":1550164521000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Domenic: if we agree on the null model I can add that concept to the spec inc a red box and then we slowly fix it over time and rebase this PR on top of that","msgtype":"m.text"},"ts":1550165735000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Domenic: spec has “Lose the strong reference from document's browsing context to document.” already","msgtype":"m.text"},"ts":1550169385000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Domenic: this should all be much more explicit though","msgtype":"m.text"},"ts":1550169406000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"I might work on that a bit as it’ll prolly keep coming up and seems good to rectify as tighten other lifetime behavior too","msgtype":"m.text"},"ts":1550169489000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"as we*","msgtype":"m.text"},"ts":1550169499000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: I agree with the null model but would feel more comfortable if jdm and bz signed off.","msgtype":"m.text"},"ts":1550172677000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"The spec does indeed sever the BC -> document, but it doesn't say much about the Window -> BC. Even if we define Window -> BC as a macro for Window -> associated Document -> BC, severing BC -> document does not impact that.","msgtype":"m.text"},"ts":1550172717000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Domenic: ah yes","msgtype":"m.text"},"ts":1550173118000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"I wonder if that connection was even considered","msgtype":"m.text"},"ts":1550173135000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"This whole mess would benefit from some pictures","msgtype":"m.text"},"ts":1550173157000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Tangentially, it looks like from your tests <embed>s have name=\"\" attributes!?!","msgtype":"m.text"},"ts":1550173173000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Yeah, though poorly defined","msgtype":"m.text"},"ts":1550173202000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Initially embed did not have nested bcs…","msgtype":"m.text"},"ts":1550173224000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"In the spec","msgtype":"m.text"},"ts":1550173232000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Yeah it appears to not exist in the spec at all","msgtype":"m.text"},"ts":1550173234000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"I'll file a separate bug...","msgtype":"m.text"},"ts":1550173239000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"I think the plan for <object> and <embed> is to wait for Flash to die then re-do everything","msgtype":"m.text"},"ts":1550173257000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"We did add support when we centralized creation of nbcs","msgtype":"m.text"},"ts":1550173261000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Oh","msgtype":"m.text"},"ts":1550173267000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"I was Ctrl+Fing \"name\" and looking at the highlighted instances, but you're right","msgtype":"m.text"},"ts":1550173285000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"As jdm mentions, the fact that #concept-document-bc indirects through session history, and session history is impacted by discarding, means... something is happening here.","msgtype":"m.text"},"ts":1550173543000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Uhuh, I wonder if we’re still on track for 2022 or whatever it was","msgtype":"m.text"},"ts":1550174440000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Are you talking about Flash's death or REC-worthy test coverage?","msgtype":"m.text"},"ts":1550174900000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Oh, we got actions access somehow. I never got an email.","msgtype":"m.text"},"ts":1550174991000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"HTML5 being Hixie-perfect","msgtype":"m.text"},"ts":1550176204000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"hi. should i put my sitewide navigation <nav> in a <section> if it containers anything more than a heading (h1) and <ul> list of links?","msgtype":"m.text"},"ts":1550177976000,"senderName":"eightfold","senderId":"eightfold@irc"},
{"content":{"body":"eightfold: no hard-and-fast rule, afaik","msgtype":"m.text"},"ts":1550178288000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"thanks. as it looks now there’s only a h1 and ul, so sidewide nav should be directly below body it seems.","msgtype":"m.text"},"ts":1550178356000,"senderName":"eightfold","senderId":"eightfold@irc"},
{"content":{"body":"eightfold: sounds fine","msgtype":"m.text"},"ts":1550178419000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"any wrapper divs should not affect structural outline, right?","msgtype":"m.text"},"ts":1550178735000,"senderName":"eightfold","senderId":"eightfold@irc"},
{"content":{"body":"Correct","msgtype":"m.text"},"ts":1550179627000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"and (last question i hope), body > main > article > header > 1makes sense even if there’s only one article in main?","msgtype":"m.text"},"ts":1550179760000,"senderName":"eightfold","senderId":"eightfold@irc"},
{"content":{"body":"i meant: body > main > article > header > h1","msgtype":"m.text"},"ts":1550179786000,"senderName":"eightfold","senderId":"eightfold@irc"},
{"content":{"body":"just wondering if i should ditch either main or article in that outline","msgtype":"m.text"},"ts":1550179816000,"senderName":"eightfold","senderId":"eightfold@irc"},
{"content":{"body":"content in article is blog posts","msgtype":"m.text"},"ts":1550179836000,"senderName":"eightfold","senderId":"eightfold@irc"},
{"content":{"body":"blog post, singular :)","msgtype":"m.text"},"ts":1550179845000,"senderName":"eightfold","senderId":"eightfold@irc"},
{"content":{"body":"eightfold: either ok","msgtype":"m.text"},"ts":1550179986000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"so all of these are ok: 1. main only. 2. article only. 3. article inside main","msgtype":"m.text"},"ts":1550180073000,"senderName":"eightfold","senderId":"eightfold@irc"},
{"content":{"body":"for my use?","msgtype":"m.text"},"ts":1550180075000,"senderName":"eightfold","senderId":"eightfold@irc"},
{"content":{"body":"shouldn’t the second example here: https://html.spec.whatwg.org/multipage/sections.html#the-header-element","msgtype":"m.text"},"ts":1550181705000,"senderName":"eightfold","senderId":"eightfold@irc"},
{"content":{"body":"have a </header> directly after the </nav>?","msgtype":"m.text"},"ts":1550181728000,"senderName":"eightfold","senderId":"eightfold@irc"},
{"content":{"body":"or is the </header> below ...","msgtype":"m.text"},"ts":1550181744000,"senderName":"eightfold","senderId":"eightfold@irc"},
{"content":{"body":"?","msgtype":"m.text"},"ts":1550181746000,"senderName":"eightfold","senderId":"eightfold@irc"},
{"content":{"body":"it’s all up to you","msgtype":"m.text"},"ts":1550183069000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"none of those elements have any specific presentational effects","msgtype":"m.text"},"ts":1550183105000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"so you could also just as well use <div>s","msgtype":"m.text"},"ts":1550183148000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"}
]