[
{"content":{"body":"PiersW: having now read the post, it’s humbling to see you ran into the unsolved script insertion issue. Maybe it’s time to give that another go","msgtype":"m.text"},"ts":1575003526000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"CSS and modules load subresources differently, e.g., https://github.com/w3c/webappsec-referrer-policy/issues/123","msgtype":"m.text"},"ts":1575011524000,"senderName":"jochen__","senderId":"jochen__@irc"},
{"content":{"body":"it would be cool if they behaved the same :)","msgtype":"m.text"},"ts":1575011538000,"senderName":"jochen__","senderId":"jochen__@irc"},
{"content":{"body":"any opinion on changing css or modules?","msgtype":"m.text"},"ts":1575011549000,"senderName":"jochen__","senderId":"jochen__@irc"},
{"content":{"body":"jochen__: suspect modules is more compatible, I also thought we made them behave similar already","msgtype":"m.text"},"ts":1575011880000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"so the exact difference is that if a stylesheet loads a resource (e.g. an image), the stylesheet itself will be the referrer","msgtype":"m.text"},"ts":1575012207000,"senderName":"jochen__","senderId":"jochen__@irc"},
{"content":{"body":"and for modules, always the fetch client will be the referrer (and a module itself is not a new fetch client, so the referrer always stays e.g. the document that initiated the module loading)","msgtype":"m.text"},"ts":1575012249000,"senderName":"jochen__","senderId":"jochen__@irc"},
{"content":{"body":"jochen__: ooh, I thought we would not do that, hmm; hopefully Domenic knows the rationale as I’m pretty sure this was discussed","msgtype":"m.text"},"ts":1575016860000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Yeah, scripts are a pain. It's not clear to me what happens if you append a tree with two scripts and the first one removes the second before it's executed.","msgtype":"m.text"},"ts":1575017330000,"senderName":"PiersW","senderId":"PiersW@irc"},
{"content":{"body":"annevk: The stuff in the blog was about our internal flags, which was really an implementation bug.","msgtype":"m.text"},"ts":1575017412000,"senderName":"PiersW","senderId":"PiersW@irc"},
{"content":{"body":"PiersW: there's a couple open issues on that and I created a bunch of tests, but no cross-browser decision on what it should be","msgtype":"m.text"},"ts":1575018612000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"(nox also did a bunch of work on that)","msgtype":"m.text"},"ts":1575018629000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"PiersW: https://github.com/whatwg/dom/pull/732 was an attempt at clarifying what happens with DOM mutations and script insertion.","msgtype":"m.text"},"ts":1575019139000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"Unfortunately, other yaks had to be taken care of before I could finish.","msgtype":"m.text"},"ts":1575019162000,"senderName":"nox","senderId":"nox@irc"},
{"content":{"body":"Looks thorough. I'll take a look.","msgtype":"m.text"},"ts":1575019458000,"senderName":"PiersW","senderId":"PiersW@irc"},
{"content":{"body":"I wouldn't say it's the most pressing issue, though, unless we find a site that doesn't like our existing behaviour.","msgtype":"m.text"},"ts":1575019506000,"senderName":"PiersW","senderId":"PiersW@irc"},
{"content":{"body":"jochen__: annevk: the referrer is set to the module's URL. https://html.spec.whatwg.org/multipage/webappapis.html#fetch-the-descendants-of-a-module-script step 8 passes the module's URL (= base URL) as the referrer to https://html.spec.whatwg.org/multipage/webappapis.html#fetch-a-single-module-script .","msgtype":"m.text"},"ts":1575041514000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Domenic: ty","msgtype":"m.text"},"ts":1575047679000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Domenic: also, something to think about, there is some appetite to make origin isolation part of COOP+COEP. Making that change how keying works for the entire BCG they end up creating. As everyone has to opt-in, it’s pretty reasonable I think.","msgtype":"m.text"},"ts":1575048898000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: please loop me in to any such discussions. I thought when I went through this previously they were pretty orthogonal and it ended up being not very workable, but I might be wrong.","msgtype":"m.text"},"ts":1575049017000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Domenic: it was in person, but I’ll definitely follow up with more detail next week","msgtype":"m.text"},"ts":1575049200000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"I think it works, main question is whether sites need same-site SAB still","msgtype":"m.text"},"ts":1575049268000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: jochen__: Hmm did I miss something? I think jochen's comment described the opposite behavior; CSS subresources' referrer is always the node document's URL, and Domenic pointed out (what issue #123 mentions) that the module script becomes the referrer for its descendants","msgtype":"m.text"},"ts":1575053532000,"senderName":"domfarolino","senderId":"domfarolino@irc"},
{"content":{"body":"domfarolino: for CSS it's the style sheet's URL","msgtype":"m.text"},"ts":1575053606000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: Interesting. Doesn't https://w3c.github.io/webappsec-referrer-policy/#integration-with-css describe the referrer as the node document's URL?","msgtype":"m.text"},"ts":1575053640000,"senderName":"domfarolino","senderId":"domfarolino@irc"},
{"content":{"body":"Oof nevermind, I think I skipped a step when reading it","msgtype":"m.text"},"ts":1575053684000,"senderName":"domfarolino","senderId":"domfarolino@irc"},
{"content":{"body":"domfarolino: yeah, step 1 there is pretty clear","msgtype":"m.text"},"ts":1575053723000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"So module script  and CSS subresource referrer behavior does match I think","msgtype":"m.text"},"ts":1575053725000,"senderName":"domfarolino","senderId":"domfarolino@irc"},
{"content":{"body":"annevk: Yeah I don't know how I missed it lol","msgtype":"m.text"},"ts":1575053760000,"senderName":"domfarolino","senderId":"domfarolino@irc"},
{"content":{"body":"ta, sorry for the noise","msgtype":"m.text"},"ts":1575053770000,"senderName":"domfarolino","senderId":"domfarolino@irc"},
{"content":{"body":"PiersW: realise you may well not see this till next week, but if you want to talk about web-platform-tests at any point feel free to reach out","msgtype":"m.text"},"ts":1575064948000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"gsnedders: I'm about (for a bit). Thanks - we run them under CI. They're very helpful in ensuring we've understood the specs. Currently a subset (pointless to run ones which we don't even attempt to implement), but that subset increases every month or so.","msgtype":"m.text"},"ts":1575065189000,"senderName":"PiersW","senderId":"PiersW@irc"},
{"content":{"body":"PiersW: are you using wptrunner or some custom runner? if the latter, how are you making sure you keep up-to-date on various changes?","msgtype":"m.text"},"ts":1575065868000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Custom runner, for historic reasons. Just update it occasionally. Not often enough.","msgtype":"m.text"},"ts":1575066116000,"senderName":"PiersW","senderId":"PiersW@irc"},
{"content":{"body":"PiersW: given we have a generic WebDriver (and a somewhat less maintained Selenium) runner in wptrunner, I'd hope it wouldn't be too hard to get it running under that FWIW.","msgtype":"m.text"},"ts":1575066175000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Bolted it on to our pre-existing test harness. In hindsight that might not've been too sensible (I wasn't involved because... because... it's written in blimmin' emacs lisp.)","msgtype":"m.text"},"ts":1575066195000,"senderName":"PiersW","senderId":"PiersW@irc"},
{"content":{"body":"ah, we have selenium/web driver support. I didn't realise that.","msgtype":"m.text"},"ts":1575066251000,"senderName":"PiersW","senderId":"PiersW@irc"},
{"content":{"body":"PiersW: am happy to talk more about this at some point, probably when both of us are more around","msgtype":"m.text"},"ts":1575066351000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"PiersW: hell, you can probably convince me to come up to Cambridge easily enough","msgtype":"m.text"},"ts":1575066370000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Sure. Oh, that could work. Where are you? London?","msgtype":"m.text"},"ts":1575066418000,"senderName":"PiersW","senderId":"PiersW@irc"},
{"content":{"body":"We could come down, too, if that works. The guy who wrote our emacs wpt import script lives in London.","msgtype":"m.text"},"ts":1575066479000,"senderName":"PiersW","senderId":"PiersW@irc"},
{"content":{"body":"PiersW: both myself and jgraham who deal with most of the WPT infra stuff are in London","msgtype":"m.text"},"ts":1575066515000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Personally, I'd be happy to have an excuse to go to Cambridge for a day :)","msgtype":"m.text"},"ts":1575066534000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"But, like, if that means people from London on your side especailly going into your office then it's probably less worthhwile","msgtype":"m.text"},"ts":1575066566000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Heh. Nah, he commutes up to here. But I'm sure he'd be happy not to.","msgtype":"m.text"},"ts":1575066618000,"senderName":"PiersW","senderId":"PiersW@irc"},
{"content":{"body":"I guess it partly depends on how many other people it makes sense to have involved in any discussion.","msgtype":"m.text"},"ts":1575066694000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Well, one person here wrote the selenium stuff, another did the wpt import integration, and the rest of us just test against them. I've never got involved in the infrastructure part, just testing against them.","msgtype":"m.text"},"ts":1575066808000,"senderName":"PiersW","senderId":"PiersW@irc"},
{"content":{"body":"They're very, very, helpful for regression testing. Couldn't write a browser without 'em.","msgtype":"m.text"},"ts":1575066837000,"senderName":"PiersW","senderId":"PiersW@irc"},
{"content":{"body":"PiersW: also happy to talk more generally about contributing any tests you do write upstream :)","msgtype":"m.text"},"ts":1575067009000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"(obviously there's very much limits to how much I can do on time I get paid for general WPT work, but I do have time if you want to talk about paying me directly to do anything related)","msgtype":"m.text"},"ts":1575067111000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Yeah, we should... Our own test system is less structured so easier to create a test for (can do a simple render text dump comparison, screen bitmap comparison or console comparison).","msgtype":"m.text"},"ts":1575067137000,"senderName":"PiersW","senderId":"PiersW@irc"},
{"content":{"body":"Do you know emacs lisp? :-)","msgtype":"m.text"},"ts":1575067379000,"senderName":"PiersW","senderId":"PiersW@irc"},
{"content":{"body":"I might be an emacs users, but not really. :)","msgtype":"m.text"},"ts":1575067429000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"s/users/user/","msgtype":"m.text"},"ts":1575067437000,"senderName":"gsnedders","senderId":"gsnedders@irc"}
]