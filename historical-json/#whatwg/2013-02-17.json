[
{"content":{"body":"http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#drawing-images","msgtype":"m.text"},"ts":1361062240000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"\"","msgtype":"m.text"},"ts":1361062249000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"When the source rectangle is outside the source image, it must be clipped to the source image, and the destination rectangle must be clipped in the same proportion.","msgtype":"m.text"},"ts":1361062250000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"\"","msgtype":"m.text"},"ts":1361062250000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"(whoops, didn't mean to paste line breaks). Is it possible to specify how this clipping is done? Firefox w/out acceleration, Firefox w/ acceleration and Chrome all seem to do different things.","msgtype":"m.text"},"ts":1361062287000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"See: http://magcius.github.com/xserver.js/copyimage.html (press any key repeatedly)","msgtype":"m.text"},"ts":1361062314000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"Firefox w/ acceleration seems to do naive clipping and stretches the image. Chrome doesn't seem to draw anything, it just aborts the request, and Firefox w/out acceleration smartly clips the source and destination so that it's as if you just drew on a larger canvas, and then clipped it.","msgtype":"m.text"},"ts":1361062398000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"Jasper: not possible to specify what it should be exactly but iirc we do specify what it should be","msgtype":"m.text"},"ts":1361069483000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"Hixie, as far as I can tell, it doesn't specify how things should be clipped anywhere.","msgtype":"m.text"},"ts":1361069558000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"what rendering do you disagree with that you think the spec allows?","msgtype":"m.text"},"ts":1361069607000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"Hixie, well, let's assume a 50x50 canvas and we do drawImage(20, 20, 20, 20, 40, 40, 20, 20);","msgtype":"m.text"},"ts":1361069710000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"It might be interpreted as drawImage(20, 20, 20, 20, 40, 40, 10, 10);, which basically clips the extents","msgtype":"m.text"},"ts":1361069742000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"with the drawImage image being that canvas, or another image? i'm confused, what are we drawing on what","msgtype":"m.text"},"ts":1361069752000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"Hixie, does it matter what the source is?","msgtype":"m.text"},"ts":1361069783000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"My demo above uses the same canvas as the source, but that really doesn't matter, I think.","msgtype":"m.text"},"ts":1361069821000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"the part of the spec you quoted is all about the source, so yes :-)","msgtype":"m.text"},"ts":1361069823000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"Hixie, ah, right. Just assume that the source is big enough. It's the destination I care about.","msgtype":"m.text"},"ts":1361069875000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"then the part you quoted is of no relevance :-)","msgtype":"m.text"},"ts":1361069900000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"looks at the spec","msgtype":"m.emote"},"ts":1361069902000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"\"and the destination rectangle must be clipped in the same proportion\"","msgtype":"m.text"},"ts":1361069917000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"I'm assuming that means \"to the destination image\"","msgtype":"m.text"},"ts":1361069922000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"not \"to the source image\"","msgtype":"m.text"},"ts":1361069927000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"what's only \"When the source rectangle is outside the source image\"","msgtype":"m.text"},"ts":1361069932000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"Hixie, it's very ambiguous","msgtype":"m.text"},"ts":1361069962000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"how is that ambiguous?","msgtype":"m.text"},"ts":1361069975000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"I initially read it as \"and the destination rectangle must be clipped in the same proportion\" as expanding to \"... When the destination rectangle is outside the destination image, it must be clipped to the destination image\"","msgtype":"m.text"},"ts":1361070029000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"anyway, to answer your original question, looks like the spec doesn't say anything special about what happens when you paint outside the dest, so you're just required to do it, and the pixels that land outside the scratch bitmap are never used","msgtype":"m.text"},"ts":1361070034000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"ah, ok","msgtype":"m.text"},"ts":1361070046000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"yeah that wasn't intended","msgtype":"m.text"},"ts":1361070051000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"let me fix that","msgtype":"m.text"},"ts":1361070057000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"I think it would be useful to specify a behavior for what happens when you paint outside the dest, and I think the render being the same as if you had an infinite canvas.","msgtype":"m.text"},"ts":1361070118000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"yes, that's what the spec intends","msgtype":"m.text"},"ts":1361070134000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"Right. Only Firefox w/out acceleration does that correctly for going past the width/height.","msgtype":"m.text"},"ts":1361070155000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"None of the browsers handle negative destination coordinates well.","msgtype":"m.text"},"ts":1361070170000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"At least, none that I tested (Chrome Dev Channel, Firefox Nightly w/ and w/out acceleration, IE10 Preview Release)","msgtype":"m.text"},"ts":1361070225000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"what do they do?","msgtype":"m.text"},"ts":1361070239000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"Chrome just aborts the drawImage.","msgtype":"m.text"},"ts":1361070265000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"o_O","msgtype":"m.text"},"ts":1361070273000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"Yeah.","msgtype":"m.text"},"ts":1361070285000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"you sure? works for me...","msgtype":"m.text"},"ts":1361070322000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"e.g. http://software.hixie.ch/utilities/js/canvas/?c.clearRect(0%2C%200%2C%20640%2C%20480)%3B%0Ac.save()%3B%0Atry%20%7B%0A%20%20c.drawImage(img1%2C%2010%2C10%2C50%2C50%2C%20-20%2C-20%2C50%2C50)%3B%0A%7D%20finally%20%7B%0A%20%20c.restore()%3B%0A%7D%0A","msgtype":"m.text"},"ts":1361070334000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"http://magcius.github.com/xserver.js/copyimage.html","msgtype":"m.text"},"ts":1361070344000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"Hold down any key.","msgtype":"m.text"},"ts":1361070348000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"No idea if that's a special code path.","msgtype":"m.text"},"ts":1361070360000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"i don't understand what that page is doing","msgtype":"m.text"},"ts":1361070369000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"can you make a simpler test case?","msgtype":"m.text"},"ts":1361070377000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"I can try.","msgtype":"m.text"},"ts":1361070383000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"(you can use http://software.hixie.ch/utilities/js/canvas/ to save time)","msgtype":"m.text"},"ts":1361070400000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"(it makes writing canvas tests much easier)","msgtype":"m.text"},"ts":1361070405000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"Thanks.","msgtype":"m.text"},"ts":1361070448000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"That's really neat.","msgtype":"m.text"},"ts":1361070451000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"i just checked in http://html5.org/tools/web-apps-tracker?from=7723&to=7724 to the spec to try to clarify the requirement","msgtype":"m.text"},"ts":1361070480000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"i gotta go eat dinner, bbiab","msgtype":"m.text"},"ts":1361070487000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"Hixie, OK, so it seems to be weird interaction coming from the source rect going beyond the source image. So, it's intended, it's just not what I expected.","msgtype":"m.text"},"ts":1361071647000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"http://software.hixie.ch/utilities/js/canvas/?c.clearRect%280%2C%200%2C%20640%2C%20480%29%3B%0Ac.save%28%29%3B%0Atry%20{%0A%20%20var%20posX%20%3D%20c.canvas.width%20-%20img2.width%20%2B%2030%3B%0A%20%20var%20posY%20%3D%20c.canvas.height%20-%20img2.height%20%2B%2030%3B%0A%20%20c.drawImage%28img2%2C%20posX%2C%20posY%29%3B%0A%20%20c.drawImage%28c.canvas%2C%20posX%2C%20posY%2C%20img2.width%2C%20img2.height%2C%20posX%2B20%2C%20posY%2B20%2C%20img2.width%2C","msgtype":"m.text"},"ts":1361071899000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"%20img2.height%29%3B%0A}%20finally%20{%0A%20%20c.restore%28%29%3B%0A}%0A","msgtype":"m.text"},"ts":1361071899000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"yikes, IRC doesn't like that","msgtype":"m.text"},"ts":1361071904000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"the cat grows larger, which isn't really what I expected for something where we're only modifying the position","msgtype":"m.text"},"ts":1361071926000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"that's in Firefox w/ acceleration. In Chrome, it doesn't like it at all, and draws one cat.","msgtype":"m.text"},"ts":1361071948000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"Similar cases happen for negative coordiantes as well.","msgtype":"m.text"},"ts":1361071964000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"Perhaps there should be a special case for the source and destination being the same?","msgtype":"m.text"},"ts":1361071987000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"Jasper: weird, i don't understand why chrome doesn't render the cat in that one","msgtype":"m.text"},"ts":1361077270000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"Hixie, do you think that Firefox stretching the image is correct?","msgtype":"m.text"},"ts":1361077303000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"I'd have to work out the math of how the source and destination rectangle combine.","msgtype":"m.text"},"ts":1361077322000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"it should look exactly like it would with -30 instead of +30, except shifted over","msgtype":"m.text"},"ts":1361077327000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"Hixie, OK, so should I file browser bugs?","msgtype":"m.text"},"ts":1361077416000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"yeah","msgtype":"m.text"},"ts":1361077446000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"cc me if you do? ian⊙hc","msgtype":"m.text"},"ts":1361077449000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"OK.","msgtype":"m.text"},"ts":1361077458000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"test case at http://goo.gl/VFSGn","msgtype":"m.text"},"ts":1361077486000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"shows the problem well","msgtype":"m.text"},"ts":1361077488000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"Hixie, I don't know how to CC you on the Chromium issues tracker, so here: https://code.google.com/p/chromium/issues/detail?id=176714","msgtype":"m.text"},"ts":1361077810000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"thanks","msgtype":"m.text"},"ts":1361077818000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"That's a great testcase. I'll use it for the Firefox bug as well.","msgtype":"m.text"},"ts":1361077835000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"thanks a ton for filing the bugs, btw","msgtype":"m.text"},"ts":1361077857000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"much appreciated","msgtype":"m.text"},"ts":1361077863000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"I work on a big open-source project as well -- I know how it feels to not get bugs reported.","msgtype":"m.text"},"ts":1361078058000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"Thanks for being patient.","msgtype":"m.text"},"ts":1361078058000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"Hixie, filed FF bug, CC'd you at https://bugzilla.mozilla.org/show_bug.cgi?id=842110","msgtype":"m.text"},"ts":1361078327000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"ta","msgtype":"m.text"},"ts":1361078340000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"Jasper, what are the upload / download buttons and the textarea supposed to do?","msgtype":"m.text"},"ts":1361083694000,"senderName":"dbaron","senderId":"dbaron@irc"},
{"content":{"body":"Jasper, are they testcase-writing tools or part of the actual testcase?","msgtype":"m.text"},"ts":1361083711000,"senderName":"dbaron","senderId":"dbaron@irc"},
{"content":{"body":"dbaron, I didn't write the harness, Hixie did.","msgtype":"m.text"},"ts":1361083717000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"Jasper, when filing bugs, it's really useful to just have the testcase","msgtype":"m.text"},"ts":1361083729000,"senderName":"dbaron","senderId":"dbaron@irc"},
{"content":{"body":"dbaron, they're not part of the testcaews","msgtype":"m.text"},"ts":1361083729000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"They apparently POST something to clipboard.cgi. I don't know what that does.","msgtype":"m.text"},"ts":1361083800000,"senderName":"Jasper","senderId":"Jasper@irc"},
{"content":{"body":"Jasper: It's uploading/downloading to/from a global shared clipboard","msgtype":"m.text"},"ts":1361093645000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"which is quite useful if you're trying to develop a test on multiple devices","msgtype":"m.text"},"ts":1361093668000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"though obviously it's totally non-scalable and in theory it can't possibly work (though in practice it does work, like a lot of Hixie's crazy ideas)","msgtype":"m.text"},"ts":1361093735000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"sort of wish indexeddb followed mongo's data model; it works well, and is very simple (especially since it essentially needs no explicit transactions at all)","msgtype":"m.text"},"ts":1361115908000,"senderName":"zewt","senderId":"zewt@irc"},
{"content":{"body":"2004 is dead. Long live 2004! https://brendaneich.com/2004/06/the-non-world-non-wide-non-web/","msgtype":"m.text"},"ts":1361121340000,"senderName":"GPHemsley","senderId":"GPHemsley@irc"}
]