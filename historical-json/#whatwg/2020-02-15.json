[
{"content":{"body":"is the functionality requested here something that browsers are able to do (and therefore something that js engines implement)? https://github.com/nodejs/node/issues/31807","msgtype":"m.text"},"ts":1581753795000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"devsnek: yes","msgtype":"m.text"},"ts":1581788679000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"https://html.spec.whatwg.org/#creating-browsing-contexts:concept-windowproxy-window","msgtype":"m.text"},"ts":1581788703000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Well, I'm not sure","msgtype":"m.text"},"ts":1581788765000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Browsers don't change a realm's global after the fact","msgtype":"m.text"},"ts":1581788774000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"They keep the global and globalThis the same","msgtype":"m.text"},"ts":1581788781000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"And change an internal property of the globalThis","msgtype":"m.text"},"ts":1581788790000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"But they don't interface with the ES spec more than at setup time","msgtype":"m.text"},"ts":1581788809000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Maybe they do interface with V8 more than at setup time, to make things fast, I dunno.","msgtype":"m.text"},"ts":1581788824000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Domenic: so if they're just changing some internal slot","msgtype":"m.text"},"ts":1581789549000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"that probably isn't a thing js engines themselves implement","msgtype":"m.text"},"ts":1581789562000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"its just changing some variable somewhere","msgtype":"m.text"},"ts":1581789568000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"a private symbol or a c++ field or smth","msgtype":"m.text"},"ts":1581789579000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"I'm not sure; I kind of doubt JS/web engines map 1:1 with specs for this sort of low-level stuff","msgtype":"m.text"},"ts":1581789598000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"But yeah in theory if Node already provided a way to create a realm with separate globalThis and global then this could be implemented 1:1 with the spec with nothing further","msgtype":"m.text"},"ts":1581789618000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"I guess what you really need though is some kind of \"instruction for creating global and globalThis\" since the objects need to be created in the new realm","msgtype":"m.text"},"ts":1581789668000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"well, at least global; I guess globalThis the realm doesn't matter since it just delegates all obervable properties to another object created inside the new realm","msgtype":"m.text"},"ts":1581789726000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"ok i think i figured it out","msgtype":"m.text"},"ts":1581790041000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"with v8 when you pass an object to become the global, the internal map gets wiped, it just retains identity","msgtype":"m.text"},"ts":1581790074000,"senderName":"devsnek","senderId":"devsnek@irc"}
]