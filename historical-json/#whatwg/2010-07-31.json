[
{"content":{"body":"so only Mozilla has implemented ele.spellcheck and they do it as a boolean rather than enumerable attribute as the spec requires?","msgtype":"m.text"},"ts":1280576520000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: Yes","msgtype":"m.text"},"ts":1280576521000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"I guess the spec wanted it to be in sync with .contentEditable","msgtype":"m.text"},"ts":1280576580000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"hybi list fail - Thomas was blue not green. Henry was green. (and James was red)","msgtype":"m.text"},"ts":1280576581000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"maybe even on my request","msgtype":"m.text"},"ts":1280576582000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"jgraham, euh?!","msgtype":"m.text"},"ts":1280576640000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Yeah, I think the spec isn't going to happen","msgtype":"m.text"},"ts":1280576641000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"annevk: Greg's extension of Hixie's transport analogy had a vehicle that is green, runs on rails, and answers to the name Thomas","msgtype":"m.text"},"ts":1280576700000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"But Thomas was blue","msgtype":"m.text"},"ts":1280576701000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"(possibly Thomas the Tank Engine is an Anglo-American curio)","msgtype":"m.text"},"ts":1280576760000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"Filed a bug on spellcheck.","msgtype":"m.text"},"ts":1280576820000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: I already filed a bug indicating that throwing SYNTAX_ERR wasn't going to work","msgtype":"m.text"},"ts":1280576821000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"annevk: I added an \"HTML elements organized by function\" section to the HtmlR doc -","msgtype":"m.text"},"ts":1280579100000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"http://dev.w3.org/html5/markup/elements-by-function.html","msgtype":"m.text"},"ts":1280579101000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"(I think you had suggested it should have one)","msgtype":"m.text"},"ts":1280579102000,"senderName":"MikeSmith","senderId":"MikeSmith@irc"},
{"content":{"body":"ah yeah","msgtype":"m.text"},"ts":1280581440000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk, I want to do some very light DOM manipulation in PHP and intend to use html5lib to get the DOM. Two question: First, is that a good choice? Second, what solution would you recommend to manipulate said DOM in PHP?","msgtype":"m.text"},"ts":1280581441000,"senderName":"erlehmann_","senderId":"erlehmann_@irc"},
{"content":{"body":"well, I suggested the main draft would be done in that way, but I suppose this works too","msgtype":"m.text"},"ts":1280581442000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"erlehmann_, I don't have experience with the PHP html5lib unfortunately","msgtype":"m.text"},"ts":1280581443000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"erlehmann, nor with PHP DOM manipulation :(","msgtype":"m.text"},"ts":1280581500000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"erlehmann, though overall that sounds like the best way if you plan on using PHP","msgtype":"m.text"},"ts":1280581501000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"just saw you as project owner on google code. that's the python part then, right?","msgtype":"m.text"},"ts":1280581502000,"senderName":"erlehmann","senderId":"erlehmann@irc"},
{"content":{"body":"erlehmann: Well I think PHP isn't a good choice :)","msgtype":"m.text"},"ts":1280581560000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"But if hat is a constraint then html5lib is a good choice for parsing the HTML ","msgtype":"m.text"},"ts":1280581561000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"as long as speed is not your main concern","msgtype":"m.text"},"ts":1280581562000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"gsnedders and ezyang were mainly responsible for the PHP verson","msgtype":"m.text"},"ts":1280581620000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"jgraham, i agree wholeheartedly. when i applied for an internship in early 2008 and they asked me if i knew PHP, i told them why i hate it.","msgtype":"m.text"},"ts":1280581621000,"senderName":"erlehmann","senderId":"erlehmann@irc"},
{"content":{"body":"erlehmann, oh, yeah, I did the original Python version in part way back though jgraham knows and did more :)","msgtype":"m.text"},"ts":1280581622000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"but right now i have a gsoc project to finish.","msgtype":"m.text"},"ts":1280581623000,"senderName":"erlehmann","senderId":"erlehmann@irc"},
{"content":{"body":"and since i am writing a wordpress plugin … well ;)","msgtype":"m.text"},"ts":1280581680000,"senderName":"erlehmann","senderId":"erlehmann@irc"},
{"content":{"body":"Ah","msgtype":"m.text"},"ts":1280581681000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"You chose the wrong problem","msgtype":"m.text"},"ts":1280581682000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":":)","msgtype":"m.text"},"ts":1280581683000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"It is at least worth trying using PHP html5lib","msgtype":"m.text"},"ts":1280581740000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"probably. but all my friends are using wordpress.","msgtype":"m.text"},"ts":1280581741000,"senderName":"erlehmann","senderId":"erlehmann@irc"},
{"content":{"body":"and me too. though i will look into habari Really Soon Now [TM]","msgtype":"m.text"},"ts":1280581742000,"senderName":"erlehmann","senderId":"erlehmann@irc"},
{"content":{"body":"That's PHP too, right?","msgtype":"m.text"},"ts":1280581800000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"yeah. i should probably bully my hoster into getting me some WSGI goodness so i can install a python-based imageboard instead of my boring old blog.","msgtype":"m.text"},"ts":1280581801000,"senderName":"erlehmann","senderId":"erlehmann@irc"},
{"content":{"body":"i'll look if PHP Simple HTML DOM Parser does it for me. i do not have that many edge cases and it looks nice and usable.","msgtype":"m.text"},"ts":1280581980000,"senderName":"erlehmann","senderId":"erlehmann@irc"},
{"content":{"body":"The PHP html5lib is really quite out of date","msgtype":"m.text"},"ts":1280585820000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"There's access to the libxml HTML parser from the DOM extension","msgtype":"m.text"},"ts":1280585821000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"jgraham: yeah i considered saying gordon was green and thomas wasn't an eletric locomotive, but i figured that was maybe being pedantic about hte wrong thing :-)","msgtype":"m.text"},"ts":1280603460000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"wait, gordon was blue","msgtype":"m.text"},"ts":1280603520000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"man it's been too long","msgtype":"m.text"},"ts":1280603521000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"(or possibly not long enough)","msgtype":"m.text"},"ts":1280603522000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"The former","msgtype":"m.text"},"ts":1280603580000,"senderName":"Workshiva","senderId":"Workshiva@irc"},
{"content":{"body":"now you mention trains, apparently there's a Marklin shop here in Utrecht","msgtype":"m.text"},"ts":1280603581000,"senderName":"annevk5","senderId":"annevk5@irc"},
{"content":{"body":"Thomas is awesome","msgtype":"m.text"},"ts":1280603582000,"senderName":"Workshiva","senderId":"Workshiva@irc"},
{"content":{"body":"thought of your train set when I saw that :)","msgtype":"m.text"},"ts":1280603583000,"senderName":"annevk5","senderId":"annevk5@irc"},
{"content":{"body":":-)","msgtype":"m.text"},"ts":1280603640000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"gordon was indeed blue","msgtype":"m.text"},"ts":1280603940000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"Gordon was the fat Thomas","msgtype":"m.text"},"ts":1280603941000,"senderName":"Workshiva","senderId":"Workshiva@irc"},
{"content":{"body":"That's how I always thought of him","msgtype":"m.text"},"ts":1280603942000,"senderName":"Workshiva","senderId":"Workshiva@irc"},
{"content":{"body":"thomas was a switcher, gordon was for long haul... though i don't think the people who wrote the stories understood the difference","msgtype":"m.text"},"ts":1280604000000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"Percy was the green one.","msgtype":"m.text"},"ts":1280604060000,"senderName":"Lachy","senderId":"Lachy@irc"},
{"content":{"body":"finally realizes what you're on about","msgtype":"m.emote"},"ts":1280604120000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Oh man… Bunch of kids.","msgtype":"m.text"},"ts":1280604121000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Yeah, that hurts bad coming from you","msgtype":"m.text"},"ts":1280604240000,"senderName":"Workshiva","senderId":"Workshiva@irc"},
{"content":{"body":"Heh, I see that I didn't make abarth's list of people from browser vendors who are worth listening to","msgtype":"m.text"},"ts":1280604420000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"I guess I should try harder or something","msgtype":"m.text"},"ts":1280604421000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"Maybe he doesn't know you're from a browser vendor","msgtype":"m.text"},"ts":1280604480000,"senderName":"Workshiva","senderId":"Workshiva@irc"},
{"content":{"body":"I suppose that is possible","msgtype":"m.text"},"ts":1280604481000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"But it seems unlikely","msgtype":"m.text"},"ts":1280604540000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"jgraham: The list was only a \"for example\", and looks like it's intentionally listing one person per browser vendor","msgtype":"m.text"},"ts":1280604660000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"Hixie: How does you writing a separate Web Sockets spec to the IETF one help? Would you keep writing your spec if browser buy-in stuck with the IETF branch?","msgtype":"m.text"},"ts":1280604720000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"gsnedders: no, if browsers aren't on board it's like with websql, i'd stop editing","msgtype":"m.text"},"ts":1280604780000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"Hixie: That wasn't quite clear on the list.","msgtype":"m.text"},"ts":1280604781000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"well if i didn't i'd just be writing pointless fiction that didn't affect anyone anyway","msgtype":"m.text"},"ts":1280604840000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"so it's rather moot","msgtype":"m.text"},"ts":1280604841000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"Philip`: But I want to be important :p","msgtype":"m.text"},"ts":1280605020000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"jgraham: Clearly you need to eliminate the Opera employees before you in the ranking","msgtype":"m.text"},"ts":1280605080000,"senderName":"Workshiva","senderId":"Workshiva@irc"},
{"content":{"body":"That way you end up on the next list","msgtype":"m.text"},"ts":1280605081000,"senderName":"Workshiva","senderId":"Workshiva@irc"},
{"content":{"body":"jgraham: You could be just a smidgen behind annevk5 on the perceived importance scale","msgtype":"m.text"},"ts":1280605140000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"Or you could be right at the bottom","msgtype":"m.text"},"ts":1280605141000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"so you should eliminate every single Opera employee, just to be sure","msgtype":"m.text"},"ts":1280605200000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"Hmm","msgtype":"m.text"},"ts":1280605201000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"How to kill the dutch?","msgtype":"m.text"},"ts":1280605260000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"you'd be pretty important if you went on a rampaging homocide stream, but i'd urge you to consider if that's the right kind of importance for you","msgtype":"m.text"},"ts":1280605261000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"Maybe make a series of tiny holes in their levees","msgtype":"m.text"},"ts":1280605262000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"streak, even","msgtype":"m.text"},"ts":1280605263000,"senderName":"Hixie","senderId":"Hixie@irc"},
{"content":{"body":"You could crash the tulip market","msgtype":"m.text"},"ts":1280605264000,"senderName":"Workshiva","senderId":"Workshiva@irc"},
{"content":{"body":"All of this sounds like too much effort really","msgtype":"m.text"},"ts":1280605500000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"clearly abarth should be arrested for inciting violence","msgtype":"m.text"},"ts":1280605501000,"senderName":"annevk5","senderId":"annevk5@irc"},
{"content":{"body":"I think I will just have to develop a zen-like perspective on my own insignificance","msgtype":"m.text"},"ts":1280605560000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"is this my cue for saying you're not? or something? ;p","msgtype":"m.text"},"ts":1280605680000,"senderName":"annevk5","senderId":"annevk5@irc"},
{"content":{"body":"No","msgtype":"m.text"},"ts":1280605681000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"I am developing an indifference to it, remember","msgtype":"m.text"},"ts":1280605682000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"If you say I'm not it will only confuse and upset me","msgtype":"m.text"},"ts":1280605683000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"So I might go back to plotting to kill the Dutch","msgtype":"m.text"},"ts":1280605740000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"I think I stand by my original statement","msgtype":"m.text"},"ts":1280605741000,"senderName":"annevk5","senderId":"annevk5@irc"},
{"content":{"body":"I had forgotten about Percy","msgtype":"m.text"},"ts":1280606280000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"Is it me or does Sordor sound uncomfortably like Mordor","msgtype":"m.text"},"ts":1280606340000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"I would never have liked Thomas The Tank Engine so much if I had thought he was mainly carrying Orcs","msgtype":"m.text"},"ts":1280606400000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"s/Sordor/Sodor/","msgtype":"m.text"},"ts":1280606401000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"Which I guess makes a difference","msgtype":"m.text"},"ts":1280606402000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"But still","msgtype":"m.text"},"ts":1280606460000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"Time to make me hate zcorpan again, and bring PHP html5lib up to date","msgtype":"m.text"},"ts":1280607660000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Uh, the Python tests don't run for me","msgtype":"m.text"},"ts":1280607840000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"jgraham: You broke running tests with UTF-16 Python","msgtype":"m.text"},"ts":1280607900000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"gsnedders: Ah, I think I expected that","msgtype":"m.text"},"ts":1280608680000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"I may even have mentioned it in the commit log","msgtype":"m.text"},"ts":1280608681000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"But I had no easy way to test","msgtype":"m.text"},"ts":1280608682000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"gsnedders: (that is a lame excuse, yes, but I didn't really have time to fix it then)","msgtype":"m.text"},"ts":1280608740000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"gsnedders: http://code.google.com/p/html5lib/source/detail?r=964568c175092c45156fe5a32a211e0d5d3781d8","msgtype":"m.text"},"ts":1280608800000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"Probably","msgtype":"m.text"},"ts":1280608801000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"jgraham: There's lots of breakage, not just that","msgtype":"m.text"},"ts":1280608802000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Oh","msgtype":"m.text"},"ts":1280608860000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"Like, creating http://code.google.com/p/html5lib/source/detail?r=964568c175092c45156fe5a32a211e0d5d3781d8","msgtype":"m.text"},"ts":1280608861000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Um, wrong clipboard","msgtype":"m.text"},"ts":1280608862000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"encode_entity_map","msgtype":"m.text"},"ts":1280608863000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"That throws an exception. :)","msgtype":"m.text"},"ts":1280608864000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Which means import html5lib fails :)","msgtype":"m.text"},"ts":1280608920000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"gsnedders: That has nothing to do with me","msgtype":"m.text"},"ts":1280608921000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"Possibly","msgtype":"m.text"},"ts":1280608922000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"Unless it was adding more entities that broke it","msgtype":"m.text"},"ts":1280608923000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"Which is just silly","msgtype":"m.text"},"ts":1280608924000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"Adding non-BMP entities for the first time would","msgtype":"m.text"},"ts":1280609040000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Now, to actually get tests passing instead of merely running","msgtype":"m.text"},"ts":1280609041000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Huh, now I really don't get what's going on.","msgtype":"m.text"},"ts":1280610000000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"I appear to be hitting a data corruption bug in Python","msgtype":"m.text"},"ts":1280610001000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Hah. This is awesome.","msgtype":"m.text"},"ts":1280610120000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Negative lookbehind assertion in regexp causing data corruption.","msgtype":"m.text"},"ts":1280610180000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Got a test case?","msgtype":"m.text"},"ts":1280610240000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"Oh, no","msgtype":"m.text"},"ts":1280610300000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"I see what's going on","msgtype":"m.text"},"ts":1280610301000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Hah, that is evil.","msgtype":"m.text"},"ts":1280610360000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"I can't write code.","msgtype":"m.text"},"ts":1280610361000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Also: I just introduced a bug without breaking any tests.","msgtype":"m.text"},"ts":1280610420000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"We need more tests.","msgtype":"m.text"},"ts":1280610421000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"What bug?","msgtype":"m.text"},"ts":1280610480000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"Stripping lone surrogate bytes would also strip the byte where the other half of the surrogate should be","msgtype":"m.text"},"ts":1280610600000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"You would always remove two bytes rather than one?","msgtype":"m.text"},"ts":1280610601000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"Four bytes, two characters.","msgtype":"m.text"},"ts":1280610720000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"So a test with {lone surrogate}{other} -> {replacemnt}{other} would be sufficient to test it","msgtype":"m.text"},"ts":1280610721000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"Yeah, I've added that","msgtype":"m.text"},"ts":1280610780000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"https://code.google.com/p/html5lib/source/detail?r=46df29539c714df260a18f280dfeaf96e7af62c5","msgtype":"m.text"},"ts":1280610781000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Hah, byte counting fail :)","msgtype":"m.text"},"ts":1280610782000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"I haven't tested on UCS4, but I've made no change to the code it uses effectively","msgtype":"m.text"},"ts":1280610900000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"wonders where his UCS4 build is","msgtype":"m.emote"},"ts":1280610901000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"gsnedders: I'm glad it was clear how I intended it to be patched for the UCS2 case :)","msgtype":"m.text"},"ts":1280610902000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"gsnedders: Why remove the null from the regexp?","msgtype":"m.text"},"ts":1280610960000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"Surely it is faster with it in?","msgtype":"m.text"},"ts":1280610961000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"More common code.","msgtype":"m.text"},"ts":1280611020000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Also, your patch is wrong","msgtype":"m.text"},"ts":1280611021000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"How?","msgtype":"m.text"},"ts":1280611022000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"It doesn't take account of lone surrogates at the end of chunks","msgtype":"m.text"},"ts":1280611023000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"That's not a new issue","msgtype":"m.text"},"ts":1280611080000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Isn't it?","msgtype":"m.text"},"ts":1280611140000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"Well, we at least throw parse errors in that case","msgtype":"m.text"},"ts":1280611141000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"So it would fail tokenizer tests for that","msgtype":"m.text"},"ts":1280611142000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Can you actually end up with a non-lone surrogate at the end of the chunk in the UCS4 case?","msgtype":"m.text"},"ts":1280611200000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"i.e. can you actually split the surrogate pair?","msgtype":"m.text"},"ts":1280611260000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"It depends if we are reading bytes or characters","msgtype":"m.text"},"ts":1280611320000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"In the UCS4 case? No, you can never have a valid surrogate.","msgtype":"m.text"},"ts":1280611321000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"In the UCS2 case? Sure.","msgtype":"m.text"},"ts":1280611380000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Right, so we don't have the bug in the UCS4 case","msgtype":"m.text"},"ts":1280611381000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"So the UCS2 patch is wrong in the sense that it misses a case that the UCS4 code covers","msgtype":"m.text"},"ts":1280611440000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"Indeed","msgtype":"m.text"},"ts":1280611500000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"But the UCS2 behaviour is already wrong in that case","msgtype":"m.text"},"ts":1280611501000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"And I've not made it any worse than it was before","msgtype":"m.text"},"ts":1280611502000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Agreed","msgtype":"m.text"},"ts":1280611503000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"But the patch is still wrong :)","msgtype":"m.text"},"ts":1280611504000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"The patch is right, just incomplete. ;P","msgtype":"m.text"},"ts":1280611505000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"However you want to think of it","msgtype":"m.text"},"ts":1280611506000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"(it seems like since you are fixing it now, this would be a good time to make it right because otherwise we will have a subtle bug that will almost never happen but be reasonably surprising when it does)","msgtype":"m.text"},"ts":1280611560000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"(you need to do roughly the same thing as the CR thing","msgtype":"m.text"},"ts":1280611680000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"but bonus points for making it not that ugly)","msgtype":"m.text"},"ts":1280611740000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"It's harder than the CR thing","msgtype":"m.text"},"ts":1280611800000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"the CR thing is easy because you can just convert it to \\n and ignore a LF in the next chunk","msgtype":"m.text"},"ts":1280611801000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"In this case you can't known what the right behaviour is until you get the next chunk… if there is a next chunk.","msgtype":"m.text"},"ts":1280611860000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Can you just stick the character onto the front of the next chunk?","msgtype":"m.text"},"ts":1280612100000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"That might work","msgtype":"m.text"},"ts":1280612101000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"or, uh, something like that","msgtype":"m.text"},"ts":1280612102000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"has no idea how the code works really","msgtype":"m.emote"},"ts":1280612103000,"senderName":"Philip`","senderId":"Philip`@irc"},
{"content":{"body":"Philip`: What if there's no next chunk?","msgtype":"m.text"},"ts":1280612104000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"(That's the problem with that solution)","msgtype":"m.text"},"ts":1280612160000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"gsnedders: You just make sure that having a character in the unget buffer menas there is a next chunk","msgtype":"m.text"},"ts":1280612161000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"Which I think is straightforward with the current code","msgtype":"m.text"},"ts":1280612220000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"(just do data = self._danglingCharacter + self.dataStream.read(chunkSize)","msgtype":"m.text"},"ts":1280612400000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"and then if some_regexp.match(data[-1]): self._danglingCharacter = data[-1]; data = data[:-1]; else: self._danglingCharacter = \"\"","msgtype":"m.text"},"ts":1280612460000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":")","msgtype":"m.text"},"ts":1280612461000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"or something","msgtype":"m.text"},"ts":1280612462000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"There's not even any need for a regexp","msgtype":"m.text"},"ts":1280612520000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"(just use ord)","msgtype":"m.text"},"ts":1280612580000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"jgraham: I don't get how to use the unget buffer for that","msgtype":"m.text"},"ts":1280612640000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"With how unget works, that is","msgtype":"m.text"},"ts":1280612641000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"Like, there is no buffer for unget","msgtype":"m.text"},"ts":1280612760000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"gsnedders: I mean you have to create one","msgtype":"m.text"},"ts":1280612761000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"that's self._danglingCharacter above","msgtype":"m.text"},"ts":1280612762000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"Sorry, I don't think I was very clear","msgtype":"m.text"},"ts":1280612820000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"Really you're still not :)","msgtype":"m.text"},"ts":1280612880000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"gsnedders: All I'm saying is","msgtype":"m.text"},"ts":1280612940000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"If the last character is a \\r or an unpaired surrogate, make a property that points to that character and slice it off the end of the chunk","msgtype":"m.text"},"ts":1280613000000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"The next time we go to get a chunk, add it on the start","msgtype":"m.text"},"ts":1280613001000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"this is sure to work because the signal for \"we don't need no more chunks\" is that readChunk returns nothing","msgtype":"m.text"},"ts":1280613060000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"So there is a cost of one more cycle through readChunk if this is the last chunk","msgtype":"m.text"},"ts":1280613061000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"but that isn't very common so it can be slow","msgtype":"m.text"},"ts":1280613120000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"(we need to make sure we still do the right thing in that case of course)","msgtype":"m.text"},"ts":1280613121000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"Then the only special magic we need is to make sure we detect when the last character is special and save it for next time","msgtype":"m.text"},"ts":1280613180000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"Is that clearer, or am I talking nonsense?","msgtype":"m.text"},"ts":1280613181000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"That's clear","msgtype":"m.text"},"ts":1280613480000,"senderName":"gsnedders","senderId":"gsnedders@irc"},
{"content":{"body":"I guess one special case is if the document is _only_ a \\r character","msgtype":"m.text"},"ts":1280613600000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"then you save the character but get an empty chunk back","msgtype":"m.text"},"ts":1280613601000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"But you can probably deal with that where readChunk is called, or something","msgtype":"m.text"},"ts":1280613660000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"Or in readchunk I guess","msgtype":"m.text"},"ts":1280613840000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"Just by checking if length > 1 before you slice anything of","msgtype":"m.text"},"ts":1280613841000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"f","msgtype":"m.text"},"ts":1280613842000,"senderName":"jgraham","senderId":"jgraham@irc"},
{"content":{"body":"Which seems much simpler","msgtype":"m.text"},"ts":1280613843000,"senderName":"jgraham","senderId":"jgraham@irc"}
]