[
{"content":{"body":"andreubotella: nice find on the top-level await PR","msgtype":"m.text"},"ts":1607587558000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"littledan: so to be clear, I was mainly wondering about the principle that would expose encodeURI and not atob","msgtype":"m.text"},"ts":1607590303000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"littledan: my preference is to have a smaller starting point as that is what Worklets wanted but didn't get","msgtype":"m.text"},"ts":1607590331000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"oh, sorry if citing you is inaccurate there","msgtype":"m.text"},"ts":1607590335000,"senderName":"littledan","senderId":"littledan@irc"},
{"content":{"body":"hmm, I'll raise the smaller starting point in the next SES call","msgtype":"m.text"},"ts":1607590395000,"senderName":"littledan","senderId":"littledan@irc"},
{"content":{"body":"littledan: it's not a big deal, to be clear, and that's appreciated","msgtype":"m.text"},"ts":1607590430000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"I do think there is something to \"the JS spec has been a line for a long time, which has some reality to it\". but I understand if this is not a desirable thing to make even more visible.","msgtype":"m.text"},"ts":1607590470000,"senderName":"littledan","senderId":"littledan@irc"},
{"content":{"body":"I don't think that's really true for web developers, though maybe Node.js made it more apparent","msgtype":"m.text"},"ts":1607590604000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"I think it's true in the JS ecosystem of today in general, and web developers participate in that. It bleeds out already. It's legitimate to want to reduce it, but i would say it's already \"a thing\"","msgtype":"m.text"},"ts":1607594987000,"senderName":"littledan","senderId":"littledan@irc"},
{"content":{"body":"littledan: You think most web developers will be able to tell where encodeURI and atob sit?","msgtype":"m.text"},"ts":1607595055000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"I don't think there are many things that we can say most web developers know","msgtype":"m.text"},"ts":1607595200000,"senderName":"littledan","senderId":"littledan@irc"},
{"content":{"body":"Agreed, and they shouldn't have to ðŸ˜Š","msgtype":"m.text"},"ts":1607595276000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"AFAICT, when focus in in an iframe and the iframe navigates, the new document in the iframe gets focus. Firefox fires a focus event on the newly-loaded doc (roughly when requestAnimationFrame starts firing?). However, Chrome doesn't. However, clicking the iframe fires the focus event in Chrome, which suggests that in Chrome the new doc is in some weird state.","msgtype":"m.text"},"ts":1607609073000,"senderName":"hsivonen","senderId":"hsivonen@irc"},
{"content":{"body":"Demo: https://hsivonen.com/test/moz/navigation-focus/","msgtype":"m.text"},"ts":1607609098000,"senderName":"hsivonen","senderId":"hsivonen@irc"},
{"content":{"body":"Safari also doesn't fire the event in the iframe but also doesn't fire the event if the iframe is clicked, which suggests that Safari actually considers the navigated iframe properly focused (but without event upon loading)","msgtype":"m.text"},"ts":1607609762000,"senderName":"hsivonen","senderId":"hsivonen@irc"},
{"content":{"body":"hsivonen: in Different-Site I also have to click in Fx it seems","msgtype":"m.text"},"ts":1607609797000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: You have Fission enabled, right?","msgtype":"m.text"},"ts":1607609832000,"senderName":"hsivonen","senderId":"hsivonen@irc"},
{"content":{"body":"hsivonen: yes","msgtype":"m.text"},"ts":1607609835000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: That's the bug I'm investigating. :-)","msgtype":"m.text"},"ts":1607609849000,"senderName":"hsivonen","senderId":"hsivonen@irc"},
{"content":{"body":"It seems Chrome somehow does that \"weird state\" consistently","msgtype":"m.text"},"ts":1607609890000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: Note how in Firefox with Fission without my patch the focus moves out of the iframe","msgtype":"m.text"},"ts":1607609892000,"senderName":"hsivonen","senderId":"hsivonen@irc"},
{"content":{"body":"That is, in Fission, the outer document changes `activeElement` away from the iframe","msgtype":"m.text"},"ts":1607609914000,"senderName":"hsivonen","senderId":"hsivonen@irc"},
{"content":{"body":"I think both the non-Fission Firefox and Safari behavior are defensible, but the Chrome behavior is weird.","msgtype":"m.text"},"ts":1607609979000,"senderName":"hsivonen","senderId":"hsivonen@irc"},
{"content":{"body":"hsivonen: Safari TP does the same as Chrome for me","msgtype":"m.text"},"ts":1607610629000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"hsivonen: Safari non-TP too, for that matter","msgtype":"m.text"},"ts":1607610660000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: Which OS? I tested release version on Mojave and the latest iPadOS.","msgtype":"m.text"},"ts":1607610702000,"senderName":"hsivonen","senderId":"hsivonen@irc"},
{"content":{"body":"hsivonen: wait, Safari seems weird, if I alt+tab it does fire","msgtype":"m.text"},"ts":1607610707000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"annevk: I guess I should boot up Big Sur.","msgtype":"m.text"},"ts":1607610718000,"senderName":"hsivonen","senderId":"hsivonen@irc"},
{"content":{"body":"hsivonen: 10.15.7 (19H2)","msgtype":"m.text"},"ts":1607610725000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"hsivonen: which is Catalina","msgtype":"m.text"},"ts":1607610740000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"hsivonen: yeah for both versions of Safari I have to alt+tab away and back for onfocus to say has fired","msgtype":"m.text"},"ts":1607610783000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"hsivonen: and it doesn't say it has fired for the earlier documents","msgtype":"m.text"},"ts":1607610794000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"That makes sense.","msgtype":"m.text"},"ts":1607610797000,"senderName":"hsivonen","senderId":"hsivonen@irc"},
{"content":{"body":"Let's see what Chrome does on alt-tab.","msgtype":"m.text"},"ts":1607610826000,"senderName":"hsivonen","senderId":"hsivonen@irc"},
{"content":{"body":"hmm actually, for the first document it has, but then the second one it has not","msgtype":"m.text"},"ts":1607610827000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Chrome also seems to react to it","msgtype":"m.text"},"ts":1607610848000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Yeah","msgtype":"m.text"},"ts":1607610854000,"senderName":"hsivonen","senderId":"hsivonen@irc"},
{"content":{"body":"So the iframe is focused enough for Chrome that alt-tabbing back restores focus.","msgtype":"m.text"},"ts":1607610872000,"senderName":"hsivonen","senderId":"hsivonen@irc"},
{"content":{"body":"I think the non-Fission Firefox behavior makes the most sense for Web devs but I could see the argument why the Safari behavior could be defended.","msgtype":"m.text"},"ts":1607610934000,"senderName":"hsivonen","senderId":"hsivonen@irc"},
{"content":{"body":"Maybe I should make the demo log blur and the number of times focus has fired.","msgtype":"m.text"},"ts":1607610982000,"senderName":"hsivonen","senderId":"hsivonen@irc"},
{"content":{"body":"so apparently Chrome's implementation of FACEs also gets newlines wrong","msgtype":"m.text"},"ts":1607611303000,"senderName":"andreubotella","senderId":"andreubotella@irc"},
{"content":{"body":"hopefully that's not something people already depend on","msgtype":"m.text"},"ts":1607611311000,"senderName":"andreubotella","senderId":"andreubotella@irc"},
{"content":{"body":"Seems very doubtful","msgtype":"m.text"},"ts":1607611351000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"Filed https://github.com/whatwg/html/issues/6209 about the focus thing.","msgtype":"m.text"},"ts":1607620023000,"senderName":"hsivonen","senderId":"hsivonen@irc"}
]