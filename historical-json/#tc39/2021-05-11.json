[
{"content":{"body":"> 11:58 AM <• Bakkot> no, 2290 does not have stage 4 yet","msgtype":"m.text"},"ts":1620692089000,"senderName":"DerekNonGeneric","senderId":"DerekNonGeneric@irc"},
{"content":{"body":"jmdyck ^ that was said while you were out","msgtype":"m.text"},"ts":1620692115000,"senderName":"DerekNonGeneric","senderId":"DerekNonGeneric@irc"},
{"content":{"body":"yup, i read that in the log, thanks.","msgtype":"m.text"},"ts":1620692148000,"senderName":"jmdyck","senderId":"jmdyck@irc"},
{"content":{"body":"cool","msgtype":"m.text"},"ts":1620692161000,"senderName":"DerekNonGeneric","senderId":"DerekNonGeneric@irc"},
{"content":{"body":"jmdyck: i'll ofc rebase it the moment 1668 lands tho, and it's minimal so it won't cause further conflicts","msgtype":"m.text"},"ts":1620693370000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"ok, I'll review it once you rebase.","msgtype":"m.text"},"ts":1620693416000,"senderName":"jmdyck","senderId":"jmdyck@irc"},
{"content":{"body":"Bakkot: after filling in the tail call logic: https://gc.gy/88408124.png","msgtype":"m.text"},"ts":1620703131000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"also after updating eshost lol https://gc.gy/88408161.png","msgtype":"m.text"},"ts":1620703169000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"devsnek neat","msgtype":"m.text"},"ts":1620704165000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"this is such a dumb edge case","msgtype":"m.text"},"ts":1620704191000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"how do you get v8 and sm to do the $262 thing?","msgtype":"m.text"},"ts":1620704430000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"I guess the answer is \"update eshost\" huh","msgtype":"m.text"},"ts":1620704810000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"devsnek want to try this one with the new engine262? https://gist.github.com/bakkot/7fc563fb93c2e3b76dca793f467c0ec5","msgtype":"m.text"},"ts":1620705523000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"just adds a couple more cases so you can tell if the tail call is actually relevant","msgtype":"m.text"},"ts":1620705540000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"Bakkot: https://gc.gy/88412800.png","msgtype":"m.text"},"ts":1620707807000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"neat","msgtype":"m.text"},"ts":1620707823000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"engine262+ is I think correct per spec","msgtype":"m.text"},"ts":1620707844000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"big wins","msgtype":"m.text"},"ts":1620707868000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"idk what moddable is doing","msgtype":"m.text"},"ts":1620707950000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"xs doesn't actually create new intrinsics for $262.createRealm()","msgtype":"m.text"},"ts":1620708181000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"`xs -e 'print($262.createRealm().global.TypeError === TypeError)'` gives `true`","msgtype":"m.text"},"ts":1620708189000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"weird","msgtype":"m.text"},"ts":1620708264000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"doesn't that mean that it's not really providing a realm, so any tests that require it might be invalid?","msgtype":"m.text"},"ts":1620708276000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"/shrug","msgtype":"m.text"},"ts":1620708305000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"probably, depending on your interpretation","msgtype":"m.text"},"ts":1620708321000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"realms are kinda silly anyway, though","msgtype":"m.text"},"ts":1620708327000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"XS does not need to expose them","msgtype":"m.text"},"ts":1620708334000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"you only see them on the web because of iframe shenanigans","msgtype":"m.text"},"ts":1620708344000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"lol, that's a longer discussion","msgtype":"m.text"},"ts":1620708383000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"lul i still fail the tco tests","msgtype":"m.text"},"ts":1620708391000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"iframes are indeed the reason they exist, ofc","msgtype":"m.text"},"ts":1620708392000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"https://gc.gy/88413389.png","msgtype":"m.text"},"ts":1620708393000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"cuz v8 runs out of stack space","msgtype":"m.text"},"ts":1620708399000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"just `--stack_size 10000` or whatever","msgtype":"m.text"},"ts":1620708435000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"but i don't think it's open to interpretation; https://tc39.es/ecma262/#sec-createintrinsics seems to mandate all intrinsics be distinct property values","msgtype":"m.text"},"ts":1620708443000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"*distinct values","msgtype":"m.text"},"ts":1620708483000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"idk","msgtype":"m.text"},"ts":1620708496000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"i don't think its black and white","msgtype":"m.text"},"ts":1620708507000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"step 3 - \"The value of each field is a new object value\" and \"All object property values are newly created object values\" seems pretty black and white to me","msgtype":"m.text"},"ts":1620708525000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"eh","msgtype":"m.text"},"ts":1620708577000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"new is relative","msgtype":"m.text"},"ts":1620708581000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"lol","msgtype":"m.text"},"ts":1620708585000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"can we test tco without blowing the stack","msgtype":"m.text"},"ts":1620708600000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"if so, the spec's wayyyyy looser than we all think :-p","msgtype":"m.text"},"ts":1620708606000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"$262.getStackDepth when","msgtype":"m.text"},"ts":1620708608000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"I mean, no?","msgtype":"m.text"},"ts":1620708646000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"tco is not observable except in that your stack can be deeper than it otherwise would be, outside of stupid edge cases like the ones I've been playing with","msgtype":"m.text"},"ts":1620708667000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"(which everyone is inconsistent on even absent tco)","msgtype":"m.text"},"ts":1620708684000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"i mean if you can get the number of frames you can assert that it is constant","msgtype":"m.text"},"ts":1620708876000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"it's not constant though","msgtype":"m.text"},"ts":1620708887000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"even absent tco","msgtype":"m.text"},"ts":1620708888000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"because not all frames are the same size","msgtype":"m.text"},"ts":1620708893000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"i'm not saying getNumberOfBytesThatFramesOccupy","msgtype":"m.text"},"ts":1620708908000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"i'm saying getExecutionContextStackLength","msgtype":"m.text"},"ts":1620708922000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"IIRC spidermonkey has a hard cap on the number of stack frames but v8 bases it on the actual amount of space the frames occupy","msgtype":"m.text"},"ts":1620708953000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"so your maximum stack depth is different for different functions","msgtype":"m.text"},"ts":1620708978000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"i mean you don't need to call it more than once","msgtype":"m.text"},"ts":1620709085000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"well","msgtype":"m.text"},"ts":1620709091000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"twice","msgtype":"m.text"},"ts":1620709092000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"foo = (i) => i > 3 ? getStackDepth() : foo(i + 1); assert(foo(0) === getStackDepth() + 1)","msgtype":"m.text"},"ts":1620709124000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"oh, get the _current_ stack depth, got it","msgtype":"m.text"},"ts":1620710084000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"🙌🏻 https://gc.gy/88415352.png","msgtype":"m.text"},"ts":1620710360000,"senderName":"devsnek","senderId":"devsnek@irc"}
]