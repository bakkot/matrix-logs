[
{"content":{"body":"mathiasbynens: for the JSON.stringify fix, how would one get to the \"List containing in order the code points of value when interpreted as a sequence of UTF-16 encoded code points\" it requires using only pure JS","msgtype":"m.text"},"ts":1555038275000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"from what i can tell this could be very difficult due to js strings being outwardly ucs-2","msgtype":"m.text"},"ts":1555038319000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"devsnek: that quote is followed by \"as described in 6.1.4\" which details it","msgtype":"m.text"},"ts":1555071092000,"senderName":"mathiasbynens","senderId":"mathiasbynens@irc"},
{"content":{"body":"unless i misunderstand your question","msgtype":"m.text"},"ts":1555071110000,"senderName":"mathiasbynens","senderId":"mathiasbynens@irc"},
{"content":{"body":"see \"However, ECMAScript does not restrict the value of or relationships between these code units, so operations that further interpret String contents as sequences of Unicode code points encoded in UTF-16 must account for ill-formed subsequences [...]\"","msgtype":"m.text"},"ts":1555071211000,"senderName":"mathiasbynens","senderId":"mathiasbynens@irc"},
{"content":{"body":"devsnek: iow implementing this in JS is super easy","msgtype":"m.text"},"ts":1555071247000,"senderName":"mathiasbynens","senderId":"mathiasbynens@irc"},
{"content":{"body":"saying UTF-16 encoded is rather misleading though as that typically means lone surrogates are gone","msgtype":"m.text"},"ts":1555071303000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"i don't disagree","msgtype":"m.text"},"ts":1555071324000,"senderName":"mathiasbynens","senderId":"mathiasbynens@irc"},
{"content":{"body":"devsnek: you want `const codePoints = [...value];`","msgtype":"m.text"},"ts":1555071353000,"senderName":"mathiasbynens","senderId":"mathiasbynens@irc"},
{"content":{"body":"mathiasbynens: everything I've tried to split the string gives those json invalid ones as single items instead of split surrogate pairs","msgtype":"m.text"},"ts":1555071378000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"which is what is needed as far as i can tell","msgtype":"m.text"},"ts":1555071393000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"devsnek: you don't want to split surrogate pairs, you only want to have lone surrogates as individual items","msgtype":"m.text"},"ts":1555071413000,"senderName":"mathiasbynens","senderId":"mathiasbynens@irc"},
{"content":{"body":"devsnek: the string iterator does that for you, which is why `[...string]` works","msgtype":"m.text"},"ts":1555071424000,"senderName":"mathiasbynens","senderId":"mathiasbynens@irc"},
{"content":{"body":"What might help here is that the process of making \"code points\" out of \"code units\" is in particular about keep surrogate pairs together as they are two code units, but one code point","msgtype":"m.text"},"ts":1555071490000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"but isn't the change looking for \\dc8whatever as a lone surrogate","msgtype":"m.text"},"ts":1555071498000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"devsnek: yeah, it is","msgtype":"m.text"},"ts":1555071542000,"senderName":"mathiasbynens","senderId":"mathiasbynens@irc"},
{"content":{"body":"devsnek: if you do [...\"\\uD800remainder\"] the \"\\uD800\" will be standalone still","msgtype":"m.text"},"ts":1555071575000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"^ and that's exactly what you want here","msgtype":"m.text"},"ts":1555071587000,"senderName":"mathiasbynens","senderId":"mathiasbynens@irc"},
{"content":{"body":"mathiasbynens: do you have any plans to tidy up the language?","msgtype":"m.text"},"ts":1555071618000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"mathiasbynens: I looked into it briefly at some point, but it seemed like quite a bit of work","msgtype":"m.text"},"ts":1555071630000,"senderName":"annevk","senderId":"annevk@irc"},
{"content":{"body":"in `[...'_\\uDC00\\uD800_ðŸ’©_']` you want ðŸ’© (a surrogate pair) to remain a single unit; it needs no escaping. otoh, you want `\\uDC00\\uD800` (a surrogate pair in the wrong order, i.e. two consecutive lone surrogates) to be two separate units","msgtype":"m.text"},"ts":1555071668000,"senderName":"mathiasbynens","senderId":"mathiasbynens@irc"},
{"content":{"body":"annevk: hmm, i'm sure the editors would be open to a PR that tidies things up. i'm mostly interested in observable changes (like the recent change to make `JSON.stringify()` output well-formed)","msgtype":"m.text"},"ts":1555071727000,"senderName":"mathiasbynens","senderId":"mathiasbynens@irc"},
{"content":{"body":"mathiasbynens: maybe there is some other issue, but spreading the string didn't seem to work, when I'm in front of the code again I will take another look","msgtype":"m.text"},"ts":1555071881000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"devsnek: happy to take a look","msgtype":"m.text"},"ts":1555071912000,"senderName":"mathiasbynens","senderId":"mathiasbynens@irc"},
{"content":{"body":"quotejsonstring is here https://github.com/devsnek/engine262/blob/master/src/intrinsics/JSON.mjs","msgtype":"m.text"},"ts":1555071964000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"I haven't pushed up the changes yet","msgtype":"m.text"},"ts":1555071973000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"mathiasbynens: back to computer, getting weird behaviour out of this","msgtype":"m.text"},"ts":1555074209000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"https://www.irccloud.com/pastebin/7iT65YLf/agh.js","msgtype":"m.text"},"ts":1555074215000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"you're using charCodeAt instead of codePointAt","msgtype":"m.text"},"ts":1555074229000,"senderName":"mathiasbynens","senderId":"mathiasbynens@irc"},
{"content":{"body":"devsnek: and fromCharCode instead of fromCodePoint","msgtype":"m.text"},"ts":1555074252000,"senderName":"mathiasbynens","senderId":"mathiasbynens@irc"},
{"content":{"body":"ey alright","msgtype":"m.text"},"ts":1555074257000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"should UnicodeEscape also use codePointAt","msgtype":"m.text"},"ts":1555074283000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"oh that's not in the paste","msgtype":"m.text"},"ts":1555074303000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"it will never be reached for non-BMP code points, so it doesn't matter there","msgtype":"m.text"},"ts":1555074328000,"senderName":"mathiasbynens","senderId":"mathiasbynens@irc"},
{"content":{"body":"i.e. code points above U+FFFF","msgtype":"m.text"},"ts":1555074337000,"senderName":"mathiasbynens","senderId":"mathiasbynens@irc"},
{"content":{"body":"\\uXXXX only works with exactly 4 hex digits anyhow","msgtype":"m.text"},"ts":1555074360000,"senderName":"mathiasbynens","senderId":"mathiasbynens@irc"},
{"content":{"body":"and for UTF16Encoding()","msgtype":"m.text"},"ts":1555074395000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"right now i return an array from it","msgtype":"m.text"},"ts":1555074411000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"should i do String.fromCodePoint(cu1, cu2)","msgtype":"m.text"},"ts":1555074419000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"(i never had to use UTF16Encoding before now lol)","msgtype":"m.text"},"ts":1555074443000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"is there an eslint to prevent `const x = expression that uses accidentally uses x`","msgtype":"m.text"},"ts":1555080680000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"devsnek: Iâ€™m pretty confident there is, since thatâ€™d always be a tdz error","msgtype":"m.text"},"ts":1555083925000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"I couldn't find one, but maybe I'm just bad at reading","msgtype":"m.text"},"ts":1555083966000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"if not, make one and PR it into core :-)","msgtype":"m.text"},"ts":1555083988000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"devsnek / ljharb: you'll never get it to be complete, because `const x = () => x` is fine but `const x = (() => x)()` is a TDZ error, and distinguishing between those two is (in general) uncomputable","msgtype":"m.text"},"ts":1555095146000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"but you can at least lint against the case where it's not in a closure, yeah","msgtype":"m.text"},"ts":1555095200000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"halting problem is ez","msgtype":"m.text"},"ts":1555095232000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"yeah true, the non-closure case is easy","msgtype":"m.text"},"ts":1555095529000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"but i suspect the lint rule would want to warn on `() => x` too - ie, it wouldn't just be for avoiding a tdz error, it'd be for likely mistakes","msgtype":"m.text"},"ts":1555095570000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"I don't think that's a likely mistake?","msgtype":"m.text"},"ts":1555095587000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"i'm sure there's nonzero use cases for a function that returns itself but i can't imagine there's many","msgtype":"m.text"},"ts":1555095617000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"oh, I just meant like","msgtype":"m.text"},"ts":1555095653000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"`const fib = n => n <= 0 ? 1 : fib(n - 1) + fib(n - 2)`","msgtype":"m.text"},"ts":1555095656000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"returning itself is probably a mistake, but _referencing_ itself isn't","msgtype":"m.text"},"ts":1555095667000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"a partial evaluator could help here","msgtype":"m.text"},"ts":1555095698000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"prepack or engine262 with some slight modifications","msgtype":"m.text"},"ts":1555095714000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"true of many problems, but perhaps overkill for a linter","msgtype":"m.text"},"ts":1555095715000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"sometimes you gotta bring out the big guns","msgtype":"m.text"},"ts":1555095733000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"yeah fair","msgtype":"m.text"},"ts":1555095749000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"rather than a new rule, probably the thing to do is make no-use-before-undef also give errors in the case where the RHS of the initial assignment references the LHS in a not-closure way","msgtype":"m.text"},"ts":1555096010000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"but it's really quite hard to get eslint to accept new rules or changes these days","msgtype":"m.text"},"ts":1555096022000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"been considering starting up a new project to be a home for all the good eslint rules which core has refused to accept","msgtype":"m.text"},"ts":1555096045000,"senderName":"Bakkot","senderId":"Bakkot@irc"},
{"content":{"body":"Bakkot: I'd give that a star","msgtype":"m.text"},"ts":1555096130000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"ljharb: any forecast re merges to master?","msgtype":"m.text"},"ts":1555100986000,"senderName":"jmdyck","senderId":"jmdyck@irc"},
{"content":{"body":"jmdyck: sorry about the delay; i'll get to it today :-)","msgtype":"m.text"},"ts":1555101019000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"ok","msgtype":"m.text"},"ts":1555101029000,"senderName":"jmdyck","senderId":"jmdyck@irc"},
{"content":{"body":"I wonder how many spec bugs could be prevented by requiring a pr to engine262","msgtype":"m.text"},"ts":1555101978000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"TimothyGu: heads up that https://github.com/tc39/ecma262/pull/1406 needs a rebase, but also i'm still waiting for waldemar to review it","msgtype":"m.text"},"ts":1555106193000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"are there tests for the change to await to reduce the ticks?","msgtype":"m.text"},"ts":1555111400000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"devsnek: https://github.com/tc39/ecma262/pull/1250 links to https://github.com/tc39/test262/pull/1843","msgtype":"m.text"},"ts":1555111494000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"hmmm","msgtype":"m.text"},"ts":1555111500000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"i just noticed AsyncGeneratorResumeNext in engine262 wasn't updated for that change","msgtype":"m.text"},"ts":1555111514000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"but no tests were failling","msgtype":"m.text"},"ts":1555111517000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"failing*","msgtype":"m.text"},"ts":1555111519000,"senderName":"devsnek","senderId":"devsnek@irc"}
]