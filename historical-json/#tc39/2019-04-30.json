[
{"content":{"body":"so I've got a question that's most likely shockingly newbish","msgtype":"m.text"},"ts":1556599999000,"senderName":"rkirsling","senderId":"rkirsling@irc"},
{"content":{"body":"does `Let R be the result of evaluating DefaultClause.` not carry any implication that we're actually going to evaluate something such that side effects would be seen? it seems that the answer has to be yes but I don't think I understand why","msgtype":"m.text"},"ts":1556600072000,"senderName":"rkirsling","senderId":"rkirsling@irc"},
{"content":{"body":"rkirsling: is this like in a switch statement?","msgtype":"m.text"},"ts":1556600186000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"yessir","msgtype":"m.text"},"ts":1556600190000,"senderName":"rkirsling","senderId":"rkirsling@irc"},
{"content":{"body":"it's a statement list, so yeah that sounds right","msgtype":"m.text"},"ts":1556600207000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"i think there's something about the default clause not being required to be last, but it'll still be evaluated last?","msgtype":"m.text"},"ts":1556600238000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"switch statements are weird","msgtype":"m.text"},"ts":1556600246000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"that's exactly what I opened the spec to search for","msgtype":"m.text"},"ts":1556600346000,"senderName":"rkirsling","senderId":"rkirsling@irc"},
{"content":{"body":"rkirsling: so","msgtype":"m.text"},"ts":1556600376000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"but in the RS here https://tc39.github.io/ecma262/#sec-runtime-semantics-caseblockevaluation","msgtype":"m.text"},"ts":1556600383000,"senderName":"rkirsling","senderId":"rkirsling@irc"},
{"content":{"body":"the evaluation of switch is defined such that the `DefaultClause` is plucked out","msgtype":"m.text"},"ts":1556600399000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"and always run last","msgtype":"m.text"},"ts":1556600401000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"because its defined as `Clauses DefaultClause Clauses_opt` or something like that","msgtype":"m.text"},"ts":1556600421000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"oh yeah its those two syntax branches","msgtype":"m.text"},"ts":1556600456000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"yeah but it seems that we check the cases before the default in source order, then evaluate default and tentatively set its completion value as the overall completion value, then go through the cases after the default in source order","msgtype":"m.text"},"ts":1556600499000,"senderName":"rkirsling","senderId":"rkirsling@irc"},
{"content":{"body":"that's probably so the spec can be written top down, but unobservably so that implementations can re-order the default clause and it works the same?","msgtype":"m.text"},"ts":1556600527000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"totally throwing out guesses","msgtype":"m.text"},"ts":1556600540000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"oh i see what you're saying","msgtype":"m.text"},"ts":1556600552000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"yeah I'm clearly missing something because the engines all do the right thing (no side effects putting default above the case that we want)","msgtype":"m.text"},"ts":1556600583000,"senderName":"rkirsling","senderId":"rkirsling@irc"},
{"content":{"body":"hm, are you suggesting the spec implies that `default` should be ran always (when it's not last) even if it's not triggered? O.o","msgtype":"m.text"},"ts":1556600614000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"its doing it this way for fallthrough","msgtype":"m.text"},"ts":1556600628000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"that's what I'm reading it as and feeling like I must be mistaken","msgtype":"m.text"},"ts":1556600635000,"senderName":"rkirsling","senderId":"rkirsling@irc"},
{"content":{"body":"things in front of the default might still need to fall through to the default","msgtype":"m.text"},"ts":1556600651000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"but things after don't","msgtype":"m.text"},"ts":1556600655000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"aha","msgtype":"m.text"},"ts":1556600659000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"which is why foundInB returns immediately","msgtype":"m.text"},"ts":1556600668000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"but a only returns if its abrupt (throw or break)","msgtype":"m.text"},"ts":1556600674000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"ngl this is confusing af","msgtype":"m.text"},"ts":1556600700000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"oh for crying out loud","msgtype":"m.text"},"ts":1556600774000,"senderName":"rkirsling","senderId":"rkirsling@irc"},
{"content":{"body":"lol","msgtype":"m.text"},"ts":1556600786000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"I think my eyes just jumped over step 7","msgtype":"m.text"},"ts":1556600805000,"senderName":"rkirsling","senderId":"rkirsling@irc"},
{"content":{"body":"okay yeah I've fully got it now","msgtype":"m.text"},"ts":1556601744000,"senderName":"rkirsling","senderId":"rkirsling@irc"},
{"content":{"body":"anyway that's what I get for skimming too fast","msgtype":"m.text"},"ts":1556602505000,"senderName":"rkirsling","senderId":"rkirsling@irc"},
{"content":{"body":"since I wrote it out clearly for my own purposes, I'll copy-paste it here for closure's sake","msgtype":"m.text"},"ts":1556602743000,"senderName":"rkirsling","senderId":"rkirsling@irc"},
{"content":{"body":"1. we check the _before_ cases in order","msgtype":"m.text"},"ts":1556602792000,"senderName":"rkirsling","senderId":"rkirsling@irc"},
{"content":{"body":"2. if we match *and* hit a `break`/`return` somewhere before the `default`, we're done","msgtype":"m.text"},"ts":1556602793000,"senderName":"rkirsling","senderId":"rkirsling@irc"},
{"content":{"body":"3. otherwise, we check the _after_ cases in order","msgtype":"m.text"},"ts":1556602793000,"senderName":"rkirsling","senderId":"rkirsling@irc"},
{"content":{"body":"4. if we matched an _after_ case we're done (regardless of `break`/`return`)","msgtype":"m.text"},"ts":1556602793000,"senderName":"rkirsling","senderId":"rkirsling@irc"},
{"content":{"body":"5. otherwise, we evaluate the `default`","msgtype":"m.text"},"ts":1556602793000,"senderName":"rkirsling","senderId":"rkirsling@irc"},
{"content":{"body":"6. if we *still* haven't hit a `break`/`return` we evaluate on into the _after_ cases as necessary","msgtype":"m.text"},"ts":1556602793000,"senderName":"rkirsling","senderId":"rkirsling@irc"},
{"content":{"body":"so that matches expected behavior","msgtype":"m.text"},"ts":1556602813000,"senderName":"rkirsling","senderId":"rkirsling@irc"},
{"content":{"body":"(this all started because I was reading one of LLVM's tutorial docs and they've got a (C++) switch with default first, and I literally never thought about that being valid to do before now...)","msgtype":"m.text"},"ts":1556602957000,"senderName":"rkirsling","senderId":"rkirsling@irc"},
{"content":{"body":"i think the only valid thing to do is avoid c style switch cases","msgtype":"m.text"},"ts":1556603062000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"we all know ljharb agrees ;)","msgtype":"m.text"},"ts":1556603137000,"senderName":"rkirsling","senderId":"rkirsling@irc"},
{"content":{"body":"they're kind of like \"goto's last bastion\"","msgtype":"m.text"},"ts":1556603188000,"senderName":"rkirsling","senderId":"rkirsling@irc"},
{"content":{"body":"heh","msgtype":"m.text"},"ts":1556603189000,"senderName":"rkirsling","senderId":"rkirsling@irc"},
{"content":{"body":"lol yes, burn them with fire","msgtype":"m.text"},"ts":1556603236000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"`do { break label } while (false);`","msgtype":"m.text"},"ts":1556603259000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"actually can you jump to labels that are defined later","msgtype":"m.text"},"ts":1556603287000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"aw you can't","msgtype":"m.text"},"ts":1556603306000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"what if i LIKE gotos huh??","msgtype":"m.text"},"ts":1556643100000,"senderName":"cloudshu","senderId":"cloudshu@irc"},
{"content":{"body":"cloudshu: then i can suggest somewhere for you to goto :-p","msgtype":"m.text"},"ts":1556643344000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"when i say jump i want the cpu to say how high","msgtype":"m.text"},"ts":1556643373000,"senderName":"cloudshu","senderId":"cloudshu@irc"},
{"content":{"body":"Domenic: can you tell i don't do browser js very often :P","msgtype":"m.text"},"ts":1556643408000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"Hehe :)","msgtype":"m.text"},"ts":1556643413000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Domenic: would that be `document.body.insertAdjacentHTML('afterbegin', WARNING_HTML)`","msgtype":"m.text"},"ts":1556643521000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"Seems likely","msgtype":"m.text"},"ts":1556643700000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Domenic: also it seems like jsdom messed up the encoding of the <title> of the page","msgtype":"m.text"},"ts":1556643758000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"`ECMAScriptÂ® 2020 Language Specification`","msgtype":"m.text"},"ts":1556643764000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"(before and after removing 'utf8' in readFile)","msgtype":"m.text"},"ts":1556643787000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"Oh the source document doesn't have a meta charset doesn't it","msgtype":"m.text"},"ts":1556643789000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Because it's not really HTML","msgtype":"m.text"},"ts":1556643797000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"lol","msgtype":"m.text"},"ts":1556643800000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"Yeah then I guess that advice doesn't work","msgtype":"m.text"},"ts":1556643805000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"is jsdom adding a meta charset","msgtype":"m.text"},"ts":1556643814000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"No it's doing encoding sniffing and with no meta charset it defaults to windows1252","msgtype":"m.text"},"ts":1556643833000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"ouch","msgtype":"m.text"},"ts":1556643843000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"Valid HTML needs to include a meta charset","msgtype":"m.text"},"ts":1556643857000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"But ecmarkup inserts it for you automatically","msgtype":"m.text"},"ts":1556643864000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"So the source document isn't really following the normal rules that jsdom expects","msgtype":"m.text"},"ts":1556643883000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"well i'm not passing the source","msgtype":"m.text"},"ts":1556643899000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"Maybe you should be running this as a post-processing step actually?","msgtype":"m.text"},"ts":1556643902000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"i'm passing the result of ecmarkup","msgtype":"m.text"},"ts":1556643904000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"Oh weird","msgtype":"m.text"},"ts":1556643905000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Does ecmarkup not insert a meta charset then","msgtype":"m.text"},"ts":1556643915000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Maybe I misremembered","msgtype":"m.text"},"ts":1556643927000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"passing string instead of buffer works","msgtype":"m.text"},"ts":1556643967000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"oh well","msgtype":"m.text"},"ts":1556643971000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"Can you check if the output of ecmarkup has a meta charset","msgtype":"m.text"},"ts":1556644106000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"If it does then maybe jsdom bug I should fix","msgtype":"m.text"},"ts":1556644114000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"If it doesn't then ecmarkup bug","msgtype":"m.text"},"ts":1556644120000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"will do","msgtype":"m.text"},"ts":1556644143000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"Domenic: it has `<meta charset=\"utf-8\">`","msgtype":"m.text"},"ts":1556644185000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"Ok dang potential jsdom bug then","msgtype":"m.text"},"ts":1556644212000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"inb4 v8 memory corruption triggered by the sheer size of the spec","msgtype":"m.text"},"ts":1556644254000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"devsnek: is the intention here that the spec build job that runs on every master commit would use this?","msgtype":"m.text"},"ts":1556646514000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"ljharb: the intention was running it for pull requests","msgtype":"m.text"},"ts":1556646532000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"but master snapshots could be pretty cool as well","msgtype":"m.text"},"ts":1556646537000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"ah ok so it's just setting up scaffolding, but nothing's using it yet","msgtype":"m.text"},"ts":1556646548000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"yeah","msgtype":"m.text"},"ts":1556646551000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"i don't really have permission to install actual hooks and stuff on the repo","msgtype":"m.text"},"ts":1556646563000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"so for this snapshot thing, how does it work on mobile, and is it keyboard accessible?","msgtype":"m.text"},"ts":1556646601000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"it uses <details>","msgtype":"m.text"},"ts":1556646616000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"which is part of the html spec","msgtype":"m.text"},"ts":1556646619000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"which is why i don't need to define how it collapses","msgtype":"m.text"},"ts":1556646630000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"so it should just work (tm)","msgtype":"m.text"},"ts":1556646636000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"what does it do on older browsers that don't have <details>?","msgtype":"m.text"},"ts":1556646653000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"look funny","msgtype":"m.text"},"ts":1556646659000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"lol","msgtype":"m.text"},"ts":1556646669000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"whatwg uses this same thing for their snapshots","msgtype":"m.text"},"ts":1556646678000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"i actually copied most of it","msgtype":"m.text"},"ts":1556646682000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"Master should not have this","msgtype":"m.text"},"ts":1556646687000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"This redirects people to master","msgtype":"m.text"},"ts":1556646690000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"so i assume it hasn't been a problem","msgtype":"m.text"},"ts":1556646694000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"gotcha","msgtype":"m.text"},"ts":1556646698000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"IMO the things on ecma-international.org should have this","msgtype":"m.text"},"ts":1556646701000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"Domenic: i mean like renders of any point of master","msgtype":"m.text"},"ts":1556646704000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"not of master itself","msgtype":"m.text"},"ts":1556646706000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"Mmm OK","msgtype":"m.text"},"ts":1556646716000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"like if `tc39.github.io/ecma262/abcdef` existed","msgtype":"m.text"},"ts":1556646722000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"for every commit to master","msgtype":"m.text"},"ts":1556646729000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"i dunno","msgtype":"m.text"},"ts":1556646733000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"Right gotcha","msgtype":"m.text"},"ts":1556646737000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"https://dom.spec.whatwg.org/commit-snapshots/","msgtype":"m.text"},"ts":1556646747000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"or a nice list like that :P","msgtype":"m.text"},"ts":1556646756000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"It's just a styled nginx directory listing :)","msgtype":"m.text"},"ts":1556646776000,"senderName":"Domenic","senderId":"Domenic@irc"},
{"content":{"body":"ljharb: when bigint lands will it be part of 2019 or 2020","msgtype":"m.text"},"ts":1556664271000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"assuming that pr doesn't sit there forever","msgtype":"m.text"},"ts":1556664282000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"devsnek: 2019 was conceptually frozen in like january, and actually frozen in march","msgtype":"m.text"},"ts":1556664290000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"more like november than january even","msgtype":"m.text"},"ts":1556664297000,"senderName":"ljharb","senderId":"ljharb@irc"},
{"content":{"body":"ok","msgtype":"m.text"},"ts":1556664297000,"senderName":"devsnek","senderId":"devsnek@irc"},
{"content":{"body":"certainly if it reaches stage 4 before november, then it'll be in 2020","msgtype":"m.text"},"ts":1556664319000,"senderName":"ljharb","senderId":"ljharb@irc"}
]