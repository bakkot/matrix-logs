<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>TC39-TG4_ Source Maps on 2025-04-08</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "TC39-TG4_ Source Maps";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">TC39-TG4_ Source Maps<br>2025-04-08<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2025-04-07" class="nav-link"><span>prev</span></a>
<a href="2025-04-09" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search TC39-TG4_ Source Maps">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Mon Apr 07 2025 21:18:20 GMT-0700 (Pacific Daylight Time)">04:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@szuend:matrix.org">Simon Zünd</span>&gt;</div></td><td class="msg-cell">To answer the last question first: You'd be able to achieve this already with the current source map format. The sourceMappingURL is allowed to be cross-origin.

The closest thing I can think of are artifact servers for cloud providers. E.g. MS Azure allows you to host source maps (and original source files) for you behind some OAuth, so you can securely debug an app without making the source/source maps publicly available (<a href="https://learn.microsoft.com/en-us/microsoft-edge/devtools-guide-chromium/javascript/consume-source-maps-from-azure">https://learn.microsoft.com/en-us/microsoft-edge/devtools-guide-chromium/javascript/consume-source-maps-from-azure</a>).

AFAIK there is no package registry purely for source maps yet.</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Tue Apr 08 2025 05:01:46 GMT-0700 (Pacific Daylight Time)">12:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">should we work together to build one? It could make source maps available in practice more of the time, reduce the incentive for doing a data URL for the source map (which slows down loading time), and reduce the size of npm packages (for installation time)</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Tue Apr 08 2025 06:15:16 GMT-0700 (Pacific Daylight Time)">13:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@43081j:matrix.org">James</span>&gt;</div></td><td class="msg-cell">ah nice! i didn't realise map URLs can be cross-origin</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Tue Apr 08 2025 06:16:44 GMT-0700 (Pacific Daylight Time)">13:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@43081j:matrix.org">James</span>&gt;</div></td><td class="msg-cell"><p><span class="nick-5">Nic</span>: the benefit .net and various other languages doing this have is that they don't need to ship debug symbols<br>think of a compiled language, you want to ship the cut down production binary with no debug symbols etc.<br>you then pull those symbols from a separate source if you want to debug said binary</p>
<p>we could do the same by having a sourcemap registry and pull sourcemaps from there instead of shipping them in our packages</p>
</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Tue Apr 08 2025 06:17:25 GMT-0700 (Pacific Daylight Time)">13:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@43081j:matrix.org">James</span>&gt;</div></td><td class="msg-cell">e.g. cloudflare recently removed sourcemaps and halved their package size. great for everyone except the couple of people who want to debug it nicely. but if they could pull those maps from some other source, that'd solve it for both sides</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Tue Apr 08 2025 06:19:05 GMT-0700 (Pacific Daylight Time)">13:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@43081j:matrix.org">James</span>&gt;</div></td><td class="msg-cell">we could do this now by having a build-time transform which sets the sourcemap URL to a remote one and uploads them to the server</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Tue Apr 08 2025 06:34:48 GMT-0700 (Pacific Daylight Time)">13:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@nribaudo:igalia.com">Nic</span>&gt;</div></td><td class="msg-cell">Could it be something like we have <code>@types/foo</code>, e.g. <code>@source-map/foo</code>?</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Tue Apr 08 2025 06:41:45 GMT-0700 (Pacific Daylight Time)">13:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@43081j:matrix.org">James</span>&gt;</div></td><td class="msg-cell">i think so yes</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Tue Apr 08 2025 06:43:14 GMT-0700 (Pacific Daylight Time)">13:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@43081j:matrix.org">James</span>&gt;</div></td><td class="msg-cell">though maybe its more like unpkg or something. as it isn't something you'd pull from npm. if you did host it on npm though, i suppose you could use something like unpkg/jsdelivr/etc to retrieve it</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Tue Apr 08 2025 06:43:52 GMT-0700 (Pacific Daylight Time)">13:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@43081j:matrix.org">James</span>&gt;</div></td><td class="msg-cell">i.e. if we publish our map to <code>@source-map/foo</code>, our sources link to <code><a href="http://somecdn.com/@source-map/foo/lib/index.js.map">somecdn.com/@source-map/foo/lib/index.js.map</a></code></td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Tue Apr 08 2025 06:44:10 GMT-0700 (Pacific Daylight Time)">13:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@43081j:matrix.org">James</span>&gt;</div></td><td class="msg-cell">maybe thats how you avoid needing a whole new registry/host</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Tue Apr 08 2025 09:17:32 GMT-0700 (Pacific Daylight Time)">16:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell"><code>@types</code> works because DT manages all those packages - i don't think you'd want to have to manage everyone's source maps and keep them in sync</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Tue Apr 08 2025 11:43:54 GMT-0700 (Pacific Daylight Time)">18:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">yeah having your source maps centralized on some cdn seems less risky than actually loading your source from there</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Tue Apr 08 2025 11:58:56 GMT-0700 (Pacific Daylight Time)">18:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@kriskowal:aelf.land">kriskowal</span>&gt;</div></td><td class="msg-cell">I would like to see it to become common for the stock source map URL to be a content address of the preceding text, and eventually, implicit, so an IDE could be configured to find the sourcemap in whatever storage. At Agoric, we’ve been working toward a solution where our bundler drops source maps in a conventional XDG caches directory, keyed on content address. We believe there’s a solution you can rig up WebPack this way and, in a VSCode launch.json, map content addresses to local physical files, but I simply haven’t found credible documentation for it.</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Tue Apr 08 2025 11:59:11 GMT-0700 (Pacific Daylight Time)">18:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@kriskowal:aelf.land">kriskowal</span>&gt;</div></td><td class="msg-cell">Consider <code>source-map://${hash}.map.json</code>.</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Tue Apr 08 2025 13:27:45 GMT-0700 (Pacific Daylight Time)">20:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Do you mean using <code>"sourceMapPathOverrides"</code>? <a href="https://code.visualstudio.com/docs/nodejs/nodejs-debugging#_overriding-source-map-paths">https://code.visualstudio.com/docs/nodejs/nodejs-debugging#_overriding-source-map-paths</a></td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Tue Apr 08 2025 13:32:18 GMT-0700 (Pacific Daylight Time)">20:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@kriskowal:aelf.land">kriskowal</span>&gt;</div></td><td class="msg-cell">There it is!</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Tue Apr 08 2025 13:35:29 GMT-0700 (Pacific Daylight Time)">20:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@kriskowal:aelf.land">kriskowal</span>&gt;</div></td><td class="msg-cell">So, I believe this is the thing we would use to make <code>source-map://${hash}.map.json</code> just work. It doesn’t look particularly fancy, so it’d probably look more like <code>source-map://b0/<a href="http://b5c0ffeefacade.map">b5c0ffeefacade.map</a>.json</code> so we don’t end up with intractable <code>readdir</code> expenses.</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Tue Apr 08 2025 13:36:31 GMT-0700 (Pacific Daylight Time)">20:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@kriskowal:aelf.land">kriskowal</span>&gt;</div></td><td class="msg-cell">If that practice became the norm, bundlers, LSP, and registries could conspire to their hearts’ content.</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Tue Apr 08 2025 13:44:12 GMT-0700 (Pacific Daylight Time)">20:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">IIRC, there was an internal hackathon to make sure VSCode supported remote sourcemaps and this kind of wire up so it could use them somewhat like a symbol server. In lieu of a bundler, even tsc lets you specify a URL as the base to use for <code>sourceMappingURL=</code> via the <code>"mapRoot"</code> option, as well as a URL for sources using the <code>"sourceRoot"</code> option, assuming you don't just use <code>"inlineSources": true</code></td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Tue Apr 08 2025 13:57:15 GMT-0700 (Pacific Daylight Time)">20:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@kriskowal:aelf.land">kriskowal</span>&gt;</div></td><td class="msg-cell">We find that we have to tolerate certain compromises in order to ensure that our bundles produce consistent content regardless of the parent path and as insensitive as possible to the layout of the node_modules tree. We tend to inject a source URL like <code>.../${nameOfPackageParentDirectory}/${pathWithinPackage}</code> and tolerate the occasional collision due to “eval twin” packages under <code>node_modules</code> or the occasional divergence between the name of the package and the name of the directory containing the package. And, consistent hashes have their own vagaries.</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Tue Apr 08 2025 14:04:23 GMT-0700 (Pacific Daylight Time)">21:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell"><span class="nick-11">kriskowal</span>: Is that a content hash of the source map you're referencing?</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Tue Apr 08 2025 14:08:03 GMT-0700 (Pacific Daylight Time)">21:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@kriskowal:aelf.land">kriskowal</span>&gt;</div></td><td class="msg-cell">That’s an open design question. That probably wouldn’t work for our case, because of fully qualified file URLs in the source map varying between users and host systems, which would frustrate the consistency of the hash of the bundle.</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Tue Apr 08 2025 14:10:54 GMT-0700 (Pacific Daylight Time)">21:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@kriskowal:aelf.land">kriskowal</span>&gt;</div></td><td class="msg-cell">Hash of the original source works in many but not all cases, and we can safely carry that in-band (embedded in the sourceMapURL comment of the bundled code).</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Tue Apr 08 2025 14:11:41 GMT-0700 (Pacific Daylight Time)">21:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@kriskowal:aelf.land">kriskowal</span>&gt;</div></td><td class="msg-cell">The original source hash tends to converge when you get close to empty, and everything about an empty sourcemap is fine except the <code>sources</code> array being different for each.</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Tue Apr 08 2025 14:15:20 GMT-0700 (Pacific Daylight Time)">21:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@kriskowal:aelf.land">kriskowal</span>&gt;</div></td><td class="msg-cell">At the end of the day, the protocol just requires a consistent, collision-free, decentralized namespace that the bundler and the IDE can converge into, so the specifics of how the hash get generated can vary. Like, a probably sufficient mitigation for collisions is to hash the package name and version, the module specifier within the package, and the content of the original sources. You could certainly go so far as to use the path names through the package dependency tree to obviate node_modules twins and discrepancies between the package name and package parent directory name.</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Tue Apr 08 2025 14:15:41 GMT-0700 (Pacific Daylight Time)">21:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">content hashes are pretty cool</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Tue Apr 08 2025 14:15:51 GMT-0700 (Pacific Daylight Time)">21:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">I mean content hash-based addressing</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Tue Apr 08 2025 14:16:22 GMT-0700 (Pacific Daylight Time)">21:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@kriskowal:aelf.land">kriskowal</span>&gt;</div></td><td class="msg-cell">They’re a sort of big deal :-)</td></tr>

</tbody></table></div></div></div>
</body></html>