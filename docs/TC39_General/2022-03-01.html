<!DOCTYPE html><html><head>
  <title>TC39 General on 2022-03-01</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "TC39 General";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">TC39 General<br>2022-03-01<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2022-02-28" class="nav-link"><span>prev</span></a>
<span style="float:right">next</span>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search TC39 General">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Mon Feb 28 2022 16:55:47 GMT-0800 (Pacific Standard Time)">00:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell"><span class="nick-5">danielrosenwasser</span> / <span class="nick-15">rbuckton</span>: The new What's Changed Since RC/Beta in the TS release notes are üëç</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Mon Feb 28 2022 17:47:45 GMT-0800 (Pacific Standard Time)">01:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@sirisian:matrix.org">sirisian</span>&gt;</div></td><td class="msg-cell">Question. Possibly I'm not searching the right terms, but when async/await was added to ECMAScript, why was threading never pulled into the core language away from Web Workers? (As others I've done the blob thing for years with workers when doing heavily threaded things). I kind of expected that one would be able to just call an async function and have it execute on another thread by now with intuitive shared state, but that was never proposed. Why not?</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Mon Feb 28 2022 17:55:08 GMT-0800 (Pacific Standard Time)">01:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">"intuitive shared state" is a contradiction in terms</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Mon Feb 28 2022 17:55:51 GMT-0800 (Pacific Standard Time)">01:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">the thing you're proposing would be incredibly complicated to specify or implement, and we're just now getting to the point where we're fleshing out the building blocks which might let us get there someday</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Mon Feb 28 2022 17:56:03 GMT-0800 (Pacific Standard Time)">01:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">or, well, not there precisely, but somewhere like it</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Mon Feb 28 2022 18:19:23 GMT-0800 (Pacific Standard Time)">02:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Question. Possibly I'm not searching the right terms, but when async/await was added to ECMAScript, why was threading never pulled into the core language away from Web Workers? (As others I've done the blob thing for years with workers when doing heavily threaded things). I kind of expected that one would be able to just call an async function and have it execute on another thread by now with intuitive shared state, but that was never proposed. Why not?</blockquote></mx-reply><p>we're on the route of that. ü§î<br>search for those proposals:</p>
<ul>
<li>struct (shared struct section)</li>
<li>module block</li>
</ul>
</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Mon Feb 28 2022 18:41:56 GMT-0800 (Pacific Standard Time)">02:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <p>can someone verify my assessment that <a href="https://github.com/mishoo/UglifyJS/issues/5370">https://github.com/mishoo/UglifyJS/issues/5370</a> represents a deviation of V8 from other major implementations in FunctionDeclarationInstantiation with respect to non-simple parameter lists when VarDeclaredNames includes "arguments"?</p>
<pre><code>$ eshost -se '[].concat(...["function arguments(){}", "var arguments"].map(occluding =&gt; ["()", "(..._)", "(_=0)"].map(params =&gt; { const r="return typeof arguments; ", f=Function(params.slice(1,-1), r+occluding); return `${f().padEnd(9)} // function${params}{${r+occluding}}`; }))).join("\n")'
#### ChakraCore, engine262, JavaScriptCore, Moddable XS, SpiderMonkey
function  // function(){return typeof arguments; function arguments(){}}
function  // function(..._){return typeof arguments; function arguments(){}}
function  // function(_=0){return typeof arguments; function arguments(){}}
object    // function(){return typeof arguments; var arguments}
object    // function(..._){return typeof arguments; var arguments}
object    // function(_=0){return typeof arguments; var arguments}

#### V8
function  // function(){return typeof arguments; function arguments(){}}
function  // function(..._){return typeof arguments; function arguments(){}}
function  // function(_=0){return typeof arguments; function arguments(){}}
object    // function(){return typeof arguments; var arguments}
undefined // function(..._){return typeof arguments; var arguments}
undefined // function(_=0){return typeof arguments; var arguments}
</code></pre>
</blockquote></mx-reply>Tracing through the full machinery would take me a while, but I can at least confirm that there should not be a difference between simple and non-simple arguments lists in this case, so V8 is definitely wrong <em>somewhere</em>, and it seems quite likely to be wrong in the cases where it differs from other implementations</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Mon Feb 28 2022 18:42:31 GMT-0800 (Pacific Standard Time)">02:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@sirisian:matrix.org">sirisian</span>&gt;</div></td><td class="msg-cell">Well intuitive as in all closed over variables and they automatically behave like SharedArrayBuffer items without the bloat. (And in scope functions can just be called without any module syntax). Creating a variable and using an atomic to increment it or other operation would just "work" without stuff like shared structs or shuffling stuff into TypedArrays like it's some separate API.</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Mon Feb 28 2022 18:45:12 GMT-0800 (Pacific Standard Time)">02:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">SABs are the single most "handle with care" part of the entire language, especially when used without atomics; making it so that every single thing in the language behaved like that would be... not an idea I'd endorse, to put it lightly, and I imagine that's a common sentiment among the committee</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Mon Feb 28 2022 18:46:32 GMT-0800 (Pacific Standard Time)">02:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">Like, just getting the memory model right for SABs was incredibly complicated, and not without bugs; see e.g. <a href="https://github.com/tc39/ecma262/issues/1680">https://github.com/tc39/ecma262/issues/1680</a> <a href="https://github.com/tc39/ecma262/issues/2231">https://github.com/tc39/ecma262/issues/2231</a> <a href="https://github.com/tc39/ecma262/pull/1511">https://github.com/tc39/ecma262/pull/1511</a></td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Mon Feb 28 2022 18:46:52 GMT-0800 (Pacific Standard Time)">02:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">and that's the <em>simple</em> case, where you're just dealing with raw bytes; it gets more complicated when you get more complicated data structures involved</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Mon Feb 28 2022 18:49:43 GMT-0800 (Pacific Standard Time)">02:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">(also blocking atomics don't work on the main thread, so the "using an atomic to increment it" thing doesn't really make sense, at least not on the main thread)</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Mon Feb 28 2022 19:04:43 GMT-0800 (Pacific Standard Time)">03:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@sirisian:matrix.org">sirisian</span>&gt;</div></td><td class="msg-cell">I meant incrementing in other threads. My general thinking is I'd like for SharedArrayBuffer to be deprecated such that a variable and thread system works more like C++. In this case everything is handled with care implied. Was talking to someone about my type proposal/notes and they commented that you can't just create say an integer in the main thread and increment it in multiple threads (with atomics). In this setup you'd be able to do things like swap two object references atomically or set a variable object atomically. It definitely would be very complex to implement, but for the user they could just call functions to create threads and implement parallelism without any extra sugar (wrapping of objects, functions, variables).</td></tr>

</tbody></table></div></div></div>
</body></html>