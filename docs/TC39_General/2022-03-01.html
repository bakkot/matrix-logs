<!DOCTYPE html><html><head>
  <title>TC39 General on 2022-03-01</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "TC39 General";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">TC39 General<br>2022-03-01<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2022-02-28" class="nav-link"><span>prev</span></a>
<span style="float:right">next</span>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search TC39 General">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Mon Feb 28 2022 16:55:47 GMT-0800 (Pacific Standard Time)">00:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell"><span class="nick-5">danielrosenwasser</span> / <span class="nick-15">rbuckton</span>: The new What's Changed Since RC/Beta in the TS release notes are üëç</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Mon Feb 28 2022 17:47:45 GMT-0800 (Pacific Standard Time)">01:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@sirisian:matrix.org">sirisian</span>&gt;</div></td><td class="msg-cell">Question. Possibly I'm not searching the right terms, but when async/await was added to ECMAScript, why was threading never pulled into the core language away from Web Workers? (As others I've done the blob thing for years with workers when doing heavily threaded things). I kind of expected that one would be able to just call an async function and have it execute on another thread by now with intuitive shared state, but that was never proposed. Why not?</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Mon Feb 28 2022 17:55:08 GMT-0800 (Pacific Standard Time)">01:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">"intuitive shared state" is a contradiction in terms</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Mon Feb 28 2022 17:55:51 GMT-0800 (Pacific Standard Time)">01:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">the thing you're proposing would be incredibly complicated to specify or implement, and we're just now getting to the point where we're fleshing out the building blocks which might let us get there someday</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Mon Feb 28 2022 17:56:03 GMT-0800 (Pacific Standard Time)">01:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">or, well, not there precisely, but somewhere like it</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Mon Feb 28 2022 18:19:23 GMT-0800 (Pacific Standard Time)">02:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Question. Possibly I'm not searching the right terms, but when async/await was added to ECMAScript, why was threading never pulled into the core language away from Web Workers? (As others I've done the blob thing for years with workers when doing heavily threaded things). I kind of expected that one would be able to just call an async function and have it execute on another thread by now with intuitive shared state, but that was never proposed. Why not?</blockquote></mx-reply><p>we're on the route of that. ü§î<br>search for those proposals:</p>
<ul>
<li>struct (shared struct section)</li>
<li>module block</li>
</ul>
</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Mon Feb 28 2022 18:41:56 GMT-0800 (Pacific Standard Time)">02:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <p>can someone verify my assessment that <a href="https://github.com/mishoo/UglifyJS/issues/5370">https://github.com/mishoo/UglifyJS/issues/5370</a> represents a deviation of V8 from other major implementations in FunctionDeclarationInstantiation with respect to non-simple parameter lists when VarDeclaredNames includes "arguments"?</p>
<pre><code>$ eshost -se '[].concat(...["function arguments(){}", "var arguments"].map(occluding =&gt; ["()", "(..._)", "(_=0)"].map(params =&gt; { const r="return typeof arguments; ", f=Function(params.slice(1,-1), r+occluding); return `${f().padEnd(9)} // function${params}{${r+occluding}}`; }))).join("\n")'
#### ChakraCore, engine262, JavaScriptCore, Moddable XS, SpiderMonkey
function  // function(){return typeof arguments; function arguments(){}}
function  // function(..._){return typeof arguments; function arguments(){}}
function  // function(_=0){return typeof arguments; function arguments(){}}
object    // function(){return typeof arguments; var arguments}
object    // function(..._){return typeof arguments; var arguments}
object    // function(_=0){return typeof arguments; var arguments}

#### V8
function  // function(){return typeof arguments; function arguments(){}}
function  // function(..._){return typeof arguments; function arguments(){}}
function  // function(_=0){return typeof arguments; function arguments(){}}
object    // function(){return typeof arguments; var arguments}
undefined // function(..._){return typeof arguments; var arguments}
undefined // function(_=0){return typeof arguments; var arguments}
</code></pre>
</blockquote></mx-reply>Tracing through the full machinery would take me a while, but I can at least confirm that there should not be a difference between simple and non-simple arguments lists in this case, so V8 is definitely wrong <em>somewhere</em>, and it seems quite likely to be wrong in the cases where it differs from other implementations</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Mon Feb 28 2022 18:42:31 GMT-0800 (Pacific Standard Time)">02:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@sirisian:matrix.org">sirisian</span>&gt;</div></td><td class="msg-cell">Well intuitive as in all closed over variables and they automatically behave like SharedArrayBuffer items without the bloat. (And in scope functions can just be called without any module syntax). Creating a variable and using an atomic to increment it or other operation would just "work" without stuff like shared structs or shuffling stuff into TypedArrays like it's some separate API.</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Mon Feb 28 2022 18:45:12 GMT-0800 (Pacific Standard Time)">02:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">SABs are the single most "handle with care" part of the entire language, especially when used without atomics; making it so that every single thing in the language behaved like that would be... not an idea I'd endorse, to put it lightly, and I imagine that's a common sentiment among the committee</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Mon Feb 28 2022 18:46:32 GMT-0800 (Pacific Standard Time)">02:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">Like, just getting the memory model right for SABs was incredibly complicated, and not without bugs; see e.g. <a href="https://github.com/tc39/ecma262/issues/1680">https://github.com/tc39/ecma262/issues/1680</a> <a href="https://github.com/tc39/ecma262/issues/2231">https://github.com/tc39/ecma262/issues/2231</a> <a href="https://github.com/tc39/ecma262/pull/1511">https://github.com/tc39/ecma262/pull/1511</a></td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Mon Feb 28 2022 18:46:52 GMT-0800 (Pacific Standard Time)">02:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">and that's the <em>simple</em> case, where you're just dealing with raw bytes; it gets more complicated when you get more complicated data structures involved</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Mon Feb 28 2022 18:49:43 GMT-0800 (Pacific Standard Time)">02:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">(also blocking atomics don't work on the main thread, so the "using an atomic to increment it" thing doesn't really make sense, at least not on the main thread)</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Mon Feb 28 2022 19:04:43 GMT-0800 (Pacific Standard Time)">03:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@sirisian:matrix.org">sirisian</span>&gt;</div></td><td class="msg-cell">I meant incrementing in other threads. My general thinking is I'd like for SharedArrayBuffer to be deprecated such that a variable and thread system works more like C++. In this case everything is handled with care implied. Was talking to someone about my type proposal/notes and they commented that you can't just create say an integer in the main thread and increment it in multiple threads (with atomics). In this setup you'd be able to do things like swap two object references atomically or set a variable object atomically. It definitely would be very complex to implement, but for the user they could just call functions to create threads and implement parallelism without any extra sugar (wrapping of objects, functions, variables).</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Mon Feb 28 2022 19:05:06 GMT-0800 (Pacific Standard Time)">03:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">also, not everyone on the committee :cough: is convinced that threads are "not incredibly harmful" :-)</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Mon Feb 28 2022 19:08:48 GMT-0800 (Pacific Standard Time)">03:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@sirisian:matrix.org">sirisian</span>&gt;</div></td><td class="msg-cell">I completely get that. I'm migrating over to WebGPU for my current toy projects. Most of my applications were more "spin up 8 threads because I can't use the GPU to compute this" situation. Still for simple projects for demos it would be nice to write a few lines of code to say run a pathfinding algorithm on multiple threads. Though the module block fits those kind of applications cleanly where I'm not sharing state between threads.</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Mon Feb 28 2022 19:09:37 GMT-0800 (Pacific Standard Time)">03:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">As a rule we don't usually introduce features only intended to be used in toy projects, particularly when they have sharp edges</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Mon Feb 28 2022 19:10:12 GMT-0800 (Pacific Standard Time)">03:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">and shared-memory parallelism isn't just a sharp edge, it's an entire box of rusty razor blades</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Mon Feb 28 2022 19:10:44 GMT-0800 (Pacific Standard Time)">03:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> and shared-memory parallelism isn't just a sharp edge, it's an entire box of rusty razor blades</blockquote></mx-reply>so how u think about the shared structs proposal?</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Mon Feb 28 2022 19:12:01 GMT-0800 (Pacific Standard Time)">03:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">Jack Works</span>: as with SABs it's something which will be useful to build safe-to-use libraries on top of, but not something I'd expect users to touch in everyday life</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Mon Feb 28 2022 19:13:14 GMT-0800 (Pacific Standard Time)">03:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">it's carefully designed so that the shared memory parts are constrained to the struct and its references, and doesn't get out into the rest of your program, which is the only thing which makes it even conceivably a good idea</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Mon Feb 28 2022 19:13:52 GMT-0800 (Pacific Standard Time)">03:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><p>that is, I agree with the readme:</p>
<blockquote>
<p>Like other shared memory features in JavaScript, it is high in expressive power and high in difficulty to use correctly. This proposal is both intended as an incremental step towards higher-level, easier-to-use (e.g. data-race free by construction) concurrency abstractions as well as an escape hatch for expert programmers who need the expressivity.</p>
</blockquote>
</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Mon Feb 28 2022 19:13:56 GMT-0800 (Pacific Standard Time)">03:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <span class="nick-4">Jack Works</span>: as with SABs it's something which will be useful to build safe-to-use libraries on top of, but not something I'd expect users to touch in everyday life</blockquote></mx-reply>once it is available, it will be used in everyday life by programmers that has c++/rust/java/... background</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Mon Feb 28 2022 19:14:05 GMT-0800 (Pacific Standard Time)">03:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">well</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Mon Feb 28 2022 19:14:07 GMT-0800 (Pacific Standard Time)">03:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">seems bad</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Mon Feb 28 2022 19:14:11 GMT-0800 (Pacific Standard Time)">03:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell">lol</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Mon Feb 28 2022 19:14:15 GMT-0800 (Pacific Standard Time)">03:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">if we actually think that's going to happen, it's probably not worth putting in the language</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Mon Feb 28 2022 19:15:06 GMT-0800 (Pacific Standard Time)">03:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">that said, I have a background in all of those languages and still wouldn't touch structs without thinking <em>extremely</em> carefully about it</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Mon Feb 28 2022 19:15:18 GMT-0800 (Pacific Standard Time)">03:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell">no one use SAB+worker because it's too hard to create one than just following JS style of multi-thread programming </td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Mon Feb 28 2022 19:15:42 GMT-0800 (Pacific Standard Time)">03:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">I use SABs...</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Mon Feb 28 2022 19:16:02 GMT-0800 (Pacific Standard Time)">03:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">but, you know, only after thinking extremely carefully about it</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Mon Feb 28 2022 19:16:13 GMT-0800 (Pacific Standard Time)">03:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">and emscripten uses them to good effect as well</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Mon Feb 28 2022 19:16:45 GMT-0800 (Pacific Standard Time)">03:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">I think module blocks will make workers more popular in general, tbh</td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Mon Feb 28 2022 19:17:02 GMT-0800 (Pacific Standard Time)">03:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I completely get that. I'm migrating over to WebGPU for my current toy projects. Most of my applications were more "spin up 8 threads because I can't use the GPU to compute this" situation. Still for simple projects for demos it would be nice to write a few lines of code to say run a pathfinding algorithm on multiple threads. Though the module block fits those kind of applications cleanly where I'm not sharing state between threads.</blockquote></mx-reply>ü§î for a toy project maybe you can try a toy runtime. I've heard that the structed proposal has a demo implementation in V8. maybe u can contact v8 team to get a demo build and play around</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Mon Feb 28 2022 19:17:06 GMT-0800 (Pacific Standard Time)">03:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">if something is going to encourage wider usage of multi-threaded programming in JS, that sounds like a huge detriment to the language</td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Mon Feb 28 2022 19:17:14 GMT-0800 (Pacific Standard Time)">03:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">multi-threading is good!</td></tr>
  <tr class="msg" id="L35"><td class="ts-cell"><a class="ts" href="#L35" alt="Mon Feb 28 2022 19:17:14 GMT-0800 (Pacific Standard Time)">03:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">"being single-threaded" is a feature, not a bug</td></tr>
  <tr class="msg" id="L36"><td class="ts-cell"><a class="ts" href="#L36" alt="Mon Feb 28 2022 19:17:16 GMT-0800 (Pacific Standard Time)">03:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@sirisian:matrix.org">sirisian</span>&gt;</div></td><td class="msg-cell">Well WebGPU makes it not a toy project technically since it's identical to an existing piece of software. The performance issue of doing the project with web workers made it very suboptimal compared to usual approaches (like much slower with limitations a GPU approach wouldn't have). The main idea though is taking a data structure and passing it through a pipeline where each operation is expensive. One could imagine say using the pipeline proposal and each function just calls a thread? yeah, that's probably close, but simplified.</td></tr>
  <tr class="msg" id="L37"><td class="ts-cell"><a class="ts" href="#L37" alt="Mon Feb 28 2022 19:17:20 GMT-0800 (Pacific Standard Time)">03:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">shared-memory multithreading is bad</td></tr>
  <tr class="msg" id="L38"><td class="ts-cell"><a class="ts" href="#L38" alt="Mon Feb 28 2022 19:17:25 GMT-0800 (Pacific Standard Time)">03:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">but multiple threads are good</td></tr>
  <tr class="msg" id="L39"><td class="ts-cell"><a class="ts" href="#L39" alt="Mon Feb 28 2022 19:17:38 GMT-0800 (Pacific Standard Time)">03:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">CPUs have many cores</td></tr>
  <tr class="msg" id="L40"><td class="ts-cell"><a class="ts" href="#L40" alt="Mon Feb 28 2022 19:17:43 GMT-0800 (Pacific Standard Time)">03:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">i can agree that things that are observably the same as "being single-threaded" is good</td></tr>
  <tr class="msg" id="L41"><td class="ts-cell"><a class="ts" href="#L41" alt="Mon Feb 28 2022 19:18:10 GMT-0800 (Pacific Standard Time)">03:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">the thing i value is that things must act as if they're single-threaded. they can be faster than that if i can't tell the difference, and that's a good thing</td></tr>
  <tr class="msg" id="L42"><td class="ts-cell"><a class="ts" href="#L42" alt="Mon Feb 28 2022 19:18:12 GMT-0800 (Pacific Standard Time)">03:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">deliberately limiting your programming language so that it can't use more than 1/16th of the CPU seems like... bad</td></tr>
  <tr class="msg" id="L43"><td class="ts-cell"><a class="ts" href="#L43" alt="Mon Feb 28 2022 19:18:28 GMT-0800 (Pacific Standard Time)">03:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@sirisian:matrix.org">sirisian</span>&gt;</div></td><td class="msg-cell">I have a 12900k for reference. :|</td></tr>
  <tr class="msg" id="L44"><td class="ts-cell"><a class="ts" href="#L44" alt="Mon Feb 28 2022 19:19:07 GMT-0800 (Pacific Standard Time)">03:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">we shouldn't be optimizing for people with 12900ks</td></tr>
  <tr class="msg" id="L45"><td class="ts-cell"><a class="ts" href="#L45" alt="Mon Feb 28 2022 19:19:24 GMT-0800 (Pacific Standard Time)">03:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> "being single-threaded" is a feature, not a bug</blockquote></mx-reply>this goes too far. i support multi-thread by message passing, not memory sharing</td></tr>
  <tr class="msg" id="L46"><td class="ts-cell"><a class="ts" href="#L46" alt="Mon Feb 28 2022 19:19:26 GMT-0800 (Pacific Standard Time)">03:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">but even the cheapest android phones available have 4 cores these days</td></tr>
  <tr class="msg" id="L47"><td class="ts-cell"><a class="ts" href="#L47" alt="Mon Feb 28 2022 19:21:23 GMT-0800 (Pacific Standard Time)">03:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@pokute:matrix.org">pokute</span>&gt;</div></td><td class="msg-cell">We could simultaneously introduce manual memory management as a viable alternative to GC in ECMAScript since users will appreciate the freedom. üöé</td></tr>
  <tr class="msg" id="L48"><td class="ts-cell"><a class="ts" href="#L48" alt="Mon Feb 28 2022 19:22:02 GMT-0800 (Pacific Standard Time)">03:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell">actually I'm curious about, if Record&amp;Tuple are shipped and highly optimized by the engine, does that make life easier?</td></tr>
  <tr class="msg" id="L49"><td class="ts-cell"><a class="ts" href="#L49" alt="Mon Feb 28 2022 19:22:30 GMT-0800 (Pacific Standard Time)">03:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">records and tuples are immutable so it doesn't much matter</td></tr>
  <tr class="msg" id="L50"><td class="ts-cell"><a class="ts" href="#L50" alt="Mon Feb 28 2022 19:22:37 GMT-0800 (Pacific Standard Time)">03:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell">we can pass immutable object/arrays with 0 serialization cost (engine can share the memory)</td></tr>
  <tr class="msg" id="L51"><td class="ts-cell"><a class="ts" href="#L51" alt="Mon Feb 28 2022 19:22:38 GMT-0800 (Pacific Standard Time)">03:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">you'd still have to <code>postMessage</code> them, and you can do that with a plain object</td></tr>
  <tr class="msg" id="L52"><td class="ts-cell"><a class="ts" href="#L52" alt="Mon Feb 28 2022 19:22:50 GMT-0800 (Pacific Standard Time)">03:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> you'd still have to <code>postMessage</code> them, and you can do that with a plain object</blockquote></mx-reply>yeah, but that need a clone</td></tr>
  <tr class="msg" id="L53"><td class="ts-cell"><a class="ts" href="#L53" alt="Mon Feb 28 2022 19:22:54 GMT-0800 (Pacific Standard Time)">03:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">yeah that's fair</td></tr>
  <tr class="msg" id="L54"><td class="ts-cell"><a class="ts" href="#L54" alt="Mon Feb 28 2022 19:23:38 GMT-0800 (Pacific Standard Time)">03:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">my impression is that the expensiveness of the clone is rarely a limiting factor, but it might be for some projects</td></tr>
  <tr class="msg" id="L55"><td class="ts-cell"><a class="ts" href="#L55" alt="Mon Feb 28 2022 19:23:51 GMT-0800 (Pacific Standard Time)">03:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> We could simultaneously introduce manual memory management as a viable alternative to GC in ECMAScript since users will appreciate the freedom. üöé</blockquote></mx-reply>WeakMap[@@iterator]!</td></tr>
  <tr class="msg" id="L56"><td class="ts-cell"><a class="ts" href="#L56" alt="Mon Feb 28 2022 19:24:07 GMT-0800 (Pacific Standard Time)">03:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">that's been proposed...</td></tr>
  <tr class="msg" id="L57"><td class="ts-cell"><a class="ts" href="#L57" alt="Mon Feb 28 2022 19:24:14 GMT-0800 (Pacific Standard Time)">03:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">you can do it yourself with weakrefs if you really want to</td></tr>
  <tr class="msg" id="L58"><td class="ts-cell"><a class="ts" href="#L58" alt="Mon Feb 28 2022 19:24:16 GMT-0800 (Pacific Standard Time)">03:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">but, like</td></tr>
  <tr class="msg" id="L59"><td class="ts-cell"><a class="ts" href="#L59" alt="Mon Feb 28 2022 19:24:17 GMT-0800 (Pacific Standard Time)">03:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">don't</td></tr>
  <tr class="msg" id="L60"><td class="ts-cell"><a class="ts" href="#L60" alt="Mon Feb 28 2022 19:25:11 GMT-0800 (Pacific Standard Time)">03:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> my impression is that the expensiveness of the clone is rarely a limiting factor, but it might be for some projects</blockquote></mx-reply>üëÄ what's the common limit?</td></tr>
  <tr class="msg" id="L61"><td class="ts-cell"><a class="ts" href="#L61" alt="Mon Feb 28 2022 19:25:55 GMT-0800 (Pacific Standard Time)">03:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">workers are annoying to create, mostly</td></tr>
  <tr class="msg" id="L62"><td class="ts-cell"><a class="ts" href="#L62" alt="Mon Feb 28 2022 19:26:01 GMT-0800 (Pacific Standard Time)">03:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">and postmessage is annoying to use</td></tr>
  <tr class="msg" id="L63"><td class="ts-cell"><a class="ts" href="#L63" alt="Mon Feb 28 2022 19:26:11 GMT-0800 (Pacific Standard Time)">03:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">you can't just <code>await</code> stuff without building some wrappers</td></tr>
  <tr class="msg" id="L64"><td class="ts-cell"><a class="ts" href="#L64" alt="Mon Feb 28 2022 19:27:23 GMT-0800 (Pacific Standard Time)">03:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@sirisian:matrix.org">sirisian</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> if something is going to encourage wider usage of multi-threaded programming in JS, that sounds like a huge detriment to the language</blockquote></mx-reply>My thinking is people should be able to use it without thinking much or from other libraries. Like years ago I wrote a small game server in C++ for web sockets then converted it to node.js with WS. In order to speed up things to support thousands of players again I moved the packet deserialization stuff to another "thread" with cluster. Creating simple producer/consumer systems in worker threads for processing packets should be like super simple. (In C++ I was using I think boost fibers for something similar and it was very elegant).</td></tr>
  <tr class="msg" id="L65"><td class="ts-cell"><a class="ts" href="#L65" alt="Mon Feb 28 2022 19:27:59 GMT-0800 (Pacific Standard Time)">03:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell">I think requiring memory-sharing in JS is like requiring imperative style programming in haskell ü§î</td></tr>
  <tr class="msg" id="L66"><td class="ts-cell"><a class="ts" href="#L66" alt="Mon Feb 28 2022 19:28:01 GMT-0800 (Pacific Standard Time)">03:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">you've got a lot of "shoulds" in there that seem pretty informed by C++ experience, which isn't something most JS programmers have or will ever have</td></tr>
  <tr class="msg" id="L67"><td class="ts-cell"><a class="ts" href="#L67" alt="Mon Feb 28 2022 19:30:18 GMT-0800 (Pacific Standard Time)">03:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">i'm pretty confident that in the fullness of time, the majority of JS devs won't have ever used something besides JS :-) no way to prove it either way, ofc.</td></tr>
  <tr class="msg" id="L68"><td class="ts-cell"><a class="ts" href="#L68" alt="Mon Feb 28 2022 19:30:29 GMT-0800 (Pacific Standard Time)">03:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><span class="nick-6">ljharb</span> I feel like "it is good to do expensive compute off the main thread" is like... not a principle I would expect to find disagreement with?</td></tr>
  <tr class="msg" id="L69"><td class="ts-cell"><a class="ts" href="#L69" alt="Mon Feb 28 2022 19:30:30 GMT-0800 (Pacific Standard Time)">03:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jessidhia:matrix.org">Jessidhia</span>&gt;</div></td><td class="msg-cell">I haven‚Äôt used Go in over 5 years but I miss goroutines and channels</td></tr>
  <tr class="msg" id="L70"><td class="ts-cell"><a class="ts" href="#L70" alt="Mon Feb 28 2022 19:31:00 GMT-0800 (Pacific Standard Time)">03:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@sirisian:matrix.org">sirisian</span>&gt;</div></td><td class="msg-cell">Well I'm just saying there are situations where a JS programmer runs into an issue and the real solution of just calling a thread and passing work over is much more complicated than it should be.</td></tr>
  <tr class="msg" id="L71"><td class="ts-cell"><a class="ts" href="#L71" alt="Mon Feb 28 2022 19:31:04 GMT-0800 (Pacific Standard Time)">03:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@pokute:matrix.org">pokute</span>&gt;</div></td><td class="msg-cell">Well, I would be interested in what kind of API would be super simple for a JS developer for writing "multi-threaded" code.</td></tr>
  <tr class="msg" id="L72"><td class="ts-cell"><a class="ts" href="#L72" alt="Mon Feb 28 2022 19:31:06 GMT-0800 (Pacific Standard Time)">03:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell"><span class="nick-2">bakkot</span>: yeah i'm not disputing that. something that worked identically single-threaded as multi-threaded, so engines could unobservably execute them across multiple cores, would be amazing</td></tr>
  <tr class="msg" id="L73"><td class="ts-cell"><a class="ts" href="#L73" alt="Mon Feb 28 2022 19:31:35 GMT-0800 (Pacific Standard Time)">03:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">yeah but that's not... possible</td></tr>
  <tr class="msg" id="L74"><td class="ts-cell"><a class="ts" href="#L74" alt="Mon Feb 28 2022 19:31:44 GMT-0800 (Pacific Standard Time)">03:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">the whole point is that the compute is happening <em>while other compute is happening</em></td></tr>
  <tr class="msg" id="L75"><td class="ts-cell"><a class="ts" href="#L75" alt="Mon Feb 28 2022 19:31:48 GMT-0800 (Pacific Standard Time)">03:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">which is inherently observable</td></tr>
  <tr class="msg" id="L76"><td class="ts-cell"><a class="ts" href="#L76" alt="Mon Feb 28 2022 19:31:57 GMT-0800 (Pacific Standard Time)">03:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">ay, there's the rub</td></tr>
  <tr class="msg" id="L77"><td class="ts-cell"><a class="ts" href="#L77" alt="Mon Feb 28 2022 19:32:37 GMT-0800 (Pacific Standard Time)">03:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">personally i would prefer a world where everything is eternally single-threaded, and parallelism is done via processes, to a world where JS is ruined by bringing in all the problems of threading. i'm quite sure there are those who violently disagree with me, ofc.</td></tr>
  <tr class="msg" id="L78"><td class="ts-cell"><a class="ts" href="#L78" alt="Mon Feb 28 2022 19:32:52 GMT-0800 (Pacific Standard Time)">03:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">threading is already a thing in JS</td></tr>
  <tr class="msg" id="L79"><td class="ts-cell"><a class="ts" href="#L79" alt="Mon Feb 28 2022 19:33:03 GMT-0800 (Pacific Standard Time)">03:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">sadly, that is true</td></tr>
  <tr class="msg" id="L80"><td class="ts-cell"><a class="ts" href="#L80" alt="Mon Feb 28 2022 19:33:10 GMT-0800 (Pacific Standard Time)">03:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">doesn't seem to have been ruined</td></tr>
  <tr class="msg" id="L81"><td class="ts-cell"><a class="ts" href="#L81" alt="Mon Feb 28 2022 19:33:15 GMT-0800 (Pacific Standard Time)">03:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">... at least, not by that</td></tr>
  <tr class="msg" id="L82"><td class="ts-cell"><a class="ts" href="#L82" alt="Mon Feb 28 2022 19:33:20 GMT-0800 (Pacific Standard Time)">03:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">that's because it's unapproachable and not super usable :-)</td></tr>
  <tr class="msg" id="L83"><td class="ts-cell"><a class="ts" href="#L83" alt="Mon Feb 28 2022 19:33:35 GMT-0800 (Pacific Standard Time)">03:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> doesn't seem to have been ruined</blockquote></mx-reply>because that api is tooooo hard to use</td></tr>
  <tr class="msg" id="L84"><td class="ts-cell"><a class="ts" href="#L84" alt="Mon Feb 28 2022 19:33:37 GMT-0800 (Pacific Standard Time)">03:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">i'm content to keep it that way, so that advanced niche use cases can leverage it, but regular JS devs aren't tempted to</td></tr>
  <tr class="msg" id="L85"><td class="ts-cell"><a class="ts" href="#L85" alt="Mon Feb 28 2022 19:34:05 GMT-0800 (Pacific Standard Time)">03:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell">you could only manipulate a number array</td></tr>
  <tr class="msg" id="L86"><td class="ts-cell"><a class="ts" href="#L86" alt="Mon Feb 28 2022 19:34:13 GMT-0800 (Pacific Standard Time)">03:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">you can postmessage</td></tr>
  <tr class="msg" id="L87"><td class="ts-cell"><a class="ts" href="#L87" alt="Mon Feb 28 2022 19:34:27 GMT-0800 (Pacific Standard Time)">03:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">which is the <em>only</em> multithreading in some languages</td></tr>
  <tr class="msg" id="L88"><td class="ts-cell"><a class="ts" href="#L88" alt="Mon Feb 28 2022 19:34:43 GMT-0800 (Pacific Standard Time)">03:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">message passing is a totally normal way of doing multithreading</td></tr>
  <tr class="msg" id="L89"><td class="ts-cell"><a class="ts" href="#L89" alt="Mon Feb 28 2022 19:35:13 GMT-0800 (Pacific Standard Time)">03:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> which is the <em>only</em> multithreading in some languages</blockquote></mx-reply>(including JS before we have SAB)</td></tr>
  <tr class="msg" id="L90"><td class="ts-cell"><a class="ts" href="#L90" alt="Mon Feb 28 2022 19:35:13 GMT-0800 (Pacific Standard Time)">03:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><span class="nick-6">ljharb</span> I stand by "it is good to do expensive compute off the main thread"</td></tr>
  <tr class="msg" id="L91"><td class="ts-cell"><a class="ts" href="#L91" alt="Mon Feb 28 2022 19:35:28 GMT-0800 (Pacific Standard Time)">03:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">if that is good in general, then it is good for "regular JS devs"</td></tr>
  <tr class="msg" id="L92"><td class="ts-cell"><a class="ts" href="#L92" alt="Mon Feb 28 2022 19:35:41 GMT-0800 (Pacific Standard Time)">03:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">i think the goodness of that is far outweighed by the badness of threaded programming gotchas.</td></tr>
  <tr class="msg" id="L93"><td class="ts-cell"><a class="ts" href="#L93" alt="Mon Feb 28 2022 19:35:54 GMT-0800 (Pacific Standard Time)">03:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">slowness &gt;&gt;&gt;&gt;&gt;&gt; race conditions, always</td></tr>
  <tr class="msg" id="L94"><td class="ts-cell"><a class="ts" href="#L94" alt="Mon Feb 28 2022 19:36:02 GMT-0800 (Pacific Standard Time)">03:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">basically all threaded programming gotchas are about shared memory</td></tr>
  <tr class="msg" id="L95"><td class="ts-cell"><a class="ts" href="#L95" alt="Mon Feb 28 2022 19:36:19 GMT-0800 (Pacific Standard Time)">03:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@pokute:matrix.org">pokute</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Well I'm just saying there are situations where a JS programmer runs into an issue and the real solution of just calling a thread and passing work over is much more complicated than it should be.</blockquote></mx-reply>We can compare this to a early 2000s C++ programmer runs into an issue where they are waiting for a long operation (like disk read) and want to do something in the meantime. The default solution of threads and passing work over is a lot more complicated to wrap around than most other C++ code, especially with the special and hard-to-intuit considerations of thread-safeness.</td></tr>
  <tr class="msg" id="L96"><td class="ts-cell"><a class="ts" href="#L96" alt="Mon Feb 28 2022 19:36:29 GMT-0800 (Pacific Standard Time)">03:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">race conditions are almost always a thing in shared memory, but are no more a thing with message passing than they are with async functions</td></tr>
  <tr class="msg" id="L97"><td class="ts-cell"><a class="ts" href="#L97" alt="Mon Feb 28 2022 19:36:30 GMT-0800 (Pacific Standard Time)">03:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">i would be happy to be convinced that there's a threading model that has no shared memory yet has a deterministic way to communicate</td></tr>
  <tr class="msg" id="L98"><td class="ts-cell"><a class="ts" href="#L98" alt="Mon Feb 28 2022 19:36:38 GMT-0800 (Pacific Standard Time)">03:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">postmessage</td></tr>
  <tr class="msg" id="L99"><td class="ts-cell"><a class="ts" href="#L99" alt="Mon Feb 28 2022 19:36:41 GMT-0800 (Pacific Standard Time)">03:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">postmessage is the thing you are talking about</td></tr>
  <tr class="msg" id="L100"><td class="ts-cell"><a class="ts" href="#L100" alt="Mon Feb 28 2022 19:36:45 GMT-0800 (Pacific Standard Time)">03:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">also channels in go</td></tr>
  <tr class="msg" id="L101"><td class="ts-cell"><a class="ts" href="#L101" alt="Mon Feb 28 2022 19:36:51 GMT-0800 (Pacific Standard Time)">03:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">postMessage takes objects too</td></tr>
  <tr class="msg" id="L102"><td class="ts-cell"><a class="ts" href="#L102" alt="Mon Feb 28 2022 19:36:54 GMT-0800 (Pacific Standard Time)">03:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">it's like a very normal way of doing multithreading</td></tr>
  <tr class="msg" id="L103"><td class="ts-cell"><a class="ts" href="#L103" alt="Mon Feb 28 2022 19:36:59 GMT-0800 (Pacific Standard Time)">03:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">and to be fair, i'm not familiar with go</td></tr>
  <tr class="msg" id="L104"><td class="ts-cell"><a class="ts" href="#L104" alt="Mon Feb 28 2022 19:36:59 GMT-0800 (Pacific Standard Time)">03:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">the objects are cloned, not shared, in postMessage</td></tr>
  <tr class="msg" id="L105"><td class="ts-cell"><a class="ts" href="#L105" alt="Mon Feb 28 2022 19:37:33 GMT-0800 (Pacific Standard Time)">03:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">sure, but structured cloning is its own pile of problems :-)</td></tr>
  <tr class="msg" id="L106"><td class="ts-cell"><a class="ts" href="#L106" alt="Mon Feb 28 2022 19:38:06 GMT-0800 (Pacific Standard Time)">03:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">right but whatever problems structured clone has, those problems aren't inherent to multithreading</td></tr>
  <tr class="msg" id="L107"><td class="ts-cell"><a class="ts" href="#L107" alt="Mon Feb 28 2022 19:38:14 GMT-0800 (Pacific Standard Time)">03:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> We can compare this to a early 2000s C++ programmer runs into an issue where they are waiting for a long operation (like disk read) and want to do something in the meantime. The default solution of threads and passing work over is a lot more complicated to wrap around than most other C++ code, especially with the special and hard-to-intuit considerations of thread-safeness.</blockquote></mx-reply>don't know c++, but is io_uring some kind of async without block threading?</td></tr>
  <tr class="msg" id="L108"><td class="ts-cell"><a class="ts" href="#L108" alt="Mon Feb 28 2022 19:38:30 GMT-0800 (Pacific Standard Time)">03:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">being against shared memory parallelism is very reasonable, but it seems wrong to generalize this to being against multithreading in general</td></tr>
  <tr class="msg" id="L109"><td class="ts-cell"><a class="ts" href="#L109" alt="Mon Feb 28 2022 19:39:44 GMT-0800 (Pacific Standard Time)">03:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@sirisian:matrix.org">sirisian</span>&gt;</div></td><td class="msg-cell">That reminds me of someone's finance app I saw they made for a company. Kind of lagged. Was doing stuff with hundreds of thousands of records client-side. This was before web workers (and Power BI I think). Fascinating what people try to do in JS single page applications. Granted computers are faster now, so I don't think it's as huge of an issue.</td></tr>
  <tr class="msg" id="L110"><td class="ts-cell"><a class="ts" href="#L110" alt="Mon Feb 28 2022 19:39:49 GMT-0800 (Pacific Standard Time)">03:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> sure, but structured cloning is its own pile of problems :-)</blockquote></mx-reply>then message passing by R&amp;T ‚Ñ¢!</td></tr>
  <tr class="msg" id="L111"><td class="ts-cell"><a class="ts" href="#L111" alt="Mon Feb 28 2022 19:42:48 GMT-0800 (Pacific Standard Time)">03:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@pokute:matrix.org">pokute</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> That reminds me of someone's finance app I saw they made for a company. Kind of lagged. Was doing stuff with hundreds of thousands of records client-side. This was before web workers (and Power BI I think). Fascinating what people try to do in JS single page applications. Granted computers are faster now, so I don't think it's as huge of an issue.</blockquote></mx-reply>I bet in a hundred years people will still be able to write lagging apps, even with thousands of items and even with multithreading. Can't underestimate people.  (Though if AI will write the software......)</td></tr>
  <tr class="msg" id="L112"><td class="ts-cell"><a class="ts" href="#L112" alt="Mon Feb 28 2022 19:44:24 GMT-0800 (Pacific Standard Time)">03:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell">another question. now we reified Realms and some host hooks (compartment proposal) as something we can control. is it impossible to have Agent/Agent Clusters reified to run suspious code? </td></tr>
  <tr class="msg" id="L113"><td class="ts-cell"><a class="ts" href="#L113" alt="Mon Feb 28 2022 19:44:59 GMT-0800 (Pacific Standard Time)">03:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">depends on what you mean by "suspicious code"?</td></tr>
  <tr class="msg" id="L114"><td class="ts-cell"><a class="ts" href="#L114" alt="Mon Feb 28 2022 19:45:11 GMT-0800 (Pacific Standard Time)">03:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell">untrusted code</td></tr>
  <tr class="msg" id="L115"><td class="ts-cell"><a class="ts" href="#L115" alt="Mon Feb 28 2022 19:45:22 GMT-0800 (Pacific Standard Time)">03:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">completely untrusted? no</td></tr>
  <tr class="msg" id="L116"><td class="ts-cell"><a class="ts" href="#L116" alt="Mon Feb 28 2022 19:46:02 GMT-0800 (Pacific Standard Time)">03:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">spectre is going to sit there haunting you</td></tr>
  <tr class="msg" id="L117"><td class="ts-cell"><a class="ts" href="#L117" alt="Mon Feb 28 2022 19:46:32 GMT-0800 (Pacific Standard Time)">03:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">if timing attacks are outside your thread model, though, what do you want that realms don't already give you?</td></tr>
  <tr class="msg" id="L118"><td class="ts-cell"><a class="ts" href="#L118" alt="Mon Feb 28 2022 19:46:34 GMT-0800 (Pacific Standard Time)">03:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell">oh... but you can turn off high resolution timer right?</td></tr>
  <tr class="msg" id="L119"><td class="ts-cell"><a class="ts" href="#L119" alt="Mon Feb 28 2022 19:46:39 GMT-0800 (Pacific Standard Time)">03:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">no</td></tr>
  <tr class="msg" id="L120"><td class="ts-cell"><a class="ts" href="#L120" alt="Mon Feb 28 2022 19:46:48 GMT-0800 (Pacific Standard Time)">03:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><a href="https://gruss.cc/files/fantastictimers.pdf">https://gruss.cc/files/fantastictimers.pdf</a></td></tr>
  <tr class="msg" id="L121"><td class="ts-cell"><a class="ts" href="#L121" alt="Mon Feb 28 2022 19:47:01 GMT-0800 (Pacific Standard Time)">03:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> if timing attacks are outside your thread model, though, what do you want that realms don't already give you?</blockquote></mx-reply><pre><code class="language-js">while (true);
</code></pre>
</td></tr>
  <tr class="msg" id="L122"><td class="ts-cell"><a class="ts" href="#L122" alt="Mon Feb 28 2022 19:47:15 GMT-0800 (Pacific Standard Time)">03:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">do it in a worker?</td></tr>
  <tr class="msg" id="L123"><td class="ts-cell"><a class="ts" href="#L123" alt="Mon Feb 28 2022 19:48:26 GMT-0800 (Pacific Standard Time)">03:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell">well maybe i dont need to worry about while true so much</td></tr>
  <tr class="msg" id="L124"><td class="ts-cell"><a class="ts" href="#L124" alt="Mon Feb 28 2022 19:52:22 GMT-0800 (Pacific Standard Time)">03:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@pokute:matrix.org">pokute</span>&gt;</div></td><td class="msg-cell">I would be really interested in any threading model that would allow something like <code>myThread.shareReference(globalThis);</code> that wouldn't completely break every JS coder's expectations.</td></tr>
  <tr class="msg" id="L125"><td class="ts-cell"><a class="ts" href="#L125" alt="Mon Feb 28 2022 19:55:15 GMT-0800 (Pacific Standard Time)">03:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">I don't think you can simultaneously have "shared memory" and "doesn't completely break every JS coder's expectations"</td></tr>
  <tr class="msg" id="L126"><td class="ts-cell"><a class="ts" href="#L126" alt="Mon Feb 28 2022 19:55:36 GMT-0800 (Pacific Standard Time)">03:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">at least not without adding in the whole of Rust's ownership model</td></tr>
  <tr class="msg" id="L127"><td class="ts-cell"><a class="ts" href="#L127" alt="Mon Feb 28 2022 19:55:42 GMT-0800 (Pacific Standard Time)">03:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">... which is going to break every JS coder's expectations anyway, for that matter</td></tr>
  <tr class="msg" id="L128"><td class="ts-cell"><a class="ts" href="#L128" alt="Mon Feb 28 2022 20:00:04 GMT-0800 (Pacific Standard Time)">04:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@pokute:matrix.org">pokute</span>&gt;</div></td><td class="msg-cell">I think "multi-threading" in JS is a bad term, since "threads" imply certain stuff like shared memory that is practically impossible with JS.</td></tr>
  <tr class="msg" id="L129"><td class="ts-cell"><a class="ts" href="#L129" alt="Mon Feb 28 2022 20:01:56 GMT-0800 (Pacific Standard Time)">04:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@pokute:matrix.org">pokute</span>&gt;</div></td><td class="msg-cell">threads are (I think) OS feature leveraging CPU capabilities that nothing of JS actually relies on. Workers could run on a separate process or even a remote server.</td></tr>
  <tr class="msg" id="L130"><td class="ts-cell"><a class="ts" href="#L130" alt="Mon Feb 28 2022 20:04:57 GMT-0800 (Pacific Standard Time)">04:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@sirisian:matrix.org">sirisian</span>&gt;</div></td><td class="msg-cell">Again shared memory already exists. SharedArrayBuffer has allowed this for a long time now.</td></tr>
  <tr class="msg" id="L131"><td class="ts-cell"><a class="ts" href="#L131" alt="Mon Feb 28 2022 20:06:04 GMT-0800 (Pacific Standard Time)">04:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@pokute:matrix.org">pokute</span>&gt;</div></td><td class="msg-cell">It's explicitly shared memory. That's very different from implicitly shared memory where all of a process' memory is shared between threads.</td></tr>
  <tr class="msg" id="L132"><td class="ts-cell"><a class="ts" href="#L132" alt="Mon Feb 28 2022 20:24:07 GMT-0800 (Pacific Standard Time)">04:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@pokute:matrix.org">pokute</span>&gt;</div></td><td class="msg-cell">@sirisian I was thinking about your initial question, about the async/await. Async/await is just a different way to write some function calls (callbacks). For it to use multiple threads, every function call would have to be possibly using threads. For most callbacks, they just only call other functions. The functions that actually do heavy computation is a vanishingly small percentage. Creating a new costly thread for each function call would immediately erode any performance benefit gained from parallelism.

This might be fixed by JS engines inspecting code and spinning only such heavy computation functions into separate threads if it recognizes it to be safe. But that completely up to engine whether to do it and isn't a language issue at all.</td></tr>
  <tr class="msg" id="L133"><td class="ts-cell"><a class="ts" href="#L133" alt="Mon Feb 28 2022 20:25:29 GMT-0800 (Pacific Standard Time)">04:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@sirisian:matrix.org">sirisian</span>&gt;</div></td><td class="msg-cell">The threading would be explicit when making a call.</td></tr>
  <tr class="msg" id="L134"><td class="ts-cell"><a class="ts" href="#L134" alt="Mon Feb 28 2022 20:25:30 GMT-0800 (Pacific Standard Time)">04:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@pokute:matrix.org">pokute</span>&gt;</div></td><td class="msg-cell">There's nothing that prevents existing engines to add a feature that they run heavy computation parallelly in separate threads if they can handle the possible side effects.</td></tr>
  <tr class="msg" id="L135"><td class="ts-cell"><a class="ts" href="#L135" alt="Mon Feb 28 2022 20:27:01 GMT-0800 (Pacific Standard Time)">04:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@pokute:matrix.org">pokute</span>&gt;</div></td><td class="msg-cell">So it would be a normal function that is called?</td></tr>
  <tr class="msg" id="L136"><td class="ts-cell"><a class="ts" href="#L136" alt="Mon Feb 28 2022 20:27:37 GMT-0800 (Pacific Standard Time)">04:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@sirisian:matrix.org">sirisian</span>&gt;</div></td><td class="msg-cell">yes</td></tr>
  <tr class="msg" id="L137"><td class="ts-cell"><a class="ts" href="#L137" alt="Mon Feb 28 2022 20:29:14 GMT-0800 (Pacific Standard Time)">04:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@pokute:matrix.org">pokute</span>&gt;</div></td><td class="msg-cell">A normal function has access to all globals and closures and is free to modify them as it sees fit. If it was run as a thread, this would mean implicit shared memory. How would other code that runs parallel to that be safe from variables changing their values suddenly?</td></tr>
  <tr class="msg" id="L138"><td class="ts-cell"><a class="ts" href="#L138" alt="Mon Feb 28 2022 20:29:57 GMT-0800 (Pacific Standard Time)">04:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@sirisian:matrix.org">sirisian</span>&gt;</div></td><td class="msg-cell">You could for example call multiple functions then await Promise.allSettled on them if you wanted to join back in an async task. I haven't thought about this hard at all, but like foo.callThread(..., args); which returns a promise. Ideally we'd have cancellable promises by then. &gt;_&gt;</td></tr>
  <tr class="msg" id="L139"><td class="ts-cell"><a class="ts" href="#L139" alt="Mon Feb 28 2022 20:30:47 GMT-0800 (Pacific Standard Time)">04:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@sirisian:matrix.org">sirisian</span>&gt;</div></td><td class="msg-cell">It wouldn't be safe at all. Using threads would have an assumed level of complexity just like using SharedArrayBuffer stuff.</td></tr>
  <tr class="msg" id="L140"><td class="ts-cell"><a class="ts" href="#L140" alt="Mon Feb 28 2022 20:32:18 GMT-0800 (Pacific Standard Time)">04:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@pokute:matrix.org">pokute</span>&gt;</div></td><td class="msg-cell">From what I've understood of SharedArrayBuffer is that it's always completely safe to use due to how extremely narrow and restricted it's features are. It's not even complex. It's cumbersome.</td></tr>
  <tr class="msg" id="L141"><td class="ts-cell"><a class="ts" href="#L141" alt="Mon Feb 28 2022 20:32:29 GMT-0800 (Pacific Standard Time)">04:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@sirisian:matrix.org">sirisian</span>&gt;</div></td><td class="msg-cell">I should mentioned it would be my hope that with this we'd all get concurrent data structures and standard library stuff in the far future. I noticed that state of JS mentioned some data structure stuff. Not sure the context of that. Concurrent queue at the least. heh.</td></tr>
  <tr class="msg" id="L142"><td class="ts-cell"><a class="ts" href="#L142" alt="Mon Feb 28 2022 20:35:18 GMT-0800 (Pacific Standard Time)">04:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@pokute:matrix.org">pokute</span>&gt;</div></td><td class="msg-cell">Also, people should take their promises more seriously. :-) Don't ask for promises that you can't receive later.</td></tr>
  <tr class="msg" id="L143"><td class="ts-cell"><a class="ts" href="#L143" alt="Mon Feb 28 2022 20:39:51 GMT-0800 (Pacific Standard Time)">04:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@pokute:matrix.org">pokute</span>&gt;</div></td><td class="msg-cell">Cancelable promises are a terrible term since it never reliably cancels any work a promise does. It only cancels the receiving of results. That's not what people expect.</td></tr>
  <tr class="msg" id="L144"><td class="ts-cell"><a class="ts" href="#L144" alt="Mon Feb 28 2022 20:41:12 GMT-0800 (Pacific Standard Time)">04:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@sirisian:matrix.org">sirisian</span>&gt;</div></td><td class="msg-cell">Good point.</td></tr>
  <tr class="msg" id="L145"><td class="ts-cell"><a class="ts" href="#L145" alt="Mon Feb 28 2022 20:49:37 GMT-0800 (Pacific Standard Time)">04:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@pokute:matrix.org">pokute</span>&gt;</div></td><td class="msg-cell">Which is why code should rather gracefully receive and discard out-of-order and obsolete data received from promises. Instead of canceling promises (which is quite simple to do), you could expect a version number from a REST call. You could add metadata to a REST call that you receive with the result in a way to see that the result is for the current context you're viewing. Etc...</td></tr>
  <tr class="msg" id="L146"><td class="ts-cell"><a class="ts" href="#L146" alt="Mon Feb 28 2022 20:50:18 GMT-0800 (Pacific Standard Time)">04:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@sirisian:matrix.org">sirisian</span>&gt;</div></td><td class="msg-cell">Kind of surprised there isn't a simple way to throw at the next await kind of language design that could be made for that. I have a few cancellable systems where there's stuff like await Promise.race([cancelPromise, workPromise]); multiple lines.</td></tr>
  <tr class="msg" id="L147"><td class="ts-cell"><a class="ts" href="#L147" alt="Mon Feb 28 2022 20:54:01 GMT-0800 (Pacific Standard Time)">04:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@pokute:matrix.org">pokute</span>&gt;</div></td><td class="msg-cell">You could do it with generators.</td></tr>
  <tr class="msg" id="L148"><td class="ts-cell"><a class="ts" href="#L148" alt="Mon Feb 28 2022 20:55:49 GMT-0800 (Pacific Standard Time)">04:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@pokute:matrix.org">pokute</span>&gt;</div></td><td class="msg-cell">But it's very cumbersome.</td></tr>
  <tr class="msg" id="L149"><td class="ts-cell"><a class="ts" href="#L149" alt="Mon Feb 28 2022 20:56:16 GMT-0800 (Pacific Standard Time)">04:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@sirisian:matrix.org">sirisian</span>&gt;</div></td><td class="msg-cell">Consume the generator unless the cancel flag is set kind of thing and in the worker just yield all the work?</td></tr>
  <tr class="msg" id="L150"><td class="ts-cell"><a class="ts" href="#L150" alt="Mon Feb 28 2022 20:57:02 GMT-0800 (Pacific Standard Time)">04:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@sirisian:matrix.org">sirisian</span>&gt;</div></td><td class="msg-cell">Not a bad idea. I could see that being kind of elegant in some of my code. I think it was written before async generators.</td></tr>
  <tr class="msg" id="L151"><td class="ts-cell"><a class="ts" href="#L151" alt="Mon Feb 28 2022 20:57:36 GMT-0800 (Pacific Standard Time)">04:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@pokute:matrix.org">pokute</span>&gt;</div></td><td class="msg-cell">Yeah. redux-saga is one pretty well known example of that.</td></tr>
  <tr class="msg" id="L152"><td class="ts-cell"><a class="ts" href="#L152" alt="Mon Feb 28 2022 21:00:49 GMT-0800 (Pacific Standard Time)">05:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@pokute:matrix.org">pokute</span>&gt;</div></td><td class="msg-cell">I really liked redux-saga at one point. I tried to use it in everything non-simple. Now I removed it from my own hobby project.</td></tr>
  <tr class="msg" id="L153"><td class="ts-cell"><a class="ts" href="#L153" alt="Mon Feb 28 2022 21:01:28 GMT-0800 (Pacific Standard Time)">05:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@pokute:matrix.org">pokute</span>&gt;</div></td><td class="msg-cell">Now I write mega-reducers. :-)</td></tr>
  <tr class="msg" id="L154"><td class="ts-cell"><a class="ts" href="#L154" alt="Mon Feb 28 2022 21:02:50 GMT-0800 (Pacific Standard Time)">05:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@pokute:matrix.org">pokute</span>&gt;</div></td><td class="msg-cell">Well, I'm in the process of removing most of the complex sagas.</td></tr>
  <tr class="msg" id="L155"><td class="ts-cell"><a class="ts" href="#L155" alt="Tue Mar 01 2022 09:27:42 GMT-0800 (Pacific Standard Time)">17:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@gibson042:matrix.org">Richard Gibson</span>&gt;</div></td><td class="msg-cell"><blockquote>
<p>Tracing through the full machinery would take me a while, but I can at least confirm that there should not be a difference between simple and non-simple arguments lists in this case, so V8 is definitely wrong <em>somewhere</em>, and it seems quite likely to be wrong in the cases where it differs from other implementations</p>
</blockquote>
<p>@bakkot it looks to me like <em>nobody</em> is following the spec here but V8 comes closest. Absent overlap between VarDeclaredNames and parameter names, FunctionDeclarationInstantiation steps 27 and 28 (the former when any parameter has an initializer, the latter otherwise) should both create a binding for each variable and initialize it to <code>undefined</code>‚Äîeven if that variable is named "arguments".</p>
</td></tr>
  <tr class="msg" id="L156"><td class="ts-cell"><a class="ts" href="#L156" alt="Tue Mar 01 2022 09:41:40 GMT-0800 (Pacific Standard Time)">17:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">that does not sound like a thing i want to implement</td></tr>

</tbody></table></div></div></div>
</body></html>