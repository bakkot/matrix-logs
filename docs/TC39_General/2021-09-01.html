<!DOCTYPE html><html><head>
  <title>TC39 General on 2021-09-01</title>
  <link rel="stylesheet" href="../style.css">
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">TC39 General<br>2021-09-01<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2021-08-31" class="nav-link"><span>prev</span></a>
<span style="float:right">next</span>
</div>
    
<div class="room-list-wrapper">Active:<br>
<ul class="room-list">
<li><a href="../TC39_Delegates/">TC39 Delegates</a></li>
<li><a href="../TC39_Editors/">TC39 Editors</a></li>
<li><a href="../TC39_General/" class="current-room">TC39 General</a></li>
<li><a href="../WHATWG/">WHATWG</a></li>
</ul>
</div>
<br>
<div class="room-list-wrapper">Historical:<br>
<ul class="room-list">
<li><a href="../irc-tc39/">#tc39</a></li>
<li><a href="../irc-tc39-delegates/">#tc39-delegates</a></li>
<li><a href="../irc-tc39-editor-group/">#tc39-editor-group</a></li>
<li><a href="../irc-whatwg/">#whatwg</a></li>
</ul>
</div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs"><div class="log">
<table><tbody id="log-tbody">
  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Wed Sep 01 2021 03:39:35 GMT-0700 (Pacific Daylight Time)">10:39</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</td><td class="msg-cell">Does anyone have any background on why <code>Math</code> got so many functions like <code>abs</code> that might have gotten put in <code>Number</code>? Having trouble finding in the meeting notes; I think this might predate them.</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Wed Sep 01 2021 04:33:15 GMT-0700 (Pacific Daylight Time)">11:33</a></td><td class="nick-cell">&lt;<span class="nick nick-13" title="@jmdyck:matrix.org">jmdyck</span>&gt;</td><td class="msg-cell">The Math object goes back to ES1</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Wed Sep 01 2021 05:16:57 GMT-0700 (Pacific Daylight Time)">12:16</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</td><td class="msg-cell"><mx-reply><blockquote> The Math object goes back to ES1</blockquote></mx-reply><p>Right, and as far as I can tell, post-ES1 mathematical functions were subsequently added to Math rather than Number simply to be consistent with that status quo. Is that correct?</p>
<p>For example, in the notes, I see some old talk of making clz32 an instance method on Number.prototype, and later it got switched to a “static” method, presumably to avoid boxing primitive numbers. But I can’t really find any explicit reasoning why Math was chosen as its home instead of Number.</p>
</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Wed Sep 01 2021 05:20:02 GMT-0700 (Pacific Daylight Time)">12:20</a></td><td class="nick-cell">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</td><td class="msg-cell">Looks like Number.{isInteger,isSafeInterger} and Math.{sign,trunc,log10,hypot} were added in ES6</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Wed Sep 01 2021 05:20:22 GMT-0700 (Pacific Daylight Time)">12:20</a></td><td class="nick-cell">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</td><td class="msg-cell">* Looks like Number.{isInteger,isSafeInteger} and Math.{sign,trunc,log10,hypot} were added in ES6</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Wed Sep 01 2021 05:21:07 GMT-0700 (Pacific Daylight Time)">12:21</a></td><td class="nick-cell">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</td><td class="msg-cell">Those homes seem logical, at least to me.</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Wed Sep 01 2021 05:54:11 GMT-0700 (Pacific Daylight Time)">12:54</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</td><td class="msg-cell"><mx-reply><blockquote> Those homes seem logical, at least to me.</blockquote></mx-reply><p>Yeah. An issue I’m going to raise during my BigInt Math presentation is that of <code>max</code> (and <code>min</code> and <code>hypot</code>). The issue is that if we simply extend <code>Math.max</code> to accept BigInts, then <code>Math.max(…arrOfBigInts)</code> would unexpectedly return <code>+Infinity</code> whenever <code>arrOfBigInts</code> happens to be empty—this would basically be an unexpected implicit type conversion from an array of BigInts to a Number value.</p>
<p>The choices I see are to either add a separate <code>Math.bigMax</code> function (and <code>bigMin</code> and <code>bigHypot</code>)…or add a <code>BigInt.max</code> method (in which case…why don’t we have <code>Number.max</code>—and then what about the other <code>Math</code> functions, do they get copied to <code>Number</code> and <code>BigInt</code> too?). So that’s why I’m wondering about the original “philosophy” behind <code>Number</code> versus <code>Math</code>.</p></td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Wed Sep 01 2021 05:55:10 GMT-0700 (Pacific Daylight Time)">12:55</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</td><td class="msg-cell">All the other <code>Math</code> methods can be extended for BigInts with no conversion problems. It’s just those three variadic functions…</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Wed Sep 01 2021 06:12:44 GMT-0700 (Pacific Daylight Time)">13:12</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</td><td class="msg-cell">* <mx-reply><blockquote> Those homes seem logical, at least to me.</blockquote></mx-reply><p>Yeah. An issue I’m going to raise during my BigInt Math presentation is that of <code>max</code> (and <code>min</code> and <code>hypot</code>). The issue is that if we simply extend <code>Math.max</code> to accept BigInts, then <code>Math.max(…arrOfBigInts)</code> would unexpectedly return <code>+Infinity</code> whenever <code>arrOfBigInts</code> happens to be empty—this would basically be an unexpected implicit type conversion from an array of BigInts to a Number value.</p>
<p>The choices I see are to either add a separate <code>Math.bigMax</code> function (and <code>bigMin</code> and <code>bigHypot</code>)…or add a <code>BigInt.max</code> method (in which case…why don’t we have <code>Number.max</code>—and then what about the other <code>Math</code> functions, do they get copied to <code>Number</code> and <code>BigInt</code> too?).</p></td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Wed Sep 01 2021 06:12:53 GMT-0700 (Pacific Daylight Time)">13:12</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</td><td class="msg-cell">* So that’s why I’m wondering about the original “philosophy” behind <code>Number</code> versus <code>Math</code>. All the other <code>Math</code> methods can be extended for BigInts with no conversion problems. It’s just those three variadic functions…</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Wed Sep 01 2021 06:14:42 GMT-0700 (Pacific Daylight Time)">13:14</a></td><td class="nick-cell">&lt;<span class="nick nick-13" title="@jmdyck:matrix.org">jmdyck</span>&gt;</td><td class="msg-cell">Note that max and min weren't variadic originally, so even if they'd anticipated other numeric types, there wouldn't have been that reason to put them in Number. </td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Wed Sep 01 2021 06:17:56 GMT-0700 (Pacific Daylight Time)">13:17</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</td><td class="msg-cell">Yeah—I suppose I’m wondering if anyone knows the reasoning behind the original decision to separate <code>Math</code> and <code>Number</code> functions in the first place. The original philosophy. Perhaps that would help inform this decision.</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Wed Sep 01 2021 06:18:32 GMT-0700 (Pacific Daylight Time)">13:18</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</td><td class="msg-cell">* Yeah—I suppose I’m wondering if anyone knows the reasoning behind the original decision to separate <code>Math</code> and <code>Number</code> functions in the first place. The original philosophy behind ES1 <code>Math.abs</code> rather than <code>Number.abs</code>. Perhaps that would help inform this decision.</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Wed Sep 01 2021 06:42:56 GMT-0700 (Pacific Daylight Time)">13:42</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</td><td class="msg-cell">Totally uninformed guess: Brendan was used to C's <code>#include &lt;math.h&gt;</code> as the way to get access to functions like max()/abs()/etc. So he carried that over to JS as using the Math namespace object to get access to functions like max()/abs()/etc.</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Wed Sep 01 2021 08:05:05 GMT-0700 (Pacific Daylight Time)">15:05</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@danielrosenwasser:matrix.org">danielrosenwasser</span>&gt;</td><td class="msg-cell"><mx-reply><blockquote> Totally uninformed guess: Brendan was used to C's <code>#include &lt;math.h&gt;</code> as the way to get access to functions like max()/abs()/etc. So he carried that over to JS as using the Math namespace object to get access to functions like max()/abs()/etc.</blockquote></mx-reply><p>alternative guess: it's on the Math class because they were trying to script java</p>
<p><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Math.html">https://docs.oracle.com/javase/8/docs/api/java/lang/Math.html</a></p>
</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Wed Sep 01 2021 08:06:36 GMT-0700 (Pacific Daylight Time)">15:06</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@danielrosenwasser:matrix.org">danielrosenwasser</span>&gt;</td><td class="msg-cell"><mx-reply><blockquote> <p>alternative guess: it's on the Math class because they were trying to script java</p>
<p><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Math.html">https://docs.oracle.com/javase/8/docs/api/java/lang/Math.html</a></p>
</blockquote></mx-reply><a href="https://twitter.com/BrendanEich/status/1263386663679438850">https://twitter.com/BrendanEich/status/1263386663679438850</a></td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Wed Sep 01 2021 08:13:01 GMT-0700 (Pacific Daylight Time)">15:13</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</td><td class="msg-cell">That makes more sense</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Wed Sep 01 2021 08:50:42 GMT-0700 (Pacific Daylight Time)">15:50</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</td><td class="msg-cell"><p><a href="https://twitter.com/benawad/status/1263183829235269634?s=20">https://twitter.com/benawad/status/1263183829235269634?s=20</a></p>
<p>I wonder if a precision argument for <code>Math.round</code> might be worth pursuing………</p>
</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Wed Sep 01 2021 08:50:46 GMT-0700 (Pacific Daylight Time)">15:50</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</td><td class="msg-cell"><mx-reply><blockquote> <a href="https://twitter.com/BrendanEich/status/1263386663679438850">https://twitter.com/BrendanEich/status/1263386663679438850</a></blockquote></mx-reply> * <blockquote>
</blockquote>
<p><a href="https://twitter.com/benawad/status/1263183829235269634?s=20">https://twitter.com/benawad/status/1263183829235269634?s=20</a></p>
<p>I wonder if pursuing a precision argument for <code>Math.round</code> might be worth pursuing………</p>
</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Wed Sep 01 2021 08:50:58 GMT-0700 (Pacific Daylight Time)">15:50</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">i like proto methods</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Wed Sep 01 2021 08:51:04 GMT-0700 (Pacific Daylight Time)">15:51</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</td><td class="msg-cell"> * <p><a href="https://twitter.com/benawad/status/1263183829235269634?s=20">https://twitter.com/benawad/status/1263183829235269634?s=20</a></p>
<p>I wonder if a precision argument for <code>Math.round</code> might be worth pursuing………</p>
</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Wed Sep 01 2021 08:51:39 GMT-0700 (Pacific Daylight Time)">15:51</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">they also make stuff like "empty arguments" not an issue anymore</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Wed Sep 01 2021 08:52:35 GMT-0700 (Pacific Daylight Time)">15:52</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">how does a proto method make sense for max?</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Wed Sep 01 2021 08:52:47 GMT-0700 (Pacific Daylight Time)">15:52</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell"><code>a.max(...others)</code></td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Wed Sep 01 2021 08:52:54 GMT-0700 (Pacific Daylight Time)">15:52</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">if others is empty you return a instead of Infinity</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Wed Sep 01 2021 08:52:54 GMT-0700 (Pacific Daylight Time)">15:52</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">... no</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Wed Sep 01 2021 08:53:09 GMT-0700 (Pacific Daylight Time)">15:53</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">?</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Wed Sep 01 2021 08:54:16 GMT-0700 (Pacific Daylight Time)">15:54</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">uhh I guess I will just say that I find that extremely aesthetically distasteful</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Wed Sep 01 2021 08:54:38 GMT-0700 (Pacific Daylight Time)">15:54</a></td><td class="nick-cell">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</td><td class="msg-cell">static methods are nice though</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Wed Sep 01 2021 08:54:46 GMT-0700 (Pacific Daylight Time)">15:54</a></td><td class="nick-cell">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</td><td class="msg-cell"><code>Number.max(...args)</code></td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Wed Sep 01 2021 08:54:50 GMT-0700 (Pacific Daylight Time)">15:54</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">static methods make you have to care about which item you're dealing with</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Wed Sep 01 2021 08:55:03 GMT-0700 (Pacific Daylight Time)">15:55</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell"> * static methods make you have to care about which type you're dealing with</td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Wed Sep 01 2021 08:55:07 GMT-0700 (Pacific Daylight Time)">15:55</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">like how we do Type(x)::foo in the spec</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Wed Sep 01 2021 08:55:40 GMT-0700 (Pacific Daylight Time)">15:55</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">i guess you could do <code>a.constructor.max(a, b)</code></td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Wed Sep 01 2021 08:56:04 GMT-0700 (Pacific Daylight Time)">15:56</a></td><td class="nick-cell">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</td><td class="msg-cell">oh right</td></tr>
  <tr class="msg" id="L35"><td class="ts-cell"><a class="ts" href="#L35" alt="Wed Sep 01 2021 08:56:24 GMT-0700 (Pacific Daylight Time)">15:56</a></td><td class="nick-cell">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</td><td class="msg-cell">but I do still like the idea of polymorphic functions that work on mixed lists</td></tr>
  <tr class="msg" id="L36"><td class="ts-cell"><a class="ts" href="#L36" alt="Wed Sep 01 2021 08:56:32 GMT-0700 (Pacific Daylight Time)">15:56</a></td><td class="nick-cell">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</td><td class="msg-cell">so namespaced makes sense for those</td></tr>
  <tr class="msg" id="L37"><td class="ts-cell"><a class="ts" href="#L37" alt="Wed Sep 01 2021 08:56:54 GMT-0700 (Pacific Daylight Time)">15:56</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">i mean they could still be polymorphic in cases where that makes sense</td></tr>
  <tr class="msg" id="L38"><td class="ts-cell"><a class="ts" href="#L38" alt="Wed Sep 01 2021 08:57:37 GMT-0700 (Pacific Daylight Time)">15:57</a></td><td class="nick-cell">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</td><td class="msg-cell">proto functions, sure, but for static methods it might not be great to make them polymorphic?</td></tr>
  <tr class="msg" id="L39"><td class="ts-cell"><a class="ts" href="#L39" alt="Wed Sep 01 2021 15:12:20 GMT-0700 (Pacific Daylight Time)">22:12</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">so class fields use define instead of set right</td></tr>
  <tr class="msg" id="L40"><td class="ts-cell"><a class="ts" href="#L40" alt="Wed Sep 01 2021 15:12:27 GMT-0700 (Pacific Daylight Time)">22:12</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">so there's no way for the superclass to see that happen</td></tr>
  <tr class="msg" id="L41"><td class="ts-cell"><a class="ts" href="#L41" alt="Wed Sep 01 2021 15:12:59 GMT-0700 (Pacific Daylight Time)">22:12</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">in general superclasses do not see things subclasses do, correct</td></tr>
  <tr class="msg" id="L42"><td class="ts-cell"><a class="ts" href="#L42" alt="Wed Sep 01 2021 15:13:05 GMT-0700 (Pacific Daylight Time)">22:13</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">same goes for methods defined by the subclass</td></tr>
  <tr class="msg" id="L43"><td class="ts-cell"><a class="ts" href="#L43" alt="Wed Sep 01 2021 15:13:12 GMT-0700 (Pacific Daylight Time)">22:13</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">there's a cool python library i want to mimic</td></tr>
  <tr class="msg" id="L44"><td class="ts-cell"><a class="ts" href="#L44" alt="Wed Sep 01 2021 15:13:15 GMT-0700 (Pacific Daylight Time)">22:13</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">where you can do like</td></tr>
  <tr class="msg" id="L45"><td class="ts-cell"><a class="ts" href="#L45" alt="Wed Sep 01 2021 15:13:33 GMT-0700 (Pacific Daylight Time)">22:13</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell"><pre><code class="language-py">class Foo(lib.Model):
  field = lib.Int()
  field = lib.String()
</code></pre>
</td></tr>
  <tr class="msg" id="L46"><td class="ts-cell"><a class="ts" href="#L46" alt="Wed Sep 01 2021 15:13:44 GMT-0700 (Pacific Daylight Time)">22:13</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">and that builds a validator on foo that you can use on incoming requests</td></tr>
  <tr class="msg" id="L47"><td class="ts-cell"><a class="ts" href="#L47" alt="Wed Sep 01 2021 15:13:52 GMT-0700 (Pacific Daylight Time)">22:13</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">and you can also add methods and stuff to the instance cuz its a normal class</td></tr>
  <tr class="msg" id="L48"><td class="ts-cell"><a class="ts" href="#L48" alt="Wed Sep 01 2021 15:14:09 GMT-0700 (Pacific Daylight Time)">22:14</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">but it requires the superclass knowing the fields to build the validator</td></tr>
  <tr class="msg" id="L49"><td class="ts-cell"><a class="ts" href="#L49" alt="Wed Sep 01 2021 15:14:26 GMT-0700 (Pacific Daylight Time)">22:14</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">i think in python that's done using metaclasses</td></tr>
  <tr class="msg" id="L50"><td class="ts-cell"><a class="ts" href="#L50" alt="Wed Sep 01 2021 15:14:57 GMT-0700 (Pacific Daylight Time)">22:14</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">that seems like a use case for decorators, at a glance</td></tr>
  <tr class="msg" id="L51"><td class="ts-cell"><a class="ts" href="#L51" alt="Wed Sep 01 2021 15:15:08 GMT-0700 (Pacific Daylight Time)">22:15</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">hmmm interesting</td></tr>
  <tr class="msg" id="L52"><td class="ts-cell"><a class="ts" href="#L52" alt="Wed Sep 01 2021 15:15:31 GMT-0700 (Pacific Daylight Time)">22:15</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">where would the data from the decorators be stored</td></tr>
  <tr class="msg" id="L53"><td class="ts-cell"><a class="ts" href="#L53" alt="Wed Sep 01 2021 15:17:11 GMT-0700 (Pacific Daylight Time)">22:17</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">wait, maybe I'm not understanding</td></tr>
  <tr class="msg" id="L54"><td class="ts-cell"><a class="ts" href="#L54" alt="Wed Sep 01 2021 15:17:18 GMT-0700 (Pacific Daylight Time)">22:17</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">how do you use <code>Foo</code> after setting it up like that?</td></tr>
  <tr class="msg" id="L55"><td class="ts-cell"><a class="ts" href="#L55" alt="Wed Sep 01 2021 15:17:22 GMT-0700 (Pacific Daylight Time)">22:17</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">or do you have a link to the library?</td></tr>
  <tr class="msg" id="L56"><td class="ts-cell"><a class="ts" href="#L56" alt="Wed Sep 01 2021 15:17:38 GMT-0700 (Pacific Daylight Time)">22:17</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">not a public library unfortunately</td></tr>
  <tr class="msg" id="L57"><td class="ts-cell"><a class="ts" href="#L57" alt="Wed Sep 01 2021 15:17:45 GMT-0700 (Pacific Daylight Time)">22:17</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">but you can do <code>Foo(some raw data)</code></td></tr>
  <tr class="msg" id="L58"><td class="ts-cell"><a class="ts" href="#L58" alt="Wed Sep 01 2021 15:18:09 GMT-0700 (Pacific Daylight Time)">22:18</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">and it will attempt to pull the fields from the raw data and either coerce them into something matching what you specified (Int/String/etc) or throw</td></tr>
  <tr class="msg" id="L59"><td class="ts-cell"><a class="ts" href="#L59" alt="Wed Sep 01 2021 15:18:41 GMT-0700 (Pacific Daylight Time)">22:18</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell"> * <pre><code class="language-py">class Foo(lib.Model):
  field1 = lib.Int()
  field2 = lib.String()
</code></pre>
</td></tr>
  <tr class="msg" id="L60"><td class="ts-cell"><a class="ts" href="#L60" alt="Wed Sep 01 2021 15:19:29 GMT-0700 (Pacific Daylight Time)">22:19</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">its nothing too magical, i'm just trying to imagine how i'd duplicate the sort of declarative schema info pattern in js</td></tr>
  <tr class="msg" id="L61"><td class="ts-cell"><a class="ts" href="#L61" alt="Wed Sep 01 2021 15:21:26 GMT-0700 (Pacific Daylight Time)">22:21</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">i guess there could be like <code>Foo._fields</code> that the decorators populate, and then lib.Model can check for <code>this._fields</code> when its being used?</td></tr>
  <tr class="msg" id="L62"><td class="ts-cell"><a class="ts" href="#L62" alt="Wed Sep 01 2021 15:21:39 GMT-0700 (Pacific Daylight Time)">22:21</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">or Symbol('lib.Fields') would be more proper i guess :P</td></tr>
  <tr class="msg" id="L63"><td class="ts-cell"><a class="ts" href="#L63" alt="Wed Sep 01 2021 15:22:36 GMT-0700 (Pacific Daylight Time)">22:22</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">the current decorator proposal has a concept of metadata, which I think is intended to be used for that sort of thing?</td></tr>
  <tr class="msg" id="L64"><td class="ts-cell"><a class="ts" href="#L64" alt="Wed Sep 01 2021 15:22:46 GMT-0700 (Pacific Daylight Time)">22:22</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">I haven't been following too closely though</td></tr>
  <tr class="msg" id="L65"><td class="ts-cell"><a class="ts" href="#L65" alt="Wed Sep 01 2021 15:25:01 GMT-0700 (Pacific Daylight Time)">22:25</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell"><p>I think the thing I'd actually do with a decorator would be more like</p>
<pre><code>@fields({ field1: lib.Int, field2: lib.String })
class Foo {
 ...
}
</code></pre>
<p>where <code>@fields</code> would replace the class with a subclass which called <code>super</code> and then validated and installed the fields named by the decorator</p>
</td></tr>
  <tr class="msg" id="L66"><td class="ts-cell"><a class="ts" href="#L66" alt="Wed Sep 01 2021 15:25:17 GMT-0700 (Pacific Daylight Time)">22:25</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">this seems like it could work <a href="https://gc.gy/e5d1ed0d-50fd-4394-8cfd-4f28fe049b5f.png">https://gc.gy/e5d1ed0d-50fd-4394-8cfd-4f28fe049b5f.png</a></td></tr>
  <tr class="msg" id="L67"><td class="ts-cell"><a class="ts" href="#L67" alt="Wed Sep 01 2021 15:25:25 GMT-0700 (Pacific Daylight Time)">22:25</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">you can probably do something closer to the Python version where the fields are inline, it's just not how I'd write it</td></tr>
  <tr class="msg" id="L68"><td class="ts-cell"><a class="ts" href="#L68" alt="Wed Sep 01 2021 15:26:12 GMT-0700 (Pacific Daylight Time)">22:26</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">yeah, the thing that annoys me about schema libraries in js i'm familiar with is that they're all out of line</td></tr>
  <tr class="msg" id="L69"><td class="ts-cell"><a class="ts" href="#L69" alt="Wed Sep 01 2021 15:48:10 GMT-0700 (Pacific Daylight Time)">22:48</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">this syntax is rough lol <a href="https://gc.gy/3ef68645-496c-41e2-b2db-15eac94f8244.png">https://gc.gy/3ef68645-496c-41e2-b2db-15eac94f8244.png</a></td></tr>
  <tr class="msg" id="L70"><td class="ts-cell"><a class="ts" href="#L70" alt="Wed Sep 01 2021 16:08:58 GMT-0700 (Pacific Daylight Time)">23:08</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">can a decorator remove a field</td></tr>
  <tr class="msg" id="L71"><td class="ts-cell"><a class="ts" href="#L71" alt="Wed Sep 01 2021 16:09:56 GMT-0700 (Pacific Daylight Time)">23:09</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">this define behavior is terrible we shouldn't have done it lol</td></tr>
  <tr class="msg" id="L72"><td class="ts-cell"><a class="ts" href="#L72" alt="Wed Sep 01 2021 16:15:24 GMT-0700 (Pacific Daylight Time)">23:15</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">having <code>[[Set]]</code> would not make this task any easier, because you can't have a setter for arbitrary properties</td></tr>
  <tr class="msg" id="L73"><td class="ts-cell"><a class="ts" href="#L73" alt="Wed Sep 01 2021 16:15:56 GMT-0700 (Pacific Daylight Time)">23:15</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">you have to use a proxy trap for that, and you can trap <code>[[DefineOwnProperty]]</code> just as readily as <code>[[Set]]</code> if you're using a proxy</td></tr>
  <tr class="msg" id="L74"><td class="ts-cell"><a class="ts" href="#L74" alt="Wed Sep 01 2021 16:16:45 GMT-0700 (Pacific Daylight Time)">23:16</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">anyway I don't think you can have a decorator which removes a field, no; in fact I think that was basically a design constraint for it to get through committee</td></tr>
  <tr class="msg" id="L75"><td class="ts-cell"><a class="ts" href="#L75" alt="Wed Sep 01 2021 16:18:08 GMT-0700 (Pacific Daylight Time)">23:18</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">that means the base constructor can't set the new field values after they're schema validated</td></tr>
  <tr class="msg" id="L76"><td class="ts-cell"><a class="ts" href="#L76" alt="Wed Sep 01 2021 16:18:18 GMT-0700 (Pacific Daylight Time)">23:18</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">cuz the define overwrites it</td></tr>
  <tr class="msg" id="L77"><td class="ts-cell"><a class="ts" href="#L77" alt="Wed Sep 01 2021 16:19:01 GMT-0700 (Pacific Daylight Time)">23:19</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">... right, base classes run before subclasses, that's how that works</td></tr>
  <tr class="msg" id="L78"><td class="ts-cell"><a class="ts" href="#L78" alt="Wed Sep 01 2021 16:19:10 GMT-0700 (Pacific Daylight Time)">23:19</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">[[Set]] would not help you there because the base class would not know about the fields</td></tr>
  <tr class="msg" id="L79"><td class="ts-cell"><a class="ts" href="#L79" alt="Wed Sep 01 2021 16:19:53 GMT-0700 (Pacific Daylight Time)">23:19</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">well my train of thinking was, using [[set]] would make it reasonable to not perform any operation for <code>x;</code> instead of doing <code>this.x = undefined;</code></td></tr>
  <tr class="msg" id="L80"><td class="ts-cell"><a class="ts" href="#L80" alt="Wed Sep 01 2021 16:20:04 GMT-0700 (Pacific Daylight Time)">23:20</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">but it doesn't matter much now</td></tr>
  <tr class="msg" id="L81"><td class="ts-cell"><a class="ts" href="#L81" alt="Wed Sep 01 2021 16:21:06 GMT-0700 (Pacific Daylight Time)">23:21</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">also I think this works: <a href="https://gist.github.com/bakkot/71bb439da868db191467762a82e85e61">https://gist.github.com/bakkot/71bb439da868db191467762a82e85e61</a></td></tr>
  <tr class="msg" id="L82"><td class="ts-cell"><a class="ts" href="#L82" alt="Wed Sep 01 2021 16:22:12 GMT-0700 (Pacific Daylight Time)">23:22</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">ah interesting</td></tr>
  <tr class="msg" id="L83"><td class="ts-cell"><a class="ts" href="#L83" alt="Wed Sep 01 2021 16:22:16 GMT-0700 (Pacific Daylight Time)">23:22</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">not sure if it's what you were looking for though</td></tr>
  <tr class="msg" id="L84"><td class="ts-cell"><a class="ts" href="#L84" alt="Wed Sep 01 2021 16:22:31 GMT-0700 (Pacific Daylight Time)">23:22</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">the extra constructor certainly gets around this</td></tr>
  <tr class="msg" id="L85"><td class="ts-cell"><a class="ts" href="#L85" alt="Wed Sep 01 2021 16:22:36 GMT-0700 (Pacific Daylight Time)">23:22</a></td><td class="nick-cell">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</td><td class="msg-cell">thanks for the idea</td></tr>
</tbody></table>
</div></div></div>
</body></html>