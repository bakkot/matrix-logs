2021-10-01
[17:00:01.0754] <bakkot>
we're moving progressively further in that direction with our internal tooling and it's been basically fine

[17:00:34.0404] <bakkot>
you need to do some basic conservative type analysis but at least in the code I've been working with that type analysis is feasible

[17:01:30.0942] <Justin Ridgewell>
I absolutely don’t agree. Even with a full type system, the difficulty of banning `Nodelist.p.forEach` had lead to bugs for us.

[17:02:05.0437] <Justin Ridgewell>
As soon as you cast to avoid a typecheck, we get ambiguities that let it slip back in

[17:02:46.0763] <Justin Ridgewell>
Even with a type system and full typing, it’s a difficult problem

[17:03:34.0053] <Justin Ridgewell>
Requiring us to rewrite tooling infra on top of another’s type system seems bad.

[17:04:26.0200] <Justin Ridgewell>
Devirtualized methods are simple, tiny, fast, and extremely easy to tree shake statically

[17:43:38.0070] <Justin Ridgewell>
 * Requiring us to rewrite tooling infra on top of another’s type system (even if it's as beloved as TS) seems bad.

[17:43:57.0702] <Justin Ridgewell>
 * Devirtualized methods are simple, fast, and extremely easy to tree shake statically

[18:09:11.0337] <shu>
rkirsling: actually pun was not intended!

[18:26:35.0026] <pokute>
Concerning proposed Partial Function Application, should partially applying `import()`work?

[21:42:06.0211] <TabAtkins>
The import() function is just an ordinary function, yeah? Nothing special syntactically?

[21:42:18.0554] <TabAtkins>
Assuming that's true, then yeah

[21:56:11.0629] <bakkot>
no, it is a special syntactic form, not a function

[21:56:29.0805] <bakkot>
(it has to be, since it's module-relative - it's not something you could coherently pass around)

[00:12:20.0999] <Ashley Claymore>
jschoi: maybe the readme could say how it differs from the `::` bind proposal? Unless maybe it is already obvious and I am just being slow

[00:17:16.0743] <Ashley Claymore>
 * jschoi: maybe the readme could say how it differs from the `::` bind proposal? Unless maybe it is already obvious and I am just being slow. Or is it just that there is nothing stopping there being similar proposals, lead by different groups of people? Healthy competition type of thing?

[04:24:46.0158] <jschoi>
> <@aclaymore:matrix.org> jschoi: maybe the readme could say how it differs from the `::` bind proposal? Unless maybe it is already obvious and I am just being slow. Or is it just that there is nothing stopping there being similar proposals, lead by different groups of people? Healthy competition type of thing?

Yeah, good idea. The new proposal is pretty much the same as the old bind proposal except it has no unary form. Michael has recommended to open a new repository because of the baggage with the old proposal in https://github.com/tc39/proposal-bind-operator/issues/56#issuecomment-698444297.

There’s also a Gist comparing the new proposal with the Stage-1 Extensions proposal, but it focuses on security rather than “call/bind are common”, so it’s out of date. I plan to edit it and add it to the repository later. https://gist.github.com/js-choi/eca7c67f88a2e82c3353fb11e8da46f7

[05:52:34.0745] <Ashley Claymore>
thanks for that info jschoi !


2021-10-02

2021-10-04
[08:43:20.0818] <pokute>
I made a [TypeScript PR](https://github.com/microsoft/TypeScript/pull/37973) for the new Syntatic Marker variant of Partial Application proposal. There's a [Playground link](https://www.staging-typescript.org/play?ts=4.5.0-pr-37973-15#code/PTAEAUBsEME8HMBOB7ArgOwCagGbMRNIgC4CW0koAggA42SkDG0Zy6oAFscTQM4BcIeKWIdUAIwB0jZAFtgxRgGYAnMBooayXhQC0NImT3Q6DZq3QAoEKAAqsGgFMAyo0SkaxCACV+nbnyCwMKiEtJywLJMKLzIOMTA9k6u7p7qqJCQwEoA7Co5StZgzqh0+MS8oOLIorgAFAD8ADSgAIwAlKDQWLgAfo0tHaC6eIiyvJJF1KRR6PCgxMigvADuIowcpHMLS1w8AkIiYlIy8oqq6praegYk5JC6JvRMLKRswKS8vKiOvMAALAAOYYANyI5HQXjioA0yC0OkosTYkxsAFloFtQFEvlt5lotl5GKhEIhHJDILBQJ8YYZ7hSuqZYLjQJJWcNSbwvLdoLJHMRHIhJpYZOhOcsAI6oIiOUAAXlA6NEki0K36zVAACZ2gBuSzCtixSCOSSQZDwOq8SXSur-do6yxAA) for it too! Test it out!

[08:44:20.0190] <Jack Works>
Partial application on generics? 

[08:44:32.0687] <Jack Works>
Oh on values Cool

[08:45:20.0127] <pokute>
 * I made a [TypeScript PR](https://github.com/microsoft/TypeScript/pull/37973) for the new [Syntatic Marker variant of Partial Application proposal](https://github.com/tc39/proposal-partial-application/issues/48). There's a [Playground link](https://www.staging-typescript.org/play?ts=4.5.0-pr-37973-15#code/PTAEAUBsEME8HMBOB7ArgOwCagGbMRNIgC4CW0koAggA42SkDG0Zy6oAFscTQM4BcIeKWIdUAIwB0jZAFtgxRgGYAnMBooayXhQC0NImT3Q6DZq3QAoEKAAqsGgFMAyo0SkaxCACV+nbnyCwMKiEtJywLJMKLzIOMTA9k6u7p7qqJCQwEoA7Co5StZgzqh0+MS8oOLIorgAFAD8ADSgAIwAlKDQWLgAfo0tHaC6eIiyvJJF1KRR6PCgxMigvADuIowcpHMLS1w8AkIiYlIy8oqq6praegYk5JC6JvRMLKRswKS8vKiOvMAALAAOYYANyI5HQXjioA0yC0OkosTYkxsAFloFtQFEvlt5lotl5GKhEIhHJDILBQJ8YYZ7hSuqZYLjQJJWcNSbwvLdoLJHMRHIhJpYZOhOcsAI6oIiOUAAXlA6NEki0K36zVAACZ2gBuSzCtixSCOSSQZDwOq8SXSur-do6yxAA) for it too! Test it out!


2021-10-05
[16:19:57.0294] <jschoi>
If we were to guess which standard functions do developers most commonly use explicitly, among all JavaScript code, then what would those functions be? `console.log`? `Array.prototype.push`? `Function.prototype.call`? `Array.from`?

[16:20:30.0075] <pokute>
`Array.map`

[16:20:47.0892] <pokute>
 * Array.map

[16:20:55.0784] <pokute>
 * `Array.map`

[16:22:13.0828] <jschoi>
Indeed, when I count occurrences in Gzemnid’s dataset of top-1000 downloaded NPM packages in 2019-09, then I get the following results:

```bash
> ls
search.topcode.sh
slim.topcode.1000.txt.lz4
> ./search.topcode.sh '\b.map\b' | awk 'END { print NR }'
1016503
> ./search.topcode.sh '\.call\b' | awk 'END { print NR }'
500084
> ./search.topcode.sh '\bconsole.log\b' | awk 'END { print NR }'
271915
> ./search.topcode.sh '\.apply\b' | awk 'END { print NR }'
225315
> ./search.topcode.sh '\.bind\b' | awk 'END { print NR }'
170248
> ./search.topcode.sh '\.set\b' | awk 'END { print NR }'
168872
> ./search.topcode.sh '\.push\b' | awk 'END { print NR }'
70116
```


[16:24:22.0849] <jschoi>
Obviously though these are only rough surrogates for the actual total JavaScript codebase of humankind.

[16:24:31.0844] <jschoi>
 * Obviously though these are only rough surrogates for the actual total JavaScript codebase of humankind.

[16:25:00.0302] <pokute>
I don't trust minimized/transpiled code as much tho. It's no exactly what people write.

[16:26:33.0410] <jschoi>
As far as I can tell, Gzemnid tries to exclude minified code (https://github.com/nodejs/Gzemnid/blob/main/README.md#deception), although it has lots of other limitations…

[16:27:06.0717] <jschoi>
I don’t think the “slim” in the filename means minified. I think it means LZ4 compressed.

[16:27:27.0317] <jschoi>
There’s `slim.code.coffee.txt.lz4` and `slim.code.ts.txt.lz4` too.

[16:27:38.0731] <jschoi>
 * I don’t think the “slim” in the filename means minified. It means LZ4 compressed.

[16:28:05.0457] <jschoi>
 * I don’t think the “slim” in the filename means minified. I think means LZ4 compressed.

[16:28:08.0638] <jschoi>
 * I don’t think the “slim” in the filename means minified. I think it means LZ4 compressed.


2021-10-06
[17:24:54.0948] <TabAtkins>
I highly, highly doubt `.call` is actually used that much in real code. It might be counting library code a bunch?

[17:25:38.0740] <jschoi>
> <@tabatkins:matrix.org> I highly, highly doubt `.call` is actually used that much in real code. It might be counting library code a bunch?

I actually checked the first thousand lines of its output and they all generally seem legitimate to me. 

[17:25:48.0641] <jschoi>
I can dump them in a Gist.

[17:26:39.0453] <jschoi>
Mostly stuff like `_super.call(this, destination)` or `tryCatch(onCancelCallback).call(this._boundValue())`.

[17:27:08.0466] <jschoi>
Oh, you’re asking if it’s double-counting dependencies.

[17:27:48.0504] <jschoi>
I don’t…think it should…

[17:28:32.0281] <jschoi>
I’ll check with `uniq`.

[17:40:14.0322] <jschoi>
Sorting the output then running `uniq -d` doesn’t return any duplicate lines. It doesn’t seem to be double-counting dependencies. 
At most, a library might manually include the code of another library in its own source code, but that problem is probably pretty small. And it applies to all the other functions’ counts, too.

[17:53:53.0630] <jschoi>
…I’d upload the sorted dump, but I just realized not everyone might want to download a 75.9-MB file, and I don’t know how Matrix’s file sharing works, haha.

[17:59:49.0663] <jschoi>
(Fun fact: The most-downloaded NPM library that uses `.call`, as of 2019-09, was debug, and it uses `.call` twice: in `createDebug.formatArgs.call(self, args)` and in `match = formatter.call(self, val);`.)

[18:00:42.0866] <jschoi>
(Next up is kind-of, which uses `.call` once, followed by readable-stream…which uses `.call` nineteen times.)

[18:12:58.0457] <jschoi>
 * (Next up is kind-of, which uses `.call` once, followed by readable-stream…which uses `.call` nineteen times. And lodash uses `.call` 127 times.)

[21:32:19.0342] <devsnek>
jschoi: https://sourcegraph.com/search?q=context:global+.call%28+lang:javascript&patternType=literal

[22:21:32.0617] <annevk>
Is there a place to follow what is outstanding on https://datatracker.ietf.org/doc/html/draft-ietf-dispatch-javascript-mjs? There was a GitHub repo at some point...

[23:27:58.0522] <annevk>
/me finds https://github.com/linuxwolf/bmeck-ids

