<!DOCTYPE html><html><head>
  <title>TC39 General on 2021-06-08</title>
  <link rel="stylesheet" href="../style.css">
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">TC39 General<br>2021-06-08<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2021-06-07" class="nav-link"><span>prev</span></a>
<span style="float:right">next</span>
</div>
    
<ul class="room-list">
<li><a href="../TC39_Delegates/">TC39 Delegates</a></li>
<li><a href="../TC39_Editors/">TC39 Editors</a></li>
<li><a href="../TC39_General/" class="current-room">TC39 General</a></li>
<li><a href="../WHATWG/">WHATWG</a></li>
</ul>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs"><div class="log">
<table><tbody id="log-tbody">
  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Mon Jun 07 2021 21:28:33 GMT-0700 (Pacific Daylight Time)">04:28</a></td><td class="nick-cell">&lt;<span class="nick nick-13" title="@jmdyck:matrix.org">jmdyck</span>&gt;</td><td class="msg-cell"><span class="nick-2">bakkot</span>: (re tail calls) you said "instead move control back to the most recent <code>Let result be OrdinaryCallEvaluateBody(...)</code> step". I assume you mean the most recent "pending" OrdinaryCallEvaluateBody step. But I don't think that would work, because the first thing after that call is "Remove calleeContext from the execution context stack", which you don't want to do, because PrepareForTailCall already removed that context from the stack.</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Mon Jun 07 2021 21:29:17 GMT-0700 (Pacific Daylight Time)">04:29</a></td><td class="nick-cell">&lt;<span class="nick nick-13" title="@jmdyck:matrix.org">jmdyck</span>&gt;</td><td class="msg-cell"> * <span class="nick-2">bakkot</span>: (re tail calls) you said "instead move control back to the most recent <code>Let result be OrdinaryCallEvaluateBody(...)</code> step". I assume you mean the most recent "pending" OrdinaryCallEvaluateBody step. But I don't think that would work, because the first thing after that step is "Remove calleeContext from the execution context stack", which you don't want to do, because PrepareForTailCall already removed that context from the stack.</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Mon Jun 07 2021 21:39:14 GMT-0700 (Pacific Daylight Time)">04:39</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell"><span class="nick-13">jmdyck</span>: ah, yes, good point. I'm not sure exactly where it's mean to return to, then</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Mon Jun 07 2021 21:39:29 GMT-0700 (Pacific Daylight Time)">04:39</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">possibly something like "return to that step, but don't do the following one because calleeContext has already been removed"?</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Mon Jun 07 2021 21:41:03 GMT-0700 (Pacific Daylight Time)">04:41</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">in the case that the tailcall occurs in function being invoked via <code>[[Call]]</code> you could return from that <code>[[Call]]</code>, but that doesn't work if the tailcall occurs while doing <code>[[Construct]]</code></td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Mon Jun 07 2021 21:42:27 GMT-0700 (Pacific Daylight Time)">04:42</a></td><td class="nick-cell">&lt;<span class="nick nick-13" title="@jmdyck:matrix.org">jmdyck</span>&gt;</td><td class="msg-cell">My current guess is that, if fn A calls fn B in tail position, then <code>Call(B)</code> returns to where <code>Call(A)</code> would have returned to: step 7 in EvaluateCall, but it's an outer execution of EvaluateCall.</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Mon Jun 07 2021 21:44:37 GMT-0700 (Pacific Daylight Time)">04:44</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">That works if you're just doing calls, but doesn't work if fn A was invoked with <code>Construct(A)</code> rather than <code>Call(A)</code></td></tr>
</tbody></table>
</div></div></div>
</body></html>