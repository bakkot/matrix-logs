<!DOCTYPE html><html><head>
  <title>TC39 General on 2022-11-10</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "TC39 General";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">TC39 General<br>2022-11-10<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2022-11-08" class="nav-link"><span>prev</span></a>
<span style="float:right">next</span>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search TC39 General">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Thu Nov 10 2022 03:56:24 GMT-0800 (Pacific Standard Time)">11:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jessidhia:matrix.org">Jessidhia</span>&gt;</div></td><td class="msg-cell"><p>Is there a good reason as to why <a href="https://tc39.es/ecma402/#sec-defaultlocale">https://tc39.es/ecma402/#sec-defaultlocale</a> ignores the document language?</p>
<p>Like, I know the spec language is intentionally underspecified here, but is there a reason to prefer the chrome's language instead of the document's language? From what I can gather this would just result in out-of-place formatting if <code>Intl</code> formatting is used in documents where a <code>document.documentElement.lang</code> is specified and doesn't match the chrome's settings.</p>
</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Thu Nov 10 2022 03:57:26 GMT-0800 (Pacific Standard Time)">11:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jessidhia:matrix.org">Jessidhia</span>&gt;</div></td><td class="msg-cell">on Firefox it ignores the document language <em>even if</em> it's present in <code>navigator.languages</code>; only the primary <code>navigator.language</code> is ever used</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Thu Nov 10 2022 04:00:53 GMT-0800 (Pacific Standard Time)">12:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jessidhia:matrix.org">Jessidhia</span>&gt;</div></td><td class="msg-cell">this is kind of a blocker on me using <code>Intl.DateTimeFormat</code> without very careful wrapping ðŸ˜…</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Thu Nov 10 2022 04:03:43 GMT-0800 (Pacific Standard Time)">12:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jessidhia:matrix.org">Jessidhia</span>&gt;</div></td><td class="msg-cell">(on the other hand this gets into trouble with SSR because there's no document language during SSR so I guess my problem formulation is incomplete)</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Thu Nov 10 2022 04:34:37 GMT-0800 (Pacific Standard Time)">12:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell">"host environment's current locale" seems kinda bogus</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Thu Nov 10 2022 04:36:28 GMT-0800 (Pacific Standard Time)">12:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell">Well, I guess it's good enough, but I haven't seen a PR for HTML that maps "current locale" to <code>navigator.language</code>'s underlying primitive.</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Thu Nov 10 2022 04:38:55 GMT-0800 (Pacific Standard Time)">12:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell">(Using the language of a document wouldn't work in quite a few environments, e.g., all workers, worklets. And it's not necessarily declared on the root element all of the time either, although it kinda ought to be. So if you want to write portable code you probably want that to be a separate input from the end user locale.)</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Thu Nov 10 2022 04:41:38 GMT-0800 (Pacific Standard Time)">12:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</div></td><td class="msg-cell"><span class="nick-2">Jessidhia</span>: did you come across this by any chance? <a href="https://github.com/WICG/proposals/issues/78">https://github.com/WICG/proposals/issues/78</a></td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Thu Nov 10 2022 04:41:59 GMT-0800 (Pacific Standard Time)">12:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</div></td><td class="msg-cell">basically "fetch the user's preferred locale" is a known problem in Intl</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Thu Nov 10 2022 04:43:42 GMT-0800 (Pacific Standard Time)">12:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jessidhia:matrix.org">Jessidhia</span>&gt;</div></td><td class="msg-cell">I had come across <a href="https://github.com/tc39/ecma402/issues/38">https://github.com/tc39/ecma402/issues/38</a> which I guess is similar enough to WICG#78</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Thu Nov 10 2022 04:43:54 GMT-0800 (Pacific Standard Time)">12:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</div></td><td class="msg-cell">it's a complicated problem to solve while protecting the users' privacy but we're working on it</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Thu Nov 10 2022 04:44:16 GMT-0800 (Pacific Standard Time)">12:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I had come across <a href="https://github.com/tc39/ecma402/issues/38">https://github.com/tc39/ecma402/issues/38</a> which I guess is similar enough to WICG#78</blockquote></mx-reply>yes, basically this entire label: <a href="https://github.com/tc39/ecma402/labels/User%20Preferences">https://github.com/tc39/ecma402/labels/User%20Preferences</a></td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Thu Nov 10 2022 04:44:50 GMT-0800 (Pacific Standard Time)">12:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</div></td><td class="msg-cell">it was an impetus for us to start looking into the problem, but the solution requires a non-trivial amount of API design and privacy auditing.</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Thu Nov 10 2022 04:45:04 GMT-0800 (Pacific Standard Time)">12:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jessidhia:matrix.org">Jessidhia</span>&gt;</div></td><td class="msg-cell">but it's not quite what I was looking for; more of a way to include the application's preferences (say, user accessing page with document language set to Japanese while using an English language browser, which is my case as a developer of a Japanese web app ðŸ˜…)</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Thu Nov 10 2022 04:46:04 GMT-0800 (Pacific Standard Time)">12:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</div></td><td class="msg-cell">ah, essentially the other way around, I guess?</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Thu Nov 10 2022 04:46:28 GMT-0800 (Pacific Standard Time)">12:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</div></td><td class="msg-cell"><em>enforcing</em> a locale instead of inferring the user's preference, I mean</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Thu Nov 10 2022 04:48:55 GMT-0800 (Pacific Standard Time)">12:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jessidhia:matrix.org">Jessidhia</span>&gt;</div></td><td class="msg-cell">yes, due to the document language; in my example the default result would produce a result with <code>/</code> separators instead of <code>YYYYå¹´MMæœˆDDæ—¥</code>, which would look out of place in a japanese language phrase (user preference for the website being <code>lang="ja"</code>)</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Thu Nov 10 2022 04:50:09 GMT-0800 (Pacific Standard Time)">12:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jessidhia:matrix.org">Jessidhia</span>&gt;</div></td><td class="msg-cell"><code>luxon</code> somewhat has a facility for this (<code>Settings.defaultLocale</code>) but it doesn't handle dynamic updates well</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Thu Nov 10 2022 04:50:28 GMT-0800 (Pacific Standard Time)">12:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</div></td><td class="msg-cell">why can't you just call all the formatters with <code>"ja-JP"</code>?</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Thu Nov 10 2022 04:50:40 GMT-0800 (Pacific Standard Time)">12:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</div></td><td class="msg-cell">by hardcoding the locale argument</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Thu Nov 10 2022 04:52:25 GMT-0800 (Pacific Standard Time)">12:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jessidhia:matrix.org">Jessidhia</span>&gt;</div></td><td class="msg-cell">the locale is actually user preference (out of 4 supported languages) but yes, I can supply a locale (or <code>document.documentElement.lang</code> on the browser side) -- the problem then becomes coworkers using Japanese browsers accidentally getting "correct" output while omitting the argument if they don't test changing the language</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Thu Nov 10 2022 04:56:28 GMT-0800 (Pacific Standard Time)">12:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</div></td><td class="msg-cell">I see</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Thu Nov 10 2022 04:56:43 GMT-0800 (Pacific Standard Time)">12:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</div></td><td class="msg-cell">well, this seems to be more of a host problem than a language problem ðŸ˜…</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Thu Nov 10 2022 04:56:58 GMT-0800 (Pacific Standard Time)">12:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</div></td><td class="msg-cell">all ways to override would be host-defined behavior I'm afraid</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Thu Nov 10 2022 04:58:22 GMT-0800 (Pacific Standard Time)">12:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jessidhia:matrix.org">Jessidhia</span>&gt;</div></td><td class="msg-cell">prioritizing document language would be sufficient for this use case</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Thu Nov 10 2022 04:58:57 GMT-0800 (Pacific Standard Time)">12:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jessidhia:matrix.org">Jessidhia</span>&gt;</div></td><td class="msg-cell">the complication is on hosts without a document (like node), that would necessitate a host-defined override</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Thu Nov 10 2022 04:59:24 GMT-0800 (Pacific Standard Time)">12:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</div></td><td class="msg-cell">yes, but <code>DefaultLocale</code> is completely host-defined too (<a href="https://tc39.es/ecma402/#sec-defaultlocale">https://tc39.es/ecma402/#sec-defaultlocale</a>)</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Thu Nov 10 2022 04:59:44 GMT-0800 (Pacific Standard Time)">12:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</div></td><td class="msg-cell">oh wait, we've looped around to the start</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Thu Nov 10 2022 05:00:04 GMT-0800 (Pacific Standard Time)">13:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</div></td><td class="msg-cell">but yes, essentially hosts can choose to do whatever they prefer as long as the result is a valid locale</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Thu Nov 10 2022 05:40:25 GMT-0800 (Pacific Standard Time)">13:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell"><span class="nick-3">ryzokuken</span>: why is there no HTML PR for this feature?</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Thu Nov 10 2022 05:55:15 GMT-0800 (Pacific Standard Time)">13:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">annevk</span>: it's still under active development. We're only just starting to narrow down the final semantics after consultation with different browser privacy teams.</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Thu Nov 10 2022 05:55:27 GMT-0800 (Pacific Standard Time)">13:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</div></td><td class="msg-cell">but yes, hopefully a PR should be out soon.</td></tr>

</tbody></table></div></div></div>
</body></html>