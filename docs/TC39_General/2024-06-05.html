<!DOCTYPE html><html><head>
  <title>TC39 General on 2024-06-05</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "TC39 General";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">TC39 General<br>2024-06-05<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2024-06-01" class="nav-link"><span>prev</span></a>
<a href="2024-06-06" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search TC39 General">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Wed Jun 05 2024 15:55:17 GMT-0700 (Pacific Daylight Time)">22:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@whosy:matrix.org">whosy</span>&gt;</div></td><td class="msg-cell">I wonder if there's any want for a <code>Promise.sleep( duration )</code>. I find myself writing one-liners for this in many a project.<br>e.g.<br><code>const sleep = durationMs =&gt; new Promise( resolve =&gt; setTimeout( resolve, durationMs ) );</code></td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Wed Jun 05 2024 15:58:52 GMT-0700 (Pacific Daylight Time)">22:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@jasnell:matrix.org">James M Snell</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I wonder if there's any want for a <code>Promise.sleep( duration )</code>. I find myself writing one-liners for this in many a project.<br>e.g.<br><code>const sleep = durationMs =&gt; new Promise( resolve =&gt; setTimeout( resolve, durationMs ) );</code></blockquote></mx-reply>There are already solutions for this. scheduler.wait is mostly this. Node.js has timers/promises, etc. Given that timers tend to be implementation specific, it's likely best left as a web platform API</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Wed Jun 05 2024 16:02:47 GMT-0700 (Pacific Daylight Time)">23:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@whosy:matrix.org">whosy</span>&gt;</div></td><td class="msg-cell"><p>Might I ask what <code>schedular.wait</code> is?</p>
<p>And I really did mean as a simple shorthand for wrapping whatever native implementation of setTimeout is in a promise.</p>
<p>Though I guess that does leave a big question mark about what value is returned (if any). I am very green when it comes to actual implementations and the specification side of the language, by the way.</p>
</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Wed Jun 05 2024 16:04:55 GMT-0700 (Pacific Daylight Time)">23:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@jasnell:matrix.org">James M Snell</span>&gt;</div></td><td class="msg-cell"><code>scheduler.wait(...)</code> is defined <a href="https://github.com/WICG/scheduling-apis">https://github.com/WICG/scheduling-apis</a> ... there's more to it but it essentially allows you to do <code>await scheduler.wait(duration)</code></td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Wed Jun 05 2024 16:07:38 GMT-0700 (Pacific Daylight Time)">23:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@whosy:matrix.org">whosy</span>&gt;</div></td><td class="msg-cell">Ah, I see. I couldn't find any reference to this when I tried a quick search for npm/JavaScript or the proposals listings.

It's an interesting read, and would definitely encompass this use-case.</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Wed Jun 05 2024 16:09:04 GMT-0700 (Pacific Daylight Time)">23:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@softwarechris:matrix.org">Chris de Almeida</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I wonder if there's any want for a <code>Promise.sleep( duration )</code>. I find myself writing one-liners for this in many a project.<br>e.g.<br><code>const sleep = durationMs =&gt; new Promise( resolve =&gt; setTimeout( resolve, durationMs ) );</code></blockquote></mx-reply><code>setTimeout</code> is not part of JS</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Wed Jun 05 2024 16:12:06 GMT-0700 (Pacific Daylight Time)">23:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@softwarechris:matrix.org">Chris de Almeida</span>&gt;</div></td><td class="msg-cell">the longer answer is that in order to get some flavor of <code>sleep()</code>, you would have to add various other things in the language first in order to support it</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Wed Jun 05 2024 16:12:32 GMT-0700 (Pacific Daylight Time)">23:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@whosy:matrix.org">whosy</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <code>setTimeout</code> is not part of JS</blockquote></mx-reply><p>Yes..that's something I only considered and realised after thinking about the differing return types across implementations. As I said in the thread now, I am very much not clued in on the language spec. I've mostly just used the language without considering its development until very recently.</p>
<p>But the lack of a spec-defined timing mechanism, I'm guessing is why the aforementioned Scheduler API is being developed?</p>
</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Wed Jun 05 2024 16:13:51 GMT-0700 (Pacific Daylight Time)">23:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">even if the core js language had timers, the web would still need a more complex scheduling api. you can read the details about that in the scheduling api readme</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Wed Jun 05 2024 16:15:43 GMT-0700 (Pacific Daylight Time)">23:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@softwarechris:matrix.org">Chris de Almeida</span>&gt;</div></td><td class="msg-cell">I can't speak to the motivation of the folks that advanced Scheduler, but if you already have an environment where you have production-ready foundational components available, like timing, eventing, and cancellation, and that environment is the same one in which you want to have <code>sleep()</code>, then that seems like a faster path to that goal</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Wed Jun 05 2024 16:17:56 GMT-0700 (Pacific Daylight Time)">23:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@softwarechris:matrix.org">Chris de Almeida</span>&gt;</div></td><td class="msg-cell">that doesn't mean it can't be pursued in the language, or that it's not still useful to add to the language</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Wed Jun 05 2024 16:20:50 GMT-0700 (Pacific Daylight Time)">23:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">I very much hope <code>scheduler.wait</code> does not become the way to do this, but it seems pretty likely unfortunately</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Wed Jun 05 2024 16:21:25 GMT-0700 (Pacific Daylight Time)">23:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">we generally try to avoid duplicating things on the web platform, so if that ships it will not be in the language probably</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Wed Jun 05 2024 16:23:41 GMT-0700 (Pacific Daylight Time)">23:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@whosy:matrix.org">whosy</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> we generally try to avoid duplicating things on the web platform, so if that ships it will not be in the language probably</blockquote></mx-reply>That was my immediate concern as well. At this point the only way to avoid duplication is to adopt part of the spec into the language, or to try and rush through a proposal to the same effect faster than Scheduler.wait it can be adopted into major browsers.<br>Both of which have their own challenges and pitfalls..</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Wed Jun 05 2024 16:24:32 GMT-0700 (Pacific Daylight Time)">23:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@whosy:matrix.org">whosy</span>&gt;</div></td><td class="msg-cell">Or I guess option 3, create a stage-0 proposal and just ask them very nicely to drop parts of their work which..I also don't see happening.</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Wed Jun 05 2024 16:29:12 GMT-0700 (Pacific Daylight Time)">23:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@whosy:matrix.org">whosy</span>&gt;</div></td><td class="msg-cell">I am quite possibly the least qualified person to speak of what should or shouldn't be done here though, so I actually would love to hear the opinions of veterans on the matter.</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Wed Jun 05 2024 16:37:50 GMT-0700 (Pacific Daylight Time)">23:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@kriskowal:aelf.land">kriskowal</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <code>setTimeout</code> is not part of JS</blockquote></mx-reply>Me too, though I called it delay in Q, and the ocap folks (like me) would insist it go on a different namespace that the otherwise I/O free Promise since we prefer to be able to pass Promise into a compartment instead of an attenuated constructor</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Wed Jun 05 2024 16:43:10 GMT-0700 (Pacific Daylight Time)">23:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">personally I would just put it at the top level namespace, named <code>wait</code> or something</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Wed Jun 05 2024 16:43:16 GMT-0700 (Pacific Daylight Time)">23:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><code>await wait(500)</code> etc</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Wed Jun 05 2024 16:50:53 GMT-0700 (Pacific Daylight Time)">23:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@sirisian:matrix.org">sirisian</span>&gt;</div></td><td class="msg-cell">Maybe I'm blanking since I forget proposals. Has anyone suggested an operator like f??.() that is equivalent to <code>typeof f === 'function' ? f() : f</code> ?</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Wed Jun 05 2024 16:56:55 GMT-0700 (Pacific Daylight Time)">23:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@sirisian:matrix.org">sirisian</span>&gt;</div></td><td class="msg-cell"><span class="nick-2">bakkot</span>: <code>await wait(Temporal.Duration.from({ milliseconds: 500 }))</code> heh</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Wed Jun 05 2024 16:57:29 GMT-0700 (Pacific Daylight Time)">23:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Maybe I'm blanking since I forget proposals. Has anyone suggested an operator like f??.() that is equivalent to <code>typeof f === 'function' ? f() : f</code> ?</blockquote></mx-reply>nnnnno I don't think so. that seems kind of niche</td></tr>

</tbody></table></div></div></div>
</body></html>