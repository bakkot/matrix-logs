<!DOCTYPE html><html><head>
  <title>TC39 General on 2021-12-18</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "TC39 General";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">TC39 General<br>2021-12-18<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2021-12-17" class="nav-link"><span>prev</span></a>
<span style="float:right">next</span>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search TC39 General">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Fri Dec 17 2021 19:42:20 GMT-0800 (Pacific Standard Time)">03:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@pokute:matrix.org">pokute</span>&gt;</div></td><td class="msg-cell">There's resistance against adding syntax to ECMAScript and implicit tail-call elimination doesn't seem to be working out from engine implementers. Then how about explicit, magical <code>Function.prototype.callWithElimination(this, ...params)</code> that gives an error during AST generation if the call is not in correct place for eliminating the tail call?</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Fri Dec 17 2021 23:13:55 GMT-0800 (Pacific Standard Time)">07:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">what is "AST generation"? that's not a thing in the spec afaict</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Fri Dec 17 2021 23:20:37 GMT-0800 (Pacific Standard Time)">07:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> what is "AST generation"? that's not a thing in the spec afaict</blockquote></mx-reply>They mean "while parsing" </td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Fri Dec 17 2021 23:20:54 GMT-0800 (Pacific Standard Time)">07:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</div></td><td class="msg-cell">But I don't think a function call should fail while parsing? </td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Fri Dec 17 2021 23:20:54 GMT-0800 (Pacific Standard Time)">07:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">sure, but how could you parse an API call like that?</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Fri Dec 17 2021 23:21:01 GMT-0800 (Pacific Standard Time)">07:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</div></td><td class="msg-cell">Exactly</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Fri Dec 17 2021 23:21:13 GMT-0800 (Pacific Standard Time)">07:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell"><code>const x = Function.prototype.callWithElimination; return <a href="http://x.call">x.call</a>(f);</code></td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Fri Dec 17 2021 23:21:33 GMT-0800 (Pacific Standard Time)">07:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">pretty sure it requires syntax to detect the position of something, eg tail call position</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Fri Dec 17 2021 23:21:35 GMT-0800 (Pacific Standard Time)">07:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</div></td><td class="msg-cell">I don't think this will work, it's valid syntax and shouldn't fail.</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Fri Dec 17 2021 23:23:15 GMT-0800 (Pacific Standard Time)">07:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> pretty sure it requires syntax to detect the position of something, eg tail call position</blockquote></mx-reply>You mean syntax around the expression inside the function? </td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Fri Dec 17 2021 23:23:43 GMT-0800 (Pacific Standard Time)">07:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</div></td><td class="msg-cell">The expression containing the tail call I mean.</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Fri Dec 17 2021 23:35:01 GMT-0800 (Pacific Standard Time)">07:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mhofman:matrix.org">Mathieu Hofman</span>&gt;</div></td><td class="msg-cell">Yeah I don't see how something that isn't syntax could cause a parsing time error. Now the premise about syntax is that it should pay for itself. If there is a way to add something without syntax, then there is little justification to add syntax. If the only option is syntax (like in this idea of explicit tail call) then the question becomes, is it worth the cost? I'm not sure I know enough about tail call use cases to form a complete opinion, but the fact we've gotten away without it for so long is an indicator there are likely ways to avoid a tail call optimization requirements.</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Sat Dec 18 2021 05:11:21 GMT-0800 (Pacific Standard Time)">13:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@pokute:matrix.org">pokute</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <code>const x = Function.prototype.callWithElimination; return <a href="http://x.call">x.call</a>(f);</code></blockquote></mx-reply>I was thinking of that, but it's difficult.  I was thinking of only recognising <code>return recursiveFunc.callWithElimination(undefined, accumulator, moreParams)</code> or something like that.</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Sat Dec 18 2021 05:12:29 GMT-0800 (Pacific Standard Time)">13:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I was thinking of that, but it's difficult.  I was thinking of only recognising <code>return recursiveFunc.callWithElimination(undefined, accumulator, moreParams)</code> or something like that.</blockquote></mx-reply>that do you mean "only recognizing"?</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Sat Dec 18 2021 05:12:45 GMT-0800 (Pacific Standard Time)">13:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</div></td><td class="msg-cell">that it won't work if you assign it to another variable?</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Sat Dec 18 2021 05:12:58 GMT-0800 (Pacific Standard Time)">13:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</div></td><td class="msg-cell">that seems to go against pretty much every single rule of the language</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Sat Dec 18 2021 05:14:20 GMT-0800 (Pacific Standard Time)">13:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@pokute:matrix.org">pokute</span>&gt;</div></td><td class="msg-cell">As the only valid position that doesn't give error during parsing. The error thing was that it should give an error before runtime so that it's impossible to have code that tries to call it in wrong position. And yeah, can't assign. :-) It's magical. <strong>But</strong> it's not unprecended! You can't have <code>const myImport = import</code>.</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Sat Dec 18 2021 05:15:16 GMT-0800 (Pacific Standard Time)">13:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</div></td><td class="msg-cell"><code>import</code> is a keyword</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Sat Dec 18 2021 05:15:32 GMT-0800 (Pacific Standard Time)">13:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</div></td><td class="msg-cell">this is a function on a prototype</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Sat Dec 18 2021 05:17:29 GMT-0800 (Pacific Standard Time)">13:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@pokute:matrix.org">pokute</span>&gt;</div></td><td class="msg-cell">Well, we could make it less conventional with <code>return recursiveFunc[Function.withCallEliminationSymbol]( ... )</code>.</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Sat Dec 18 2021 05:20:43 GMT-0800 (Pacific Standard Time)">13:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@pokute:matrix.org">pokute</span>&gt;</div></td><td class="msg-cell">I was thinking of early error just that people don't accidentally write it in positions where it can't be tail eliminated away.</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Sat Dec 18 2021 05:21:32 GMT-0800 (Pacific Standard Time)">13:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell">I should re-read the previous meeting notes, but in my memory I didn't think syntax was the main item stopping tco ? I thought it was more implementation complexity and relation to the stack trace proposal?</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Sat Dec 18 2021 05:23:39 GMT-0800 (Pacific Standard Time)">13:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@pokute:matrix.org">pokute</span>&gt;</div></td><td class="msg-cell">Explicity would weaken the expectations that stack traces and debugging is identical to normal function calls.</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Sat Dec 18 2021 05:39:02 GMT-0800 (Pacific Standard Time)">13:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell">last notes I could find: <a href="https://github.com/tc39/notes/blob/master/meetings/2016-05/may-24.md#syntactic-tail-calls-bt">https://github.com/tc39/notes/blob/master/meetings/2016-05/may-24.md#syntactic-tail-calls-bt</a></td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Sat Dec 18 2021 07:17:16 GMT-0800 (Pacific Standard Time)">15:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</div></td><td class="msg-cell">Yeah, I don't think it would be easy to sell new syntax for TCO to the committee...</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Sat Dec 18 2021 08:36:37 GMT-0800 (Pacific Standard Time)">16:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mhofman:matrix.org">Mathieu Hofman</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Well, we could make it less conventional with <code>return recursiveFunc[Function.withCallEliminationSymbol]( ... )</code>.</blockquote></mx-reply>This is still a dynamic non parse time evaluation. `import()` is pure syntax. `Function` is not and can be replaced by code, as can any of it's prototype or self methods.</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Sat Dec 18 2021 08:37:40 GMT-0800 (Pacific Standard Time)">16:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mhofman:matrix.org">Mathieu Hofman</span>&gt;</div></td><td class="msg-cell">If you want explicit tail call that throws at parse time, i don't see any other way but requiring syntax.</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Sat Dec 18 2021 08:38:11 GMT-0800 (Pacific Standard Time)">16:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">I donâ€™t see how non-syntax could throw at any time</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Sat Dec 18 2021 08:40:33 GMT-0800 (Pacific Standard Time)">16:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mhofman:matrix.org">Mathieu Hofman</span>&gt;</div></td><td class="msg-cell">Yeah I think you're right, you'd probably need something to link your current stack to the runtime call to ensure it throws if not I'm tail position. That reeks of `function.callee`</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Sat Dec 18 2021 08:42:38 GMT-0800 (Pacific Standard Time)">16:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mhofman:matrix.org">Mathieu Hofman</span>&gt;</div></td><td class="msg-cell">At which point since you need syntax anyway, I'd rather make it static/parse time syntax. Note that I still don't understand enough the motivation.</td></tr>

</tbody></table></div></div></div>
</body></html>