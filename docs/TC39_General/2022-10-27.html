<!DOCTYPE html><html><head>
  <title>TC39 General on 2022-10-27</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "TC39 General";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">TC39 General<br>2022-10-27<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2022-10-26" class="nav-link"><span>prev</span></a>
<a href="2022-10-28" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search TC39 General">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Wed Oct 26 2022 19:20:57 GMT-0700 (Pacific Daylight Time)">02:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">what do people do if they want to take the maximum of an with like 200k items in it, such that <code>Math.max(...arr)</code> overflows</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Wed Oct 26 2022 19:21:03 GMT-0700 (Pacific Daylight Time)">02:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">does this just not happen?</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Wed Oct 26 2022 19:21:32 GMT-0700 (Pacific Daylight Time)">02:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">context: I am thinking about how <code>Math.sum</code> should work - it could take an iterable, which seems like the obvious thing, but then it wouldn't match <code>Math.max</code></td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Wed Oct 26 2022 20:13:44 GMT-0700 (Pacific Daylight Time)">03:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">you’d probably slice it and max the slices? but i think it largely doesn’t happen</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Wed Oct 26 2022 20:15:00 GMT-0700 (Pacific Daylight Time)">03:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">however I’d assume that it should be possible for engines to handle too-large arg arrays that are spread into a call to a builtin function?</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Wed Oct 26 2022 20:24:31 GMT-0700 (Pacific Daylight Time)">03:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">it is possible in principle but difficult in practice; none of the major engines support passing an array of length 1e6 in my testing</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Wed Oct 26 2022 20:31:13 GMT-0700 (Pacific Daylight Time)">03:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">I would if we could reasonably overload <code>Math.max</code> such that if you call it with exactly one argument, and that argument is an object, it does a lookup of <code>Symbol.iterator</code> on that object and then uses that</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Wed Oct 26 2022 20:31:18 GMT-0700 (Pacific Daylight Time)">03:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">possibly this is a bad idea though</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Wed Oct 26 2022 20:31:48 GMT-0700 (Pacific Daylight Time)">03:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">probably someone out there is somehow relying <code>Math.max([0, 1])</code> being NaN</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Wed Oct 26 2022 20:36:08 GMT-0700 (Pacific Daylight Time)">03:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@kriskowal:matrix.org">Kris Kowal</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> what do people do if they want to take the maximum of an with like 200k items in it, such that <code>Math.max(...arr)</code> overflows</blockquote></mx-reply>At some point, I ran into this with <code>splice</code>, because it was useful to funnel insertion and deletion operations through a single method. I ended up adding an <code>swap(index, count, replacements) =&gt; void</code> that was <code>splice</code> but not-variadic and also didn’t return a useless <code>slice</code>.</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Wed Oct 26 2022 20:39:06 GMT-0700 (Pacific Daylight Time)">03:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@kriskowal:matrix.org">Kris Kowal</span>&gt;</div></td><td class="msg-cell">I think the bigger concern with unadic overloads of <code>min</code> and <code>max</code> would be the behavior of <code>Math.min(...array)</code> for arrays that happen to only have one value.</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Wed Oct 26 2022 20:40:33 GMT-0700 (Pacific Daylight Time)">03:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@kriskowal:matrix.org">Kris Kowal</span>&gt;</div></td><td class="msg-cell">Perhaps it makes more sense to leave <code>Math</code> behind and <code>Number.min,max,sum</code>.</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Wed Oct 26 2022 20:41:22 GMT-0700 (Pacific Daylight Time)">03:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@kriskowal:matrix.org">Kris Kowal</span>&gt;</div></td><td class="msg-cell">Also <code>String.join(iterable)</code></td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Wed Oct 26 2022 21:02:59 GMT-0700 (Pacific Daylight Time)">04:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">I would not want to have both <code>Math.max</code> and also <code>Number.max</code>, especially with different behaviors</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Wed Oct 26 2022 21:03:48 GMT-0700 (Pacific Daylight Time)">04:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><blockquote>
<p><code>Math.min(...array)</code> for arrays that happen to only have one value</p>
</blockquote>
<p>with my suggestion this would only be problematic if the first value in the array happened to be an object with a Symbol.iterator method (or such that accessing that property was side-effecting, I guess)</p>
</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Wed Oct 26 2022 21:04:19 GMT-0700 (Pacific Daylight Time)">04:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">which seems unlikely, or at least unlikely-ish</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Wed Oct 26 2022 21:45:44 GMT-0700 (Pacific Daylight Time)">04:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@gibson042:matrix.org">Richard Gibson</span>&gt;</div></td><td class="msg-cell">I for one don't support that kind of overloading. If such behavior is to be added to the standard library, it should be in the form of new functions that always read <code>Symbol.iterator</code>.</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Wed Oct 26 2022 21:56:56 GMT-0700 (Pacific Daylight Time)">04:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><span class="nick-11">Richard Gibson</span> do you think <code>Math.sum</code> should be such a new function, inconsistent with <code>Math.max</code>? or would you want like a <code>Math.maxList</code> and <code>Math.sumList</code> so they could be consistent?</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Wed Oct 26 2022 22:00:09 GMT-0700 (Pacific Daylight Time)">05:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@gibson042:matrix.org">Richard Gibson</span>&gt;</div></td><td class="msg-cell">the latter. We've got precedent for Math functions that operate on an arbitrary number of values to accept each one as an argument, so new Math functions that accept an arbitrary number of values from an iterable should indicate that distinction by a common naming pattern.</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Wed Oct 26 2022 22:11:32 GMT-0700 (Pacific Daylight Time)">05:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@gibson042:matrix.org">Richard Gibson</span>&gt;</div></td><td class="msg-cell">similar to how <code>Array.from</code> process its argument as an iterable but <code>Array</code> does not</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Wed Oct 26 2022 22:41:24 GMT-0700 (Pacific Daylight Time)">05:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">python's <code>max</code> appears to be overloaded exactly as I suggested above, incidentally</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Wed Oct 26 2022 22:41:41 GMT-0700 (Pacific Daylight Time)">05:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">and their <code>sum</code> only takes an iterable</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Wed Oct 26 2022 22:42:35 GMT-0700 (Pacific Daylight Time)">05:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">I guess their <code>max</code> isn't <em>exactly</em> as I suggested; if you pass it exactly one item it assumes it's iterable and throws if not</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Wed Oct 26 2022 22:42:44 GMT-0700 (Pacific Daylight Time)">05:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">which, alas, we could not do at this point</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Wed Oct 26 2022 22:46:26 GMT-0700 (Pacific Daylight Time)">05:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jessidhia:matrix.org">Jessidhia</span>&gt;</div></td><td class="msg-cell">was wondering about “what if you want to sum more than one iterable”, and the obvious answer is to spread them, but that’d be an eager operation that’d result in double iteration and extra GC garbage; perhaps that’s a use case for concat in iteratorhelpers, or perhaps I’m just overthinking</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Wed Oct 26 2022 22:59:22 GMT-0700 (Pacific Daylight Time)">05:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><span class="nick-2">Jessidhia</span>: yeah, concat in iterator helpers would work, though that's not in V1; flatmap serves the same purpose though</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Wed Oct 26 2022 22:59:48 GMT-0700 (Pacific Daylight Time)">05:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><code>Math.sumList(Iterator.from(arrayOfIterables).flatMap(x =&gt; x))</code></td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Wed Oct 26 2022 23:00:30 GMT-0700 (Pacific Daylight Time)">06:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><code>sumList</code> is a terrible name for this API though; hope someone can come up with a better one</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Wed Oct 26 2022 23:16:39 GMT-0700 (Pacific Daylight Time)">06:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@gibson042:matrix.org">Richard Gibson</span>&gt;</div></td><td class="msg-cell">my bikeshed vote would be <code>sumFrom</code>, aligning with <code>Array.from</code></td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Wed Oct 26 2022 23:20:49 GMT-0700 (Pacific Daylight Time)">06:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">I don't hate it</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Wed Oct 26 2022 23:21:31 GMT-0700 (Pacific Daylight Time)">06:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">also if we do add <code>Math.sum</code> (the argument-list-taking version, by contrast to the iterable-taking version) can we make it throw if any of the things are not already numbers, instead of casting</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Wed Oct 26 2022 23:22:09 GMT-0700 (Pacific Daylight Time)">06:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">I don't want <code>Math.sum([1])</code> to work; the fact that <code>Math.max([1])</code> works is horrifying</td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Thu Oct 27 2022 00:12:22 GMT-0700 (Pacific Daylight Time)">07:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> what do people do if they want to take the maximum of an with like 200k items in it, such that <code>Math.max(...arr)</code> overflows</blockquote></mx-reply>I use a for-loop instead if not confident on limit of array length</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Thu Oct 27 2022 14:44:16 GMT-0700 (Pacific Daylight Time)">21:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@tabatkins:matrix.org">TabAtkins</span>&gt;</div></td><td class="msg-cell">yup, or that's simple enough that I feel okay doing an <code>arr.reduce((a,b)=&gt;Math.max(a,b))</code></td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Thu Oct 27 2022 14:44:34 GMT-0700 (Pacific Daylight Time)">21:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@tabatkins:matrix.org">TabAtkins</span>&gt;</div></td><td class="msg-cell">(I don't use <code>reduce</code> if the operation is more than a single simple expression, but this qualifies)</td></tr>

</tbody></table></div></div></div>
</body></html>