<!DOCTYPE html><html><head>
  <title>TC39 General on 2021-07-16</title>
  <link rel="stylesheet" href="../style.css">
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">TC39 General<br>2021-07-16<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2021-07-15" class="nav-link"><span>prev</span></a>
<span style="float:right">next</span>
</div>
    
<div class="room-list-wrapper">Active:<br>
<ul class="room-list">
<li><a href="../TC39_Delegates/">TC39 Delegates</a></li>
<li><a href="../TC39_Editors/">TC39 Editors</a></li>
<li><a href="../TC39_General/" class="current-room">TC39 General</a></li>
<li><a href="../WHATWG/">WHATWG</a></li>
</ul>
</div>
<br>
<div class="room-list-wrapper">Historical:<br>
<ul class="room-list">
<li><a href="../irc-tc39/">#tc39</a></li>
<li><a href="../irc-tc39-delegates/">#tc39-delegates</a></li>
<li><a href="../irc-tc39-editor-group/">#tc39-editor-group</a></li>
<li><a href="../irc-whatwg/">#whatwg</a></li>
</ul>
</div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs"><div class="log">
<table><tbody id="log-tbody">
  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Thu Jul 15 2021 19:31:34 GMT-0700 (Pacific Daylight Time)">02:31</a></td><td class="nick-cell">&lt;<span class="nick nick-11" title="@gibson042:matrix.org">Richard Gibson</span>&gt;</td><td class="msg-cell">sure, but in the same sense as flatMap itself is <code>.reduce((out, ...args) =&gt; out.concat(mapper(...args)), [])</code></td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Fri Jul 16 2021 02:48:30 GMT-0700 (Pacific Daylight Time)">09:48</a></td><td class="nick-cell">&lt;<span class="nick nick-11" title="@andreubotella:mozilla.org">Andreu Botella (he/they)</span>&gt;</td><td class="msg-cell">Hi! I just noticed that <code>Atomics.multiply()</code> isn't a thing. Is that because for all other operations you don't need to know whether the type is signed or unsigned but for multiplication you do?</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Fri Jul 16 2021 11:19:19 GMT-0700 (Pacific Daylight Time)">18:19</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</td><td class="msg-cell">What objects in 262 use option bags?</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Fri Jul 16 2021 11:19:31 GMT-0700 (Pacific Daylight Time)">18:19</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</td><td class="msg-cell">I am investigating whether error.cause's HasProperty + Get pattern is standard or unusual</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Fri Jul 16 2021 11:22:02 GMT-0700 (Pacific Daylight Time)">18:22</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">262 itself does not tend to use object bags much, though that's changing. 402 uses them more and just does Get, IIRC</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Fri Jul 16 2021 11:22:48 GMT-0700 (Pacific Daylight Time)">18:22</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">I think we are in generally in favor of just doing Get; I argued for error.cause to be a special case because, unusually, <code>undefined</code> is a value one might reasonably want to use</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Fri Jul 16 2021 11:23:08 GMT-0700 (Pacific Daylight Time)">18:23</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">In cases where <code>undefined</code> is not an expected value there's no particularly reason to do a Has check first</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Fri Jul 16 2021 11:23:23 GMT-0700 (Pacific Daylight Time)">18:23</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</td><td class="msg-cell">Hmm</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Fri Jul 16 2021 11:23:38 GMT-0700 (Pacific Daylight Time)">18:23</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</td><td class="msg-cell">I do not like distinguishing between undefined and not-present in the options bag</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Fri Jul 16 2021 11:23:42 GMT-0700 (Pacific Daylight Time)">18:23</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</td><td class="msg-cell">As well as on the object itself</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Fri Jul 16 2021 11:24:07 GMT-0700 (Pacific Daylight Time)">18:24</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</td><td class="msg-cell">I feel like if you really want to split hairs there you should use error.cause === undefined vs. error.cause === null, instead of testing 'cause' in error</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Fri Jul 16 2021 11:24:50 GMT-0700 (Pacific Daylight Time)">18:24</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">The problem is that the error values are generally being handed to you, not a thing you are given yourself: that is, you are writing <code>catch (e) { throw new Error('message, { cause: e })</code> without testing the value of <code>e</code></td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Fri Jul 16 2021 11:25:05 GMT-0700 (Pacific Daylight Time)">18:25</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell"> * The problem is that the error values are generally being handed to you, not a thing you are creating yourself: that is, you are writing <code>catch (e) { throw new Error('message, { cause: e })</code> without testing the value of <code>e</code></td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Fri Jul 16 2021 11:26:34 GMT-0700 (Pacific Daylight Time)">18:26</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</td><td class="msg-cell">Sure</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Fri Jul 16 2021 11:27:16 GMT-0700 (Pacific Daylight Time)">18:27</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</td><td class="msg-cell">But I don't understand why that means it's important that <code>'cause' in new Error('message')</code> is false whereas <code>'cause' in new Error('message', { cause: undefined })</code> is true.</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Fri Jul 16 2021 11:28:39 GMT-0700 (Pacific Daylight Time)">18:28</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">Ah, this was on the assumption that there would not be a <code>cause</code> property if you didn't pass the options bag at all</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Fri Jul 16 2021 11:28:59 GMT-0700 (Pacific Daylight Time)">18:28</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">that is, I think it's important that <code>'cause' in new Error('message', { cause: undefined })</code>, since you are explicitly asking to create an error with a <code>cause</code></td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Fri Jul 16 2021 11:29:30 GMT-0700 (Pacific Daylight Time)">18:29</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">I don't know if I have an opinion about whether <code>'cause' in new Error('message')</code> should also be true</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Fri Jul 16 2021 11:30:05 GMT-0700 (Pacific Daylight Time)">18:30</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">but I do think <code>'cause' in new Error('message')</code> should match <code>'cause' in new Error('message', {})</code></td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Fri Jul 16 2021 11:30:14 GMT-0700 (Pacific Daylight Time)">18:30</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</td><td class="msg-cell">My opinion is it should also be true</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Fri Jul 16 2021 11:30:28 GMT-0700 (Pacific Daylight Time)">18:30</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</td><td class="msg-cell">I.e. we should not branch behavior on {} vs. { cause: undefined }</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Fri Jul 16 2021 11:31:11 GMT-0700 (Pacific Daylight Time)">18:31</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</td><td class="msg-cell">Filed <a href="https://github.com/tc39/proposal-error-cause/issues/35">https://github.com/tc39/proposal-error-cause/issues/35</a></td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Fri Jul 16 2021 11:36:31 GMT-0700 (Pacific Daylight Time)">18:36</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">Mind, it's already stage 3, so I don't know how much appetite there will be for this sort of change</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Fri Jul 16 2021 11:56:32 GMT-0700 (Pacific Daylight Time)">18:56</a></td><td class="nick-cell">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</td><td class="msg-cell">it's also already shipping</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Fri Jul 16 2021 11:56:38 GMT-0700 (Pacific Daylight Time)">18:56</a></td><td class="nick-cell">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</td><td class="msg-cell">well, almost, coming up in chrome 93</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Fri Jul 16 2021 12:01:42 GMT-0700 (Pacific Daylight Time)">19:01</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title="@justingrant:matrix.org">justingrant</span>&gt;</td><td class="msg-cell"><blockquote>
<p>What objects in 262 use option bags?</p>
</blockquote>
<p>Temporal uses options bags in almost every method that takes parameters. If we're using them incorrectly or inconsistently, let us know!</p>
</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Fri Jul 16 2021 12:18:24 GMT-0700 (Pacific Daylight Time)">19:18</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</td><td class="msg-cell">My intent was for this to be "implementer feedback" as we work to spec/implement structured clone for it</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Fri Jul 16 2021 12:25:25 GMT-0700 (Pacific Daylight Time)">19:25</a></td><td class="nick-cell">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</td><td class="msg-cell">i was chatting with marja on the V8 team about just this the other day, on whether we should unify option bag handling to be Get for Error cause</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Fri Jul 16 2021 12:26:21 GMT-0700 (Pacific Daylight Time)">19:26</a></td><td class="nick-cell">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</td><td class="msg-cell">my conclusion was that "just a Get" should be the default behavior for option bags, but once in a while a specific use case arises that requires special casing with a Has, like Error cause has with wanting to capture undefined/falsy values, which can be thrown</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Fri Jul 16 2021 12:26:54 GMT-0700 (Pacific Daylight Time)">19:26</a></td><td class="nick-cell">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</td><td class="msg-cell">wait, is that what's being discussed here, i might've skimmed it too fast</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Fri Jul 16 2021 12:42:27 GMT-0700 (Pacific Daylight Time)">19:42</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</td><td class="msg-cell">Pretty much yeah. I just think we shouldn't distinguish because { cause: undefined } and {}</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Fri Jul 16 2021 12:49:58 GMT-0700 (Pacific Daylight Time)">19:49</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title="@justingrant:matrix.org">justingrant</span>&gt;</td><td class="msg-cell">From a documentation standpoint, does <code>{ cause: null }</code> mean "I am filling <code>cause</code> but I don't know what the cause was" as opposed to <code>{ cause: undefined }</code> which means "I didn't fill in a <code>cause</code>"?</td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Fri Jul 16 2021 12:57:08 GMT-0700 (Pacific Daylight Time)">19:57</a></td><td class="nick-cell">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</td><td class="msg-cell">are you asking about the status quo or domenic's suggestion?</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Fri Jul 16 2021 12:57:33 GMT-0700 (Pacific Daylight Time)">19:57</a></td><td class="nick-cell">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</td><td class="msg-cell">the status quo is <code>cause</code>, if present at all, is honored, since you can <code>throw undefined;</code> and maybe you want to capture that in the <code>cause</code></td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Fri Jul 16 2021 13:27:07 GMT-0700 (Pacific Daylight Time)">20:27</a></td><td class="nick-cell">&lt;<span class="nick nick-11" title="@gibson042:matrix.org">Richard Gibson</span>&gt;</td><td class="msg-cell">it seems hostile to future options for <code>new Error(message, {})</code> to create a <code>cause</code> property that would not be present on the result of <code>new Error(message)</code></td></tr>
  <tr class="msg" id="L35"><td class="ts-cell"><a class="ts" href="#L35" alt="Fri Jul 16 2021 13:29:52 GMT-0700 (Pacific Daylight Time)">20:29</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title="@justingrant:matrix.org">justingrant</span>&gt;</td><td class="msg-cell">Got it. TIL that <code>throw undefined</code> was a thing. 🤷‍♂️ Just when I thought I knew all the weird parts of ECMAScript, it turns out there's always something weirder!</td></tr>
  <tr class="msg" id="L36"><td class="ts-cell"><a class="ts" href="#L36" alt="Fri Jul 16 2021 13:39:37 GMT-0700 (Pacific Daylight Time)">20:39</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell"><span class="nick-11">Richard Gibson</span>: I believe the proposal is for <code>new Error(message)</code> to also have a <code>cause</code> property</td></tr>
  <tr class="msg" id="L37"><td class="ts-cell"><a class="ts" href="#L37" alt="Fri Jul 16 2021 13:40:10 GMT-0700 (Pacific Daylight Time)">20:40</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">per <a href="https://github.com/tc39/proposal-error-cause/issues/35">https://github.com/tc39/proposal-error-cause/issues/35</a> + <a href="https://github.com/tc39/proposal-error-cause/issues/36">https://github.com/tc39/proposal-error-cause/issues/36</a></td></tr>
  <tr class="msg" id="L38"><td class="ts-cell"><a class="ts" href="#L38" alt="Fri Jul 16 2021 14:03:51 GMT-0700 (Pacific Daylight Time)">21:03</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</td><td class="msg-cell">Indeed, the idea is that, like everywhere is that I'm aware of in the ES spec ecosystem and web platform, omitting the options object is treated the same as the empty options object which is treated the same as the options object with a bunch of undefineds for each option.</td></tr>
</tbody></table>
</div></div></div>
</body></html>