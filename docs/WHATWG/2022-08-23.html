<!DOCTYPE html><html><head>
  <title>WHATWG on 2022-08-23</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "WHATWG";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">WHATWG<br>2022-08-23<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2022-08-22" class="nav-link"><span>prev</span></a>
<span style="float:right">next</span>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search WHATWG">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Mon Aug 22 2022 19:39:20 GMT-0700 (Pacific Daylight Time)">02:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@alystair:matrix.org">Lorin</span>&gt;</div></td><td class="msg-cell">Are there plans to allow the pseudo-element <code>content</code> prop to use <code>var()</code> in its value - so I can set a piece of content much higher in the DOM chain and display it?</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Mon Aug 22 2022 19:41:21 GMT-0700 (Pacific Daylight Time)">02:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@alystair:matrix.org">Lorin</span>&gt;</div></td><td class="msg-cell">at the moment it's a bit limited with just <code>attr()</code></td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Mon Aug 22 2022 23:48:39 GMT-0700 (Pacific Daylight Time)">06:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@kaiido:matrix.org">Kaiido</span>&gt;</div></td><td class="msg-cell">But then doing something as simple as <code>input.oninput = (evt)  =&gt; { evt.preventDefault(); input.value = input.value.toUpperCase(); }</code> would end up in an infinite loop unless you had super complicated/ugly machinery to avoid it.<br>If you need ComponentB to let the other scripts know that it made some changes, it can still dispatch the event manually.</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Tue Aug 23 2022 01:24:06 GMT-0700 (Pacific Daylight Time)">08:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@jakea:matrix.org">Jake Archibald</span>&gt;</div></td><td class="msg-cell"><span class="nick-14">Kaiido</span>: in your example, some piece of code wants to ensure the input text is uppercase. Presumably, that's true regardless of whether the input is from the user, or programatic from some other piece of code. Relying on that other piece of code to pretend it's user input is hacky.</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Tue Aug 23 2022 01:25:48 GMT-0700 (Pacific Daylight Time)">08:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@kaiido:matrix.org">Kaiido</span>&gt;</div></td><td class="msg-cell"> But that's not the point. The issue is that if the script does the change in response to the event it will itself trigger the same event.</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Tue Aug 23 2022 01:26:21 GMT-0700 (Pacific Daylight Time)">08:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@jakea:matrix.org">Jake Archibald</span>&gt;</div></td><td class="msg-cell">It is the point ðŸ˜€. The model is bad because it works in some cases but not in others.</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Tue Aug 23 2022 01:26:46 GMT-0700 (Pacific Daylight Time)">08:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@kaiido:matrix.org">Kaiido</span>&gt;</div></td><td class="msg-cell">To know if an event came from the user or from a script we have the isTrusted property.</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Tue Aug 23 2022 01:27:09 GMT-0700 (Pacific Daylight Time)">08:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@jakea:matrix.org">Jake Archibald</span>&gt;</div></td><td class="msg-cell"><code>BroadcastChannel</code> works really well here, since each component can have its own instance. Compare this to storage events which have the same global problem.</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Tue Aug 23 2022 01:29:03 GMT-0700 (Pacific Daylight Time)">08:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@jakea:matrix.org">Jake Archibald</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> To know if an event came from the user or from a script we have the isTrusted property.</blockquote></mx-reply>It isn't as black and white as that. Something can be started by user input, and then modified by script. So the origin of the change is still the user, but it's been influenced by script. <code>isTrusted</code> is more useful to know if the event is directly from the browser, but I don't think that helps in the case we're talking about</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Tue Aug 23 2022 01:29:36 GMT-0700 (Pacific Daylight Time)">08:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@kaiido:matrix.org">Kaiido</span>&gt;</div></td><td class="msg-cell">Ok, so you're saying the whole EventTarget model is broken. I think I could agree with that. But firing events from script changes on that model without changing it all won't work.</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Tue Aug 23 2022 01:30:35 GMT-0700 (Pacific Daylight Time)">08:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@jakea:matrix.org">Jake Archibald</span>&gt;</div></td><td class="msg-cell">I'm not saying the whole <code>EventTarget</code> model is broken. I just pointed to <code>BroadcastChannel</code> as working well, and that usesâ€¦ <code>EventTarget</code></td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Tue Aug 23 2022 01:30:36 GMT-0700 (Pacific Daylight Time)">08:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@kaiido:matrix.org">Kaiido</span>&gt;</div></td><td class="msg-cell">I highly doubt the one precedent details created is something we should follow.</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Tue Aug 23 2022 01:31:16 GMT-0700 (Pacific Daylight Time)">08:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@jakea:matrix.org">Jake Archibald</span>&gt;</div></td><td class="msg-cell">It isn't one precedent. There are many events on the platform that are script-triggered</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Tue Aug 23 2022 01:31:20 GMT-0700 (Pacific Daylight Time)">08:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@kaiido:matrix.org">Kaiido</span>&gt;</div></td><td class="msg-cell">But it works well because each component can have its own target. right?</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Tue Aug 23 2022 01:32:11 GMT-0700 (Pacific Daylight Time)">08:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@jakea:matrix.org">Jake Archibald</span>&gt;</div></td><td class="msg-cell">Yes. And the input case (and similar cases like storage events) work badly because it assumes that it's owned by one component</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Tue Aug 23 2022 01:33:04 GMT-0700 (Pacific Daylight Time)">08:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@jakea:matrix.org">Jake Archibald</span>&gt;</div></td><td class="msg-cell">It's better to fire change events when things are changed, then provide a way to avoid firing events, for changes that are transformations of changes.</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Tue Aug 23 2022 01:35:15 GMT-0700 (Pacific Daylight Time)">08:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@jakea:matrix.org">Jake Archibald</span>&gt;</div></td><td class="msg-cell">The <code>formdata</code> event on forms is a good model here. There, listeners make modifications via the event itself. It's built for transforming the user input, so it works well for transformations.</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Tue Aug 23 2022 01:37:27 GMT-0700 (Pacific Daylight Time)">08:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@jakea:matrix.org">Jake Archibald</span>&gt;</div></td><td class="msg-cell">An equivalent would be an event on <code>&lt;input&gt;</code> where the new value could be transformed by listeners on the event object itself. That way, it's clear it shouldn't fire an additional change event, since the change is being made as part of the event.</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Tue Aug 23 2022 01:43:59 GMT-0700 (Pacific Daylight Time)">08:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@kaiido:matrix.org">Kaiido</span>&gt;</div></td><td class="msg-cell">I must admit I'm not as familiar with all these APIs as you are. For instance if by "storage events" you talk about the onstorage one, do you mean it's broken because we could for instance access the other page's handler from a <code><a href="http://window.open">window.open</a>()</code> call? That sounds like a far more complicated way to shoot you in the foot than my input.value example. And unfortunately I think that even with a new event like the one you propose where the value is passed and transformable from the event itself, it would still be very easy to shoot ourselves in the foot by using the input's <code>.value</code> there too. Btw, is it possible to change the form's formdata from outside of the event?</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Tue Aug 23 2022 02:22:17 GMT-0700 (Pacific Daylight Time)">09:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@jakea:matrix.org">Jake Archibald</span>&gt;</div></td><td class="msg-cell">I do mean <code>onstorage</code>. If <code>localStorage</code> is used to store state, and ComponentA makes a change, ComponentB doesn't find out about it if they're in the same window.</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Tue Aug 23 2022 02:22:45 GMT-0700 (Pacific Daylight Time)">09:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@jakea:matrix.org">Jake Archibald</span>&gt;</div></td><td class="msg-cell"><blockquote>
<p>is it possible to change the form's formdata from outside of the event?</p>
</blockquote>
<p>Well, you can change form inputs, which are later used to create the <code>FormData</code> object.</p>
</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Tue Aug 23 2022 03:24:30 GMT-0700 (Pacific Daylight Time)">10:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@kaiido:matrix.org">Kaiido</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <blockquote>
<p>is it possible to change the form's formdata from outside of the event?</p>
</blockquote>
<p>Well, you can change form inputs, which are later used to create the <code>FormData</code> object.</p>
</blockquote></mx-reply>But you're not modifying the same FormData object, only a future one.</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Tue Aug 23 2022 03:31:10 GMT-0700 (Pacific Daylight Time)">10:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@kaiido:matrix.org">Kaiido</span>&gt;</div></td><td class="msg-cell">Ok, I guess I can see the point. I still believe dispatchEvent is a quite ok workaround for that case though.<br>
Moreover if that would mean that the same component had to filter out the events it did trigger.</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Tue Aug 23 2022 04:36:48 GMT-0700 (Pacific Daylight Time)">11:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@jakea:matrix.org">Jake Archibald</span>&gt;</div></td><td class="msg-cell"><span class="nick-14">Kaiido</span>: I think you only need to filter it out in the circular case, where the change is in response to the change. Take the Navigation API <a href="https://developer.chrome.com/docs/web-platform/navigation-api/">https://developer.chrome.com/docs/web-platform/navigation-api/</a> - this works really well <em>because</em> there's one central place to handle navigations, regardless of whether the navigation was caused by script or directly by the user. This is one of the things that makes the Navigation API easier to use than the old History API, where your logic ends up split depending on how the navigation was triggered.</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Tue Aug 23 2022 08:59:18 GMT-0700 (Pacific Daylight Time)">15:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell"><span class="nick-16">sideshowbarker</span>: I filed a ticket with DreamHost for <a href="http://html5.org">html5.org</a>, seems it affects all my sites</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Tue Aug 23 2022 09:00:09 GMT-0700 (Pacific Daylight Time)">16:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell"><span class="nick-16">sideshowbarker</span>: we could potentially keep the existing domain name but point it to GitHub for hosting...</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Tue Aug 23 2022 16:29:57 GMT-0700 (Pacific Daylight Time)">23:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@kaiido:matrix.org">Kaiido</span>&gt;</div></td><td class="msg-cell">I didn't had the occasion to play with this new API yet, so pardon my ignorance here. From fast-reading your article, doesn't this model work well because it's assumed that a single point will handle all these events? I have the feeling this model wouldn't scale very well for the case of two different components trying to handle events on a single target either.<br>I made a very quick test and it seems that two intercept handlers could actually run at the same time, in parallel, without any apparent way of knowing that the event was already intercepted. Did I miss something there? Shouldn't <code>.intercept()</code> at least set the <code>defaultPrevented</code> to true or a new <code>isIntercepted</code> flag?<br>I now see this was discussed in <a href="https://github.com/WICG/navigation-api/issues/89">#89</a> and <a href="https://github.com/WICG/navigation-api/issues/94">#94</a> to some extents (based on the previous <code>respondWith()</code> model), but I don't see any mention of letting the other handlers know they're not alone. One could still append that flag on the event manually, but that requires coordination. Also, I don't have a use-case for this, so you may very well just ignore me ;-)</td></tr>

</tbody></table></div></div></div>
</body></html>