<!DOCTYPE html><html><head>
  <title>WHATWG on 2021-10-28</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "WHATWG";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">WHATWG<br>2021-10-28<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2021-10-27" class="nav-link"><span>prev</span></a>
<span style="float:right">next</span>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>
<input type="text" id="query" size="25" placeholder="Search WHATWG">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Thu Oct 28 2021 07:50:03 GMT-0700 (Pacific Daylight Time)">14:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:mozilla.org">annevk</span>&gt;</div></td><td class="msg-cell"><span class="nick-1">Domenic</span>: hey, you could make the ARIA thing right? I could join an hour in, potentially</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Thu Oct 28 2021 08:22:17 GMT-0700 (Pacific Daylight Time)">15:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">annevk</span>: I'm not sure it's really a good use of time...</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Thu Oct 28 2021 08:24:17 GMT-0700 (Pacific Daylight Time)">15:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:mozilla.org">annevk</span>&gt;</div></td><td class="msg-cell">Yeah... And they didn't reply to our comments about that either ☹️</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Thu Oct 28 2021 10:50:13 GMT-0700 (Pacific Daylight Time)">17:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@dereknongeneric:mozilla.org">DerekNonGeneric</span>&gt;</div></td><td class="msg-cell"><blockquote>
<p>Regardless, an implementation of a given set of IDL fragments needs to be able to recognize all platform objects that are created by the implementation. <a href="https://webidl.spec.whatwg.org/#idl-objects">https://webidl.spec.whatwg.org/#idl-objects</a></p>
</blockquote>
<p>w/o having read the whole Web IDL spec to find out why does anyone know what the reason for this is?</p>
<p>also, would be curious to know if the new IDL Object that we just released (<code>DOMException</code>) in Node.js v17.0.0 would be considered a <em>real</em> "platform object" or if not, how we should classify these new objects that are to be backed by the IDL type system if they aren't already?</p>
</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Thu Oct 28 2021 10:52:48 GMT-0700 (Pacific Daylight Time)">17:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</div></td><td class="msg-cell"><span class="nick-9">DerekNonGeneric</span>: an implementation needs to be able to recognize platform objects so that it can properly implement the "is a platform object" checks in the Web IDL spec and elsewhere.</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Thu Oct 28 2021 10:53:08 GMT-0700 (Pacific Daylight Time)">17:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</div></td><td class="msg-cell">I suspect that DOMException should be considered as such in Node.js, e.g. for structuredClone().</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Thu Oct 28 2021 10:55:50 GMT-0700 (Pacific Daylight Time)">17:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@dereknongeneric:mozilla.org">DerekNonGeneric</span>&gt;</div></td><td class="msg-cell">yeah, so we will likely need to write up something like <code>isPlatformObject()</code>, but whether or not we should expose it is another story</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Thu Oct 28 2021 12:13:22 GMT-0700 (Pacific Daylight Time)">19:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@andreubotella:mozilla.org">Andreu Botella (he/they)</span>&gt;</div></td><td class="msg-cell">I'm not sure how Node does things, but I've been looking into implementing serializable platform objects in Deno, and V8 requires you to have at least one internal field before it lets you define a custom serialization.</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Thu Oct 28 2021 12:13:52 GMT-0700 (Pacific Daylight Time)">19:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@andreubotella:mozilla.org">Andreu Botella (he/they)</span>&gt;</div></td><td class="msg-cell">FTR</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Thu Oct 28 2021 12:26:16 GMT-0700 (Pacific Daylight Time)">19:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@dereknongeneric:mozilla.org">DerekNonGeneric</span>&gt;</div></td><td class="msg-cell"><span class="nick-11">Andreu Botella (he/they)</span>: tbh, i was not the one who originally contributed that error so it's hard for me to know what alternatives were considered to shipping that, but think that we needed to work around the problem we had w/ the <code>AbortController</code> error (<code>AbortError</code>) not existing..</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Thu Oct 28 2021 12:27:28 GMT-0700 (Pacific Daylight Time)">19:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@dereknongeneric:mozilla.org">DerekNonGeneric</span>&gt;</div></td><td class="msg-cell"><blockquote>
When <code>abort()</code> is called, the <code>fetch()</code> promise rejects with an Error of type <code>DOMException</code>, with name <code>AbortError</code> <a href="https://developer.mozilla.org/en-US/docs/Web/API/AbortController/abort">https://developer.mozilla.org/en-US/docs/Web/API/AbortController/abort</a>
</blockquote>
</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Thu Oct 28 2021 12:31:01 GMT-0700 (Pacific Daylight Time)">19:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@dereknongeneric:mozilla.org">DerekNonGeneric</span>&gt;</div></td><td class="msg-cell">still a bit surprised about what we shipped for <code>structuredClone()</code> and am not sure how more people didn't asked more questions about that lol</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Thu Oct 28 2021 12:34:48 GMT-0700 (Pacific Daylight Time)">19:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@dereknongeneric:mozilla.org">DerekNonGeneric</span>&gt;</div></td><td class="msg-cell">we will probably need to use <code>isPlatformObject()</code> to detect whether the deserialized object we are outputting is all correct when implementing the next iteration (hopefully standardized) version of <code>structuredClone()</code> if the discuss i was reading made any sense <a href="https://github.com/tc39/ecma262/issues/2555">https://github.com/tc39/ecma262/issues/2555</a></td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Thu Oct 28 2021 12:39:02 GMT-0700 (Pacific Daylight Time)">19:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@dereknongeneric:mozilla.org">DerekNonGeneric</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I'm not sure how Node does things, but I've been looking into implementing serializable platform objects in Deno, and V8 requires you to have at least one internal field before it lets you define a custom serialization.</blockquote></mx-reply>um, not sure about whether or not we have plans to make any more "platform objects", but my goal is really just to ensure that the couple we have so far are actually implemented correctly since atm i have very low confidence that those aren't potemkin villagers</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Thu Oct 28 2021 12:40:30 GMT-0700 (Pacific Daylight Time)">19:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@andreubotella:mozilla.org">Andreu Botella (he/they)</span>&gt;</div></td><td class="msg-cell">The thing with V8's implementation of structured clone is that the delegate methods that let you override (de)serialization are only called for objects with internal slots</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Thu Oct 28 2021 12:40:41 GMT-0700 (Pacific Daylight Time)">19:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@andreubotella:mozilla.org">Andreu Botella (he/they)</span>&gt;</div></td><td class="msg-cell">so effectively V8 already implements its own kind of platform object determination</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Thu Oct 28 2021 12:40:51 GMT-0700 (Pacific Daylight Time)">19:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@andreubotella:mozilla.org">Andreu Botella (he/they)</span>&gt;</div></td><td class="msg-cell">see this bug <span class="nick-3">Luca Casonato</span> filed: <a href="https://bugs.chromium.org/p/v8/issues/detail?id=11927">https://bugs.chromium.org/p/v8/issues/detail?id=11927</a></td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Thu Oct 28 2021 12:48:28 GMT-0700 (Pacific Daylight Time)">19:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@dereknongeneric:mozilla.org">DerekNonGeneric</span>&gt;</div></td><td class="msg-cell">ooh, nice, you are sort of making the case for adding more of these in that issue, but definitely going to be having users running code in some kind of hybrid franken-environment</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Thu Oct 28 2021 15:01:59 GMT-0700 (Pacific Daylight Time)">22:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@dereknongeneric:mozilla.org">DerekNonGeneric</span>&gt;</div></td><td class="msg-cell"><span class="nick-11">Andreu Botella (he/they)</span>, <span class="nick-3">Luca Casonato</span> : not too familiar w/ the problem you all are facing, but maybe we can leverage <code>isV8IntrinsicIdentifier</code> to at least ensure that those bases are covered and then gradually append the Web IDL type identifiers as we make  use of <a href="https://babeljs.io/docs/en/babel-types#v8intrinsicidentifier">https://babeljs.io/docs/en/babel-types#v8intrinsicidentifier</a></td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Thu Oct 28 2021 15:19:42 GMT-0700 (Pacific Daylight Time)">22:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@dereknongeneric:mozilla.org">DerekNonGeneric</span>&gt;</div></td><td class="msg-cell">so, it might just be a union of the identifiers supplied by that predicate and then some other predicate that includes these identifiers listed in Web IDL (?) <a href="https://webidl.spec.whatwg.org/#idl-types">https://webidl.spec.whatwg.org/#idl-types</a></td></tr>

</tbody></table></div></div></div>
</body></html>