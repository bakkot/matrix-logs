<!DOCTYPE html><html><head>
  <title>WHATWG on 2021-11-23</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "WHATWG";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">WHATWG<br>2021-11-23<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2021-11-22" class="nav-link"><span>prev</span></a>
<span style="float:right">next</span>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>
<input type="text" id="query" size="25" placeholder="Search WHATWG">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Mon Nov 22 2021 18:17:41 GMT-0800 (Pacific Standard Time)">02:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@sefeng:mozilla.org">sefeng</span>&gt;</div></td><td class="msg-cell"><span class="nick-1">Domenic</span>: should <a href="https://github.com/web-platform-tests/wpt/blob/628af0fd55db95d785a63484882998343e3a069e/html/semantics/interactive-elements/the-dialog-element/dialog-focus-shadow.html#L40-L47">https://github.com/web-platform-tests/wpt/blob/628af0fd55db95d785a63484882998343e3a069e/html/semantics/interactive-elements/the-dialog-element/dialog-focus-shadow.html#L40-L47</a> focus an element inside the shadow dom?</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Mon Nov 22 2021 18:18:57 GMT-0800 (Pacific Standard Time)">02:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@sefeng:mozilla.org">sefeng</span>&gt;</div></td><td class="msg-cell">because the shadow dom is before the <code>focus-me</code>?</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Mon Nov 22 2021 18:19:40 GMT-0800 (Pacific Standard Time)">02:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</div></td><td class="msg-cell"><span class="nick-8">sefeng</span>: Yes I think you are right</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Mon Nov 22 2021 18:20:02 GMT-0800 (Pacific Standard Time)">02:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</div></td><td class="msg-cell">focus-me should be moved to the very first button</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Mon Nov 22 2021 18:21:03 GMT-0800 (Pacific Standard Time)">02:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@sefeng:mozilla.org">sefeng</span>&gt;</div></td><td class="msg-cell"><span class="nick-1">Domenic</span>: we don't need to move this one, because the one before this template does that already, I think?</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Mon Nov 22 2021 18:22:12 GMT-0800 (Pacific Standard Time)">02:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</div></td><td class="msg-cell">Not sure what you mean? I think the test would still be valuable since it shows that autofocus="" is ignored</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Mon Nov 22 2021 18:22:27 GMT-0800 (Pacific Standard Time)">02:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@sefeng:mozilla.org">sefeng</span>&gt;</div></td><td class="msg-cell">yeah, sorry, I misunderstood </td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Mon Nov 22 2021 18:22:50 GMT-0800 (Pacific Standard Time)">02:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@sefeng:mozilla.org">sefeng</span>&gt;</div></td><td class="msg-cell">I'll fix it and ping you for review </td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Mon Nov 22 2021 18:23:18 GMT-0800 (Pacific Standard Time)">02:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</div></td><td class="msg-cell">Great, thank you for spotting!</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Mon Nov 22 2021 18:37:56 GMT-0800 (Pacific Standard Time)">02:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@sefeng:mozilla.org">sefeng</span>&gt;</div></td><td class="msg-cell"><span class="nick-1">Domenic</span>: so before all these generic focus delegates algorithm, when there's a nested shadow dom host with no delegates focus, we don't delegate the focus to this shadow dom.</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Mon Nov 22 2021 18:38:35 GMT-0800 (Pacific Standard Time)">02:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@sefeng:mozilla.org">sefeng</span>&gt;</div></td><td class="msg-cell">but now it seems that we can delegate the focus to this shadow dom </td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Mon Nov 22 2021 18:48:55 GMT-0800 (Pacific Standard Time)">02:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@sefeng:mozilla.org">sefeng</span>&gt;</div></td><td class="msg-cell">I am looking at these two tests <a href="https://github.com/web-platform-tests/wpt/blob/628af0fd55db95d785a63484882998343e3a069e/shadow-dom/focus/focus-method-delegatesFocus.html#L271-L284">https://github.com/web-platform-tests/wpt/blob/628af0fd55db95d785a63484882998343e3a069e/shadow-dom/focus/focus-method-delegatesFocus.html#L271-L284</a> and wondering which step makes the behaviour different </td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Tue Nov 23 2021 01:28:58 GMT-0800 (Pacific Standard Time)">09:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@rdeltour:matrix.org">rdeltour</span>&gt;</div></td><td class="msg-cell">Hi. I have a couple questions on how to integrate the URL standard in a specification (ping <span class="nick-12">annevk</span> I guess ðŸ˜Š)</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Tue Nov 23 2021 01:32:55 GMT-0800 (Pacific Standard Time)">09:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@rdeltour:matrix.org">rdeltour</span>&gt;</div></td><td class="msg-cell">In EPUB, we now refer to the URL standard. 
EPUB is basically a collection of web resources in an container (called "Abstract OCF Container"); practically, it's a ZIP.
In this container, files refer to each other using relative URL strings (with optional fragments)</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Tue Nov 23 2021 01:34:08 GMT-0800 (Pacific Standard Time)">09:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@rdeltour:matrix.org">rdeltour</span>&gt;</div></td><td class="msg-cell">What we'd like to do, is normatively disallow relative URL strings that "leak" outside the container. For instance "../../../../secret"</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Tue Nov 23 2021 01:36:21 GMT-0800 (Pacific Standard Time)">09:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@rdeltour:matrix.org">rdeltour</span>&gt;</div></td><td class="msg-cell">So we're trying to define what is a valid relative URL string in the context of EPUB.</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Tue Nov 23 2021 01:40:51 GMT-0800 (Pacific Standard Time)">09:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@rdeltour:matrix.org">rdeltour</span>&gt;</div></td><td class="msg-cell"><p>My question is: is it OK to say something along the lines of "in an EPUB container, a <strong>relative-URL string</strong> MUST be a <strong>container-relative URL string</strong>", and then define what we mean by <strong>container-relative URL string</strong>.</p>
<p>In other words, we're trying to override the definition of "relative-URL string" of the URL standard by:</p>
<ul>
<li>disallowing path-absolute URL strings</li>
<li>disallowing scheme-relative URL strings</li>
<li>further constraining path-relative-scheme-less-URL strings to ensure dot-dot path segments are balanced by other segments</li>
</ul>
</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Tue Nov 23 2021 01:42:08 GMT-0800 (Pacific Standard Time)">09:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@rdeltour:matrix.org">rdeltour</span>&gt;</div></td><td class="msg-cell">In some way it has a smell of monkey patching, but I can't see how to do otherwise. That's why I'm asking for advice to y'all ðŸ˜Š</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Tue Nov 23 2021 01:44:05 GMT-0800 (Pacific Standard Time)">09:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@rdeltour:matrix.org">rdeltour</span>&gt;</div></td><td class="msg-cell">see also <a href="https://github.com/w3c/epub-specs/issues/1912">https://github.com/w3c/epub-specs/issues/1912</a></td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Tue Nov 23 2021 01:50:24 GMT-0800 (Pacific Standard Time)">09:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:mozilla.org">annevk</span>&gt;</div></td><td class="msg-cell"><span class="nick-3">rdeltour</span>: have you checked what implementations do? If there is some kind of base URL in play I'd expect it to work similarly to <code><a href="https://example.com/../">https://example.com/../</a></code></td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Tue Nov 23 2021 01:51:18 GMT-0800 (Pacific Standard Time)">09:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:mozilla.org">annevk</span>&gt;</div></td><td class="msg-cell">I suppose you could still have a desire to say that's invalid, but it isn't invalid for similar URLs in other contexts (if I remember correctly)</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Tue Nov 23 2021 01:52:35 GMT-0800 (Pacific Standard Time)">09:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@rdeltour:matrix.org">rdeltour</span>&gt;</div></td><td class="msg-cell">so, implementations vary (EPUB is old and this was largely unspecified so far). We added a UA conformance criteria to specify how the implementation-specific base URL must be. But here we're trying to define authoring requirements (what string is conforming or not, before parsing)</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Tue Nov 23 2021 01:54:09 GMT-0800 (Pacific Standard Time)">09:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@rdeltour:matrix.org">rdeltour</span>&gt;</div></td><td class="msg-cell">a conforming UA will parse '../../secret'  to the same URL record as 'secret', but we'd still like to disallow the former, for better interop with legacy or non-conforming UAs.</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Tue Nov 23 2021 01:56:16 GMT-0800 (Pacific Standard Time)">09:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:mozilla.org">annevk</span>&gt;</div></td><td class="msg-cell">It seems somewhat reasonable to write such a requirement the way you proposed above. The one quibble is that URL validity is also part of the URL parser and you wouldn't really be able to change that. (It's written in two different ways for different audiences.)</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Tue Nov 23 2021 01:57:18 GMT-0800 (Pacific Standard Time)">09:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:mozilla.org">annevk</span>&gt;</div></td><td class="msg-cell">It also seems that long term the requirement would be moot, so maybe it's easier to just explain the situation in a note and strongly encourage folks not to create such URL strings.</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Tue Nov 23 2021 02:03:36 GMT-0800 (Pacific Standard Time)">10:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@rdeltour:matrix.org">rdeltour</span>&gt;</div></td><td class="msg-cell">OK good. Yeah, we're only talking of subsetting valid URL strings, so the URL parser would still return an expected result. That it doesn't produce a validation error on some of EPUB-non-conforming strings is acceptable.

As for explaining all that in a note: that's what we do in the current WD; but that requirement was normative before, and EPUB is a slow world so I believe we a normative definition makes more sense.</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Tue Nov 23 2021 02:07:30 GMT-0800 (Pacific Standard Time)">10:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@rdeltour:matrix.org">rdeltour</span>&gt;</div></td><td class="msg-cell"><p>I have another question if I may.<br>Essentially for testing if a URL string is conforming I'm proposing the following (simplified) algo:</p>
<ol>
<li>if not a path-relative-scheme-less-URL string, return false</li>
<li>if the result of parsing <em>url</em> with "<a href="http://example.org/A/&quot;">http://example.org/A/"</a>; does not start with "<a href="http://example.org/A/&quot;">http://example.org/A/"</a>;, return false</li>
<li>if the result of parsing <em>url</em> with "<a href="http://example.org/B/&quot;">http://example.org/B/"</a>; does not start with "<a href="http://example.org/B/&quot;">http://example.org/B/"</a>;, return false</li>
<li>return true</li>
</ol>
</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Tue Nov 23 2021 02:08:44 GMT-0800 (Pacific Standard Time)">10:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@rdeltour:matrix.org">rdeltour</span>&gt;</div></td><td class="msg-cell">the use of test URLs is somewhat inelegant, but is simpler than redefining a custom parsing algo for counting that dot-dot path segments are balanced by other segments.</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Tue Nov 23 2021 02:09:33 GMT-0800 (Pacific Standard Time)">10:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@rdeltour:matrix.org">rdeltour</span>&gt;</div></td><td class="msg-cell">any advice or comment ?</td></tr>

</tbody></table></div></div></div>
</body></html>