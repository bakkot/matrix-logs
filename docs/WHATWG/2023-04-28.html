<!DOCTYPE html><html><head>
  <title>WHATWG on 2023-04-28</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "WHATWG";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">WHATWG<br>2023-04-28<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2023-04-27" class="nav-link"><span>prev</span></a>
<span style="float:right">next</span>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search WHATWG">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Thu Apr 27 2023 22:28:20 GMT-0700 (Pacific Daylight Time)">05:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell"><span class="nick-7">jugglinmike</span>: maybe share it here first? I don't really see how that thread won't continue to generate noise if we reopen it</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Thu Apr 27 2023 22:28:55 GMT-0700 (Pacific Daylight Time)">05:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell">And it's not like we really govern <code>file:</code> fetching to begin with, it's pretty explicitly undefined</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Thu Apr 27 2023 23:10:57 GMT-0700 (Pacific Daylight Time)">06:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">annevk</span>: any further thoughts on naming for <a href="https://github.com/WICG/navigation-api/issues/225#issuecomment-1527039396">https://github.com/WICG/navigation-api/issues/225#issuecomment-1527039396</a> ? <code>sourceElement</code> vs. <code>triggerElement</code> vs. <code>triggeringElement</code> is my current set of favorites.</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Thu Apr 27 2023 23:42:01 GMT-0700 (Pacific Daylight Time)">06:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell"><span class="nick-1">Domenic</span>: I added my not-naming thoughts from the offline conversation, but also commented on naming</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Fri Apr 28 2023 04:06:46 GMT-0700 (Pacific Daylight Time)">11:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@sideshowbarker:matrix.org">sideshowbarker</span>&gt;</div></td><td class="msg-cell">Does the Chromium project have a position on <a href="https://w3c.github.io/audio-session/">Audio Session</a>?</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Fri Apr 28 2023 06:12:23 GMT-0700 (Pacific Daylight Time)">13:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domfarolino:matrix.org">Dominic Farolino</span>&gt;</div></td><td class="msg-cell">In spec land, is it possible to call a callback with an infra struct, as opposed to a [=new=] WebIDL object, and have WebIDL [=convert=] that to an appropriate ES object for consumption by JS? Or do you actually have to pass in a [=new=]ly constructed WebIDL interface, since WebIDL only knows how to convert <em>those</em> to appropriate ES objects?</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Fri Apr 28 2023 06:15:08 GMT-0700 (Pacific Daylight Time)">13:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> In spec land, is it possible to call a callback with an infra struct, as opposed to a [=new=] WebIDL object, and have WebIDL [=convert=] that to an appropriate ES object for consumption by JS? Or do you actually have to pass in a [=new=]ly constructed WebIDL interface, since WebIDL only knows how to convert <em>those</em> to appropriate ES objects?</blockquote></mx-reply>You are supposed to call a callback with a Web IDL object, which could be an infra map representing a dictionary, but if it's an interface you want, yeah there's no way to get an interface without [=new=]ing one.</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Fri Apr 28 2023 06:17:35 GMT-0700 (Pacific Daylight Time)">13:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domfarolino:matrix.org">Dominic Farolino</span>&gt;</div></td><td class="msg-cell">Thanks, I think in the spec I'm reviewing passing an infra map should suffice, provided the values are mutable (JS can change them and we can read them after the callback is done) though I'm not sure how common that pattern is</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Fri Apr 28 2023 06:30:19 GMT-0700 (Pacific Daylight Time)">13:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</div></td><td class="msg-cell">The values are not mutable; the conversion process performs a copy when constructing the ES object, and you do not have a handle to that ES object</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Fri Apr 28 2023 06:31:04 GMT-0700 (Pacific Daylight Time)">13:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domfarolino:matrix.org">Dominic Farolino</span>&gt;</div></td><td class="msg-cell">OK that makes sense.</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Fri Apr 28 2023 06:31:35 GMT-0700 (Pacific Daylight Time)">13:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</div></td><td class="msg-cell">If you get an arbitrary ES object back, you can try to convert it to a dictionary (or record) again, and that will handle all the pathological cases like what if the author installed a throwing getter on a property you care about or some property with the wrong type value or similar</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Fri Apr 28 2023 06:35:08 GMT-0700 (Pacific Daylight Time)">13:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domfarolino:matrix.org">Dominic Farolino</span>&gt;</div></td><td class="msg-cell">"get an arbitrary ES object back" &gt; what mechanism would I get one back by, something like a callback that lets the user invoke a function with a dictionary of populated values?</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Fri Apr 28 2023 06:39:09 GMT-0700 (Pacific Daylight Time)">13:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domfarolino:matrix.org">Dominic Farolino</span>&gt;</div></td><td class="msg-cell">Can you even pass a callback fn (for JS to invoke) as an argument to a callback fn (that specs invoke to run JS)?</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Fri Apr 28 2023 06:39:57 GMT-0700 (Pacific Daylight Time)">13:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</div></td><td class="msg-cell">I mean I don't know, I thought you were reviewing an existing API. What does code that uses the existing API look like/how is it supposed to work?</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Fri Apr 28 2023 06:40:27 GMT-0700 (Pacific Daylight Time)">13:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</div></td><td class="msg-cell">(Like, example JS code)</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Fri Apr 28 2023 06:44:27 GMT-0700 (Pacific Daylight Time)">13:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domfarolino:matrix.org">Dominic Farolino</span>&gt;</div></td><td class="msg-cell"><p>New spec/new API. It's not pretty, I'm trying to land on something sensible.</p>
<pre><code>function generateBid(foo, bar, baz) { // This will get invoked by the browser
  const bidValue = [compute a value based on foo/bar/baz];
  setBid(bidValue);

  const priorityValue = [compute priority based on foo/bar/baz];
  setPriority(priorityValue);
}
</code></pre>
<p>Caveat is: <code>setBid</code> and <code>setPriority</code> functions should only ever exist <em>inside</em> that generateBid() user-supplied fn</p>
</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Fri Apr 28 2023 06:45:00 GMT-0700 (Pacific Daylight Time)">13:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domfarolino:matrix.org">Dominic Farolino</span>&gt;</div></td><td class="msg-cell">So I'd like to pass in a <code>setBid()</code> and <code>setPriority()</code> function directly as an argument alongside foo/bar/baz, so that those fns can literally only be called <em>inside</em> generateBid()</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Fri Apr 28 2023 06:45:20 GMT-0700 (Pacific Daylight Time)">13:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domfarolino:matrix.org">Dominic Farolino</span>&gt;</div></td><td class="msg-cell">But I'm not sure how to pass in "a function that does THIS" (called setBid()), and so on.</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Fri Apr 28 2023 06:45:39 GMT-0700 (Pacific Daylight Time)">13:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domfarolino:matrix.org">Dominic Farolino</span>&gt;</div></td><td class="msg-cell">Personally I'd like to pass (to generateBid()) in an <em>interface</em> that has a setBid() and setPriority() methods</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Fri Apr 28 2023 06:45:53 GMT-0700 (Pacific Daylight Time)">13:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</div></td><td class="msg-cell">Got it. You can do that either with callback functions, or if you want to put those two callback functions on an interface that would also work.</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Fri Apr 28 2023 06:46:06 GMT-0700 (Pacific Daylight Time)">13:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</div></td><td class="msg-cell">To create callback functions that have specific behavior, let me find an example...</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Fri Apr 28 2023 06:46:34 GMT-0700 (Pacific Daylight Time)">13:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domfarolino:matrix.org">Dominic Farolino</span>&gt;</div></td><td class="msg-cell">Yeah that's what I've been looking for on WebDex but I only see them go the other way: callbacks that JS passes into spec code, that specs invoke later</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Fri Apr 28 2023 06:47:04 GMT-0700 (Pacific Daylight Time)">13:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</div></td><td class="msg-cell">Pretty sure onxyz's are an example</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Fri Apr 28 2023 06:47:39 GMT-0700 (Pacific Daylight Time)">13:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</div></td><td class="msg-cell">Yeah. It's not pretty, you manually construct a JS Function object and then wrap it. <a href="https://html.spec.whatwg.org/#getting-the-current-value-of-the-event-handler">https://html.spec.whatwg.org/#getting-the-current-value-of-the-event-handler</a></td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Fri Apr 28 2023 06:48:07 GMT-0700 (Pacific Daylight Time)">13:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</div></td><td class="msg-cell">Steps 3.8-12</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Fri Apr 28 2023 06:48:33 GMT-0700 (Pacific Daylight Time)">13:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</div></td><td class="msg-cell">Step 3.11 is probably not necessary in your case</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Fri Apr 28 2023 06:49:09 GMT-0700 (Pacific Daylight Time)">13:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domfarolino:matrix.org">Dominic Farolino</span>&gt;</div></td><td class="msg-cell">I agree with all of that. Thanks a lot for the example, it is exactly as I feared :)</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Fri Apr 28 2023 06:49:17 GMT-0700 (Pacific Daylight Time)">13:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domfarolino:matrix.org">Dominic Farolino</span>&gt;</div></td><td class="msg-cell">interface with methods would be much nicer</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Fri Apr 28 2023 06:49:23 GMT-0700 (Pacific Daylight Time)">13:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</div></td><td class="msg-cell">But creating an interface might be easier and perhaps nicer for authors, as a signature of (foo, bar, baz, setBid, setPriority) feels a bit more confusing than (foo, bar, baz, controller) or ([foo, bar, baz], controller)</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Fri Apr 28 2023 06:49:25 GMT-0700 (Pacific Daylight Time)">13:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domfarolino:matrix.org">Dominic Farolino</span>&gt;</div></td><td class="msg-cell">I fear that ship has sailed though</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Fri Apr 28 2023 06:52:58 GMT-0700 (Pacific Daylight Time)">13:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</div></td><td class="msg-cell">Hmm that example is likely not exactly what you want because OrdinaryFunctionCreate is for parsed source code</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Fri Apr 28 2023 06:53:49 GMT-0700 (Pacific Daylight Time)">13:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</div></td><td class="msg-cell">Ah yeah you want <a href="https://tc39.es/ecma262/multipage/ordinary-and-exotic-objects-behaviours.html#sec-createbuiltinfunction">https://tc39.es/ecma262/multipage/ordinary-and-exotic-objects-behaviours.html#sec-createbuiltinfunction</a></td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Fri Apr 28 2023 06:53:52 GMT-0700 (Pacific Daylight Time)">13:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</div></td><td class="msg-cell">As used often in Web IDL</td></tr>

</tbody></table></div></div></div>
</body></html>