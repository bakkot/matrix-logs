2022-02-01
[13:07:04.0207] <Ian Hickson>
anyone know if we ever defined what headers should not be included in subsequent requests after a cross-origin HTTP redirect?

[14:59:15.0612] <Domenic>
> <@hixie:matrix.org> anyone know if we ever defined what headers should not be included in subsequent requests after a cross-origin HTTP redirect?

I see nothing relevant in https://fetch.spec.whatwg.org/#http-redirect-fetch . This might fall into the still-underspecified https://fetch.spec.whatwg.org/#:~:text=Modify%20httpRequest%E2%80%99s%20header%20list%20per%20HTTP.

[15:27:35.0811] <Ian Hickson>
yeah i couldn't find anything either

[15:28:32.0358] <Ian Hickson>
context is we're trying to figure out how the Dart HttpClient should be updated, but so far it seems the list of headers to skip is just something we copy from Curl or Chrome...


2022-02-02
[02:11:12.0714] <sideshowbarker>
What‚Äôs the current best-practice way to programmatically detect if a document is in a frame?

[04:24:40.0876] <Noam Rosenthal>
> <@sideshowbarker:mozilla.org> What‚Äôs the current best-practice way to programmatically detect if a document is in a frame?

I guess https://developer.mozilla.org/en-US/docs/Web/API/Window/frameElement ?

[04:52:55.0574] <Noam Rosenthal>
(I usually do something like `window.parent !== window.self` but `frameElement` feels more like a best practice)

[06:23:59.0236] <sideshowbarker>
Noam Rosenthal: thanks much

[07:02:25.0946] <Domenic>
> <@hixie:matrix.org> anyone know if we ever defined what headers should not be included in subsequent requests after a cross-origin HTTP redirect?

Not sure how I missed this yesterday but a coworker pointed me to https://fetch.spec.whatwg.org/#http-redirect-fetch step 11. So basically remove https://fetch.spec.whatwg.org/#request-body-header-name

[08:51:47.0062] <smaug>
jgraham: in wpt, is there a way to test behavior when alert() pops up?

[08:51:55.0421] <smaug>
or basically, is there a way to close it?

[09:31:48.0426] <Noam Rosenthal>
smaug: seems like WebDriver has support for this, but it's not patched through to testdriver and not used in tests. Shouldn't be difficult to accomplish IMO. But maybe jgraham has more context (or others at #wpt:matrix.org)

[11:07:30.0365] <Ian Hickson>
> <@domenicdenicola:matrix.org> Not sure how I missed this yesterday but a coworker pointed me to https://fetch.spec.whatwg.org/#http-redirect-fetch step 11. So basically remove https://fetch.spec.whatwg.org/#request-body-header-name

oh interesting. but that doesn't include things like Set-Cookie and Authorization?

[11:08:10.0127] <Domenic>
Right so removing credentials is conditional on your credentials mode being "same-origin", let's find that...

[11:09:10.0189] <Domenic>
Those two are only conditionally included in step 20 of https://fetch.spec.whatwg.org/#concept-http-network-or-cache-fetch based on several pieces of input

[11:46:08.0641] <jgraham>
smaug, Noam Rosenthal I think the way that the wpt harness uses WebDriver makes it quite hard to test alert behaviour; that probabaly requires WebDriver-BiDi

[12:01:35.0565] <Ian Hickson>
> <@domenicdenicola:matrix.org> Those two are only conditionally included in step 20 of https://fetch.spec.whatwg.org/#concept-http-network-or-cache-fetch based on several pieces of input

i might just be rusty in my spec-fu but i have to say i can't really figure out how to point someone to this spec in a sufficiently clear way to explain what headers they should include when :-(
like, https://curl.se/docs/CVE-2018-1000007.html removes Authorization during a redirect, but is that all we should remove?

[13:20:56.0091] <Domenic>
I mean the intention isn't just to give people answers to "what HTTP headers to remove during a redirect", it's to give "if you want to build a browser-compatible fetch algorithm here is step-by-step how to do it"

[13:21:11.0063] <Domenic>
And so in particular part of that is only adding in Authorization or Set-Cookie under certain conditions

[13:21:55.0237] <Domenic>
Whether that particular algorithm is applicable to non-browser software, yeah, unclear.

[13:32:07.0582] <Arya Mulya>
Hii guys hello 


[15:13:24.0691] <sideshowbarker>
Odd https://stackoverflow.com/questions/70963287/youtube-is-blocking-javascript-execution-for-around-10-seconds

[15:28:52.0686] <Luca Casonato>
Does anyone here know if Joshua Bell (IndexedDB editor) is on matrix? I can also email, but I don't know what is @google.com/@chromium.com address is. If anyone knows his email, would be great if you could DM it to me :-)

[15:31:54.0644] <Domenic>
> <@lucacasonato:matrix.org> Does anyone here know if Joshua Bell (IndexedDB editor) is on matrix? I can also email, but I don't know what is @google.com/@chromium.com address is. If anyone knows his email, would be great if you could DM it to me :-)

If you hover over his name in https://w3c.github.io/IndexedDB/ the email is there :)

[15:49:04.0715] <Luca Casonato>
> <@domenicdenicola:matrix.org> If you hover over his name in https://w3c.github.io/IndexedDB/ the email is there :)

ah! didn't know that. thank you :-)


2022-02-03
[15:51:30.0577] <zcorpan>
should I assume that the wattsi server error is intermittent? https://github.com/whatwg/html/pull/5462


2022-02-04
[17:11:19.0459] <Domenic>
> <@zcorpan_:matrix.org> should I assume that the wattsi server error is intermittent? https://github.com/whatwg/html/pull/5462

Probably, yes.

[17:11:33.0743] <Domenic>
It is probably just https://github.com/whatwg/build.whatwg.org/issues/19

[17:13:26.0726] <Domenic>
Hmm the logging I added did not seem to show up, I wonder what's the deal there...


2022-02-05
[13:41:03.0547] <Cory>
right place to ask a spec question/comment? this is about selecting and copying arbitrary text from an html page. 

often, content and styling makes sense for the screen, but doesn't translate when pasted as plain-text.

as an example, if i copy those room notifications immediately above ===^ it will paste the text "Today" instead of a timestamp.

the img tag has the alt attribute which (among other things) provides a text representation for the clipboard -- has there ever been any discussion around expanding that to a global element attribute? or providing a mechanism for helping the browser convert an arbitrary selection on the page to plain text (without having to use js)?

[13:43:16.0151] <Andreu Botella>
something that doesn't require JS, I don't know, but you can customize what gets copied into the clipboard with the clipboard API

[13:43:19.0234] <Andreu Botella>
https://www.w3.org/TR/clipboard-apis

[13:51:00.0550] <Cory>
that's great for specialized situations but creating something that allows arbitrary selections would be difficult.  ...and i guess expanding alt to non-images would be difficult for the same reasons, like partial selections.  i donno. copying/pasting text from pages sucks though, ha


2022-02-07
[22:57:27.0484] <sideshowbarker>
> <@noamr:matrix.org> I guess https://developer.mozilla.org/en-US/docs/Web/API/Window/frameElement ?

so I‚Äôm now realizing that while that seems to work in some cases of cross-origin iframes, it returns null in others

[22:57:57.0352] <Noam Rosenthal>
> <@sideshowbarker:mozilla.org> so I‚Äôm now realizing that while that seems to work in some cases of cross-origin iframes, it returns null in others

yea this is not for cross-origin

[22:58:53.0464] <sideshowbarker>
yeah I thought it _never_ worked cross-origin ‚Äî but then I found for the case of the iframe at the end of https://developer.mozilla.org/en-US/docs/Web/API/Notifications_API/Using_the_Notifications_API#replacing_existing_notifications it did actually seem to work

[22:59:03.0906] <sideshowbarker>
but maybe I was just testing it wrong

[22:59:41.0476] <sideshowbarker>
anyway, reverting to just the usual `window.self !== window.top` 

[23:01:12.0292] <sideshowbarker>
oh, cool to see there‚Äôs a `.top` TLD now ‚Äî¬†recursively appropriate‚Ä¶

[23:01:56.0977] <sideshowbarker>
makes for some good fun and confusion for any technical writer who has to document it

[23:02:20.0327] <sideshowbarker>
kind of a ‚ÄúWho‚Äôs on first?‚Äù thing

[23:02:35.0945] <sideshowbarker>
‚Äúthe top top-level domain‚Äú

[23:02:53.0312] <sideshowbarker>
or ‚Äútop top‚Äù for short

[00:07:10.0484] <annevk>
`frameElement` can only work cross-origin when `document.domain` is involved and the documents are same-site. If you find it does something in other cases I'd love to see a testcase.

[00:21:00.0720] <sideshowbarker>
> <@annevk:mozilla.org> `frameElement` can only work cross-origin when `document.domain` is involved and the documents are same-site. If you find it does something in other cases I'd love to see a testcase.

probably I just made a mistake, when I thought I had it working with the one case

[00:21:08.0502] <sideshowbarker>
I will re-try it and see 

[00:45:55.0636] <annevk>
Domenic: Yoav Weiss: shouldn't the introduction of new browsing contexts be done in a bit more coordinated manner? Re: https://groups.google.com/a/chromium.org/g/blink-dev/c/jr2fQUh6xEI/m/Oqge6pPtAAAJ

[01:03:02.0873] <Yoav Weiss>
annevk: Potentially... This effort is still in very early stages AFAIK. I think it'd be helpful for the team if you chimed in on that thread to say what you'd like to see defined for this to be interoperable.

[01:14:42.0137] <sideshowbarker>
> <@annevk:mozilla.org> `frameElement` can only work cross-origin when `document.domain` is involved and the documents are same-site. If you find it does something in other cases I'd love to see a testcase.

so yeah, for the record here, I was mistaken ‚Äî it wasn‚Äôt working cross-origin (I just thought it was) Noam Rosenthal 

[03:25:23.0637] <Luca Casonato>
Jake Archibald: I don't want to be a bother, but have you been able to take a look at this? Trying to judge if Chrome would be opposed to this in any way.

[03:25:33.0321] <Luca Casonato>
> <@annevk:mozilla.org> Jake Archibald: have you ever seen service workers create JSON responses? Trying to figure out browser interest for https://github.com/whatwg/fetch/issues/1389

 * Jake Archibald: I don't want to be a bother, but have you been able to take a look at this? Trying to judge if Chrome would be opposed to this in any way.

[04:44:55.0777] <Ms2ger üíâüíâ>
Yoav Weiss: hey, do you know if you'll have time soonish to review https://github.com/w3c/resource-timing/pull/302 https://github.com/w3c/server-timing/pull/84 ?

