2022-01-01
[19:04:44.0380] <EveryOS>
If I were in charge of the web, I'd probably tell GitHub to change GitHub pages or they'd be left behind
(It's probably a good thing I'm not in charge of the web)

[09:09:38.0243] <devsrealmguy>
Hi people, hope you are having a good day. I have a question, how would one unit test the correctness of an HTML parser, should I just find several malformed html pages and test against what Chrome or Mozilla parses in the browser, I'll also appreciate it there are links to test cases, e.g if you have so so so malformed structure, you get the following output, something like that. I have seen few but I need more to test rigorously. Thanks

[09:15:25.0029] <Alan Stearns>
devsrealmguy: you may get a better response on https://matrix.to/#/#wpt:matrix.org (though there is a lot of shared people between these rooms)

[09:16:22.0205] <devsrealmguy>
Thanks, I'll join the room now

[11:13:27.0681] <Luca Casonato>
annevk Am I correct in my interpretation that `Foo: abc, xyz\r\n` and `Foo: abc\r\nFoo: xyz\r\n` are both fetch spec compliant on the wire encodings for a request issued with `fetch` as follows?
```js
fetch(url, { headers: [["Foo", "abc"], ["Foo", "xyz"]] })
```


2022-01-02
[07:31:45.0943] <sideshowbarker>
https://stackoverflow.com/questions/70553932/fetch-api-abort-doesnt-works-after-1st-cancel

[10:26:02.0682] <sideshowbarker>
I’m trying to clone an `SVGRect` object using `structuredClone()`, but am getting _DataCloneError: The object could not be cloned` error_ — because, I guess, the `SVGRect` object isn’t serializable.

[10:26:25.0558] <sideshowbarker>
But what part of it wouldn’t be serializable?

[10:28:39.0384] <sideshowbarker>
Specifically, what I have is an SVG `marker` element with a `viewBox` attribute, and I assign that to a `marker` variable, and when I log `console.log(marker.viewBox.baseVal), the browser logs this:
```js
[object SVGRect] {
  height: 10,
  width: 10,
  x: 0,
  y: 0
```

[10:30:04.0258] <sideshowbarker>
…but if I then do this:
```js
let foo = self.structuredClone(marker.viewBox.baseVal);
```
…it fails and that browser logs that _DataCloneError: The object could not be cloned_ 

[10:30:11.0671] <sideshowbarker>
 * …but if I then do this:
```js
let foo = self.structuredClone(marker.viewBox.baseVal);
```

…it fails and that browser logs that _DataCloneError: The object could not be cloned_ error

[10:30:22.0717] <sideshowbarker>
 * …but if I then do this:
```js
let foo = self.structuredClone(marker.viewBox.baseVal);
```

…it fails, and the browser logs that _DataCloneError: The object could not be cloned_ error

[10:30:34.0791] <sideshowbarker>
 * …but if I then do this:
```js
let foo = structuredClone(marker.viewBox.baseVal);
```

…it fails, and the browser logs that _DataCloneError: The object could not be cloned_ error

[10:32:21.0213] <sideshowbarker>
 * I’m trying to clone an `SVGRect` object using `structuredClone()`, but am getting a *DataCloneError: The object could not be cloned`error* — because, I guess, the`SVGRect` object isn’t serializable.

[10:32:43.0697] <sideshowbarker>
 * I’m trying to clone an `SVGRect` object using `structuredClone()`, but am getting a _DataCloneError: The object could not be cloned_ error — because, I guess, the`SVGRect` object isn’t serializable.

[11:59:02.0426] <sideshowbarker>
* …but if I then do this:
```js
let foo = structuredClone(marker.viewBox.baseVal);
```

…it fails, and the browser logs that *DataCloneError: The object could not be cloned* error

[12:46:49.0240] <Andreu Botella (he/they)>
Web APIs are by default not serializable, even with `DOMRect`, which is as close to a plain object as it gets

[12:47:29.0258] <Andreu Botella (he/they)>
Maybe it'd be worth it to try and identify such interfaces

[12:55:26.0084] <sideshowbarker>
I see


2022-01-03
[16:17:11.0133] <Domenic>
It is kind of understandable that SVGRect is not serializable though. It is not a plain object; it has an inner connection to a SVG element. And serializing that across realm boundaries is tricky.

[16:17:23.0319] <Domenic>
DOMRect is very simple though and could be made serializable.

[16:17:51.0184] <Domenic>
I believe the spec still says SVGRect is simple but this was a misstep in the spec and they need to change it back to match implementations https://github.com/w3c/svgwg/issues/706

[16:17:54.0714] <Domenic>
We ran into this in jsdom

[16:18:35.0701] <Andreu Botella (he/they)>
TIL

