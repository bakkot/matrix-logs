2025-11-01
[23:58:59.0855] <Meghan Denny>
currently if you have multiple <details> with the same [name] the browser will treat the group as an accordion. github has this behavior where if you're on the page for a commit or the changed files of a pr and hold alt/option and then click the caret then all the dropdowns in the group with open/close together. is there an open issue for this/any interest?

[23:59:20.0838] <Meghan Denny>
* currently if you have multiple \<details> with the same \[name\] the browser will treat the group as an accordion. github has this behavior where if you're on the page for a commit or the changed files of a pr and hold alt/option and then click the caret then all the dropdowns in the group will open/close together. is there an open issue for this/any interest?

[00:03:48.0251] <sideshowbarker>
Sounds interesting to me (as someone who implemented the existing details@name accordion/grouping stuff in an engine)

[00:04:05.0084] <sideshowbarker>
‚Ä¶and there‚Äôs no existing open issue for it as far as I know

[00:04:16.0022] <sideshowbarker>
* ‚Ä¶and there‚Äôs no existing open spec issue for it as far as I know


2025-11-02
[15:51:33.0267] <Fi Ni Nh 0x>
is not what html6 should do to us, it is what ......HTML5 web3‚ùì 


2025-11-03
[06:28:22.0546] <Brian Cardarella>
are deprecated features tracked anywhere? For example, the MimeType and MimeTypeArray interfaces which are deprecated but I don't see represented in the current webref repo's IDL files. I presume deprecated interfaces are removed?

[06:29:27.0681] <Brian Cardarella>
well, it does look like they are in the html idl

[06:30:24.0663] <Brian Cardarella>
I guess the real question is are deprecated features expected to still be represented in the webref repo? 

[06:39:45.0000] <annevk>
Brian Cardarella: yes, everything that's defined should probably be in there. Maybe things can have annotations.


2025-11-04
[00:17:35.0475] <sideshowbarker>
`div` is now allowed as a descendant of `select`?

[00:17:38.0229] <sideshowbarker>
https://html.spec.whatwg.org/multipage/dom.html#select-element-inner-content-elements-2

[00:18:32.0451] <sideshowbarker>
The following are [select element inner content elements](https://html.spec.whatwg.org/multipage/dom.html#select-element-inner-content-elements-2):

    [option](https://html.spec.whatwg.org/multipage/form-elements.html#the-option-element)[optgroup](https://html.spec.whatwg.org/multipage/form-elements.html#the-optgroup-element)[hr](https://html.spec.whatwg.org/multipage/grouping-content.html#the-hr-element)[script-supporting elements](https://html.spec.whatwg.org/multipage/dom.html#script-supporting-elements-2)[noscript](https://html.spec.whatwg.org/multipage/scripting.html#the-noscript-element)[div](https://html.spec.whatwg.org/multipage/grouping-content.html#the-div-element)

[00:18:43.0621] <sideshowbarker>
* The following are [select element inner content elements](https://html.spec.whatwg.org/multipage/dom.html#select-element-inner-content-elements-2):

[option](https://html.spec.whatwg.org/multipage/form-elements.html#the-option-element)[optgroup](https://html.spec.whatwg.org/multipage/form-elements.html#the-optgroup-element)[hr](https://html.spec.whatwg.org/multipage/grouping-content.html#the-hr-element)[script-supporting elements](https://html.spec.whatwg.org/multipage/dom.html#script-supporting-elements-2)[noscript](https://html.spec.whatwg.org/multipage/scripting.html#the-noscript-element)[div](https://html.spec.whatwg.org/multipage/grouping-content.html#the-div-element)
```

[00:19:40.0764] <sideshowbarker>
*    
> The following are select element inner content elements:
>      * option
>      * optgroup
>      * hr
>      * script-supporting elements
>      * noscript
>      * div


[00:20:05.0746] <sideshowbarker>
Do current parsers actually support that?

[00:20:24.0711] <sideshowbarker>
The Gecko/validator.nu parser doesn‚Äôt seem to 

[00:23:00.0748] <sideshowbarker>
trying the HTML checker with this:
```html
<!doctype html><html lang=en><meta charset=utf-8>
<title>select with hr and div children</title>
<select id="theme-select">
  <option value="light">Light</option>
  <option value="dark">Dark</option>
  <hr>
  <div class="group-label">Custom themes</div>
  <option value="solarized">Solarized</option>
  <option value="dracula">Dracula</option>
</select>
```
I get parse-error messages:

"file:/Users/mike/workspace/validator/tests/html/elements/select/hr-and-div-children-isvalid.html":7.3-7.27: error: Stray start tag ‚Äúdiv‚Äù.
"file:/Users/mike/workspace/validator/tests/html/elements/select/hr-and-div-children-isvalid.html":7.3-7.40: error: Text not allowed in element ‚Äúselect‚Äù in this context.
"file:/Users/mike/workspace/validator/tests/html/elements/select/hr-and-div-children-isvalid.html":7.41-7.46: error: Stray end tag ‚Äúdiv‚Äù.

[00:23:47.0826] <sideshowbarker>
* trying the HTML checker with this:

```html
<!doctype html><html lang=en><meta charset=utf-8>
<title>select with hr and div children</title>
<select id="theme-select">
  <option value="light">Light</option>
  <option value="dark">Dark</option>
  <hr>
  <div class="group-label">Custom themes</div>
  <option value="solarized">Solarized</option>
  <option value="dracula">Dracula</option>
</select>
```

I get parse-error messages:

:7.3-7.27: error: Stray start tag ‚Äúdiv‚Äù.
:7.3-7.40: error: Text not allowed in element ‚Äúselect‚Äù in this context.
:7.41-7.46: error: Stray end tag ‚Äúdiv‚Äù.

[00:25:15.0190] <sideshowbarker>
hmm yeah also in Firefox ‚Äî the DOM looks like this:
```html
<select id="theme-select">
  <option value="light">Light</option>
  <option value="dark">Dark</option>
  <hr>
  Custom themes
  <option value="solarized">Solarized</option>
  <option value="dracula">Dracula</option>
</select>
```

[00:26:26.0013] <sideshowbarker>
hmm yeah same DOM in Safari ‚Äî¬†no `div` in the DOM

[00:27:15.0821] <annevk>
sideshowbarker: that's a very recent change; I think Chrome might have shipped it. I did implement these aspects in WebKit, but nothing shipped as-of-yet.

[00:27:33.0313] <sideshowbarker>
ah OK

[00:28:08.0061] <sideshowbarker>
so I guess I may need to implement in the vnu HTML parser ‚Äî or wait til Henri or somebody does

[00:28:35.0131] <sideshowbarker>
Do you know if there‚Äôs an open gecko bug for it?

[00:29:49.0896] <annevk>
sideshowbarker: https://bugzilla.mozilla.org/show_bug.cgi?id=1933591

[01:47:44.0977] <julienw>
incidentelly I've seen dl/dt/dd got similar changes too, but I haven't checked if that was implemented

[01:47:49.0895] <julienw>
* incidentaly I've seen dl/dt/dd got similar changes too, but I haven't checked if that was implemented

[01:58:17.0174] <annevk>
I think those were just conformance changes. The parser wasn't changed for those elements.

[05:07:14.0754] <Dominic Farolino>
annevk & smaug are we OK marking Menu Elements (https://github.com/whatwg/html/issues/11729) as stage 1? This was raised a few WHATNOTs ago

[05:28:22.0363] <annevk>
Dominic Farolino: okay from our side.

[06:05:17.0889] <smaug>
that is ok


2025-11-05
[23:13:32.0756] <annevk>
sideshowbarker: you around? The ‚ÄúRunning the HTML checker‚Ä¶‚Äù part of the WHATWG build pipeline is failing on a 404.

[23:14:02.0280] <annevk>
sideshowbarker: https://github.com/whatwg/compression/pull/79 and https://github.com/whatwg/cookiestore/pull/290

[23:30:03.0907] <annevk>
I suppose I can still merge and we just won't have validation this time around. I might do that given that these are overdue.

[01:55:56.0930] <annevk>
* I suppose I can still merge and we just won't have validation this time around. I might do that given that these are overdue. Edit: that does not work. sideshowbarker I need your help.

[02:57:46.0626] <sideshowbarker>
Here now. Will take a look right away as soon as I can (where as soon as I can is, after finishing up with usual evening responsibilities at home)

[04:22:48.0040] <zcorpan>
sideshowbarker: https://github.com/whatwg/whatwg.org/pull/476#issuecomment-3490878207

[04:27:27.0514] <sideshowbarker>
https://github.com/validator/validator/releases/tag/latest

[04:28:11.0229] <sideshowbarker>
But there are missing release assets there 

[04:32:07.0564] <sideshowbarker>
The releases are generated by a CI build ‚Äî from GitHub Actions ‚Äî that runs for every push to main

[04:33:13.0931] <sideshowbarker>
But for some reason, the last time it ran, it seems it didn't actually upload all the assets to where it should have

[04:34:27.0259] <sideshowbarker>
So I just now retriggered the GH Actions workflow for it, manually

[04:36:10.0810] <sideshowbarker>
‚Ä¶and now all the assets are there

[04:36:16.0978] <sideshowbarker>
https://github.com/validator/validator/releases/tag/latest

[04:36:40.0549] <sideshowbarker>
https://github.com/validator/validator/releases/download/latest/vnu.linux.zip

[04:38:39.0160] <sideshowbarker>
I'm away from my laptop still, so I haven't looked at the deploy.sh script. But can you remind me what the logic is in the case where it can't download the latest release?

[04:39:22.0883] <sideshowbarker>
Apparently it then makes a request to validator.nu?

[04:40:33.0704] <sideshowbarker>
If so, we should change that to have it fall back to validator.w3.org/nu instead

[04:48:29.0119] <annevk>
sideshowbarker: now that you fixed that it's all working again.

[13:50:07.0753] <Dominic Farolino>
Must all new content attributes be reflected by an IDL attribute? Is this a requirement anywhere?

[14:06:15.0645] <Luke Warlow>
> <@domfarolino:matrix.org> Must all new content attributes be reflected by an IDL attribute? Is this a requirement anywhere?

https://www.w3.org/TR/design-principles/#html-idl-must-by-synced 


2025-11-06
[02:53:42.0962] <Noam Rosenthal>
jjaschke (out until Dec 1), smaug, if you're around at TPAC we can perhaps do some navigation API whiteboarding to resolve some of the pending messy issues. I understand farre won't be there unfortunately. Anyone else who's around is welcome of course (e.g. Dominic Farolino)

[02:54:02.0054] <smaug>
I'll be there

[02:56:43.0135] <smaug>
I don't think wait-for-all is that messy. The spec is mostly good in that case, and API is part of interop, so "encouraging browsers to precisely match the web standards " üòâ  But yeah, that issue, and perhaps others too should be discussed.

[02:57:45.0604] <smaug>
And we should also discuss about that "encouraging browsers to precisely match the web standards " part.

[03:08:04.0988] <Noam Rosenthal>
It's messy when there is a divergence between WPTs and spec which in some cases begs the question of which one is correct. 

[03:09:39.0408] <Noam Rosenthal>
anyway, I saw that the process/meta question is already on the agenda requests but what I want is to spend a bit of time on the specifics and make sure we make the right decisions for users/web-devs.

[03:10:58.0868] <smaug>
Sure. 

[03:14:52.0583] <farre>
I must admit that I'm surprised by the amount of divergence

[03:18:19.0307] <Noam Rosenthal>
I wasn't involved when it was spec'ed/implemented but I remember that there was a huge hanging PR with a lot of details for quite a while, and the prototype was progressing alongside the spec. So it caught me by surprise as well but also it's not totally unexpected given the complexity of this API

[03:18:40.0115] <farre>
Or Session History and Navigation in genereal

[03:18:42.0090] <farre>
* Or Session History and Navigation in general

[03:21:11.0632] <Noam Rosenthal>
Yea exactly. I am curious as to whether this is an outlier or there are other recent examples of this kind of divergence/complexity. Answering this can help the meta conversation.

[04:26:45.0066] <smaug>
Trusted types was perhaps a bit similar, though there through some great collaboration specs and implementations got into a lot better shape. But it did mean filing spec issues and fixing them when the spec wasn't implementable and also writing tests following the spec, not the first implementation.

[04:36:47.0837] <Noam Rosenthal>
Yea I see that TrustedTypes landed in 2019, and there were some recent spec-alignment changes

[04:38:27.0628] <smaug>
"some" üôÇ And lots of new tests

[04:39:22.0376] <smaug>
(I can't thank Fr√©d√©ric enough for writing tons of tests)

[04:40:50.0794] <foolip>
annevk zcorpan Jake Archibald: Noam Rosenthal and I are working on `streamHTMLUnsafe()` and would like to use the stages process, and would like to move https://github.com/whatwg/html/issues/2142 to stage 1. (https://github.com/whatwg/html/issues/11669 is also very relevant, but we don't need two issues in the stages process I think.)

[05:43:53.0035] <zcorpan>
foolip: SGTM, maybe add to https://github.com/whatwg/html/issues/11711#issuecomment-3432130305 ?

[08:42:32.0513] <Dominic Farolino>
Yes definitely! Looking forward to this

[11:52:13.0509] <cwilso>
Draft WHATUP schedule posted :https://github.com/whatwg/html/issues/11711#issuecomment-3499143498

[11:52:26.0722] <cwilso>
Please let me know if you need changes, and there are still a few openings.

[12:56:09.0537] <nicolo-ribaudo>
If there is time available, could we also talk about https://github.com/whatwg/html/issues/11711#issuecomment-3481575249? :)

[15:48:02.0857] <cwilso>
Gaaah nicolo-ribaudo Andreu Botella (üïë JST, mostly off until Nov 10) I'm so sorry, I dropped that one.  Added in.

[15:48:36.0397] <cwilso>
Schedule updated with some slight changes per requests:
https://github.com/whatwg/html/issues/11711#issuecomment-3499143498


2025-11-10
[01:39:45.0328] <jjaschke (out until Dec 1) üáØüáµ>
Sure, I'm around and happy to discuss


2025-11-11
[16:46:03.0740] <cwilso>
Notes doc for WHATUP: https://docs.google.com/document/d/1XQLLjETtdBPv-xGiGPRALR4X7hgSb_Lk13bdBucEJ_g/edit?usp=sharing

[16:56:13.0453] <cwilso>
https://docs.google.com/document/d/1XQLLjETtdBPv-xGiGPRALR4X7hgSb_Lk13bdBucEJ_g/edit?tab=t.0#heading=h.51akrqmzup50
https://webirc.w3.org/?channels=WHATWG

[23:37:35.0012] <hsivonen>
Is scribing happening in a different GDoc now?

[23:48:49.0893] <annevk>
It happens on W3C IRC `#whatwg` due to lack of Matrix bots

[00:51:18.0869] <cwilso>
note new draft Thursday schedule :https://github.com/whatwg/html/issues/11711#issuecomment-3515612334

[01:07:50.0216] <emilio>
TabAtkins: https://github.com/mstange/samply / https://docs.python.org/3/using/cmdline.html / https://share.firefox.dev/43n45Vy

[03:38:23.0151] <Zolt√°n Kond√©r>
I fail to understand why whatwg is focusing on various API's in different browsers. I do protecting my API's to prevent fingerprinting. To me anything that needs the API to work is a threat and it must be contained with urgency. I hardly see any discussion about HTML here it's more like developing full applications that will use the browsers capabilities but completely disregarding the dangers of this. In my opinion anything that depends on specific API's in the browsers is a significant threat.

[03:54:38.0017] <Zolt√°n Kond√©r>
Far as I know W3C and others do working on prevention of fingerprinting, I never seen any discussion regarding this issue in whatwg. The more API's are there which implemented by browsers the bigger the threat. I do not support more and more API's and more and more proposal to depend on them especially not when fingerprinting and privacy is completely left out of discussion.

[04:03:55.0491] <Zolt√°n Kond√©r>
Probably the biggest most meaningful standard would be a new high-level API that mediates or annotates other APIs. One for all - all for one.

This way it is possible to protect users privacy, resist fingerprinting etc. 

Pretty sure a lot of browsers would implement it. 

The API itself would be difficult but not impossible. Once there is a working version the development would be easier.

[04:32:39.0069] <freddy>
I think there's significant overlap between whatwg/w3c that I presume most people in either group have seen things like v

[04:32:40.0887] <freddy>
* I think there's significant overlap between whatwg/w3c that I presume most people in either group have seen things like https://www.w3.org/TR/fingerprinting-guidance/

[10:45:19.0538] <dveditz>
There's not much discussion of HTML because there aren't many newly-proposed declarative HTML features, and cross-browser compatibility/ambiguity problems are largely addressed or at least known and added to web platform tests.

[10:46:37.0552] <dveditz>
Most of the activity in non-scripted features is happening in the very active CSS working group, but that's hosted by W3C so it doesn't come up here in WHATWG

[10:48:29.0395] <dveditz>
And most of the proposals to restrict capabilities of existing APIs are happening in the Privacy WG and CG. Often by the same people who are in this channel!

[12:25:45.0565] <Noam Rosenthal>
zcorpan, annevk OK to move https://github.com/whatwg/html/issues/11819 to stage 1 following yesterday discussion?


2025-11-12
[22:19:06.0846] <jarhar>
i wrote some notes about implementing customizable select which would be very helpful for anyone else who is implementing it: https://gist.github.com/josepharhar/9c359f5b8b6fa4c31065bd1fbeab40dd


2025-11-15
[18:42:24.0706] <snek>
annevk: do you think it would be reasonable to make Request/Response transferable? I think the biggest piece there is the bodies and they are already transferable... i can open an issue with more detail if this sounds generally coherent.

[07:15:49.0735] <Noam Rosenthal>
Would be good to clarify the use case beyond passing the bodies. 

[10:20:31.0476] <snek>
> <@noamr:matrix.org> Would be good to clarify the use case beyond passing the bodies. 

server software (e.g. deno) passing them to different threads for processing


2025-11-17
[17:25:36.0930] <Brian Cardarella>
does this group work with the webref repo or is that completely separate?

[17:25:44.0622] <Brian Cardarella>
webref being in the w3c org

[18:08:42.0066] <sideshowbarker>
[@bcardarella:matrix.org](https://matrix.to/#/@bcardarella:matrix.org)  I think everybody except Fran√ßois Daoust who wrote it and maintains it are just users of it

[18:09:57.0984] <sideshowbarker>
‚Ä¶modulo some people maybe having contributed PRs at times

[13:01:33.0014] <Meghan Denny>
https://github.com/whatwg/html/issues/11920 got this written up :)


2025-11-18
[02:34:19.0428] <annevk>
snek: yeah, seems reasonable in the abstract

[04:10:52.0390] <hsivonen>
annevk: It looks like the reporter of https://github.com/whatwg/html/issues/11782 filed it on Gecko and Chromium but not on WebKit.

[04:22:29.0614] <annevk>
hsivonen: presumably those reports will be closed as INVALID so it doesn't matter? Or am I missing something?

[04:22:36.0702] <hsivonen>
(https://bugzilla.mozilla.org/show_bug.cgi?id=2000805 and https://issues.chromium.org/issues/461532443?pli=1 )

[04:23:29.0992] <hsivonen>
Mostly a FYI about trying different venues. I closed the Gecko bug.

[04:23:46.0753] <annevk>
(Also doesn't seem like any of that is high priority for the i18n WG, but I suspect Richard at least still cares about it. And Elika prolly too.)

[04:24:34.0861] <annevk>
Now that we've made other changes to the HTML parser maybe we should reconsider, but it seems really hard to determine where to draw the line.

[08:20:14.0367] <annevk>
TabAtkins: seeing a weird warning at https://github.com/whatwg/fetch/actions/runs/19468018147/job/55725474022: "Remote data (2025-11-11 11:44) is more than two days older than local time (2025-11-18 16:17); either your local time is wrong (no worries, this warning will just repeat each time) or the update process has fallen over (please report this!)."

[08:21:25.0309] <TabAtkins>
Yu, someone just reported it over the weekend, looking into it now

[08:49:36.0001] <TabAtkins>
Ah, it's a data issue that was triggering an error in the update process (someone left an empty id attribute on their heading). Fixed the spec and am currently verifying the fix in Bikeshed.


2025-11-19
[07:27:28.0415] <fjjdfjdjdb>
LEARN HOW TO HACK üïπ
 üï∂Ô∏è CyberSecurityExpertsHQ‚Äî born from the 2013 cyber underground. Real intel. Real exploits. No noise ‚Äî just raw cybersecurity knowledge. ‚ö°

JOIN US HERE üìå

üì±Telegram Account Hacking
üì©Hotmail and Outlook Hacking
‚òéÔ∏èTrack cellphone
üì±YouTube Account Hacking 
üì©Gmail Hacking
üõ°SS7 attack launching
üì±Facebook Hacking
üì±WhatsApp Account/Spy
üì±Twitter Account Hacking
üì±Instagram Account Hacking
üì±Tiktok hack 
üí≥Carding and selling Carded tools
üì±Skype Account Hacking
üì±Snapchat Account Hacking
üéÆGame hacking
 üìûnumber Hacking/Cloning
üì±Phone Hacking/Android Hacking
üì±Tinder/ Onlyfans account Hacking
üì±Website Database Hacking
üíªComputer/Laptop Hacking
‚òÅÔ∏è  Bitcoin Mining 
üì±Phone Hacking/Android Hacking
üì±Normal account Hacking like Apple account 

JOIN NOWüîé https://t.me/CyberSecurityExpertsHQ2



2025-11-20
[00:00:41.0788] <smaug>
Looks like many (all?) agenda+ items for WHATNOT got the label well before WHATUP, and most of them were discussed last week. 

[01:25:23.0334] <smaug>
Hmm, some pages are getting mad with cross site iframes (mostly ads etc.). Easily 50 different sites, and if implementation uses separate process per site and process overhead + ad page is ~20MB (which seems to be the case in couple of browsers), one has ~1GB overhead from ads. Easily.

[01:32:30.0878] <smaug>
We should limit the number of sites a tab can contain simultaneously. Let's say 5 üôÇ 

[06:06:12.0958] <annevk>
If anyone has any opinion on specification singleton types (success, failure, etc.) that is different from what https://github.com/whatwg/infra/pull/687 attempts to do please speak up now.

[07:14:05.0994] <Dominic Farolino>
emilio: What do you make of the tests in https://github.com/web-platform-tests/wpt/blob/master/html/interaction/focus/processing-model/focusVisible.html#L59-L60? It seems like they expect `focusVisible: false` to force `:focus-visible` to not match, but the spec text only indicates that `focusVisible: true` forces `:focus-visible`, but can't *unforce* it? Am I right in thinking there's a mismatch here?

[07:38:13.0252] <cwilso>
Gah.  I have failed to get back ahead of the curve.  I don't see anything new agenda+ for today; cancel?

[07:44:33.0061] <annevk>
cwilso: that would work for me. I wanted to share that Fetch might hold its own call dedicated to cookies (a more formalized version of an informal call we have today), but that can wait.

[07:50:53.0365] <annevk>
Kaiido: FYI: https://github.com/whatwg/html/pull/11529

[07:54:33.0574] <Luke Warlow>
It doesn't change focus on that call, so if the element already has focus then it keeps it. But this test resets focus between each test

[07:54:54.0946] <Luke Warlow>
* It doesn't change focus on that call, so if the element already has focus then it keeps it. But this test resets focus between each test. So the test is correct imo.

[07:55:28.0685] <Luke Warlow>
* It doesn't change focus indication on that call of focus(), so if the element already has focus indication then it keeps it. But this test resets focus between each test. So the test is correct imo.

[07:55:55.0606] <Luke Warlow>
* It doesn't change focus indication on that call of focus(), so if the element already has focus indication then it keeps it. But this test resets focus between each test. So the test is correct imo.

I implemented this in WebKit and remember getting slightly confused but the test did seem correct in the end.

[08:08:55.0338] <Luke Warlow>
* It doesn't change focus indication on that call of focus(), so if the element already has focus indication then it keeps it. But this test resets focus between each test. So the test is correct imo.

I implemented this in WebKit and remember getting slightly confused but the test did seem correct in the end.

Edit: Oh oops looks like this reply didn't link properly. Dominic Farolino: 

[08:28:18.0030] <Dominic Farolino>
Luke Warlow: Ahh I see. OK so HTML only sets the focus ring if `focusVisible` is true, or missing. It never calls into CSS's "indicate focus" if it's false, and that's the "force-invisible" mechanism I guess. 

[08:29:51.0030] <Luke Warlow>
> <@domfarolino:matrix.org> Luke Warlow: Ahh I see. OK so HTML only sets the focus ring if `focusVisible` is true, or missing. It never calls into CSS's "indicate focus" if it's false, and that's the "force-invisible" mechanism I guess. 

Yeah exactly. Idk if one exists but ideally there should be a test that calling focus with false after calling it with true still keeps the indicator. To make sure it doesn't *remove* it in that case.

[08:33:35.0623] <Dominic Farolino>
I think I recall seeing tests that exercise that calling focus on an already-focused element has no effect, so I guess that would implicitly catch this case? Not sure really

[09:02:29.0240] <annevk>
cwilso: if you have time I think it would be good to open the issue for next week now and maybe close the last meeting issue (and the WHATUP one?)

[13:15:50.0414] <foolip>
I've updated https://github.com/whatwg/html/pull/11631 today and would like to move https://github.com/whatwg/html/issues/2142 to stage 2. Jake Archibald WDYT?


2025-11-21
[16:36:29.0801] <jmdyck>
The latest commit to the HTML spec left one uppercase occurrence of "Get Trusted Type" (the only one with an embedded newline), which I'm guessing was an oversight. Line 124289-90. foolip ?

[18:13:46.0890] <emilio>
How so? https://html.spec.whatwg.org/#dom-focus has:

> If options["focusVisible"] is true, or does not exist but in an implementation-defined way the user agent determines it would be best to do so, then indicate focus.

So if it's `false`, then you don't indicate focus, right?

[18:14:18.0222] <emilio>
Note the test resets the focus state between steps too

[00:39:30.0792] <foolip>
Yep, definitely accidental. If you have it up on your screen can you send a PR that I can merge?

[02:37:53.0393] <jmdyck>
ok

[03:44:27.0629] <jmdyck>
https://github.com/whatwg/html/pull/11937


2025-11-24
[12:21:53.0455] <sb3nder>
I noticed something odd on the MDN page for the inert attribute. It says:

> Inert HTML elements and their flat tree descendants:
> - Do not have click events fired when clicked on.

But in practice, inert elements do fire click events in certain circumstances. Was the spec originally meant to block clicks, or is MDN just inaccurate here?

[13:37:59.0959] <bkardell>
In which circumstances?

[14:06:43.0951] <sb3nder>
The ones I remember:
opening a <dialog> on pointerdown.
setting inert on pointerup.

[14:10:38.0687] <sb3nder>
In MDN I would write this instead:
Act as if the 'pointer-events' CSS property were set to 'none'.


2025-11-25
[02:44:25.0171] <Jake Archibald>
There's still some discussion over how it should behave with script & preloading https://github.com/whatwg/html/issues/11669#issuecomment-3550088089. Do you think this blocks moving to stage 2? If not I'm fine with it and we can continue to discuss. zcorpan does this make sense with the stages model?

[03:10:32.0439] <annevk>
foolip: why doesn't it add runScripts to setHTMLUnsafe?

[03:13:35.0879] <foolip>
annevk: That's just an oversight. Do you think we should add `runScripts` to setHTMLUnsafe() independently (before) streamHTMLUnsafe(), or do it all in one PR?

[03:14:39.0844] <annevk>
I don't have a preference, except that `setHTMLUnsafe()` getting it later doesn't seem good.

[03:21:34.0687] <foolip>
Yeah, that wouldn't make sense

[03:21:44.0905] <annevk>
I left some other comments on the PR. Forgot to comment on `runScripts`. üòÖ

[03:21:45.0742] <foolip>
I'll add it to the PR so that it's somewhere for now.

[03:27:04.0871] <Noam Rosenthal>
I'm not sure there is actually much of an issue there; we can tee those streams to use the speculative parser the same way it's done in the main parser. The mechanism of that is kind of loosely spec'ed to begin with though

[03:28:58.0680] <Jake Archibald>
Noam Rosenthal: ohh, I didn't realise that the buffering to allow scripts to run before adding the next element stuff had made it into the spec

[03:30:27.0187] <Noam Rosenthal>
It *sort of* did. The stream that goes into the parser is teed to the main parser and speculative parser, but a lot of details there are left to implementations. In either case, I checked it in the spec and streaming to an element doesn't have an effective change on this (though of course this needs to be properly tested).

[03:41:37.0705] <Jake Archibald>
> but a lot of details there are left to implementations
That sounds‚Ä¶ bad :D

[03:41:43.0764] <Jake Archibald>
* > but a lot of details there are left to implementations

That sounds‚Ä¶ bad :D

[03:42:36.0836] <Jake Archibald>
Noam Rosenthal: I really think the stuff in https://github.com/whatwg/html/issues/11669#issuecomment-3537477657 should be interoperable

[03:47:15.0656] <Noam Rosenthal>
*That* stuff is interoperable. I meant that the speculative parsing behaviour might not be entirely interoperable.

[03:55:13.0724] <Jake Archibald>
oh yeah that's fine

[04:03:46.0857] <Jake Archibald>
Noam Rosenthal: someone's asking "why contentname and not id", and I couldn't find the relevant discussion

[04:03:52.0674] <Jake Archibald>
https://x.com/royalicing/status/1991714869012582584

[04:06:30.0423] <foolip>
Thanks for the feedback! I've addressed the simple stuff now. For the HTML fragment parsing algorithm refactor I'm concerned that the diff will be unreadable if I just do it. In the end there should be one algorithm, so maybe as a middle ground I could add "(streaming case)" markers to some steps to show exactly where the changes are instead of waving at them from the outside?

[04:08:07.0505] <annevk>
I think you need to modify the core HTML parser as well, at least for some of the things we discussed. And ideally some of that is tidied up as it's all rather hand-wavy currently and adding this on top will make it even more fragile. So yeah, maybe do some refactoring first.

[04:10:31.0617] <Noam Rosenthal>
It's an XSS mitigation, to avoid new streaming modifying markup that doesn't expect it. It was raised in the first WHATNOT about this and also by our security folks.
It was discussed here https://docs.google.com/document/d/1iaarr4Ho715CUULrvi_LD3TwshAcN2odDLBBEK0FjH0/edit?tab=t.0#heading=h.oh1h778cnny but the minutes are lacking/missing


[04:12:05.0451] <Noam Rosenthal>
... also, contentname is not meant to be document-unique like ID. it is resolved from the template's parent downwards (or for the whole document if the template is a direct child of the body)

[05:53:15.0478] <sb3nder>
bkardell: Do you have any insight?

[06:45:54.0649] <foolip>
For Sanitizer definitely, although I think that has to be a different PR. But also for `runScripts`, at least https://html.spec.whatwg.org/#parsing-main-inhead:already-started should be modified.

[06:47:16.0702] <foolip>
annevk: but this really seems more like stage 3 ("Complete specification text") than stage 2 ("draft specification") to me, don't you think so?

[07:19:17.0040] <annevk>
foolip: are you sure that's only for sanitizer? For instance, the way it is currently specified declarative shadow trees would not work, because there's no separate parser document and thus you would get the settings from the main document parser. I don't think that's what we want.

[07:23:36.0366] <annevk>
foolip: anyway, API-shape-wise this is all seems fairly settled and it does seem somewhat unlikely we'll have to deviate very far from this as we define things better. But it's a big gap and I really hope this will come with some improvements to how we define the HTML parser in general, because I don't know if you've noticed, but people keep reporting new issues with it.

[07:29:34.0097] <foolip>
annevk: My current thinking is to define an algorithm that works for streamHTMLUnsafe() and then wrap that in a synchronous form for setHTUnsafe() and other existing APIs. I'm not sure how exactly though because streams primitives aren't synchronous so it will have to be something else. Maybe just a parser object that can be fed chunks.

[07:31:40.0208] <foolip>
That isn't the most interesting stuff however. What makes scripts and DSD work differently in different parser modes is much more interesting. For scripts I'm pretty sure of how to do it, for DSD I'll need to look at where we get the setting from in the absence of a separate parser document.

[07:36:34.0315] <annevk>
I'm not sure it's just scripts and declarative shadow trees. I can imagine there might also be differences between node creation and insertion that would show up. Because as currently proposed the node would not be created in an "inert" document. I suspect that needs to change so it's the same as `setHTMLUnsafe()` and friends.

[09:10:51.0532] <foolip>
This aspect would be more like the main parser where nodes are created in and inserted into the main document. There might definitely be surprises hiding here since it's not quite like the main parser and not quite the fragment parser, but I'm not sure that bouncing nodes off an inert document is really better. Noam Rosenthal can you think of any observable differences between those two models?

[09:19:02.0028] <annevk>
foolip: well something like that is clearly needed for the Sanitizer and we don't want the design for setHTMLUnsafe to be fundamentally different from setHTML.

[09:19:55.0158] <annevk>
foolip: so solving for the Sanitizer is definitely going to be needed to some extent for v1. Much more so than with setHTMLUnsafe() as there it was very clear what needed to be done.

[09:20:30.0921] <annevk>
* foolip: well something like that is clearly needed for the Sanitizer and we don't want the design for streamHTMLUnsafe to be fundamentally different from streamHTML.

[09:21:03.0207] <annevk>
* foolip: well something like that is clearly needed for the Sanitizer and we don't want the design for `streamHTMLUnsafe()` to be fundamentally different from `streamHTML()`.

[09:21:11.0851] <annevk>
* foolip: so solving for the Sanitizer is definitely going to be needed to some extent for v1. Much more so than with `setHTMLUnsafe()` as there it was very clear what needed to be done.

[09:22:08.0001] <Noam Rosenthal>
In blink it's basically the fragment parser, but when it's time to insert to the the `root` created in step 7, we insert directly to the context node.
There is no inert document in the blink implementation in the first place -  the existing `setHTMLUnsafe` and friends it's basically a `DocumentFragment` and those elements are inserted to that fragment directly.

[09:32:19.0029] <annevk>
Sure, I suspect all implementations optimize that away, but the observables are the same if you go through a `DocumentFragment`. Not so much if you skip that.

[09:45:42.0970] <Noam Rosenthal>
... but if the difference was between node creation and insertion times, the DocumentFragment in the middle is not what would matter...
e.g. if custom elements were created at some point and then asynchronously inserted much later it would be observable with the custom element constructor or some such.
The differences we've found so far are the ones you'd expect due to streaming (e.g. classic scripts run immediately)

[09:45:56.0246] <Noam Rosenthal>
* ... but if the difference was between node creation and insertion times, the DocumentFragment in the middle is not what would matter, but rather the inert document...
e.g. if custom elements were created at some point and then asynchronously inserted much later it would be observable with the custom element constructor or some such.
The differences we've found so far are the ones you'd expect due to streaming (e.g. classic scripts run immediately)

[09:47:57.0779] <Noam Rosenthal>
... at least nothing obvious came up from using the fragment parser in this way and just adjusting the insertion point when inserting into the `root`. It doesn't mean that there aren't surprises somewhere, the parser is pretty big.

