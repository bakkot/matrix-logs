<!DOCTYPE html><html><head>
  <title>WHATWG on 2024-07-18</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "WHATWG";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">WHATWG<br>2024-07-18<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2024-07-17" class="nav-link"><span>prev</span></a>
<span style="float:right">next</span>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search WHATWG">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Wed Jul 17 2024 21:25:05 GMT-0700 (Pacific Daylight Time)">04:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">could use some rapid spam hiding/deleting on <a href="https://github.com/whatwg/webidl/pull/1421#pullrequestreview-2184595148">https://github.com/whatwg/webidl/pull/1421#pullrequestreview-2184595148</a> (warning, there's a graphic image)</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Wed Jul 17 2024 21:28:18 GMT-0700 (Pacific Daylight Time)">04:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</div></td><td class="msg-cell">Jeez</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Thu Jul 18 2024 00:20:04 GMT-0700 (Pacific Daylight Time)">07:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</div></td><td class="msg-cell"><p>More than 10 years after the progress promises discussions and we still don't have a <em>great</em> pattern for progress signals...</p>
<p>My choices seem to be either: <code>createX()</code> returns a promise for a not-yet-initialized <code>X</code> object, which fires <code>progress</code> events and has a <code>ready</code> promise for when it's fully usable. Or, <code>createX({ progressCallback })</code>, which only fulfills once the <code>X</code> is fully ready.</p>
<p>The latter is a bit nicer but I can find zero precedent for it on the web platform...</p>
</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Thu Jul 18 2024 00:29:29 GMT-0700 (Pacific Daylight Time)">07:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell"><span class="nick-1">Domenic</span>: this in light of some of the chatter about people returning to XHR? I thought we had some kind of plan for that, though a general solution for promises also sounds interesting.</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Thu Jul 18 2024 00:31:07 GMT-0700 (Pacific Daylight Time)">07:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</div></td><td class="msg-cell">It's actually reflecting on some feedback on the former pattern which I've used in <a href="https://github.com/WICG/translation-api#downloading-new-languages">https://github.com/WICG/translation-api#downloading-new-languages</a> .

A general solution for promises is probably not really possible. Or if it is, it'll be like AbortController and be something separate that just often integrates with promises.

What plan do you think we have? I vaguely remember some sort of FetchController or FetchSignal or something?</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Thu Jul 18 2024 00:32:18 GMT-0700 (Pacific Daylight Time)">07:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</div></td><td class="msg-cell"><a href="https://github.com/whatwg/fetch/issues/607">https://github.com/whatwg/fetch/issues/607</a> isn't very enlightening</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Thu Jul 18 2024 01:01:06 GMT-0700 (Pacific Daylight Time)">08:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</div></td><td class="msg-cell">I guess <a href="https://github.com/whatwg/fetch/issues/447#issuecomment-281731850">https://github.com/whatwg/fetch/issues/447#issuecomment-281731850</a> proposes a callback that gives you an object that fires events, that's even more complex, hmm.</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Thu Jul 18 2024 01:08:54 GMT-0700 (Pacific Daylight Time)">08:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@noamr:matrix.org">Noam Rosenthal</span>&gt;</div></td><td class="msg-cell">Seems like this should be on the <code>Response</code> rather than the fetch?</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Thu Jul 18 2024 01:09:04 GMT-0700 (Pacific Daylight Time)">08:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell"><span class="nick-1">Domenic</span>: yeah, I think that's the plan of record. A callback that reveals a FetchObserver object upon which you can listen for progress, and can potentially monitor things like 1xx responses.</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Thu Jul 18 2024 01:09:10 GMT-0700 (Pacific Daylight Time)">08:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell"><span class="nick-8">Noam Rosenthal</span>: no, that would not work for 1xx.</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Thu Jul 18 2024 01:10:03 GMT-0700 (Pacific Daylight Time)">08:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell">Might have to be careful about when it starts sending progress though to not give additional timing channels.</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Thu Jul 18 2024 01:10:33 GMT-0700 (Pacific Daylight Time)">08:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</div></td><td class="msg-cell">Hmm, for my case that's more complexity than needed, but maybe for future extensibility it's worth it??</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Thu Jul 18 2024 01:11:08 GMT-0700 (Pacific Daylight Time)">08:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell">What would be simpler that gives both download and upload progress? One callback for each?</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Thu Jul 18 2024 01:17:52 GMT-0700 (Pacific Daylight Time)">08:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@noamr:matrix.org">Noam Rosenthal</span>&gt;</div></td><td class="msg-cell">What's the meaning of download/upload progress for a 1xx response? didn't see that in the issue</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Thu Jul 18 2024 01:35:39 GMT-0700 (Pacific Daylight Time)">08:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> What would be simpler that gives both download and upload progress? One callback for each?</blockquote></mx-reply>My case only needs download progress.</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Thu Jul 18 2024 01:36:39 GMT-0700 (Pacific Daylight Time)">08:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@noamr:matrix.org">Noam Rosenthal</span>&gt;</div></td><td class="msg-cell">Wouldn't <code>request.onprogress</code> and <code>response.onprogress</code> be simpler? Sure it doesn't support 1xx responses but isn't this good for the use cases authors care about? (Apologies if I'm missing something basic about this)</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Thu Jul 18 2024 03:46:06 GMT-0700 (Pacific Daylight Time)">10:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell">Neither of those objects is stateful today, I'd kinda like to keep it that way</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Thu Jul 18 2024 03:59:47 GMT-0700 (Pacific Daylight Time)">10:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell"><code>FetchObserver</code> is still the best idea I've seen for 1xx responses, upload progress, download progress, priority changes (although maybe this one can be covered by signal?), and future esoteric HTTP features (e.g., trailers that appear mid-stream has been suggested as a feature at one point). But it is somewhat clunky and I can already see people complaining about it when compared to XHR.</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Thu Jul 18 2024 04:07:32 GMT-0700 (Pacific Daylight Time)">11:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@lwarlow:igalia.com">Luke Warlow</span>&gt;</div></td><td class="msg-cell">That's very probably a spec bug. The Dom parsing spec has a number of open issues on it which need reviewing and migrating to html or closing. </td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Thu Jul 18 2024 04:07:43 GMT-0700 (Pacific Daylight Time)">11:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell"><pre><code>fetch("test", {
  method: "POST",
  observer =&gt; {
    observer.onprogress = () =&gt; {
      console.log("finally");
    }
  }
});

const client = new XMLHttpRequest();
client.open("POST", "test");
client.onprogress = () =&gt; {
  console.log("been doing this for a long time");
}
</code></pre>
</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Thu Jul 18 2024 04:10:00 GMT-0700 (Pacific Daylight Time)">11:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell">Maybe interesting to run a Twitter/Mastodon poll on at some point.</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Thu Jul 18 2024 04:10:56 GMT-0700 (Pacific Daylight Time)">11:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@lwarlow:igalia.com">Luke Warlow</span>&gt;</div></td><td class="msg-cell">Am I missing something or is that fetch one not quite valid JS? Should be 'observer: observer =&gt; ...' I think </td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Thu Jul 18 2024 04:11:25 GMT-0700 (Pacific Daylight Time)">11:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell"><span class="nick-5">Luke Warlow</span>: I might well have fumbled it. ðŸ˜…</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Thu Jul 18 2024 04:12:49 GMT-0700 (Pacific Daylight Time)">11:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell">I guess it has to be <code>observer(x) =&gt; x.on...</code> or some such?</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Thu Jul 18 2024 04:12:55 GMT-0700 (Pacific Daylight Time)">11:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@lwarlow:igalia.com">Luke Warlow</span>&gt;</div></td><td class="msg-cell">Fwiw that fetch call seems like a pretty nice API? Though I feel like most developers won't mind the API too much at this point they just want a non XHR way to do it.

As in, do what's best from a spec and implementation point of view over purely the "best" API design especially if it allows more use cases</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Thu Jul 18 2024 04:15:16 GMT-0700 (Pacific Daylight Time)">11:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell"><p>It's not terrible, I think what people might prefer is an overloaded return promise. But subclassing promises is very much uncharted territory and prolly has its own issues.</p>
<p>As in, naively I would expect this:</p>
<pre><code>const observer = fetch("test", { method: "POST" });
observer.onprogress = () =&gt; {
  console.log("finally");
}
</code></pre>
</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Thu Jul 18 2024 04:18:47 GMT-0700 (Pacific Daylight Time)">11:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell">I wonder if <span class="nick-1">Domenic</span> still recalls the thinking around promise subclasses.</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Thu Jul 18 2024 04:29:49 GMT-0700 (Pacific Daylight Time)">11:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@sideshowbarker:matrix.org">sideshowbarker</span>&gt;</div></td><td class="msg-cell">I vote for whatever we could agree on that gets something in the hands of developers sooner rather than later. It seems like we have plenty of evidence that this remains a major pain point for developers, and addressing it will save developers from a lot of frustration, and save them a lot of time.</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Thu Jul 18 2024 04:43:52 GMT-0700 (Pacific Daylight Time)">11:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell">I'll be out for a couple of weeks. If you need me, check back mid-August. (Though I'll show up at WHATNOT today.)</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Thu Jul 18 2024 09:57:29 GMT-0700 (Pacific Daylight Time)">16:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@smaug:mozilla.org">smaug</span>&gt;</div></td><td class="msg-cell"><span class="nick-5">Luke Warlow</span>: FWIW, Gecko's innerHTML serializer is also like GetMarkup(bool aIncludeSelf, nsAString&amp; aMarkup). I was expecting to see something similar in the spec</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Thu Jul 18 2024 09:57:41 GMT-0700 (Pacific Daylight Time)">16:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@smaug:mozilla.org">smaug</span>&gt;</div></td><td class="msg-cell">Oh, outerHTML indeed has this weird "fictional node" <a href="https://html.spec.whatwg.org/#dom-element-outerhtml">https://html.spec.whatwg.org/#dom-element-outerhtml</a></td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Thu Jul 18 2024 10:02:24 GMT-0700 (Pacific Daylight Time)">17:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@lwarlow:igalia.com">Luke Warlow</span>&gt;</div></td><td class="msg-cell">In that case I think all <strong>5</strong> engines pass a flag through to the fragment serializing steps</td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Thu Jul 18 2024 10:03:39 GMT-0700 (Pacific Daylight Time)">17:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@lwarlow:igalia.com">Luke Warlow</span>&gt;</div></td><td class="msg-cell">So it seems like a no brainer for the spec to match. And then we can do away with finctional nodes.</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Thu Jul 18 2024 13:54:24 GMT-0700 (Pacific Daylight Time)">20:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@lwarlow:igalia.com">Luke Warlow</span>&gt;</div></td><td class="msg-cell">Is <a href="https://html.spec.whatwg.org/multipage/xhtml.html#xml-fragment-serialisation-algorithm">https://html.spec.whatwg.org/multipage/xhtml.html#xml-fragment-serialisation-algorithm</a> actually used?</td></tr>

</tbody></table></div></div></div>
</body></html>