<!DOCTYPE html><html><head>
  <title>WHATWG on 2021-11-26</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "WHATWG";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">WHATWG<br>2021-11-26<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2021-11-25" class="nav-link"><span>prev</span></a>
<span style="float:right">next</span>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>
<input type="text" id="query" size="25" placeholder="Search WHATWG">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Thu Nov 25 2021 23:50:04 GMT-0800 (Pacific Standard Time)">07:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:mozilla.org">annevk</span>&gt;</div></td><td class="msg-cell">I think that is editorial. It doesn't change how the standard is understood.</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Thu Nov 25 2021 23:51:12 GMT-0800 (Pacific Standard Time)">07:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:mozilla.org">annevk</span>&gt;</div></td><td class="msg-cell"><a href="https://github.com/whatwg/meta/blob/main/COMMITTING.md#title-prefixes">https://github.com/whatwg/meta/blob/main/COMMITTING.md#title-prefixes</a> has advice, though I'll admit that every now and then <span class="nick-1">Domenic</span> will correct me. It still doesn't come natural to me.</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Fri Nov 26 2021 00:19:25 GMT-0800 (Pacific Standard Time)">08:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@mehboob_101:matrix.org">The Finder</span>&gt;</div></td><td class="msg-cell">Hello everybody here, You can consider me as someone accidently land out into this room. But I am really exciting to be here. and will really appreciate that if anyone here explain me a bit on its science ?</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Fri Nov 26 2021 00:55:38 GMT-0800 (Pacific Standard Time)">08:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@ntim:mozilla.org">ntim</span>&gt;</div></td><td class="msg-cell"><span class="nick-1">Domenic</span>: Filed <a href="https://bugs.webkit.org/show_bug.cgi?id=233514">https://bugs.webkit.org/show_bug.cgi?id=233514</a> &amp; <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1743082">https://bugzilla.mozilla.org/show_bug.cgi?id=1743082</a> for WebKit &amp; Gecko</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Fri Nov 26 2021 00:55:53 GMT-0800 (Pacific Standard Time)">08:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@ntim:mozilla.org">ntim</span>&gt;</div></td><td class="msg-cell">(also i'm doing the work for WebKit)</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Fri Nov 26 2021 00:56:24 GMT-0800 (Pacific Standard Time)">08:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@ntim:mozilla.org">ntim</span>&gt;</div></td><td class="msg-cell"><span class="nick-13">emilio</span>: <span class="nick-8">sefeng</span> ^</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Fri Nov 26 2021 08:23:16 GMT-0800 (Pacific Standard Time)">16:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@jgraham_:matrix.org">jgraham</span>&gt;</div></td><td class="msg-cell">So I'm trying to work out how to talk about sandboxes / isolated worlds for WebDriver BiDi (Extensions will need something similar for content scripts). I kind of just want to sketch in the basics of how it works at the moment, but it would be good to start with a model that isn't total nonsense. 

So I'm leaning towards a model where the behaviour is explained as "in a sandbox, objects are accessed through a transparent wrapper object. When getting a property, if the property is defined on the wrapper, return that. Otherwise check if the property is defined on the wrapped object and, if it is, and the wrapped object is a platform object, and the property is part of the interface definition for the wrapped object, or is an internal slot, return the wrapped property value if it's an object, or the primitive value if it's not. When setting a property, check if the wrapped object is a platform object, and the property is part of the interface for that platform object, then act as if setting the property on the wrapped object. Otherwise set the property on the wrapper."

Does that make any sense whatsoever as a model or is it going to run into insurmountable difficulties (I think it's similar to the actual Gecko implementation, but I'm not an expert)? If it does make sense, how to fit it into the formalism? I don't mind the wrapper objects being "magical", but does it make sense to claim that the sandbox itself is a realm and the wrapped objects are part of a different realm? That kind of makes sense at a high level, and matches how we want to expose it in the BiDi protocol but is it going cause problems with some invariants at the spec level?</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Fri Nov 26 2021 08:26:45 GMT-0800 (Pacific Standard Time)">16:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@jgraham_:matrix.org">jgraham</span>&gt;</div></td><td class="msg-cell">I kind of realise that this stuff doesn't match the theoretical model of ECMAScript etc. so there is probably going to be some amount of doing things that aren't intended (and maybe people won't like it), but it would be good to avoid unnecessary friction.</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Fri Nov 26 2021 08:33:16 GMT-0800 (Pacific Standard Time)">16:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@dubiousjim:matrix.org">Jim Pryor</span>&gt;</div></td><td class="msg-cell">I've been reading the Webstreams spec and working on porting some code running in Node to use webstreams. I came across two obstacles that I think are built into the current design. Would value hearing from others who know more about or have more experience working with this spec. Is this a good place to ask? Would it be ok/better to raise issue on whatwg/streams?</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Fri Nov 26 2021 08:33:25 GMT-0800 (Pacific Standard Time)">16:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@dubiousjim:matrix.org">Jim Pryor</span>&gt;</div></td><td class="msg-cell"><ol>
<li>In a Readable/WritableStream's <code>start()</code> implementation (also in <code>read()</code> or <code>write()</code>) I sometimes want to gracefully cancel or abort the stream. For example, if a WritableStream is passed data of a type it doesn't handle, but I want the stream implementation to do some post-processing on the data it already received. One can't use the client-facing <code>cancel</code> or <code>abort</code> methods on the streams at these points, because the stream is typically locked. You can call <code>controller.error</code>, but (at least in Node 17.1.0's implementation and in the current web-streams-polyfill), this throws an error outside the scope of the stream implementation (so it can't be observed/caught by the implementation's <code>cancel</code> or <code>abort</code> routines). I'd be interested to hear whether this design is deliberate and what kinds of worksarounds I might consider.</li>
</ol>
</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Fri Nov 26 2021 08:33:31 GMT-0800 (Pacific Standard Time)">16:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@dubiousjim:matrix.org">Jim Pryor</span>&gt;</div></td><td class="msg-cell"><ol start="2">
<li>There doesn't seem to be any way to observe errors/aborts/cancelations in an existing stream (that my code did not implement itself). Some Node code I'm trying to port calls <code>webstream.on('error', err =&gt; ...)</code> but I don't see any way to do something similar with webstreams. I considered having my code implement a TransformStream and piping the externally-provided ReadableStream through that. But I don't see any way to make the TransformStream observe errors in another stream piping into it.</li>
</ol>
</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Fri Nov 26 2021 08:37:10 GMT-0800 (Pacific Standard Time)">16:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:mozilla.org">annevk</span>&gt;</div></td><td class="msg-cell"><span class="nick-6">jgraham</span>: at a high-level it sounds reasonable; "Proxy object" is the TC39 verbiage. You could look at WindowProxy for some inspiration. Defining that in detail seems quite involved though.</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Fri Nov 26 2021 08:37:23 GMT-0800 (Pacific Standard Time)">16:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@ntim:mozilla.org">ntim</span>&gt;</div></td><td class="msg-cell"><span class="nick-1">Domenic</span>: <span class="nick-13">emilio</span> <span class="nick-8">sefeng</span> , I wrote <a href="https://github.com/web-platform-tests/wpt/pull/31758">https://github.com/web-platform-tests/wpt/pull/31758</a> which formalizes the behavior implemented in Chrome/Firefox (though it fails in WebKit), although I'm not sure this is specified anywhere</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Fri Nov 26 2021 08:39:08 GMT-0800 (Pacific Standard Time)">16:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@ntim:mozilla.org">ntim</span>&gt;</div></td><td class="msg-cell">Should ::backdrop receive events from the associated  element ?</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Fri Nov 26 2021 08:39:39 GMT-0800 (Pacific Standard Time)">16:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@dubiousjim:matrix.org">Jim Pryor</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <ol start="2">
<li>There doesn't seem to be any way to observe errors/aborts/cancelations in an existing stream (that my code did not implement itself). Some Node code I'm trying to port calls <code>webstream.on('error', err =&gt; ...)</code> but I don't see any way to do something similar with webstreams. I considered having my code implement a TransformStream and piping the externally-provided ReadableStream through that. But I don't see any way to make the TransformStream observe errors in another stream piping into it.</li>
</ol>
</blockquote></mx-reply>Whoops, I mean, it calls <code>nodestream.on('error', err =&gt; ...)</code></td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Fri Nov 26 2021 08:41:28 GMT-0800 (Pacific Standard Time)">16:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:mozilla.org">annevk</span>&gt;</div></td><td class="msg-cell"><span class="nick-16">Jim Pryor</span>: I think stream.closed ends up rejecting</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Fri Nov 26 2021 08:41:45 GMT-0800 (Pacific Standard Time)">16:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:mozilla.org">annevk</span>&gt;</div></td><td class="msg-cell">Someone else prolly knows better though</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Fri Nov 26 2021 08:43:01 GMT-0800 (Pacific Standard Time)">16:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@jgraham_:matrix.org">jgraham</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">annevk</span>: Yeah, I have been looking at WindowProxy, that's pretty much how I ended up with "oh if we just override all the internal methods…" :)</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Fri Nov 26 2021 08:43:02 GMT-0800 (Pacific Standard Time)">16:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@mattiasbuelens:matrix.org">Mattias Buelens</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Whoops, I mean, it calls <code>nodestream.on('error', err =&gt; ...)</code></blockquote></mx-reply>You can use `reader.closed.catch(err =&gt; { ... })` for that.</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Fri Nov 26 2021 08:44:16 GMT-0800 (Pacific Standard Time)">16:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@jgraham_:matrix.org">jgraham</span>&gt;</div></td><td class="msg-cell">And yes I agree it's quite a lot of work, this is why the aim in the short term is to have something that sketches out the requirements, because in reality browsers already have an implementation of this stuff and they aren't going to change the existing implementation to match the spec anyway</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Fri Nov 26 2021 08:44:21 GMT-0800 (Pacific Standard Time)">16:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:mozilla.org">annevk</span>&gt;</div></td><td class="msg-cell"><span class="nick-6">jgraham</span>: "just" is doing a lot in that sentence</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Fri Nov 26 2021 08:44:59 GMT-0800 (Pacific Standard Time)">16:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@jgraham_:matrix.org">jgraham</span>&gt;</div></td><td class="msg-cell">Fair :)</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Fri Nov 26 2021 08:48:23 GMT-0800 (Pacific Standard Time)">16:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:mozilla.org">annevk</span>&gt;</div></td><td class="msg-cell"><span class="nick-6">jgraham</span>: I wonder if implementations are truly creating proxy objects or if they are creating separate JS objects that point to the same backing IDL object</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Fri Nov 26 2021 08:49:58 GMT-0800 (Pacific Standard Time)">16:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:mozilla.org">annevk</span>&gt;</div></td><td class="msg-cell"><span class="nick-6">jgraham</span>: the former seems kinda painful for perf, especially if you'd also have to do it for website scripts (not sure how you'd avoid expandos leaking to extensions otherwise)</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Fri Nov 26 2021 08:52:22 GMT-0800 (Pacific Standard Time)">16:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@jgraham_:matrix.org">jgraham</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">annevk</span>: I think Gecko and Blink are different here (I assume WebKit matches Blink). Blink basically creates a new JS reflector for each underlying C++ object. But Gecko I think is closer to having a proxy object as described (and a practial implication is that in Gecko you can get to the original JS reflector using <code>.wrappedJSObject</code> fram a sandbox)</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Fri Nov 26 2021 08:52:37 GMT-0800 (Pacific Standard Time)">16:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@mattiasbuelens:matrix.org">Mattias Buelens</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <ol>
<li>In a Readable/WritableStream's <code>start()</code> implementation (also in <code>read()</code> or <code>write()</code>) I sometimes want to gracefully cancel or abort the stream. For example, if a WritableStream is passed data of a type it doesn't handle, but I want the stream implementation to do some post-processing on the data it already received. One can't use the client-facing <code>cancel</code> or <code>abort</code> methods on the streams at these points, because the stream is typically locked. You can call <code>controller.error</code>, but (at least in Node 17.1.0's implementation and in the current web-streams-polyfill), this throws an error outside the scope of the stream implementation (so it can't be observed/caught by the implementation's <code>cancel</code> or <code>abort</code> routines). I'd be interested to hear whether this design is deliberate and what kinds of worksarounds I might consider.</li>
</ol>
</blockquote></mx-reply>Hmm, controller.error() does indeed clear the queue, it's supposed to be for an "immediate" fatal error. You could do controller.close() for a ReadableStream, but then you can't signal an error. 🤔</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Fri Nov 26 2021 08:54:42 GMT-0800 (Pacific Standard Time)">16:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:mozilla.org">annevk</span>&gt;</div></td><td class="msg-cell"><span class="nick-6">jgraham</span>: does that mean you can see expandos in Gecko? I guess one thing that would help me here is to have some examples 🙂</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Fri Nov 26 2021 08:55:16 GMT-0800 (Pacific Standard Time)">16:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:mozilla.org">annevk</span>&gt;</div></td><td class="msg-cell"><span class="nick-6">jgraham</span>: I also wonder if we want to keep that setup in Gecko or if this is something we might change (we ended up changing things for <code>document.domain</code>)</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Fri Nov 26 2021 08:56:17 GMT-0800 (Pacific Standard Time)">16:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@jgraham_:matrix.org">jgraham</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">annevk</span>: In gecko, if a window does something like <code>document.expando = 1</code> then from a sandbox <code>document.expando</code> is <code>undefined</code> but <code>document.wrappedJSObject.expando</code> is <code>1</code> (I believe)</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Fri Nov 26 2021 08:56:56 GMT-0800 (Pacific Standard Time)">16:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@jgraham_:matrix.org">jgraham</span>&gt;</div></td><td class="msg-cell">The Firefox UI code leans pretty heavily on the current implementation, so I wouldn't bet on it changing.</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Fri Nov 26 2021 08:57:27 GMT-0800 (Pacific Standard Time)">16:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:mozilla.org">annevk</span>&gt;</div></td><td class="msg-cell">I wonder how that works. Doesn't that mean that wrappedJSObject also has to be a proxy?</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Fri Nov 26 2021 08:58:09 GMT-0800 (Pacific Standard Time)">16:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@jgraham_:matrix.org">jgraham</span>&gt;</div></td><td class="msg-cell">I mean I don't think it really works in terms of ES proxies</td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Fri Nov 26 2021 08:58:23 GMT-0800 (Pacific Standard Time)">16:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:mozilla.org">annevk</span>&gt;</div></td><td class="msg-cell">Yeah, but I guess that means that specifying this in a way that's agreeable to the various implementations might also be tricky and will end up being mostly hand-wavy...</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Fri Nov 26 2021 08:58:47 GMT-0800 (Pacific Standard Time)">16:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@jgraham_:matrix.org">jgraham</span>&gt;</div></td><td class="msg-cell"><a href="https://firefox-source-docs.mozilla.org/dom/scriptSecurity/xray_vision.html">https://firefox-source-docs.mozilla.org/dom/scriptSecurity/xray_vision.html</a> is the entrypoint to the documentation on what Firefox does</td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Fri Nov 26 2021 09:01:01 GMT-0800 (Pacific Standard Time)">17:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@jgraham_:matrix.org">jgraham</span>&gt;</div></td><td class="msg-cell">Yeah, it's kind of "exciting" in that implementations aren't exactly the same, but also are very unlikely to converge, and in spec terms it's not super clear that exposing the concept of the internal state of an object being different from the JS observed state is OK/not going to cause people to be cross.</td></tr>
  <tr class="msg" id="L35"><td class="ts-cell"><a class="ts" href="#L35" alt="Fri Nov 26 2021 09:01:48 GMT-0800 (Pacific Standard Time)">17:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@jgraham_:matrix.org">jgraham</span>&gt;</div></td><td class="msg-cell">But it's also a thing that exists in the real world and is needed by at least two popular platform-adjacent features (remote automation and extensions)</td></tr>
  <tr class="msg" id="L36"><td class="ts-cell"><a class="ts" href="#L36" alt="Fri Nov 26 2021 09:04:31 GMT-0800 (Pacific Standard Time)">17:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:mozilla.org">annevk</span>&gt;</div></td><td class="msg-cell"><span class="nick-6">jgraham</span>: yeah not sure. Maybe you can come up with a way of writing it down where you just have requirements on observable behavior ( + some stuff that's implementation-defined). Having examples would help a lot with that I think.</td></tr>
  <tr class="msg" id="L37"><td class="ts-cell"><a class="ts" href="#L37" alt="Fri Nov 26 2021 09:05:26 GMT-0800 (Pacific Standard Time)">17:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:mozilla.org">annevk</span>&gt;</div></td><td class="msg-cell"><span class="nick-6">jgraham</span>: and some explanation as to why there's no actual model, to not favor any particular approach.</td></tr>
  <tr class="msg" id="L38"><td class="ts-cell"><a class="ts" href="#L38" alt="Fri Nov 26 2021 09:05:31 GMT-0800 (Pacific Standard Time)">17:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@mattiasbuelens:matrix.org">Mattias Buelens</span>&gt;</div></td><td class="msg-cell"><span class="nick-16">Jim Pryor</span>: I think these questions deserve an issue in whatwg/streams.

You're right, there's no way for a TransformStream to observe cancel or abort on its readable or writable end. I have personally had to do the same trick with piping through another identity transform in order to observe errors from the pipeTo promise. Not very elegant. 😛</td></tr>
  <tr class="msg" id="L39"><td class="ts-cell"><a class="ts" href="#L39" alt="Fri Nov 26 2021 09:10:50 GMT-0800 (Pacific Standard Time)">17:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@jgraham_:matrix.org">jgraham</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">annevk</span>: Yeah that's kind of what I planned to do and then when it came to writing it turned out to be hard to reason about how precise one needs to be when this is interacting with existing specs to avoid breaking their models/invariants. Usually the answer is "everything needs to be precise, but here it's more like "you need to look like you're doing something reputable from the outside, whilst furiously handwaving the internals". So I think that's been pushing me towards something that looks more like a "real" definition, but maybe it's not actually helping :)</td></tr>

</tbody></table></div></div></div>
</body></html>