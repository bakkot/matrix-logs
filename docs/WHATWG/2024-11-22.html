<!DOCTYPE html><html><head>
  <title>WHATWG on 2024-11-22</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "WHATWG";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">WHATWG<br>2024-11-22<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2024-11-21" class="nav-link"><span>prev</span></a>
<span style="float:right">next</span>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search WHATWG">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Thu Nov 21 2024 21:45:29 GMT-0800 (Pacific Standard Time)">05:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">annevk</span>: <a href="https://github.com/whatwg/html/pull/10770">https://github.com/whatwg/html/pull/10770</a> is marked as WebKit supportive "based on comments on this PR", but it seems possible you were only wearing your editor hat; would you mind explicitly giving a thumbs-up here or there on behalf of WebKit?</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Fri Nov 22 2024 00:38:34 GMT-0800 (Pacific Standard Time)">08:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell"><span class="nick-8">Noam Rosenthal</span>: <span class="nick-1">Dominic Farolino</span>: the thing I wanted to say during the call yesterday is that the bits that are shared between insert and move, and between remove and move, should be abstracted so we only have to maintain those algorithms in a single place as they are quite involved (especially the range mutations).</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Fri Nov 22 2024 00:40:20 GMT-0800 (Pacific Standard Time)">08:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell">I guess there's now also some web developer feedback where they prefer <code>moveBefore()</code> to fallback to <code>insertBefore()</code> where it currently throws. I'm not enthusiastic about that idea as it prevents us from making move possible for more scenarios in the future and it also just seems to encapsulate too much magic. I'd be curious to hear what <span class="nick-4">smaug</span> and <span class="nick-1">Domenic</span> think about that idea, but I'd be inclined to say no.</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Fri Nov 22 2024 00:46:30 GMT-0800 (Pacific Standard Time)">08:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</div></td><td class="msg-cell">I agree, I feel like we settled that during TPAC. It's such a fragile design.</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Fri Nov 22 2024 00:54:38 GMT-0800 (Pacific Standard Time)">08:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell">I'll double check with <span class="nick-12">ntim</span> on the popover PR btw. (I suspect it's fine.)</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Fri Nov 22 2024 02:15:49 GMT-0800 (Pacific Standard Time)">10:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@noamr:matrix.org">Noam Rosenthal</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I guess there's now also some web developer feedback where they prefer <code>moveBefore()</code> to fallback to <code>insertBefore()</code> where it currently throws. I'm not enthusiastic about that idea as it prevents us from making move possible for more scenarios in the future and it also just seems to encapsulate too much magic. I'd be curious to hear what <span class="nick-4">smaug</span> and <span class="nick-1">Domenic</span> think about that idea, but I'd be inclined to say no.</blockquote></mx-reply>Can you expand on "prevents us from making move possible for more scenarios in the future"? Is that relying on people putting <code>moveBefore</code> inside try/catch? Because that can't be guaranteed, people might make the <code>isConnected</code> checks etc. themselves.</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Fri Nov 22 2024 02:16:30 GMT-0800 (Pacific Standard Time)">10:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@noamr:matrix.org">Noam Rosenthal</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Can you expand on "prevents us from making move possible for more scenarios in the future"? Is that relying on people putting <code>moveBefore</code> inside try/catch? Because that can't be guaranteed, people might make the <code>isConnected</code> checks etc. themselves.</blockquote></mx-reply>Nevertheless, I'm content with the design we went with, I think people got used to higher level APIs so introducing a new API that's low level and throws is a bit confusing. We should consider higher level variants in the future but starting with this seems like the right approach</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Fri Nov 22 2024 02:19:58 GMT-0800 (Pacific Standard Time)">10:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@smaug:mozilla.org">smaug</span>&gt;</div></td><td class="msg-cell">I'm not keen on falling back to insertBefore.  </td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Fri Nov 22 2024 03:34:21 GMT-0800 (Pacific Standard Time)">11:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell"><span class="nick-8">Noam Rosenthal</span>: It doesn't rely on that. Though potentially it does somewhat rely on people not automatically falling back to insertBefore() and then relying on insertion and removal steps to run. I'm just saying that in the future perhaps we want to take on moves between connected documents and possibly also between connected and disconnected states. And it would be annoying to have to add new API at that point.</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Fri Nov 22 2024 06:29:10 GMT-0800 (Pacific Standard Time)">14:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domfarolino:matrix.org">Dominic Farolino</span>&gt;</div></td><td class="msg-cell">I think I might be the only one here that would be OK with falling back to insertBefore(). The argument I find convincing is that if 99% of users of this API are going to be in some generic framework-like context, all they care about is literally getting the node from A -&gt; B, and they see moveBefore() as a way to opportunistically do that atomically when possible. But either way they still want the node to end up "over there" somehow.</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Fri Nov 22 2024 06:29:29 GMT-0800 (Pacific Standard Time)">14:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domfarolino:matrix.org">Dominic Farolino</span>&gt;</div></td><td class="msg-cell">I have to imagine the # of users that would actually jump ship and not do anything when moveBefore() currently throws is really small. I haven't heard developers say that's how they would use the API.</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Fri Nov 22 2024 06:29:46 GMT-0800 (Pacific Standard Time)">14:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domfarolino:matrix.org">Dominic Farolino</span>&gt;</div></td><td class="msg-cell">That said, I am fine with the current design. I just think I'm more sympathetic to what I'm hearing from devs right now.</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Fri Nov 22 2024 06:32:32 GMT-0800 (Pacific Standard Time)">14:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domfarolino:matrix.org">Dominic Farolino</span>&gt;</div></td><td class="msg-cell">Like, I understand the value of introducing a low-level single-purpose primitive. But if developers are definitely going to hold it like the higher-level DOM mutation APIs, maybe making this a low-level single-purpose API is trying to force a market fit that isn't there?</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Fri Nov 22 2024 06:33:36 GMT-0800 (Pacific Standard Time)">14:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domfarolino:matrix.org">Dominic Farolino</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <span class="nick-8">Noam Rosenthal</span>: <span class="nick-1">Dominic Farolino</span>: the thing I wanted to say during the call yesterday is that the bits that are shared between insert and move, and between remove and move, should be abstracted so we only have to maintain those algorithms in a single place as they are quite involved (especially the range mutations).</blockquote></mx-reply>(This seems nice! I'm mostly OOO today and will likely forget to do this so maybe this as a review comment would be useful. That, or a follow-up PR after moveBefore() lands)</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Fri Nov 22 2024 06:50:06 GMT-0800 (Pacific Standard Time)">14:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@noamr:matrix.org">Noam Rosenthal</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I think I might be the only one here that would be OK with falling back to insertBefore(). The argument I find convincing is that if 99% of users of this API are going to be in some generic framework-like context, all they care about is literally getting the node from A -&gt; B, and they see moveBefore() as a way to opportunistically do that atomically when possible. But either way they still want the node to end up "over there" somehow.</blockquote></mx-reply>I am also OK with falling back to <code>insertBefore</code>, ans also with what we've landed with, with a slight preference towards throwing. Though I do see both arguments.</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Fri Nov 22 2024 06:55:33 GMT-0800 (Pacific Standard Time)">14:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domfarolino:matrix.org">Dominic Farolino</span>&gt;</div></td><td class="msg-cell">I just want to protect against us trying to land something that feels academically right, but isn't what fits into most practical consumers hands</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Fri Nov 22 2024 06:57:24 GMT-0800 (Pacific Standard Time)">14:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@noamr:matrix.org">Noam Rosenthal</span>&gt;</div></td><td class="msg-cell">I do agree that the argument for throwing are a bit handwavy and need to be somewhat more concrete to be convincing. "encapsulating too much magic", "fragile design", and future proofing are indeed in an academic realm</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Fri Nov 22 2024 06:57:48 GMT-0800 (Pacific Standard Time)">14:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domfarolino:matrix.org">Dominic Farolino</span>&gt;</div></td><td class="msg-cell">I'd like to understand the "prevents us from making move possible for more scenarios in the future" argument more too. Maybe some concrete examples of what these future scenarios would be would help me get it. I guess this is just referring to relaxing the conditions in <a href="https://whatpr.org/dom/1307.html#concept-node-ensure-pre-move-validity">https://whatpr.org/dom/1307.html#concept-node-ensure-pre-move-validity</a>?</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Fri Nov 22 2024 06:59:24 GMT-0800 (Pacific Standard Time)">14:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domfarolino:matrix.org">Dominic Farolino</span>&gt;</div></td><td class="msg-cell">And I guess the argument is the future relaxation wouldn't be compatible if we don't throw <em>now</em>?</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Fri Nov 22 2024 07:02:31 GMT-0800 (Pacific Standard Time)">15:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell">Did the TPAC discussion not capture this in enough detail? I'm a bit hesitant to elaborate on everything here again as I suspect it won't be the last time and even simple PR feedback was already likely to go missing if I didn't enumerate it elsewhere.</td></tr>

</tbody></table></div></div></div>
</body></html>