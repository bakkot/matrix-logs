<!DOCTYPE html><html><head>
  <title>WHATWG on 2024-09-18</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "WHATWG";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">WHATWG<br>2024-09-18<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2024-09-17" class="nav-link"><span>prev</span></a>
<span style="float:right">next</span>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search WHATWG">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Tue Sep 17 2024 17:16:54 GMT-0700 (Pacific Daylight Time)">00:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</div></td><td class="msg-cell">I'm OK to skip.</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Tue Sep 17 2024 22:36:53 GMT-0700 (Pacific Daylight Time)">05:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <span class="nick-1">Domenic</span>: do the changes in <a href="https://github.com/w3c/csswg-drafts/issues/10550#issuecomment-2328247135">https://github.com/w3c/csswg-drafts/issues/10550#issuecomment-2328247135</a> work for you? Any preferred text for referencing this kind of serialization from HTML?</blockquote></mx-reply>Yes, they work! I think I suggested some reference text in the last sentence of <a href="https://github.com/w3c/csswg-drafts/issues/10550#issuecomment-2292850688">https://github.com/w3c/csswg-drafts/issues/10550#issuecomment-2292850688</a> . (Although I used <code>&lt;a href="..."&gt;</code> instead of <code>&lt;span data-x="..."&gt;</code> for clarity since they don't know Wattsi over there.)</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Tue Sep 17 2024 23:13:24 GMT-0700 (Pacific Daylight Time)">06:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell">I'm okay to skip as well.</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Tue Sep 17 2024 23:16:40 GMT-0700 (Pacific Daylight Time)">06:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">hsivonen</span>: <span class="nick-16">Adam Rice</span>: I'd appreciate your thoughts on <a href="https://github.com/whatwg/encoding/pull/335">https://github.com/whatwg/encoding/pull/335</a>. I'm convinced we should do GB18030-2022, but not entirely sure whether it should impact GBK or not. It seems about as incompatible for either encoding so maybe keeping them aligned is better? That would require updating the underlying table and have 18 additional encoder mappings. The alternative would be not touching the table and have 18 encoder/decoder mappings solely for gb18030.</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Wed Sep 18 2024 01:35:54 GMT-0700 (Pacific Daylight Time)">08:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@hsivonen:mozilla.org">hsivonen</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <span class="nick-15">hsivonen</span>: <span class="nick-16">Adam Rice</span>: I'd appreciate your thoughts on <a href="https://github.com/whatwg/encoding/pull/335">https://github.com/whatwg/encoding/pull/335</a>. I'm convinced we should do GB18030-2022, but not entirely sure whether it should impact GBK or not. It seems about as incompatible for either encoding so maybe keeping them aligned is better? That would require updating the underlying table and have 18 additional encoder mappings. The alternative would be not touching the table and have 18 encoder/decoder mappings solely for gb18030.</blockquote></mx-reply>It seems bad to tweak legacy encodings, and I'm not sure how much this matters in practice. I'm quite skeptical of there being real interest these days in GB18030-the-encoding as opposed to GB18030-the-repertoire with UTF-8. Making WHATWG gbk diverge from Windows 936 does not seem nice in principle, but I could see an argument why changing WHATWG gbk might make sense in practice if any of this matters in practice. Do you know if Microsoft intends to change Windows code pages 936 and 54936?</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Wed Sep 18 2024 01:40:04 GMT-0700 (Pacific Daylight Time)">08:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">hsivonen</span>: I know ICU doesn't plan to make changes to GBK. I doubt Windows would make changes. The main reason to change GBK as well is because it already inherits most of gb18030 in the Encoding Standard. E.g., GBK uses the gb18030 decoder. Anyway, we could decide to safeguard GBK from these additional changes and defend it with test coverage, I'm just not sure it's worth it. Especially as it's mainly PUA code points.</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Wed Sep 18 2024 01:40:24 GMT-0700 (Pacific Daylight Time)">08:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell">And it already regressed in Chromium and WebKit for about a year without anybody complaining...</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Wed Sep 18 2024 01:41:11 GMT-0700 (Pacific Daylight Time)">08:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@hsivonen:mozilla.org">hsivonen</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> And it already regressed in Chromium and WebKit for about a year without anybody complaining...</blockquote></mx-reply>Do you mean Chromium has implemented the gb18030 label as gb18030-2022?</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Wed Sep 18 2024 01:43:17 GMT-0700 (Pacific Daylight Time)">08:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">hsivonen</span>: some variant of gb18030-2022, yes. I think the one they currently ship is not the Unicode recommendation as they just copied the code from WebKit without much discussion. And it has impacted their implementation of GBK as well (because of the Encoding Standard sharing a lot of logic between GBK and gb18030), just like it has in WebKit...</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Wed Sep 18 2024 01:43:34 GMT-0700 (Pacific Daylight Time)">08:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@ms2ger:igalia.com">Ms2ger</span>&gt;</div></td><td class="msg-cell">ðŸ™ˆ</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Wed Sep 18 2024 01:45:09 GMT-0700 (Pacific Daylight Time)">08:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@hsivonen:mozilla.org">hsivonen</span>&gt;</div></td><td class="msg-cell">I'm already sad that our EUC-KR isn't an exact PUA match for Windows code page 949, but my sadness about this isn't really a good technical argument.</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Wed Sep 18 2024 01:47:24 GMT-0700 (Pacific Daylight Time)">08:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@hsivonen:mozilla.org">hsivonen</span>&gt;</div></td><td class="msg-cell">If gbk in both WebKit and Chromium has diverged from Windows code page 936 for a year towards less PUA, I guess it's a rather convincing sign of it being Web-compatible. What happens if you try to encode the relevant PUA code points?</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Wed Sep 18 2024 01:48:03 GMT-0700 (Pacific Daylight Time)">08:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell">Yeah, I can't say I'm thrilled about how all this went down with some flip-flopping along the way as to how exactly GB18030-2022 is to be implemented coupled with unforeseen side effects for GBK. But it is what it is.</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Wed Sep 18 2024 01:49:39 GMT-0700 (Pacific Daylight Time)">08:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">hsivonen</span>: that currently fails. <a href="https://github.com/web-platform-tests/wpt/pull/48240">https://github.com/web-platform-tests/wpt/pull/48240</a> demonstrates this. The reason is that the additional encoder code points are guarded by a gb18030 check. It's like the worst solution one can imagine.</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Wed Sep 18 2024 01:52:31 GMT-0700 (Pacific Daylight Time)">08:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell"><p><span class="nick-15">hsivonen</span>: given the three lists in <a href="https://github.com/whatwg/encoding/issues/312#issuecomment-2354764499">https://github.com/whatwg/encoding/issues/312#issuecomment-2354764499</a> my idea for the best solution given today's knowledge is as follows:</p>
<ol>
<li>We encode the 18 bidirectional mappings (the first set) directly in the gb18030 index.</li>
<li>We encode the 18 from Unicode mappings (the second set) as an additional encoder step shared by GBK and gb18030.</li>
<li>We leave the third set alone as the gb18030 decoder (and GBK decoder for that matter) already handle those as-is.</li>
</ol>
</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Wed Sep 18 2024 01:55:22 GMT-0700 (Pacific Daylight Time)">08:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@hsivonen:mozilla.org">hsivonen</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <p><span class="nick-15">hsivonen</span>: given the three lists in <a href="https://github.com/whatwg/encoding/issues/312#issuecomment-2354764499">https://github.com/whatwg/encoding/issues/312#issuecomment-2354764499</a> my idea for the best solution given today's knowledge is as follows:</p>
<ol>
<li>We encode the 18 bidirectional mappings (the first set) directly in the gb18030 index.</li>
<li>We encode the 18 from Unicode mappings (the second set) as an additional encoder step shared by GBK and gb18030.</li>
<li>We leave the third set alone as the gb18030 decoder (and GBK decoder for that matter) already handle those as-is.</li>
</ol>
</blockquote></mx-reply>Does 'as-is' in item 3 mean doing the Unicode recommendation of decoding the 4-byte sequences (as gb18030) to non-PUA (and errors in gbk)?</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Wed Sep 18 2024 01:57:34 GMT-0700 (Pacific Daylight Time)">08:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">hsivonen</span>: the GBK decoder is the gb18030 decoder. They are currently completely identical. And those sequences already map to non-PUA in the gb18030 decoder as currently specified. (This third set doesn't actually constitute a change with respect to GB18030-2005. This is a bit confusing and did result in redundant code being written for WebKit. I mentioned it to Ken Lunde, but I'm not sure much is going to be done about it.)</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Wed Sep 18 2024 01:59:07 GMT-0700 (Pacific Daylight Time)">08:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@hsivonen:mozilla.org">hsivonen</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <span class="nick-15">hsivonen</span>: the GBK decoder is the gb18030 decoder. They are currently completely identical. And those sequences already map to non-PUA in the gb18030 decoder as currently specified. (This third set doesn't actually constitute a change with respect to GB18030-2005. This is a bit confusing and did result in redundant code being written for WebKit. I mentioned it to Ken Lunde, but I'm not sure much is going to be done about it.)</blockquote></mx-reply>Ah, right sorry about my confusing about gbk decoder. If the third set stays as-is in the index, will the first set end up taking precedence over the third set in the gb18030 encoder due to existing specified search order?</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Wed Sep 18 2024 02:00:07 GMT-0700 (Pacific Daylight Time)">09:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">hsivonen</span>: if you want even more evidence, see how <a href="https://github.com/WebKit/WebKit/commit/068d177a29ad44c82c95dd204a27d4841979c301">https://github.com/WebKit/WebKit/commit/068d177a29ad44c82c95dd204a27d4841979c301</a> removed those mappings without needed corresponding changes in tests.</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Wed Sep 18 2024 02:01:23 GMT-0700 (Pacific Daylight Time)">09:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">hsivonen</span>: yeah it'll take precedence because we look at the two-byte table (index gb18030) before resorting to index gb18030 ranges</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Wed Sep 18 2024 02:03:06 GMT-0700 (Pacific Daylight Time)">09:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@hsivonen:mozilla.org">hsivonen</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <span class="nick-15">hsivonen</span>: yeah it'll take precedence because we look at the two-byte table (index gb18030) before resorting to index gb18030 ranges</blockquote></mx-reply>OK. I guess it makes sense to do this, although I don't like it that this will result in more caveats for me to mention every time I happen to talk about the relationship of the WHATWG encoding and Windows code pages. (But so far, it's only been about talking about them: no real-world evidence of practical problem either way.)</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Wed Sep 18 2024 02:04:31 GMT-0700 (Pacific Daylight Time)">09:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">hsivonen</span>: maybe just memorize a URL for when people are eager for the cliff notes? :-)</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Wed Sep 18 2024 02:05:03 GMT-0700 (Pacific Daylight Time)">09:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:matrix.org">annevk</span>&gt;</div></td><td class="msg-cell">Okay, I'll see about preparing a new PR. </td></tr>

</tbody></table></div></div></div>
</body></html>