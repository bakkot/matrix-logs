<!DOCTYPE html><html><head>
  <title>WHATWG on 2022-03-02</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "WHATWG";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">WHATWG<br>2022-03-02<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2022-03-01" class="nav-link"><span>prev</span></a>
<a href="2022-03-03" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search WHATWG">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Tue Mar 01 2022 17:07:46 GMT-0800 (Pacific Standard Time)">01:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@sideshowbarker:mozilla.org">sideshowbarker</span>&gt;</div></td><td class="msg-cell"><p><span class="nick-12">annevk</span>: <a href="https://stackoverflow.com/questions/71311305/how-to-prevent-safari-from-dropping-the-authorization-header-when-following-a-re">https://stackoverflow.com/questions/71311305/how-to-prevent-safari-from-dropping-the-authorization-header-when-following-a-re</a></p>
<blockquote>
<p>Safari seems to drop the <code>Authorization</code> header when following a [same-origin] 301 redirect... Chrome (98) and Firefox (97) both follow the redirect and include the <code>Authorization</code> header in the subsequent <code>GET</code> request.</p>
</blockquote>
<p>Wonder what behavior the spec requires here</p>
</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Tue Mar 01 2022 17:09:09 GMT-0800 (Pacific Standard Time)">01:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@sideshowbarker:mozilla.org">sideshowbarker</span>&gt;</div></td><td class="msg-cell">and <a href="https://stackoverflow.com/questions/57974176/safari-does-not-persist-the-authorization-header-on-redirect">https://stackoverflow.com/questions/57974176/safari-does-not-persist-the-authorization-header-on-redirect</a> is another 2-year-old question about the same thing</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Tue Mar 01 2022 21:12:15 GMT-0800 (Pacific Standard Time)">05:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@noamr:matrix.org">Noam Rosenthal</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <span class="nick-6">Yoav Weiss</span>: <span class="nick-8">Noam Rosenthal</span> : what is the cross-origin redirects case for unload timing protecting against? It's basically saying if you go <a href="http://x.com">x.com</a> -&gt; <a href="http://y.com">y.com</a> --redirects to-&gt; <a href="http://x.com/bar">x.com/bar</a>, <a href="http://x.com/bar">x.com/bar</a> does not get unload timing for <a href="http://x.com">x.com</a>. Why? No information about <a href="http://y.com">y.com</a> leaked.</blockquote></mx-reply>I checked, and the specific scenario (same-&gt;cross-&gt;same redirect, check that unload is not available) is tested in WPT and passes all 3 browsers... <a href="https://github.com/web-platform-tests/wpt/blob/master/navigation-timing/unload-event-same-origin-check.html#L57">https://github.com/web-platform-tests/wpt/blob/master/navigation-timing/unload-event-same-origin-check.html#L57</a><br><a href="https://wpt.fyi/results/navigation-timing/unload-event-same-origin-check.html?label=experimental&amp;label=master&amp;aligned">https://wpt.fyi/results/navigation-timing/unload-event-same-origin-check.html?label=experimental&amp;label=master&amp;aligned</a></td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Tue Mar 01 2022 21:13:09 GMT-0800 (Pacific Standard Time)">05:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@noamr:matrix.org">Noam Rosenthal</span>&gt;</div></td><td class="msg-cell">to me it seems like an unnecessary security measure or I don't understand it. <span class="nick-6">Yoav Weiss</span> ?</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Tue Mar 01 2022 21:35:56 GMT-0800 (Pacific Standard Time)">05:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@yoavweiss:matrix.org">Yoav Weiss</span>&gt;</div></td><td class="msg-cell">It's possible that this is overly strict. It used to be TAO protected and have the same rules as TAO, but at some point we realized that it's not really protecting anything (it's not the origin which information was exposed that was opting in), so moved to a same origin check. The same=&gt;cross=&gt;same scenario was one that we protected against in TAO, so maybe that logic sticked around through the move to same origin checks.</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Tue Mar 01 2022 21:37:30 GMT-0800 (Pacific Standard Time)">05:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@yoavweiss:matrix.org">Yoav Weiss</span>&gt;</div></td><td class="msg-cell">Maybe <span class="nick-12">annevk</span> has reasons as to why we should keep it, but I tend to agree with y'all that if the previous origin is the same as the destination origin, we could expose the data</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Tue Mar 01 2022 23:48:27 GMT-0800 (Pacific Standard Time)">07:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:mozilla.org">annevk</span>&gt;</div></td><td class="msg-cell">I think Referer and Sec-Fetch-Site are impacted so I think this ought to be impacted as well. What might leak is if <a href="http://y.com">y.com</a> does a further redirect based on a cookie. Now <a href="http://x.com">x.com</a> could conspire with subsequent <a href="http://x.com">x.com</a>, but given that Referer and Sec-Fetch-Site are impacted it might not entirely be clear whether it's the result of a redirect or a subsequent visit. Especially with more navigation tracking mitigation down the line.</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Tue Mar 01 2022 23:48:42 GMT-0800 (Pacific Standard Time)">07:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:mozilla.org">annevk</span>&gt;</div></td><td class="msg-cell"><span class="nick-8">Noam Rosenthal</span>: <span class="nick-6">Yoav Weiss</span>: <span class="nick-1">Domenic</span>: ^^</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Tue Mar 01 2022 23:50:49 GMT-0800 (Pacific Standard Time)">07:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@noamr:matrix.org">Noam Rosenthal</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I think Referer and Sec-Fetch-Site are impacted so I think this ought to be impacted as well. What might leak is if <a href="http://y.com">y.com</a> does a further redirect based on a cookie. Now <a href="http://x.com">x.com</a> could conspire with subsequent <a href="http://x.com">x.com</a>, but given that Referer and Sec-Fetch-Site are impacted it might not entirely be clear whether it's the result of a redirect or a subsequent visit. Especially with more navigation tracking mitigation down the line.</blockquote></mx-reply>OK so this hides the fact that the unload and the new document are the same visit, which is otherwise a hidden fact. This also brings back the <a href="https://github.com/w3c/navigation-timing/issues/160">https://github.com/w3c/navigation-timing/issues/160</a> thing...</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Tue Mar 01 2022 23:56:38 GMT-0800 (Pacific Standard Time)">07:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:mozilla.org">annevk</span>&gt;</div></td><td class="msg-cell"><span class="nick-8">Noam Rosenthal</span>: yeah, though I'd argue that case is worse.</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Tue Mar 01 2022 23:57:01 GMT-0800 (Pacific Standard Time)">07:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:mozilla.org">annevk</span>&gt;</div></td><td class="msg-cell"><span class="nick-16">sideshowbarker</span>: left a reply. Not sure if Safari has an open bug for this, maybe you want to file one?</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Tue Mar 01 2022 23:58:41 GMT-0800 (Pacific Standard Time)">07:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@sideshowbarker:mozilla.org">sideshowbarker</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <span class="nick-16">sideshowbarker</span>: left a reply. Not sure if Safari has an open bug for this, maybe you want to file one?</blockquote></mx-reply>I'll ask the OP if they can file a bug</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Wed Mar 02 2022 07:28:49 GMT-0800 (Pacific Standard Time)">15:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</div></td><td class="msg-cell">any webkit/gecko people feeling inspired? <a href="https://github.com/whatwg/websockets/issues/20">https://github.com/whatwg/websockets/issues/20</a></td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Wed Mar 02 2022 07:29:25 GMT-0800 (Pacific Standard Time)">15:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@devsnek:matrix.org">devsnek</span>&gt;</div></td><td class="msg-cell"><span class="nick-12">annevk</span>: you seemed to not hate this, in the past at least. do you think mozilla would accept contribution for this?</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Wed Mar 02 2022 07:31:45 GMT-0800 (Pacific Standard Time)">15:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title="@annevk:mozilla.org">annevk</span>&gt;</div></td><td class="msg-cell"><span class="nick-5">devsnek</span>: yeah probably, but will need spec + tests</td></tr>

</tbody></table></div></div></div>
</body></html>