<!DOCTYPE html><html><head>
  <title>WHATWG on 2021-07-07</title>
  <link rel="stylesheet" href="../style.css">
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">WHATWG<br>2021-07-07<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2021-07-06" class="nav-link"><span>prev</span></a>
<span style="float:right">next</span>
</div>
    
<div class="room-list-wrapper">Active:<br>
<ul class="room-list">
<li><a href="../TC39_Delegates/">TC39 Delegates</a></li>
<li><a href="../TC39_Editors/">TC39 Editors</a></li>
<li><a href="../TC39_General/">TC39 General</a></li>
<li><a href="../WHATWG/" class="current-room">WHATWG</a></li>
</ul>
</div>
<br>
<div class="room-list-wrapper">Historical:<br>
<ul class="room-list">
<li><a href="../irc-tc39/">#tc39</a></li>
<li><a href="../irc-tc39-delegates/">#tc39-delegates</a></li>
<li><a href="../irc-tc39-editor-group/">#tc39-editor-group</a></li>
<li><a href="../irc-whatwg/">#whatwg</a></li>
</ul>
</div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs"><div class="log">
<table><tbody id="log-tbody">
  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Tue Jul 06 2021 19:30:01 GMT-0700 (Pacific Daylight Time)">02:30</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title="@sujaldev:matrix.org">sujaldev</span>&gt;</td><td class="msg-cell">oki thanks!</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Tue Jul 06 2021 19:48:21 GMT-0700 (Pacific Daylight Time)">02:48</a></td><td class="nick-cell">&lt;<span class="nick nick-16" title="@sideshowbarker:mozilla.org">sideshowbarker</span>&gt;</td><td class="msg-cell">wonderful, <a href="https://drafts.csswg.org/">https://drafts.csswg.org/</a> completely broken again for the Nth time</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Tue Jul 06 2021 19:50:31 GMT-0700 (Pacific Daylight Time)">02:50</a></td><td class="nick-cell">&lt;<span class="nick nick-16" title="@sideshowbarker:mozilla.org">sideshowbarker</span>&gt;</td><td class="msg-cell">after this having happened so frequently, it’s baffling that there’s not a watchdog or something set up</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Tue Jul 06 2021 19:51:07 GMT-0700 (Pacific Daylight Time)">02:51</a></td><td class="nick-cell"><span class="nick nick-16" title="@sideshowbarker:mozilla.org">sideshowbarker</span></td><td class="msg-cell">goes off to raise an <a href="https://github.com/w3c/csswg-drafts">https://github.com/w3c/csswg-drafts</a> issue about it for at least the 3rd time</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Wed Jul 07 2021 05:30:45 GMT-0700 (Pacific Daylight Time)">12:30</a></td><td class="nick-cell">&lt;<span class="nick nick-4" title="@smaug:mozilla.org">smaug</span>&gt;</td><td class="msg-cell">I have asked this before, I think. Is there some documentation for a good workflow for making spec changes? Including the usual github pr creation but also what checks people do to find if there are relevant WPTs etc.</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Wed Jul 07 2021 07:18:51 GMT-0700 (Pacific Daylight Time)">14:18</a></td><td class="nick-cell">&lt;<span class="nick nick-14" title="@fbraun:mozilla.org">freddy</span>&gt;</td><td class="msg-cell">Admittedly, you are probably not exactly the intended audience but this might help <a href="https://wpc.guide/bug-guide/">https://wpc.guide/bug-guide/</a> </td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Wed Jul 07 2021 07:19:20 GMT-0700 (Pacific Daylight Time)">14:19</a></td><td class="nick-cell">&lt;<span class="nick nick-14" title="@fbraun:mozilla.org">freddy</span>&gt;</td><td class="msg-cell">but TBH, I often just look at similar patches and the follow-up bugs (e.g., for WPT) they led to</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Wed Jul 07 2021 09:49:10 GMT-0700 (Pacific Daylight Time)">16:49</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell"><span class="nick-12">annevk</span>: domenic suggested you might have an opinion on <a href="https://github.com/bakkot/proposal-arraybuffer-base64/issues/5">https://github.com/bakkot/proposal-arraybuffer-base64/issues/5</a>. the question under consideration (as I see it; he is welcome to correct) is, must any new base64-decoding API in the web platform decline to validate the padding bytes by default (and hence match the behavior of <code>atob</code>), or can it be stricter by default in pursuit of making it harder to accidentally fall into security issues arising from the (I think fairly natural) assumption that base64 encoding is one-to-one?</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Wed Jul 07 2021 09:49:26 GMT-0700 (Pacific Daylight Time)">16:49</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">also interested in opinions from others</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Wed Jul 07 2021 09:50:38 GMT-0700 (Pacific Daylight Time)">16:50</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell"><span class="nick-1">Domenic</span> seems to feel strongly that it is more important to match <code>atob</code>, I feel fairly strongly that it is more important to make the less-secure behavior opt-in, so I am hoping we can get other opinions on the matter</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Wed Jul 07 2021 09:55:31 GMT-0700 (Pacific Daylight Time)">16:55</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</td><td class="msg-cell">Matching data: URLs and other base64 encoding behaviors in the platform (e.g. SRI digests) is more important than atob</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Wed Jul 07 2021 10:01:30 GMT-0700 (Pacific Daylight Time)">17:01</a></td><td class="nick-cell">&lt;<span class="nick nick-3" title="@lucacasonato:matrix.org">Luca Casonato</span>&gt;</td><td class="msg-cell">I agree</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Wed Jul 07 2021 10:03:20 GMT-0700 (Pacific Daylight Time)">17:03</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">I understand that position even less; how many people are ever manually decoding a data: url or an SRI digest?</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Wed Jul 07 2021 10:04:15 GMT-0700 (Pacific Daylight Time)">17:04</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">(CSP, incidentally, requires padding, so the web platform is not uniform here)</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Wed Jul 07 2021 10:05:42 GMT-0700 (Pacific Daylight Time)">17:05</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">actually SRI does too, as far as I can tell from the spec</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Wed Jul 07 2021 10:06:59 GMT-0700 (Pacific Daylight Time)">17:06</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</td><td class="msg-cell">Yeah the spec doesn't seem to match browsers there</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Wed Jul 07 2021 10:08:11 GMT-0700 (Pacific Daylight Time)">17:08</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</td><td class="msg-cell">I can't find base64 decoding in the CSP/SRI specs, only the implementations</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Wed Jul 07 2021 10:09:53 GMT-0700 (Pacific Daylight Time)">17:09</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">that's because they don't aren't specified in terms of decoding; they compare by string equality, and assume that base64 encoding is 1-to-1, since everyone makes this assumption.</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Wed Jul 07 2021 10:09:58 GMT-0700 (Pacific Daylight Time)">17:09</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell"> * that's because they aren't specified in terms of decoding; they compare by string equality, and assume that base64 encoding is 1-to-1, since everyone makes this assumption.</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Wed Jul 07 2021 10:10:10 GMT-0700 (Pacific Daylight Time)">17:10</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell"> * that's because they aren't specified in terms of decoding; they compare base64-encoded strings by string equality, and assume that base64 encoding is 1-to-1, since everyone makes this assumption.</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Wed Jul 07 2021 10:17:28 GMT-0700 (Pacific Daylight Time)">17:17</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell"><mx-reply><blockquote> Yeah the spec doesn't seem to match browsers there</blockquote></mx-reply>Browsers disagree; Firefox follows the spec, Chrome does not</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Wed Jul 07 2021 10:22:48 GMT-0700 (Pacific Daylight Time)">17:22</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell"> * that's because they aren't specified in terms of decoding; they compare base64-encoded strings by string equality, and assume that base64 decoding is 1-to-1, since everyone makes this assumption.</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Wed Jul 07 2021 10:39:40 GMT-0700 (Pacific Daylight Time)">17:39</a></td><td class="nick-cell">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</td><td class="msg-cell"><blockquote>
<p>that's because they aren't specified in terms of decoding; they compare base64-encoded strings by string equality, and assume that base64 decoding is 1-to-1, since everyone makes this assumption.</p>
</blockquote>
<p>i find this footgun argument to be pretty persuasive. fwiw i feel more radicalized than before from reading those tweets, and feel like if anything we should try to change the web default</p>
</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Wed Jul 07 2021 10:52:51 GMT-0700 (Pacific Daylight Time)">17:52</a></td><td class="nick-cell">&lt;<span class="nick nick-16" title="@sideshowbarker:mozilla.org">sideshowbarker</span>&gt;</td><td class="msg-cell"><span class="nick-1">Domenic</span>: r? <a href="https://github.com/whatwg/whatwg.org/pull/371">https://github.com/whatwg/whatwg.org/pull/371</a></td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Wed Jul 07 2021 10:58:26 GMT-0700 (Pacific Daylight Time)">17:58</a></td><td class="nick-cell">&lt;<span class="nick nick-16" title="@sideshowbarker:mozilla.org">sideshowbarker</span>&gt;</td><td class="msg-cell"><span class="nick-1">Domenic</span>: also <a href="https://github.com/whatwg/html-build/pull/265">https://github.com/whatwg/html-build/pull/265</a></td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Wed Jul 07 2021 11:00:38 GMT-0700 (Pacific Daylight Time)">18:00</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</td><td class="msg-cell"><mx-reply><blockquote> <blockquote>
<p>that's because they aren't specified in terms of decoding; they compare base64-encoded strings by string equality, and assume that base64 decoding is 1-to-1, since everyone makes this assumption.</p>
</blockquote>
<p>i find this footgun argument to be pretty persuasive. fwiw i feel more radicalized than before from reading those tweets, and feel like if anything we should try to change the web default</p>
</blockquote></mx-reply>I just don't think these people are JS practictioners. They are crypto people (?) who maybe use base64 for crypto purposes. We should not expose base64 at all if our audience is people hand-rolling crypto.</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Wed Jul 07 2021 11:00:46 GMT-0700 (Pacific Daylight Time)">18:00</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</td><td class="msg-cell">Note also that the tweets note that Go has the same default as JS</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Wed Jul 07 2021 11:01:01 GMT-0700 (Pacific Daylight Time)">18:01</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</td><td class="msg-cell">It feels really bad for TC39 to try to shift the web default by fiat</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Wed Jul 07 2021 11:02:49 GMT-0700 (Pacific Daylight Time)">18:02</a></td><td class="nick-cell">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</td><td class="msg-cell">the "we shouldn't expose this at all" is a separate argument, which i think i also disagree with, but we should table in this context</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Wed Jul 07 2021 11:03:38 GMT-0700 (Pacific Daylight Time)">18:03</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</td><td class="msg-cell">Well it's relevant because what is our goal in exposing this</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Wed Jul 07 2021 11:03:53 GMT-0700 (Pacific Daylight Time)">18:03</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</td><td class="msg-cell">Is it to allow people to decode base64 in a fashion they're used to from Node/Go/Deno/the web?</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Wed Jul 07 2021 11:04:08 GMT-0700 (Pacific Daylight Time)">18:04</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</td><td class="msg-cell">Or is it to allow people to do secure crypto-adjacent stuff that assumes bijection?</td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Wed Jul 07 2021 11:04:20 GMT-0700 (Pacific Daylight Time)">18:04</a></td><td class="nick-cell">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</td><td class="msg-cell"><mx-reply><blockquote> It feels really bad for TC39 to try to shift the web default by fiat</blockquote></mx-reply>i have a hard time engaging with this as well -- there are technical reasons to prefer the stricter variant, which there is disagreement with. it similarly feels bad to accuse TC39 of some kind of power grab here</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Wed Jul 07 2021 11:04:20 GMT-0700 (Pacific Daylight Time)">18:04</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">Filippo Valsorda is one of the people your employer pays to be hand-rolling crypto</td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Wed Jul 07 2021 11:04:39 GMT-0700 (Pacific Daylight Time)">18:04</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</td><td class="msg-cell"><mx-reply><blockquote> Filippo Valsorda is one of the people your employer pays to be hand-rolling crypto</blockquote></mx-reply>Yes, and I don't think he's the target audience for this API.</td></tr>
  <tr class="msg" id="L35"><td class="ts-cell"><a class="ts" href="#L35" alt="Wed Jul 07 2021 11:04:57 GMT-0700 (Pacific Daylight Time)">18:04</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</td><td class="msg-cell">I don't really think pointing at someone with a different opinion and saying "you get your money from the same dude" is really that insightful</td></tr>
  <tr class="msg" id="L36"><td class="ts-cell"><a class="ts" href="#L36" alt="Wed Jul 07 2021 11:05:27 GMT-0700 (Pacific Daylight Time)">18:05</a></td><td class="nick-cell">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</td><td class="msg-cell">yes let's... cool down on that front</td></tr>
  <tr class="msg" id="L37"><td class="ts-cell"><a class="ts" href="#L37" alt="Wed Jul 07 2021 11:10:51 GMT-0700 (Pacific Daylight Time)">18:10</a></td><td class="nick-cell">&lt;<span class="nick nick-3" title="@lucacasonato:matrix.org">Luca Casonato</span>&gt;</td><td class="msg-cell">Just for clarity: this is about the strictness of base64 <strong>decoding</strong> right? We do all agree that base64 encoding should always include padding?</td></tr>
  <tr class="msg" id="L38"><td class="ts-cell"><a class="ts" href="#L38" alt="Wed Jul 07 2021 11:11:55 GMT-0700 (Pacific Daylight Time)">18:11</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</td><td class="msg-cell">Yes</td></tr>
  <tr class="msg" id="L39"><td class="ts-cell"><a class="ts" href="#L39" alt="Wed Jul 07 2021 11:12:06 GMT-0700 (Pacific Daylight Time)">18:12</a></td><td class="nick-cell">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</td><td class="msg-cell">i've tried to steer the conversation to something more pragmatic, but so long as we're talking about broad-scope arguments like "we shouldn't diverge at all from existing standardized web APIs" and "the current default is not great", i do find the latter more convincing because i'm not sure what group the former position helps in this particular case</td></tr>
  <tr class="msg" id="L40"><td class="ts-cell"><a class="ts" href="#L40" alt="Wed Jul 07 2021 11:12:53 GMT-0700 (Pacific Daylight Time)">18:12</a></td><td class="nick-cell">&lt;<span class="nick nick-3" title="@lucacasonato:matrix.org">Luca Casonato</span>&gt;</td><td class="msg-cell">In this case, what are some arguments for being strict with padding by default? What use cases would this benefit?</td></tr>
  <tr class="msg" id="L41"><td class="ts-cell"><a class="ts" href="#L41" alt="Wed Jul 07 2021 11:13:02 GMT-0700 (Pacific Daylight Time)">18:13</a></td><td class="nick-cell">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</td><td class="msg-cell">for the concrete AMP case, it seemed like the weird Java printer was, well, regarded as weird, and an attempt was made to fix it</td></tr>
  <tr class="msg" id="L42"><td class="ts-cell"><a class="ts" href="#L42" alt="Wed Jul 07 2021 11:13:59 GMT-0700 (Pacific Daylight Time)">18:13</a></td><td class="nick-cell">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</td><td class="msg-cell"><mx-reply><blockquote> In this case, what are some arguments for being strict with padding by default? What use cases would this benefit?</blockquote></mx-reply>the use case that the (imo reasonable) assumption that base64 is a bijection holds, and that when it does not, it prompts the author to take a second look and figure out why</td></tr>
  <tr class="msg" id="L43"><td class="ts-cell"><a class="ts" href="#L43" alt="Wed Jul 07 2021 11:16:00 GMT-0700 (Pacific Daylight Time)">18:16</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</td><td class="msg-cell">Who is going around saying "I really want bijection"? I'm worried about people going "I want to switch from Buffer.from(x, "base64") to the new thing, but I did and now we have a production outage because I didn't know about how TC39 decided to diverge from Node semantics and data that used to work now fails"</td></tr>
  <tr class="msg" id="L44"><td class="ts-cell"><a class="ts" href="#L44" alt="Wed Jul 07 2021 11:16:28 GMT-0700 (Pacific Daylight Time)">18:16</a></td><td class="nick-cell">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</td><td class="msg-cell">i think that's precisely the point of why it's so surprising -- nobody's going around saying that because they don't even realize it's not. i certainly didn't!</td></tr>
  <tr class="msg" id="L45"><td class="ts-cell"><a class="ts" href="#L45" alt="Wed Jul 07 2021 11:16:58 GMT-0700 (Pacific Daylight Time)">18:16</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</td><td class="msg-cell">I suspect people don't <em>expect</em> it.</td></tr>
  <tr class="msg" id="L46"><td class="ts-cell"><a class="ts" href="#L46" alt="Wed Jul 07 2021 11:17:09 GMT-0700 (Pacific Daylight Time)">18:17</a></td><td class="nick-cell">&lt;<span class="nick nick-3" title="@lucacasonato:matrix.org">Luca Casonato</span>&gt;</td><td class="msg-cell"><mx-reply><blockquote> the use case that the (imo reasonable) assumption that base64 is a bijection holds, and that when it does not, it prompts the author to take a second look and figure out why</blockquote></mx-reply><span class="nick-8">shu</span>: Many other languages and ecosystems have set the precedent that this is not the case though: Go, Python, Java, Deno, Node, Rust. I don't think it is a reasonable assumption to make.</td></tr>
  <tr class="msg" id="L47"><td class="ts-cell"><a class="ts" href="#L47" alt="Wed Jul 07 2021 11:17:21 GMT-0700 (Pacific Daylight Time)">18:17</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</td><td class="msg-cell">Bijection is just not a property one usually insists on for encoding/decoding, is my claim. Certainly not with text encodings!</td></tr>
  <tr class="msg" id="L48"><td class="ts-cell"><a class="ts" href="#L48" alt="Wed Jul 07 2021 11:17:28 GMT-0700 (Pacific Daylight Time)">18:17</a></td><td class="nick-cell">&lt;<span class="nick nick-3" title="@lucacasonato:matrix.org">Luca Casonato</span>&gt;</td><td class="msg-cell"><a href="https://docs.rs/base64/0.13.0/base64/">https://docs.rs/base64/0.13.0/base64/</a> &lt;- too little padding is ok, too much is not</td></tr>
  <tr class="msg" id="L49"><td class="ts-cell"><a class="ts" href="#L49" alt="Wed Jul 07 2021 11:17:31 GMT-0700 (Pacific Daylight Time)">18:17</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell"><span class="nick-1">Domenic</span>: to be clear, <code>Buffer.from(x, "base64")</code> accepts <em>mixed</em> base64 and base64url in the same string, which I am definitely not proposing to support</td></tr>
  <tr class="msg" id="L50"><td class="ts-cell"><a class="ts" href="#L50" alt="Wed Jul 07 2021 11:17:49 GMT-0700 (Pacific Daylight Time)">18:17</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</td><td class="msg-cell"><mx-reply><blockquote> <span class="nick-1">Domenic</span>: to be clear, <code>Buffer.from(x, "base64")</code> accepts <em>mixed</em> base64 and base64url in the same string, which I am definitely not proposing to support</blockquote></mx-reply>Well OK, that's pretty bonkers, fair enough.</td></tr>
  <tr class="msg" id="L51"><td class="ts-cell"><a class="ts" href="#L51" alt="Wed Jul 07 2021 11:17:54 GMT-0700 (Pacific Daylight Time)">18:17</a></td><td class="nick-cell">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</td><td class="msg-cell"><span class="nick-1">Domenic</span>: i'm worried about the latter too, but that's why i want more data here! it's all too easy to raise the specter of possible compat breakage</td></tr>
  <tr class="msg" id="L52"><td class="ts-cell"><a class="ts" href="#L52" alt="Wed Jul 07 2021 11:18:01 GMT-0700 (Pacific Daylight Time)">18:18</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell">(CSP does too, fun fact)</td></tr>
  <tr class="msg" id="L53"><td class="ts-cell"><a class="ts" href="#L53" alt="Wed Jul 07 2021 11:18:21 GMT-0700 (Pacific Daylight Time)">18:18</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</td><td class="msg-cell">Seems like <em>that</em> should be a non-default mode...</td></tr>
  <tr class="msg" id="L54"><td class="ts-cell"><a class="ts" href="#L54" alt="Wed Jul 07 2021 11:18:32 GMT-0700 (Pacific Daylight Time)">18:18</a></td><td class="nick-cell">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</td><td class="msg-cell">and while we're here and i'm a little worked up, i really want us to stop pitting whatwg-vs-tc39, both inside and outside of tc39</td></tr>
  <tr class="msg" id="L55"><td class="ts-cell"><a class="ts" href="#L55" alt="Wed Jul 07 2021 11:18:41 GMT-0700 (Pacific Daylight Time)">18:18</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</td><td class="msg-cell">(I'll open a tracking issue)</td></tr>
  <tr class="msg" id="L56"><td class="ts-cell"><a class="ts" href="#L56" alt="Wed Jul 07 2021 11:19:59 GMT-0700 (Pacific Daylight Time)">18:19</a></td><td class="nick-cell">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</td><td class="msg-cell">i mean, obviously JS is a stakeholder in the web platform and we want to improve it too. there are delegate who don't care about the web as much, but perpetuating that dichotomy entrenches that position which is counter-productive</td></tr>
  <tr class="msg" id="L57"><td class="ts-cell"><a class="ts" href="#L57" alt="Wed Jul 07 2021 11:27:04 GMT-0700 (Pacific Daylight Time)">18:27</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title="@domenicdenicola:matrix.org">Domenic</span>&gt;</td><td class="msg-cell">I don't think this is a very WHATWG-vs.-TC39 thing; for me at least I tried to frame all my comments as about technical/API surface concerns on each proposal. E.g. even if TC39 wants to do this then I still am unsure about putting things on the prototypes vs. a separate utility class.

At first I thought it was more a web-vs-non-web thing. But recent research showing that Deno/Node/Go/etc. all do forgiving base-64 makes it seem like it's not even that. It's apparently about whether you expect a new JS API to have some bijection property vs. whether you expect it to align with the JS ecosystem/other standard library APIs.</td></tr>
  <tr class="msg" id="L58"><td class="ts-cell"><a class="ts" href="#L58" alt="Wed Jul 07 2021 11:31:13 GMT-0700 (Pacific Daylight Time)">18:31</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</td><td class="msg-cell"><mx-reply><blockquote> Bijection is just not a property one usually insists on for encoding/decoding, is my claim. Certainly not with text encodings!</blockquote></mx-reply><p>My claim is that a great many people <em>assume</em> it holds, for base64 in particular. Either Chrome's implementation of CSP or the CSP spec itself assumes it holds, so it's not like it's only amateurs who make this mistake. (I don't know what the intent of the CSP authors was, so I'm not saying Chrome is wrong, just that it doesn't match the spec-as-written.)</p>
<p>That is to say, my claim is that very few people have the correct intuition about what <code>atob</code> and friends actually do in this edge case, and in any case are unlikely to be exposed to it, and as such we should match what they expect these APIs to do, not what they actually do.</p>
</td></tr>
  <tr class="msg" id="L59"><td class="ts-cell"><a class="ts" href="#L59" alt="Wed Jul 07 2021 11:35:11 GMT-0700 (Pacific Daylight Time)">18:35</a></td><td class="nick-cell">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</td><td class="msg-cell"><mx-reply><blockquote> I don't think this is a very WHATWG-vs.-TC39 thing; for me at least I tried to frame all my comments as about technical/API surface concerns on each proposal. E.g. even if TC39 wants to do this then I still am unsure about putting things on the prototypes vs. a separate utility class.<br><br>At first I thought it was more a web-vs-non-web thing. But recent research showing that Deno/Node/Go/etc. all do forgiving base-64 makes it seem like it's not even that. It's apparently about whether you expect a new JS API to have some bijection property vs. whether you expect it to align with the JS ecosystem/other standard library APIs.</blockquote></mx-reply>i was responding mainly to the "TC39 tries to shift the web default by fiat" comment</td></tr>
  <tr class="msg" id="L60"><td class="ts-cell"><a class="ts" href="#L60" alt="Wed Jul 07 2021 13:13:47 GMT-0700 (Pacific Daylight Time)">20:13</a></td><td class="nick-cell">&lt;<span class="nick nick-3" title="@timothygu:matrix.org">timothygu</span>&gt;</td><td class="msg-cell"><p>Another data point in the "base64-being-bijection" problem. By default, the GNU coreutils <code>base64</code> program <em>emits</em> base64-encoded output wrapped at 76 cols, so already it requires whitespace to be ignored during decoding. In terms of decoding, all popular non-JS base64 decoders that I tested (Perl, Python, Ruby, coreutils) ignore whitespace and treat <code>YQ==</code> and <code>YR==</code> similarly (return <code>a</code> with no errors).</p>
<p>It really seems like forgiving-decode is already an established default across ecosystems.</p>
</td></tr>
</tbody></table>
</div></div></div>
</body></html>