<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>Pipeline Champions on 2025-08-05</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "Pipeline Champions";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">Pipeline Champions<br>2025-08-05<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2025-05-14" class="nav-link"><span>prev</span></a>
<a href="2025-08-06" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search Pipeline Champions">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Tue Aug 05 2025 06:39:31 GMT-0700 (Pacific Daylight Time)">13:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">PHP got a pipeline operator: <a href="https://thephp.foundation/blog/2025/07/11/php-85-adds-pipe-operator/">https://thephp.foundation/blog/2025/07/11/php-85-adds-pipe-operator/</a></td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Tue Aug 05 2025 06:40:05 GMT-0700 (Pacific Daylight Time)">13:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">It looks like its using F# style, since the RHS must be callable</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Tue Aug 05 2025 06:49:09 GMT-0700 (Pacific Daylight Time)">13:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">Yah, but PHP doesn’t have first class functions for every fn value, so it’s a bunch of <code>foo(…)</code></td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Tue Aug 05 2025 06:49:51 GMT-0700 (Pacific Daylight Time)">13:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">Any arbitrary expressions are wrapped in a closure</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Tue Aug 05 2025 06:50:28 GMT-0700 (Pacific Daylight Time)">13:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">I think our F# supporters would still be unhappy with this syntax.</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Tue Aug 05 2025 06:50:45 GMT-0700 (Pacific Daylight Time)">13:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">In lieu of PFA, we would have had to do the same for F# style. And they did get first-class callables</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Tue Aug 05 2025 06:50:52 GMT-0700 (Pacific Daylight Time)">13:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><a href="https://wiki.php.net/rfc/first_class_callable_syntax">https://wiki.php.net/rfc/first_class_callable_syntax</a></td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Tue Aug 05 2025 06:51:41 GMT-0700 (Pacific Daylight Time)">13:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">Yah, that’s the <code>(…)</code> to turn it into a first class callable function.</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Tue Aug 05 2025 06:52:11 GMT-0700 (Pacific Daylight Time)">13:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">Functions aren’t callable by pipe by default</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Tue Aug 05 2025 06:52:40 GMT-0700 (Pacific Daylight Time)">13:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Ah. My PFA proposal did have <code>...</code> in addition to <code>?</code></td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Tue Aug 05 2025 06:52:55 GMT-0700 (Pacific Daylight Time)">13:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">You could assign the <code>var f = foo(…)</code> and pass that to pipe directly</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Tue Aug 05 2025 06:54:09 GMT-0700 (Pacific Daylight Time)">13:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@nribaudo:igalia.com">Nic</span>&gt;</div></td><td class="msg-cell">`x |&gt; filter(isOnSale(...))`<br><br>It this calling filter passing the closure to it, and then calling the result of filter with x?</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Tue Aug 05 2025 06:56:24 GMT-0700 (Pacific Daylight Time)">13:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Ah. My PFA proposal did have <code>...</code> in addition to <code>?</code></blockquote></mx-reply>They mirrored your proposal: <a href="https://wiki.php.net/rfc/partial_function_application">https://wiki.php.net/rfc/partial_function_application</a></td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Tue Aug 05 2025 06:56:28 GMT-0700 (Pacific Daylight Time)">13:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">filter takes a closure and returns a closure</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Tue Aug 05 2025 06:57:10 GMT-0700 (Pacific Daylight Time)">13:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">It looks like they didn't move forward with it though, due to engine complexity, per the pipeline article.</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Tue Aug 05 2025 06:57:55 GMT-0700 (Pacific Daylight Time)">13:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> `x |&gt; filter(isOnSale(...))`<br><br>It this calling filter passing the closure to it, and then calling the result of filter with x?</blockquote></mx-reply>Yes</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Tue Aug 05 2025 06:59:21 GMT-0700 (Pacific Daylight Time)">13:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> It looks like they didn't move forward with it though, due to engine complexity, per the pipeline article.</blockquote></mx-reply>At the end of the article, they mention trying again for 8.5 or 8.6</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Tue Aug 05 2025 07:00:47 GMT-0700 (Pacific Daylight Time)">14:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">They even call our performance of closure allocations when not using literal syntax directly in the RHS</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Tue Aug 05 2025 07:01:14 GMT-0700 (Pacific Daylight Time)">14:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell"><a href="https://wiki.php.net/rfc/pipe-operator-v3#:~:text=Performance">https://wiki.php.net/rfc/pipe-operator-v3#:~:text=Performance</a></td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Tue Aug 05 2025 07:06:10 GMT-0700 (Pacific Daylight Time)">14:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><code>x |&gt; f(?)</code> could be statically optimized to <code>x |&gt; (_) =&gt; f(_)</code>.</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Tue Aug 05 2025 07:11:19 GMT-0700 (Pacific Daylight Time)">14:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">Yup</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Tue Aug 05 2025 10:51:52 GMT-0700 (Pacific Daylight Time)">17:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@tabatkins:matrix.org">TabAtkins</span>&gt;</div></td><td class="msg-cell">I'm not finding filter() or map() in the php manual. Are these meant to be assumed to be user-defined HOFs?</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Tue Aug 05 2025 12:29:32 GMT-0700 (Pacific Daylight Time)">19:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><p>Assumed from context.:</p>
<blockquote>
<p>Or, consider that the right-side can also be a function call that returns a Closure. That means with a few functions that return functions: ...</p>
</blockquote>
<p>and the definition of <code>maybe</code> further down:</p>
<pre><code class="language-php">function maybe(\Closure $c): \Closure
{
    return fn(mixed $arg) =&gt; $arg === null ? null : $c($arg);
}
</code></pre>
</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Tue Aug 05 2025 13:28:31 GMT-0700 (Pacific Daylight Time)">20:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</div></td><td class="msg-cell"><p>This PHP first-class callable syntax is interesting because they call it out as an “alternative” to PFA syntax, insofar that “the vast majority of PFA uses” would be “to acquire a callable, without partially applying any arguments”.</p>
<p>The first-class callable proposal also notes, “A PFA-based optimization would entail significant overhead relative to simple function calls, unless special optimization for the pipe operator usage is introduced (which may not be possible, depending on precise semantics).” This is similar to the pushback we’ve gotten from the big JS engines.</p>
<p>And then this first-class callable syntax results in a pipe syntax that is <em>not tacit</em>—it requires using <code>(...)</code> on every unary function call.</p>
<p>And then they require wrapping n-ary function calls in pipes with unary closures, like <code>fn($x) =&gt; array_map(strtoupper(...), $x)</code>.</p>
<p>They punt this to a future PFA proposal. The pipe v3 proposal says, “Should the proposed follow-up RFC of Partial Function Application RFC (see below) be approved, it would be logical and recommended for a similar optimization to be made when a PFA appears on the right-side of pipe.” Which seems optimistic compared to the cautious statement in the first-class callable proposal?</p>
<p>Lastly, like Justin mentioned, the pipe v3 proposal says that their pipe’s requiring that n-ary function calls be wrapped in unary closures “gives a little overhead over making all calls directly, but only in some cases, and not dramatically so”. This contrasts with the JS engines’ concerns about GC thrashing due to closure creation in hot paths.</p></td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Tue Aug 05 2025 13:29:37 GMT-0700 (Pacific Daylight Time)">20:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <code>x |&gt; f(?)</code> could be statically optimized to <code>x |&gt; (_) =&gt; f(_)</code>.</blockquote></mx-reply>I vaguely remember an engine implementor saying this kind of closure substitution not being possible to stack traces and other side effects of closure creation…I’d have to double check.</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Tue Aug 05 2025 13:30:26 GMT-0700 (Pacific Daylight Time)">20:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I'm not finding filter() or map() in the php manual. Are these meant to be assumed to be user-defined HOFs?</blockquote></mx-reply>They’re called array_map and array_filter. The pipe v3 proposal’s code samples link to their pages.</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Tue Aug 05 2025 13:30:49 GMT-0700 (Pacific Daylight Time)">20:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</div></td><td class="msg-cell"><a href="https://www.php.net/array_map">https://www.php.net/array_map</a></td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Tue Aug 05 2025 13:31:03 GMT-0700 (Pacific Daylight Time)">20:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@tabatkins:matrix.org">TabAtkins</span>&gt;</div></td><td class="msg-cell">No, <code>array_map</code>/etc take a closure <em>and</em> an array.</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Tue Aug 05 2025 13:34:52 GMT-0700 (Pacific Daylight Time)">20:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</div></td><td class="msg-cell">I think Ron was talking about Nicolò’s <code>x |&gt; filter(isOnSale(...))</code> question, but Nicolò was probably just abbreviating it from the PHP pipe v3 proposal’s <code>|&gt; fn(array $ws) =&gt; array_filter(isOnSale(...), $ws)</code> example.</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Tue Aug 05 2025 13:36:46 GMT-0700 (Pacific Daylight Time)">20:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">This seems like inlining to me, plus an extra frame just to represent PFA here seems unnecessary.</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Tue Aug 05 2025 13:37:16 GMT-0700 (Pacific Daylight Time)">20:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">All of the examples in the article are fairly handwavy</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Tue Aug 05 2025 13:40:40 GMT-0700 (Pacific Daylight Time)">20:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">Filter is used in the blog post, it’s hand waved as a higher order closure returning function.</td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Tue Aug 05 2025 13:41:00 GMT-0700 (Pacific Daylight Time)">20:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">To avoid the inline closure in pipeline.</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Tue Aug 05 2025 13:42:10 GMT-0700 (Pacific Daylight Time)">20:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> This seems like inlining to me, plus an extra frame just to represent PFA here seems unnecessary.</blockquote></mx-reply><p>Here’s the relevant part from my notes in <a href="https://github.com/tc39/proposal-pipeline-operator/issues/221">https://github.com/tc39/proposal-pipeline-operator/issues/221</a>. It’s more about named HOFs than PFA syntax per se?</p>
<blockquote>
<p>The engine implementers have said that they would have much difficulty with optimizing these closures by inlining.<br>
This is especially difficult when the closures were created by a named function and must appear in error stack traces.<br>
For example, an engine might easily inline [1, 2, 3].map(x =&gt; x + 1).<br>
But given a curried add function, [1, 2, 3].map(add(1)) may be difficult to inline—especially if add can throw an error.<br>
Error stack traces are observable by the developer, and any function that may throw an error must be preserved for the error stack.</p>
</blockquote></td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Tue Aug 05 2025 13:43:13 GMT-0700 (Pacific Daylight Time)">20:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</div></td><td class="msg-cell">But in the end everything is possible, so it’s more about to what extent it “would be difficult and complex for them to optimize for relatively little gain from their perspective”.</td></tr>
  <tr class="msg" id="L35"><td class="ts-cell"><a class="ts" href="#L35" alt="Tue Aug 05 2025 13:45:00 GMT-0700 (Pacific Daylight Time)">20:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">That seems to suppose <code>add</code> is something like <code>function add(x) { return _ =&gt; _ + x; }</code>? I'm talking about <code>[1, 2, 3].map(add(?, 1))</code>, where <code>add</code> is just <code>function add(x, y) { x + y }</code>. The inlining in question here is the transformation of <code>add(?, 1)</code> to <code>_ =&gt; add(_, 1)</code>, which would have the same inlining applied as regular <code>[1, 2, 3].map(_ =&gt; add(_, 1))</code>.</td></tr>
  <tr class="msg" id="L36"><td class="ts-cell"><a class="ts" href="#L36" alt="Tue Aug 05 2025 13:47:23 GMT-0700 (Pacific Daylight Time)">20:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</div></td><td class="msg-cell">Yes. It is a good point that a PFA syntax would allow engines to statically determine that a closure cannot throw and does not need an error frame—and this is <em>unlike</em> curried functions or other named HoFs.</td></tr>
  <tr class="msg" id="L37"><td class="ts-cell"><a class="ts" href="#L37" alt="Tue Aug 05 2025 13:47:32 GMT-0700 (Pacific Daylight Time)">20:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Ignoring evaluation order (which can be preserved using temporary storage), in an F# pipe, <code>a |&gt; B |&gt; C</code> can be essentially rewritten to <code>C(B(a))</code>. In that case <code>a |&gt; B(?, 1) |&gt; C</code> would be rewritten to <code>C(B(a, 1))</code>, so a frame specific to PFA is unnecessary.</td></tr>
  <tr class="msg" id="L38"><td class="ts-cell"><a class="ts" href="#L38" alt="Tue Aug 05 2025 13:49:35 GMT-0700 (Pacific Daylight Time)">20:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</div></td><td class="msg-cell">Do you recall many of the engine implementers’ specific objections to PFA syntax’s performance from back circa 2020? Other than general optimization complexity burden or concerns about encouraging developers to create more non-inlineable closures.</td></tr>
  <tr class="msg" id="L39"><td class="ts-cell"><a class="ts" href="#L39" alt="Tue Aug 05 2025 13:51:11 GMT-0700 (Pacific Daylight Time)">20:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">IIRC, the main objection was that ad-hoc arrows in general are expensive, and a syntax to make it easier to write ad-hoc arrows wasn't preferred.</td></tr>
  <tr class="msg" id="L40"><td class="ts-cell"><a class="ts" href="#L40" alt="Tue Aug 05 2025 13:51:33 GMT-0700 (Pacific Daylight Time)">20:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@tabatkins:matrix.org">TabAtkins</span>&gt;</div></td><td class="msg-cell">Yup, that's the general objection to FP-based pipeline</td></tr>
  <tr class="msg" id="L41"><td class="ts-cell"><a class="ts" href="#L41" alt="Tue Aug 05 2025 13:52:04 GMT-0700 (Pacific Daylight Time)">20:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">IMO you're not likely to use PFA anywhere you wouldn't already be writing an ad-hoc arrow except for F#-style pipes, in which case they could be inlined so the cost wouldn't be observed.</td></tr>
  <tr class="msg" id="L42"><td class="ts-cell"><a class="ts" href="#L42" alt="Tue Aug 05 2025 13:52:35 GMT-0700 (Pacific Daylight Time)">20:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</div></td><td class="msg-cell">Right, so it was that they were concerned about a general increase in closure creation.</td></tr>
  <tr class="msg" id="L43"><td class="ts-cell"><a class="ts" href="#L43" alt="Tue Aug 05 2025 13:52:35 GMT-0700 (Pacific Daylight Time)">20:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@tabatkins:matrix.org">TabAtkins</span>&gt;</div></td><td class="msg-cell">No, the PHP article uses <code>filter()</code> and <code>map()</code> itself, as HOFs.</td></tr>
  <tr class="msg" id="L44"><td class="ts-cell"><a class="ts" href="#L44" alt="Tue Aug 05 2025 13:52:45 GMT-0700 (Pacific Daylight Time)">20:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</div></td><td class="msg-cell">(Yeah, I missed those, sorry.)</td></tr>
  <tr class="msg" id="L45"><td class="ts-cell"><a class="ts" href="#L45" alt="Tue Aug 05 2025 13:52:51 GMT-0700 (Pacific Daylight Time)">20:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">The fact we advanced Iterator helpers, which also depends on ad hoc arrows, weakens that argument, IMO.</td></tr>
  <tr class="msg" id="L46"><td class="ts-cell"><a class="ts" href="#L46" alt="Tue Aug 05 2025 13:56:30 GMT-0700 (Pacific Daylight Time)">20:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</div></td><td class="msg-cell">The “F# pipes could easily inline PFA calls” argument only applies to the pipe operator (and <a href="http://Array.prototype.map">Array.prototype.map</a>, iterator helpers, etc.), and it would not obviate concerns about PFA syntax generally increasing non-inlinable calls outside those cases, e.g., whenever they’re assigned to variables within hot paths.

I suppose, Ron, you could argue that developers could be encouraged to use PFA syntax only as arguments to <a href="http://Array.prototype.map">Array.prototype.map</a>, iterator helpers, etc. or as operands to F# pipes. But that might not be too persuasive to the engines…</td></tr>
  <tr class="msg" id="L47"><td class="ts-cell"><a class="ts" href="#L47" alt="Tue Aug 05 2025 13:58:12 GMT-0700 (Pacific Daylight Time)">20:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I'm not sure I agree with the concern that PFAs would result in more usage of ad-hoc function wrappers/arrows than already exists. There are already entire ecosystems in JS built around FP-style programming where arrows are commonplace.</td></tr>
  <tr class="msg" id="L48"><td class="ts-cell"><a class="ts" href="#L48" alt="Tue Aug 05 2025 14:00:18 GMT-0700 (Pacific Daylight Time)">21:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</div></td><td class="msg-cell">Yes, it’s not my argument, haha. Though we’ve talked about Ramda, Fantasy Land, and the various other tacit FP ecosystems in TC39, and the engine implementors do not generally seem to enjoy their performance characteristics or be willing to really accommodate their styles in the core language.</td></tr>
  <tr class="msg" id="L49"><td class="ts-cell"><a class="ts" href="#L49" alt="Tue Aug 05 2025 14:01:16 GMT-0700 (Pacific Daylight Time)">21:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I don't think PFA itself would push more people to FP-style, though it could potentially speed up existing FP-style applications that already depend on function currying scaffolding (since that scaffolding would no longer be necessary).</td></tr>
  <tr class="msg" id="L50"><td class="ts-cell"><a class="ts" href="#L50" alt="Tue Aug 05 2025 14:03:26 GMT-0700 (Pacific Daylight Time)">21:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">IMO, the argument against ad-hoc functions/wrappers should have been considered lost when we introduced <code>=&gt;</code>. PFA would improve existing use cases with a clean syntax that slots well into <code>|&gt;</code>. IMO it only really gets scary if we were to introduce a composition operator.</td></tr>
  <tr class="msg" id="L51"><td class="ts-cell"><a class="ts" href="#L51" alt="Tue Aug 05 2025 14:04:17 GMT-0700 (Pacific Daylight Time)">21:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</div></td><td class="msg-cell">You heard it here, folks: “I draw the line at function composition” —&nbsp;Ron Buckton, 2025
Just kidding.</td></tr>
  <tr class="msg" id="L52"><td class="ts-cell"><a class="ts" href="#L52" alt="Tue Aug 05 2025 14:04:54 GMT-0700 (Pacific Daylight Time)">21:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Hah, I don't, but I consider that to be a far bigger hurdle than PFA should have been.</td></tr>
  <tr class="msg" id="L53"><td class="ts-cell"><a class="ts" href="#L53" alt="Tue Aug 05 2025 14:06:15 GMT-0700 (Pacific Daylight Time)">21:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I was investigating composition as well as functional operators (i.e., <code>{+}</code> as shorthand for <code>(a, b) =&gt; a + b</code>) to improve composition and higher-order operations</td></tr>
  <tr class="msg" id="L54"><td class="ts-cell"><a class="ts" href="#L54" alt="Tue Aug 05 2025 14:06:55 GMT-0700 (Pacific Daylight Time)">21:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">So you would end up with <code>[1, 2, 3].map(? {+} 1)</code> -&gt; <code>[1, 2, 3].map({+}(?, 1))</code></td></tr>
  <tr class="msg" id="L55"><td class="ts-cell"><a class="ts" href="#L55" alt="Tue Aug 05 2025 14:07:54 GMT-0700 (Pacific Daylight Time)">21:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</div></td><td class="msg-cell">I remember that proposal.</td></tr>
  <tr class="msg" id="L56"><td class="ts-cell"><a class="ts" href="#L56" alt="Tue Aug 05 2025 14:07:56 GMT-0700 (Pacific Daylight Time)">21:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</div></td><td class="msg-cell">With regards to currying, I do agree with Tab’s opinion stated ages ago that there’s a fundamental “impedance mismatch” between n-ary functional languages like JavaScript and unary-functional currying-based languages like Haskell. Attempts to add auto-currying to n-ary functions in JavaScript may be trying overmuch to retrofit a familiar approach onto a fundamentally different core language design, square things in round holes. The same may apply to a lesser extent to unary-function pipes, unary function composition, etc. N-ary function calls truly exist in JavaScript.</td></tr>
  <tr class="msg" id="L57"><td class="ts-cell"><a class="ts" href="#L57" alt="Tue Aug 05 2025 14:08:35 GMT-0700 (Pacific Daylight Time)">21:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</div></td><td class="msg-cell">(This is also ignoring the fact that <code>await</code> and <code>yield</code> operators are function scoped…)</td></tr>
  <tr class="msg" id="L58"><td class="ts-cell"><a class="ts" href="#L58" alt="Tue Aug 05 2025 14:09:45 GMT-0700 (Pacific Daylight Time)">21:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">That was one of the reasons I proposed PFA since it avoided the need to bake currying into functions themselves. The other was to avoid "picking a winner" between lodash-style <code>f(it, ...args)</code> and ramda-style <code>f(...args, it)</code></td></tr>
  <tr class="msg" id="L59"><td class="ts-cell"><a class="ts" href="#L59" alt="Tue Aug 05 2025 14:11:01 GMT-0700 (Pacific Daylight Time)">21:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</div></td><td class="msg-cell">Yes, it is a good goal to not promote subject-first function signatures or subject-last function signatures in core JavaScript. Which is part of why we also rejected Elixir pipes…</td></tr>
  <tr class="msg" id="L60"><td class="ts-cell"><a class="ts" href="#L60" alt="Tue Aug 05 2025 14:11:16 GMT-0700 (Pacific Daylight Time)">21:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I did consider a syntactic currying syntax for functions, a. la. <code>function f(a)(b)(c) { }</code> which would curry when undersupplied.</td></tr>
  <tr class="msg" id="L61"><td class="ts-cell"><a class="ts" href="#L61" alt="Tue Aug 05 2025 14:12:21 GMT-0700 (Pacific Daylight Time)">21:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">but I didn't like the overhead or complexity, plus it required libraries to be rewritten before they could be consumed in that fashion, while PFA worked on everything immediately.</td></tr>
  <tr class="msg" id="L62"><td class="ts-cell"><a class="ts" href="#L62" alt="Tue Aug 05 2025 14:13:06 GMT-0700 (Pacific Daylight Time)">21:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</div></td><td class="msg-cell">Yes, the ecosystem schism would be wild if we added that as syntax.
Someone should add “ecosystem schism”&nbsp;to the old TC39 bingo card…</td></tr>
  <tr class="msg" id="L63"><td class="ts-cell"><a class="ts" href="#L63" alt="Tue Aug 05 2025 14:17:32 GMT-0700 (Pacific Daylight Time)">21:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</div></td><td class="msg-cell">Anyways, it amuses me greatly that PHP added a unary-function-based pipe operator…that is basically <em>non-tacit</em>. Its unary function calls require annotation with <code>(...)</code>.<br>We’ve had some people lament about how ES Hack pipes require an explicit topic reference with its unary function calls. They count extra characters—three or four extra characters per pipe—and speak of terrible friction.<br>But, over there, PHP adds a new pipe operator based on unary function calls, but it <em>still</em> requires essentially the same argument annotation. With <em>five</em> extra characters per pipe. Are people complaining about this too?</td></tr>
  <tr class="msg" id="L64"><td class="ts-cell"><a class="ts" href="#L64" alt="Tue Aug 05 2025 14:21:53 GMT-0700 (Pacific Daylight Time)">21:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@tabatkins:matrix.org">TabAtkins</span>&gt;</div></td><td class="msg-cell">Yeah, the "unary functions but not tacit" restriction that PHP restricted itself into is kinda <em>hilarious</em></td></tr>
  <tr class="msg" id="L65"><td class="ts-cell"><a class="ts" href="#L65" alt="Tue Aug 05 2025 14:24:06 GMT-0700 (Pacific Daylight Time)">21:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@tabatkins:matrix.org">TabAtkins</span>&gt;</div></td><td class="msg-cell">Man what type of value do you even <em>get</em> if you, say, <code>$x = array_map;</code>? Is that just a reference error?</td></tr>
  <tr class="msg" id="L66"><td class="ts-cell"><a class="ts" href="#L66" alt="Tue Aug 05 2025 14:24:18 GMT-0700 (Pacific Daylight Time)">21:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@tabatkins:matrix.org">TabAtkins</span>&gt;</div></td><td class="msg-cell">(I haven't used PHP since 4.x)</td></tr>
  <tr class="msg" id="L67"><td class="ts-cell"><a class="ts" href="#L67" alt="Tue Aug 05 2025 14:30:28 GMT-0700 (Pacific Daylight Time)">21:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</div></td><td class="msg-cell">My understanding is that PHP’s functions and variables are in separate “scopes” or “namespaces”. 
It’s like a Lisp-2, not a Lisp-1. 
So you would get a reference error.</td></tr>
  <tr class="msg" id="L68"><td class="ts-cell"><a class="ts" href="#L68" alt="Tue Aug 05 2025 14:31:12 GMT-0700 (Pacific Daylight Time)">21:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</div></td><td class="msg-cell">Hence that first-class callable proposal: you can’t use <code>array_map</code> as a value (reference error), but you can use <code>array_map(...)</code> as a value.</td></tr>
  <tr class="msg" id="L69"><td class="ts-cell"><a class="ts" href="#L69" alt="Tue Aug 05 2025 14:31:13 GMT-0700 (Pacific Daylight Time)">21:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</div></td><td class="msg-cell"><a href="https://onecompiler.com/php/43su8xqsa">https://onecompiler.com/php/43su8xqsa</a></td></tr>
  <tr class="msg" id="L70"><td class="ts-cell"><a class="ts" href="#L70" alt="Tue Aug 05 2025 14:36:50 GMT-0700 (Pacific Daylight Time)">21:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</div></td><td class="msg-cell">Hm, no, I’m wrong. There are “variable functions” aka “user-defined functions”, there are “anonymous functions” aka “closures”, and there are “language constructs” aka “built-in functions”. 
<a href="https://www.php.net/manual/en/functions.variable-functions.php">https://www.php.net/manual/en/functions.variable-functions.php</a></td></tr>
  <tr class="msg" id="L71"><td class="ts-cell"><a class="ts" href="#L71" alt="Tue Aug 05 2025 14:37:08 GMT-0700 (Pacific Daylight Time)">21:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@jschoi:matrix.org">jschoi</span>&gt;</div></td><td class="msg-cell">But in the end the answer is still the same:<br><code>$x = array_map</code> throws a reference error.<br>Because only variable functions (or a closure assigned to a variable), and not built-in functions, can be directly referred to by name.</td></tr>
  <tr class="msg" id="L72"><td class="ts-cell"><a class="ts" href="#L72" alt="Tue Aug 05 2025 14:47:11 GMT-0700 (Pacific Daylight Time)">21:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@tabatkins:matrix.org">TabAtkins</span>&gt;</div></td><td class="msg-cell">Omigod, right, pretend closures (that can't close over anything) via string passing, ugh.</td></tr>

</tbody></table></div></div></div>
</body></html>