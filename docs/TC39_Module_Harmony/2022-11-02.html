<!DOCTYPE html><html><head>
  <title>TC39 Module Harmony on 2022-11-02</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "TC39 Module Harmony";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">TC39 Module Harmony<br>2022-11-02<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2022-10-25" class="nav-link"><span>prev</span></a>
<a href="2022-11-03" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search TC39 Module Harmony">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Wed Nov 02 2022 15:22:29 GMT-0700 (Pacific Daylight Time)">22:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@kriskowal:matrix.org">Kris Kowal</span>&gt;</div></td><td class="msg-cell"><span class="nick-9">nicolo-ribaudo</span>: I got a question from <span class="nick-2">guybedford</span> and want to confirm weâ€™re on the same page: reflective import would advance the module to loaded but not to linked and its dependencies wonâ€™t be loaded.</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Wed Nov 02 2022 15:23:24 GMT-0700 (Pacific Daylight Time)">22:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@kriskowal:matrix.org">Kris Kowal</span>&gt;</div></td><td class="msg-cell">I can easily imagine <code>import(x, {reflect: true, state: 'linked'})</code> or some such would load transitive dependencies without initializing or executing.</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Wed Nov 02 2022 15:27:03 GMT-0700 (Pacific Daylight Time)">22:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">Right, it would not load it's dependencies.<br>However, I hope it will not just result in a ModuleSource but in something that contains all the info necessary to later load&amp;link it's dependencies</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Wed Nov 02 2022 15:30:11 GMT-0700 (Pacific Daylight Time)">22:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">"would advance the module to loaded" -&gt; Informally yes. Formally, it doesn't advance the module's state because the first state change happens when loading all its dependencies. It just makes us go from "I have nothing" to "I have a Module/ModuleSource"</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Wed Nov 02 2022 15:30:56 GMT-0700 (Pacific Daylight Time)">22:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@kriskowal:matrix.org">Kris Kowal</span>&gt;</div></td><td class="msg-cell">I assume it would not be an observable optimization if the Module Record was born with a null pointer to the structs needed to advance past the loaded state.</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Wed Nov 02 2022 15:34:41 GMT-0700 (Pacific Daylight Time)">22:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@kriskowal:matrix.org">Kris Kowal</span>&gt;</div></td><td class="msg-cell">We are in agreement about having a <code>Module</code> object and not just a <code>ModuleSource</code> but <span class="nick-2">guybedford</span> would like us to at least contemplate the alternative given that deferred <code>await import(reflectedModule)</code> doesnâ€™t go as far as <span class="nick-10">yulia</span>â€™s proposing for deferred execution. I donâ€™t think our current agreement precludes going farther and I think itâ€™s compelling for code splitting, but it wouldnâ€™t initialize a dependency on the stack of the first access of one of its exports.</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Wed Nov 02 2022 15:36:52 GMT-0700 (Pacific Daylight Time)">22:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@kriskowal:matrix.org">Kris Kowal</span>&gt;</div></td><td class="msg-cell">In any case, I wanted to make sure about reflection being shallow since thatâ€™s important to Guy. Itâ€™s important to me too, since itâ€™s possible to load a module that canâ€™t advance to linked without a custom import hook.</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Wed Nov 02 2022 15:37:29 GMT-0700 (Pacific Daylight Time)">22:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> We are in agreement about having a <code>Module</code> object and not just a <code>ModuleSource</code> but <span class="nick-2">guybedford</span> would like us to at least contemplate the alternative given that deferred <code>await import(reflectedModule)</code> doesnâ€™t go as far as <span class="nick-10">yulia</span>â€™s proposing for deferred execution. I donâ€™t think our current agreement precludes going farther and I think itâ€™s compelling for code splitting, but it wouldnâ€™t initialize a dependency on the stack of the first access of one of its exports.</blockquote></mx-reply>Yeah, we are not solving deferred execution.<br>I'm almost hoping we can have <code><a href="http://import.link">import.link</a>(module) -&gt; Promise</code> and <code>import.evaluateSync(module)</code> ðŸ˜¬</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Wed Nov 02 2022 15:38:02 GMT-0700 (Pacific Daylight Time)">22:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> In any case, I wanted to make sure about reflection being shallow since thatâ€™s important to Guy. Itâ€™s important to me too, since itâ€™s possible to load a module that canâ€™t advance to linked without a custom import hook.</blockquote></mx-reply>I'm 100% aligned with that. I have use cases for not loading the whole graph, and import reflection should be shallow.</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Wed Nov 02 2022 15:39:09 GMT-0700 (Pacific Daylight Time)">22:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">For JS, it's exactly like <code>module { export * from "x" }</code> which doesn't load the graph until the block is imported (except that reflection loads "x", this almost-equivalent-module-block doesn't)</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Wed Nov 02 2022 15:40:04 GMT-0700 (Pacific Daylight Time)">22:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@kriskowal:matrix.org">Kris Kowal</span>&gt;</div></td><td class="msg-cell">Right, I expect module expressions to be shallow too.</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Wed Nov 02 2022 15:40:22 GMT-0700 (Pacific Daylight Time)">22:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@kriskowal:matrix.org">Kris Kowal</span>&gt;</div></td><td class="msg-cell">Same reasons. They might be sent somewhere their linkage is possible even if thatâ€™s not local.</td></tr>

</tbody></table></div></div></div>
</body></html>