<!doctype html>
<head>
  <title>#whatwg on 2019-02-17</title>
  <link rel="stylesheet" href="../style.css">
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">#whatwg<br>2019-02-17<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2019-02-16" class="nav-link"><span>prev</span></a>
<a href="2019-02-18" class="nav-link"><span style="float:right">next</span></a>
</div>
    
<div class="room-list-wrapper">Active:<br>
<ul class="room-list">
<li><a href="../TC39_Delegates/">TC39 Delegates</a></li>
<li><a href="../TC39_Editors/">TC39 Editors</a></li>
<li><a href="../TC39_General/">TC39 General</a></li>
<li><a href="../WHATWG/">WHATWG</a></li>
</ul>
</div>
<br>
<div class="room-list-wrapper">Historical:<br>
<ul class="room-list">
<li><a href="../irc-tc39/">#tc39</a></li>
<li><a href="../irc-tc39-delegates/">#tc39-delegates</a></li>
<li><a href="../irc-tc39-editor-group/">#tc39-editor-group</a></li>
<li><a href="../irc-whatwg/" class="current-room">#whatwg</a></li>
</ul>
</div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs"><div class="log">
<table><tbody id="log-tbody">
  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Sun Feb 17 2019 01:04:52 GMT-0800 (Pacific Standard Time)">09:04</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">littledan: let me know at what point <a href="https://github.com/whatwg/html/pull/4372">https://github.com/whatwg/html/pull/4372</a> is ready for nits</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Sun Feb 17 2019 01:05:09 GMT-0800 (Pacific Standard Time)">09:05</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">littledan: and thanks for writing it up!</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Sun Feb 17 2019 01:14:13 GMT-0800 (Pacific Standard Time)">09:14</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">TimothyGu: I&#039;ll leave <a href="https://github.com/whatwg/html/pull/4368">https://github.com/whatwg/html/pull/4368</a> open until you can verify my analysis, but I think it&#039;s good still</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Sun Feb 17 2019 01:16:05 GMT-0800 (Pacific Standard Time)">09:16</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">Annevk, never too early for a review, but it will be some months or maybe a year. I will note in the PR thread when ready.</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Sun Feb 17 2019 01:17:03 GMT-0800 (Pacific Standard Time)">09:17</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">How would folks feel if I proposed some of the HTML job queue to be part of JS semantics? No normative changes, but maybe this could clear up the willful violation in this area.</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Sun Feb 17 2019 01:17:12 GMT-0800 (Pacific Standard Time)">09:17</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">Domenic: ^</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Sun Feb 17 2019 01:17:48 GMT-0800 (Pacific Standard Time)">09:17</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">This willful violation is causing extra complexity for several JS specs</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Sun Feb 17 2019 01:19:03 GMT-0800 (Pacific Standard Time)">09:19</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">littledan: so the last time we looked into this the simplest setup would be for JS to queue (perhaps annotated) things and let the host take care of organizing where to put those</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Sun Feb 17 2019 01:19:32 GMT-0800 (Pacific Standard Time)">09:19</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">littledan: I suppose we could move more of HTML into ES, but that seems really tricky to get right</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Sun Feb 17 2019 01:19:50 GMT-0800 (Pacific Standard Time)">09:19</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">I see. Where does the complexity come in?</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Sun Feb 17 2019 01:20:09 GMT-0800 (Pacific Standard Time)">09:20</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">(oh sorry rereading your above question, the PR is already ready for nits)</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Sun Feb 17 2019 01:21:01 GMT-0800 (Pacific Standard Time)">09:21</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">littledan: I mean, HTML&#039;s event loop algorithm is not simple</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Sun Feb 17 2019 01:21:05 GMT-0800 (Pacific Standard Time)">09:21</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">In particular, there was interest in TC39 in standardizing microtask queue semantics across JS environments to make things more predictable, which seems like a nice goal to me</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Sun Feb 17 2019 01:21:44 GMT-0800 (Pacific Standard Time)">09:21</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">The event loop would be in HTML still... OK, sounds like I should read more details and I will probably see where it doesn&#039;t work for myself</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Sun Feb 17 2019 01:21:47 GMT-0800 (Pacific Standard Time)">09:21</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">littledan: and afaik ES only queues what HTML calls microtasks and those only happen in special places and even those also have their own HTML-specific logic surrounding them</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Sun Feb 17 2019 01:22:31 GMT-0800 (Pacific Standard Time)">09:22</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">What&#039;s HTML -specific about that logic?</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Sun Feb 17 2019 01:22:50 GMT-0800 (Pacific Standard Time)">09:22</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">littledan: <a href="https://html.spec.whatwg.org/#perform-a-microtask-checkpoint">https://html.spec.whatwg.org/#perform-a-microtask-checkpoint</a></td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Sun Feb 17 2019 01:23:49 GMT-0800 (Pacific Standard Time)">09:23</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">Oh, that&#039;s the thing, I think we will need to perform microtask checkpoints from the JS spec</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Sun Feb 17 2019 01:23:54 GMT-0800 (Pacific Standard Time)">09:23</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">littledan: promise rejection notification, database cleanup, the manipulation of the event loop (I&#039;m not sure what that does)</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Sun Feb 17 2019 01:24:06 GMT-0800 (Pacific Standard Time)">09:24</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">Well, at least Step 2</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Sun Feb 17 2019 01:24:11 GMT-0800 (Pacific Standard Time)">09:24</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">Of that algorithm</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Sun Feb 17 2019 01:24:35 GMT-0800 (Pacific Standard Time)">09:24</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">littledan: interesting</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Sun Feb 17 2019 01:24:57 GMT-0800 (Pacific Standard Time)">09:24</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">Maybe we should just make a host hook for microtask checkpoints</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Sun Feb 17 2019 01:26:14 GMT-0800 (Pacific Standard Time)">09:26</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">&quot;just&quot; 😃</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Sun Feb 17 2019 01:26:14 GMT-0800 (Pacific Standard Time)">09:26</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">But, I think we might need to at least run through the microtask queue between sibling modules as part of the top-level await proposal</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Sun Feb 17 2019 01:26:28 GMT-0800 (Pacific Standard Time)">09:26</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">I will have to think more about whether the other parts are required</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Sun Feb 17 2019 01:27:34 GMT-0800 (Pacific Standard Time)">09:27</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">I think it would help a lot to look at existing software architectures here and base the standard on those</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Sun Feb 17 2019 01:27:53 GMT-0800 (Pacific Standard Time)">09:27</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">What&#039;s an example?</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Sun Feb 17 2019 01:28:02 GMT-0800 (Pacific Standard Time)">09:28</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">E.g., SpiderMonkey &lt;&gt; Gecko</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Sun Feb 17 2019 01:28:11 GMT-0800 (Pacific Standard Time)">09:28</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">Or V8 &lt;&gt; Chromium</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Sun Feb 17 2019 01:28:18 GMT-0800 (Pacific Standard Time)">09:28</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">Or V8 &lt;&gt; Node</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Sun Feb 17 2019 01:28:19 GMT-0800 (Pacific Standard Time)">09:28</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">Oh, for the layering?</td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Sun Feb 17 2019 01:28:23 GMT-0800 (Pacific Standard Time)">09:28</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">Yeah</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Sun Feb 17 2019 01:28:44 GMT-0800 (Pacific Standard Time)">09:28</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">We are already well past that! JS engines include lots of things from HTML and WebIDL</td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Sun Feb 17 2019 01:28:51 GMT-0800 (Pacific Standard Time)">09:28</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">ES could still impose restrictions on hosts to make them consistent somehow</td></tr>
  <tr class="msg" id="L35"><td class="ts-cell"><a class="ts" href="#L35" alt="Sun Feb 17 2019 01:29:22 GMT-0800 (Pacific Standard Time)">09:29</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">Well, lots is an exaggeration</td></tr>
  <tr class="msg" id="L36"><td class="ts-cell"><a class="ts" href="#L36" alt="Sun Feb 17 2019 01:29:48 GMT-0800 (Pacific Standard Time)">09:29</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">And for some of those things it would indeed make sense to define them in ES, as we previously discussed 😃</td></tr>
  <tr class="msg" id="L37"><td class="ts-cell"><a class="ts" href="#L37" alt="Sun Feb 17 2019 01:29:57 GMT-0800 (Pacific Standard Time)">09:29</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">I&#039;m pretty sure the event loop is not in V8 or SpiderMonkey though</td></tr>
  <tr class="msg" id="L38"><td class="ts-cell"><a class="ts" href="#L38" alt="Sun Feb 17 2019 01:30:15 GMT-0800 (Pacific Standard Time)">09:30</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">But, at the same time, V8 includes (or at one point included) step 2 of the perform a microtask checkpoint algorithm (which is what I think I need)</td></tr>
  <tr class="msg" id="L39"><td class="ts-cell"><a class="ts" href="#L39" alt="Sun Feb 17 2019 01:30:33 GMT-0800 (Pacific Standard Time)">09:30</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">V8 definitely doesn&#039;t include the broader event loop</td></tr>
  <tr class="msg" id="L40"><td class="ts-cell"><a class="ts" href="#L40" alt="Sun Feb 17 2019 01:31:21 GMT-0800 (Pacific Standard Time)">09:31</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">So step 2 is basically an agent having a microtask queue and some abstract operation iterating over it and draining it?</td></tr>
  <tr class="msg" id="L41"><td class="ts-cell"><a class="ts" href="#L41" alt="Sun Feb 17 2019 01:31:49 GMT-0800 (Pacific Standard Time)">09:31</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">Well, except for &quot;Set the event loop&#039;s currently running task to oldestMicrotask.&quot;</td></tr>
  <tr class="msg" id="L42"><td class="ts-cell"><a class="ts" href="#L42" alt="Sun Feb 17 2019 01:31:50 GMT-0800 (Pacific Standard Time)">09:31</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">Right... I will have to look into how the currently running task is maintained</td></tr>
  <tr class="msg" id="L43"><td class="ts-cell"><a class="ts" href="#L43" alt="Sun Feb 17 2019 01:35:22 GMT-0800 (Pacific Standard Time)">09:35</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">Seems to be mostly for compound microtasks, i.e., mutation observers, but Domenic investigated all this last</td></tr>
  <tr class="msg" id="L44"><td class="ts-cell"><a class="ts" href="#L44" alt="Sun Feb 17 2019 01:42:59 GMT-0800 (Pacific Standard Time)">09:42</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">Thanks for the pointer; that is an area I don&#039;t understand as well</td></tr>
  <tr class="msg" id="L45"><td class="ts-cell"><a class="ts" href="#L45" alt="Sun Feb 17 2019 01:47:37 GMT-0800 (Pacific Standard Time)">09:47</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">Looking at <a href="https://dom.spec.whatwg.org/#notify-mutation-observers">https://dom.spec.whatwg.org/#notify-mutation-observers</a> I guess there&#039;s a bug there in that the slotchange event also needs to be dispatched from a compound microtask subtask...</td></tr>
  <tr class="msg" id="L46"><td class="ts-cell"><a class="ts" href="#L46" alt="Sun Feb 17 2019 01:49:34 GMT-0800 (Pacific Standard Time)">09:49</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">Hmm, how does that work at all, since an event can result in multiple callbacks...</td></tr>
  <tr class="msg" id="L47"><td class="ts-cell"><a class="ts" href="#L47" alt="Sun Feb 17 2019 01:49:45 GMT-0800 (Pacific Standard Time)">09:49</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">Time to file an issue I guess</td></tr>
  <tr class="msg" id="L48"><td class="ts-cell"><a class="ts" href="#L48" alt="Sun Feb 17 2019 01:53:01 GMT-0800 (Pacific Standard Time)">09:53</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell"><a href="https://github.com/whatwg/dom/issues/734">https://github.com/whatwg/dom/issues/734</a> for those curious</td></tr>
  <tr class="msg" id="L49"><td class="ts-cell"><a class="ts" href="#L49" alt="Sun Feb 17 2019 02:04:59 GMT-0800 (Pacific Standard Time)">10:04</a></td><td class="nick-cell">&lt;<span class="nick nick-11" title=MikeSmith@irc>MikeSmith</span>&gt;</td><td class="msg-cell">annevk: about <a href="https://github.com/whatwg/fetch/issues/871">https://github.com/whatwg/fetch/issues/871</a> it seems somebody should have thought to take time to confirm with you first</td></tr>
  <tr class="msg" id="L50"><td class="ts-cell"><a class="ts" href="#L50" alt="Sun Feb 17 2019 02:05:10 GMT-0800 (Pacific Standard Time)">10:05</a></td><td class="nick-cell">&lt;<span class="nick nick-11" title=MikeSmith@irc>MikeSmith</span>&gt;</td><td class="msg-cell">I mean about <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1508661">https://bugzilla.mozilla.org/show_bug.cgi?id=1508661</a></td></tr>
  <tr class="msg" id="L51"><td class="ts-cell"><a class="ts" href="#L51" alt="Sun Feb 17 2019 02:05:21 GMT-0800 (Pacific Standard Time)">10:05</a></td><td class="nick-cell">&lt;<span class="nick nick-11" title=MikeSmith@irc>MikeSmith</span>&gt;</td><td class="msg-cell">at least Cc you</td></tr>
  <tr class="msg" id="L52"><td class="ts-cell"><a class="ts" href="#L52" alt="Sun Feb 17 2019 02:06:21 GMT-0800 (Pacific Standard Time)">10:06</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">MikeSmith: I dunno, given that Chrome and Safari were already passing those tests there was really no indication (other than misreading of the spec text) that suggested that needed to be done</td></tr>
  <tr class="msg" id="L53"><td class="ts-cell"><a class="ts" href="#L53" alt="Sun Feb 17 2019 02:07:11 GMT-0800 (Pacific Standard Time)">10:07</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">MikeSmith: I suspect I made a mistake by assuming fetch()&#039;s default was &quot;no-cors&quot; or some such</td></tr>
  <tr class="msg" id="L54"><td class="ts-cell"><a class="ts" href="#L54" alt="Sun Feb 17 2019 02:07:40 GMT-0800 (Pacific Standard Time)">10:07</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">MikeSmith: I&#039;m somewhat surprised it took until Firefox changed for this to be found out however, that makes little sense</td></tr>
  <tr class="msg" id="L55"><td class="ts-cell"><a class="ts" href="#L55" alt="Sun Feb 17 2019 02:07:49 GMT-0800 (Pacific Standard Time)">10:07</a></td><td class="nick-cell">&lt;<span class="nick nick-11" title=MikeSmith@irc>MikeSmith</span>&gt;</td><td class="msg-cell">yeah</td></tr>
  <tr class="msg" id="L56"><td class="ts-cell"><a class="ts" href="#L56" alt="Sun Feb 17 2019 02:12:03 GMT-0800 (Pacific Standard Time)">10:12</a></td><td class="nick-cell">&lt;<span class="nick nick-11" title=MikeSmith@irc>MikeSmith</span>&gt;</td><td class="msg-cell">I also don’t understand how, given the browsers passing those tests, server systems could work as expected if they rely on taking the value of the Origin header and using it to set the value of the Access-Control-Allow-Origin header</td></tr>
  <tr class="msg" id="L57"><td class="ts-cell"><a class="ts" href="#L57" alt="Sun Feb 17 2019 02:12:36 GMT-0800 (Pacific Standard Time)">10:12</a></td><td class="nick-cell">&lt;<span class="nick nick-11" title=MikeSmith@irc>MikeSmith</span>&gt;</td><td class="msg-cell">there must be a lot of servers and server CORS libraries which do that</td></tr>
  <tr class="msg" id="L58"><td class="ts-cell"><a class="ts" href="#L58" alt="Sun Feb 17 2019 02:12:38 GMT-0800 (Pacific Standard Time)">10:12</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">MikeSmith: yeah that doesn&#039;t make any sense, maybe nobody is using fetch()</td></tr>
  <tr class="msg" id="L59"><td class="ts-cell"><a class="ts" href="#L59" alt="Sun Feb 17 2019 02:13:58 GMT-0800 (Pacific Standard Time)">10:13</a></td><td class="nick-cell">&lt;<span class="nick nick-11" title=MikeSmith@irc>MikeSmith</span>&gt;</td><td class="msg-cell">I think Adam Rice said at the TAG f2f that Chrome use counters show usage of fetch() is around 9% of pages</td></tr>
  <tr class="msg" id="L60"><td class="ts-cell"><a class="ts" href="#L60" alt="Sun Feb 17 2019 02:15:45 GMT-0800 (Pacific Standard Time)">10:15</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">MikeSmith: maybe it&#039;s only same-origin</td></tr>
  <tr class="msg" id="L61"><td class="ts-cell"><a class="ts" href="#L61" alt="Sun Feb 17 2019 02:16:06 GMT-0800 (Pacific Standard Time)">10:16</a></td><td class="nick-cell">&lt;<span class="nick nick-11" title=MikeSmith@irc>MikeSmith</span>&gt;</td><td class="msg-cell">ah yeah maybe so</td></tr>
  <tr class="msg" id="L62"><td class="ts-cell"><a class="ts" href="#L62" alt="Sun Feb 17 2019 02:18:02 GMT-0800 (Pacific Standard Time)">10:18</a></td><td class="nick-cell">&lt;<span class="nick nick-11" title=MikeSmith@irc>MikeSmith</span>&gt;</td><td class="msg-cell">annevk: yeah another data point is that I’ve never seen and question posted to Stack Overflow from somebody indicating that their browser wasn’t sending the Origin header for GET requests</td></tr>
  <tr class="msg" id="L63"><td class="ts-cell"><a class="ts" href="#L63" alt="Sun Feb 17 2019 02:18:35 GMT-0800 (Pacific Standard Time)">10:18</a></td><td class="nick-cell">&lt;<span class="nick nick-11" title=MikeSmith@irc>MikeSmith</span>&gt;</td><td class="msg-cell">(and I pretty much read every single CORS-tagged question posted to SO, for the last 2 years or so)</td></tr>
  <tr class="msg" id="L64"><td class="ts-cell"><a class="ts" href="#L64" alt="Sun Feb 17 2019 02:19:34 GMT-0800 (Pacific Standard Time)">10:19</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">MikeSmith: so also, if it&#039;s just same-origin the specification wasn&#039;t misread, because the CORS flag is only set once cross-origin</td></tr>
  <tr class="msg" id="L65"><td class="ts-cell"><a class="ts" href="#L65" alt="Sun Feb 17 2019 02:19:48 GMT-0800 (Pacific Standard Time)">10:19</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">MikeSmith: so maybe the spec has a bug here after all</td></tr>
  <tr class="msg" id="L66"><td class="ts-cell"><a class="ts" href="#L66" alt="Sun Feb 17 2019 02:19:59 GMT-0800 (Pacific Standard Time)">10:19</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">MikeSmith: I guess I need to do some more digging</td></tr>
  <tr class="msg" id="L67"><td class="ts-cell"><a class="ts" href="#L67" alt="Sun Feb 17 2019 02:20:13 GMT-0800 (Pacific Standard Time)">10:20</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">but maybe not today</td></tr>
</tbody></table>
</div></div></div></body>
