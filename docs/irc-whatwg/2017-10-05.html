<!doctype html>
<head>
  <title>#whatwg on 2017-10-05</title>
  <link rel="stylesheet" href="../style.css">
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">#whatwg<br>2017-10-05<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2017-10-04" class="nav-link"><span>prev</span></a>
<a href="2017-10-06" class="nav-link"><span style="float:right">next</span></a>
</div>
    
<div class="room-list-wrapper">Active:<br>
<ul class="room-list">
<li><a href="../TC39_Delegates/">TC39 Delegates</a></li>
<li><a href="../TC39_Editors/">TC39 Editors</a></li>
<li><a href="../TC39_General/">TC39 General</a></li>
<li><a href="../WHATWG/">WHATWG</a></li>
</ul>
</div>
<br>
<div class="room-list-wrapper">Historical:<br>
<ul class="room-list">
<li><a href="../irc-tc39/">#tc39</a></li>
<li><a href="../irc-tc39-delegates/">#tc39-delegates</a></li>
<li><a href="../irc-tc39-editor-group/">#tc39-editor-group</a></li>
<li><a href="../irc-whatwg/" class="current-room">#whatwg</a></li>
</ul>
</div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs"><div class="log">
<table><tbody id="log-tbody">
  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Wed Oct 04 2017 17:04:44 GMT-0700 (Pacific Daylight Time)">00:04</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=jsbell@irc>jsbell</span>&gt;</td><td class="msg-cell">MikeSmith: will do...</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Wed Oct 04 2017 17:05:15 GMT-0700 (Pacific Daylight Time)">00:05</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=jsbell@irc>jsbell</span>&gt;</td><td class="msg-cell">MikeSmith: done</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Wed Oct 04 2017 17:05:32 GMT-0700 (Pacific Daylight Time)">00:05</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=jsbell@irc>jsbell</span>&gt;</td><td class="msg-cell">Yeah, I think it predates some (all?) lint checks</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Wed Oct 04 2017 17:06:49 GMT-0700 (Pacific Daylight Time)">00:06</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=jsbell@irc>jsbell</span>&gt;</td><td class="msg-cell">MikeSmith: dropping off now, so followups -&gt; email/github. Thank you VERY much for your help!</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Thu Oct 05 2017 01:42:05 GMT-0700 (Pacific Daylight Time)">08:42</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=mkwst@irc>mkwst</span>&gt;</td><td class="msg-cell">annevk: jochen__ just closed <a href="https://bugs.chromium.org/p/chromium/issues/detail?id=760096#c6">https://bugs.chromium.org/p/chromium/issues/detail?id=760096#c6</a> as WontFix, which reminded me how much I hate that `file:` URLs can have hostnames.</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Thu Oct 05 2017 01:42:28 GMT-0700 (Pacific Daylight Time)">08:42</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=mkwst@irc>mkwst</span>&gt;</td><td class="msg-cell">Before I go through the trouble of adding metrics, would you fundamentally object to not allowing hostnames? :)(</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Thu Oct 05 2017 01:43:07 GMT-0700 (Pacific Daylight Time)">08:43</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">mkwst: probably not, file URLs already have a lot of special cases in the parser</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Thu Oct 05 2017 01:43:26 GMT-0700 (Pacific Daylight Time)">08:43</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">mkwst: it&#039;s probably worth raising an issue at the same time though since Node.js uses file URLs a fair bit too</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Thu Oct 05 2017 01:43:55 GMT-0700 (Pacific Daylight Time)">08:43</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">mkwst: the other thing you could do of course is block them at the resolve layer</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Thu Oct 05 2017 01:43:57 GMT-0700 (Pacific Daylight Time)">08:43</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=mkwst@irc>mkwst</span>&gt;</td><td class="msg-cell">I&#039;d add metrics before raising an issue. No point in poking if there&#039;s no way to follow through.</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Thu Oct 05 2017 01:44:01 GMT-0700 (Pacific Daylight Time)">08:44</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">mkwst: maybe that&#039;s cleaner</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Thu Oct 05 2017 01:44:19 GMT-0700 (Pacific Daylight Time)">08:44</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=mkwst@irc>mkwst</span>&gt;</td><td class="msg-cell">Sure. Chrome could decide that it doesn&#039;t like the behavior. But I&#039;d like other folks on board.</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Thu Oct 05 2017 01:44:42 GMT-0700 (Pacific Daylight Time)">08:44</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=mkwst@irc>mkwst</span>&gt;</td><td class="msg-cell">Eh. I guess? I&#039;m not sure what&#039;s simpler to implement, really, since I think we delegate to the OS for filesystem access.</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Thu Oct 05 2017 01:44:44 GMT-0700 (Pacific Daylight Time)">08:44</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">We haven&#039;t really defined how file URLs resolve since it&#039;s platform dependent</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Thu Oct 05 2017 01:45:15 GMT-0700 (Pacific Daylight Time)">08:45</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">You&#039;d have to gate those calls somehow if you block at the resolve layer</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Thu Oct 05 2017 01:45:59 GMT-0700 (Pacific Daylight Time)">08:45</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=mkwst@irc>mkwst</span>&gt;</td><td class="msg-cell">I haven&#039;t looked at any of the code. Maybe it&#039;s trivial.</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Thu Oct 05 2017 01:46:31 GMT-0700 (Pacific Daylight Time)">08:46</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=mkwst@irc>mkwst</span>&gt;</td><td class="msg-cell">But I know it&#039;s trivial to remove the URL-parsing special case in Chrome&#039;s URL library, so. :)</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Thu Oct 05 2017 02:00:24 GMT-0700 (Pacific Daylight Time)">09:00</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=mkwst@irc>mkwst</span>&gt;</td><td class="msg-cell">annevk: Hey, more file things! <a href="https://bugs.chromium.org/p/chromium/issues/detail?id=756416#c3">https://bugs.chromium.org/p/chromium/issues/detail?id=756416#c3</a></td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Thu Oct 05 2017 02:00:33 GMT-0700 (Pacific Daylight Time)">09:00</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=mkwst@irc>mkwst</span>&gt;</td><td class="msg-cell">I&#039;ll file something against... HTML, I guess?</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Thu Oct 05 2017 02:01:07 GMT-0700 (Pacific Daylight Time)">09:01</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=mkwst@irc>mkwst</span>&gt;</td><td class="msg-cell">Or maybe URL, which already hand-waves in the direction of opaqueness for `file:`?</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Thu Oct 05 2017 02:01:37 GMT-0700 (Pacific Daylight Time)">09:01</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">mkwst: the main problem is getting user agents to agree</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Thu Oct 05 2017 02:01:47 GMT-0700 (Pacific Daylight Time)">09:01</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">mkwst: is it consistently cross-origin in Chrome or can you still do XHR?</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Thu Oct 05 2017 02:01:55 GMT-0700 (Pacific Daylight Time)">09:01</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=mkwst@irc>mkwst</span>&gt;</td><td class="msg-cell">Yeah. Which is why I&#039;d file a bug for discussion.</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Thu Oct 05 2017 02:02:29 GMT-0700 (Pacific Daylight Time)">09:02</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=mkwst@irc>mkwst</span>&gt;</td><td class="msg-cell">I&#039;m just looking now, actually. I remember that we had some strange carveouts where we called the origin `file:` for all file URLs,  but I don&#039;t recall the details.</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Thu Oct 05 2017 02:03:10 GMT-0700 (Pacific Daylight Time)">09:03</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">mkwst: I guess it would be HTML, since URL gives an opaque origin for data URLs too, but that&#039;s not always what we do because of overrides</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Thu Oct 05 2017 02:03:31 GMT-0700 (Pacific Daylight Time)">09:03</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=mkwst@irc>mkwst</span>&gt;</td><td class="msg-cell">Got it.</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Thu Oct 05 2017 02:03:44 GMT-0700 (Pacific Daylight Time)">09:03</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">mkwst: Firefox has some kind of same-or-deeper directory thing going on</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Thu Oct 05 2017 02:04:03 GMT-0700 (Pacific Daylight Time)">09:04</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=mkwst@irc>mkwst</span>&gt;</td><td class="msg-cell">Yeah. We considered that, but intentionally chose not to because of the downloads directory.</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Thu Oct 05 2017 02:04:06 GMT-0700 (Pacific Daylight Time)">09:04</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">mkwst: it doesn&#039;t really seem worth it and will probably all go away the more we force HTTPS</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Thu Oct 05 2017 02:04:30 GMT-0700 (Pacific Daylight Time)">09:04</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">mkwst: that&#039;s a compelling argument</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Thu Oct 05 2017 02:04:41 GMT-0700 (Pacific Daylight Time)">09:04</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=mkwst@irc>mkwst</span>&gt;</td><td class="msg-cell">On the HTTPS note, I saw that you poked at dev-platform@ regarding pushing for secure contexts.</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Thu Oct 05 2017 02:05:00 GMT-0700 (Pacific Daylight Time)">09:05</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=mkwst@irc>mkwst</span>&gt;</td><td class="msg-cell">Is there anything I can do there to help out? Other than poking at folks on Chrome&#039;s end in the same way?</td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Thu Oct 05 2017 02:06:09 GMT-0700 (Pacific Daylight Time)">09:06</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">mkwst: I need to talk to some more folks and at some point I mean to investigate what Chrome has disabled and Firefox has not</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Thu Oct 05 2017 02:06:53 GMT-0700 (Pacific Daylight Time)">09:06</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">mkwst: if the latter is available somewhere that&#039;d be swell, but I don&#039;t see anything else right now (other than pushing the worklets folks up the hill and getting a story for CSS and such)</td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Thu Oct 05 2017 02:07:28 GMT-0700 (Pacific Daylight Time)">09:07</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">mkwst: agreed with your review on the TAG PR too, FWIW</td></tr>
  <tr class="msg" id="L35"><td class="ts-cell"><a class="ts" href="#L35" alt="Thu Oct 05 2017 02:07:52 GMT-0700 (Pacific Daylight Time)">09:07</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=mkwst@irc>mkwst</span>&gt;</td><td class="msg-cell">There&#039;s an internal thread among API owners that wasn&#039;t actually meant to be internal. Will try to externalize that when folks wake up.</td></tr>
  <tr class="msg" id="L36"><td class="ts-cell"><a class="ts" href="#L36" alt="Thu Oct 05 2017 02:08:18 GMT-0700 (Pacific Daylight Time)">09:08</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">I saw the public thread, but there weren&#039;t many convincing arguments there</td></tr>
  <tr class="msg" id="L37"><td class="ts-cell"><a class="ts" href="#L37" alt="Thu Oct 05 2017 02:08:27 GMT-0700 (Pacific Daylight Time)">09:08</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=mkwst@irc>mkwst</span>&gt;</td><td class="msg-cell">But it&#039;s more or less the same story. slightlyoff, jochen__, and I are the bad cops.</td></tr>
  <tr class="msg" id="L38"><td class="ts-cell"><a class="ts" href="#L38" alt="Thu Oct 05 2017 02:09:23 GMT-0700 (Pacific Daylight Time)">09:09</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">The resistance mostly seems to be that transition is hard</td></tr>
  <tr class="msg" id="L39"><td class="ts-cell"><a class="ts" href="#L39" alt="Thu Oct 05 2017 02:10:01 GMT-0700 (Pacific Daylight Time)">09:10</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">But the argument also changes, since first the resistance was that it would be too expansive or too slow</td></tr>
  <tr class="msg" id="L40"><td class="ts-cell"><a class="ts" href="#L40" alt="Thu Oct 05 2017 02:23:25 GMT-0700 (Pacific Daylight Time)">09:23</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=nox@irc>nox</span>&gt;</td><td class="msg-cell">annevk: I need a poster image for a &lt;video&gt; in wpt,</td></tr>
  <tr class="msg" id="L41"><td class="ts-cell"><a class="ts" href="#L41" alt="Thu Oct 05 2017 02:23:30 GMT-0700 (Pacific Daylight Time)">09:23</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=nox@irc>nox</span>&gt;</td><td class="msg-cell">annevk: what image should I use?</td></tr>
  <tr class="msg" id="L42"><td class="ts-cell"><a class="ts" href="#L42" alt="Thu Oct 05 2017 02:23:56 GMT-0700 (Pacific Daylight Time)">09:23</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=nox@irc>nox</span>&gt;</td><td class="msg-cell">Oh, media/poster.png</td></tr>
  <tr class="msg" id="L43"><td class="ts-cell"><a class="ts" href="#L43" alt="Thu Oct 05 2017 02:25:35 GMT-0700 (Pacific Daylight Time)">09:25</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">Glad you found something ðŸ˜Š</td></tr>
  <tr class="msg" id="L44"><td class="ts-cell"><a class="ts" href="#L44" alt="Thu Oct 05 2017 02:27:24 GMT-0700 (Pacific Daylight Time)">09:27</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=nox@irc>nox</span>&gt;</td><td class="msg-cell">Hah. :)</td></tr>
  <tr class="msg" id="L45"><td class="ts-cell"><a class="ts" href="#L45" alt="Thu Oct 05 2017 02:27:35 GMT-0700 (Pacific Daylight Time)">09:27</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=nox@irc>nox</span>&gt;</td><td class="msg-cell">annevk: Almost done with them tests,</td></tr>
  <tr class="msg" id="L46"><td class="ts-cell"><a class="ts" href="#L46" alt="Thu Oct 05 2017 02:28:38 GMT-0700 (Pacific Daylight Time)">09:28</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=nox@irc>nox</span>&gt;</td><td class="msg-cell">annevk: and I have a question: there is nothing that lets me know whether a poster frame loaded, apart from making sure the poster frame starts loading before the document&#039;s load event, so that I can do stuff in the onload handler?</td></tr>
  <tr class="msg" id="L47"><td class="ts-cell"><a class="ts" href="#L47" alt="Thu Oct 05 2017 02:30:10 GMT-0700 (Pacific Daylight Time)">09:30</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">nox: I don&#039;t know about that either</td></tr>
  <tr class="msg" id="L48"><td class="ts-cell"><a class="ts" href="#L48" alt="Thu Oct 05 2017 02:30:29 GMT-0700 (Pacific Daylight Time)">09:30</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">nox: I was really only closely involved with &lt;video&gt; before it became all complicated</td></tr>
  <tr class="msg" id="L49"><td class="ts-cell"><a class="ts" href="#L49" alt="Thu Oct 05 2017 02:32:33 GMT-0700 (Pacific Daylight Time)">09:32</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=nox@irc>nox</span>&gt;</td><td class="msg-cell">annevk: Hah!</td></tr>
  <tr class="msg" id="L50"><td class="ts-cell"><a class="ts" href="#L50" alt="Thu Oct 05 2017 02:33:08 GMT-0700 (Pacific Daylight Time)">09:33</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=nox@irc>nox</span>&gt;</td><td class="msg-cell">annevk: tfw local clone is thousands of commits in the past and you need to push all of them to make a PR with a single test</td></tr>
  <tr class="msg" id="L51"><td class="ts-cell"><a class="ts" href="#L51" alt="Thu Oct 05 2017 06:09:23 GMT-0700 (Pacific Daylight Time)">13:09</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">And as we get closer to requiring UTF-8 all over, XMLHttpRequest and Firefox have to regress on that point: <a href="https://github.com/whatwg/xhr/issues/159">https://github.com/whatwg/xhr/issues/159</a></td></tr>
  <tr class="msg" id="L52"><td class="ts-cell"><a class="ts" href="#L52" alt="Thu Oct 05 2017 06:09:58 GMT-0700 (Pacific Daylight Time)">13:09</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">It even had a test, but I suspect no bugs were filed back then</td></tr>
  <tr class="msg" id="L53"><td class="ts-cell"><a class="ts" href="#L53" alt="Thu Oct 05 2017 06:10:43 GMT-0700 (Pacific Daylight Time)">13:10</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">Makes me wonder whether we test fetch() for this</td></tr>
  <tr class="msg" id="L54"><td class="ts-cell"><a class="ts" href="#L54" alt="Thu Oct 05 2017 08:30:14 GMT-0700 (Pacific Daylight Time)">15:30</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">JakeA: do you know who knows about chrome performance timeline stuff with service workers involved?</td></tr>
  <tr class="msg" id="L55"><td class="ts-cell"><a class="ts" href="#L55" alt="Thu Oct 05 2017 08:35:47 GMT-0700 (Pacific Daylight Time)">15:35</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">just trying to figure out: <a href="https://github.com/w3c/resource-timing/issues/119">https://github.com/w3c/resource-timing/issues/119</a></td></tr>
  <tr class="msg" id="L56"><td class="ts-cell"><a class="ts" href="#L56" alt="Thu Oct 05 2017 08:39:20 GMT-0700 (Pacific Daylight Time)">15:39</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=JakeA@irc>JakeA</span>&gt;</td><td class="msg-cell">wanderview: falken maybe?</td></tr>
  <tr class="msg" id="L57"><td class="ts-cell"><a class="ts" href="#L57" alt="Thu Oct 05 2017 08:40:01 GMT-0700 (Pacific Daylight Time)">15:40</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">JakeA: ok... I pinged him in the github issue... thanks</td></tr>
  <tr class="msg" id="L58"><td class="ts-cell"><a class="ts" href="#L58" alt="Thu Oct 05 2017 08:40:09 GMT-0700 (Pacific Daylight Time)">15:40</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">these values are pretty confusing right now</td></tr>
  <tr class="msg" id="L59"><td class="ts-cell"><a class="ts" href="#L59" alt="Thu Oct 05 2017 10:33:17 GMT-0700 (Pacific Daylight Time)">17:33</a></td><td class="nick-cell">&lt;<span class="nick nick-11" title=ondras@irc>ondras</span>&gt;</td><td class="msg-cell">damn, apparently font-size:calc(1vw*1vh) is not possible :/</td></tr>
  <tr class="msg" id="L60"><td class="ts-cell"><a class="ts" href="#L60" alt="Thu Oct 05 2017 10:33:26 GMT-0700 (Pacific Daylight Time)">17:33</a></td><td class="nick-cell">&lt;<span class="nick nick-11" title=ondras@irc>ondras</span>&gt;</td><td class="msg-cell">why not? sounds like a useful idea.</td></tr>
  <tr class="msg" id="L61"><td class="ts-cell"><a class="ts" href="#L61" alt="Thu Oct 05 2017 10:38:00 GMT-0700 (Pacific Daylight Time)">17:38</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">annevk: mkwst: according to <a href="https://quuz.org/url/liveview.html#file://x.jd.com/mkt/pcwap?&amp;callback=dsp_1504020242543&amp;r=1504020242544">https://quuz.org/url/liveview.html#file://x.jd.com/mkt/pcwap?&amp;callback=dsp_1504020242543&amp;r=1504020242544</a> in Firefox there is no hostname there, at least. So that&#039;s a point in its favor.</td></tr>
  <tr class="msg" id="L62"><td class="ts-cell"><a class="ts" href="#L62" alt="Thu Oct 05 2017 11:00:10 GMT-0700 (Pacific Daylight Time)">18:00</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=mkwst@irc>mkwst</span>&gt;</td><td class="msg-cell">Domenic: Great! Go file a bug against every other browser to align with Firefox!</td></tr>
  <tr class="msg" id="L63"><td class="ts-cell"><a class="ts" href="#L63" alt="Thu Oct 05 2017 11:27:06 GMT-0700 (Pacific Daylight Time)">18:27</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=Krinkle@irc>Krinkle</span>&gt;</td><td class="msg-cell">JakeA: I&#039;m curious about your thoughts on Wikimedia&#039;s approach to the client-side caching of javascript/css module bundles. As you might know, we currently do it as follows (in a nut shell): JS has a module manifest (dependency tree and version hashes), and an array of modules names to load on this page. For each module+version key it checks localStorage, and if present, evals it. Any remaining modules are fetched from the server in 1 batch</td></tr>
  <tr class="msg" id="L64"><td class="ts-cell"><a class="ts" href="#L64" alt="Thu Oct 05 2017 11:27:06 GMT-0700 (Pacific Daylight Time)">18:27</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=Krinkle@irc>Krinkle</span>&gt;</td><td class="msg-cell">request. On response, after normal execution, we also stash each module&#039;s response closure from the batch request into localStorage.</td></tr>
  <tr class="msg" id="L65"><td class="ts-cell"><a class="ts" href="#L65" alt="Thu Oct 05 2017 11:27:26 GMT-0700 (Pacific Daylight Time)">18:27</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=Krinkle@irc>Krinkle</span>&gt;</td><td class="msg-cell">I&#039;ve considered using ServiceWorkers and/or its Cache API in various ways over the past 2 years but always came back to the current solution.</td></tr>
  <tr class="msg" id="L66"><td class="ts-cell"><a class="ts" href="#L66" alt="Thu Oct 05 2017 11:29:30 GMT-0700 (Pacific Daylight Time)">18:29</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=TabAtkins@irc>TabAtkins</span>&gt;</td><td class="msg-cell">ondras: Because it&#039;s multiplying a length by a length, so the unit ends up being length^2.  (V&amp;U 4 will allow unit algebra, so you can divide that expression by 1px and get back to a plain length, and that&#039;s already specified in the TypedOM spec.)</td></tr>
  <tr class="msg" id="L67"><td class="ts-cell"><a class="ts" href="#L67" alt="Thu Oct 05 2017 11:29:59 GMT-0700 (Pacific Daylight Time)">18:29</a></td><td class="nick-cell">&lt;<span class="nick nick-11" title=ondras@irc>ondras</span>&gt;</td><td class="msg-cell">@TabAtkins: yeah, I would happily divide that by Npx to get to a reasonable unit</td></tr>
  <tr class="msg" id="L68"><td class="ts-cell"><a class="ts" href="#L68" alt="Thu Oct 05 2017 11:30:16 GMT-0700 (Pacific Daylight Time)">18:30</a></td><td class="nick-cell">&lt;<span class="nick nick-11" title=ondras@irc>ondras</span>&gt;</td><td class="msg-cell">TabAtkins: ^ (sorry for bad highlight)</td></tr>
  <tr class="msg" id="L69"><td class="ts-cell"><a class="ts" href="#L69" alt="Thu Oct 05 2017 11:30:26 GMT-0700 (Pacific Daylight Time)">18:30</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=Krinkle@irc>Krinkle</span>&gt;</td><td class="msg-cell">The main reason I want to get out of localStorage is because it&#039;s synchronous and because it&#039;s limited and is sometimes breaking user features when its full (e.g. 99% full with js/css, no space for &quot;normal&quot; usage like small key/value pairs for things like hiding notices or keeping track of collapsed/expanded state of something).</td></tr>
  <tr class="msg" id="L70"><td class="ts-cell"><a class="ts" href="#L70" alt="Thu Oct 05 2017 11:30:26 GMT-0700 (Pacific Daylight Time)">18:30</a></td><td class="nick-cell">&lt;<span class="nick nick-11" title=ondras@irc>ondras</span>&gt;</td><td class="msg-cell">ideally, I would like to take a square root tho</td></tr>
  <tr class="msg" id="L71"><td class="ts-cell"><a class="ts" href="#L71" alt="Thu Oct 05 2017 11:32:12 GMT-0700 (Pacific Daylight Time)">18:32</a></td><td class="nick-cell">&lt;<span class="nick nick-4" title=Mek@irc>Mek</span>&gt;</td><td class="msg-cell">replacing localstorage usage with cache API usage or something definitely sounds like a sensible thing to do</td></tr>
  <tr class="msg" id="L72"><td class="ts-cell"><a class="ts" href="#L72" alt="Thu Oct 05 2017 11:38:56 GMT-0700 (Pacific Daylight Time)">18:38</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=Krinkle@irc>Krinkle</span>&gt;</td><td class="msg-cell">At first I tried the &quot;obvious&quot; way with proper ServiceWorker intercepting network requests, and disabling the main thread logic of using localStorage.</td></tr>
  <tr class="msg" id="L73"><td class="ts-cell"><a class="ts" href="#L73" alt="Thu Oct 05 2017 11:40:29 GMT-0700 (Pacific Daylight Time)">18:40</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=Krinkle@irc>Krinkle</span>&gt;</td><td class="msg-cell">That means the SW thread needs to unpack the request url to find the raw list of module names again, then it needs access to the module manifest (postMessage, or separate request), and then for each moduleName/moduleVersion, construct a non-batch fake url and do cache lookups, then the logic is essentially the same as before: Make a batch request for the cache misses, and then mimick the server-side&#039;s logic of concatenating the hits from Cache</td></tr>
  <tr class="msg" id="L74"><td class="ts-cell"><a class="ts" href="#L74" alt="Thu Oct 05 2017 11:40:29 GMT-0700 (Pacific Daylight Time)">18:40</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=Krinkle@irc>Krinkle</span>&gt;</td><td class="msg-cell">and cache-miss-batch responses.</td></tr>
  <tr class="msg" id="L75"><td class="ts-cell"><a class="ts" href="#L75" alt="Thu Oct 05 2017 11:40:51 GMT-0700 (Pacific Daylight Time)">18:40</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=Krinkle@irc>Krinkle</span>&gt;</td><td class="msg-cell">The downside is that now the whole thing is a lot slower. we used to eval modules right away from those that are in the cache. I don&#039;t wanna block those on 1 cache  miss.</td></tr>
  <tr class="msg" id="L76"><td class="ts-cell"><a class="ts" href="#L76" alt="Thu Oct 05 2017 11:40:57 GMT-0700 (Pacific Daylight Time)">18:40</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=Krinkle@irc>Krinkle</span>&gt;</td><td class="msg-cell">And JS responses don&#039;t stream execution.</td></tr>
  <tr class="msg" id="L77"><td class="ts-cell"><a class="ts" href="#L77" alt="Thu Oct 05 2017 11:42:05 GMT-0700 (Pacific Daylight Time)">18:42</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=Krinkle@irc>Krinkle</span>&gt;</td><td class="msg-cell">So it seems more natural to ditch the SW part of it, and do the cache lookups in the main thread instead, but that means resorting to eval again, which is fine I suppose, (as long as V8&#039;s parse cache still works, which seems to be fine for us at the moment).</td></tr>
  <tr class="msg" id="L78"><td class="ts-cell"><a class="ts" href="#L78" alt="Thu Oct 05 2017 11:44:06 GMT-0700 (Pacific Daylight Time)">18:44</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Krinkle: what do you mean by &quot;And JS responses don&#039;t stream execution.&quot;</td></tr>
  <tr class="msg" id="L79"><td class="ts-cell"><a class="ts" href="#L79" alt="Thu Oct 05 2017 12:00:43 GMT-0700 (Pacific Daylight Time)">19:00</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=Krinkle@irc>Krinkle</span>&gt;</td><td class="msg-cell">wanderview: Given 10 keys, where 8 are going to hit cache. We currently read from localStorage, eval, and then request 2 from network. At this point, the first 8 modules are not waiting or blocked, they&#039;re executed and are done.</td></tr>
  <tr class="msg" id="L80"><td class="ts-cell"><a class="ts" href="#L80" alt="Thu Oct 05 2017 12:01:06 GMT-0700 (Pacific Daylight Time)">19:01</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=Krinkle@irc>Krinkle</span>&gt;</td><td class="msg-cell">If I&#039;d do the same in SW, I&#039;d have to wait for the batch request for the remaining 2 modules in order to concat the response and send it back to the client.</td></tr>
  <tr class="msg" id="L81"><td class="ts-cell"><a class="ts" href="#L81" alt="Thu Oct 05 2017 12:01:27 GMT-0700 (Pacific Daylight Time)">19:01</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=Krinkle@irc>Krinkle</span>&gt;</td><td class="msg-cell">E.g. given the client making a request for 10, SW.js unpacking it and composing it of 8 cache entries and the real request for 2 more.</td></tr>
  <tr class="msg" id="L82"><td class="ts-cell"><a class="ts" href="#L82" alt="Thu Oct 05 2017 12:01:33 GMT-0700 (Pacific Daylight Time)">19:01</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Krinkle: even with ReadableStream in the service worker script?</td></tr>
  <tr class="msg" id="L83"><td class="ts-cell"><a class="ts" href="#L83" alt="Thu Oct 05 2017 12:01:44 GMT-0700 (Pacific Daylight Time)">19:01</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=Krinkle@irc>Krinkle</span>&gt;</td><td class="msg-cell">wanderview: I can stream alright, but JS doesn&#039;t execute in a streaming way.</td></tr>
  <tr class="msg" id="L84"><td class="ts-cell"><a class="ts" href="#L84" alt="Thu Oct 05 2017 12:02:05 GMT-0700 (Pacific Daylight Time)">19:02</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=Krinkle@irc>Krinkle</span>&gt;</td><td class="msg-cell">Even if Chrome/V8 does streamed parsing (does it?), it certainly won&#039;t execute any JS code until the last byte arrives afaik.</td></tr>
  <tr class="msg" id="L85"><td class="ts-cell"><a class="ts" href="#L85" alt="Thu Oct 05 2017 12:02:52 GMT-0700 (Pacific Daylight Time)">19:02</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Krinkle: ah, ok</td></tr>
  <tr class="msg" id="L86"><td class="ts-cell"><a class="ts" href="#L86" alt="Thu Oct 05 2017 12:03:09 GMT-0700 (Pacific Daylight Time)">19:03</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title=gsnedders@irc>gsnedders</span>&gt;</td><td class="msg-cell">well you can&#039;t given JS semantics</td></tr>
  <tr class="msg" id="L87"><td class="ts-cell"><a class="ts" href="#L87" alt="Thu Oct 05 2017 12:03:21 GMT-0700 (Pacific Daylight Time)">19:03</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title=gsnedders@irc>gsnedders</span>&gt;</td><td class="msg-cell">oh wait that was literally your previous line</td></tr>
  <tr class="msg" id="L88"><td class="ts-cell"><a class="ts" href="#L88" alt="Thu Oct 05 2017 12:04:05 GMT-0700 (Pacific Daylight Time)">19:04</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=Krinkle@irc>Krinkle</span>&gt;</td><td class="msg-cell">Yeah, I get it. I&#039;m not blaming the browser here. Just looking for a suitable way to get this stash out of localStorage without making things worse :)</td></tr>
  <tr class="msg" id="L89"><td class="ts-cell"><a class="ts" href="#L89" alt="Thu Oct 05 2017 12:05:17 GMT-0700 (Pacific Daylight Time)">19:05</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Krinkle: I wonder if streaming html with &lt;script&gt; tags would let them evaluate incrementally</td></tr>
  <tr class="msg" id="L90"><td class="ts-cell"><a class="ts" href="#L90" alt="Thu Oct 05 2017 12:06:03 GMT-0700 (Pacific Daylight Time)">19:06</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title=gsnedders@irc>gsnedders</span>&gt;</td><td class="msg-cell">wanderview: yes</td></tr>
  <tr class="msg" id="L91"><td class="ts-cell"><a class="ts" href="#L91" alt="Thu Oct 05 2017 12:06:05 GMT-0700 (Pacific Daylight Time)">19:06</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=Krinkle@irc>Krinkle</span>&gt;</td><td class="msg-cell">wanderview: Yeah, I suppose it would. but is there a way to stream HTML into an existing browsing context? Maybe with an iframe, that then accesses the parent.</td></tr>
  <tr class="msg" id="L92"><td class="ts-cell"><a class="ts" href="#L92" alt="Thu Oct 05 2017 12:06:20 GMT-0700 (Pacific Daylight Time)">19:06</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=Krinkle@irc>Krinkle</span>&gt;</td><td class="msg-cell">but I don&#039;t expect code to then work as-is.</td></tr>
  <tr class="msg" id="L93"><td class="ts-cell"><a class="ts" href="#L93" alt="Thu Oct 05 2017 12:06:35 GMT-0700 (Pacific Daylight Time)">19:06</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=Krinkle@irc>Krinkle</span>&gt;</td><td class="msg-cell">Any use of &#039;window&#039; or &#039;document&#039; would be broken.</td></tr>
  <tr class="msg" id="L94"><td class="ts-cell"><a class="ts" href="#L94" alt="Thu Oct 05 2017 12:07:01 GMT-0700 (Pacific Daylight Time)">19:07</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=Krinkle@irc>Krinkle</span>&gt;</td><td class="msg-cell">For a single script that would work, but not with e.g. existing code base or something like jquery.js or any standard lib.</td></tr>
  <tr class="msg" id="L95"><td class="ts-cell"><a class="ts" href="#L95" alt="Thu Oct 05 2017 12:07:38 GMT-0700 (Pacific Daylight Time)">19:07</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=Krinkle@irc>Krinkle</span>&gt;</td><td class="msg-cell">dependency injection is nice, but use of browser APIs directly is quite common, DI in JS hasn&#039;t gotten much traction yet.</td></tr>
  <tr class="msg" id="L96"><td class="ts-cell"><a class="ts" href="#L96" alt="Thu Oct 05 2017 12:16:48 GMT-0700 (Pacific Daylight Time)">19:16</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=Krinkle@irc>Krinkle</span>&gt;</td><td class="msg-cell">gsnedders: wanderview: JakeA: Thanks for your input :-) I summarised it again at <a href="https://github.com/w3c/ServiceWorker/issues/1203">https://github.com/w3c/ServiceWorker/issues/1203</a></td></tr>
</tbody></table>
</div></div></div></body>
