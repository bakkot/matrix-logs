<!doctype html>
<head>
  <title>#whatwg on 2020-04-04</title>
  <link rel="stylesheet" href="../style.css">
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">#whatwg<br>2020-04-04<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2020-04-03" class="nav-link"><span>prev</span></a>
<a href="2020-04-05" class="nav-link"><span style="float:right">next</span></a>
</div>
    
<div class="room-list-wrapper">Active:<br>
<ul class="room-list">
<li><a href="../TC39_Delegates/">TC39 Delegates</a></li>
<li><a href="../TC39_Editors/">TC39 Editors</a></li>
<li><a href="../TC39_General/">TC39 General</a></li>
<li><a href="../WHATWG/">WHATWG</a></li>
</ul>
</div>
<br>
<div class="room-list-wrapper">Historical:<br>
<ul class="room-list">
<li><a href="../irc-tc39/">#tc39</a></li>
<li><a href="../irc-tc39-delegates/">#tc39-delegates</a></li>
<li><a href="../irc-tc39-editor-group/">#tc39-editor-group</a></li>
<li><a href="../irc-whatwg/" class="current-room">#whatwg</a></li>
</ul>
</div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs"><div class="log">
<table><tbody id="log-tbody">
  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Sat Apr 04 2020 09:54:58 GMT-0700 (Pacific Daylight Time)">16:54</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=xalqor@irc>xalqor</span>&gt;</td><td class="msg-cell">anyone on right now? i have an issue with iframes :(</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Sat Apr 04 2020 09:56:24 GMT-0700 (Pacific Daylight Time)">16:56</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=xalqor@irc>xalqor</span>&gt;</td><td class="msg-cell">i&#039;ll just go ahead and rant, then</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Sat Apr 04 2020 09:56:47 GMT-0700 (Pacific Daylight Time)">16:56</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=xalqor@irc>xalqor</span>&gt;</td><td class="msg-cell">i have a site with a page that is specifically intended for other sites to embed via iframe</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Sat Apr 04 2020 09:57:30 GMT-0700 (Pacific Daylight Time)">16:57</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=xalqor@irc>xalqor</span>&gt;</td><td class="msg-cell">for the user&#039;s convenience, if the user is already logged in to my site they should be able to access their logged-in account via the iframe</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Sat Apr 04 2020 09:57:53 GMT-0700 (Pacific Daylight Time)">16:57</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=xalqor@irc>xalqor</span>&gt;</td><td class="msg-cell">and this used to work but then browsers starting adding inconsistent/buggy support for 3rd party cookies</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Sat Apr 04 2020 09:58:27 GMT-0700 (Pacific Daylight Time)">16:58</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=xalqor@irc>xalqor</span>&gt;</td><td class="msg-cell">so i thought, ok I don&#039;t really need a cookie, I could just store a session id with localStorage since all the access is with javascript I can just add that token in a header</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Sat Apr 04 2020 09:58:58 GMT-0700 (Pacific Daylight Time)">16:58</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=xalqor@irc>xalqor</span>&gt;</td><td class="msg-cell">but the trouble is that localStorage seems to be blocked by browsers via the same setting that blocks 3rd party cookies</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Sat Apr 04 2020 10:00:09 GMT-0700 (Pacific Daylight Time)">17:00</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=xalqor@irc>xalqor</span>&gt;</td><td class="msg-cell">so site A loads an iframe with a page from site B, and the iframe tries to store foo=bar in localStorage, the browser interprets that as a request to store under site A&#039;s local storage and that&#039;s blocked if the user has &quot;block 3rd party cookies&quot;</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Sat Apr 04 2020 10:00:16 GMT-0700 (Pacific Daylight Time)">17:00</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">Yes, I think browsers are generally moving away from letting iframes track people around the internet in that way</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Sat Apr 04 2020 10:00:23 GMT-0700 (Pacific Daylight Time)">17:00</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">localStorage, cookies, whatever</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Sat Apr 04 2020 10:00:25 GMT-0700 (Pacific Daylight Time)">17:00</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=xalqor@irc>xalqor</span>&gt;</td><td class="msg-cell">yes but it&#039;s not about tracking users across sites</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Sat Apr 04 2020 10:00:42 GMT-0700 (Pacific Daylight Time)">17:00</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=xalqor@irc>xalqor</span>&gt;</td><td class="msg-cell">it&#039;s about communicating with users of my own site</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Sat Apr 04 2020 10:00:43 GMT-0700 (Pacific Daylight Time)">17:00</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">Knowing who the user is (i.e., accessing their logged in account) is tracking them</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Sat Apr 04 2020 10:00:52 GMT-0700 (Pacific Daylight Time)">17:00</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=xalqor@irc>xalqor</span>&gt;</td><td class="msg-cell">in fact I don&#039;t want my localStorage associated to site A at all</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Sat Apr 04 2020 10:01:05 GMT-0700 (Pacific Daylight Time)">17:01</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=xalqor@irc>xalqor</span>&gt;</td><td class="msg-cell">I&#039;d like a localStorage in an iframe that is associated only to the site the iframe came from</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Sat Apr 04 2020 10:01:43 GMT-0700 (Pacific Daylight Time)">17:01</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">The difficulty there is that the browser would need some guarantee that the embedding site never tells the iframe &quot;I exist&quot;</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Sat Apr 04 2020 10:02:39 GMT-0700 (Pacific Daylight Time)">17:02</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=xalqor@irc>xalqor</span>&gt;</td><td class="msg-cell">there could have been some iframe option to say, allow iframe-origin localStorage and block postMessage at the same time</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Sat Apr 04 2020 10:02:57 GMT-0700 (Pacific Daylight Time)">17:02</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">It&#039;d have to be stricter than that</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Sat Apr 04 2020 10:03:28 GMT-0700 (Pacific Daylight Time)">17:03</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">No headers, no query params... actually, I can&#039;t think of anything that would work, because you can just use the URL path</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Sat Apr 04 2020 10:03:53 GMT-0700 (Pacific Daylight Time)">17:03</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">E.g. &lt;iframe src=&quot;<a href="https://tracking-widget.example/userID1234/&quot;&gt;&lt;/iframe&gt">https://tracking-widget.example/userID1234/&quot;&gt;&lt;/iframe&gt</a>;</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Sat Apr 04 2020 10:03:58 GMT-0700 (Pacific Daylight Time)">17:03</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=xalqor@irc>xalqor</span>&gt;</td><td class="msg-cell">if the parent site wants to leak the user&#039;s identity i don&#039;t think you can stop it</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Sat Apr 04 2020 10:04:02 GMT-0700 (Pacific Daylight Time)">17:04</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">Right</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Sat Apr 04 2020 10:04:06 GMT-0700 (Pacific Daylight Time)">17:04</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">Which is why browsers are doing this</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Sat Apr 04 2020 10:04:13 GMT-0700 (Pacific Daylight Time)">17:04</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">So that once it&#039;s leaked, there&#039;s no way to store it</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Sat Apr 04 2020 10:04:29 GMT-0700 (Pacific Daylight Time)">17:04</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">Domenic: using allow=&quot;&quot; as additional guard for SAB postMessage() doesn&#039;t seem unreasonable to me, how serious is this proposal? Mainly wondering if you thought through all the changes required already.</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Sat Apr 04 2020 10:05:07 GMT-0700 (Pacific Daylight Time)">17:05</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">annevk: it is new and just something that came up. We have not thought it through very much but wanted to start a discussion earlier rather than later.</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Sat Apr 04 2020 10:05:07 GMT-0700 (Pacific Daylight Time)">17:05</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">Domenic: in particular, I&#039;m wondering if it should influence the public crossOriginIsolated getter and perhaps availability of the SAB constructor</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Sat Apr 04 2020 10:05:17 GMT-0700 (Pacific Daylight Time)">17:05</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">Domenic: kk</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Sat Apr 04 2020 10:05:52 GMT-0700 (Pacific Daylight Time)">17:05</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">annevk: it&#039;s a bit weirder for Chrome since this is all about a future move to lock up SAB, instead of about how to expose SAB.</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Sat Apr 04 2020 10:06:33 GMT-0700 (Pacific Daylight Time)">17:06</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">Influencing SAB constructor makes sense, unsure about the crossOriginIsolated getter</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Sat Apr 04 2020 10:06:50 GMT-0700 (Pacific Daylight Time)">17:06</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">If the meaning of crossOriginIsolated is &quot;powerful features available&quot; then that makes sense</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Sat Apr 04 2020 10:07:01 GMT-0700 (Pacific Daylight Time)">17:07</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">If the meaning is &quot;COOP+COEP enabled&quot; then maybe not</td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Sat Apr 04 2020 10:07:11 GMT-0700 (Pacific Daylight Time)">17:07</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">Probably &quot;powerful features available&quot; is more useful</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Sat Apr 04 2020 10:13:56 GMT-0700 (Pacific Daylight Time)">17:13</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=xalqor@irc>xalqor</span>&gt;</td><td class="msg-cell">iframe with postMessage was a great solution to let a site integrate a feature from a second site, while protecting the javascript in both directions</td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Sat Apr 04 2020 10:14:37 GMT-0700 (Pacific Daylight Time)">17:14</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=xalqor@irc>xalqor</span>&gt;</td><td class="msg-cell">so trying to do this in a way that respects user privacy, meaning it still works with all privacy settings enabled (but still allowing javascript)</td></tr>
  <tr class="msg" id="L35"><td class="ts-cell"><a class="ts" href="#L35" alt="Sat Apr 04 2020 10:15:52 GMT-0700 (Pacific Daylight Time)">17:15</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=xalqor@irc>xalqor</span>&gt;</td><td class="msg-cell">can it still be done?  if the user has an account at parent site and also on the iframe site, it seems like now the iframe will also need to have a login form inside</td></tr>
  <tr class="msg" id="L36"><td class="ts-cell"><a class="ts" href="#L36" alt="Sat Apr 04 2020 10:16:48 GMT-0700 (Pacific Daylight Time)">17:16</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=xalqor@irc>xalqor</span>&gt;</td><td class="msg-cell">definitely don&#039;t want the user to login through the parent site and reveal their credentials to some other site</td></tr>
  <tr class="msg" id="L37"><td class="ts-cell"><a class="ts" href="#L37" alt="Sat Apr 04 2020 10:16:58 GMT-0700 (Pacific Daylight Time)">17:16</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=xalqor@irc>xalqor</span>&gt;</td><td class="msg-cell">and if we develop a plugin now we have to do it separately for every browsre</td></tr>
  <tr class="msg" id="L38"><td class="ts-cell"><a class="ts" href="#L38" alt="Sat Apr 04 2020 10:17:00 GMT-0700 (Pacific Daylight Time)">17:17</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">xalqor: I am not an expert, but my understanding is that yes, logging in a second time is the current direction browsers are heading.</td></tr>
  <tr class="msg" id="L39"><td class="ts-cell"><a class="ts" href="#L39" alt="Sat Apr 04 2020 10:17:57 GMT-0700 (Pacific Daylight Time)">17:17</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=xalqor@irc>xalqor</span>&gt;</td><td class="msg-cell">but it&#039;s not just a second time, it&#039;s also every time they visit the parent site -- because the iframe can&#039;t store the cookie or anything in localStorage to remember that session across reloads</td></tr>
  <tr class="msg" id="L40"><td class="ts-cell"><a class="ts" href="#L40" alt="Sat Apr 04 2020 10:19:00 GMT-0700 (Pacific Daylight Time)">17:19</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">Hmm, I thought the plan was just a second time, i.e. you&#039;d get a different storage partition for when you&#039;re top level vs. when you&#039;re embedded in site A vs. when you&#039;re embedded in site B.</td></tr>
  <tr class="msg" id="L41"><td class="ts-cell"><a class="ts" href="#L41" alt="Sat Apr 04 2020 10:19:20 GMT-0700 (Pacific Daylight Time)">17:19</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=xalqor@irc>xalqor</span>&gt;</td><td class="msg-cell">if 3rd party cookies &amp; storage is blocked then it doesn&#039;t work</td></tr>
  <tr class="msg" id="L42"><td class="ts-cell"><a class="ts" href="#L42" alt="Sat Apr 04 2020 10:19:32 GMT-0700 (Pacific Daylight Time)">17:19</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=xalqor@irc>xalqor</span>&gt;</td><td class="msg-cell">and i don&#039;t want to tell my users to disable that setting -- because it affects them on all sites</td></tr>
  <tr class="msg" id="L43"><td class="ts-cell"><a class="ts" href="#L43" alt="Sat Apr 04 2020 10:19:52 GMT-0700 (Pacific Daylight Time)">17:19</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">Well I guess that setting is basically saying &quot;don&#039;t allow embedded iframes to store any state&quot; so it makes sense that it would prevent use cases like that</td></tr>
  <tr class="msg" id="L44"><td class="ts-cell"><a class="ts" href="#L44" alt="Sat Apr 04 2020 10:21:42 GMT-0700 (Pacific Daylight Time)">17:21</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">(embedded _third-party_ iframes, that is)</td></tr>
  <tr class="msg" id="L45"><td class="ts-cell"><a class="ts" href="#L45" alt="Sat Apr 04 2020 10:22:07 GMT-0700 (Pacific Daylight Time)">17:22</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=xalqor@irc>xalqor</span>&gt;</td><td class="msg-cell">yeah</td></tr>
  <tr class="msg" id="L46"><td class="ts-cell"><a class="ts" href="#L46" alt="Sat Apr 04 2020 10:24:03 GMT-0700 (Pacific Daylight Time)">17:24</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=xalqor@irc>xalqor</span>&gt;</td><td class="msg-cell">thanks for the chat, i will need to rethink how i&#039;m doing this thing</td></tr>
  <tr class="msg" id="L47"><td class="ts-cell"><a class="ts" href="#L47" alt="Sat Apr 04 2020 10:25:39 GMT-0700 (Pacific Daylight Time)">17:25</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">Happy to help!</td></tr>
  <tr class="msg" id="L48"><td class="ts-cell"><a class="ts" href="#L48" alt="Sat Apr 04 2020 10:42:06 GMT-0700 (Pacific Daylight Time)">17:42</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">Domenic: I’d like to keep the number of (public) booleans down I think. It’s confusing enough as-is</td></tr>
</tbody></table>
</div></div></div></body>
