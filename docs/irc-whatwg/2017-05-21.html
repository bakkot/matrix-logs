<!doctype html>
<head>
  <title>#whatwg on 2017-05-21</title>
  <link rel="stylesheet" href="../style.css">
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">#whatwg<br>2017-05-21<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2017-05-19" class="nav-link"><span>prev</span></a>
<a href="2017-05-22" class="nav-link"><span style="float:right">next</span></a>
</div>
    
<div class="room-list-wrapper">Active:<br>
<ul class="room-list">
<li><a href="../TC39_Delegates/">TC39 Delegates</a></li>
<li><a href="../TC39_Editors/">TC39 Editors</a></li>
<li><a href="../TC39_General/">TC39 General</a></li>
<li><a href="../WHATWG/">WHATWG</a></li>
</ul>
</div>
<br>
<div class="room-list-wrapper">Historical:<br>
<ul class="room-list">
<li><a href="../irc-tc39/">#tc39</a></li>
<li><a href="../irc-tc39-delegates/">#tc39-delegates</a></li>
<li><a href="../irc-tc39-editor-group/">#tc39-editor-group</a></li>
<li><a href="../irc-whatwg/" class="current-room">#whatwg</a></li>
</ul>
</div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs"><div class="log">
<table><tbody id="log-tbody">
  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Sat May 20 2017 20:38:56 GMT-0700 (Pacific Daylight Time)">03:38</a></td><td class="nick-cell">&lt;<span class="nick nick-8" title=domfarolino@irc>domfarolino</span>&gt;</td><td class="msg-cell">Why exactly are module scripts requested with CORS? This comment <a href="https://github.com/whatwg/html/pull/443#r48677306">https://github.com/whatwg/html/pull/443#r48677306</a> indicates it&#039;s necessary for security but I don&#039;t quite get &quot;introduce new ways to leak data from existing file types&quot; /cc annevk</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Sat May 20 2017 20:41:32 GMT-0700 (Pacific Daylight Time)">03:41</a></td><td class="nick-cell">&lt;<span class="nick nick-6" title=not-an-aardvark@irc>not-an-aardvark</span>&gt;</td><td class="msg-cell">There was additional discussion about it at <a href="https://github.com/whatwg/html/issues/1888">https://github.com/whatwg/html/issues/1888</a></td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Sat May 20 2017 20:42:04 GMT-0700 (Pacific Daylight Time)">03:42</a></td><td class="nick-cell">&lt;<span class="nick nick-8" title=domfarolino@irc>domfarolino</span>&gt;</td><td class="msg-cell">not-an-aardvark: thank you, will read</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Sun May 21 2017 04:31:18 GMT-0700 (Pacific Daylight Time)">11:31</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">domfarolino: that has all my points in it too</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Sun May 21 2017 10:18:07 GMT-0700 (Pacific Daylight Time)">17:18</a></td><td class="nick-cell">&lt;<span class="nick nick-8" title=domfarolino@irc>domfarolino</span>&gt;</td><td class="msg-cell">HTML standard (among other places) indicates a benefit to loading classic scripts via CORS is so that rich error information can be exposed to the client. I&#039;m having trouble simulating this though...</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Sun May 21 2017 10:19:07 GMT-0700 (Pacific Daylight Time)">17:19</a></td><td class="nick-cell">&lt;<span class="nick nick-8" title=domfarolino@irc>domfarolino</span>&gt;</td><td class="msg-cell">The document I&#039;m running locally can be found here <a href="https://gist.github.com/domfarolino/62ad3d9ccdcc160c62ec99b0b52d033b">https://gist.github.com/domfarolino/62ad3d9ccdcc160c62ec99b0b52d033b</a> and basically I don&#039;t see a difference in logged errors with either script tag in that gist..am I doing something wrong?</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Sun May 21 2017 10:39:13 GMT-0700 (Pacific Daylight Time)">17:39</a></td><td class="nick-cell">&lt;<span class="nick nick-8" title=domfarolino@irc>domfarolino</span>&gt;</td><td class="msg-cell">Ah ok. It seems that it&#039;s the error information specifically exposed to window.onerror (like message, url, line, column, error) that is obfuscated..not the uncaught error&#039;s stacktrace which still shows up in console</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Sun May 21 2017 10:47:48 GMT-0700 (Pacific Daylight Time)">17:47</a></td><td class="nick-cell">&lt;<span class="nick nick-8" title=domfarolino@irc>domfarolino</span>&gt;</td><td class="msg-cell">Hmm however it doesn&#039;t seem that Firefox&#039;s window.onerror has this same obfuscation...is this not standardized behavior?</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Sun May 21 2017 15:23:02 GMT-0700 (Pacific Daylight Time)">22:23</a></td><td class="nick-cell">&lt;<span class="nick nick-11" title=MikeSmith@irc>MikeSmith</span>&gt;</td><td class="msg-cell">domfarolino: not exposing it to frontend JavaScript code is required by the Fetch spec, right?</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Sun May 21 2017 15:24:49 GMT-0700 (Pacific Daylight Time)">22:24</a></td><td class="nick-cell">&lt;<span class="nick nick-8" title=domfarolino@irc>domfarolino</span>&gt;</td><td class="msg-cell">MikeSmith: not sure I can check when I get home. If so then I guess that&#039;s an FF bug unless I&#039;m missing something, bc iirc I got all the info passed to window.onerror</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Sun May 21 2017 15:25:48 GMT-0700 (Pacific Daylight Time)">22:25</a></td><td class="nick-cell">&lt;<span class="nick nick-11" title=MikeSmith@irc>MikeSmith</span>&gt;</td><td class="msg-cell">if <a href="https://demo1426415.mockable.io/errorjs">https://demo1426415.mockable.io/errorjs</a> is served with no Access-Control-Allow-Origin then Fetch requires that no part of the response be accessible to frontend JavaScript</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Sun May 21 2017 15:26:11 GMT-0700 (Pacific Daylight Time)">22:26</a></td><td class="nick-cell">&lt;<span class="nick nick-11" title=MikeSmith@irc>MikeSmith</span>&gt;</td><td class="msg-cell">the detailed error information is part of the response</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Sun May 21 2017 15:26:31 GMT-0700 (Pacific Daylight Time)">22:26</a></td><td class="nick-cell">&lt;<span class="nick nick-8" title=domfarolino@irc>domfarolino</span>&gt;</td><td class="msg-cell">I wasn&#039;t fetching it, was using it as the src attr on script tag</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Sun May 21 2017 15:26:40 GMT-0700 (Pacific Daylight Time)">22:26</a></td><td class="nick-cell">&lt;<span class="nick nick-11" title=MikeSmith@irc>MikeSmith</span>&gt;</td><td class="msg-cell">ah yeah</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Sun May 21 2017 15:27:14 GMT-0700 (Pacific Daylight Time)">22:27</a></td><td class="nick-cell">&lt;<span class="nick nick-11" title=MikeSmith@irc>MikeSmith</span>&gt;</td><td class="msg-cell">but in that case the Fetch is done with no-cors I think</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Sun May 21 2017 15:27:41 GMT-0700 (Pacific Daylight Time)">22:27</a></td><td class="nick-cell">&lt;<span class="nick nick-11" title=MikeSmith@irc>MikeSmith</span>&gt;</td><td class="msg-cell">which means the response is not exposed to frontend JS no matter what</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Sun May 21 2017 15:28:40 GMT-0700 (Pacific Daylight Time)">22:28</a></td><td class="nick-cell">&lt;<span class="nick nick-11" title=MikeSmith@irc>MikeSmith</span>&gt;</td><td class="msg-cell">opaque response</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Sun May 21 2017 15:29:55 GMT-0700 (Pacific Daylight Time)">22:29</a></td><td class="nick-cell">&lt;<span class="nick nick-11" title=MikeSmith@irc>MikeSmith</span>&gt;</td><td class="msg-cell">anyway annevk would be the best person to ask and get an explanation from, when heâ€™s not away</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Sun May 21 2017 16:25:52 GMT-0700 (Pacific Daylight Time)">23:25</a></td><td class="nick-cell">&lt;<span class="nick nick-8" title=domfarolino@irc>domfarolino</span>&gt;</td><td class="msg-cell">MikeSmith hmm,  using &lt;script src=&quot;//<a href="http://example.com/script.js&quot;&gt;&lt;/script&gt">example.com/script.js&quot;&gt;&lt;/script&gt</a>;, the response should still be avail in developer tools right? Either way, Issue with this is people say the data passed to window.onerror is obfuscated when window.onerror gets an error from script.js</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Sun May 21 2017 16:28:23 GMT-0700 (Pacific Daylight Time)">23:28</a></td><td class="nick-cell">&lt;<span class="nick nick-8" title=domfarolino@irc>domfarolino</span>&gt;</td><td class="msg-cell">This gist: <a href="https://gist.github.com/domfarolino/28725582270679b9e17fa74922cbfd65">https://gist.github.com/domfarolino/28725582270679b9e17fa74922cbfd65</a> produces this output in Chrome: <a href="https://image.ibb.co/gSgWyF/Screen_Shot_2017_05_21_at_4_27_06_PM.png">https://image.ibb.co/gSgWyF/Screen_Shot_2017_05_21_at_4_27_06_PM.png</a></td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Sun May 21 2017 16:28:59 GMT-0700 (Pacific Daylight Time)">23:28</a></td><td class="nick-cell">&lt;<span class="nick nick-8" title=domfarolino@irc>domfarolino</span>&gt;</td><td class="msg-cell">However in FF we don&#039;t get the &quot;Script error&quot; 0 0 thing...we just straight up get the real data</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Sun May 21 2017 16:47:13 GMT-0700 (Pacific Daylight Time)">23:47</a></td><td class="nick-cell">&lt;<span class="nick nick-11" title=MikeSmith@irc>MikeSmith</span>&gt;</td><td class="msg-cell">domfarolino: yeah the response will always be available in devtools</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Sun May 21 2017 16:47:35 GMT-0700 (Pacific Daylight Time)">23:47</a></td><td class="nick-cell">&lt;<span class="nick nick-8" title=domfarolino@irc>domfarolino</span>&gt;</td><td class="msg-cell">right, wanted to make sure we were on the same page</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Sun May 21 2017 16:48:22 GMT-0700 (Pacific Daylight Time)">23:48</a></td><td class="nick-cell">&lt;<span class="nick nick-11" title=MikeSmith@irc>MikeSmith</span>&gt;</td><td class="msg-cell">as far as why thereâ€™s a difference between Firefox and Chrome in what you get from window.onerror I dunno</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Sun May 21 2017 16:48:49 GMT-0700 (Pacific Daylight Time)">23:48</a></td><td class="nick-cell">&lt;<span class="nick nick-11" title=MikeSmith@irc>MikeSmith</span>&gt;</td><td class="msg-cell">it could be a bug in Firefox that itâ€™s not conforming to the Fetch spec on this</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Sun May 21 2017 16:49:02 GMT-0700 (Pacific Daylight Time)">23:49</a></td><td class="nick-cell">&lt;<span class="nick nick-11" title=MikeSmith@irc>MikeSmith</span>&gt;</td><td class="msg-cell">or I could just not be understanding</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Sun May 21 2017 16:49:13 GMT-0700 (Pacific Daylight Time)">23:49</a></td><td class="nick-cell">&lt;<span class="nick nick-11" title=MikeSmith@irc>MikeSmith</span>&gt;</td><td class="msg-cell">but annevk will be able to give you a clear answer</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Sun May 21 2017 16:53:03 GMT-0700 (Pacific Daylight Time)">23:53</a></td><td class="nick-cell">&lt;<span class="nick nick-8" title=domfarolino@irc>domfarolino</span>&gt;</td><td class="msg-cell">MikeSmith could you help find the section in the fetch spec you are referring to? I know that HTML refers to the `crossorigin` attribute and how it helps expose more specific error data (<a href="https://html.spec.whatwg.org/multipage/scripting.html#attr-script-crossorigin">https://html.spec.whatwg.org/multipage/scripting.html#attr-script-crossorigin</a>) but don&#039;t know where this sort of thing is in fetch</td></tr>
</tbody></table>
</div></div></div></body>
