<!doctype html>
<head>
  <title>#whatwg on 2015-04-08</title>
  <link rel="stylesheet" href="../style.css">
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">#whatwg<br>2015-04-08<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2015-04-07" class="nav-link"><span>prev</span></a>
<a href="2015-04-09" class="nav-link"><span style="float:right">next</span></a>
</div>
    
<div class="room-list-wrapper">Active:<br>
<ul class="room-list">
<li><a href="../TC39_Delegates/">TC39 Delegates</a></li>
<li><a href="../TC39_Editors/">TC39 Editors</a></li>
<li><a href="../TC39_General/">TC39 General</a></li>
<li><a href="../WHATWG/">WHATWG</a></li>
</ul>
</div>
<br>
<div class="room-list-wrapper">Historical:<br>
<ul class="room-list">
<li><a href="../irc-tc39/">#tc39</a></li>
<li><a href="../irc-tc39-delegates/">#tc39-delegates</a></li>
<li><a href="../irc-tc39-editor-group/">#tc39-editor-group</a></li>
<li><a href="../irc-whatwg/" class="current-room">#whatwg</a></li>
</ul>
</div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs"><div class="log">
<table><tbody id="log-tbody">
  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Tue Apr 07 2015 17:15:23 GMT-0700 (Pacific Daylight Time)">00:15</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">ok, back, although i should probably head out for the day</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Tue Apr 07 2015 17:16:04 GMT-0700 (Pacific Daylight Time)">00:16</a></td><td class="nick-cell">&lt;<span class="nick nick-3" title=terinjokes@irc>terinjokes</span>&gt;</td><td class="msg-cell">Domenic: you should go home</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Tue Apr 07 2015 17:16:04 GMT-0700 (Pacific Daylight Time)">00:16</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">this Promise.resolve analogy soothes me greatly</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Tue Apr 07 2015 17:16:19 GMT-0700 (Pacific Daylight Time)">00:16</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">(in general any time I can analogy to promises, I feel more confident)</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Tue Apr 07 2015 17:17:23 GMT-0700 (Pacific Daylight Time)">00:17</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">we can let pipeTo only accept true WritableStreams, and if in the future that becomes limiting we can add WritableStream.cast or similar as a mechanism for coping</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Tue Apr 07 2015 17:24:38 GMT-0700 (Pacific Daylight Time)">00:24</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: <a href="https://github.com/whatwg/streams/issues/321">https://github.com/whatwg/streams/issues/321</a></td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Tue Apr 07 2015 17:24:42 GMT-0700 (Pacific Daylight Time)">00:24</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">have a good night!</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Tue Apr 07 2015 23:37:06 GMT-0700 (Pacific Daylight Time)">06:37</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=JakeA@irc>JakeA</span>&gt;</td><td class="msg-cell">annevk: <a href="https://github.com/slightlyoff/ServiceWorker/issues/607#issuecomment-90819078">https://github.com/slightlyoff/ServiceWorker/issues/607#issuecomment-90819078</a> - I don&#039;t understand &quot;wait withÂ overrideRequestURL&quot;</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Tue Apr 07 2015 23:53:25 GMT-0700 (Pacific Daylight Time)">06:53</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">JakeA: just not implement it</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Tue Apr 07 2015 23:54:54 GMT-0700 (Pacific Daylight Time)">06:54</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">JakeA: what you argue for would be a new special case that did not exist before; the case the implementers brought up was not considered when we figured it as a shorthand for short-circuiting redirects</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Tue Apr 07 2015 23:58:22 GMT-0700 (Pacific Daylight Time)">06:58</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=JakeA@irc>JakeA</span>&gt;</td><td class="msg-cell">annevk: we&#039;ve got some internal customers for this, I&#039;ll find out if the API works for them. But yeah, in that case it isn&#039;t exactly like a redirect.</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Tue Apr 07 2015 23:58:56 GMT-0700 (Pacific Daylight Time)">06:58</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">JakeA: it would be interesting to hear why they can&#039;t use Response.redirect()</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Wed Apr 08 2015 00:05:13 GMT-0700 (Pacific Daylight Time)">07:05</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=JakeA@irc>JakeA</span>&gt;</td><td class="msg-cell">annevk: yeah, I&#039;m digging into that and building them an example</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Wed Apr 08 2015 01:00:51 GMT-0700 (Pacific Daylight Time)">08:00</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">Is anyone using <a href="https://atom.io/">https://atom.io/</a>?</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Wed Apr 08 2015 01:41:34 GMT-0700 (Pacific Daylight Time)">08:41</a></td><td class="nick-cell">&lt;<span class="nick nick-11" title=philipj@irc>philipj</span>&gt;</td><td class="msg-cell">annevk: I think the general situation is that Content-Type is ignored for both media elements and &lt;track&gt;</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Wed Apr 08 2015 01:42:07 GMT-0700 (Pacific Daylight Time)">08:42</a></td><td class="nick-cell">&lt;<span class="nick nick-11" title=philipj@irc>philipj</span>&gt;</td><td class="msg-cell">there&#039;s a bit of a history, but since Microsoft caved and started ignoring it in IE I think there&#039;s no turning back (which I&#039;m happy about)</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Wed Apr 08 2015 01:42:42 GMT-0700 (Pacific Daylight Time)">08:42</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">philipj: so for X-Content-Type-Options: nosniff we want to give server administrators the feature of enforcing Content-Type for resources so they can&#039;t be used in an unexpected context</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Wed Apr 08 2015 01:43:09 GMT-0700 (Pacific Daylight Time)">08:43</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">philipj: this requires a whitelist of MIME types for audio/video and a separate set for track</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Wed Apr 08 2015 01:43:17 GMT-0700 (Pacific Daylight Time)">08:43</a></td><td class="nick-cell">&lt;<span class="nick nick-11" title=philipj@irc>philipj</span>&gt;</td><td class="msg-cell">uh, ok, I couldn&#039;t say how that currently works</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Wed Apr 08 2015 01:44:10 GMT-0700 (Pacific Daylight Time)">08:44</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">philipj: it doesn&#039;t for those contexts</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Wed Apr 08 2015 01:44:16 GMT-0700 (Pacific Daylight Time)">08:44</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">philipj: well, it might in IE</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Wed Apr 08 2015 01:44:19 GMT-0700 (Pacific Daylight Time)">08:44</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">I haven&#039;t tested IE yet</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Wed Apr 08 2015 01:44:32 GMT-0700 (Pacific Daylight Time)">08:44</a></td><td class="nick-cell">&lt;<span class="nick nick-11" title=philipj@irc>philipj</span>&gt;</td><td class="msg-cell">for &lt;track&gt; there&#039;s just no code that looks at Content-Type, at least not in Blink, if it&#039;s not WebVTT then it won&#039;t work</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Wed Apr 08 2015 02:33:12 GMT-0700 (Pacific Daylight Time)">09:33</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">philipj: okay, so we could just make the whitelist text/webvtt</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Wed Apr 08 2015 02:33:19 GMT-0700 (Pacific Daylight Time)">09:33</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">philipj: for CSS it&#039;s text/css at the moment</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Wed Apr 08 2015 02:33:50 GMT-0700 (Pacific Daylight Time)">09:33</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">philipj: only unclear thing then is the MIME types for audio/video which is somewhat of a trainwreck</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Wed Apr 08 2015 02:45:47 GMT-0700 (Pacific Daylight Time)">09:45</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">text/vtt*</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Wed Apr 08 2015 02:57:13 GMT-0700 (Pacific Daylight Time)">09:57</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell"><a href="http://w3cdreams.tumblr.com/">http://w3cdreams.tumblr.com/</a></td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Wed Apr 08 2015 03:01:11 GMT-0700 (Pacific Daylight Time)">10:01</a></td><td class="nick-cell">&lt;<span class="nick nick-6" title=jgraham@irc>jgraham</span>&gt;</td><td class="msg-cell">Wow, well I was enjoying that and then the Service Worker thing guenuninely made me feel ill</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Wed Apr 08 2015 03:10:45 GMT-0700 (Pacific Daylight Time)">10:10</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">jgraham: hypno cat?</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Wed Apr 08 2015 03:12:39 GMT-0700 (Pacific Daylight Time)">10:12</a></td><td class="nick-cell">&lt;<span class="nick nick-6" title=jgraham@irc>jgraham</span>&gt;</td><td class="msg-cell">Possibly</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Wed Apr 08 2015 03:13:05 GMT-0700 (Pacific Daylight Time)">10:13</a></td><td class="nick-cell">&lt;<span class="nick nick-6" title=jgraham@irc>jgraham</span>&gt;</td><td class="msg-cell">Also made me unable to spell genuinely</td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Wed Apr 08 2015 03:17:04 GMT-0700 (Pacific Daylight Time)">10:17</a></td><td class="nick-cell">&lt;<span class="nick nick-14" title=zcorpan@irc>zcorpan</span>&gt;</td><td class="msg-cell">just need to let the eyes follow the circles a few laps and then you&#039;ll feel better again</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Wed Apr 08 2015 07:52:24 GMT-0700 (Pacific Daylight Time)">14:52</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: you said there were user space Promise libs that were faster than browser implementations... can you point me at one you recommend for perf?</td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Wed Apr 08 2015 07:52:52 GMT-0700 (Pacific Daylight Time)">14:52</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title=bradleymeck@irc>bradleymeck</span>&gt;</td><td class="msg-cell">wanderview: bluebird</td></tr>
  <tr class="msg" id="L35"><td class="ts-cell"><a class="ts" href="#L35" alt="Wed Apr 08 2015 07:52:59 GMT-0700 (Pacific Daylight Time)">14:52</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">yep</td></tr>
  <tr class="msg" id="L36"><td class="ts-cell"><a class="ts" href="#L36" alt="Wed Apr 08 2015 07:56:05 GMT-0700 (Pacific Daylight Time)">14:56</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: should I just be able to drop this in with the stream reference impl?</td></tr>
  <tr class="msg" id="L37"><td class="ts-cell"><a class="ts" href="#L37" alt="Wed Apr 08 2015 07:57:19 GMT-0700 (Pacific Daylight Time)">14:57</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: ugh, the reference impl is so un-optimized...</td></tr>
  <tr class="msg" id="L38"><td class="ts-cell"><a class="ts" href="#L38" alt="Wed Apr 08 2015 07:57:38 GMT-0700 (Pacific Daylight Time)">14:57</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: but, yeah, if you do global.Promise = require(&#039;bluebird&#039;) it should be drop-in-able</td></tr>
  <tr class="msg" id="L39"><td class="ts-cell"><a class="ts" href="#L39" alt="Wed Apr 08 2015 07:58:11 GMT-0700 (Pacific Daylight Time)">14:58</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">But I mean, all the asserts (in loops too!) and try/catches and the hilarious queue-with-sizes implementation will dwarf the performance change I think</td></tr>
  <tr class="msg" id="L40"><td class="ts-cell"><a class="ts" href="#L40" alt="Wed Apr 08 2015 08:01:40 GMT-0700 (Pacific Daylight Time)">15:01</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: meeting now... but I&#039;ll try to describe the case I&#039;m concerned with... I can write something not use ref impl, but just something similar to tease out the Promise impact</td></tr>
  <tr class="msg" id="L41"><td class="ts-cell"><a class="ts" href="#L41" alt="Wed Apr 08 2015 08:03:54 GMT-0700 (Pacific Daylight Time)">15:03</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: OK cool. Be sure it does actual I/O too :)</td></tr>
  <tr class="msg" id="L42"><td class="ts-cell"><a class="ts" href="#L42" alt="Wed Apr 08 2015 08:04:17 GMT-0700 (Pacific Daylight Time)">15:04</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: javascript consumers may not do actual I/O</td></tr>
  <tr class="msg" id="L43"><td class="ts-cell"><a class="ts" href="#L43" alt="Wed Apr 08 2015 08:05:50 GMT-0700 (Pacific Daylight Time)">15:05</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">Ultimately the stream should be grounded in some I/O, most likely</td></tr>
  <tr class="msg" id="L44"><td class="ts-cell"><a class="ts" href="#L44" alt="Wed Apr 08 2015 08:06:09 GMT-0700 (Pacific Daylight Time)">15:06</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">E.g. maybe your stream vends JS objects but it&#039;s derived from some stream that read from a file/network</td></tr>
  <tr class="msg" id="L45"><td class="ts-cell"><a class="ts" href="#L45" alt="Wed Apr 08 2015 08:36:48 GMT-0700 (Pacific Daylight Time)">15:36</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: is it not reasonable for js to do in-memory operations like your stream demo where its searching for a particular value?  that is not I/O related</td></tr>
  <tr class="msg" id="L46"><td class="ts-cell"><a class="ts" href="#L46" alt="Wed Apr 08 2015 08:36:58 GMT-0700 (Pacific Daylight Time)">15:36</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: how is that no I/O related?</td></tr>
  <tr class="msg" id="L47"><td class="ts-cell"><a class="ts" href="#L47" alt="Wed Apr 08 2015 08:37:09 GMT-0700 (Pacific Daylight Time)">15:37</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: the stream is a fetch stream</td></tr>
  <tr class="msg" id="L48"><td class="ts-cell"><a class="ts" href="#L48" alt="Wed Apr 08 2015 08:37:35 GMT-0700 (Pacific Daylight Time)">15:37</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: I thought you meant on the consumption side you wanted it to be I/O</td></tr>
  <tr class="msg" id="L49"><td class="ts-cell"><a class="ts" href="#L49" alt="Wed Apr 08 2015 08:37:51 GMT-0700 (Pacific Daylight Time)">15:37</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: oh, no, i just meant that each promise produced from the reader should correspond to doing some I/O</td></tr>
  <tr class="msg" id="L50"><td class="ts-cell"><a class="ts" href="#L50" alt="Wed Apr 08 2015 08:38:59 GMT-0700 (Pacific Daylight Time)">15:38</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">i.e., don&#039;t test for (let i = 0; i &lt; 1000; ++i) { Promise.resolve(5).then(foo); }; test for (let i = 0; i &lt; 1000; ++i) { <a href="http://fs.read">fs.read</a>(fd, ...).then(foo); })</td></tr>
  <tr class="msg" id="L51"><td class="ts-cell"><a class="ts" href="#L51" alt="Wed Apr 08 2015 08:39:04 GMT-0700 (Pacific Daylight Time)">15:39</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: the main case I can think of that concerns me is where you write data to a pipe buffer... and then want to read it starting at some later time... in that case the pipe .read() is not related to I/O until the buffer is drained... and draining the buffer will be much slower than with sync .read()</td></tr>
  <tr class="msg" id="L52"><td class="ts-cell"><a class="ts" href="#L52" alt="Wed Apr 08 2015 08:39:39 GMT-0700 (Pacific Daylight Time)">15:39</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">&quot;much&quot; slower citation needed... especially since sync read() would need to use async .ready or similar for backpressure signals</td></tr>
  <tr class="msg" id="L53"><td class="ts-cell"><a class="ts" href="#L53" alt="Wed Apr 08 2015 08:39:54 GMT-0700 (Pacific Daylight Time)">15:39</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: thats why I want to test with real Promises :-)</td></tr>
  <tr class="msg" id="L54"><td class="ts-cell"><a class="ts" href="#L54" alt="Wed Apr 08 2015 08:40:02 GMT-0700 (Pacific Daylight Time)">15:40</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">sounds good :)</td></tr>
  <tr class="msg" id="L55"><td class="ts-cell"><a class="ts" href="#L55" alt="Wed Apr 08 2015 08:40:19 GMT-0700 (Pacific Daylight Time)">15:40</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: I agree at least one async operation is needed... but doing it on every buffered chunk seems potentially not good</td></tr>
  <tr class="msg" id="L56"><td class="ts-cell"><a class="ts" href="#L56" alt="Wed Apr 08 2015 08:41:30 GMT-0700 (Pacific Daylight Time)">15:41</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: I&#039;m going to put this in the batch read issue... I think some kind of .readAllAvailable() would solve this... give me an array of all available chunks... so you get an array of length 1 or greater</td></tr>
  <tr class="msg" id="L57"><td class="ts-cell"><a class="ts" href="#L57" alt="Wed Apr 08 2015 08:41:48 GMT-0700 (Pacific Daylight Time)">15:41</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">for cases where you just want to read as fast as possible</td></tr>
  <tr class="msg" id="L58"><td class="ts-cell"><a class="ts" href="#L58" alt="Wed Apr 08 2015 08:41:52 GMT-0700 (Pacific Daylight Time)">15:41</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: sounds good, yeah. Or 0 chunks if end of stream.</td></tr>
  <tr class="msg" id="L59"><td class="ts-cell"><a class="ts" href="#L59" alt="Wed Apr 08 2015 08:52:33 GMT-0700 (Pacific Daylight Time)">15:52</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: I guess my concern here started by looking at the current rs.pipeTo() implementation... since it waits for each .read() to resolve before calling .read() again... you can&#039;t get any pipelining going that way... and then I started to wonder if it should do two .read() calls... so while its writing the first its already started the async process to get</td></tr>
  <tr class="msg" id="L60"><td class="ts-cell"><a class="ts" href="#L60" alt="Wed Apr 08 2015 08:52:34 GMT-0700 (Pacific Daylight Time)">15:52</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">the next, etc</td></tr>
  <tr class="msg" id="L61"><td class="ts-cell"><a class="ts" href="#L61" alt="Wed Apr 08 2015 08:53:33 GMT-0700 (Pacific Daylight Time)">15:53</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: right, but that should only delay at most a microtask, and then it will resolve and immediately call read() again, and the stack only has to unwind one frame since we&#039;re already in the microtask loop... it&#039;s one extra frame per loop iteration basically.</td></tr>
  <tr class="msg" id="L62"><td class="ts-cell"><a class="ts" href="#L62" alt="Wed Apr 08 2015 09:02:55 GMT-0700 (Pacific Daylight Time)">16:02</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=JakeA@irc>JakeA</span>&gt;</td><td class="msg-cell">wanderview: I&#039;ve been thinking about cache.add[All]. I&#039;ve been seeing a lot of examples check the status code of responses before putting them into the cache. Maybe we should revisit the idea of checking response.ok before caching (as an option). This would of course fail on all opaque responses. Do you think it&#039;s still useful?</td></tr>
  <tr class="msg" id="L63"><td class="ts-cell"><a class="ts" href="#L63" alt="Wed Apr 08 2015 09:05:48 GMT-0700 (Pacific Daylight Time)">16:05</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">JakeA: in a meeting</td></tr>
  <tr class="msg" id="L64"><td class="ts-cell"><a class="ts" href="#L64" alt="Wed Apr 08 2015 09:05:55 GMT-0700 (Pacific Daylight Time)">16:05</a></td><td class="nick-cell">&lt;<span class="nick nick-7" title=JakeA@irc>JakeA</span>&gt;</td><td class="msg-cell">no rush</td></tr>
  <tr class="msg" id="L65"><td class="ts-cell"><a class="ts" href="#L65" alt="Wed Apr 08 2015 10:06:51 GMT-0700 (Pacific Daylight Time)">17:06</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">JakeA: should it not be added to fetch() then?</td></tr>
  <tr class="msg" id="L66"><td class="ts-cell"><a class="ts" href="#L66" alt="Wed Apr 08 2015 10:15:07 GMT-0700 (Pacific Daylight Time)">17:15</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">JakeA: that sounds fine to me... I don&#039;t really have an opinion... whatever developers want/expect</td></tr>
  <tr class="msg" id="L67"><td class="ts-cell"><a class="ts" href="#L67" alt="Wed Apr 08 2015 10:15:21 GMT-0700 (Pacific Daylight Time)">17:15</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">not sure I understand the opaque response thing, though</td></tr>
  <tr class="msg" id="L68"><td class="ts-cell"><a class="ts" href="#L68" alt="Wed Apr 08 2015 10:15:35 GMT-0700 (Pacific Daylight Time)">17:15</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">Domenic: the post-ES6 specification plan sounds rather lovely</td></tr>
  <tr class="msg" id="L69"><td class="ts-cell"><a class="ts" href="#L69" alt="Wed Apr 08 2015 10:15:46 GMT-0700 (Pacific Daylight Time)">17:15</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">:)</td></tr>
  <tr class="msg" id="L70"><td class="ts-cell"><a class="ts" href="#L70" alt="Wed Apr 08 2015 10:15:51 GMT-0700 (Pacific Daylight Time)">17:15</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">we&#039;ll see if we can pull it off...</td></tr>
  <tr class="msg" id="L71"><td class="ts-cell"><a class="ts" href="#L71" alt="Wed Apr 08 2015 10:16:05 GMT-0700 (Pacific Daylight Time)">17:16</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">Domenic: I wonder if WHATWG can gradually convert to that as well</td></tr>
  <tr class="msg" id="L72"><td class="ts-cell"><a class="ts" href="#L72" alt="Wed Apr 08 2015 10:16:15 GMT-0700 (Pacific Daylight Time)">17:16</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">what plan?</td></tr>
  <tr class="msg" id="L73"><td class="ts-cell"><a class="ts" href="#L73" alt="Wed Apr 08 2015 10:16:30 GMT-0700 (Pacific Daylight Time)">17:16</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">wanderview: <a href="https://esdiscuss.org/topic/the-great-tooling-revolution">https://esdiscuss.org/topic/the-great-tooling-revolution</a></td></tr>
  <tr class="msg" id="L74"><td class="ts-cell"><a class="ts" href="#L74" alt="Wed Apr 08 2015 10:18:13 GMT-0700 (Pacific Daylight Time)">17:18</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">annevk: you mean the two-impls thing?</td></tr>
  <tr class="msg" id="L75"><td class="ts-cell"><a class="ts" href="#L75" alt="Wed Apr 08 2015 10:18:29 GMT-0700 (Pacific Daylight Time)">17:18</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">Domenic: the tooling and writing style</td></tr>
  <tr class="msg" id="L76"><td class="ts-cell"><a class="ts" href="#L76" alt="Wed Apr 08 2015 10:18:43 GMT-0700 (Pacific Daylight Time)">17:18</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">annevk: ah interesting.</td></tr>
  <tr class="msg" id="L77"><td class="ts-cell"><a class="ts" href="#L77" alt="Wed Apr 08 2015 10:19:32 GMT-0700 (Pacific Daylight Time)">17:19</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</td><td class="msg-cell">having said that, ES6 is rather hard to digest, but some of the algorithm shorthands you&#039;re introducing seem nice</td></tr>
  <tr class="msg" id="L78"><td class="ts-cell"><a class="ts" href="#L78" alt="Wed Apr 08 2015 10:19:43 GMT-0700 (Pacific Daylight Time)">17:19</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">Yeah, I was going to say, &quot;Ecmaspeak&quot;&#039;s evolution into something more user-friendly is still in progress (cf. <a href="https://streams.spec.whatwg.org/#conventions">https://streams.spec.whatwg.org/#conventions</a>)</td></tr>
  <tr class="msg" id="L79"><td class="ts-cell"><a class="ts" href="#L79" alt="Wed Apr 08 2015 10:19:54 GMT-0700 (Pacific Daylight Time)">17:19</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">And it&#039;s unclear the value of Ecmaspeak vs. some kind of &quot;spec ES&quot;</td></tr>
  <tr class="msg" id="L80"><td class="ts-cell"><a class="ts" href="#L80" alt="Wed Apr 08 2015 10:20:09 GMT-0700 (Pacific Daylight Time)">17:20</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: what does chrome&#039;s shipping Response body stream do for a Response returned from cache.match()?  does it stream from disk?</td></tr>
  <tr class="msg" id="L81"><td class="ts-cell"><a class="ts" href="#L81" alt="Wed Apr 08 2015 10:20:32 GMT-0700 (Pacific Daylight Time)">17:20</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: good... question...... tyoshino are you awake perchance?</td></tr>
  <tr class="msg" id="L82"><td class="ts-cell"><a class="ts" href="#L82" alt="Wed Apr 08 2015 10:20:37 GMT-0700 (Pacific Daylight Time)">17:20</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">I mean... is that implemented in this first version</td></tr>
  <tr class="msg" id="L83"><td class="ts-cell"><a class="ts" href="#L83" alt="Wed Apr 08 2015 10:20:50 GMT-0700 (Pacific Daylight Time)">17:20</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">oh hi yhirano_ is in here too</td></tr>
  <tr class="msg" id="L84"><td class="ts-cell"><a class="ts" href="#L84" alt="Wed Apr 08 2015 10:21:29 GMT-0700 (Pacific Daylight Time)">17:21</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">Maybe the thing to do is ask on the blink-dev Intent to Ship thread?</td></tr>
  <tr class="msg" id="L85"><td class="ts-cell"><a class="ts" href="#L85" alt="Wed Apr 08 2015 10:27:18 GMT-0700 (Pacific Daylight Time)">17:27</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: ok, will do... mainly just curious</td></tr>
  <tr class="msg" id="L86"><td class="ts-cell"><a class="ts" href="#L86" alt="Wed Apr 08 2015 10:28:26 GMT-0700 (Pacific Daylight Time)">17:28</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: what is WritableStream.getWriter() you to mention in that issue update?  I don;t see that in the spec</td></tr>
  <tr class="msg" id="L87"><td class="ts-cell"><a class="ts" href="#L87" alt="Wed Apr 08 2015 10:59:58 GMT-0700 (Pacific Daylight Time)">17:59</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: <a href="https://github.com/whatwg/streams/issues/319">https://github.com/whatwg/streams/issues/319</a> :-S</td></tr>
  <tr class="msg" id="L88"><td class="ts-cell"><a class="ts" href="#L88" alt="Wed Apr 08 2015 11:00:33 GMT-0700 (Pacific Daylight Time)">18:00</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">ok... so not spec&#039;d yet</td></tr>
  <tr class="msg" id="L89"><td class="ts-cell"><a class="ts" href="#L89" alt="Wed Apr 08 2015 11:00:41 GMT-0700 (Pacific Daylight Time)">18:00</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">wasn&#039;t sure if it was coming or previous-and-gone</td></tr>
  <tr class="msg" id="L90"><td class="ts-cell"><a class="ts" href="#L90" alt="Wed Apr 08 2015 11:01:04 GMT-0700 (Pacific Daylight Time)">18:01</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">heh... yeah</td></tr>
  <tr class="msg" id="L91"><td class="ts-cell"><a class="ts" href="#L91" alt="Wed Apr 08 2015 11:01:15 GMT-0700 (Pacific Daylight Time)">18:01</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: related <a href="https://github.com/whatwg/streams/commit/d757e05cf27f73488d13825e51ce5706a759ab27">https://github.com/whatwg/streams/commit/d757e05cf27f73488d13825e51ce5706a759ab27</a></td></tr>
  <tr class="msg" id="L92"><td class="ts-cell"><a class="ts" href="#L92" alt="Wed Apr 08 2015 11:04:51 GMT-0700 (Pacific Daylight Time)">18:04</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: I didn&#039;t want to bikeshed more in the &quot;getReader is named poorly&quot; issue... but take() is also widely used for locking concepts :-)</td></tr>
  <tr class="msg" id="L93"><td class="ts-cell"><a class="ts" href="#L93" alt="Wed Apr 08 2015 11:09:41 GMT-0700 (Pacific Daylight Time)">18:09</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">meeeeeeeeeeehhhhhh</td></tr>
  <tr class="msg" id="L94"><td class="ts-cell"><a class="ts" href="#L94" alt="Wed Apr 08 2015 11:12:32 GMT-0700 (Pacific Daylight Time)">18:12</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: getReader() does not unlock if the reader gets GC&#039;d right?  or rather, the whole stream has to be GC&#039;d in addition to the reader?</td></tr>
  <tr class="msg" id="L95"><td class="ts-cell"><a class="ts" href="#L95" alt="Wed Apr 08 2015 11:12:48 GMT-0700 (Pacific Daylight Time)">18:12</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: right. (and in the latter case i&#039;m not sure there&#039;s a difference.)</td></tr>
  <tr class="msg" id="L96"><td class="ts-cell"><a class="ts" href="#L96" alt="Wed Apr 08 2015 11:12:58 GMT-0700 (Pacific Daylight Time)">18:12</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: webkit has a test showing this</td></tr>
  <tr class="msg" id="L97"><td class="ts-cell"><a class="ts" href="#L97" alt="Wed Apr 08 2015 11:13:15 GMT-0700 (Pacific Daylight Time)">18:13</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">unsure how/whether to put it in the general suite...</td></tr>
  <tr class="msg" id="L98"><td class="ts-cell"><a class="ts" href="#L98" alt="Wed Apr 08 2015 11:13:58 GMT-0700 (Pacific Daylight Time)">18:13</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: I really dislike stuff with explicit release like revokeObjectUrl()...  so many leaks in code that use them... the error paths are atrocious</td></tr>
  <tr class="msg" id="L99"><td class="ts-cell"><a class="ts" href="#L99" alt="Wed Apr 08 2015 11:14:27 GMT-0700 (Pacific Daylight Time)">18:14</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">from my experience with code in fxos trying to use that kind of API</td></tr>
  <tr class="msg" id="L100"><td class="ts-cell"><a class="ts" href="#L100" alt="Wed Apr 08 2015 11:14:44 GMT-0700 (Pacific Daylight Time)">18:14</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: well this case is pretty different, since it&#039;s not like you could successfully get another reader by waiting for GC of the first one, since that&#039;s unreliable</td></tr>
  <tr class="msg" id="L101"><td class="ts-cell"><a class="ts" href="#L101" alt="Wed Apr 08 2015 11:15:00 GMT-0700 (Pacific Daylight Time)">18:15</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">that&#039;s a fair argument for the lifecycle management thread though</td></tr>
  <tr class="msg" id="L102"><td class="ts-cell"><a class="ts" href="#L102" alt="Wed Apr 08 2015 11:15:01 GMT-0700 (Pacific Daylight Time)">18:15</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">yea</td></tr>
  <tr class="msg" id="L103"><td class="ts-cell"><a class="ts" href="#L103" alt="Wed Apr 08 2015 11:15:09 GMT-0700 (Pacific Daylight Time)">18:15</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">I think I mentioned it there</td></tr>
  <tr class="msg" id="L104"><td class="ts-cell"><a class="ts" href="#L104" alt="Wed Apr 08 2015 11:16:27 GMT-0700 (Pacific Daylight Time)">18:16</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: is there a finally thing on promises for people to always return the reader?</td></tr>
  <tr class="msg" id="L105"><td class="ts-cell"><a class="ts" href="#L105" alt="Wed Apr 08 2015 11:16:34 GMT-0700 (Pacific Daylight Time)">18:16</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">maybe that makes it less of a problem</td></tr>
  <tr class="msg" id="L106"><td class="ts-cell"><a class="ts" href="#L106" alt="Wed Apr 08 2015 11:17:40 GMT-0700 (Pacific Daylight Time)">18:17</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: we&#039;ve been wanting to add finally to promises for a long time, and this cancelable promise stuff might push it over the line.</td></tr>
  <tr class="msg" id="L107"><td class="ts-cell"><a class="ts" href="#L107" alt="Wed Apr 08 2015 11:19:15 GMT-0700 (Pacific Daylight Time)">18:19</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: I guess its not a huge problem here... since lock is released automatically on close</td></tr>
  <tr class="msg" id="L108"><td class="ts-cell"><a class="ts" href="#L108" alt="Wed Apr 08 2015 11:19:28 GMT-0700 (Pacific Daylight Time)">18:19</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">its optimized for single reader case... which is what we want</td></tr>
  <tr class="msg" id="L109"><td class="ts-cell"><a class="ts" href="#L109" alt="Wed Apr 08 2015 11:24:35 GMT-0700 (Pacific Daylight Time)">18:24</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: yeah, that&#039;s kind of the idea. if anyone&#039;s doing something tricky like parsing a header portion then passing the partially-read stream on to someone else, they can probably remember to release the lock. Although I agree finally would be nice.</td></tr>
  <tr class="msg" id="L110"><td class="ts-cell"><a class="ts" href="#L110" alt="Wed Apr 08 2015 11:25:33 GMT-0700 (Pacific Daylight Time)">18:25</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: that seems like something easier down with pipeThrough()... although it would be nice to remove the header transform piece after its done</td></tr>
  <tr class="msg" id="L111"><td class="ts-cell"><a class="ts" href="#L111" alt="Wed Apr 08 2015 11:25:55 GMT-0700 (Pacific Daylight Time)">18:25</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">hmm yeah that&#039;s true</td></tr>
  <tr class="msg" id="L112"><td class="ts-cell"><a class="ts" href="#L112" alt="Wed Apr 08 2015 11:26:12 GMT-0700 (Pacific Daylight Time)">18:26</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">^down^done</td></tr>
  <tr class="msg" id="L113"><td class="ts-cell"><a class="ts" href="#L113" alt="Wed Apr 08 2015 11:26:16 GMT-0700 (Pacific Daylight Time)">18:26</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">i guess most uses of readers are hidden behind the higher-level methods like pipe*() and tee()</td></tr>
  <tr class="msg" id="L114"><td class="ts-cell"><a class="ts" href="#L114" alt="Wed Apr 08 2015 11:42:14 GMT-0700 (Pacific Daylight Time)">18:42</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=calvaris@irc>calvaris</span>&gt;</td><td class="msg-cell">sorry, I just fell and I don&#039;t know if you read what I said but</td></tr>
  <tr class="msg" id="L115"><td class="ts-cell"><a class="ts" href="#L115" alt="Wed Apr 08 2015 11:42:21 GMT-0700 (Pacific Daylight Time)">18:42</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=calvaris@irc>calvaris</span>&gt;</td><td class="msg-cell">wanderview: I have a pull request with that test</td></tr>
  <tr class="msg" id="L116"><td class="ts-cell"><a class="ts" href="#L116" alt="Wed Apr 08 2015 11:42:26 GMT-0700 (Pacific Daylight Time)">18:42</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=calvaris@irc>calvaris</span>&gt;</td><td class="msg-cell">all custom tests that we had for WK are now there and waiting for Domenic to merge them</td></tr>
  <tr class="msg" id="L117"><td class="ts-cell"><a class="ts" href="#L117" alt="Wed Apr 08 2015 11:43:11 GMT-0700 (Pacific Daylight Time)">18:43</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">calvaris: which test?</td></tr>
  <tr class="msg" id="L118"><td class="ts-cell"><a class="ts" href="#L118" alt="Wed Apr 08 2015 11:44:14 GMT-0700 (Pacific Daylight Time)">18:44</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=calvaris@irc>calvaris</span>&gt;</td><td class="msg-cell">the one for the garbage collection regarding the reader</td></tr>
  <tr class="msg" id="L119"><td class="ts-cell"><a class="ts" href="#L119" alt="Wed Apr 08 2015 11:44:14 GMT-0700 (Pacific Daylight Time)">18:44</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: btw, we apparently do implement microtask queue in gecko now</td></tr>
  <tr class="msg" id="L120"><td class="ts-cell"><a class="ts" href="#L120" alt="Wed Apr 08 2015 11:44:31 GMT-0700 (Pacific Daylight Time)">18:44</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">calvaris: ah, cool</td></tr>
  <tr class="msg" id="L121"><td class="ts-cell"><a class="ts" href="#L121" alt="Wed Apr 08 2015 11:45:13 GMT-0700 (Pacific Daylight Time)">18:45</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: ah that&#039;s excellent</td></tr>
  <tr class="msg" id="L122"><td class="ts-cell"><a class="ts" href="#L122" alt="Wed Apr 08 2015 11:45:44 GMT-0700 (Pacific Daylight Time)">18:45</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: I still don&#039;t think our c++ can optimize around them, though... since js can call into c++ with js still on the stack</td></tr>
  <tr class="msg" id="L123"><td class="ts-cell"><a class="ts" href="#L123" alt="Wed Apr 08 2015 12:59:00 GMT-0700 (Pacific Daylight Time)">19:59</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=trevnorris@irc>trevnorris</span>&gt;</td><td class="msg-cell">Domenic: &quot;Cheaper than I/O&quot; doesn&#039;t say a lot and Promise instantiation speed isn&#039;t the only thing to consider. It&#039;s the complete time from .push() to .read().</td></tr>
  <tr class="msg" id="L124"><td class="ts-cell"><a class="ts" href="#L124" alt="Wed Apr 08 2015 14:23:18 GMT-0700 (Pacific Daylight Time)">21:23</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: what does it mean for a ReadableStream to .pipeTo() a WritableByteStream... what if the RS produces non-byte things?</td></tr>
  <tr class="msg" id="L125"><td class="ts-cell"><a class="ts" href="#L125" alt="Wed Apr 08 2015 14:23:53 GMT-0700 (Pacific Daylight Time)">21:23</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: calling .write() (or the equivalent internal operation if we move to that model) will error, causing the pipe to error.</td></tr>
  <tr class="msg" id="L126"><td class="ts-cell"><a class="ts" href="#L126" alt="Wed Apr 08 2015 14:24:46 GMT-0700 (Pacific Daylight Time)">21:24</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: but if the ReadableStream passes Uint8Array chunks, then its ok?</td></tr>
  <tr class="msg" id="L127"><td class="ts-cell"><a class="ts" href="#L127" alt="Wed Apr 08 2015 14:24:55 GMT-0700 (Pacific Daylight Time)">21:24</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: yes, I would really like that to work</td></tr>
  <tr class="msg" id="L128"><td class="ts-cell"><a class="ts" href="#L128" alt="Wed Apr 08 2015 14:25:09 GMT-0700 (Pacific Daylight Time)">21:25</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: maybe allow any of the &quot;BufferView&quot; types</td></tr>
  <tr class="msg" id="L129"><td class="ts-cell"><a class="ts" href="#L129" alt="Wed Apr 08 2015 14:25:37 GMT-0700 (Pacific Daylight Time)">21:25</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">or just ArrayBuffer, I presume?</td></tr>
  <tr class="msg" id="L130"><td class="ts-cell"><a class="ts" href="#L130" alt="Wed Apr 08 2015 14:28:29 GMT-0700 (Pacific Daylight Time)">21:28</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: right, I forgot what the type was called that is a union of all typed arrays + ArrayBuffer + DataView</td></tr>
  <tr class="msg" id="L131"><td class="ts-cell"><a class="ts" href="#L131" alt="Wed Apr 08 2015 14:28:59 GMT-0700 (Pacific Daylight Time)">21:28</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">&quot;BufferSource&quot; apparently</td></tr>
  <tr class="msg" id="L132"><td class="ts-cell"><a class="ts" href="#L132" alt="Wed Apr 08 2015 14:30:08 GMT-0700 (Pacific Daylight Time)">21:30</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: where is the latest ReadableByteStream proposal?</td></tr>
  <tr class="msg" id="L133"><td class="ts-cell"><a class="ts" href="#L133" alt="Wed Apr 08 2015 14:30:37 GMT-0700 (Pacific Daylight Time)">21:30</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: <a href="https://github.com/whatwg/streams/blob/asyncbytestream/BinaryExtension.md">https://github.com/whatwg/streams/blob/asyncbytestream/BinaryExtension.md</a></td></tr>
  <tr class="msg" id="L134"><td class="ts-cell"><a class="ts" href="#L134" alt="Wed Apr 08 2015 14:32:25 GMT-0700 (Pacific Daylight Time)">21:32</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: so... its starting to feel to me like we should not have a ReadableByteStream at all...  if the underlying source of the stream operates on bytes, then the specialization has already occurred... getReader() can just return a ByobReader</td></tr>
  <tr class="msg" id="L135"><td class="ts-cell"><a class="ts" href="#L135" alt="Wed Apr 08 2015 14:32:30 GMT-0700 (Pacific Daylight Time)">21:32</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">or am I missing something?</td></tr>
  <tr class="msg" id="L136"><td class="ts-cell"><a class="ts" href="#L136" alt="Wed Apr 08 2015 14:32:43 GMT-0700 (Pacific Daylight Time)">21:32</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=TabAtkins@irc>TabAtkins</span>&gt;</td><td class="msg-cell">bring-your-own-beerReader</td></tr>
  <tr class="msg" id="L137"><td class="ts-cell"><a class="ts" href="#L137" alt="Wed Apr 08 2015 14:33:00 GMT-0700 (Pacific Daylight Time)">21:33</a></td><td class="nick-cell"><span class="nick nick-12" title=wanderview@irc>wanderview</span></td><td class="msg-cell">didn&#039;t name it. :-)</td></tr>
  <tr class="msg" id="L138"><td class="ts-cell"><a class="ts" href="#L138" alt="Wed Apr 08 2015 14:33:11 GMT-0700 (Pacific Daylight Time)">21:33</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">ByobByteStreamReader</td></tr>
  <tr class="msg" id="L139"><td class="ts-cell"><a class="ts" href="#L139" alt="Wed Apr 08 2015 14:34:35 GMT-0700 (Pacific Daylight Time)">21:34</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: hmm, but adding the BYOB layer changes things quite a lot, adding complexity specifically for the byte case. You would advocate building that complexity into the readable stream itself?</td></tr>
  <tr class="msg" id="L140"><td class="ts-cell"><a class="ts" href="#L140" alt="Wed Apr 08 2015 14:35:05 GMT-0700 (Pacific Daylight Time)">21:35</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: if a view is not passed to .read()... can it not just do a &quot;get me the next chunk&quot; semantics pretty easily?</td></tr>
  <tr class="msg" id="L141"><td class="ts-cell"><a class="ts" href="#L141" alt="Wed Apr 08 2015 14:35:35 GMT-0700 (Pacific Daylight Time)">21:35</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=trevnorris@irc>trevnorris</span>&gt;</td><td class="msg-cell">Domenic: spec probably can&#039;t define any implementation details, can it?</td></tr>
  <tr class="msg" id="L142"><td class="ts-cell"><a class="ts" href="#L142" alt="Wed Apr 08 2015 14:35:52 GMT-0700 (Pacific Daylight Time)">21:35</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: for example the underlying source needs some kind of hook read(view) -&gt; promise that fills view, and inside the stream/reader mechanisms you need something such that <a href="http://byobReader.read">byobReader.read</a>(view) transfers view to view2 then passes view2 to the read hook on the source</td></tr>
  <tr class="msg" id="L143"><td class="ts-cell"><a class="ts" href="#L143" alt="Wed Apr 08 2015 14:35:58 GMT-0700 (Pacific Daylight Time)">21:35</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">trevnorris: it can define anything observable</td></tr>
  <tr class="msg" id="L144"><td class="ts-cell"><a class="ts" href="#L144" alt="Wed Apr 08 2015 14:36:06 GMT-0700 (Pacific Daylight Time)">21:36</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">trevnorris: including creation APIs</td></tr>
  <tr class="msg" id="L145"><td class="ts-cell"><a class="ts" href="#L145" alt="Wed Apr 08 2015 14:36:27 GMT-0700 (Pacific Daylight Time)">21:36</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: the idea is you should opt in to one mode or the other (BYOB or auto-flowing)</td></tr>
  <tr class="msg" id="L146"><td class="ts-cell"><a class="ts" href="#L146" alt="Wed Apr 08 2015 14:37:08 GMT-0700 (Pacific Daylight Time)">21:37</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: then keep it getByobReader(), but have it reject on streams that don&#039;t have the right underlying source</td></tr>
  <tr class="msg" id="L147"><td class="ts-cell"><a class="ts" href="#L147" alt="Wed Apr 08 2015 14:37:12 GMT-0700 (Pacific Daylight Time)">21:37</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">for example BYOB doesn&#039;t have a high water mark or queue in general (although it does probably keep one around since kernel buffers are finite... unsure if that&#039;s observable to spec or can be part of the underlying source details)</td></tr>
  <tr class="msg" id="L148"><td class="ts-cell"><a class="ts" href="#L148" alt="Wed Apr 08 2015 14:37:35 GMT-0700 (Pacific Daylight Time)">21:37</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: ick, that&#039;s a very bad API. It would be like Node having a tagName that throws an exception when you try to use it on Comment nodes</td></tr>
  <tr class="msg" id="L149"><td class="ts-cell"><a class="ts" href="#L149" alt="Wed Apr 08 2015 14:37:55 GMT-0700 (Pacific Daylight Time)">21:37</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=trevnorris@irc>trevnorris</span>&gt;</td><td class="msg-cell">Domenic: my implementations tie a C++ class to every JS stream, on which a class method can be defined to receive incoming data. .pipe() can detect that and short circuit the JS call by passing from the internal C++ to the implementation defined method.</td></tr>
  <tr class="msg" id="L150"><td class="ts-cell"><a class="ts" href="#L150" alt="Wed Apr 08 2015 14:38:20 GMT-0700 (Pacific Daylight Time)">21:38</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=trevnorris@irc>trevnorris</span>&gt;</td><td class="msg-cell">unfortunately it depends on certain V8-isms that i&#039;m not sure are currently possible in other engines.</td></tr>
  <tr class="msg" id="L151"><td class="ts-cell"><a class="ts" href="#L151" alt="Wed Apr 08 2015 14:38:20 GMT-0700 (Pacific Daylight Time)">21:38</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">trevnorris: right, in that case the spec&#039;s job is to make your short circuit unobservable</td></tr>
  <tr class="msg" id="L152"><td class="ts-cell"><a class="ts" href="#L152" alt="Wed Apr 08 2015 14:38:45 GMT-0700 (Pacific Daylight Time)">21:38</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">trevnorris: and that means completely unobservable, even if someone overwrites dest.write to log when called or similar ;)</td></tr>
  <tr class="msg" id="L153"><td class="ts-cell"><a class="ts" href="#L153" alt="Wed Apr 08 2015 14:38:48 GMT-0700 (Pacific Daylight Time)">21:38</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: what does ReadableByteStream get you beyond the Byob capacility?  It doesn&#039;t seem like anything... so maybe it should be a ByobReadableStream</td></tr>
  <tr class="msg" id="L154"><td class="ts-cell"><a class="ts" href="#L154" alt="Wed Apr 08 2015 14:39:24 GMT-0700 (Pacific Daylight Time)">21:39</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: yes, that is indeed the real delta. We figured it was a more user-friendly name? But no real opposition to renaming it</td></tr>
  <tr class="msg" id="L155"><td class="ts-cell"><a class="ts" href="#L155" alt="Wed Apr 08 2015 14:39:47 GMT-0700 (Pacific Daylight Time)">21:39</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: I guess the problem with that is the producer of the stream does not know if the user wants Byob semantics</td></tr>
  <tr class="msg" id="L156"><td class="ts-cell"><a class="ts" href="#L156" alt="Wed Apr 08 2015 14:39:53 GMT-0700 (Pacific Daylight Time)">21:39</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">Actually we are kind of hoping not to use the term &quot;BYOB&quot; in public API. The fact that&#039;s in tyoshino&#039;s doc is largely just as a placeholder :)</td></tr>
  <tr class="msg" id="L157"><td class="ts-cell"><a class="ts" href="#L157" alt="Wed Apr 08 2015 14:39:58 GMT-0700 (Pacific Daylight Time)">21:39</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">^user^consumer</td></tr>
  <tr class="msg" id="L158"><td class="ts-cell"><a class="ts" href="#L158" alt="Wed Apr 08 2015 14:40:03 GMT-0700 (Pacific Daylight Time)">21:40</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">I know</td></tr>
  <tr class="msg" id="L159"><td class="ts-cell"><a class="ts" href="#L159" alt="Wed Apr 08 2015 14:40:54 GMT-0700 (Pacific Daylight Time)">21:40</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: it just feels the &quot;type&quot; of the stream is determined by the underlying source... and having to have a special shell around particular underlying sources is clumsy... ReadableStream should just enable the extra features if its constructed with a byte oriented underlying source</td></tr>
  <tr class="msg" id="L160"><td class="ts-cell"><a class="ts" href="#L160" alt="Wed Apr 08 2015 14:40:57 GMT-0700 (Pacific Daylight Time)">21:40</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: the hope is that it is efficient for streams like fetch/fs/etc. that are bytes-backed to implement ReadableByteStream, and then consumers who want to opt in to BYOB behavior can use .getByobReader(), and normal people (including those agnostic to the chunk type) can just use .getReader()</td></tr>
  <tr class="msg" id="L161"><td class="ts-cell"><a class="ts" href="#L161" alt="Wed Apr 08 2015 14:41:46 GMT-0700 (Pacific Daylight Time)">21:41</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: I don&#039;t agree with that. The logical conclusion of that argument is that streams should be able to bake me a cake if I give them the right underlying source.</td></tr>
  <tr class="msg" id="L162"><td class="ts-cell"><a class="ts" href="#L162" alt="Wed Apr 08 2015 14:42:05 GMT-0700 (Pacific Daylight Time)">21:42</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">Adding fundamentally new capabilities, instead of just different behavior, should require a new type.</td></tr>
  <tr class="msg" id="L163"><td class="ts-cell"><a class="ts" href="#L163" alt="Wed Apr 08 2015 14:42:16 GMT-0700 (Pacific Daylight Time)">21:42</a></td><td class="nick-cell"><span class="nick nick-12" title=wanderview@irc>wanderview</span></td><td class="msg-cell">likes cake.</td></tr>
  <tr class="msg" id="L164"><td class="ts-cell"><a class="ts" href="#L164" alt="Wed Apr 08 2015 14:42:51 GMT-0700 (Pacific Daylight Time)">21:42</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: what do you anticipate being different about a WritableByteStream?</td></tr>
  <tr class="msg" id="L165"><td class="ts-cell"><a class="ts" href="#L165" alt="Wed Apr 08 2015 14:43:16 GMT-0700 (Pacific Daylight Time)">21:43</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: hazy right now, but one big thing is it will need to detach any passed-in buffers since they might be sent off thread</td></tr>
  <tr class="msg" id="L166"><td class="ts-cell"><a class="ts" href="#L166" alt="Wed Apr 08 2015 14:44:14 GMT-0700 (Pacific Daylight Time)">21:44</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: that... seems hard without including it in the WritableStream contract</td></tr>
  <tr class="msg" id="L167"><td class="ts-cell"><a class="ts" href="#L167" alt="Wed Apr 08 2015 14:44:46 GMT-0700 (Pacific Daylight Time)">21:44</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">hmm how so?</td></tr>
  <tr class="msg" id="L168"><td class="ts-cell"><a class="ts" href="#L168" alt="Wed Apr 08 2015 14:45:00 GMT-0700 (Pacific Daylight Time)">21:45</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: isn&#039;t that an optimizaiton that should be negotiated by native underlying source to native underlying sink?</td></tr>
  <tr class="msg" id="L169"><td class="ts-cell"><a class="ts" href="#L169" alt="Wed Apr 08 2015 14:45:44 GMT-0700 (Pacific Daylight Time)">21:45</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: I am talking about var a = new Uint8Array([5, 10, 15, 20]); fileStream.write(a)</td></tr>
  <tr class="msg" id="L170"><td class="ts-cell"><a class="ts" href="#L170" alt="Wed Apr 08 2015 14:46:01 GMT-0700 (Pacific Daylight Time)">21:46</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">I want to send the backing memory of a off into the thread that does file I/O</td></tr>
  <tr class="msg" id="L171"><td class="ts-cell"><a class="ts" href="#L171" alt="Wed Apr 08 2015 14:46:42 GMT-0700 (Pacific Daylight Time)">21:46</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">and I am pretty sure we don&#039;t want to let people do a[0] = 7 and have that mutate the memory, maybe before the write, maybe after the write</td></tr>
  <tr class="msg" id="L172"><td class="ts-cell"><a class="ts" href="#L172" alt="Wed Apr 08 2015 14:46:48 GMT-0700 (Pacific Daylight Time)">21:46</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: you&#039;re talking about effectively making the chunk disappear from content... if under normal circumstances I can do ws.write(chunk); muchAroundWithChunk(chunk); ... how will code based just on WritableStream know that .write() suddently doesn&#039;t work that way because it has a WBS?</td></tr>
  <tr class="msg" id="L173"><td class="ts-cell"><a class="ts" href="#L173" alt="Wed Apr 08 2015 14:47:41 GMT-0700 (Pacific Daylight Time)">21:47</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: I guess I&#039;m saying WritableStream.write() contract should say &quot;don&#039;t expect the chunk to exist in its current form after this call&quot;  regardless of WritableStream vs WritableByteStream</td></tr>
  <tr class="msg" id="L174"><td class="ts-cell"><a class="ts" href="#L174" alt="Wed Apr 08 2015 14:47:46 GMT-0700 (Pacific Daylight Time)">21:47</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: that&#039;s fair, although I&#039;m not sure in practice how worried we should be. But one easy fix is to add .getTransferringWriter() or similar, whereas .getWriter() does copies?? I dunno.</td></tr>
  <tr class="msg" id="L175"><td class="ts-cell"><a class="ts" href="#L175" alt="Wed Apr 08 2015 14:48:06 GMT-0700 (Pacific Daylight Time)">21:48</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: I just have no idea how to enforce that contract</td></tr>
  <tr class="msg" id="L176"><td class="ts-cell"><a class="ts" href="#L176" alt="Wed Apr 08 2015 14:48:26 GMT-0700 (Pacific Daylight Time)">21:48</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">if it&#039;s not true for most writable streams, then people might assume it, no matter if the spec has some kind of &quot;don&#039;t assume this please&quot; note.</td></tr>
  <tr class="msg" id="L177"><td class="ts-cell"><a class="ts" href="#L177" alt="Wed Apr 08 2015 14:48:27 GMT-0700 (Pacific Daylight Time)">21:48</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: maybe its not enforceable... but we can at least say &quot;told you so&quot; when people&#039; stuff breaks :-)</td></tr>
  <tr class="msg" id="L178"><td class="ts-cell"><a class="ts" href="#L178" alt="Wed Apr 08 2015 14:48:34 GMT-0700 (Pacific Daylight Time)">21:48</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">heh, ok</td></tr>
  <tr class="msg" id="L179"><td class="ts-cell"><a class="ts" href="#L179" alt="Wed Apr 08 2015 14:49:13 GMT-0700 (Pacific Daylight Time)">21:49</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: it just seems stuff like ByobReader and maybe this TransferringWriter are opportunistic things... optimize in this fashion if its available... otherwise use the lesser stuff</td></tr>
  <tr class="msg" id="L180"><td class="ts-cell"><a class="ts" href="#L180" alt="Wed Apr 08 2015 14:49:48 GMT-0700 (Pacific Daylight Time)">21:49</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: and I guess in your mind the right way to &quot;check if its available&quot; is to do an instanceof on the prototype?</td></tr>
  <tr class="msg" id="L181"><td class="ts-cell"><a class="ts" href="#L181" alt="Wed Apr 08 2015 14:50:09 GMT-0700 (Pacific Daylight Time)">21:50</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: I don&#039;t see how to make ByobReader opportunistic. E.g. no way to do <a href="https://gist.github.com/domenic/65921459ef7a31ec2839#reading-a-file-chunkwise">https://gist.github.com/domenic/65921459ef7a31ec2839#reading-a-file-chunkwise</a> (old API I think) without explicitly doing things with JS</td></tr>
  <tr class="msg" id="L182"><td class="ts-cell"><a class="ts" href="#L182" alt="Wed Apr 08 2015 14:50:20 GMT-0700 (Pacific Daylight Time)">21:50</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: check if what is available?</td></tr>
  <tr class="msg" id="L183"><td class="ts-cell"><a class="ts" href="#L183" alt="Wed Apr 08 2015 14:50:34 GMT-0700 (Pacific Daylight Time)">21:50</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: check if ByobReader is available on a RS, for example</td></tr>
  <tr class="msg" id="L184"><td class="ts-cell"><a class="ts" href="#L184" alt="Wed Apr 08 2015 14:50:48 GMT-0700 (Pacific Daylight Time)">21:50</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: if (rs.getByobReader) { ... }</td></tr>
  <tr class="msg" id="L185"><td class="ts-cell"><a class="ts" href="#L185" alt="Wed Apr 08 2015 14:52:35 GMT-0700 (Pacific Daylight Time)">21:52</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: can&#039;t see much difference between that and getByobReader() returning null if its not supported</td></tr>
  <tr class="msg" id="L186"><td class="ts-cell"><a class="ts" href="#L186" alt="Wed Apr 08 2015 14:53:08 GMT-0700 (Pacific Daylight Time)">21:53</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: it&#039;s just basic API design... we don&#039;t add everything onto a single object. New classes of objects get ... new classes.</td></tr>
  <tr class="msg" id="L187"><td class="ts-cell"><a class="ts" href="#L187" alt="Wed Apr 08 2015 14:53:16 GMT-0700 (Pacific Daylight Time)">21:53</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">Node vs. Element, etc.</td></tr>
  <tr class="msg" id="L188"><td class="ts-cell"><a class="ts" href="#L188" alt="Wed Apr 08 2015 14:53:39 GMT-0700 (Pacific Daylight Time)">21:53</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: I think I dislike mixing that with the revealing constructor pattern... the constructor is not revealing all the behavior</td></tr>
  <tr class="msg" id="L189"><td class="ts-cell"><a class="ts" href="#L189" alt="Wed Apr 08 2015 14:53:59 GMT-0700 (Pacific Daylight Time)">21:53</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: if we had a revealing factory method that could construct the right type... it might seem a bit better to me</td></tr>
  <tr class="msg" id="L190"><td class="ts-cell"><a class="ts" href="#L190" alt="Wed Apr 08 2015 14:54:36 GMT-0700 (Pacific Daylight Time)">21:54</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: I don&#039;t see how they&#039;re related. Revealing constructor pattern lets you customize a type&#039;s behavior. You can have different revealing constructors for different types. We don&#039;t use the same type for Promise and ReadableStream, even though they both have customizable behavior via the revealing constructor pattern.</td></tr>
  <tr class="msg" id="L191"><td class="ts-cell"><a class="ts" href="#L191" alt="Wed Apr 08 2015 14:54:50 GMT-0700 (Pacific Daylight Time)">21:54</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">why would you say the constructor is not revealing all the behavior?</td></tr>
  <tr class="msg" id="L192"><td class="ts-cell"><a class="ts" href="#L192" alt="Wed Apr 08 2015 14:55:39 GMT-0700 (Pacific Daylight Time)">21:55</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: why would you ever do new ReadableStream(myByteSource)?  shouldn&#039;t you *always* do new ReadableByteStream(myByteSource)?</td></tr>
  <tr class="msg" id="L193"><td class="ts-cell"><a class="ts" href="#L193" alt="Wed Apr 08 2015 14:55:49 GMT-0700 (Pacific Daylight Time)">21:55</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: yes?</td></tr>
  <tr class="msg" id="L194"><td class="ts-cell"><a class="ts" href="#L194" alt="Wed Apr 08 2015 14:56:00 GMT-0700 (Pacific Daylight Time)">21:56</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">did i say otherwise?</td></tr>
  <tr class="msg" id="L195"><td class="ts-cell"><a class="ts" href="#L195" alt="Wed Apr 08 2015 14:56:15 GMT-0700 (Pacific Daylight Time)">21:56</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: no... but it feels weird to leave that as a footgun for people</td></tr>
  <tr class="msg" id="L196"><td class="ts-cell"><a class="ts" href="#L196" alt="Wed Apr 08 2015 14:56:30 GMT-0700 (Pacific Daylight Time)">21:56</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">it&#039;s the same footgun as new Promise(myByteSource) ... not really worried.</td></tr>
  <tr class="msg" id="L197"><td class="ts-cell"><a class="ts" href="#L197" alt="Wed Apr 08 2015 14:56:39 GMT-0700 (Pacific Daylight Time)">21:56</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">the type is really associated with the source, not the wrapper object</td></tr>
  <tr class="msg" id="L198"><td class="ts-cell"><a class="ts" href="#L198" alt="Wed Apr 08 2015 14:56:47 GMT-0700 (Pacific Daylight Time)">21:56</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">or new WritableStream(myByteSource)</td></tr>
  <tr class="msg" id="L199"><td class="ts-cell"><a class="ts" href="#L199" alt="Wed Apr 08 2015 14:57:06 GMT-0700 (Pacific Daylight Time)">21:57</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: except those will fail... ReadableStream(myByteSource) will work, but just prevent consumers from optimizing</td></tr>
  <tr class="msg" id="L200"><td class="ts-cell"><a class="ts" href="#L200" alt="Wed Apr 08 2015 14:57:10 GMT-0700 (Pacific Daylight Time)">21:57</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">The source is an adapter between the conceptual source and the concrete readable stream type</td></tr>
  <tr class="msg" id="L201"><td class="ts-cell"><a class="ts" href="#L201" alt="Wed Apr 08 2015 14:57:18 GMT-0700 (Pacific Daylight Time)">21:57</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: why would it work?</td></tr>
  <tr class="msg" id="L202"><td class="ts-cell"><a class="ts" href="#L202" alt="Wed Apr 08 2015 14:58:24 GMT-0700 (Pacific Daylight Time)">21:58</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: err... from what I can tell new ReadableStream() and new ReadableByteStream() expect the same properties on the passed duck typed source?</td></tr>
  <tr class="msg" id="L203"><td class="ts-cell"><a class="ts" href="#L203" alt="Wed Apr 08 2015 14:58:31 GMT-0700 (Pacific Daylight Time)">21:58</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">is that not true?</td></tr>
  <tr class="msg" id="L204"><td class="ts-cell"><a class="ts" href="#L204" alt="Wed Apr 08 2015 14:58:49 GMT-0700 (Pacific Daylight Time)">21:58</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: the argument for ReadableByteStream() is not specced at all yet :)</td></tr>
  <tr class="msg" id="L205"><td class="ts-cell"><a class="ts" href="#L205" alt="Wed Apr 08 2015 14:59:14 GMT-0700 (Pacific Daylight Time)">21:59</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: it will probably be something like { start() { }, read(view), cancel(reason) { } }</td></tr>
  <tr class="msg" id="L206"><td class="ts-cell"><a class="ts" href="#L206" alt="Wed Apr 08 2015 15:00:44 GMT-0700 (Pacific Daylight Time)">22:00</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">ok</td></tr>
  <tr class="msg" id="L207"><td class="ts-cell"><a class="ts" href="#L207" alt="Wed Apr 08 2015 15:01:55 GMT-0700 (Pacific Daylight Time)">22:01</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: going back to WritableByteStream... one optimization we have in our native streams is the writing side can pass its destination back into the person doing the write... so in theory this could be passed back to read(view) or something to all a ReadableByteStream to write directly into a WritableByteStream</td></tr>
  <tr class="msg" id="L208"><td class="ts-cell"><a class="ts" href="#L208" alt="Wed Apr 08 2015 15:02:42 GMT-0700 (Pacific Daylight Time)">22:02</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: good point, i forgot that was also something we definitely want out of ReadableByteStream + WritableByteStream pipes</td></tr>
  <tr class="msg" id="L209"><td class="ts-cell"><a class="ts" href="#L209" alt="Wed Apr 08 2015 15:03:48 GMT-0700 (Pacific Daylight Time)">22:03</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">they can set up a small buffer pool and reuse buffers to limit total consumption and GC churn ... it will work beautifully ... /me waves his hands</td></tr>
  <tr class="msg" id="L210"><td class="ts-cell"><a class="ts" href="#L210" alt="Wed Apr 08 2015 15:15:50 GMT-0700 (Pacific Daylight Time)">22:15</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: sorry... I&#039;m used to the DOM stuff which just enforces types and then says &quot;using X&#039;s internal thing, do stuff&quot;</td></tr>
  <tr class="msg" id="L211"><td class="ts-cell"><a class="ts" href="#L211" alt="Wed Apr 08 2015 15:17:53 GMT-0700 (Pacific Daylight Time)">22:17</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: np, just concerned about the layering in the design. Ideally *ByteStream should be additive and opt-in, both for consumers and from an architectural level.</td></tr>
  <tr class="msg" id="L212"><td class="ts-cell"><a class="ts" href="#L212" alt="Wed Apr 08 2015 15:20:08 GMT-0700 (Pacific Daylight Time)">22:20</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: to be honest, things like off-main-thread piping are mostly interesting to me for *ByteStream... for streams with potentially arbitrary js objects for chunks... not sure I can safely move those around off-thread</td></tr>
  <tr class="msg" id="L213"><td class="ts-cell"><a class="ts" href="#L213" alt="Wed Apr 08 2015 15:20:18 GMT-0700 (Pacific Daylight Time)">22:20</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">not sure if that changes anything</td></tr>
  <tr class="msg" id="L214"><td class="ts-cell"><a class="ts" href="#L214" alt="Wed Apr 08 2015 15:20:38 GMT-0700 (Pacific Daylight Time)">22:20</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: oh, no, I was never really planning on them being off thread... but i want the model to not change drastically when you move from non-byte to byte streams</td></tr>
  <tr class="msg" id="L215"><td class="ts-cell"><a class="ts" href="#L215" alt="Wed Apr 08 2015 15:21:21 GMT-0700 (Pacific Daylight Time)">22:21</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: although I guess it could be pretty useful in some cases e.g. if a UA provided stream wants to pass metadata with each chunk like { remotePort, remoteAddress, data } or something instead of just data</td></tr>
  <tr class="msg" id="L216"><td class="ts-cell"><a class="ts" href="#L216" alt="Wed Apr 08 2015 15:22:23 GMT-0700 (Pacific Daylight Time)">22:22</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: I built a bunch of node stream libs to do that kind of thing before... not sure anyone really liked it much</td></tr>
  <tr class="msg" id="L217"><td class="ts-cell"><a class="ts" href="#L217" alt="Wed Apr 08 2015 15:22:53 GMT-0700 (Pacific Daylight Time)">22:22</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell"><a href="https://blog.wanderview.com/blog/2013/03/01/composable-object-streams/">https://blog.wanderview.com/blog/2013/03/01/composable-object-streams/</a></td></tr>
  <tr class="msg" id="L218"><td class="ts-cell"><a class="ts" href="#L218" alt="Wed Apr 08 2015 15:23:33 GMT-0700 (Pacific Daylight Time)">22:23</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: do you have a summary of where we are on <a href="https://github.com/yutakahirano/fetch-with-streams/issues/30">https://github.com/yutakahirano/fetch-with-streams/issues/30</a> ? when i went to bed last night i think we were convering on new Request({ body: readableStream }) + fetch(request, wsRevealer) + cache.add(request, wsRevealer) or similar. But then it changed overnight and now I am confused.</td></tr>
  <tr class="msg" id="L219"><td class="ts-cell"><a class="ts" href="#L219" alt="Wed Apr 08 2015 15:24:08 GMT-0700 (Pacific Daylight Time)">22:24</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: I think DOM APIs would prefer to return a structured webidl object with a stream property (like Response)</td></tr>
  <tr class="msg" id="L220"><td class="ts-cell"><a class="ts" href="#L220" alt="Wed Apr 08 2015 15:24:29 GMT-0700 (Pacific Daylight Time)">22:24</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">?</td></tr>
  <tr class="msg" id="L221"><td class="ts-cell"><a class="ts" href="#L221" alt="Wed Apr 08 2015 15:24:52 GMT-0700 (Pacific Daylight Time)">22:24</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: I objected to putting wsRevealer on the consumer... because Request is no longer representative of the network request</td></tr>
  <tr class="msg" id="L222"><td class="ts-cell"><a class="ts" href="#L222" alt="Wed Apr 08 2015 15:24:54 GMT-0700 (Pacific Daylight Time)">22:24</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">(I like the UDP object streams BTW!)</td></tr>
  <tr class="msg" id="L223"><td class="ts-cell"><a class="ts" href="#L223" alt="Wed Apr 08 2015 15:25:05 GMT-0700 (Pacific Daylight Time)">22:25</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">Hmm was it ever?</td></tr>
  <tr class="msg" id="L224"><td class="ts-cell"><a class="ts" href="#L224" alt="Wed Apr 08 2015 15:25:26 GMT-0700 (Pacific Daylight Time)">22:25</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">Isn&#039;t Request more like RequestMetadata?</td></tr>
  <tr class="msg" id="L225"><td class="ts-cell"><a class="ts" href="#L225" alt="Wed Apr 08 2015 15:25:50 GMT-0700 (Pacific Daylight Time)">22:25</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: no... before streams came into it, it contained all info to perform a network request</td></tr>
  <tr class="msg" id="L226"><td class="ts-cell"><a class="ts" href="#L226" alt="Wed Apr 08 2015 15:25:52 GMT-0700 (Pacific Daylight Time)">22:25</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">including the body</td></tr>
  <tr class="msg" id="L227"><td class="ts-cell"><a class="ts" href="#L227" alt="Wed Apr 08 2015 15:26:04 GMT-0700 (Pacific Daylight Time)">22:26</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">right, info to perform a network request, but not a network request itself....</td></tr>
  <tr class="msg" id="L228"><td class="ts-cell"><a class="ts" href="#L228" alt="Wed Apr 08 2015 15:26:40 GMT-0700 (Pacific Daylight Time)">22:26</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">which is why you can store it in a cache; you can&#039;t store a network request in a cache...</td></tr>
  <tr class="msg" id="L229"><td class="ts-cell"><a class="ts" href="#L229" alt="Wed Apr 08 2015 15:27:14 GMT-0700 (Pacific Daylight Time)">22:27</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: correct... it is a representation of a possible network request... it is not an actual in progress network request... but if you move the body ws-revealer to fetch() then Request no longer fully describes the possible network request</td></tr>
  <tr class="msg" id="L230"><td class="ts-cell"><a class="ts" href="#L230" alt="Wed Apr 08 2015 15:27:24 GMT-0700 (Pacific Daylight Time)">22:27</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">hmmm</td></tr>
  <tr class="msg" id="L231"><td class="ts-cell"><a class="ts" href="#L231" alt="Wed Apr 08 2015 15:27:33 GMT-0700 (Pacific Daylight Time)">22:27</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">i guess that&#039;s true</td></tr>
  <tr class="msg" id="L232"><td class="ts-cell"><a class="ts" href="#L232" alt="Wed Apr 08 2015 15:27:55 GMT-0700 (Pacific Daylight Time)">22:27</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">and ws-revealer is really &quot;a sequence of instructions for how to create a body&quot; so it still goes in the category of &quot;representation of a possible network request&quot;</td></tr>
  <tr class="msg" id="L233"><td class="ts-cell"><a class="ts" href="#L233" alt="Wed Apr 08 2015 15:27:58 GMT-0700 (Pacific Daylight Time)">22:27</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: look at my last proposal... it combines your WritableStream wrapper without the hard coded type switch</td></tr>
  <tr class="msg" id="L234"><td class="ts-cell"><a class="ts" href="#L234" alt="Wed Apr 08 2015 15:28:12 GMT-0700 (Pacific Daylight Time)">22:28</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">Although I doubt you&#039;ll store the ws-revealer in the cache...</td></tr>
  <tr class="msg" id="L235"><td class="ts-cell"><a class="ts" href="#L235" alt="Wed Apr 08 2015 15:28:39 GMT-0700 (Pacific Daylight Time)">22:28</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">Yeah, I liked that, although unsure how it fits with the rest of the discussion up until that point</td></tr>
  <tr class="msg" id="L236"><td class="ts-cell"><a class="ts" href="#L236" alt="Wed Apr 08 2015 15:28:41 GMT-0700 (Pacific Daylight Time)">22:28</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: well, right now Cache only supports GET... so can&#039;t put a body in... but if you could, Cache would trigger ws-revealer to get the body data</td></tr>
  <tr class="msg" id="L237"><td class="ts-cell"><a class="ts" href="#L237" alt="Wed Apr 08 2015 15:29:00 GMT-0700 (Pacific Daylight Time)">22:29</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">I still have all the code in gecko to store Request bodies</td></tr>
  <tr class="msg" id="L238"><td class="ts-cell"><a class="ts" href="#L238" alt="Wed Apr 08 2015 15:29:15 GMT-0700 (Pacific Daylight Time)">22:29</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">hmm i see</td></tr>
  <tr class="msg" id="L239"><td class="ts-cell"><a class="ts" href="#L239" alt="Wed Apr 08 2015 15:29:24 GMT-0700 (Pacific Daylight Time)">22:29</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">yeah i guess that makes sense</td></tr>
  <tr class="msg" id="L240"><td class="ts-cell"><a class="ts" href="#L240" alt="Wed Apr 08 2015 15:29:43 GMT-0700 (Pacific Daylight Time)">22:29</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">you reify the body whenever the request gets &quot;committed&quot; somewhere</td></tr>
  <tr class="msg" id="L241"><td class="ts-cell"><a class="ts" href="#L241" alt="Wed Apr 08 2015 15:30:05 GMT-0700 (Pacific Daylight Time)">22:30</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">those are fancy words, but I will nod my head</td></tr>
  <tr class="msg" id="L242"><td class="ts-cell"><a class="ts" href="#L242" alt="Wed Apr 08 2015 15:30:16 GMT-0700 (Pacific Daylight Time)">22:30</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">:P</td></tr>
  <tr class="msg" id="L243"><td class="ts-cell"><a class="ts" href="#L243" alt="Wed Apr 08 2015 15:30:24 GMT-0700 (Pacific Daylight Time)">22:30</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">does reify just mean normalize?</td></tr>
  <tr class="msg" id="L244"><td class="ts-cell"><a class="ts" href="#L244" alt="Wed Apr 08 2015 15:30:47 GMT-0700 (Pacific Daylight Time)">22:30</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">nah ... i&#039;m thinking of it as, make a real set of bytes out of a function that represents a way to get bytes</td></tr>
  <tr class="msg" id="L245"><td class="ts-cell"><a class="ts" href="#L245" alt="Wed Apr 08 2015 15:31:06 GMT-0700 (Pacific Daylight Time)">22:31</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">ah, ok... serialize then</td></tr>
  <tr class="msg" id="L246"><td class="ts-cell"><a class="ts" href="#L246" alt="Wed Apr 08 2015 15:31:06 GMT-0700 (Pacific Daylight Time)">22:31</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">ws-revealer is a &quot;potential body&quot; that gets reified into a real body when you fetch/cache-add</td></tr>
  <tr class="msg" id="L247"><td class="ts-cell"><a class="ts" href="#L247" alt="Wed Apr 08 2015 15:31:12 GMT-0700 (Pacific Daylight Time)">22:31</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">yeah that i guess</td></tr>
  <tr class="msg" id="L248"><td class="ts-cell"><a class="ts" href="#L248" alt="Wed Apr 08 2015 15:31:32 GMT-0700 (Pacific Daylight Time)">22:31</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">I should look up that term I guess</td></tr>
  <tr class="msg" id="L249"><td class="ts-cell"><a class="ts" href="#L249" alt="Wed Apr 08 2015 15:31:52 GMT-0700 (Pacific Daylight Time)">22:31</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">I have more of an EE background so I tend to get lost in the CS theory world</td></tr>
  <tr class="msg" id="L250"><td class="ts-cell"><a class="ts" href="#L250" alt="Wed Apr 08 2015 15:32:13 GMT-0700 (Pacific Daylight Time)">22:32</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">might be a mathematician thing, I dunno. Or just a pretentious thing :P</td></tr>
  <tr class="msg" id="L251"><td class="ts-cell"><a class="ts" href="#L251" alt="Wed Apr 08 2015 15:32:55 GMT-0700 (Pacific Daylight Time)">22:32</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">so the current proposal is req.{setWriter/pipeTo} plus ... body(ws) { ... } which gets triggered after setWriter/pipeTo plus ... do we allow body: readableStream?</td></tr>
  <tr class="msg" id="L252"><td class="ts-cell"><a class="ts" href="#L252" alt="Wed Apr 08 2015 15:33:27 GMT-0700 (Pacific Daylight Time)">22:33</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: I still want body: readableStream, yes</td></tr>
  <tr class="msg" id="L253"><td class="ts-cell"><a class="ts" href="#L253" alt="Wed Apr 08 2015 15:33:37 GMT-0700 (Pacific Daylight Time)">22:33</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">poor overloaded body: option</td></tr>
  <tr class="msg" id="L254"><td class="ts-cell"><a class="ts" href="#L254" alt="Wed Apr 08 2015 15:34:19 GMT-0700 (Pacific Daylight Time)">22:34</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: didn&#039;t you hear?  fetch is mostly about sugar :-)</td></tr>
  <tr class="msg" id="L255"><td class="ts-cell"><a class="ts" href="#L255" alt="Wed Apr 08 2015 15:35:47 GMT-0700 (Pacific Daylight Time)">22:35</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: and to be clear... I only think we need this ws-revealer thing because of the desire to have progress notification that a pipe would obfuscate</td></tr>
  <tr class="msg" id="L256"><td class="ts-cell"><a class="ts" href="#L256" alt="Wed Apr 08 2015 15:37:37 GMT-0700 (Pacific Daylight Time)">22:37</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: btw... resolving the .write() promises when written to the kernel is going to be somewhat challenging... in gecko we get notification from the network code about progress in a different path from where we write... so we have to match that progress back up to the promises to resolve, etc</td></tr>
  <tr class="msg" id="L257"><td class="ts-cell"><a class="ts" href="#L257" alt="Wed Apr 08 2015 15:37:46 GMT-0700 (Pacific Daylight Time)">22:37</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">maybe not challenging... but annoying</td></tr>
  <tr class="msg" id="L258"><td class="ts-cell"><a class="ts" href="#L258" alt="Wed Apr 08 2015 15:39:06 GMT-0700 (Pacific Daylight Time)">22:39</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">:-S</td></tr>
  <tr class="msg" id="L259"><td class="ts-cell"><a class="ts" href="#L259" alt="Wed Apr 08 2015 15:39:31 GMT-0700 (Pacific Daylight Time)">22:39</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">much easier to integrate that with a progress event (which is what it was designed for, of course)</td></tr>
  <tr class="msg" id="L260"><td class="ts-cell"><a class="ts" href="#L260" alt="Wed Apr 08 2015 15:39:31 GMT-0700 (Pacific Daylight Time)">22:39</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">Well, there&#039;s <a href="https://github.com/whatwg/streams/issues/316">https://github.com/whatwg/streams/issues/316</a> ...</td></tr>
  <tr class="msg" id="L261"><td class="ts-cell"><a class="ts" href="#L261" alt="Wed Apr 08 2015 15:39:56 GMT-0700 (Pacific Daylight Time)">22:39</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=trevnorris@irc>trevnorris</span>&gt;</td><td class="msg-cell">wanderview: doubt this&#039;ll have any affect on the spec here, but in previous implementations I&#039;ve had calls like .write() return a request object so you can trace the status at any point in the future.</td></tr>
  <tr class="msg" id="L262"><td class="ts-cell"><a class="ts" href="#L262" alt="Wed Apr 08 2015 15:40:08 GMT-0700 (Pacific Daylight Time)">22:40</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=trevnorris@irc>trevnorris</span>&gt;</td><td class="msg-cell">e.g. .progress() to see how much has been written.</td></tr>
  <tr class="msg" id="L263"><td class="ts-cell"><a class="ts" href="#L263" alt="Wed Apr 08 2015 15:40:21 GMT-0700 (Pacific Daylight Time)">22:40</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=trevnorris@irc>trevnorris</span>&gt;</td><td class="msg-cell">I use that in conjunction with timeouts to cancel writes that are taking too long.</td></tr>
  <tr class="msg" id="L264"><td class="ts-cell"><a class="ts" href="#L264" alt="Wed Apr 08 2015 15:40:41 GMT-0700 (Pacific Daylight Time)">22:40</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: for example, I think gecko network code throttles progress notifications to once every 50ms or something... so you will see batches of .write() promises resolves at the same time, etc.</td></tr>
  <tr class="msg" id="L265"><td class="ts-cell"><a class="ts" href="#L265" alt="Wed Apr 08 2015 15:41:20 GMT-0700 (Pacific Daylight Time)">22:41</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">trevnorris: sounds like you want cancellable promises :-)</td></tr>
  <tr class="msg" id="L266"><td class="ts-cell"><a class="ts" href="#L266" alt="Wed Apr 08 2015 15:41:29 GMT-0700 (Pacific Daylight Time)">22:41</a></td><td class="nick-cell"><span class="nick nick-12" title=wanderview@irc>wanderview</span></td><td class="msg-cell">trolls</td></tr>
  <tr class="msg" id="L267"><td class="ts-cell"><a class="ts" href="#L267" alt="Wed Apr 08 2015 15:41:36 GMT-0700 (Pacific Daylight Time)">22:41</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">wanderview: lol, because the spec says 50 ms, good times :P</td></tr>
  <tr class="msg" id="L268"><td class="ts-cell"><a class="ts" href="#L268" alt="Wed Apr 08 2015 15:41:41 GMT-0700 (Pacific Daylight Time)">22:41</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=trevnorris@irc>trevnorris</span>&gt;</td><td class="msg-cell">hehe. ;)</td></tr>
  <tr class="msg" id="L269"><td class="ts-cell"><a class="ts" href="#L269" alt="Wed Apr 08 2015 15:45:51 GMT-0700 (Pacific Daylight Time)">22:45</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=trevnorris@irc>trevnorris</span>&gt;</td><td class="msg-cell">wanderview: is it possible to do something like: var req = ws.write(data); setTimeout(function(req) { if (req.status() != &#039;complete&#039;) req.abort(); }, 1000); ?</td></tr>
  <tr class="msg" id="L270"><td class="ts-cell"><a class="ts" href="#L270" alt="Wed Apr 08 2015 15:47:04 GMT-0700 (Pacific Daylight Time)">22:47</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">trevnorris: I think you would have to call ws.abort() instead of req.abort()</td></tr>
  <tr class="msg" id="L271"><td class="ts-cell"><a class="ts" href="#L271" alt="Wed Apr 08 2015 15:47:31 GMT-0700 (Pacific Daylight Time)">22:47</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=trevnorris@irc>trevnorris</span>&gt;</td><td class="msg-cell">wanderview: what if you did ws.write(data1) ws.write(data2) and I only wanted to abort writing data1?</td></tr>
  <tr class="msg" id="L272"><td class="ts-cell"><a class="ts" href="#L272" alt="Wed Apr 08 2015 15:47:36 GMT-0700 (Pacific Daylight Time)">22:47</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">with cancelable promises you could do `var p = ws.write(data); setTimeout(() =&gt; p.cancel(), 1000). (Assuming calling p.cancel() does nothing on an already-settled promise)</td></tr>
  <tr class="msg" id="L273"><td class="ts-cell"><a class="ts" href="#L273" alt="Wed Apr 08 2015 15:48:15 GMT-0700 (Pacific Daylight Time)">22:48</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=trevnorris@irc>trevnorris</span>&gt;</td><td class="msg-cell">already-settled promise?</td></tr>
  <tr class="msg" id="L274"><td class="ts-cell"><a class="ts" href="#L274" alt="Wed Apr 08 2015 15:48:47 GMT-0700 (Pacific Daylight Time)">22:48</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">trevnorris: that seems racy to me... you may end up with data1 and data2 or just data2... also, not all write operations are abortable once they start, etc</td></tr>
  <tr class="msg" id="L275"><td class="ts-cell"><a class="ts" href="#L275" alt="Wed Apr 08 2015 15:48:49 GMT-0700 (Pacific Daylight Time)">22:48</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">already fulfilled or rejected</td></tr>
  <tr class="msg" id="L276"><td class="ts-cell"><a class="ts" href="#L276" alt="Wed Apr 08 2015 15:49:08 GMT-0700 (Pacific Daylight Time)">22:49</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">yeah, how does that work in POSIX?</td></tr>
  <tr class="msg" id="L277"><td class="ts-cell"><a class="ts" href="#L277" alt="Wed Apr 08 2015 15:49:32 GMT-0700 (Pacific Daylight Time)">22:49</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=trevnorris@irc>trevnorris</span>&gt;</td><td class="msg-cell">wanderview: if you&#039;ve queued up several chunks of data to be written, and only the first has actually been sent to the kernel it should be possible to remove any specific write req from the queue.</td></tr>
  <tr class="msg" id="L278"><td class="ts-cell"><a class="ts" href="#L278" alt="Wed Apr 08 2015 15:50:03 GMT-0700 (Pacific Daylight Time)">22:50</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">trevnorris: in a multi-threaded environment... it may have been sent to the kernel and you just haven&#039;t been notified of it yet</td></tr>
  <tr class="msg" id="L279"><td class="ts-cell"><a class="ts" href="#L279" alt="Wed Apr 08 2015 15:50:16 GMT-0700 (Pacific Daylight Time)">22:50</a></td><td class="nick-cell">&lt;<span class="nick nick-14" title=boogyman@irc>boogyman</span>&gt;</td><td class="msg-cell">can you elaborate on a scenario where a Promise could be resolved while a &quot;child&quot; Promise has yet to resolve?</td></tr>
  <tr class="msg" id="L280"><td class="ts-cell"><a class="ts" href="#L280" alt="Wed Apr 08 2015 15:50:18 GMT-0700 (Pacific Daylight Time)">22:50</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title=bradleymeck@irc>bradleymeck</span>&gt;</td><td class="msg-cell">its important to remember cancellation does not mean abrupt termination</td></tr>
  <tr class="msg" id="L281"><td class="ts-cell"><a class="ts" href="#L281" alt="Wed Apr 08 2015 15:50:24 GMT-0700 (Pacific Daylight Time)">22:50</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title=bradleymeck@irc>bradleymeck</span>&gt;</td><td class="msg-cell">just that it should cancel at the next point</td></tr>
  <tr class="msg" id="L282"><td class="ts-cell"><a class="ts" href="#L282" alt="Wed Apr 08 2015 15:50:44 GMT-0700 (Pacific Daylight Time)">22:50</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">boogyman: what is a child promise</td></tr>
  <tr class="msg" id="L283"><td class="ts-cell"><a class="ts" href="#L283" alt="Wed Apr 08 2015 15:50:47 GMT-0700 (Pacific Daylight Time)">22:50</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=trevnorris@irc>trevnorris</span>&gt;</td><td class="msg-cell">wanderview: as soon as the data is handed off to something else I&#039;ll consider it unreachable. in the case of Node I know because we make the call to uv_write() directly.</td></tr>
  <tr class="msg" id="L284"><td class="ts-cell"><a class="ts" href="#L284" alt="Wed Apr 08 2015 15:50:47 GMT-0700 (Pacific Daylight Time)">22:50</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title=bradleymeck@irc>bradleymeck</span>&gt;</td><td class="msg-cell">if there is not a clearly defines point of cancellation, something should not be cancellable</td></tr>
  <tr class="msg" id="L285"><td class="ts-cell"><a class="ts" href="#L285" alt="Wed Apr 08 2015 15:51:03 GMT-0700 (Pacific Daylight Time)">22:51</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title=bradleymeck@irc>bradleymeck</span>&gt;</td><td class="msg-cell">defined*</td></tr>
  <tr class="msg" id="L286"><td class="ts-cell"><a class="ts" href="#L286" alt="Wed Apr 08 2015 15:51:17 GMT-0700 (Pacific Daylight Time)">22:51</a></td><td class="nick-cell">&lt;<span class="nick nick-14" title=boogyman@irc>boogyman</span>&gt;</td><td class="msg-cell">Domenic: however you define &quot;p.cancel()&quot; on an already resolved p</td></tr>
  <tr class="msg" id="L287"><td class="ts-cell"><a class="ts" href="#L287" alt="Wed Apr 08 2015 15:51:26 GMT-0700 (Pacific Daylight Time)">22:51</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">i don&#039;t understand</td></tr>
  <tr class="msg" id="L288"><td class="ts-cell"><a class="ts" href="#L288" alt="Wed Apr 08 2015 15:51:43 GMT-0700 (Pacific Daylight Time)">22:51</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">please phrase your question using code?</td></tr>
  <tr class="msg" id="L289"><td class="ts-cell"><a class="ts" href="#L289" alt="Wed Apr 08 2015 15:51:45 GMT-0700 (Pacific Daylight Time)">22:51</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">trevnorris: &quot;something else&quot; is another thread?  or the kernel?  because in multi-process browsers it goes js-&gt;c++-&gt;IPC-&gt;c++-&gt;kernel with thread and process switches in there</td></tr>
  <tr class="msg" id="L290"><td class="ts-cell"><a class="ts" href="#L290" alt="Wed Apr 08 2015 15:51:56 GMT-0700 (Pacific Daylight Time)">22:51</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title=bradleymeck@irc>bradleymeck</span>&gt;</td><td class="msg-cell">if cancellation is inteded to be similar to abort()/halting a thread it should be rethought</td></tr>
  <tr class="msg" id="L291"><td class="ts-cell"><a class="ts" href="#L291" alt="Wed Apr 08 2015 15:52:21 GMT-0700 (Pacific Daylight Time)">22:52</a></td><td class="nick-cell"><span class="nick nick-2" title=bradleymeck@irc>bradleymeck</span></td><td class="msg-cell">can&#039;t type today</td></tr>
  <tr class="msg" id="L292"><td class="ts-cell"><a class="ts" href="#L292" alt="Wed Apr 08 2015 15:52:24 GMT-0700 (Pacific Daylight Time)">22:52</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">right now ws.write() does not return a cancellable promise...</td></tr>
  <tr class="msg" id="L293"><td class="ts-cell"><a class="ts" href="#L293" alt="Wed Apr 08 2015 15:52:29 GMT-0700 (Pacific Daylight Time)">22:52</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">this is all hand wving</td></tr>
  <tr class="msg" id="L294"><td class="ts-cell"><a class="ts" href="#L294" alt="Wed Apr 08 2015 15:52:30 GMT-0700 (Pacific Daylight Time)">22:52</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">waving</td></tr>
  <tr class="msg" id="L295"><td class="ts-cell"><a class="ts" href="#L295" alt="Wed Apr 08 2015 15:52:34 GMT-0700 (Pacific Daylight Time)">22:52</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=trevnorris@irc>trevnorris</span>&gt;</td><td class="msg-cell">wanderview: anything that takes control away from us over the lifetime of the data. but if I have an array of data chunks and only the first has been sent to uv_write() then the others should be able to be removed from their position in the queue.</td></tr>
  <tr class="msg" id="L296"><td class="ts-cell"><a class="ts" href="#L296" alt="Wed Apr 08 2015 15:52:52 GMT-0700 (Pacific Daylight Time)">22:52</a></td><td class="nick-cell">&lt;<span class="nick nick-14" title=boogyman@irc>boogyman</span>&gt;</td><td class="msg-cell">`var p = ws.write(data); setTimeout(() =&gt; p.cancel(), 1000). (Assuming calling p.cancel() does nothing on an already-settled promise) &lt;-- Under what circumstance would be have already been resolved if it is dependent upon ws.write(data)</td></tr>
  <tr class="msg" id="L297"><td class="ts-cell"><a class="ts" href="#L297" alt="Wed Apr 08 2015 15:53:17 GMT-0700 (Pacific Daylight Time)">22:53</a></td><td class="nick-cell">&lt;<span class="nick nick-14" title=boogyman@irc>boogyman</span>&gt;</td><td class="msg-cell">would p.cancel()*</td></tr>
  <tr class="msg" id="L298"><td class="ts-cell"><a class="ts" href="#L298" alt="Wed Apr 08 2015 15:53:42 GMT-0700 (Pacific Daylight Time)">22:53</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">trevnorris: does uv_write() do file writing on a separate IO thread or the main thread?</td></tr>
  <tr class="msg" id="L299"><td class="ts-cell"><a class="ts" href="#L299" alt="Wed Apr 08 2015 15:53:48 GMT-0700 (Pacific Daylight Time)">22:53</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">boogyman: the adjective &quot;resolved&quot; does not apply to the function call p.cancel(), nor to its return value (which is undefined)</td></tr>
  <tr class="msg" id="L300"><td class="ts-cell"><a class="ts" href="#L300" alt="Wed Apr 08 2015 15:53:52 GMT-0700 (Pacific Daylight Time)">22:53</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=trevnorris@irc>trevnorris</span>&gt;</td><td class="msg-cell">wanderview: main thread.</td></tr>
  <tr class="msg" id="L301"><td class="ts-cell"><a class="ts" href="#L301" alt="Wed Apr 08 2015 15:53:57 GMT-0700 (Pacific Daylight Time)">22:53</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title=bradleymeck@irc>bradleymeck</span>&gt;</td><td class="msg-cell">wanderview: but I think at that point the cancellation point would be if the kernel gets it still, once it gets to the kernel it cannot be stopped, so attempts at cancellation would need to propagate to the C++ that flushes to the kernel, and if it has started flushing it is in an uncancellable state</td></tr>
  <tr class="msg" id="L302"><td class="ts-cell"><a class="ts" href="#L302" alt="Wed Apr 08 2015 15:53:58 GMT-0700 (Pacific Daylight Time)">22:53</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">trevnorris: false?</td></tr>
  <tr class="msg" id="L303"><td class="ts-cell"><a class="ts" href="#L303" alt="Wed Apr 08 2015 15:54:12 GMT-0700 (Pacific Daylight Time)">22:54</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=trevnorris@irc>trevnorris</span>&gt;</td><td class="msg-cell">wanderview: though I agree that if the data chunks were immediately sent to another thread to be written then we would have &quot;lost control&quot;. thus cancel would only be a notification that we no longer need to be notified of its completion.</td></tr>
  <tr class="msg" id="L304"><td class="ts-cell"><a class="ts" href="#L304" alt="Wed Apr 08 2015 15:54:14 GMT-0700 (Pacific Daylight Time)">22:54</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=trevnorris@irc>trevnorris</span>&gt;</td><td class="msg-cell">Domenic: eh?</td></tr>
  <tr class="msg" id="L305"><td class="ts-cell"><a class="ts" href="#L305" alt="Wed Apr 08 2015 15:54:29 GMT-0700 (Pacific Daylight Time)">22:54</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">trevnorris: fs writes in io are done in a threadpool?</td></tr>
  <tr class="msg" id="L306"><td class="ts-cell"><a class="ts" href="#L306" alt="Wed Apr 08 2015 15:54:44 GMT-0700 (Pacific Daylight Time)">22:54</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">trevnorris: ok, then you don&#039;t have to deal with the races I do... trying to pick out a single buffer to cancel is going to be hit or miss in browsers or other multi-threaded environments</td></tr>
  <tr class="msg" id="L307"><td class="ts-cell"><a class="ts" href="#L307" alt="Wed Apr 08 2015 15:54:46 GMT-0700 (Pacific Daylight Time)">22:54</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title=bradleymeck@irc>bradleymeck</span>&gt;</td><td class="msg-cell">they are queued on the main thread though</td></tr>
  <tr class="msg" id="L308"><td class="ts-cell"><a class="ts" href="#L308" alt="Wed Apr 08 2015 15:54:55 GMT-0700 (Pacific Daylight Time)">22:54</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=trevnorris@irc>trevnorris</span>&gt;</td><td class="msg-cell">Domenic: they&#039;re a special case. uv_wirte() and uv_try_write() is always done on the main thread.</td></tr>
  <tr class="msg" id="L309"><td class="ts-cell"><a class="ts" href="#L309" alt="Wed Apr 08 2015 15:55:01 GMT-0700 (Pacific Daylight Time)">22:55</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=trevnorris@irc>trevnorris</span>&gt;</td><td class="msg-cell">*uv_write()</td></tr>
  <tr class="msg" id="L310"><td class="ts-cell"><a class="ts" href="#L310" alt="Wed Apr 08 2015 15:55:05 GMT-0700 (Pacific Daylight Time)">22:55</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title=bradleymeck@irc>bradleymeck</span>&gt;</td><td class="msg-cell">?</td></tr>
  <tr class="msg" id="L311"><td class="ts-cell"><a class="ts" href="#L311" alt="Wed Apr 08 2015 15:55:29 GMT-0700 (Pacific Daylight Time)">22:55</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">trevnorris: ah, I thought we were talking about file I/O since wanderview asked &quot;does uv_write() do file writing&quot;. I guess uv_write is for sockets?</td></tr>
  <tr class="msg" id="L312"><td class="ts-cell"><a class="ts" href="#L312" alt="Wed Apr 08 2015 15:55:44 GMT-0700 (Pacific Daylight Time)">22:55</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=trevnorris@irc>trevnorris</span>&gt;</td><td class="msg-cell">yes. sorry I missed that. uv_write() is only for sockets.</td></tr>
  <tr class="msg" id="L313"><td class="ts-cell"><a class="ts" href="#L313" alt="Wed Apr 08 2015 15:56:00 GMT-0700 (Pacific Daylight Time)">22:56</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=trevnorris@irc>trevnorris</span>&gt;</td><td class="msg-cell">filesystem I/O is a pain thanks to kernel incompatibilities.</td></tr>
  <tr class="msg" id="L314"><td class="ts-cell"><a class="ts" href="#L314" alt="Wed Apr 08 2015 15:56:00 GMT-0700 (Pacific Daylight Time)">22:56</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">gotcha</td></tr>
  <tr class="msg" id="L315"><td class="ts-cell"><a class="ts" href="#L315" alt="Wed Apr 08 2015 15:56:02 GMT-0700 (Pacific Daylight Time)">22:56</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: what I am getting is they treat the &quot;write is complete&quot; state when it leaves main thread... which might not quite be to kernel</td></tr>
  <tr class="msg" id="L316"><td class="ts-cell"><a class="ts" href="#L316" alt="Wed Apr 08 2015 15:56:13 GMT-0700 (Pacific Daylight Time)">22:56</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">yeah</td></tr>
  <tr class="msg" id="L317"><td class="ts-cell"><a class="ts" href="#L317" alt="Wed Apr 08 2015 15:56:16 GMT-0700 (Pacific Daylight Time)">22:56</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: which is different from your goal of &quot;bytes written to kernel&quot;</td></tr>
  <tr class="msg" id="L318"><td class="ts-cell"><a class="ts" href="#L318" alt="Wed Apr 08 2015 15:56:48 GMT-0700 (Pacific Daylight Time)">22:56</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">I&#039;m not sure to-kernel is all that much better than an app internal checkpoint</td></tr>
  <tr class="msg" id="L319"><td class="ts-cell"><a class="ts" href="#L319" alt="Wed Apr 08 2015 15:56:52 GMT-0700 (Pacific Daylight Time)">22:56</a></td><td class="nick-cell">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</td><td class="msg-cell">if you are sure that writes respect backpressure, maybe &quot;accepted and queued&quot; is a good enough proxy for upload progress...</td></tr>
  <tr class="msg" id="L320"><td class="ts-cell"><a class="ts" href="#L320" alt="Wed Apr 08 2015 15:56:56 GMT-0700 (Pacific Daylight Time)">22:56</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">but willing to try to support it</td></tr>
  <tr class="msg" id="L321"><td class="ts-cell"><a class="ts" href="#L321" alt="Wed Apr 08 2015 15:57:05 GMT-0700 (Pacific Daylight Time)">22:57</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=trevnorris@irc>trevnorris</span>&gt;</td><td class="msg-cell">it&#039;s possible to share memory on the req across threads so read-only fields can be used to check its status.</td></tr>
  <tr class="msg" id="L322"><td class="ts-cell"><a class="ts" href="#L322" alt="Wed Apr 08 2015 15:57:39 GMT-0700 (Pacific Daylight Time)">22:57</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">trevnorris: you have an atomic check-and-set for cancellation across threads?</td></tr>
  <tr class="msg" id="L323"><td class="ts-cell"><a class="ts" href="#L323" alt="Wed Apr 08 2015 15:57:53 GMT-0700 (Pacific Daylight Time)">22:57</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title=bradleymeck@irc>bradleymeck</span>&gt;</td><td class="msg-cell">wanderview: I think at either point cancellation is a suggestion to w/e you handed it off to</td></tr>
  <tr class="msg" id="L324"><td class="ts-cell"><a class="ts" href="#L324" alt="Wed Apr 08 2015 15:58:08 GMT-0700 (Pacific Daylight Time)">22:58</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title=bradleymeck@irc>bradleymeck</span>&gt;</td><td class="msg-cell">it needs to be able to continue the work if it has started side effects already</td></tr>
  <tr class="msg" id="L325"><td class="ts-cell"><a class="ts" href="#L325" alt="Wed Apr 08 2015 15:58:25 GMT-0700 (Pacific Daylight Time)">22:58</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title=bradleymeck@irc>bradleymeck</span>&gt;</td><td class="msg-cell">no real need for locking to my knowledge</td></tr>
  <tr class="msg" id="L326"><td class="ts-cell"><a class="ts" href="#L326" alt="Wed Apr 08 2015 15:58:29 GMT-0700 (Pacific Daylight Time)">22:58</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">bradleymeck: exactly... I guess I was just getting at I find it hard to reason about the need to cancel buffer1 and let buffer2 through... when you cannot know if you got to buffer1 in time</td></tr>
  <tr class="msg" id="L327"><td class="ts-cell"><a class="ts" href="#L327" alt="Wed Apr 08 2015 15:58:44 GMT-0700 (Pacific Daylight Time)">22:58</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=trevnorris@irc>trevnorris</span>&gt;</td><td class="msg-cell">wanderview: right now only have it so if I&#039;ve queued up many small buffers to be written I can check how many of them have actually been sent to the kernel.</td></tr>
  <tr class="msg" id="L328"><td class="ts-cell"><a class="ts" href="#L328" alt="Wed Apr 08 2015 15:58:54 GMT-0700 (Pacific Daylight Time)">22:58</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title=bradleymeck@irc>bradleymeck</span>&gt;</td><td class="msg-cell">i don&#039;t think you should be allowed to know at the time of cancellation</td></tr>
  <tr class="msg" id="L329"><td class="ts-cell"><a class="ts" href="#L329" alt="Wed Apr 08 2015 15:59:33 GMT-0700 (Pacific Daylight Time)">22:59</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=trevnorris@irc>trevnorris</span>&gt;</td><td class="msg-cell">wanderview: streaming video for example. say you&#039;re buffering data to be written. it&#039;s better that frames are lost and the data stays current then making sure all the data goes through.</td></tr>
  <tr class="msg" id="L330"><td class="ts-cell"><a class="ts" href="#L330" alt="Wed Apr 08 2015 16:00:30 GMT-0700 (Pacific Daylight Time)">23:00</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title=bradleymeck@irc>bradleymeck</span>&gt;</td><td class="msg-cell">wanderview: to rephrase, I cannot think of a good reason you should be allowed to know that buffer1 was cancelled before it calls .finally</td></tr>
  <tr class="msg" id="L331"><td class="ts-cell"><a class="ts" href="#L331" alt="Wed Apr 08 2015 16:00:50 GMT-0700 (Pacific Daylight Time)">23:00</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: I think we are still not on the same page here:  <a href="https://github.com/yutakahirano/fetch-with-streams/issues/30#issuecomment-91057900">https://github.com/yutakahirano/fetch-with-streams/issues/30#issuecomment-91057900</a></td></tr>
  <tr class="msg" id="L332"><td class="ts-cell"><a class="ts" href="#L332" alt="Wed Apr 08 2015 16:01:43 GMT-0700 (Pacific Daylight Time)">23:01</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title=bradleymeck@irc>bradleymeck</span>&gt;</td><td class="msg-cell">which to me resolves the problem of reasoning</td></tr>
  <tr class="msg" id="L333"><td class="ts-cell"><a class="ts" href="#L333" alt="Wed Apr 08 2015 16:01:53 GMT-0700 (Pacific Daylight Time)">23:01</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">I guess I&#039;m happy we don&#039;t yet allow canceling individual .write() calls... and if we did, I think it would very much have to be a &quot;best effort&quot;</td></tr>
  <tr class="msg" id="L334"><td class="ts-cell"><a class="ts" href="#L334" alt="Wed Apr 08 2015 16:02:17 GMT-0700 (Pacific Daylight Time)">23:02</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">bradleymeck: sure... I think I understand better that its a best effort cancel, for example the video streaming case mentioned</td></tr>
  <tr class="msg" id="L335"><td class="ts-cell"><a class="ts" href="#L335" alt="Wed Apr 08 2015 16:02:30 GMT-0700 (Pacific Daylight Time)">23:02</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title=bradleymeck@irc>bradleymeck</span>&gt;</td><td class="msg-cell">which is good, I want &quot;best effort&quot; and not guaranteed</td></tr>
  <tr class="msg" id="L336"><td class="ts-cell"><a class="ts" href="#L336" alt="Wed Apr 08 2015 16:03:02 GMT-0700 (Pacific Daylight Time)">23:03</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title=bradleymeck@irc>bradleymeck</span>&gt;</td><td class="msg-cell">cause once side effects start / external systems are involved you need to let them resolve back to valid states (say if you have not finished writing)</td></tr>
  <tr class="msg" id="L337"><td class="ts-cell"><a class="ts" href="#L337" alt="Wed Apr 08 2015 16:03:34 GMT-0700 (Pacific Daylight Time)">23:03</a></td><td class="nick-cell">&lt;<span class="nick nick-2" title=bradleymeck@irc>bradleymeck</span>&gt;</td><td class="msg-cell">guaranteed cancel would require external systems to stay in valid and buffered states which is a no-no</td></tr>
  <tr class="msg" id="L338"><td class="ts-cell"><a class="ts" href="#L338" alt="Wed Apr 08 2015 16:03:56 GMT-0700 (Pacific Daylight Time)">23:03</a></td><td class="nick-cell">&lt;<span class="nick nick-12" title=wanderview@irc>wanderview</span>&gt;</td><td class="msg-cell">Domenic: I&#039;ll respond in bug... but I think very much &quot;setWriter()&quot; should function like a pipeTo()...  we could call it drainToWriter() or something if you want</td></tr>
  <tr class="msg" id="L339"><td class="ts-cell"><a class="ts" href="#L339" alt="Wed Apr 08 2015 16:06:11 GMT-0700 (Pacific Daylight Time)">23:06</a></td><td class="nick-cell">&lt;<span class="nick nick-15" title=trevnorris@irc>trevnorris</span>&gt;</td><td class="msg-cell">wanderview: doing an atomic field set so the writing thread can check if the queue from another thread is still needed is very much possible.</td></tr>
</tbody></table>
</div></div></div></body>
