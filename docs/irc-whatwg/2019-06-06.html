<!doctype html>
<head>
  <title>#whatwg on 2019-06-06</title>
  <link rel="stylesheet" href="../style.css">
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">#whatwg<br>2019-06-06<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2019-06-05" class="nav-link"><span>prev</span></a>
<a href="2019-06-07" class="nav-link"><span style="float:right">next</span></a>
</div>
    
<div class="room-list-wrapper">Active:<br>
<ul class="room-list">
<li><a href="../TC39_Delegates/">TC39 Delegates</a></li>
<li><a href="../TC39_Editors/">TC39 Editors</a></li>
<li><a href="../TC39_General/">TC39 General</a></li>
<li><a href="../WHATWG/">WHATWG</a></li>
</ul>
</div>
<br>
<div class="room-list-wrapper">Historical:<br>
<ul class="room-list">
<li><a href="../irc-tc39/">#tc39</a></li>
<li><a href="../irc-tc39-delegates/">#tc39-delegates</a></li>
<li><a href="../irc-tc39-editor-group/">#tc39-editor-group</a></li>
<li><a href="../irc-whatwg/" class="current-room">#whatwg</a></li>
</ul>
</div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>
<input type="text" id="query" size=25 placeholder="Search #whatwg">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Wed Jun 05 2019 18:34:46 GMT-0700 (Pacific Daylight Time)">01:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title=jolvera@irc>jolvera</span>&gt;</div></td><td class="msg-cell">i&#039;d like to contribute again and i&#039;m looking at <a href="https://github.com/whatwg/html/issues/4626">https://github.com/whatwg/html/issues/4626</a> but i&#039;m not sure what a &quot;WPT test&quot; is</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Wed Jun 05 2019 18:37:21 GMT-0700 (Pacific Daylight Time)">01:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title=jolvera@irc>jolvera</span>&gt;</div></td><td class="msg-cell">nvm i just read the <a href="http://readme.md">readme.md</a></td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Wed Jun 05 2019 22:17:16 GMT-0700 (Pacific Daylight Time)">05:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</div></td><td class="msg-cell">jolvera: great, be sure to let this channel know if you run into issues</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Thu Jun 06 2019 01:17:18 GMT-0700 (Pacific Daylight Time)">08:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</div></td><td class="msg-cell">Domenic: per <a href="https://w3c.github.io/ServiceWorker/#importscripts">https://w3c.github.io/ServiceWorker/#importscripts</a> importScripts() will return a network error which I guess will result in a script error so we might have some of those on <a href="http://whatwg.org">whatwg.org</a>?</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Thu Jun 06 2019 01:25:49 GMT-0700 (Pacific Daylight Time)">08:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</div></td><td class="msg-cell">JakeA: <a href="https://github.com/tc39/proposal-top-level-await/issues/79">https://github.com/tc39/proposal-top-level-await/issues/79</a></td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Thu Jun 06 2019 01:29:13 GMT-0700 (Pacific Daylight Time)">08:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title=JakeA@irc>JakeA</span>&gt;</div></td><td class="msg-cell">annevk: yep, I agree. I can&#039;t think of anything good you could do with top-level await in service workers</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Thu Jun 06 2019 01:33:28 GMT-0700 (Pacific Daylight Time)">08:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</div></td><td class="msg-cell">JakeA: cool, I think littledan is open to making this change and hopefully nobody in TC39 cares too much about some agents not having it</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Thu Jun 06 2019 01:33:45 GMT-0700 (Pacific Daylight Time)">08:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</div></td><td class="msg-cell">JakeA: though it reached stage 3 just now, so it&#039;d be hard to block anyway :p</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Thu Jun 06 2019 01:45:27 GMT-0700 (Pacific Daylight Time)">08:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</div></td><td class="msg-cell">as an example of somewhere this might come up, if you want to use a WebAssembly module, it&#039;d run into this restriction, since we like to give Wasm time to compile itself off the main thread</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Thu Jun 06 2019 01:45:59 GMT-0700 (Pacific Daylight Time)">08:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</div></td><td class="msg-cell">but I guess people could get around this by loading the Wasm module later, after initial startup (?)</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Thu Jun 06 2019 01:46:35 GMT-0700 (Pacific Daylight Time)">08:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</div></td><td class="msg-cell">JakeA: Does that sound reasonable to you? I&#039;m happy to write this up in spec text if this is what we&#039;re agreeing on</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Thu Jun 06 2019 01:47:46 GMT-0700 (Pacific Daylight Time)">08:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-12" title=annevk@irc>annevk</span>&gt;</div></td><td class="msg-cell">Ideally a service worker is a Wasm module I think</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Thu Jun 06 2019 01:48:06 GMT-0700 (Pacific Daylight Time)">08:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title=JakeA@irc>JakeA</span>&gt;</div></td><td class="msg-cell">littledan: how is the wasm imported into the service worker in this case?</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Thu Jun 06 2019 01:48:25 GMT-0700 (Pacific Daylight Time)">08:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</div></td><td class="msg-cell">I was getting at, it could be with an import statement, with Wasm/ESM integration.</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Thu Jun 06 2019 01:48:40 GMT-0700 (Pacific Daylight Time)">08:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</div></td><td class="msg-cell">(which isn&#039;t implemented anywhere, but everyone seems to buy into it)</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Thu Jun 06 2019 01:49:11 GMT-0700 (Pacific Daylight Time)">08:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title=JakeA@irc>JakeA</span>&gt;</div></td><td class="msg-cell">So `import wasmModule from &#039;./whatever.wasm&#039;` - are you saying this uses top level await internally?</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Thu Jun 06 2019 01:49:19 GMT-0700 (Pacific Daylight Time)">08:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</div></td><td class="msg-cell">JakeA: Yes, that&#039;s the proposal</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Thu Jun 06 2019 01:49:55 GMT-0700 (Pacific Daylight Time)">08:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</div></td><td class="msg-cell">JakeA: So Wasm &quot;compilation&quot; takes place when fetching/parsing ,but some engines (currently JSC, but maybe more in the future) do significant work when &quot;instantiating&quot;, which happens in the ESM evaluation phase</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Thu Jun 06 2019 01:50:08 GMT-0700 (Pacific Daylight Time)">08:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</div></td><td class="msg-cell">JakeA: So, the spec is, &quot;in parallel, queue a task  to...&quot;</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Thu Jun 06 2019 01:50:42 GMT-0700 (Pacific Daylight Time)">08:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title=JakeA@irc>JakeA</span>&gt;</div></td><td class="msg-cell">littledan: how is its use of `await` observably different from the parse time a regular script does when importing?</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Thu Jun 06 2019 01:51:25 GMT-0700 (Pacific Daylight Time)">08:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title=JakeA@irc>JakeA</span>&gt;</div></td><td class="msg-cell">I guess I&#039;m trying to figure out what it means to use `await` &#039;internally&#039;</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Thu Jun 06 2019 01:51:26 GMT-0700 (Pacific Daylight Time)">08:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</div></td><td class="msg-cell">JakeA: Not sure what you mean by &quot;observably&quot;. It&#039;s like, if you have one module which imports another, the dependency doesn&#039;t run its top-level statements until the inner `await` resolves</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Thu Jun 06 2019 01:51:54 GMT-0700 (Pacific Daylight Time)">08:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</div></td><td class="msg-cell">and then, at the top level, there&#039;s a concept of when we&#039;ve asynchronously finished executing the module graph, rather than synchronously (but it&#039;s fine to ignore this--HTML doesn&#039;t use it for much)</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Thu Jun 06 2019 01:53:34 GMT-0700 (Pacific Daylight Time)">08:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</div></td><td class="msg-cell">JakeA: Here&#039;s a simple, silly example: <a href="https://github.com/tc39/proposal-top-level-await#solution-top-level-await">https://github.com/tc39/proposal-top-level-await#solution-top-level-await</a></td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Thu Jun 06 2019 01:54:06 GMT-0700 (Pacific Daylight Time)">08:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title=JakeA@irc>JakeA</span>&gt;</div></td><td class="msg-cell">littledan: what if `import wasmModule from &#039;./whatever.wasm&#039;` didn&#039;t use `await` internally, and it just waited. What would the observable difference be?</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Thu Jun 06 2019 01:54:25 GMT-0700 (Pacific Daylight Time)">08:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title=JakeA@irc>JakeA</span>&gt;</div></td><td class="msg-cell">littledan: but those examples aren&#039;t an internal use of `await`, they&#039;re author-written</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Thu Jun 06 2019 01:54:49 GMT-0700 (Pacific Daylight Time)">08:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title=JakeA@irc>JakeA</span>&gt;</div></td><td class="msg-cell">or have I misunderstood how `import wasmModule from &#039;./whatever.wasm&#039;` is supposed to work?</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Thu Jun 06 2019 01:55:24 GMT-0700 (Pacific Daylight Time)">08:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</div></td><td class="msg-cell">JakeA: Right, in the draft spec for Wasm modules, we *always* queue a task (for consistency), so if that module calls into JS from its start function, you can see the timing difference</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Thu Jun 06 2019 01:56:09 GMT-0700 (Pacific Daylight Time)">08:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</div></td><td class="msg-cell">smaug____ and others were pretty strong in encouraging consistency on whether we&#039;re queueing a task or just preceding synchronously (in an earlier draft, it was &quot;optional&quot;)</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Thu Jun 06 2019 01:56:47 GMT-0700 (Pacific Daylight Time)">08:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title=JakeA@irc>JakeA</span>&gt;</div></td><td class="msg-cell">littledan: consistency with what? (sorry I&#039;m being dumb)</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Thu Jun 06 2019 01:57:02 GMT-0700 (Pacific Daylight Time)">08:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</div></td><td class="msg-cell">JakeA: Among engines, or within an engine, what the timing will be</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Thu Jun 06 2019 01:57:58 GMT-0700 (Pacific Daylight Time)">08:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title=JakeA@irc>JakeA</span>&gt;</div></td><td class="msg-cell">littledan: but if wasm modules consistently _didn&#039;t_ queue a task, would that be inconsistent with something else?</td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Thu Jun 06 2019 02:01:19 GMT-0700 (Pacific Daylight Time)">09:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</div></td><td class="msg-cell">JakeA: Well, it&#039;d mean we&#039;re running compilation on the main thread, which isn&#039;t so great</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Thu Jun 06 2019 02:01:38 GMT-0700 (Pacific Daylight Time)">09:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</div></td><td class="msg-cell">not sure how deep you&#039;re interested in the details of why that&#039;d happen</td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Thu Jun 06 2019 02:02:14 GMT-0700 (Pacific Daylight Time)">09:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</div></td><td class="msg-cell">Working out these Wasm module interactions is why I got started on top-level await</td></tr>
  <tr class="msg" id="L35"><td class="ts-cell"><a class="ts" href="#L35" alt="Thu Jun 06 2019 02:03:10 GMT-0700 (Pacific Daylight Time)">09:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title=JakeA@irc>JakeA</span>&gt;</div></td><td class="msg-cell">littledan: Gotcha. I guess this relates more to <a href="https://github.com/tc39/proposal-top-level-await/issues/79#issuecomment-499402046">https://github.com/tc39/proposal-top-level-await/issues/79#issuecomment-499402046</a> then. Allowing `import()` means you can kick off the import early but not be blocked by the compilation</td></tr>
  <tr class="msg" id="L36"><td class="ts-cell"><a class="ts" href="#L36" alt="Thu Jun 06 2019 02:04:09 GMT-0700 (Pacific Daylight Time)">09:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</div></td><td class="msg-cell">right, I could imagine telling SW programmers, &quot;sorry, Wasm has to be done with import()&quot;. I would be a little sad about that, but not the end of the world</td></tr>
  <tr class="msg" id="L37"><td class="ts-cell"><a class="ts" href="#L37" alt="Thu Jun 06 2019 02:04:33 GMT-0700 (Pacific Daylight Time)">09:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</div></td><td class="msg-cell">JakeA: Is this what you&#039;re thinking?</td></tr>
  <tr class="msg" id="L38"><td class="ts-cell"><a class="ts" href="#L38" alt="Thu Jun 06 2019 02:04:50 GMT-0700 (Pacific Daylight Time)">09:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</div></td><td class="msg-cell">JakeA: Or are you thinking, we do compilation on the main thread in this case, and off the main thread in that case?</td></tr>
  <tr class="msg" id="L39"><td class="ts-cell"><a class="ts" href="#L39" alt="Thu Jun 06 2019 02:04:55 GMT-0700 (Pacific Daylight Time)">09:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title=JakeA@irc>JakeA</span>&gt;</div></td><td class="msg-cell">littledan: The alternative is &quot;WASM can be imported statically within a service worker, but oh god please don&#039;t&quot;</td></tr>
  <tr class="msg" id="L40"><td class="ts-cell"><a class="ts" href="#L40" alt="Thu Jun 06 2019 02:05:45 GMT-0700 (Pacific Daylight Time)">09:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title=JakeA@irc>JakeA</span>&gt;</div></td><td class="msg-cell">littledan: Nah I wasn&#039;t thinking about switching to main thread compilation</td></tr>
  <tr class="msg" id="L41"><td class="ts-cell"><a class="ts" href="#L41" alt="Thu Jun 06 2019 02:06:04 GMT-0700 (Pacific Daylight Time)">09:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</div></td><td class="msg-cell">well, I still have to learn more about SW to understand exactly how bad this is. This isn&#039;t the same order as waiting for network stuff, I think</td></tr>
  <tr class="msg" id="L42"><td class="ts-cell"><a class="ts" href="#L42" alt="Thu Jun 06 2019 02:06:14 GMT-0700 (Pacific Daylight Time)">09:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title=JakeA@irc>JakeA</span>&gt;</div></td><td class="msg-cell">littledan: The choice still feels like &quot;disallow it&quot; vs &quot;allow it but firefight people actually doing it&quot;</td></tr>
  <tr class="msg" id="L43"><td class="ts-cell"><a class="ts" href="#L43" alt="Thu Jun 06 2019 02:06:27 GMT-0700 (Pacific Daylight Time)">09:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title=JakeA@irc>JakeA</span>&gt;</div></td><td class="msg-cell">littledan: Service worker startup is never blocked on network stuff</td></tr>
  <tr class="msg" id="L44"><td class="ts-cell"><a class="ts" href="#L44" alt="Thu Jun 06 2019 02:06:49 GMT-0700 (Pacific Daylight Time)">09:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title=JakeA@irc>JakeA</span>&gt;</div></td><td class="msg-cell">littledan: except the very first time, but at that point the service worker isn&#039;t needed for an important event</td></tr>
  <tr class="msg" id="L45"><td class="ts-cell"><a class="ts" href="#L45" alt="Thu Jun 06 2019 02:07:08 GMT-0700 (Pacific Daylight Time)">09:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</div></td><td class="msg-cell">OK, so, I&#039;ll draft up this text to prohibit async modules for serviceworkers and socialize it a bit, and we&#039;ll go from there</td></tr>
  <tr class="msg" id="L46"><td class="ts-cell"><a class="ts" href="#L46" alt="Thu Jun 06 2019 02:07:14 GMT-0700 (Pacific Daylight Time)">09:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</div></td><td class="msg-cell">JakeA: Thanks for talking this through</td></tr>
  <tr class="msg" id="L47"><td class="ts-cell"><a class="ts" href="#L47" alt="Thu Jun 06 2019 02:09:42 GMT-0700 (Pacific Daylight Time)">09:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title=JakeA@irc>JakeA</span>&gt;</div></td><td class="msg-cell">littledan: When a service worker is first run, it&#039;s in an &#039;installing&#039; state. It isn&#039;t in the blocking path for fetch/push/sync/etc events. At this point we take everything it imports via `importScripts` (we&#039;d do the same with static imports) and cache them alongside the worker script. Then, when the service worker is in the middle of those important events, we just pull the imported scripts from disk (potentially precompiled). If</td></tr>
  <tr class="msg" id="L48"><td class="ts-cell"><a class="ts" href="#L48" alt="Thu Jun 06 2019 02:09:42 GMT-0700 (Pacific Daylight Time)">09:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title=JakeA@irc>JakeA</span>&gt;</div></td><td class="msg-cell">it tries to `importScripts` anything it hasn&#039;t already imported, it throws.</td></tr>
  <tr class="msg" id="L49"><td class="ts-cell"><a class="ts" href="#L49" alt="Thu Jun 06 2019 02:10:54 GMT-0700 (Pacific Daylight Time)">09:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</div></td><td class="msg-cell">so, if we&#039;re importing something that&#039;s already cached in the SW, maybe it can be synchronous?</td></tr>
  <tr class="msg" id="L50"><td class="ts-cell"><a class="ts" href="#L50" alt="Thu Jun 06 2019 02:11:24 GMT-0700 (Pacific Daylight Time)">09:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title=JakeA@irc>JakeA</span>&gt;</div></td><td class="msg-cell">littledan: if it can be cached, yeah</td></tr>
  <tr class="msg" id="L51"><td class="ts-cell"><a class="ts" href="#L51" alt="Thu Jun 06 2019 02:12:07 GMT-0700 (Pacific Daylight Time)">09:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title=JakeA@irc>JakeA</span>&gt;</div></td><td class="msg-cell">littledan: but if one of the static imports `await`s a load of IDB work (for instance), which adds 100s if ms to the `fetch` event being dispatchable, that&#039;s what we want to avoid</td></tr>
  <tr class="msg" id="L52"><td class="ts-cell"><a class="ts" href="#L52" alt="Thu Jun 06 2019 02:12:27 GMT-0700 (Pacific Daylight Time)">09:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</div></td><td class="msg-cell">I see</td></tr>
  <tr class="msg" id="L53"><td class="ts-cell"><a class="ts" href="#L53" alt="Thu Jun 06 2019 02:12:36 GMT-0700 (Pacific Daylight Time)">09:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title=JakeA@irc>JakeA</span>&gt;</div></td><td class="msg-cell">of ms*</td></tr>
  <tr class="msg" id="L54"><td class="ts-cell"><a class="ts" href="#L54" alt="Thu Jun 06 2019 02:12:52 GMT-0700 (Pacific Daylight Time)">09:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</div></td><td class="msg-cell">JakeA: yeah, I imagine TLA would be used for exactly that kind of thing</td></tr>
  <tr class="msg" id="L55"><td class="ts-cell"><a class="ts" href="#L55" alt="Thu Jun 06 2019 02:13:15 GMT-0700 (Pacific Daylight Time)">09:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</div></td><td class="msg-cell">and when it&#039;s &quot;dispatchable&quot; is really about, when the module has run?</td></tr>
  <tr class="msg" id="L56"><td class="ts-cell"><a class="ts" href="#L56" alt="Thu Jun 06 2019 02:13:22 GMT-0700 (Pacific Daylight Time)">09:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title=JakeA@irc>JakeA</span>&gt;</div></td><td class="msg-cell">yeah</td></tr>
  <tr class="msg" id="L57"><td class="ts-cell"><a class="ts" href="#L57" alt="Thu Jun 06 2019 02:13:54 GMT-0700 (Pacific Daylight Time)">09:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title=JakeA@irc>JakeA</span>&gt;</div></td><td class="msg-cell">We can&#039;t dispatch it until `addEventListener(&#039;fetch&#039;, listener)` has had time to be called</td></tr>
  <tr class="msg" id="L58"><td class="ts-cell"><a class="ts" href="#L58" alt="Thu Jun 06 2019 02:14:08 GMT-0700 (Pacific Daylight Time)">09:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title=JakeA@irc>JakeA</span>&gt;</div></td><td class="msg-cell">Which is once the script has run</td></tr>
  <tr class="msg" id="L59"><td class="ts-cell"><a class="ts" href="#L59" alt="Thu Jun 06 2019 03:54:32 GMT-0700 (Pacific Daylight Time)">10:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title=GPHemsley@irc>GPHemsley</span>&gt;</div></td><td class="msg-cell">looks like I&#039;m gonna be updating the wiki this weekend, as our current version of MediaWiki is going EOL this month</td></tr>
  <tr class="msg" id="L60"><td class="ts-cell"><a class="ts" href="#L60" alt="Thu Jun 06 2019 04:41:08 GMT-0700 (Pacific Daylight Time)">11:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title=Domenic@irc>Domenic</span>&gt;</div></td><td class="msg-cell">&lt;3 GPHemsley</td></tr>

</tbody></table></div></div></div></body>
