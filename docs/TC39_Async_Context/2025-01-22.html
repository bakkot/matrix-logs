<!DOCTYPE html><html><head>
  <title>TC39 Async Context on 2025-01-22</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "TC39 Async Context";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">TC39 Async Context<br>2025-01-22<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2025-01-20" class="nav-link"><span>prev</span></a>
<a href="2025-01-23" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search TC39 Async Context">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Wed Jan 22 2025 01:48:57 GMT-0800 (Pacific Standard Time)">09:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@iliasbhal:matrix.org">Iliasbhal</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">Andreu Botella</span>: I just published a new version that polyfills EventTargets ğŸ‘ï¸ Feel free to create issues on the repo if you need more API polyfilled.</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Wed Jan 22 2025 02:08:34 GMT-0800 (Pacific Standard Time)">10:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@iliasbhal:matrix.org">Iliasbhal</span>&gt;</div></td><td class="msg-cell">Sidenote: Would you guys accept a PR for the polyfill?</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Wed Jan 22 2025 02:09:09 GMT-0800 (Pacific Standard Time)">10:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@abotella:igalia.com">Andreu Botella</span>&gt;</div></td><td class="msg-cell"><span class="nick-1">Justin Ridgewell</span>:</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Wed Jan 22 2025 02:12:45 GMT-0800 (Pacific Standard Time)">10:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">Probably not, as most proposals don't have polyfills and the few that do have a disclaimer "do not actually use this polyfill, it's just meant to be an example". However, you can open an issue linking to it so that other people can find it</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Wed Jan 22 2025 02:13:43 GMT-0800 (Pacific Standard Time)">10:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@abotella:igalia.com">Andreu Botella</span>&gt;</div></td><td class="msg-cell">our repo has an existing polyfill, made by Justin, only for the TC39/JS part of it</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Wed Jan 22 2025 02:15:05 GMT-0800 (Pacific Standard Time)">10:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">Oh I didn't notice ğŸ˜…</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Wed Jan 22 2025 02:16:02 GMT-0800 (Pacific Standard Time)">10:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">Btw <span class="nick-9">@iliasbhal:matrix.org</span> the events handling seems to be wrong, as (if I'm reading the code correctly) you are capturing the context when the .addEventListener call happens rather than when the event is dispatched</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Wed Jan 22 2025 02:16:19 GMT-0800 (Pacific Standard Time)">10:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">Doing it correctly is much more difficult, but it'd would be very great if a polyfill manages to do it!</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Wed Jan 22 2025 02:17:12 GMT-0800 (Pacific Standard Time)">10:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@abotella:igalia.com">Andreu Botella</span>&gt;</div></td><td class="msg-cell">the semantics of the web integration are explained in <a href="https://github.com/tc39/proposal-async-context/blob/master/WEB-INTEGRATION.md">https://github.com/tc39/proposal-async-context/blob/master/WEB-INTEGRATION.md</a></td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Wed Jan 22 2025 02:17:39 GMT-0800 (Pacific Standard Time)">10:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">"event is dispatched" means, for example, that if you have a XMLHttpRequest object and you listen to it's "load" event, it gets the context from when you call .send() rather than when you call .addEventListener, since .send() is what eventually causes the event to happen</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Wed Jan 22 2025 02:17:47 GMT-0800 (Pacific Standard Time)">10:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@legendecas:matrix.org">Chengzhong Wu</span>&gt;</div></td><td class="msg-cell">That was for demonstrating the idea and comparison between SyncContext and AsyncContext. I don't think it is intended for real world use</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Wed Jan 22 2025 02:21:07 GMT-0800 (Pacific Standard Time)">10:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@iliasbhal:matrix.org">Iliasbhal</span>&gt;</div></td><td class="msg-cell">haha! You are reading correctly. But I swear I read the opposite somewhere, or maybe I needed more coffee ğŸ¤£ ğŸ¤¦â€â™‚ï¸  I'll fix that soon ğŸ‘ï¸ </td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Wed Jan 22 2025 02:22:01 GMT-0800 (Pacific Standard Time)">10:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@abotella:igalia.com">Andreu Botella</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> haha! You are reading correctly. But I swear I read the opposite somewhere, or maybe I needed more coffee ğŸ¤£ ğŸ¤¦â€â™‚ï¸  I'll fix that soon ğŸ‘ï¸ </blockquote></mx-reply>we actually went back and forth on this, and an earlier version of the proposed web integration did that, so you might not need more coffee ğŸ˜…</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Wed Jan 22 2025 03:03:05 GMT-0800 (Pacific Standard Time)">11:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@iliasbhal:matrix.org">Iliasbhal</span>&gt;</div></td><td class="msg-cell"><span class="nick-9">nicolo-ribaudo</span>: package updated! The event listener now executes within the same context that when the event was trigered. The event listener can be triggered synchronously or asynchronoulsy it doesn't matter. ğŸ‘ï¸</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Wed Jan 22 2025 10:39:53 GMT-0800 (Pacific Standard Time)">18:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@iliasbhal:matrix.org">Iliasbhal</span>&gt;</div></td><td class="msg-cell">Update: I pushed a new version, the way snapshots were collected created memory leak since I was holding strong references to every Async Variables globaly. This prevented them from beeing garbage collected. Even if we never create snapshots.

In this new version, I used WeakMaps and WeakSets to hold weak references that won't block anything from beeing garbage collected ğŸ‘ï¸</td></tr>

</tbody></table></div></div></div>
</body></html>