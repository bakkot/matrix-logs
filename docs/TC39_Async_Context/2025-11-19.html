<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>TC39 Async Context on 2025-11-19</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "TC39 Async Context";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">TC39 Async Context<br>2025-11-19<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2025-11-13" class="nav-link"><span>prev</span></a>
<a href="2026-01-13" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search TC39 Async Context">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Tue Nov 18 2025 17:29:53 GMT-0800 (Pacific Standard Time)">01:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@stephenhicks:matrix.org">Steve Hicks</span>&gt;</div></td><td class="msg-cell">RGN just mentioned the idea that "all async iterator cleanup solutions are isomorphic to each other" e.g. resolving a promise when it's done - but this reminds me of a discussion I brought up earlier about using promises to simulate events - when async context is involved, the isomorphism potentially breaks down if you want the cleanup to happen in the same context as the job itself...</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Tue Nov 18 2025 17:39:34 GMT-0800 (Pacific Standard Time)">01:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@legendecas:matrix.org">Chengzhong Wu</span>&gt;</div></td><td class="msg-cell">The simulation of events with promise is not an exact simulation though, particularly about the execution time of the handlers. Promises forces deferral of the handler execution time. Another common pitfall is that <code>event.preventDefault()</code> does not work after <code>await</code></td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Tue Nov 18 2025 19:35:20 GMT-0800 (Pacific Standard Time)">03:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@stephenhicks:matrix.org">Steve Hicks</span>&gt;</div></td><td class="msg-cell">sorry, I don't mean general-purpose event simulation - but exposing event-like things using promises <em>instead of</em> events because it's a nicer API to code against.  But the mismatch as I see it is that "event-like" things want dispatch context and promises hide that context.  Same situation potentially with these async iteration cleanups - choosing to expose it via a promise may be "isomorphic" in some senses, but with AsyncContext in the mix, it has very real differences.</td></tr>

</tbody></table></div></div></div>
</body></html>