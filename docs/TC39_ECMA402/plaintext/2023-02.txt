2023-02-01
[16:21:14.0933] <sffc>
Hmm, I may be open to considering if DTF *always* throws on ZDT, or perhaps any Temporal object, if the time zone is not undefined, because if you're using Temporal, you shouldn't get your time zone from Intl

[17:37:17.0370] <justingrant>
There are three cases:
- `Instant` - time zone is unknown, so no potential for conflict. `Instant` has the same data model as `Date`, so they should behave identically in `format`.
- `ZonedDateTime` - time zone is known, so there's potential for conflict. This is the focus of the PR linked above. 
- `Plain*` types - time zone is excluded from the data model, so currently the 402 section of the Temporal spec doesn't include the `[[timeZoneName]]` in the [list of supported fields](https://tc39.es/proposal-temporal/#table-temporal-patterns). We could discuss changing this behavior, but IMO this should be a separate PR and discussion.

So the issue at hand is really focused on how to handle `ZonedDateTime` output only. 


[17:42:32.0776] <sffc>
Right. Yeah. So it seems reasonable that Instant always converts to the time zone if the DTF, and ZDT always retains its time zone

[17:43:51.0293] <justingrant>
> <@sffc:mozilla.org> Hmm, I may be open to considering if DTF *always* throws on ZDT, or perhaps any Temporal object, if the time zone is not undefined, because if you're using Temporal, you shouldn't get your time zone from Intl

My main concern is ensuring that, if there's no `timeZone` option specified on the Intl side, then the output of `format` includes the ZDT's time zone. 

What we do if there's also a `timeZone` option on the Intl side is a much lower priority because it seems like it'll be a pretty rare use case. I'm not strongly opposed to your suggestion to always throw in that case, but I'd like to understand your reasoning for why we'd deviate from `calendar` behavior where both are allowed as long as they don't conflict. 

[17:43:54.0509] <sffc>
The only thing I'm unsure about are the implications for data loading. With this model, the DTF needs to be able to select the time zone in the format function, which means all the display names for all time zones need to be available and efficiently indexable 

[17:44:39.0237] <sffc>
Currently, the DTF can do the time zone name lookup in the constructor, which is likely more efficient

[17:49:03.0074] <justingrant>
Is there any choice but to solve this perf problem?  Otherwise, `zonedDateTime.toLocaleString()` would return the system time zone which is never what's intended.

[17:49:13.0632] <justingrant>
 * Is there any choice but to solve this perf problem?  Otherwise, `zonedDateTime.toLocaleString()` would return the system time zone which is never what's intended.

[17:49:24.0241] <sffc>
I'm not sure if that's a real concern; Frank could weigh in. A workaround would be that the time zone must match, a restriction we could later lift. This is fine in toLocaleString.

