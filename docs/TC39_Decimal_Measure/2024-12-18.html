<!DOCTYPE html><html><head>
  <title>TC39 Decimal_Measure on 2024-12-18</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "TC39 Decimal_Measure";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">TC39 Decimal_Measure<br>2024-12-18<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2024-12-17" class="nav-link"><span>prev</span></a>
<a href="2024-12-19" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search TC39 Decimal_Measure">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Tue Dec 17 2024 16:33:27 GMT-0800 (Pacific Standard Time)">00:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I think in Temporal we ended up with the right data model, and we worked out a way to make it not be too "noisy"</blockquote></mx-reply>that’s because everything is only objects there - numbers ideally would eventually be primitives, and we should be designing with that goal in mind.</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Tue Dec 17 2024 17:12:13 GMT-0800 (Pacific Standard Time)">01:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> that’s because everything is only objects there - numbers ideally would eventually be primitives, and we should be designing with that goal in mind.</blockquote></mx-reply>Is there anything in the design that we described that wouldn’t work well with that?</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Tue Dec 17 2024 17:12:42 GMT-0800 (Pacific Standard Time)">01:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">If only the decimal is primitive, and measure is always object</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Tue Dec 17 2024 17:12:53 GMT-0800 (Pacific Standard Time)">01:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">no that would work fine</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Tue Dec 17 2024 17:13:22 GMT-0800 (Pacific Standard Time)">01:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> If only the decimal is primitive, and measure is always object</blockquote></mx-reply>This being the future state, and the initial proposal focusing on the wrappers</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Tue Dec 17 2024 17:13:25 GMT-0800 (Pacific Standard Time)">01:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">(because most people wouldn’t likely use measure except to handle formatting with intl)</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Tue Dec 17 2024 17:14:07 GMT-0800 (Pacific Standard Time)">01:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> (because most people wouldn’t likely use measure except to handle formatting with intl)</blockquote></mx-reply>Arguably people should be doing unit-ed computations all over the place, but I think that is beyond the scope of measure (initially)</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Tue Dec 17 2024 17:14:33 GMT-0800 (Pacific Standard Time)">01:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">Also that isn’t really demonstrated in any other mainstream programming language</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Tue Dec 17 2024 17:15:52 GMT-0800 (Pacific Standard Time)">01:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">Our destiny in TC39 is to be followers, not leaders</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Tue Dec 17 2024 17:16:19 GMT-0800 (Pacific Standard Time)">01:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> This being the future state, and the initial proposal focusing on the wrappers</blockquote></mx-reply>Ljharb: just wanted to check, does this caveat weaken things?</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Tue Dec 17 2024 17:16:44 GMT-0800 (Pacific Standard Time)">01:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">(Within the context of, decimals are canonicalized)</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Tue Dec 17 2024 17:17:33 GMT-0800 (Pacific Standard Time)">01:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">which, the primitives later? I’m def still unconvinced advancing anything without primitives is worth it, but it at least removes my objection on the basis of blocking primitives</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Tue Dec 17 2024 17:18:24 GMT-0800 (Pacific Standard Time)">01:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">Seems like we are at a point of common understanding, which is good</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Tue Dec 17 2024 17:18:48 GMT-0800 (Pacific Standard Time)">01:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">Even if we differ on tradeoffs</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Tue Dec 17 2024 17:36:59 GMT-0800 (Pacific Standard Time)">01:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">Eemeli: do you have remaining concerns about introducing classes as opposed to just using strings or something?</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Wed Dec 18 2024 00:08:09 GMT-0800 (Pacific Standard Time)">08:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell"><p>I don't see how "just using strings" is a viable option for communicating precision, because we already assign meaning to formatting string values:</p>
<pre><code>new Intl.NumberFormat('en').format('1.8000') === '1.8'
new Intl.NumberFormat('en').format({ toString: () =&gt; '1.9000' }) === '1.9'
</code></pre>
<p>Or did you mean something else?</p>
<p>I do not have any qualms about introducing a Measure class. If we do, I think it could well serve many of the use cases presented for Decimal as well.</p>
</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Wed Dec 18 2024 00:09:40 GMT-0800 (Pacific Standard Time)">08:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell"><p>Because Measure doesn't exist, we could (should?) of course define its handling of string values to retain precision, so we'd end up with:</p>
<pre><code>new Intl.NumberFormat('en').format(new Measure('1.8000')) === '1.8000'
</code></pre>
</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Wed Dec 18 2024 00:11:15 GMT-0800 (Pacific Standard Time)">08:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">that looks good -- that matches what I had in mind for measure &amp; NF</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Wed Dec 18 2024 00:12:41 GMT-0800 (Pacific Standard Time)">08:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">also, measure should work with any additional specifiers, such as num-significant-digits or num-fractional-digits, as it works today with strings</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Wed Dec 18 2024 04:13:45 GMT-0800 (Pacific Standard Time)">12:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">Re strings: oops! That was kind of an unforced error; we added that support somewhat recently, though I guess before we had thought much about how exactly decimal should work. Remember, that was already a redefinition, since previously it worked via a cast to number (if that can be counted as working) so I am optimistic that the change can be done in place.</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Wed Dec 18 2024 04:15:07 GMT-0800 (Pacific Standard Time)">12:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">But, Eemeli, can you explain how your position in Shane’s slide deck relates to your current thoughts about what we’ve been discussing in this room?</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Wed Dec 18 2024 04:54:54 GMT-0800 (Pacific Standard Time)">12:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Re strings: oops! That was kind of an unforced error; we added that support somewhat recently, though I guess before we had thought much about how exactly decimal should work. Remember, that was already a redefinition, since previously it worked via a cast to number (if that can be counted as working) so I am optimistic that the change can be done in place.</blockquote></mx-reply>just to make sure I'm clear: do you mean making a normative PR in 402 alongside decimal + measure (whatever form it may take)?</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Wed Dec 18 2024 04:58:10 GMT-0800 (Pacific Standard Time)">12:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> just to make sure I'm clear: do you mean making a normative PR in 402 alongside decimal + measure (whatever form it may take)?</blockquote></mx-reply>Yeah, that’s what this would be, if we want to pursue it. It’s how we got that string logic there in the first place, back when I was at a much earlier stage in pushing decimal</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Wed Dec 18 2024 06:05:58 GMT-0800 (Pacific Standard Time)">14:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">With Measure and Decimal as separate proposals, my sense is that the former answers the question "How do I encapsulate the 'what' separately from the 'how' when formatting numerical values?", while the latter answers "How do I make math work like I expect?"

This seems like a pretty effective and orthogonal separation of concerns, and it allows for the proposals to be evaluated separately. In that evaluation, I very strongly support Measure, but I'm skeptical about non-primitive Decimal.</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Wed Dec 18 2024 06:07:43 GMT-0800 (Pacific Standard Time)">14:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">With a separately provided protocol for formatting, why does Decimal need to be in the spec?</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Wed Dec 18 2024 06:13:14 GMT-0800 (Pacific Standard Time)">14:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">imo measure and decimal are indeed separate beasts (the clearest difference, to my mind, being that arithmetic for decimals should clearly work on day 1 but may not even be necessary for measure, at least not on day 1); I'm neutral on whether they proceed in parallel, or whether they get literally merged</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Wed Dec 18 2024 06:47:49 GMT-0800 (Pacific Standard Time)">14:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">Jesse explained the use cases of decimal in a bunch of TC39 presentations, and it didn't center on formatting (which is largely already solved by the string support for NumberFormat). Was there a part of those presentations that you found unpersuasive?</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Wed Dec 18 2024 06:47:58 GMT-0800 (Pacific Standard Time)">14:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">agree on the orthogonality</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Wed Dec 18 2024 06:55:54 GMT-0800 (Pacific Standard Time)">14:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Jesse explained the use cases of decimal in a bunch of TC39 presentations, and it didn't center on formatting (which is largely already solved by the string support for NumberFormat). Was there a part of those presentations that you found unpersuasive?</blockquote></mx-reply>yeah -- the ide was that decimal provide bread-and-butter formatting, like Number, with <code>toString</code>, <code>toFixed</code>, and <code>toPrecision</code>, with serious formatting needs delegated to <a href="http://Intl.NF">Intl.NF</a></td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Wed Dec 18 2024 08:24:16 GMT-0800 (Pacific Standard Time)">16:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">If we handle the formatting aspects separately and we don't implement Decimal as a primitive, I'm not persuaded that what remains is better than the Decimal libraries already out there, which clearly have been found by many users. The ergonomics aren't improved, and as far as I recall, performance is not presented as a selling point, so what's the remaining value proposition? Why does this problem in particular need to be solved within the spec, when it's already solved outside the spec?</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Wed Dec 18 2024 08:37:43 GMT-0800 (Pacific Standard Time)">16:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">that is not the use case, that is the functionality. You explained the <em>non-formatting-related</em> use cases for Decimal in your presentations.</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Wed Dec 18 2024 08:39:21 GMT-0800 (Pacific Standard Time)">16:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">Part of it is similar to the value proposition of Temporal: primarily, these values are passed between different pieces of code (which have trouble coordinating on using the same library), and secondarily, while we're at it, we're doing an especially careful and good job of designing this library, so it levels up the ecosystem.</td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Wed Dec 18 2024 08:40:30 GMT-0800 (Pacific Standard Time)">16:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">If, again, performance isn't a selling point, isn't a numerical string a really good interchange format for decimal values?</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Wed Dec 18 2024 08:40:49 GMT-0800 (Pacific Standard Time)">16:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">no, for the reasons that Nicolo explained</td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Wed Dec 18 2024 08:41:23 GMT-0800 (Pacific Standard Time)">16:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">it is a poor interchange format since the second thing people will want to do with them (after formatting) is arithmetic operations, and that will immediately be silently buggy with strings.</td></tr>
  <tr class="msg" id="L35"><td class="ts-cell"><a class="ts" href="#L35" alt="Wed Dec 18 2024 08:42:35 GMT-0800 (Pacific Standard Time)">16:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">so, this was my question, how should we analyze this concern and come to some kind of shared conclusion?</td></tr>
  <tr class="msg" id="L36"><td class="ts-cell"><a class="ts" href="#L36" alt="Wed Dec 18 2024 09:29:20 GMT-0800 (Pacific Standard Time)">17:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell"><p>First, it'd be really nice if the proposal repo reflected the benefits of decimal-in-spec over decimal-in-libraries, which is the status quo. At the moment, the spec readme lists three use cases:</p>
<ol>
<li>Representing human-readable decimal values such as money</li>
<li>Data exchange [...] with external systems, such as databases and foreign function interfaces to other programming languages</li>
<li>Numerical calculations on more precise floats</li>
</ol>
<p>Each of those use cases can be addressed equally well by MikeMcl's libraries.</p>
<p>The value propositions that you put forward here don't appear in the readme at all, and neither the FAQ nor the "Known alternatives" sections answer the question "Why not a library?"</p>
<p>So could the readme be revised to present the current arguments for the proposal not as if decimals weren't supported at all by the ecosystem, but instead showing how defining Decimal in the spec is an improvement on them? I understand that some of these arguments are certainly included in some of the Decimal presentations, but there's been 11 of those so far, and that's a lot of slides and discussions to look through.</p>
<p>I at least look primarily at the proposal repo readme as the source of truth on what a proposal is about, and expect the presentations and discussions to be reflections of some of its aspects. If/as the Decimal readme doesn't seem to answer the questions I have, I may well not think e.g. of your valid point about string "summation" really being concatenation, and not see the value being presented.</p>
</td></tr>

</tbody></table></div></div></div>
</body></html>