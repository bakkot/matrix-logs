<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>TC39 Decimal_Measure on 2025-04-10</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "TC39 Decimal_Measure";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">TC39 Decimal_Measure<br>2025-04-10<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2025-04-09" class="nav-link"><span>prev</span></a>
<span style="float:right">next</span>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search TC39 Decimal_Measure">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Wed Apr 09 2025 22:31:05 GMT-0700 (Pacific Daylight Time)">05:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell"><p>Niocolo's reply does answer my questions, but it doesn't really make me happy about <code>Decimal.Amount</code>. According to the current version of the slides it's described as:</p>
<blockquote>
<p>Today, we propose a new <code>Decimal.Amount</code> primordial for storing a (1) decimal value (2) with a precision (3) but without a unit.</p>
</blockquote>
<p>That last part in particular seems rather novel and surprising, and I can't find any mention of such an approach in the repo or meeting notes. I proposed the term "amount" as an alternative for "measure", but now it's being taken up as a part of Decimal and won't include any units?</p>
</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Wed Apr 09 2025 22:39:36 GMT-0700 (Pacific Daylight Time)">05:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@sffc:mozilla.org">sffc</span>&gt;</div></td><td class="msg-cell">My mental model of <code>Decimal.Amount</code> is that it contains both a precision and a unit. I just looked at Jesse's updated slides and they are proposing a specific shape I haven't seen before.</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Wed Apr 09 2025 22:46:40 GMT-0700 (Pacific Daylight Time)">05:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@sffc:mozilla.org">sffc</span>&gt;</div></td><td class="msg-cell">I don't agree with the framing of the motivation on slide 4. There wasn't consensus that the proposals remain separate; I would describe it as skepticism raised by some delegates that the use cases were similar enough to merge them.</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Wed Apr 09 2025 22:50:33 GMT-0700 (Pacific Daylight Time)">05:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@sffc:mozilla.org">sffc</span>&gt;</div></td><td class="msg-cell">We should highlight that we took home the feedback about building a <em>protocol</em>, and we investigated it. We found, however, that only the primordial brings immutability, ergonomics, and interoperability to the table. To address the feedback about a top-level <code>Amount</code> not seeming well-motivated, we are coming with an updated proposal that scopes the primordial under <code>Decimal.Amount</code>, to make clear that this is a type that is designed to live in the Decimal universe.</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Wed Apr 09 2025 23:57:22 GMT-0700 (Pacific Daylight Time)">06:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">why would "amount" include a unit?</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Wed Apr 09 2025 23:57:31 GMT-0700 (Pacific Daylight Time)">06:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">amount to me is like a magnitude, it's unitless</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Thu Apr 10 2025 00:09:25 GMT-0700 (Pacific Daylight Time)">07:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> why would "amount" include a unit?</blockquote></mx-reply><p>The idea is that:</p>
<ul>
<li>
<p>the decimal proposal introduces plain decimals, exactly as it was for the past year</p>
</li>
<li>
<p>for good Intl integration and to be able to fully represent external decimal128 values, the proposal also introduced an object that lets you represent a (decimal,precision) pair. This object doesn't support any operations, it's just some data payload + a comparison function. It has a prototype, to put the function on it, as well as things like .toLocaleString.</p>
</li>
<li>
<p>the measure proposal needs a way to define an (object,precision,unit): given that for the other proposal we are defining (object,precision) already, this proposal can just add the unit there.</p>
</li>
</ul>
<p>Whether it's called Amount, Measure, or something else doesn't really matter for now â€” if we have .to/.with/.someThing else methods to get to it, we could even not expose the constructor at all (like we don't expose ArrayIterator). Although this is more like a nuclear option, because people will give a name to these objects and we are in a position to direct that.</p></td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Thu Apr 10 2025 00:10:50 GMT-0700 (Pacific Daylight Time)">07:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">Oh well I give up on formatting this as a list</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Thu Apr 10 2025 00:12:34 GMT-0700 (Pacific Daylight Time)">07:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@sffc:mozilla.org">sffc</span>&gt;</div></td><td class="msg-cell">I was proposing that <code>Decimal.Amount</code> adds both precision and unit. There is no middle intermediate type; it is just a <code>Decimal.Amount</code> with a null unit. Some delegates were already skeptical of adding 1 type, so I didn't want to push my luck with 2 types (and then we'd have to name them), plus Luca pointed out that there isn't really any JS duck-typing advantage to distinguishing "null unit" from "type does not support a unit". So it seems simplest to keep them as one type.</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Thu Apr 10 2025 00:13:45 GMT-0700 (Pacific Daylight Time)">07:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">Yes I've been convinced that we should have them as a single object. The .unit should be on the Decimal.Amount object, and not on a third new one.</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Thu Apr 10 2025 00:14:10 GMT-0700 (Pacific Daylight Time)">07:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">This is unrelated to how the proposals are merged/split though, a proposal can add a property/field on an existing object </td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Thu Apr 10 2025 00:15:24 GMT-0700 (Pacific Daylight Time)">07:15</a></td><td class="nick-cell"><div class="m-ov"><span class="nick nick-16" title="@sffc:mozilla.org">sffc</span></div></td><td class="msg-cell">verifies that the Decimal.Amount OP does indeed state that the unit is in the data model of Decimal.Amount</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Thu Apr 10 2025 00:16:36 GMT-0700 (Pacific Daylight Time)">07:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@sffc:mozilla.org">sffc</span>&gt;</div></td><td class="msg-cell">I see</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Thu Apr 10 2025 00:16:59 GMT-0700 (Pacific Daylight Time)">07:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">Yes I double-checked yesterday too :)

My mental model of the end state matches exactly what you described there</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Thu Apr 10 2025 00:17:29 GMT-0700 (Pacific Daylight Time)">07:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@sffc:mozilla.org">sffc</span>&gt;</div></td><td class="msg-cell">If you think removing the unit field from my formulation of <code>Decimal.Amount</code> is more likely to make it palatable in the short term for Stage 2 purposes... okay with me. Not sure about Eemeli.</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Thu Apr 10 2025 00:19:01 GMT-0700 (Pacific Daylight Time)">07:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">I think it's not only good for decimal (keeping the proposal focused on its goal), but it also makes life easier for proposal-that-adds-the-unit: there is no new object to justify, it's just adding a field on an existing one</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Thu Apr 10 2025 00:20:32 GMT-0700 (Pacific Daylight Time)">07:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">And I think Decimal.Amount should be justified entirely on Intl integration and interop with external systems, without saying "it will be _needed_ to add units", even though we must make it clear from the beginning that the plan is the other proposal will slot into that</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Thu Apr 10 2025 00:23:58 GMT-0700 (Pacific Daylight Time)">07:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">A question I have for <span class="nick-9">@eemeli:mozilla.org</span> is: you expressed disappointment with entangling the two proposals in the past. If plain Decimal was much further ahead in the process than Measure (or if decimal was already stage 4!), would you be ok with this design?</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Thu Apr 10 2025 00:58:00 GMT-0700 (Pacific Daylight Time)">07:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell"><p>I continue to think that trying to intermingle these proposals is making the whole situation less rather than more clear. Is "this design" the following?</p>
<ul>
<li>A <code>Decimal</code> would not carry any precision information.</li>
<li>The decimal proposal introduces <code>Decimal.Amount</code> as an object that carries precision information, but does not support mathematical operations.</li>
<li>The measure proposal adds <code>unit</code> to <code>Decimal.Amount</code>.</li>
</ul>
</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Thu Apr 10 2025 01:13:16 GMT-0700 (Pacific Daylight Time)">08:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">Yes</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Thu Apr 10 2025 01:34:53 GMT-0700 (Pacific Daylight Time)">08:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell"><p>Ok, then in a hypothetical future where something like <code>Decimal.Amount</code> was already stage 3 or 4, then it would indeed be obvious for measure to be adding <code>unit</code> to it. But this is not where we are now, and I don't see the value of the question. More significantly, I don't understand why <code>Decimal.Amount</code> needs to be included in the decimal proposal, if <code>Decimal</code> itself will not carry precision information.</p>
<p>In the current slides, the motivation and use cases for <code>Decimal</code> and <code>Decimal.Amount</code> appear to be orthogonal, with the former serving data exchange, while the latter is for formatting values with precision. Why are both of these mixed into the decimal proposal?</p>
<p>Would it not be simpler to have one proposal (decimal) providing a solution for data exchange, and another proposal (measure) providing a solution for formatting values with precision?</p>
</td></tr>

</tbody></table></div></div></div>
</body></html>