<!DOCTYPE html><html><head>
  <title>TC39 Decimal_Measure on 2025-02-12</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "TC39 Decimal_Measure";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">TC39 Decimal_Measure<br>2025-02-12<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2025-01-22" class="nav-link"><span>prev</span></a>
<span style="float:right">next</span>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search TC39 Decimal_Measure">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Wed Feb 12 2025 03:42:51 GMT-0800 (Pacific Standard Time)">11:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell"><p>Looking over and considering <span class="nick-16">Jesse</span>'s upcoming Decimal/Measure presentation and explainer, I get the sense that we really ought to find a way to reach the end goals here in multiple smaller steps, rather than one big leap. By Decimal normalising trailing zeros, the use cases for them introduce a dependency on Measure, but it gets a bit hairy if Measure then also depends on Decimal for its value representation.</p>
<p>What if we were to initially not include <em>any</em> conversions in Measure? Then we wouldn't need to change its inputs at all, and we would still be providing a way for Intl.NumberFormat and Intl.MessageFormat to get their formattable inputs as a combined value+units+precision package.</p>
<p>Then we could consider separately the Smart Units part of this whole thing adding unit conversions, and Decimal defining its accessors on Measure, and we'd avoid having everythin depend on everything else.</p>
</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Wed Feb 12 2025 04:11:38 GMT-0800 (Pacific Standard Time)">12:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">Here's a sketch of what that might look like: <a href="https://gist.github.com/eemeli/0bd413d2f711cbd6016673af8d68c38c">https://gist.github.com/eemeli/0bd413d2f711cbd6016673af8d68c38c</a>

That's in TS, so the real thing would need to have appropriate runtime checks for the types. The lack of any methods on the class is quite intentional, as is freezing it.

I'm also starting to think that we might want to call this "Amount" rather than "Measure", mostly because then it also makes sense for currencies: it feels really clumsy to talk of a "measure of money", whereas an "amount of money" (or anything else, really) makes more sense.</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Wed Feb 12 2025 04:17:23 GMT-0800 (Pacific Standard Time)">12:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">thanks!</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Wed Feb 12 2025 04:18:49 GMT-0800 (Pacific Standard Time)">12:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">happy to discuss another name</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Wed Feb 12 2025 04:19:34 GMT-0800 (Pacific Standard Time)">12:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">"measure" suggests physical quantities and (it feels like) is excludes currencies; "amount" clearly includes currencies but (to my mind) weakly excludes other kinds of measurements</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Wed Feb 12 2025 04:22:29 GMT-0800 (Pacific Standard Time)">12:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">shouldn't we have a toLocaleString or at least toString in Amounts?</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Wed Feb 12 2025 04:29:36 GMT-0800 (Pacific Standard Time)">12:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">I wonder if want to tie in to ISO 4217 (standardization of currencies) somehow or whether measure/amount is merely any tagged number (or string, or bigint) at all</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Wed Feb 12 2025 04:30:09 GMT-0800 (Pacific Standard Time)">12:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell"><code>new Amount(42.75, "foobar gramz")</code></td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Wed Feb 12 2025 04:30:55 GMT-0800 (Pacific Standard Time)">12:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">I like the simplicity of the zero-method approach but I wonder if this deflates the value-add too much</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Wed Feb 12 2025 04:31:28 GMT-0800 (Pacific Standard Time)">12:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">one of the nice value-add parts of measure, to my mind, was its tie-in to CLDR's units.xml</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Wed Feb 12 2025 04:31:49 GMT-0800 (Pacific Standard Time)">12:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">exposing new capabilities to the language, rather than merely attaching a string to a number</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Wed Feb 12 2025 04:43:30 GMT-0800 (Pacific Standard Time)">12:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">I would argue that e.g. "3 meters" or "42 grams" are both also "amounts", whereas calling those "measures" or "measurements" would be more opinionated about how the figure was reached.</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Wed Feb 12 2025 04:44:28 GMT-0800 (Pacific Standard Time)">12:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">toLocaleString potentially yes, delegating to Intl.NumberFormat. Not at all so sure about toString; what would be the use case for it?</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Wed Feb 12 2025 04:45:44 GMT-0800 (Pacific Standard Time)">12:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">I think that's a question that would be best answered within a more general currency formatting context, as any answer here ought to match the answer given by Intl.NumberFormat.</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Wed Feb 12 2025 04:47:57 GMT-0800 (Pacific Standard Time)">12:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">I agree that conversion is nice, but I think it's also complicated -- and has its own Stage 1 proposal: <a href="https://github.com/tc39/proposal-smart-unit-preferences">https://github.com/tc39/proposal-smart-unit-preferences</a></td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Wed Feb 12 2025 04:57:08 GMT-0800 (Pacific Standard Time)">12:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">ah, right</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Wed Feb 12 2025 04:57:27 GMT-0800 (Pacific Standard Time)">12:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">I wonder if the harmony under discussion should also include smart units</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Wed Feb 12 2025 04:57:39 GMT-0800 (Pacific Standard Time)">12:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">the current measure README explicitly refers to smart units</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Wed Feb 12 2025 05:03:06 GMT-0800 (Pacific Standard Time)">13:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell"><p>Yeah, there's a continuum of (at least) three separate considerations here that we're trying to solve:</p>
<ul>
<li>How to represent a number together with its unit/currency/precision (Measure/Amount)</li>
<li>How to convert values between compatible units (Smart Units)</li>
<li>How to represent numbers better (Decimal)</li>
</ul>
<p>I think Decimal depends on Amount, and unit conversion <em>might</em> depend on Decimal if that's the chosen type for the value of an Amount after conversion. So I'm looking for a way to solve the first problem in a way that doesn't require simultaneously solving all the problems and introducing all of these cross-dependencies.</p>
</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Wed Feb 12 2025 05:09:12 GMT-0800 (Pacific Standard Time)">13:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">I like the suggestion to use decimal as the result of doing conversions</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Wed Feb 12 2025 05:09:49 GMT-0800 (Pacific Standard Time)">13:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">these typically involve things like taking reciporocals or multiplying values (including squaring, cubing, etc.) so decimal feels like a good match</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Wed Feb 12 2025 05:10:06 GMT-0800 (Pacific Standard Time)">13:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">since it's promise is to provide more precision</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Wed Feb 12 2025 05:10:31 GMT-0800 (Pacific Standard Time)">13:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell"><p>The cleanest way that I see for this stack to proceed would be:</p>
<ol>
<li>Amount</li>
<li>Decimal</li>
<li>Unit conversions</li>
</ol>
<p>Then each step would only depend on things before it.</p>
</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Wed Feb 12 2025 05:12:57 GMT-0800 (Pacific Standard Time)">13:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">that looks good -- I'd like to see decimal building on amount/measure so I think it makes sense to focus on amount</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Wed Feb 12 2025 05:42:33 GMT-0800 (Pacific Standard Time)">13:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">I think given the amount of interest in these topics it might make sense to set up a regular call for decimal, measure/amount, and smart units</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Wed Feb 12 2025 05:43:27 GMT-0800 (Pacific Standard Time)">13:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">things are sort of scattered atm -- I've discussed this stuff in TG2, TG3, in plenary, in this channel, and (to a much lesser extent) the delegates channel</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Wed Feb 12 2025 05:44:59 GMT-0800 (Pacific Standard Time)">13:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">how about tomorrow (Thursday, February 13th) at, say, 18:00 CET?</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Wed Feb 12 2025 05:58:07 GMT-0800 (Pacific Standard Time)">13:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">I'm glad that we're laying out the whole space, but let's see if we can keep the result, or at least the first step, not too complex.</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Wed Feb 12 2025 06:00:33 GMT-0800 (Pacific Standard Time)">14:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">I'm sold on the need for a unit'ed Measure class, but I don't know why we'd have a third class</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Wed Feb 12 2025 06:01:14 GMT-0800 (Pacific Standard Time)">14:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">or is Amount just a way to rename Measure?</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Wed Feb 12 2025 06:01:47 GMT-0800 (Pacific Standard Time)">14:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">sorry maybe this was just me skimming too fast and the proposal is already good :)</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Wed Feb 12 2025 06:02:21 GMT-0800 (Pacific Standard Time)">14:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">I think the current thinking is that amount is just a renaming of measure</td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Wed Feb 12 2025 06:02:35 GMT-0800 (Pacific Standard Time)">14:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">plus a certain shrinking of its scope</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Wed Feb 12 2025 06:04:01 GMT-0800 (Pacific Standard Time)">14:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">there was a discussion in various places about whether measure/amount should support arithmetic, at all, and the consensus seems to be "no"; the most recent sketch is of a class that has no methods at all (except possibly toLocaleString)</td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Wed Feb 12 2025 06:04:47 GMT-0800 (Pacific Standard Time)">14:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">I can see the argument for arithmetic, but it's really complicated, and having the base type exist facilitates people writing libraries to do that. (Of course the same could be said for Temporal)</td></tr>
  <tr class="msg" id="L35"><td class="ts-cell"><a class="ts" href="#L35" alt="Wed Feb 12 2025 06:05:23 GMT-0800 (Pacific Standard Time)">14:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@sffc:mozilla.org">sffc</span>&gt;</div></td><td class="msg-cell">(I can join tomorrow at 18:00 CET, or earlier)</td></tr>
  <tr class="msg" id="L36"><td class="ts-cell"><a class="ts" href="#L36" alt="Wed Feb 12 2025 06:05:44 GMT-0800 (Pacific Standard Time)">14:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">I'd expect (citation needed!) that keeping it to one numerical type is probably simpler implementation-wise, but 3 classes vs one class with multiple possibilities for the value's type doesn't really simplify anything.</td></tr>
  <tr class="msg" id="L37"><td class="ts-cell"><a class="ts" href="#L37" alt="Wed Feb 12 2025 06:05:45 GMT-0800 (Pacific Standard Time)">14:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell"> Personally I don't mind Measure baking in Decimal (since measured quantities are very often decimals, and other numeric types might just be used in error)</td></tr>
  <tr class="msg" id="L38"><td class="ts-cell"><a class="ts" href="#L38" alt="Wed Feb 12 2025 06:08:11 GMT-0800 (Pacific Standard Time)">14:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">to my mind there are a couple senses of "arithmetic" -- 1. adding (or multiplying, or ...) two measure objects; and (2) converting to a "higher-order" unit, such as going from meter to meter^3 and converting between compatible scales (meters and inches)</td></tr>
  <tr class="msg" id="L39"><td class="ts-cell"><a class="ts" href="#L39" alt="Wed Feb 12 2025 06:08:33 GMT-0800 (Pacific Standard Time)">14:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">my understanding is that (1) is currently not very well received, but I'm not sure about (2)</td></tr>
  <tr class="msg" id="L40"><td class="ts-cell"><a class="ts" href="#L40" alt="Wed Feb 12 2025 06:09:08 GMT-0800 (Pacific Standard Time)">14:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@sffc:mozilla.org">sffc</span>&gt;</div></td><td class="msg-cell">Just looked at Jesse's slides. They look like exactly the kind of conversation I think we should be having right now. 👍️</td></tr>
  <tr class="msg" id="L41"><td class="ts-cell"><a class="ts" href="#L41" alt="Wed Feb 12 2025 06:10:10 GMT-0800 (Pacific Standard Time)">14:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">Yeah, "Amount" is effectively a synonym "Measure".</td></tr>
  <tr class="msg" id="L42"><td class="ts-cell"><a class="ts" href="#L42" alt="Wed Feb 12 2025 06:10:36 GMT-0800 (Pacific Standard Time)">14:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote>  Personally I don't mind Measure baking in Decimal (since measured quantities are very often decimals, and other numeric types might just be used in error)</blockquote></mx-reply>agree, though I can see the value in rolling just with currently existing primitive types</td></tr>
  <tr class="msg" id="L43"><td class="ts-cell"><a class="ts" href="#L43" alt="Wed Feb 12 2025 06:11:01 GMT-0800 (Pacific Standard Time)">14:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">(one could go even further an imagine supporting only Number)</td></tr>
  <tr class="msg" id="L44"><td class="ts-cell"><a class="ts" href="#L44" alt="Wed Feb 12 2025 06:13:24 GMT-0800 (Pacific Standard Time)">14:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">As I see it, the primary utility gained from a minimal Amount/Measure is in the improvements of the Intl.NumberFormat API, and so it'd be rather suprising if <code>new Amount('42')</code> or <code>new Amount(42)</code> would not work.</td></tr>
  <tr class="msg" id="L45"><td class="ts-cell"><a class="ts" href="#L45" alt="Wed Feb 12 2025 06:13:53 GMT-0800 (Pacific Standard Time)">14:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">Given that calling <code>nf.format('42')</code> or <code>nf.format(42)</code> works.</td></tr>
  <tr class="msg" id="L46"><td class="ts-cell"><a class="ts" href="#L46" alt="Wed Feb 12 2025 06:14:36 GMT-0800 (Pacific Standard Time)">14:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">Well, we could apply the <code>new Decimal</code> logic in the Measure constructor</td></tr>
  <tr class="msg" id="L47"><td class="ts-cell"><a class="ts" href="#L47" alt="Wed Feb 12 2025 06:14:41 GMT-0800 (Pacific Standard Time)">14:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">for casting</td></tr>
  <tr class="msg" id="L48"><td class="ts-cell"><a class="ts" href="#L48" alt="Wed Feb 12 2025 06:15:00 GMT-0800 (Pacific Standard Time)">14:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">Huh, just realised as I typed that that <code>new Amount(42)</code> doesn't feel as wrong as <code>new Measure(42)</code> does, i.e. without the options.</td></tr>
  <tr class="msg" id="L49"><td class="ts-cell"><a class="ts" href="#L49" alt="Wed Feb 12 2025 06:15:29 GMT-0800 (Pacific Standard Time)">14:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">(I like the name <code>Measure</code>)</td></tr>
  <tr class="msg" id="L50"><td class="ts-cell"><a class="ts" href="#L50" alt="Wed Feb 12 2025 06:16:11 GMT-0800 (Pacific Standard Time)">14:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">Why should <code>new Amount(x).value === x</code> not be retained? Something like <code>new Amount(x).asDecimal()</code> could be a thing, but there's no reason to throw away the original input value.</td></tr>
  <tr class="msg" id="L51"><td class="ts-cell"><a class="ts" href="#L51" alt="Wed Feb 12 2025 06:17:05 GMT-0800 (Pacific Standard Time)">14:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Well, we could apply the <code>new Decimal</code> logic in the Measure constructor</blockquote></mx-reply>I like that idea too but I've heard from a couple people that they'd like to use bigints in measures/amounts, and I'm a bit uncomfortable with going beyond the range of Decimal128</td></tr>
  <tr class="msg" id="L52"><td class="ts-cell"><a class="ts" href="#L52" alt="Wed Feb 12 2025 06:20:27 GMT-0800 (Pacific Standard Time)">14:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">I've made a new calendar item PR but it's not merged yet</td></tr>
  <tr class="msg" id="L53"><td class="ts-cell"><a class="ts" href="#L53" alt="Wed Feb 12 2025 06:20:43 GMT-0800 (Pacific Standard Time)">14:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell"><a href="https://github.com/tc39/Reflector/issues/551">https://github.com/tc39/Reflector/issues/551</a></td></tr>
  <tr class="msg" id="L54"><td class="ts-cell"><a class="ts" href="#L54" alt="Wed Feb 12 2025 06:23:36 GMT-0800 (Pacific Standard Time)">14:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">I should be able to make that time as well.</td></tr>
  <tr class="msg" id="L55"><td class="ts-cell"><a class="ts" href="#L55" alt="Wed Feb 12 2025 06:24:32 GMT-0800 (Pacific Standard Time)">14:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">I'd appreciate a calendar invite at eemeli@mozilla.com for the meeting, once such is available.</td></tr>
  <tr class="msg" id="L56"><td class="ts-cell"><a class="ts" href="#L56" alt="Wed Feb 12 2025 06:37:22 GMT-0800 (Pacific Standard Time)">14:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">why is this identity important?</td></tr>
  <tr class="msg" id="L57"><td class="ts-cell"><a class="ts" href="#L57" alt="Wed Feb 12 2025 06:45:40 GMT-0800 (Pacific Standard Time)">14:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">Because it would be surprising for that identity not to hold, and because it makes it straightforward to support all the same types that are supported by Intl.NumberFormat.</td></tr>
  <tr class="msg" id="L58"><td class="ts-cell"><a class="ts" href="#L58" alt="Wed Feb 12 2025 06:48:46 GMT-0800 (Pacific Standard Time)">14:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell"><p>I'm not so sure that it's important for the value type to be retained after e.g. conversion. So something like</p>
<pre><code>new Amount(42, { unit: 'meter' }).convertTo('foot-and-inch').value
</code></pre>
<p>could well be a Decimal. Which is why I think we ought to do Amount first, then Decimal, then unit conversions. That way each step only depends on previous work.</p>
</td></tr>
  <tr class="msg" id="L59"><td class="ts-cell"><a class="ts" href="#L59" alt="Wed Feb 12 2025 06:51:46 GMT-0800 (Pacific Standard Time)">14:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">I think I'm favor having something like an <code>.asDecimal</code> method, to make any conversion explicit</td></tr>
  <tr class="msg" id="L60"><td class="ts-cell"><a class="ts" href="#L60" alt="Wed Feb 12 2025 06:54:54 GMT-0800 (Pacific Standard Time)">14:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">I added a <code>.toLocaleString()</code> to the gist.</td></tr>
  <tr class="msg" id="L61"><td class="ts-cell"><a class="ts" href="#L61" alt="Wed Feb 12 2025 06:58:48 GMT-0800 (Pacific Standard Time)">14:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">I don't really feel like "this identity is intuitive" is a strong enough reason to make the data model more complex. I'd want to see a use case where you really want the representation to be something other than Decimal.</td></tr>
  <tr class="msg" id="L62"><td class="ts-cell"><a class="ts" href="#L62" alt="Wed Feb 12 2025 06:59:01 GMT-0800 (Pacific Standard Time)">14:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">(yes, more flexible is more complex)</td></tr>
  <tr class="msg" id="L63"><td class="ts-cell"><a class="ts" href="#L63" alt="Wed Feb 12 2025 06:59:38 GMT-0800 (Pacific Standard Time)">14:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">that only makes sense if the underlying data model is flexible among types</td></tr>
  <tr class="msg" id="L64"><td class="ts-cell"><a class="ts" href="#L64" alt="Wed Feb 12 2025 07:02:52 GMT-0800 (Pacific Standard Time)">15:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I don't really feel like "this identity is intuitive" is a strong enough reason to make the data model more complex. I'd want to see a use case where you really want the representation to be something other than Decimal.</blockquote></mx-reply>I've heard Mark want to use measure/amount to represent values of cryptocurrencies where one has a huge number of significant digits (beyond what can be faithfully represented in Decimal128)</td></tr>
  <tr class="msg" id="L65"><td class="ts-cell"><a class="ts" href="#L65" alt="Wed Feb 12 2025 07:03:39 GMT-0800 (Pacific Standard Time)">15:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">so I think for him being able to get the original value (in his case, a bigint) would be important</td></tr>
  <tr class="msg" id="L66"><td class="ts-cell"><a class="ts" href="#L66" alt="Wed Feb 12 2025 07:06:55 GMT-0800 (Pacific Standard Time)">15:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">I don't understand why cryptocurrencies need more than 34 significant digits. Maybe they forgot that it's floating point rather than fixed point?</td></tr>
  <tr class="msg" id="L67"><td class="ts-cell"><a class="ts" href="#L67" alt="Wed Feb 12 2025 07:07:40 GMT-0800 (Pacific Standard Time)">15:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">anyway sounds like an argument for BigDecimal over Decimal128; this is the wrong level to make that change IMO</td></tr>
  <tr class="msg" id="L68"><td class="ts-cell"><a class="ts" href="#L68" alt="Wed Feb 12 2025 07:07:40 GMT-0800 (Pacific Standard Time)">15:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">I also didn't push him on that; the cryptocurrencies I know don't use that many digits, but MM works in this space so I didn't push</td></tr>
  <tr class="msg" id="L69"><td class="ts-cell"><a class="ts" href="#L69" alt="Wed Feb 12 2025 07:08:08 GMT-0800 (Pacific Standard Time)">15:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">FWIW the Ethereum VM uses Decimal256</td></tr>
  <tr class="msg" id="L70"><td class="ts-cell"><a class="ts" href="#L70" alt="Wed Feb 12 2025 07:08:31 GMT-0800 (Pacific Standard Time)">15:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">so I guess they foresee a need for a vast number of digits</td></tr>
  <tr class="msg" id="L71"><td class="ts-cell"><a class="ts" href="#L71" alt="Wed Feb 12 2025 07:08:56 GMT-0800 (Pacific Standard Time)">15:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">sure... idk I think this use case needs to be pushed on before we make a complexity-increasing decision on that basis</td></tr>
  <tr class="msg" id="L72"><td class="ts-cell"><a class="ts" href="#L72" alt="Wed Feb 12 2025 07:09:17 GMT-0800 (Pacific Standard Time)">15:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">right, I'm not familia with any other use case where such range is needed</td></tr>
  <tr class="msg" id="L73"><td class="ts-cell"><a class="ts" href="#L73" alt="Wed Feb 12 2025 07:09:21 GMT-0800 (Pacific Standard Time)">15:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">you can always just not use this library</td></tr>
  <tr class="msg" id="L74"><td class="ts-cell"><a class="ts" href="#L74" alt="Wed Feb 12 2025 07:09:30 GMT-0800 (Pacific Standard Time)">15:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">(and you can always fall back on Intl.NumberFormat taking strings)</td></tr>
  <tr class="msg" id="L75"><td class="ts-cell"><a class="ts" href="#L75" alt="Wed Feb 12 2025 07:12:41 GMT-0800 (Pacific Standard Time)">15:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">Decimal128 also seems to be the upper limit, today, of out-of-the-box compiler support, which is another indicator that 128 bits should be enough</td></tr>
  <tr class="msg" id="L76"><td class="ts-cell"><a class="ts" href="#L76" alt="Wed Feb 12 2025 07:13:11 GMT-0800 (Pacific Standard Time)">15:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">I like the argument that if 34 significant digits isn't enough, there are other ways to get what you want</td></tr>
  <tr class="msg" id="L77"><td class="ts-cell"><a class="ts" href="#L77" alt="Wed Feb 12 2025 07:13:37 GMT-0800 (Pacific Standard Time)">15:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">I don't think compiler support is extremely relevant. This is more of a library thing. Anyway IEEE defines up to 128.</td></tr>
  <tr class="msg" id="L78"><td class="ts-cell"><a class="ts" href="#L78" alt="Wed Feb 12 2025 07:48:36 GMT-0800 (Pacific Standard Time)">15:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">If there's a need to do anything with the value, that's easier if it's a number, because then you can use <code>+</code> <code>-</code> <code>*</code> <code>/</code> etc. If my use case doesn't need the full 128 bits of precision, then a Decimal value would be clumsier to use.</td></tr>
  <tr class="msg" id="L79"><td class="ts-cell"><a class="ts" href="#L79" alt="Wed Feb 12 2025 07:49:24 GMT-0800 (Pacific Standard Time)">15:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">I would be open to removing the <code>.value</code> accessor, and including something like <code>.asNumber()</code>.</td></tr>
  <tr class="msg" id="L80"><td class="ts-cell"><a class="ts" href="#L80" alt="Wed Feb 12 2025 07:50:20 GMT-0800 (Pacific Standard Time)">15:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">That would make adding a <code>.asDecimal()</code> later rather straightforward.</td></tr>
  <tr class="msg" id="L81"><td class="ts-cell"><a class="ts" href="#L81" alt="Wed Feb 12 2025 07:55:04 GMT-0800 (Pacific Standard Time)">15:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">do you have an example of a case where that's a valid, rather than buggy, thing to do?</td></tr>
  <tr class="msg" id="L82"><td class="ts-cell"><a class="ts" href="#L82" alt="Wed Feb 12 2025 07:55:37 GMT-0800 (Pacific Standard Time)">15:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">the design of Decimal is based on the hope that its methods <em>won't</em> be too clumsy to use in practice</td></tr>
  <tr class="msg" id="L83"><td class="ts-cell"><a class="ts" href="#L83" alt="Wed Feb 12 2025 07:56:36 GMT-0800 (Pacific Standard Time)">15:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">I don't understand the argument for getting rid of an accessor for the value. IMO we should just decide on the data model and then represent it directly; no need to hide it.</td></tr>
  <tr class="msg" id="L84"><td class="ts-cell"><a class="ts" href="#L84" alt="Wed Feb 12 2025 08:06:08 GMT-0800 (Pacific Standard Time)">16:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell"><p>I see enforcing the Amount value to be a Decimal to be unnecessary complexity, because that's not needed when Amount is used when passing it between user code, <em>or</em> when passing it to Intl.NumberFormat. I would also like to not make Amount conditional on Decimal, because that seems unnecessary. The primary direct use case for it that I have in mind is Intl.NumberFormat, and for that it'd be fine if it was just an opaque blob.</p>
<p>It would be <em>nice</em> if it was also useful for passing between user code, but if that requires reaching consensus on Decimal, then I would much prefer introducing it as a part of that consensus.</p>
</td></tr>
  <tr class="msg" id="L85"><td class="ts-cell"><a class="ts" href="#L85" alt="Wed Feb 12 2025 08:09:37 GMT-0800 (Pacific Standard Time)">16:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">OK, sounds like there aren't any particular use cases, and we just disagree on what "simpler" means</td></tr>
  <tr class="msg" id="L86"><td class="ts-cell"><a class="ts" href="#L86" alt="Wed Feb 12 2025 08:09:51 GMT-0800 (Pacific Standard Time)">16:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">but I do think we can work these details out after getting consensus on the broader plan overall</td></tr>
  <tr class="msg" id="L87"><td class="ts-cell"><a class="ts" href="#L87" alt="Wed Feb 12 2025 08:11:26 GMT-0800 (Pacific Standard Time)">16:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">Are there any particular use cases that would explicitly benefit from having the value as a Decimal?</td></tr>
  <tr class="msg" id="L88"><td class="ts-cell"><a class="ts" href="#L88" alt="Wed Feb 12 2025 08:12:12 GMT-0800 (Pacific Standard Time)">16:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">well, if given a Measure as a parameter, then you know which type you get out of <code>.value</code>, and you know that you're not changing the value when accessing it as a decimal. So it becomes easier to use reliably.</td></tr>
  <tr class="msg" id="L89"><td class="ts-cell"><a class="ts" href="#L89" alt="Wed Feb 12 2025 08:13:21 GMT-0800 (Pacific Standard Time)">16:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">Hang on, "changing the value"? The Amount/Measure values should be immutable, yes?</td></tr>
  <tr class="msg" id="L90"><td class="ts-cell"><a class="ts" href="#L90" alt="Wed Feb 12 2025 08:13:45 GMT-0800 (Pacific Standard Time)">16:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">changing in the sense of, when I access the value as a decimal, I faithfully get the exact thing</td></tr>
  <tr class="msg" id="L91"><td class="ts-cell"><a class="ts" href="#L91" alt="Wed Feb 12 2025 08:13:50 GMT-0800 (Pacific Standard Time)">16:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">it's not transformed during the access</td></tr>
  <tr class="msg" id="L92"><td class="ts-cell"><a class="ts" href="#L92" alt="Wed Feb 12 2025 08:14:18 GMT-0800 (Pacific Standard Time)">16:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">If that's a concern, then would it not also be a concern if the transformation happens in the constructor?</td></tr>
  <tr class="msg" id="L93"><td class="ts-cell"><a class="ts" href="#L93" alt="Wed Feb 12 2025 08:14:58 GMT-0800 (Pacific Standard Time)">16:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">well, it's a question of the data model, but sure, my personal preference would be for it to be strict</td></tr>
  <tr class="msg" id="L94"><td class="ts-cell"><a class="ts" href="#L94" alt="Wed Feb 12 2025 08:15:24 GMT-0800 (Pacific Standard Time)">16:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">anyway, I think this is not that major of a question</td></tr>
  <tr class="msg" id="L95"><td class="ts-cell"><a class="ts" href="#L95" alt="Wed Feb 12 2025 08:15:38 GMT-0800 (Pacific Standard Time)">16:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">the major question is: are we happy with introducing two classes like this? does this resolve the needs of Measure and Decimal?</td></tr>
  <tr class="msg" id="L96"><td class="ts-cell"><a class="ts" href="#L96" alt="Wed Feb 12 2025 08:16:10 GMT-0800 (Pacific Standard Time)">16:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@sffc:mozilla.org">sffc</span>&gt;</div></td><td class="msg-cell">If we stick with <code>Amount</code> always being a decimal, then we could just say that <code>new Amount(42)</code> or <code>new Amount(42n)</code> are not allowed; you need to create one from a Decimal</td></tr>
  <tr class="msg" id="L97"><td class="ts-cell"><a class="ts" href="#L97" alt="Wed Feb 12 2025 08:17:32 GMT-0800 (Pacific Standard Time)">16:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">It seems really rather unergonomic to need to do <code>new Amount(new Decimal(42))</code>.</td></tr>
  <tr class="msg" id="L98"><td class="ts-cell"><a class="ts" href="#L98" alt="Wed Feb 12 2025 08:18:13 GMT-0800 (Pacific Standard Time)">16:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">I'm really confused about what goals you're trying to achieve, Eemeli</td></tr>
  <tr class="msg" id="L99"><td class="ts-cell"><a class="ts" href="#L99" alt="Wed Feb 12 2025 08:19:02 GMT-0800 (Pacific Standard Time)">16:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">is it an abstract sense of minimalism/good design, or is there anything more concrete that you're trying to ensure is enabled?</td></tr>
  <tr class="msg" id="L100"><td class="ts-cell"><a class="ts" href="#L100" alt="Wed Feb 12 2025 08:25:04 GMT-0800 (Pacific Standard Time)">16:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell"><p>I am primarily looking to improve the experience of using Intl.NumberFormat by better separating the "what" and the "how" of its inputs, where we currently require <code>unit</code> and <code>currency</code> to be defined in the constructor, while the numerical value is passed in in the <code>.format()</code> method.</p>
<p>This is particularly problematic in localization, where the options bag otherwise contains values that a translator may want or need to tweak. Including <code>currency: 'EUR'</code> there means that a translator working from French to US English could "fix" that option to say <code>currency: 'USD'</code> instead. Amount solves this problem by letting the developer fully control the value being formatted, by wrapping it in an object that includes both the currency code and the value.</p>
</td></tr>
  <tr class="msg" id="L101"><td class="ts-cell"><a class="ts" href="#L101" alt="Wed Feb 12 2025 08:26:47 GMT-0800 (Pacific Standard Time)">16:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">OK, so then the problem with certain designs is that it'd make the upgrade of existing code more complicated, to insert decimal128 into the mix when the surrounding code already works?</td></tr>
  <tr class="msg" id="L102"><td class="ts-cell"><a class="ts" href="#L102" alt="Wed Feb 12 2025 08:29:04 GMT-0800 (Pacific Standard Time)">16:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">It would add extra, unnecessary work for an implementation to need to convert a value to Decimal before passing it on to Intl.NumberFormat, which already supports numbers, bigints, and numerical strings.</td></tr>
  <tr class="msg" id="L103"><td class="ts-cell"><a class="ts" href="#L103" alt="Wed Feb 12 2025 08:29:16 GMT-0800 (Pacific Standard Time)">16:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">Alright, I see that argument</td></tr>
  <tr class="msg" id="L104"><td class="ts-cell"><a class="ts" href="#L104" alt="Wed Feb 12 2025 08:29:44 GMT-0800 (Pacific Standard Time)">16:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">And it adds complexity to our process to have two proposals each depend on the other.</td></tr>
  <tr class="msg" id="L105"><td class="ts-cell"><a class="ts" href="#L105" alt="Wed Feb 12 2025 08:30:51 GMT-0800 (Pacific Standard Time)">16:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">I'm still not super excited about you saying that this means that Measure can come before Decimal -- I hope that Decimal can proceed once we work out the relationship with Measure (maybe Measure would come sooner, but I don't want to add artificial extra delay to Decimal)</td></tr>
  <tr class="msg" id="L106"><td class="ts-cell"><a class="ts" href="#L106" alt="Wed Feb 12 2025 08:33:05 GMT-0800 (Pacific Standard Time)">16:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">anyway, I'm OK if we end up making Amount/Measure be polymorphic in this way -- not my first choice, but not terrible</td></tr>
  <tr class="msg" id="L107"><td class="ts-cell"><a class="ts" href="#L107" alt="Wed Feb 12 2025 09:16:51 GMT-0800 (Pacific Standard Time)">17:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell"><p>So here's an idle thought: If we end up with an opaque Amount that can hold a value + units + precision, and the units and precision are optional, then why should we add a separate Decimal class if we were to want to do operations like <code>.add()</code> or <code>.multiply()</code> on such values?</p>
<p>As in, wouldn't it be cleaner to consider unitless values as just a type of Amount, rather than needing its own special class?</p>
</td></tr>
  <tr class="msg" id="L108"><td class="ts-cell"><a class="ts" href="#L108" alt="Wed Feb 12 2025 09:18:03 GMT-0800 (Pacific Standard Time)">17:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">At least personally, I find <code>amount.add(otherAmount)</code> much less objectionable than <code>decimal.add(otherDecimal)</code>, because in the former the values don't feel like they ought to be representable as primitives.</td></tr>
  <tr class="msg" id="L109"><td class="ts-cell"><a class="ts" href="#L109" alt="Wed Feb 12 2025 09:25:06 GMT-0800 (Pacific Standard Time)">17:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">one of the issues that has come up with arithmetic on numbers with precision is how to propagate the precision to the result</td></tr>
  <tr class="msg" id="L110"><td class="ts-cell"><a class="ts" href="#L110" alt="Wed Feb 12 2025 09:25:26 GMT-0800 (Pacific Standard Time)">17:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">IEEE 754 gives an answer to that, but there are other valid answers</td></tr>
  <tr class="msg" id="L111"><td class="ts-cell"><a class="ts" href="#L111" alt="Wed Feb 12 2025 09:27:04 GMT-0800 (Pacific Standard Time)">17:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">I guess the issue with rounding errors in JS Numbers (mainly arising once one starts doing arithmetic) would persist in this approach</td></tr>
  <tr class="msg" id="L112"><td class="ts-cell"><a class="ts" href="#L112" alt="Wed Feb 12 2025 09:28:21 GMT-0800 (Pacific Standard Time)">17:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@sffc:mozilla.org">sffc</span>&gt;</div></td><td class="msg-cell">I have a few arguments against the polymorphic Measure:

1. Solves confusion regarding how we record precision 
2. More seamless i18n integration with the new number ecosystem we're building 
3. Easier to implement

I acknowledge that integrating polymorphic Amount into an existing code base is a lossless transformation. However, I've previously been convinced by Jesse that Decimal128 covers basically all use cases. So I don't find that argument for polymorphic Amount to be very strong.</td></tr>
  <tr class="msg" id="L113"><td class="ts-cell"><a class="ts" href="#L113" alt="Wed Feb 12 2025 09:34:14 GMT-0800 (Pacific Standard Time)">17:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell"><span class="nick-16">sffc</span>: Could you clarify what you mean by "polymorphic Amount"? Is that an Amount with a value that can be one of multiple different types?</td></tr>
  <tr class="msg" id="L114"><td class="ts-cell"><a class="ts" href="#L114" alt="Wed Feb 12 2025 09:37:11 GMT-0800 (Pacific Standard Time)">17:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">I think of precision-less, unitless Amount as a sort of limiting case; I think of decimals as mathematical values</td></tr>
  <tr class="msg" id="L115"><td class="ts-cell"><a class="ts" href="#L115" alt="Wed Feb 12 2025 09:37:55 GMT-0800 (Pacific Standard Time)">17:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">and I guess developers would also think of them as such (though I admit that that's a bit hand wavy on my part)</td></tr>
  <tr class="msg" id="L116"><td class="ts-cell"><a class="ts" href="#L116" alt="Wed Feb 12 2025 09:39:09 GMT-0800 (Pacific Standard Time)">17:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">I can imagine an app that only works with integers under, say, 1 million. Using bigints for those numbers is fine, and helps me to think more clearly about my program than if I were to use Numbers</td></tr>
  <tr class="msg" id="L117"><td class="ts-cell"><a class="ts" href="#L117" alt="Wed Feb 12 2025 09:39:22 GMT-0800 (Pacific Standard Time)">17:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">(just making an analogy to existing datatypes)</td></tr>
  <tr class="msg" id="L118"><td class="ts-cell"><a class="ts" href="#L118" alt="Wed Feb 12 2025 09:40:23 GMT-0800 (Pacific Standard Time)">17:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@sffc:mozilla.org">sffc</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <span class="nick-16">sffc</span>: Could you clarify what you mean by "polymorphic Amount"? Is that an Amount with a value that can be one of multiple different types?</blockquote></mx-reply>Correct, as opposed to an Amount that is always Decimal</td></tr>
  <tr class="msg" id="L119"><td class="ts-cell"><a class="ts" href="#L119" alt="Wed Feb 12 2025 09:43:47 GMT-0800 (Pacific Standard Time)">17:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">This suggests to me that starting out with an opaque Amount would be safest, as it would allow its value to later be defined as a Decimal, or for the capabilities of Amount to later be expanded to cover what's proposed for Decimal.</td></tr>
  <tr class="msg" id="L120"><td class="ts-cell"><a class="ts" href="#L120" alt="Wed Feb 12 2025 09:45:58 GMT-0800 (Pacific Standard Time)">17:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">If we day "for now Amount is opaque basically containing a string / mathematical value", end then we re-explain it in terms of decimal, we have to be careful about how it might round differently</td></tr>
  <tr class="msg" id="L121"><td class="ts-cell"><a class="ts" href="#L121" alt="Wed Feb 12 2025 09:47:16 GMT-0800 (Pacific Standard Time)">17:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">We would need to initially impose limits in the Amount constructor that would be within the limits of what's expressible in IEEE 754.</td></tr>
  <tr class="msg" id="L122"><td class="ts-cell"><a class="ts" href="#L122" alt="Wed Feb 12 2025 09:47:54 GMT-0800 (Pacific Standard Time)">17:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">just to be precise, we mean the limits of IEEE 754 Decimal128?</td></tr>
  <tr class="msg" id="L123"><td class="ts-cell"><a class="ts" href="#L123" alt="Wed Feb 12 2025 09:48:01 GMT-0800 (Pacific Standard Time)">17:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">Yeah.</td></tr>
  <tr class="msg" id="L124"><td class="ts-cell"><a class="ts" href="#L124" alt="Wed Feb 12 2025 10:02:44 GMT-0800 (Pacific Standard Time)">18:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">I'd like the discussion during the meeting to focus first on building consensus in committee that we should do both of these classes, and then later we can work out details like proposal merging vs not, and polymorphic vs decimal-linked measure. For this, it'd be ideal if all of us could hold back so that the queue could initially be <em>others</em> in committee who haven't already been discussing this as a group at length. (And then afterwards we can make statements about our positions within this, but I take it we all agree with this two-class approach where they have basically this role.) What do you think?</td></tr>
  <tr class="msg" id="L125"><td class="ts-cell"><a class="ts" href="#L125" alt="Wed Feb 12 2025 10:03:09 GMT-0800 (Pacific Standard Time)">18:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">(I mean, not necessarily all of us, but the group who's been more active in discussion)</td></tr>
  <tr class="msg" id="L126"><td class="ts-cell"><a class="ts" href="#L126" alt="Wed Feb 12 2025 10:03:46 GMT-0800 (Pacific Standard Time)">18:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">for example, <span class="nick-6">ljharb</span> has repeatedly expressed opposition for an unrelated reason. I think we should get that out of the way before we go into these additional details. (That topic is usually brought up just at the very end of the timebox, which doesn't allow for discussion)</td></tr>
  <tr class="msg" id="L127"><td class="ts-cell"><a class="ts" href="#L127" alt="Wed Feb 12 2025 10:04:25 GMT-0800 (Pacific Standard Time)">18:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">but also we should explore other concerns the rest of the committee might have, e.g., "is this class worth it at all, or should it just be a library?"</td></tr>
  <tr class="msg" id="L128"><td class="ts-cell"><a class="ts" href="#L128" alt="Wed Feb 12 2025 10:04:55 GMT-0800 (Pacific Standard Time)">18:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">I <em>think</em> we've made clear good reasons for all those basic points, but if people still disagree with them, we also won't get Stage 2, even if we have agreement among this group</td></tr>
  <tr class="msg" id="L129"><td class="ts-cell"><a class="ts" href="#L129" alt="Wed Feb 12 2025 10:06:03 GMT-0800 (Pacific Standard Time)">18:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">sorry I don't mean to dictate the order, we can do whatever order, as long as we make space to hear out the various concerns. I just want to make sure that this conversation is broad and not <em>only</em> the same people who are in this channel and other meetings outside of plenary arguing among ourselves.</td></tr>
  <tr class="msg" id="L130"><td class="ts-cell"><a class="ts" href="#L130" alt="Wed Feb 12 2025 10:09:52 GMT-0800 (Pacific Standard Time)">18:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">I'd hope that, because the presentation is about measure, too, the set of those in committee who might have useful feedback would be somewhat wider</td></tr>
  <tr class="msg" id="L131"><td class="ts-cell"><a class="ts" href="#L131" alt="Wed Feb 12 2025 10:10:24 GMT-0800 (Pacific Standard Time)">18:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">and I hope others who have watched the development of related-but-distinct proposals might have some insight</td></tr>
  <tr class="msg" id="L132"><td class="ts-cell"><a class="ts" href="#L132" alt="Wed Feb 12 2025 12:09:50 GMT-0800 (Pacific Standard Time)">20:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell"><blockquote>
<p>I take it we all agree with this two-class approach where they have basically this role.</p>
</blockquote>
<p>I'm not sure that I agree with this part. I think the discussions so far have identified valid use cases that are served exclusively by Amount/Measure. Furthermore, I think that an opaque Amount can be defined and can be useful without any dependence on Decimal. Presuming then that at least one class (Amount) is added to the language, it is not clear to me that it would be better to add a second Decimal class, rather than including its functionality in Amount.</p>
</td></tr>

</tbody></table></div></div></div>
</body></html>