<!DOCTYPE html><html><head>
  <title>TC39 Beginners on 2023-09-13</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "TC39 Beginners";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">TC39 Beginners<br>2023-09-13<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2023-06-03" class="nav-link"><span>prev</span></a>
<a href="2023-11-06" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search TC39 Beginners">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Wed Sep 13 2023 06:52:14 GMT-0700 (Pacific Daylight Time)">13:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@zacque:matrix.org">zacque</span>&gt;</div></td><td class="msg-cell">Hi, what's the difference between Completion Record <code>normal</code> and <code>return</code> type?</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Wed Sep 13 2023 06:53:37 GMT-0700 (Pacific Daylight Time)">13:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@zacque:matrix.org">zacque</span>&gt;</div></td><td class="msg-cell"><a href="https://tc39.es/ecma262/#table-completion-record-fields">https://tc39.es/ecma262/#table-completion-record-fields</a></td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Wed Sep 13 2023 06:56:41 GMT-0700 (Pacific Daylight Time)">13:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@jmdyck:matrix.org">jmdyck</span>&gt;</div></td><td class="msg-cell">If you evaluate a statement (within a function body, say), and it causes a return from that function, then that's signaled via a <code>return</code> completion. If evaluation is to proceed normally to the next statement, then that's signaled by a <code>normal</code> completion.</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Wed Sep 13 2023 07:00:39 GMT-0700 (Pacific Daylight Time)">14:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@zacque:matrix.org">zacque</span>&gt;</div></td><td class="msg-cell">Makes sense, but what about the next paragraph: "Callable objects that are defined in this specification only return a normal completion or a throw completion. Returning any other kind of Completion Record is considered an editorial error."</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Wed Sep 13 2023 07:00:55 GMT-0700 (Pacific Daylight Time)">14:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@zacque:matrix.org">zacque</span>&gt;</div></td><td class="msg-cell">I'll expect it to include <code>return</code> completion?</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Wed Sep 13 2023 07:02:45 GMT-0700 (Pacific Daylight Time)">14:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@jmdyck:matrix.org">jmdyck</span>&gt;</div></td><td class="msg-cell">No, if, within function A, you call function B, that call cannot cause a return from function A. (But it can cause A to throw.)</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Wed Sep 13 2023 07:05:24 GMT-0700 (Pacific Daylight Time)">14:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@jmdyck:matrix.org">jmdyck</span>&gt;</div></td><td class="msg-cell">The wording you quoted is not the best: callable objects (i.e., functions) don't return completions at all.</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Wed Sep 13 2023 07:08:33 GMT-0700 (Pacific Daylight Time)">14:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@jmdyck:matrix.org">jmdyck</span>&gt;</div></td><td class="msg-cell">Rather, the completions are 'internal' to the process of calling a function. I.e., certain algorithms in the spec are returning completions. </td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Wed Sep 13 2023 07:12:24 GMT-0700 (Pacific Daylight Time)">14:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@jmdyck:matrix.org">jmdyck</span>&gt;</div></td><td class="msg-cell">It would be more accurate to say something like "a function's [[Call]] internal method can only return a normal completion or a throw completion..."</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Wed Sep 13 2023 07:13:55 GMT-0700 (Pacific Daylight Time)">14:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@zacque:matrix.org">zacque</span>&gt;</div></td><td class="msg-cell">Hmm, I see... But still, it's a bit weird to me. Can you please point me to the semantics of function invocation in the spec? I can't seem to find it in <a href="https://tc39.es/ecma262/#sec-function-objects">https://tc39.es/ecma262/#sec-function-objects</a>, <a href="https://tc39.es/ecma262/#sec-ecmascript-language-functions-and-classes">https://tc39.es/ecma262/#sec-ecmascript-language-functions-and-classes</a>, or <a href="https://tc39.es/ecma262/#sec-ecmascript-language-expressions">https://tc39.es/ecma262/#sec-ecmascript-language-expressions</a></td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Wed Sep 13 2023 07:14:23 GMT-0700 (Pacific Daylight Time)">14:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@zacque:matrix.org">zacque</span>&gt;</div></td><td class="msg-cell">What if I want to describe the semantics of invoking function A?</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Wed Sep 13 2023 07:16:50 GMT-0700 (Pacific Daylight Time)">14:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@jmdyck:matrix.org">jmdyck</span>&gt;</div></td><td class="msg-cell">Function invocation is kind of involved. You should maybe start at <a href="https://tc39.es/ecma262/#sec-function-calls-runtime-semantics-evaluation">https://tc39.es/ecma262/#sec-function-calls-runtime-semantics-evaluation</a></td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Wed Sep 13 2023 07:17:25 GMT-0700 (Pacific Daylight Time)">14:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@jmdyck:matrix.org">jmdyck</span>&gt;</div></td><td class="msg-cell">skip the first group and go to <code> CallExpression : CallExpression Arguments</code></td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Wed Sep 13 2023 07:18:22 GMT-0700 (Pacific Daylight Time)">14:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@jmdyck:matrix.org">jmdyck</span>&gt;</div></td><td class="msg-cell">to EvaluateCall(), to Call(), to [[Call]]</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Wed Sep 13 2023 07:20:49 GMT-0700 (Pacific Daylight Time)">14:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@jmdyck:matrix.org">jmdyck</span>&gt;</div></td><td class="msg-cell">And then either <a href="https://tc39.es/ecma262/#sec-ecmascript-function-objects-call-thisargument-argumentslist">https://tc39.es/ecma262/#sec-ecmascript-function-objects-call-thisargument-argumentslist</a> or <a href="https://tc39.es/ecma262/#sec-built-in-function-objects-call-thisargument-argumentslist">https://tc39.es/ecma262/#sec-built-in-function-objects-call-thisargument-argumentslist</a>, depending on whether the function is a built-in. (Actually, there are a couple other possibilities here that you don't need to worry about.)</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Wed Sep 13 2023 07:22:27 GMT-0700 (Pacific Daylight Time)">14:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@jmdyck:matrix.org">jmdyck</span>&gt;</div></td><td class="msg-cell">For a built-in function, that'll go to BuiltinCallOrConstruct, which basically bottoms out in prose.</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Wed Sep 13 2023 07:26:17 GMT-0700 (Pacific Daylight Time)">14:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@jmdyck:matrix.org">jmdyck</span>&gt;</div></td><td class="msg-cell">For a non-built-in, you'll get to OrdinaryCallEvaluateBody, which calls  EvaluateBody, which goes various ways depending on what kind of function it is. If it's the plainest kind of function, then you'll go to EvaluateFunctionBody which calls FunctionDeclarationInstantiation to instantiate the function's declarations, and then Evaluation to evaluate its body. </td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Wed Sep 13 2023 07:35:39 GMT-0700 (Pacific Daylight Time)">14:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@zacque:matrix.org">zacque</span>&gt;</div></td><td class="msg-cell">Great, thanks for your pointers! I'll need some time to digest them</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Wed Sep 13 2023 07:36:03 GMT-0700 (Pacific Daylight Time)">14:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@jmdyck:matrix.org">jmdyck</span>&gt;</div></td><td class="msg-cell">Yup!</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Wed Sep 13 2023 07:39:52 GMT-0700 (Pacific Daylight Time)">14:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@jmdyck:matrix.org">jmdyck</span>&gt;</div></td><td class="msg-cell">And all those operations return a completion, either <code>normal</code> or <code>throw</code>.</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Wed Sep 13 2023 07:42:30 GMT-0700 (Pacific Daylight Time)">14:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@jmdyck:matrix.org">jmdyck</span>&gt;</div></td><td class="msg-cell">(Actually, some say "an abrupt completion" rather than "a throw completion". I'm not sure whether that's an unnecessary generalization, or I'm forgetting something.)</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Wed Sep 13 2023 07:44:36 GMT-0700 (Pacific Daylight Time)">14:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">An abrupt completion is any completion that's not a normal completion </td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Wed Sep 13 2023 07:44:58 GMT-0700 (Pacific Daylight Time)">14:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">So throw/return/break/continue</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Wed Sep 13 2023 07:45:26 GMT-0700 (Pacific Daylight Time)">14:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@jmdyck:matrix.org">jmdyck</span>&gt;</div></td><td class="msg-cell">Right, but do you think these ops can validly return a return/break/continue completion?</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Wed Sep 13 2023 07:46:04 GMT-0700 (Pacific Daylight Time)">14:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">No â€” in this case they are equivalent, but not always :)</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Wed Sep 13 2023 07:47:20 GMT-0700 (Pacific Daylight Time)">14:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@jmdyck:matrix.org">jmdyck</span>&gt;</div></td><td class="msg-cell">Okay, so that's what I meant by "unnecessary generalization". The operation header is naming a more general return-type than it could.</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Wed Sep 13 2023 10:22:12 GMT-0700 (Pacific Daylight Time)">17:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@jmdyck:matrix.org">jmdyck</span>&gt;</div></td><td class="msg-cell">In the case of EvaluateCall, it looks like the possibility of a non-throw abrupt completion comes from  ArgumentListEvaluation, which I think has that possibility because an argument could involve a <code>yield</code> expression, which (under somewhat obscure circumstances) could result in a <code>return</code> completion. Is that right, @bakkot?</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Wed Sep 13 2023 10:35:20 GMT-0700 (Pacific Daylight Time)">17:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@jmdyck:matrix.org">jmdyck</span>&gt;</div></td><td class="msg-cell">Similarly, for OrdinaryCallEvaluateBody and the ones below it, I think "an abrupt completion" is in practice "a throw completion or a return completion". But here, the return completion happens for a more prosaic reason (usually): executing a ReturnStatement.</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Wed Sep 13 2023 10:41:56 GMT-0700 (Pacific Daylight Time)">17:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@jmdyck:matrix.org">jmdyck</span>&gt;</div></td><td class="msg-cell">(<code>[[Call]]</code> and <code>[[Construct]]</code> explicitly handle the possibility of a <code>return</code> completion, and only return a <code>normal</code> completion or <code>throw</code> completion .)</td></tr>

</tbody></table></div></div></div>
</body></html>