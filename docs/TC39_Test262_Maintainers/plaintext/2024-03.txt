2024-03-12
[00:10:22.0604] <bakkot>
Can I suggest a policy of not force-pushing to branches people are working on, even just force-pushing to rebase? I'm used to the convention of clicking the "update with merge commit" button, which makes it much more obvious what's happened when one's local branch is out of date.

[10:28:32.0002] <ptomato>
Igalia has an all hands next week during the maintainers meeting. how would people feel about moving it to the following week?


2024-03-13
[23:24:35.0928] <ljharb>
> <@bakkot:matrix.org> Can I suggest a policy of not force-pushing to branches people are working on, even just force-pushing to rebase? I'm used to the convention of clicking the "update with merge commit" button, which makes it much more obvious what's happened when one's local branch is out of date.

happy to hear the other maintainer's thoughts, but the convention on github is pretty commonly that force pushes are expected

[23:27:07.0543] <bakkot>
I have never had anyone else force push to a branch I was working on prior to me saying the branch was ready to merge, so I don't this this convention is that widespread

[23:28:21.0321] <bakkot>
everyone else just pushes new commits, which means if they want to run CI with the branch updated to main they click the "update with merge commit" button

[23:28:31.0947] <bakkot>
 * I have never had anyone else force push to a branch I was working on prior to me saying the branch was ready to merge, so I don't think this convention is that widespread

[00:43:23.0793] <ljharb>
if it's not a draft PR then it's potentially ready to merge; that's what the "draft" semantic is for

[08:53:53.0076] <ptomato>
yeah, I do force-pushes on PRs all the time. I don't know whether it's the convention, maybe I'm weird ðŸ˜…

[08:55:57.0867] <ptomato>
in my defense, I work on a lot of repos where most contributors have less time/motivation to be involved than me, and are often not immediately on top of following up with the PRs that they send. so when I force-push, that seems like a kindness because it saves them the trouble of rebasing

[09:00:30.0534] <ptomato>
update with merge commit, on the other hand, I'm not a fan of - it's fine if your working style is to consistently do one commit per PR, because you can always 'squash and merge' when it comes time to merge the PR. but in test262 we get both 'squash everything' PRs and 'each commit is a carefully curated logical unit' PRs. update with merge commit makes the latter harder to preserve

[09:10:59.0924] <bakkot>
> <@ljharb:matrix.org> if it's not a draft PR then it's potentially ready to merge; that's what the "draft" semantic is for

If there are outstanding requests for changes from maintainers then it is not potentially ready to merge

[09:11:42.0431] <bakkot>
unless the maintainers are making those changes themselves and then immediately approving and merging, in which case I have no objections to force-pushing as part of the process

[09:15:38.0332] <ptomato>
we could maybe render some of this moot by not requiring that PRs have to be fast-forwardable to be mergeable (but still require that when they are actually merged, they are rebased and fast-forwarded). github can do this. that way, no one would have to force-push unless there were actually merge conflicts, which rarely happens because of the nature of test262

[09:34:15.0232] <ljharb>
> <@bakkot:matrix.org> If there are outstanding requests for changes from maintainers then it is not potentially ready to merge

true, fair

[09:35:40.0935] <ljharb>
but in general, i'm surprised you've never had this happen, because i've had it happen to me dozens of times and i've done it to others many hundreds of times. and in this case it wasn't even a real force push, i just clicked the clickable "rebase branch" button in the UI. so tbh i think that if you aren't expecting someone to click one of the buttons in the web ui then on some level you may need to adjust your expectations?

