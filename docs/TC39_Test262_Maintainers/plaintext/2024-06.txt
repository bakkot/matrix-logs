2024-06-03
[07:30:20.0506] <dminor>
Hi :) I'd like to bring up `implementation-contributed` again... After some discussions with Yulia and the other implementers, I've come back around to wanting to upstream our `non262` tests to test262. What I'm proposing is to upstream our non262 tests, in test262 format, but without the intention of reworking them to follow exactly what test262 does (e.g. testing a single part of the spec). Based on this, I don't think `staging` is the correct place.

The benefit to us is that we can simplify our testing, and work towards writing new tests in `staging` as opposed to increasing our corpus of `non262` tests. The benefit we see to the community is that we would increase the set of tests available to other implementations, including tests that test cross-cutting concerns, rather than individual bits of functionality.

[07:42:51.0430] <littledan>
Why wouldn't `staging` be a good place to upstream tests while not having the intention to rework them?

[07:44:35.0932] <littledan>
If the name is too evocative of eventually removing things, then we could make another directory which is set up the same way technically, which just removes that intentionality. I agree that there shouldn't be an expectation that tests which are shared like this are necessarily eventually reworked somehow or other--that's not the best use of people's time, and would limit the number of tests shared if they had to have that expectation.

[07:45:13.0092] <littledan>
(probably we should still remove the current contents of implementation-contributed, though, right?)

[07:45:44.0080] <littledan>
I had thought that folks already agreed on the plan that there is no expectation to rework these shared tests, so I'm having a little bit of trouble understanding dminor 's message.

[07:52:44.0333] <Ms2ger>
Fwiw: https://github.com/tc39/test262/compare/main...impl-sm

[09:01:34.0875] <dminor>
Looks like Ms2ger has already done the work :)

[09:03:10.0648] <dminor>
I have no strong opinion about where the tests go, I do think that the name `staging` suggests that the tests are intended to be moved into mainstream test262 at some point.

[09:03:32.0365] <dminor>
Whatever we pick, we should document the expectations around `staging`, if they aren't already.

[09:21:55.0049] <shu>
dminor: https://github.com/tc39/test262/blob/249657722525cc8e43b1ddb91f8df0b4b011fcf6/CONTRIBUTING.md#staging

[09:23:04.0659] <shu>
IIUC sounds like you'd like to change the "live temporarily" part, not anything before that

[09:28:46.0142] <dminor>
Yes, that sounds right to me. I guess it makes sense for me to open a PR and we can continue any discussion there.

[09:30:48.0956] <ptomato>
> <@littledan:matrix.org> (probably we should still remove the current contents of implementation-contributed, though, right?)

I was going to do this once we had something sensible to put there instead, but I wouldn't mind if someone just deleted it now. I don't think the current contents of i-c are runnable

[09:32:44.0735] <ptomato>
> <@shuyuguo:matrix.org> IIUC sounds like you'd like to change the "live temporarily" part, not anything before that

FWIW I think this was written with the assumption that it would be tests for new stage 2.7 / 3 features going into staging, and as it's documented elsewhere in that section that staging doesn't "count" towards the required coverage for stage 4. I don't think we anticipated a case like Spidermonkey's non262 tests at that time

[09:35:13.0235] <shu>
> <@pchimento:igalia.com> FWIW I think this was written with the assumption that it would be tests for new stage 2.7 / 3 features going into staging, and as it's documented elsewhere in that section that staging doesn't "count" towards the required coverage for stage 4. I don't think we anticipated a case like Spidermonkey's non262 tests at that time

agreed, this warrants a new consensus / discussion. i'm saying mechanically it should be the same as what's described in that section, except the "live temporarily" part

[09:38:23.0228] <dminor>
ptomato: do you have a preference between `staging` and new directory for this?

[09:55:42.0235] <ptomato>
Personally, I don't care that much ðŸ™‚

[09:56:20.0394] <ptomato>
i-c seems okay to me especially if we're going to put transformed tests from other engines there

[09:57:07.0517] <ptomato>
I wouldn't have a problem with staging, either. You're right that the name suggests temporary, though

[09:59:52.0020] <dminor>
I'll open a PR for i-c as that name seems closer to the intended use here. I'll open another PR to remove the current contents, as I believe we have consensus to move ahead with that.

[11:18:53.0983] <shu>
dminor: thanks for doing the work for getting more tests in the commons

[13:07:09.0669] <ljharb>
sorry i missed this here, before engaging on the PR

[13:07:33.0890] <ljharb>
i think that everything not in the main suite is temporary.

[13:07:48.0451] <ljharb>
 * i think that everything not in the main suite is temporary. it's just that the timeline may be long.

[13:17:33.0690] <shu>
like, finitely long but longer than our lifetimes? :)

[14:53:47.0146] <littledan>
Yeah it is important to be able to land shared tests somewhere while having literally no intent to ever do this work

[14:54:10.0605] <littledan>
Maybe someone else will decide to do it but that would be a separate decision 


2024-06-04
[09:55:09.0580] <ljharb>
i agree that lots of them might stay there forever. but it's still "temporary" in intention

[11:21:39.0327] <ptomato>
Sure, that works for me as well - as long as we don't commit ourselves as maintainers to do it

[11:22:57.0913] <ptomato>
I guess there's still a difference in intention though; what's been in staging so far has been coverage for pre-stage 4 stuff that needs to get migrated before stage 4.

