<!doctype html>
<head>
  <title>#tc39 on 2019-03-16</title>
  <link rel="stylesheet" href="../style.css">
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">#tc39<br>2019-03-16<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2019-03-15" class="nav-link"><span>prev</span></a>
<a href="2019-03-17" class="nav-link"><span style="float:right">next</span></a>
</div>
    
<div class="room-list-wrapper">Active:<br>
<ul class="room-list">
<li><a href="../TC39_Delegates/">TC39 Delegates</a></li>
<li><a href="../TC39_Editors/">TC39 Editors</a></li>
<li><a href="../TC39_General/">TC39 General</a></li>
<li><a href="../WHATWG/">WHATWG</a></li>
</ul>
</div>
<br>
<div class="room-list-wrapper">Historical:<br>
<ul class="room-list">
<li><a href="../irc-tc39/" class="current-room">#tc39</a></li>
<li><a href="../irc-tc39-delegates/">#tc39-delegates</a></li>
<li><a href="../irc-tc39-editor-group/">#tc39-editor-group</a></li>
<li><a href="../irc-whatwg/">#whatwg</a></li>
</ul>
</div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs"><div class="log">
<table><tbody id="log-tbody">
  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Fri Mar 15 2019 17:37:22 GMT-0700 (Pacific Daylight Time)">00:37</a></td><td class="nick-cell">&lt;<span class="nick nick-6" title=ljharb@irc>ljharb</span>&gt;</td><td class="msg-cell">littledan: import await addresses one of my big concerns; but it’s vitality is one that remains.</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Fri Mar 15 2019 17:47:14 GMT-0700 (Pacific Daylight Time)">00:47</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">ljharb: Is there any version of top-level await you could imagine that would address the virality concern (regardless of other issues people have raised)?</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Fri Mar 15 2019 17:50:23 GMT-0700 (Pacific Daylight Time)">00:50</a></td><td class="nick-cell">&lt;<span class="nick nick-6" title=ljharb@irc>ljharb</span>&gt;</td><td class="msg-cell">yep! Maybe sugar for an AAIFE with import or import await? That makes adding TLA or import await not a breaking change (transparent) but using import await ensures all the bindings are available (desired behavior). Both sync and async static import would work with any module. (just came up with this now so i haven’t thought it through more than this comment)</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Sat Mar 16 2019 00:46:47 GMT-0700 (Pacific Daylight Time)">07:46</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">ljharb: Do you mean, dependent modules would not be blocked?</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Sat Mar 16 2019 00:53:05 GMT-0700 (Pacific Daylight Time)">07:53</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">If so, I don&#039;t think this would meet the WebAssembly goals well, as those should wait for the module to be ready before exposing the exports</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Sat Mar 16 2019 00:53:29 GMT-0700 (Pacific Daylight Time)">07:53</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">it seems like a weird hazard that, if you leave off the `await`, you expose yourself to the race condition that the explainer walks through the techniques for avoiding.</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Sat Mar 16 2019 00:53:45 GMT-0700 (Pacific Daylight Time)">07:53</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">this really would be a problem when refactoring!</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Sat Mar 16 2019 09:05:01 GMT-0700 (Pacific Daylight Time)">16:05</a></td><td class="nick-cell">&lt;<span class="nick nick-6" title=ljharb@irc>ljharb</span>&gt;</td><td class="msg-cell">littledan: yes, i dislike that dependent modules are blocked without them opting into it</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Sat Mar 16 2019 09:05:21 GMT-0700 (Pacific Daylight Time)">16:05</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">ljharb: They are opting into it by doing `import await`, right?</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Sat Mar 16 2019 09:05:36 GMT-0700 (Pacific Daylight Time)">16:05</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">I mean, they have the choice of not using the module at all, but it&#039;s not silently foisted on them</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Sat Mar 16 2019 09:05:41 GMT-0700 (Pacific Daylight Time)">16:05</a></td><td class="nick-cell">&lt;<span class="nick nick-6" title=ljharb@irc>ljharb</span>&gt;</td><td class="msg-cell">yes, but modules importing *them* are not</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Sat Mar 16 2019 09:05:59 GMT-0700 (Pacific Daylight Time)">16:05</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">OK, I think that&#039;s where we have some confusion. I&#039;d say, if you import a module using import await, you also have to use import await</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Sat Mar 16 2019 09:06:05 GMT-0700 (Pacific Daylight Time)">16:06</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">(otherwise there&#039;s no point to any of it)</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Sat Mar 16 2019 09:06:16 GMT-0700 (Pacific Daylight Time)">16:06</a></td><td class="nick-cell">&lt;<span class="nick nick-6" title=ljharb@irc>ljharb</span>&gt;</td><td class="msg-cell">right, that’s the current proposal for import await iirc</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Sat Mar 16 2019 09:06:31 GMT-0700 (Pacific Daylight Time)">16:06</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">right, so what is it that you&#039;re against with that?</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Sat Mar 16 2019 09:06:36 GMT-0700 (Pacific Daylight Time)">16:06</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">or, what are you in favor of?</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Sat Mar 16 2019 09:06:42 GMT-0700 (Pacific Daylight Time)">16:06</a></td><td class="nick-cell">&lt;<span class="nick nick-6" title=ljharb@irc>ljharb</span>&gt;</td><td class="msg-cell">so that addresses my concern of silent optin - but it preserves the concern about vitality</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Sat Mar 16 2019 09:06:45 GMT-0700 (Pacific Daylight Time)">16:06</a></td><td class="nick-cell">&lt;<span class="nick nick-6" title=ljharb@irc>ljharb</span>&gt;</td><td class="msg-cell">*virality</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Sat Mar 16 2019 09:06:54 GMT-0700 (Pacific Daylight Time)">16:06</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">heh I keep making the same mistake</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Sat Mar 16 2019 09:07:00 GMT-0700 (Pacific Daylight Time)">16:07</a></td><td class="nick-cell">&lt;<span class="nick nick-6" title=ljharb@irc>ljharb</span>&gt;</td><td class="msg-cell">DYAC :-p</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Sat Mar 16 2019 09:07:39 GMT-0700 (Pacific Daylight Time)">16:07</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">so, do you have any ideas of what would meet your requirements, while also not encouraging races?</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Sat Mar 16 2019 09:21:05 GMT-0700 (Pacific Daylight Time)">16:21</a></td><td class="nick-cell">&lt;<span class="nick nick-6" title=ljharb@irc>ljharb</span>&gt;</td><td class="msg-cell">perhaps the same idea i said earlier, but the bindings start out as promises instead of undefined or in tdz?</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Sat Mar 16 2019 09:22:21 GMT-0700 (Pacific Daylight Time)">16:22</a></td><td class="nick-cell">&lt;<span class="nick nick-6" title=ljharb@irc>ljharb</span>&gt;</td><td class="msg-cell">it seems important that i can import a module that’s not using TLA, but that starts using import await, and that it doesn’t necessarily impact me</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Sat Mar 16 2019 12:19:58 GMT-0700 (Pacific Daylight Time)">19:19</a></td><td class="nick-cell">&lt;<span class="nick nick-4" title=MylesBorins@irc>MylesBorins</span>&gt;</td><td class="msg-cell">ljharb littledan it seems to me that if the &quot;import await&quot; is not viral there isn&#039;t much point to it. if just the consumer needs to know if would be dead simple for package authors to introduce a single level of indirection and never have to let consumers worry about it... in which case there really isn&#039;t any value in it</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Sat Mar 16 2019 12:25:48 GMT-0700 (Pacific Daylight Time)">19:25</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">Yeah, I am similarly confused. Also, it&#039;s really hard for me to imagine how you&#039;d use a module  when you don&#039;t know whether its bindings are Promises or not. Is everyone supposed to defensively await everything?</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Sat Mar 16 2019 12:26:41 GMT-0700 (Pacific Daylight Time)">19:26</a></td><td class="nick-cell">&lt;<span class="nick nick-10" title=littledan@irc>littledan</span>&gt;</td><td class="msg-cell">ljharb: Happy to keep bouncing ideas back and forth, but I think making all the exports into Promises wouldn&#039;t really work out</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Sat Mar 16 2019 13:15:27 GMT-0700 (Pacific Daylight Time)">20:15</a></td><td class="nick-cell">&lt;<span class="nick nick-6" title=ljharb@irc>ljharb</span>&gt;</td><td class="msg-cell">MylesBorins: if it is viral, then everyone will have to use it basically everywhere (unless, i suppose, if it errored on a sync module) but at that point either a graph leaf will never use TLA, limiting its usefulness, or it will, forcing the entire chain above it to use import await as well.</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Sat Mar 16 2019 13:16:07 GMT-0700 (Pacific Daylight Time)">20:16</a></td><td class="nick-cell">&lt;<span class="nick nick-6" title=ljharb@irc>ljharb</span>&gt;</td><td class="msg-cell">i suppose another alternative is that TLA modules can only be dynamically imported</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Sat Mar 16 2019 13:16:48 GMT-0700 (Pacific Daylight Time)">20:16</a></td><td class="nick-cell">&lt;<span class="nick nick-6" title=ljharb@irc>ljharb</span>&gt;</td><td class="msg-cell">and then `await import()` at the top level is how you’d consume that in a blocking fashion, and that would be your own TLA</td></tr>
</tbody></table>
</div></div></div></body>
