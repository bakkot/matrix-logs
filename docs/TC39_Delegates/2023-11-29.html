<!DOCTYPE html><html><head>
  <title>TC39 Delegates on 2023-11-29</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "TC39 Delegates";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">TC39 Delegates<br>2023-11-29<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2023-11-28" class="nav-link"><span>prev</span></a>
<a href="2023-11-30" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search TC39 Delegates">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Tue Nov 28 2023 16:44:02 GMT-0800 (Pacific Standard Time)">00:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">I will be happy to revisit it and add the omitted data properties as a proposal once the websites are fixed. I canâ€™t speak to chromes opinion on that tho.</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Tue Nov 28 2023 16:47:27 GMT-0800 (Pacific Standard Time)">00:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">assuming it's web-compat to do so, which it may not be</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Tue Nov 28 2023 16:47:48 GMT-0800 (Pacific Standard Time)">00:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">whereas it would almost certainly be web-compat to change the accessors to data properties as long as the people in this room agreed not to rely on them being accessors</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Tue Nov 28 2023 17:35:12 GMT-0800 (Pacific Standard Time)">01:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Do we just need to spec a special data property flag that allows assignment of the property on an instance even if the prototype is non-writable/non-configurable? It seems to me this isn't the last time this will come up.</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Tue Nov 28 2023 18:13:34 GMT-0800 (Pacific Standard Time)">02:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">I think that would be worse than just having a bunch of accessors.</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Wed Nov 29 2023 09:14:28 GMT-0800 (Pacific Standard Time)">17:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">FYI I will miss the first 90 minutes today</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Wed Nov 29 2023 09:22:13 GMT-0800 (Pacific Standard Time)">17:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell"><span class="nick-2">Rezvan</span>: Does Chrome have a position here? If these properties are omitted for now, would you consider attempting to add data properties again in the future, or are accessors the only option?</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Wed Nov 29 2023 10:02:18 GMT-0800 (Pacific Standard Time)">18:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@softwarechris:matrix.org">Chris de Almeida</span>&gt;</div></td><td class="msg-cell"><a href="https://matrix.to/#/#jsx:matrix.org">#jsx:matrix.org</a></td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Wed Nov 29 2023 10:04:40 GMT-0800 (Pacific Standard Time)">18:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I wonder if a generalized <code>canParse</code> solution for JS would be viable as an alternative to using <code>eval</code> or <code>Function</code> for syntactic feature testing</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Wed Nov 29 2023 10:09:13 GMT-0800 (Pacific Standard Time)">18:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@gibson042:matrix.org">Richard Gibson</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I wonder if a generalized <code>canParse</code> solution for JS would be viable as an alternative to using <code>eval</code> or <code>Function</code> for syntactic feature testing</blockquote></mx-reply>definitely, and similar to <a href="https://developer.mozilla.org/en-US/docs/Web/API/CSS/supports_static">CSS.supports</a></td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Wed Nov 29 2023 10:13:43 GMT-0800 (Pacific Standard Time)">18:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><p>how do people feel about</p>
<pre><code>Function.prototype.try = function(...args) {
  try {
    return { success: true, value: this.apply(null, args) };
  } catch {
    return { success: false, value: undefined };
  }
}
</code></pre>
<p>as in</p>
<pre><code>let { success, value } = JSON.parse.try(string);
</code></pre>
</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Wed Nov 29 2023 10:14:28 GMT-0800 (Pacific Standard Time)">18:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">only works for functions not methods, I guess</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Wed Nov 29 2023 10:15:06 GMT-0800 (Pacific Standard Time)">18:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">guess there could be a <code>tryWithThis</code> which would let you do <code>JSON.parse.try(JSON, string)</code></td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Wed Nov 29 2023 10:15:15 GMT-0800 (Pacific Standard Time)">18:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">i like that (the non-method one), it has the side benefit that it encourages use of standalone functions</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Wed Nov 29 2023 10:17:09 GMT-0800 (Pacific Standard Time)">18:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@gibson042:matrix.org">Richard Gibson</span>&gt;</div></td><td class="msg-cell"><code>let { success, value } = tryApply(fn, thisArgument, argumentsList)</code> would be language-consistent but less ergonomic</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Wed Nov 29 2023 10:17:36 GMT-0800 (Pacific Standard Time)">18:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><code>fn.tryApply(thisArgument, argumentsList)</code> is at least as consistent, surely</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Wed Nov 29 2023 10:18:09 GMT-0800 (Pacific Standard Time)">18:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">i'd swap those two but sure (<code>thisArg</code> goes last, just like all the array methods, since it's more optional than args)</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Wed Nov 29 2023 10:18:29 GMT-0800 (Pacific Standard Time)">18:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@gibson042:matrix.org">Richard Gibson</span>&gt;</div></td><td class="msg-cell">or I guess <code>fn.tryCall(thisArgument, ...args)</code></td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Wed Nov 29 2023 10:18:49 GMT-0800 (Pacific Standard Time)">18:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> i'd swap those two but sure (<code>thisArg</code> goes last, just like all the array methods, since it's more optional than args)</blockquote></mx-reply>I disagree, <code>thisArg</code> should come first, like <code>call</code> and <code>apply</code></td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Wed Nov 29 2023 10:19:02 GMT-0800 (Pacific Standard Time)">18:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">oh hm, i guess i see that argument too</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Wed Nov 29 2023 10:19:02 GMT-0800 (Pacific Standard Time)">18:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">but also I would want a version that doesn't take <code>this</code> at all</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Wed Nov 29 2023 10:19:23 GMT-0800 (Pacific Standard Time)">18:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">i get this feeling that like</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Wed Nov 29 2023 10:19:23 GMT-0800 (Pacific Standard Time)">18:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">so specifically I think I like best <code>.try</code>, which is only useful for non-methods, and <code>.tryCall</code>, which adds an initial <code>this</code> parameter</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Wed Nov 29 2023 10:19:26 GMT-0800 (Pacific Standard Time)">18:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">yeah if the thisArg has to come first in a call/apply variant then i'd def want yet another one that omitted the receiver entirely</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Wed Nov 29 2023 10:19:31 GMT-0800 (Pacific Standard Time)">18:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">async modules are some sort of fundamental failure</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Wed Nov 29 2023 10:19:32 GMT-0800 (Pacific Standard Time)">18:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@gibson042:matrix.org">Richard Gibson</span>&gt;</div></td><td class="msg-cell">yeah, that's the friction point</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Wed Nov 29 2023 10:19:36 GMT-0800 (Pacific Standard Time)">18:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">because everyone keeps trying to build ways to disable them</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Wed Nov 29 2023 10:19:51 GMT-0800 (Pacific Standard Time)">18:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">but i don't want them to be some sort of fundamental failure</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Wed Nov 29 2023 10:19:53 GMT-0800 (Pacific Standard Time)">18:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">i really like them</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Wed Nov 29 2023 10:20:13 GMT-0800 (Pacific Standard Time)">18:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">agreed on both points</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Wed Nov 29 2023 10:23:11 GMT-0800 (Pacific Standard Time)">18:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">another place where async modules were no longer used <a href="https://github.com/WebAssembly/esm-integration/pull/76">https://github.com/WebAssembly/esm-integration/pull/76</a></td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Wed Nov 29 2023 10:24:44 GMT-0800 (Pacific Standard Time)">18:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">lol if we end up doing a directive, there's going to be a deluge of pragma/directive proposals once "no more modes" isn't a law anymore</td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Wed Nov 29 2023 10:25:12 GMT-0800 (Pacific Standard Time)">18:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">eh, I think directives which either evaluate normally or cause errors aren't really new modes</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Wed Nov 29 2023 10:25:15 GMT-0800 (Pacific Standard Time)">18:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">This directive wouldn't be a new mode like strict vs sloppy</td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Wed Nov 29 2023 10:25:36 GMT-0800 (Pacific Standard Time)">18:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">It doesn't introduce a new "language version"</td></tr>
  <tr class="msg" id="L35"><td class="ts-cell"><a class="ts" href="#L35" alt="Wed Nov 29 2023 10:25:48 GMT-0800 (Pacific Standard Time)">18:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">No more than doing the same through any other syntax</td></tr>
  <tr class="msg" id="L36"><td class="ts-cell"><a class="ts" href="#L36" alt="Wed Nov 29 2023 10:25:50 GMT-0800 (Pacific Standard Time)">18:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">lol yeah i understand the nuance, but i don't think it will come across</td></tr>
  <tr class="msg" id="L37"><td class="ts-cell"><a class="ts" href="#L37" alt="Wed Nov 29 2023 10:29:23 GMT-0800 (Pacific Standard Time)">18:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><code>export with { sync: true }</code>? Not a huge fan of how it reads though.</td></tr>
  <tr class="msg" id="L38"><td class="ts-cell"><a class="ts" href="#L38" alt="Wed Nov 29 2023 10:29:34 GMT-0800 (Pacific Standard Time)">18:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">ps here's a relevant snippet from the notes from 2018 related to this exact problem: <a href="https://github.com/tc39/notes/blob/df1449925841bc77574e8e127611234670275575/meetings/2019-03/mar-28.md?plain=1#L507-L519">https://github.com/tc39/notes/blob/df1449925841bc77574e8e127611234670275575/meetings/2019-03/mar-28.md?plain=1#L507-L519</a></td></tr>
  <tr class="msg" id="L39"><td class="ts-cell"><a class="ts" href="#L39" alt="Wed Nov 29 2023 10:36:06 GMT-0800 (Pacific Standard Time)">18:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">oh man i would hate if nodejs was another reason for people to not use async modules</td></tr>
  <tr class="msg" id="L40"><td class="ts-cell"><a class="ts" href="#L40" alt="Wed Nov 29 2023 10:36:08 GMT-0800 (Pacific Standard Time)">18:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">that would kill me</td></tr>
  <tr class="msg" id="L41"><td class="ts-cell"><a class="ts" href="#L41" alt="Wed Nov 29 2023 10:40:14 GMT-0800 (Pacific Standard Time)">18:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@peetk:matrix.org">peetk</span>&gt;</div></td><td class="msg-cell">what about a function or bit of syntax that {tells you whether/asserts !} you've hit the event loop? i feel like that's always what you really care about in these worker listener cases</td></tr>
  <tr class="msg" id="L42"><td class="ts-cell"><a class="ts" href="#L42" alt="Wed Nov 29 2023 10:48:47 GMT-0800 (Pacific Standard Time)">18:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">If you have multiple script tags the event loop will start spinning before that the module even starts running, so it would always say "yes"</td></tr>
  <tr class="msg" id="L43"><td class="ts-cell"><a class="ts" href="#L43" alt="Wed Nov 29 2023 10:50:04 GMT-0800 (Pacific Standard Time)">18:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">Example: you load an analytics script and your main entry point module, and the analytics script already spins the event loop</td></tr>
  <tr class="msg" id="L44"><td class="ts-cell"><a class="ts" href="#L44" alt="Wed Nov 29 2023 10:56:11 GMT-0800 (Pacific Standard Time)">18:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@peetk:matrix.org">peetk</span>&gt;</div></td><td class="msg-cell">then that would be the correct result right?</td></tr>
  <tr class="msg" id="L45"><td class="ts-cell"><a class="ts" href="#L45" alt="Wed Nov 29 2023 10:56:54 GMT-0800 (Pacific Standard Time)">18:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@peetk:matrix.org">peetk</span>&gt;</div></td><td class="msg-cell">if you are a worker and you need to register listeners to handle messages then you absolutely must register them before you hit the event loop</td></tr>
  <tr class="msg" id="L46"><td class="ts-cell"><a class="ts" href="#L46" alt="Wed Nov 29 2023 10:58:02 GMT-0800 (Pacific Standard Time)">18:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@robpalme:matrix.org">Rob Palmer</span>&gt;</div></td><td class="msg-cell">I see a barrel library</td></tr>
  <tr class="msg" id="L47"><td class="ts-cell"><a class="ts" href="#L47" alt="Wed Nov 29 2023 11:00:21 GMT-0800 (Pacific Standard Time)">19:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">deferred imports make me very nervous; a keyword on <code>export</code> that's a lazily evaluated thing on the first import seems pretty nice - it might turn treeshaking from a half-assed hack into a reliable mechanism</td></tr>
  <tr class="msg" id="L48"><td class="ts-cell"><a class="ts" href="#L48" alt="Wed Nov 29 2023 11:02:30 GMT-0800 (Pacific Standard Time)">19:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@robpalme:matrix.org">Rob Palmer</span>&gt;</div></td><td class="msg-cell">It's like runtime treeshaking.  You only get the bits of the barrel you need.</td></tr>
  <tr class="msg" id="L49"><td class="ts-cell"><a class="ts" href="#L49" alt="Wed Nov 29 2023 11:03:02 GMT-0800 (Pacific Standard Time)">19:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">... treeshaking seems like a pretty reliable mechanism in the current world in fact?</td></tr>
  <tr class="msg" id="L50"><td class="ts-cell"><a class="ts" href="#L50" alt="Wed Nov 29 2023 11:03:04 GMT-0800 (Pacific Standard Time)">19:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@robpalme:matrix.org">Rob Palmer</span>&gt;</div></td><td class="msg-cell">And it can progressively load more of the barrel just-in-time</td></tr>
  <tr class="msg" id="L51"><td class="ts-cell"><a class="ts" href="#L51" alt="Wed Nov 29 2023 11:03:47 GMT-0800 (Pacific Standard Time)">19:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> ... treeshaking seems like a pretty reliable mechanism in the current world in fact?</blockquote></mx-reply>not in every codebase i've worked in; changing to deep imports and prohibiting barrel files has consistently produced MASSIVE savings</td></tr>
  <tr class="msg" id="L52"><td class="ts-cell"><a class="ts" href="#L52" alt="Wed Nov 29 2023 11:03:55 GMT-0800 (Pacific Standard Time)">19:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">coinbase's react native app size dropped by 71% (seventy-one, not a typo) with that change</td></tr>
  <tr class="msg" id="L53"><td class="ts-cell"><a class="ts" href="#L53" alt="Wed Nov 29 2023 11:04:16 GMT-0800 (Pacific Standard Time)">19:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell">it should really make defer become default back when tc39 design ES module in ES6</td></tr>
  <tr class="msg" id="L54"><td class="ts-cell"><a class="ts" href="#L54" alt="Wed Nov 29 2023 11:04:56 GMT-0800 (Pacific Standard Time)">19:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@robpalme:matrix.org">Rob Palmer</span>&gt;</div></td><td class="msg-cell">Tree-shaking only works when the compiler can see the full-scope of the program. That's not always possible in dynamically linked systems.</td></tr>
  <tr class="msg" id="L55"><td class="ts-cell"><a class="ts" href="#L55" alt="Wed Nov 29 2023 11:05:31 GMT-0800 (Pacific Standard Time)">19:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@robpalme:matrix.org">Rob Palmer</span>&gt;</div></td><td class="msg-cell">The perf issues of barrel files are well-documented
<a href="https://marvinh.dev/blog/speeding-up-javascript-ecosystem-part-7/">https://marvinh.dev/blog/speeding-up-javascript-ecosystem-part-7/</a></td></tr>
  <tr class="msg" id="L56"><td class="ts-cell"><a class="ts" href="#L56" alt="Wed Nov 29 2023 11:05:38 GMT-0800 (Pacific Standard Time)">19:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">even then, my statement holds. coinbase's RN app had no dynamic linking.</td></tr>
  <tr class="msg" id="L57"><td class="ts-cell"><a class="ts" href="#L57" alt="Wed Nov 29 2023 11:05:52 GMT-0800 (Pacific Standard Time)">19:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell">and requires <code>"sideEffects: false"</code> in your package.json which is not everyone remembers to add</td></tr>
  <tr class="msg" id="L58"><td class="ts-cell"><a class="ts" href="#L58" alt="Wed Nov 29 2023 11:06:33 GMT-0800 (Pacific Standard Time)">19:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">and which isn't granular enough to support packages with one side-effecting code path and many non-side-effecting code paths, eg</td></tr>
  <tr class="msg" id="L59"><td class="ts-cell"><a class="ts" href="#L59" alt="Wed Nov 29 2023 11:07:55 GMT-0800 (Pacific Standard Time)">19:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">i can confirm, importing fewer things is faster</td></tr>
  <tr class="msg" id="L60"><td class="ts-cell"><a class="ts" href="#L60" alt="Wed Nov 29 2023 11:09:33 GMT-0800 (Pacific Standard Time)">19:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> and which isn't granular enough to support packages with one side-effecting code path and many non-side-effecting code paths, eg</blockquote></mx-reply>actually it supports, you can write <code>"sideEffects": ["./src/init/**"]</code></td></tr>
  <tr class="msg" id="L61"><td class="ts-cell"><a class="ts" href="#L61" alt="Wed Nov 29 2023 11:10:35 GMT-0800 (Pacific Standard Time)">19:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">ooh, TIL, thanks</td></tr>
  <tr class="msg" id="L62"><td class="ts-cell"><a class="ts" href="#L62" alt="Wed Nov 29 2023 11:12:20 GMT-0800 (Pacific Standard Time)">19:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> coinbase's react native app size dropped by 71% (seventy-one, not a typo) with that change</blockquote></mx-reply>that is wild to me. they just... had a bunch of side effects? for some reason?</td></tr>
  <tr class="msg" id="L63"><td class="ts-cell"><a class="ts" href="#L63" alt="Wed Nov 29 2023 11:13:01 GMT-0800 (Pacific Standard Time)">19:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">no, it's that treeshaking simply isn't capable of safely judging that, and so the necessary heuristics leave behind way more code than is actually used</td></tr>
  <tr class="msg" id="L64"><td class="ts-cell"><a class="ts" href="#L64" alt="Wed Nov 29 2023 11:13:34 GMT-0800 (Pacific Standard Time)">19:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">in the past, rollup's heuristics (when rollup was the only treeshaker) were too aggressive, and it broke <a href="http://airbnb.com">airbnb.com</a> in IE for months, so it's a really hard line to walk</td></tr>
  <tr class="msg" id="L65"><td class="ts-cell"><a class="ts" href="#L65" alt="Wed Nov 29 2023 11:13:45 GMT-0800 (Pacific Standard Time)">19:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">that has not been my experience at all; do you have an example where the heuristics fail?</td></tr>
  <tr class="msg" id="L66"><td class="ts-cell"><a class="ts" href="#L66" alt="Wed Nov 29 2023 11:14:08 GMT-0800 (Pacific Standard Time)">19:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">tbf i haven't dived into treeshaking tools to know exactly what it is; that's just the sense i have seeing the empirical results</td></tr>
  <tr class="msg" id="L67"><td class="ts-cell"><a class="ts" href="#L67" alt="Wed Nov 29 2023 11:15:10 GMT-0800 (Pacific Standard Time)">19:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@robpalme:matrix.org">Rob Palmer</span>&gt;</div></td><td class="msg-cell">Statically judging whether JS code has side-effects is hard - probably impossible - so compilers take a safety-first approach and bail out unless they are really sure dead code is safe to remove.  This is why treeshaking is not always effective.</td></tr>
  <tr class="msg" id="L68"><td class="ts-cell"><a class="ts" href="#L68" alt="Wed Nov 29 2023 11:15:20 GMT-0800 (Pacific Standard Time)">19:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">the lesson here should be just don't use side effects</td></tr>
  <tr class="msg" id="L69"><td class="ts-cell"><a class="ts" href="#L69" alt="Wed Nov 29 2023 11:15:32 GMT-0800 (Pacific Standard Time)">19:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">i wonder if this js code halts</td></tr>
  <tr class="msg" id="L70"><td class="ts-cell"><a class="ts" href="#L70" alt="Wed Nov 29 2023 11:15:43 GMT-0800 (Pacific Standard Time)">19:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">the lesson most of us have taken is, don't use barrel files :-)</td></tr>
  <tr class="msg" id="L71"><td class="ts-cell"><a class="ts" href="#L71" alt="Wed Nov 29 2023 11:16:20 GMT-0800 (Pacific Standard Time)">19:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">i wish prepack was still a thing</td></tr>
  <tr class="msg" id="L72"><td class="ts-cell"><a class="ts" href="#L72" alt="Wed Nov 29 2023 11:18:57 GMT-0800 (Pacific Standard Time)">19:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> the lesson most of us have taken is, don't use barrel files :-)</blockquote></mx-reply>and with this proposal, barrel files suddenly becomes a performance benefit</td></tr>
  <tr class="msg" id="L73"><td class="ts-cell"><a class="ts" href="#L73" alt="Wed Nov 29 2023 11:19:03 GMT-0800 (Pacific Standard Time)">19:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell">thankfully 0% of my code has side-effects, it's all overhead</td></tr>
  <tr class="msg" id="L74"><td class="ts-cell"><a class="ts" href="#L74" alt="Wed Nov 29 2023 11:19:20 GMT-0800 (Pacific Standard Time)">19:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Statically judging whether JS code has side-effects is hard - probably impossible - so compilers take a safety-first approach and bail out unless they are really sure dead code is safe to remove.  This is why treeshaking is not always effective.</blockquote></mx-reply>Right but only if you're writing code in such a way that it's hard to analyze; my experience has been, dependencies which I consider of adequate quality to add to my projects are, in general, written in such a way that this is trivial to analyze</td></tr>
  <tr class="msg" id="L75"><td class="ts-cell"><a class="ts" href="#L75" alt="Wed Nov 29 2023 11:19:27 GMT-0800 (Pacific Standard Time)">19:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">I am surprised to learn this is not everyone's experience</td></tr>
  <tr class="msg" id="L76"><td class="ts-cell"><a class="ts" href="#L76" alt="Wed Nov 29 2023 11:20:18 GMT-0800 (Pacific Standard Time)">19:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">tbh i'm surprised it's anyone's. the above article got quite a lot of +1s on twitter and virtually no pushback that i saw</td></tr>
  <tr class="msg" id="L77"><td class="ts-cell"><a class="ts" href="#L77" alt="Wed Nov 29 2023 11:20:24 GMT-0800 (Pacific Standard Time)">19:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">after reading the article on what these are, I feel like this should have been obvious from the beginning</td></tr>
  <tr class="msg" id="L78"><td class="ts-cell"><a class="ts" href="#L78" alt="Wed Nov 29 2023 11:20:27 GMT-0800 (Pacific Standard Time)">19:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">people be crazy</td></tr>
  <tr class="msg" id="L79"><td class="ts-cell"><a class="ts" href="#L79" alt="Wed Nov 29 2023 11:21:04 GMT-0800 (Pacific Standard Time)">19:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">the article above was only talking runtime, not treeshaking</td></tr>
  <tr class="msg" id="L80"><td class="ts-cell"><a class="ts" href="#L80" alt="Wed Nov 29 2023 11:21:11 GMT-0800 (Pacific Standard Time)">19:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">in fact it specifically says "treeshaking solves this"</td></tr>
  <tr class="msg" id="L81"><td class="ts-cell"><a class="ts" href="#L81" alt="Wed Nov 29 2023 11:21:24 GMT-0800 (Pacific Standard Time)">19:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><blockquote>
<p>you then run the bundled file to repeat the experiment and voilÃ¡, it finishes in a blink of an eye. Out of curiosity, you measure the time it takes to run esbuild and run the bundled file together and notice that both of them combined are still quicker than running the original source code. Huh? What is going on?</p>
</blockquote>
</td></tr>
  <tr class="msg" id="L82"><td class="ts-cell"><a class="ts" href="#L82" alt="Wed Nov 29 2023 11:21:56 GMT-0800 (Pacific Standard Time)">19:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">"waah, I want one import line instead of five, I'm going to <em>blindly merge others' namespaces</em>, that seems like an okay trade-off"</td></tr>
  <tr class="msg" id="L83"><td class="ts-cell"><a class="ts" href="#L83" alt="Wed Nov 29 2023 11:22:09 GMT-0800 (Pacific Standard Time)">19:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">ðŸ¤®</td></tr>
  <tr class="msg" id="L84"><td class="ts-cell"><a class="ts" href="#L84" alt="Wed Nov 29 2023 11:24:48 GMT-0800 (Pacific Standard Time)">19:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">ah fair, i was remembering some twitter discussion then i guess, not the article</td></tr>
  <tr class="msg" id="L85"><td class="ts-cell"><a class="ts" href="#L85" alt="Wed Nov 29 2023 11:26:45 GMT-0800 (Pacific Standard Time)">19:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">multiple exports was a mistake</td></tr>
  <tr class="msg" id="L86"><td class="ts-cell"><a class="ts" href="#L86" alt="Wed Nov 29 2023 11:36:31 GMT-0800 (Pacific Standard Time)">19:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">ugh we have a bug in PerformEval: it doesn't ever ToString its argument <a href="https://tc39.es/ecma262/#sec-performeval">https://tc39.es/ecma262/#sec-performeval</a></td></tr>
  <tr class="msg" id="L87"><td class="ts-cell"><a class="ts" href="#L87" alt="Wed Nov 29 2023 11:37:34 GMT-0800 (Pacific Standard Time)">19:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">oh wait, never mind, it just can't reach that point without being a String</td></tr>
  <tr class="msg" id="L88"><td class="ts-cell"><a class="ts" href="#L88" alt="Wed Nov 29 2023 11:37:34 GMT-0800 (Pacific Standard Time)">19:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">I got it</td></tr>
  <tr class="msg" id="L89"><td class="ts-cell"><a class="ts" href="#L89" alt="Wed Nov 29 2023 11:41:20 GMT-0800 (Pacific Standard Time)">19:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">the thing where <code>eval</code> is the identity function on non-string arguments is... very strange</td></tr>
  <tr class="msg" id="L90"><td class="ts-cell"><a class="ts" href="#L90" alt="Wed Nov 29 2023 11:45:26 GMT-0800 (Pacific Standard Time)">19:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">I prefer option 2 because it will extend to TT better</td></tr>
  <tr class="msg" id="L91"><td class="ts-cell"><a class="ts" href="#L91" alt="Wed Nov 29 2023 11:48:34 GMT-0800 (Pacific Standard Time)">19:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell"><pre><code>function unsafeMaybeNotAString(v) {
  return Object.is(v, eval(v));
}
</code></pre>
</td></tr>
  <tr class="msg" id="L92"><td class="ts-cell"><a class="ts" href="#L92" alt="Wed Nov 29 2023 11:48:38 GMT-0800 (Pacific Standard Time)">19:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell"><span class="nick-6">ljharb</span>: we need to figure out what we're going to do with iterator helpers ASAP</td></tr>
  <tr class="msg" id="L93"><td class="ts-cell"><a class="ts" href="#L93" alt="Wed Nov 29 2023 11:49:03 GMT-0800 (Pacific Standard Time)">19:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">the accessors approach seems safest to me, even if it makes us feel a little bit gross</td></tr>
  <tr class="msg" id="L94"><td class="ts-cell"><a class="ts" href="#L94" alt="Wed Nov 29 2023 11:49:17 GMT-0800 (Pacific Standard Time)">19:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">i'd love to hear v8's position on the two options, but i still don't feel that accessors are safer</td></tr>
  <tr class="msg" id="L95"><td class="ts-cell"><a class="ts" href="#L95" alt="Wed Nov 29 2023 11:49:19 GMT-0800 (Pacific Standard Time)">19:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">I won't die on that hill though; either solution works for now</td></tr>
  <tr class="msg" id="L96"><td class="ts-cell"><a class="ts" href="#L96" alt="Wed Nov 29 2023 11:50:07 GMT-0800 (Pacific Standard Time)">19:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">if we go with "omit" i will be happy to immediately make a new proposal to reintroduce them, and will coordinate with the person from the issue to track upgrading those sites, fwiw</td></tr>
  <tr class="msg" id="L97"><td class="ts-cell"><a class="ts" href="#L97" alt="Wed Nov 29 2023 11:50:30 GMT-0800 (Pacific Standard Time)">19:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">that doesn't mean you'll have engine support to experiment with shipping them though</td></tr>
  <tr class="msg" id="L98"><td class="ts-cell"><a class="ts" href="#L98" alt="Wed Nov 29 2023 11:50:40 GMT-0800 (Pacific Standard Time)">19:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">right, which is why i want to hear v8's position first</td></tr>
  <tr class="msg" id="L99"><td class="ts-cell"><a class="ts" href="#L99" alt="Wed Nov 29 2023 11:50:54 GMT-0800 (Pacific Standard Time)">19:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell"><span class="nick-2">Rezvan</span> is the V8 rep at this meeting</td></tr>
  <tr class="msg" id="L100"><td class="ts-cell"><a class="ts" href="#L100" alt="Wed Nov 29 2023 11:51:43 GMT-0800 (Pacific Standard Time)">19:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell"><code>unsafeMaybeNotAString("v")</code></td></tr>
  <tr class="msg" id="L101"><td class="ts-cell"><a class="ts" href="#L101" alt="Wed Nov 29 2023 11:53:03 GMT-0800 (Pacific Standard Time)">19:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell"><pre><code>function unsafeMaybeNotAString(v) {
  return Object.is(v, (0, eval(v)));
}
</code></pre>
</td></tr>
  <tr class="msg" id="L102"><td class="ts-cell"><a class="ts" href="#L102" alt="Wed Nov 29 2023 11:53:35 GMT-0800 (Pacific Standard Time)">19:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell">Level 2</td></tr>
  <tr class="msg" id="L103"><td class="ts-cell"><a class="ts" href="#L103" alt="Wed Nov 29 2023 11:54:03 GMT-0800 (Pacific Standard Time)">19:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I'm generally partial to "omit" as well. While I understand bakkot's concerns around <code>x.constructor === whatever</code>, I think there is a fairly low likelihood of that becoming a problem if there is a short turnaround on a follow-on proposal and the outstanding sites being fixed.</td></tr>
  <tr class="msg" id="L104"><td class="ts-cell"><a class="ts" href="#L104" alt="Wed Nov 29 2023 11:54:04 GMT-0800 (Pacific Standard Time)">19:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell">can strings be quines</td></tr>
  <tr class="msg" id="L105"><td class="ts-cell"><a class="ts" href="#L105" alt="Wed Nov 29 2023 11:56:05 GMT-0800 (Pacific Standard Time)">19:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell"><pre><code>unsafeMaybeNotAString(`(function _(){return'('+_+')()'})()`)
</code></pre>
</td></tr>
  <tr class="msg" id="L106"><td class="ts-cell"><a class="ts" href="#L106" alt="Wed Nov 29 2023 11:56:20 GMT-0800 (Pacific Standard Time)">19:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">also the <code>toString</code> of an Iterator will change</td></tr>
  <tr class="msg" id="L107"><td class="ts-cell"><a class="ts" href="#L107" alt="Wed Nov 29 2023 11:56:24 GMT-0800 (Pacific Standard Time)">19:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Though I still think there's potential for a general solution to the "override mistake", such as adding a new PropertyDescriptor flag to opt-in to a behavior that allows setting on an instance even if the property is frozen on the prototype.</td></tr>
  <tr class="msg" id="L108"><td class="ts-cell"><a class="ts" href="#L108" alt="Wed Nov 29 2023 11:56:52 GMT-0800 (Pacific Standard Time)">19:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">From what it is in the proposal spec, or do you mean from what it is on <code>%IteratorPrototype%</code> currently?</td></tr>
  <tr class="msg" id="L109"><td class="ts-cell"><a class="ts" href="#L109" alt="Wed Nov 29 2023 11:57:16 GMT-0800 (Pacific Standard Time)">19:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">from what's in the draft spec as of now</td></tr>
  <tr class="msg" id="L110"><td class="ts-cell"><a class="ts" href="#L110" alt="Wed Nov 29 2023 11:57:49 GMT-0800 (Pacific Standard Time)">19:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">it is proposed as "[object Iterator]" and will be "[object Object]" temporarily</td></tr>
  <tr class="msg" id="L111"><td class="ts-cell"><a class="ts" href="#L111" alt="Wed Nov 29 2023 11:58:01 GMT-0800 (Pacific Standard Time)">19:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">like... why do that?</td></tr>
  <tr class="msg" id="L112"><td class="ts-cell"><a class="ts" href="#L112" alt="Wed Nov 29 2023 11:58:22 GMT-0800 (Pacific Standard Time)">19:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">this is just unnecessary risk and I really don't see the upside other than warm fuzzies</td></tr>
  <tr class="msg" id="L113"><td class="ts-cell"><a class="ts" href="#L113" alt="Wed Nov 29 2023 12:01:46 GMT-0800 (Pacific Standard Time)">20:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I don't have a preference regarding toString/toStringTag, tbh. I generally wouldn't recommend relying on it for anything other than a debugging aid, so its presence or absence isn't that concerning to me.</td></tr>
  <tr class="msg" id="L114"><td class="ts-cell"><a class="ts" href="#L114" alt="Wed Nov 29 2023 12:32:25 GMT-0800 (Pacific Standard Time)">20:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@rmahdav:matrix.org">Rezvan</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> right, which is why i want to hear v8's position first</blockquote></mx-reply>V8 is supporting the PR (<a href="https://github.com/tc39/proposal-iterator-helpers/pull/287">https://github.com/tc39/proposal-iterator-helpers/pull/287</a>) Michael talked about yesterday. This incompatibility blocked us for shipping iterator helpers. The solution provided in the PR seems to be the best way to resolve the issue.</td></tr>
  <tr class="msg" id="L115"><td class="ts-cell"><a class="ts" href="#L115" alt="Wed Nov 29 2023 12:32:53 GMT-0800 (Pacific Standard Time)">20:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> V8 is supporting the PR (<a href="https://github.com/tc39/proposal-iterator-helpers/pull/287">https://github.com/tc39/proposal-iterator-helpers/pull/287</a>) Michael talked about yesterday. This incompatibility blocked us for shipping iterator helpers. The solution provided in the PR seems to be the best way to resolve the issue.</blockquote></mx-reply>thanks; and does v8 have an opinion about, instead of the PR, just not implementing the constructor and Symbol.toStringTag properties for the time being?</td></tr>
  <tr class="msg" id="L116"><td class="ts-cell"><a class="ts" href="#L116" alt="Wed Nov 29 2023 12:33:31 GMT-0800 (Pacific Standard Time)">20:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">and additionally, with either approach, is Chrome willing to try to ship them as normal data properties in the future once the incompatible websites have finished upgrading?</td></tr>
  <tr class="msg" id="L117"><td class="ts-cell"><a class="ts" href="#L117" alt="Wed Nov 29 2023 12:51:38 GMT-0800 (Pacific Standard Time)">20:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@rmahdav:matrix.org">Rezvan</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> thanks; and does v8 have an opinion about, instead of the PR, just not implementing the constructor and Symbol.toStringTag properties for the time being?</blockquote></mx-reply>I am not sure about this. I do not remember anything related to this in our discussions with Shu.</td></tr>
  <tr class="msg" id="L118"><td class="ts-cell"><a class="ts" href="#L118" alt="Wed Nov 29 2023 12:52:22 GMT-0800 (Pacific Standard Time)">20:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@rmahdav:matrix.org">Rezvan</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> and additionally, with either approach, is Chrome willing to try to ship them as normal data properties in the future once the incompatible websites have finished upgrading?</blockquote></mx-reply>About this one, I think the answer is yes. <span class="nick-14">Michael Ficarra</span> Since you had discussions with Shu, what do you think about it?</td></tr>
  <tr class="msg" id="L119"><td class="ts-cell"><a class="ts" href="#L119" alt="Wed Nov 29 2023 12:59:35 GMT-0800 (Pacific Standard Time)">20:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@haxjs:matrix.org">hax (HE Shi-Jun)</span>&gt;</div></td><td class="msg-cell">slide link of next topic: <a href="https://johnhax.net/2023/slice/slide">https://johnhax.net/2023/slice/slide</a></td></tr>
  <tr class="msg" id="L120"><td class="ts-cell"><a class="ts" href="#L120" alt="Wed Nov 29 2023 13:00:25 GMT-0800 (Pacific Standard Time)">21:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell"><span class="nick-2">Rezvan</span> <span class="nick-6">ljharb</span> we didn't talk about that</td></tr>
  <tr class="msg" id="L121"><td class="ts-cell"><a class="ts" href="#L121" alt="Wed Nov 29 2023 13:02:53 GMT-0800 (Pacific Standard Time)">21:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@rmahdav:matrix.org">Rezvan</span>&gt;</div></td><td class="msg-cell">So, my answer was my opinion. Not sure if Shu thinks the same.</td></tr>
  <tr class="msg" id="L122"><td class="ts-cell"><a class="ts" href="#L122" alt="Wed Nov 29 2023 13:13:04 GMT-0800 (Pacific Standard Time)">21:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">I've never met anyone who knows the parameter meaning and order for both slice and splice off the top of their head</td></tr>
  <tr class="msg" id="L123"><td class="ts-cell"><a class="ts" href="#L123" alt="Wed Nov 29 2023 13:13:31 GMT-0800 (Pacific Standard Time)">21:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">other than <code>slice(n)</code>, I look them up every time</td></tr>
  <tr class="msg" id="L124"><td class="ts-cell"><a class="ts" href="#L124" alt="Wed Nov 29 2023 13:13:39 GMT-0800 (Pacific Standard Time)">21:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@softwarechris:matrix.org">Chris de Almeida</span>&gt;</div></td><td class="msg-cell">mdn. every time</td></tr>
  <tr class="msg" id="L125"><td class="ts-cell"><a class="ts" href="#L125" alt="Wed Nov 29 2023 13:14:04 GMT-0800 (Pacific Standard Time)">21:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> mdn. every time</blockquote></mx-reply>Quick-info in VS Code :)</td></tr>
  <tr class="msg" id="L126"><td class="ts-cell"><a class="ts" href="#L126" alt="Wed Nov 29 2023 13:14:35 GMT-0800 (Pacific Standard Time)">21:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@softwarechris:matrix.org">Chris de Almeida</span>&gt;</div></td><td class="msg-cell">my vscode-fu need polishing for sure</td></tr>
  <tr class="msg" id="L127"><td class="ts-cell"><a class="ts" href="#L127" alt="Wed Nov 29 2023 13:14:54 GMT-0800 (Pacific Standard Time)">21:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">i know slice but only because i've trained myself to see the "p" so hard, at which point i immediately have to look it up every time</td></tr>
  <tr class="msg" id="L128"><td class="ts-cell"><a class="ts" href="#L128" alt="Wed Nov 29 2023 13:15:16 GMT-0800 (Pacific Standard Time)">21:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> my vscode-fu need polishing for sure</blockquote></mx-reply>Usually just <code>array.slice(</code> is enough assuming the language service knows <code>array</code> is an array type</td></tr>
  <tr class="msg" id="L129"><td class="ts-cell"><a class="ts" href="#L129" alt="Wed Nov 29 2023 13:15:22 GMT-0800 (Pacific Standard Time)">21:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">I can never remember which of the string methods support negative indices.</td></tr>
  <tr class="msg" id="L130"><td class="ts-cell"><a class="ts" href="#L130" alt="Wed Nov 29 2023 13:16:28 GMT-0800 (Pacific Standard Time)">21:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@softwarechris:matrix.org">Chris de Almeida</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Usually just <code>array.slice(</code> is enough assuming the language service knows <code>array</code> is an array type</blockquote></mx-reply>oh true.. I guess I start thinking about it before I start writing the code.. like I don't get to slice( and then start wondering</td></tr>
  <tr class="msg" id="L131"><td class="ts-cell"><a class="ts" href="#L131" alt="Wed Nov 29 2023 13:16:35 GMT-0800 (Pacific Standard Time)">21:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">this vscode example doesn't look like a bug to me</td></tr>
  <tr class="msg" id="L132"><td class="ts-cell"><a class="ts" href="#L132" alt="Wed Nov 29 2023 13:16:43 GMT-0800 (Pacific Standard Time)">21:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Yeah, not a bug. </td></tr>
  <tr class="msg" id="L133"><td class="ts-cell"><a class="ts" href="#L133" alt="Wed Nov 29 2023 13:17:26 GMT-0800 (Pacific Standard Time)">21:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">The line assumes <code>subcommand</code> exists as an element, because that's the only way you can get to that line to begin with.</td></tr>
  <tr class="msg" id="L134"><td class="ts-cell"><a class="ts" href="#L134" alt="Wed Nov 29 2023 13:18:32 GMT-0800 (Pacific Standard Time)">21:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">that's what I figured</td></tr>
  <tr class="msg" id="L135"><td class="ts-cell"><a class="ts" href="#L135" alt="Wed Nov 29 2023 13:29:56 GMT-0800 (Pacific Standard Time)">21:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">:-( my queue reply was skipped</td></tr>
  <tr class="msg" id="L136"><td class="ts-cell"><a class="ts" href="#L136" alt="Wed Nov 29 2023 13:29:58 GMT-0800 (Pacific Standard Time)">21:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@softwarechris:matrix.org">Chris de Almeida</span>&gt;</div></td><td class="msg-cell">apologies <span class="nick-14">Michael Ficarra</span> didn't see your reply in time</td></tr>
  <tr class="msg" id="L137"><td class="ts-cell"><a class="ts" href="#L137" alt="Wed Nov 29 2023 13:30:26 GMT-0800 (Pacific Standard Time)">21:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">this is why we need <a href="https://github.com/bterlson/tcq/issues/65">https://github.com/bterlson/tcq/issues/65</a></td></tr>
  <tr class="msg" id="L138"><td class="ts-cell"><a class="ts" href="#L138" alt="Wed Nov 29 2023 13:31:49 GMT-0800 (Pacific Standard Time)">21:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">by "reified" do we mean like, a noun that represents a kind of "view" on an array/string?</td></tr>
  <tr class="msg" id="L139"><td class="ts-cell"><a class="ts" href="#L139" alt="Wed Nov 29 2023 13:31:49 GMT-0800 (Pacific Standard Time)">21:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">anyway, I was trying to point Ron to the <a href="https://github.com/tc39/proposal-iterator.range">https://github.com/tc39/proposal-iterator.range</a> proposal where we have discussed having a reified range</td></tr>
  <tr class="msg" id="L140"><td class="ts-cell"><a class="ts" href="#L140" alt="Wed Nov 29 2023 13:32:01 GMT-0800 (Pacific Standard Time)">21:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">I personally support it, but most others seemed to reject it</td></tr>
  <tr class="msg" id="L141"><td class="ts-cell"><a class="ts" href="#L141" alt="Wed Nov 29 2023 13:32:35 GMT-0800 (Pacific Standard Time)">21:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell"><span class="nick-6">ljharb</span>: basically a data structure that holds bounds and can be passed between the <code>[]</code> to do the slice</td></tr>
  <tr class="msg" id="L142"><td class="ts-cell"><a class="ts" href="#L142" alt="Wed Nov 29 2023 13:33:14 GMT-0800 (Pacific Standard Time)">21:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">yeah that sounds super unjavascripty to me</td></tr>
  <tr class="msg" id="L143"><td class="ts-cell"><a class="ts" href="#L143" alt="Wed Nov 29 2023 13:34:38 GMT-0800 (Pacific Standard Time)">21:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><p>My suggestion for reification is the introduction of "inverted" get/set/has/delete via symbols that could be looked up on an Object in lieu of ToPrimitive:</p>
<pre><code class="language-js">class Index { 
   offset;
   fromEnd;
   [Symbol.geti](value) { 
     return this.fromEnd ? value[value.length - this.offset] : value[value.length];
   }
}

const x = new Index(1, /*fromEnd*/ true);
ar[x] // -&gt; x[Symbol.geti](ar)
</code></pre>
<p>Which has a general utility for custom indexes, such as turning a <code>WeakMap</code> into a scoped pseudo-private name:</p>
<pre><code class="language-js">WeakMap.prototype[Symbol.geti] = function (key) { return this.get(key); }
WeakMap.prototype[Symbol.seti] = function (key, value) { this.set(key, value); }
const key = new WeakMap();
const obj = {};
obj[key] = 1; // key[Symbol.geti](obj);
</code></pre>
</td></tr>
  <tr class="msg" id="L144"><td class="ts-cell"><a class="ts" href="#L144" alt="Wed Nov 29 2023 13:34:54 GMT-0800 (Pacific Standard Time)">21:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">making an actual thing vs just typing <code>x =&gt; x[a, b](y)</code> doesn't seem worth adding</td></tr>
  <tr class="msg" id="L145"><td class="ts-cell"><a class="ts" href="#L145" alt="Wed Nov 29 2023 13:36:02 GMT-0800 (Pacific Standard Time)">21:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">I would definitely not want that to work with normal <code>obj[key]</code> access, but could see using the <code>obj[^key]</code> syntax or something</td></tr>
  <tr class="msg" id="L146"><td class="ts-cell"><a class="ts" href="#L146" alt="Wed Nov 29 2023 13:36:05 GMT-0800 (Pacific Standard Time)">21:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">That can't be unwrapped though</td></tr>
  <tr class="msg" id="L147"><td class="ts-cell"><a class="ts" href="#L147" alt="Wed Nov 29 2023 13:36:09 GMT-0800 (Pacific Standard Time)">21:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">and while i see ron's point that making a special kind of value and a special protocol to go with it would be a logical generalization, that's a ton of complexity that it'd be a hard sell to justify</td></tr>
  <tr class="msg" id="L148"><td class="ts-cell"><a class="ts" href="#L148" alt="Wed Nov 29 2023 13:36:37 GMT-0800 (Pacific Standard Time)">21:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">though I don't see why you want to do it in this inverted way - it seems like usually containers know how to use an index, rather than an index knowing how to use a container?</td></tr>
  <tr class="msg" id="L149"><td class="ts-cell"><a class="ts" href="#L149" alt="Wed Nov 29 2023 13:36:46 GMT-0800 (Pacific Standard Time)">21:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">i.e., <code>x =&gt; x[a, b]</code> doesn't let you extract <code>a</code> and <code>b</code> as there's no associated data model.</td></tr>
  <tr class="msg" id="L150"><td class="ts-cell"><a class="ts" href="#L150" alt="Wed Nov 29 2023 13:37:08 GMT-0800 (Pacific Standard Time)">21:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">so would we also have a PropertyKey that represents a property, takes an object, and does an inverted lookup?</td></tr>
  <tr class="msg" id="L151"><td class="ts-cell"><a class="ts" href="#L151" alt="Wed Nov 29 2023 13:37:22 GMT-0800 (Pacific Standard Time)">21:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">oh lol yeah sorry <code>x.slice(a, b)</code> in this case, i mistyped. but yes it doesn't let you get at the a and b, which seems like a benefit? (to make it an opaque lens)</td></tr>
  <tr class="msg" id="L152"><td class="ts-cell"><a class="ts" href="#L152" alt="Wed Nov 29 2023 13:38:46 GMT-0800 (Pacific Standard Time)">21:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">I think my preference here would be to leave <code>obj[x]</code> alone, and to add a new <code>obj[^x]</code> which invokes a symbol-named method on <code>obj</code> passing it <code>x</code> (uncoerced). there could then be a <code>slice(a, b)</code> function which returns a reified Slice, and the symbol-named method on Array could know how to deal with that</td></tr>
  <tr class="msg" id="L153"><td class="ts-cell"><a class="ts" href="#L153" alt="Wed Nov 29 2023 13:39:00 GMT-0800 (Pacific Standard Time)">21:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">also you could have the symbol-named method on Map be an alias for <code>get</code>, and that sort of thing</td></tr>
  <tr class="msg" id="L154"><td class="ts-cell"><a class="ts" href="#L154" alt="Wed Nov 29 2023 13:39:09 GMT-0800 (Pacific Standard Time)">21:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> though I don't see why you want to do it in this inverted way - it seems like usually containers know how to use an index, rather than an index knowing how to use a container?</blockquote></mx-reply>Except <code>[]</code> is only useful for strings and symbols (i.e., via toPrimitive). You can't put anything else meaningful in there that isn't either.</td></tr>
  <tr class="msg" id="L155"><td class="ts-cell"><a class="ts" href="#L155" alt="Wed Nov 29 2023 13:39:13 GMT-0800 (Pacific Standard Time)">21:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">and of course have a similarly named method to be invoked when doing <code>obj[^x] = y</code></td></tr>
  <tr class="msg" id="L156"><td class="ts-cell"><a class="ts" href="#L156" alt="Wed Nov 29 2023 13:39:20 GMT-0800 (Pacific Standard Time)">21:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">yeah I would also not want <code>a[b]</code> delegating to a protocol</td></tr>
  <tr class="msg" id="L157"><td class="ts-cell"><a class="ts" href="#L157" alt="Wed Nov 29 2023 13:40:07 GMT-0800 (Pacific Standard Time)">21:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I'm surprised the <code>WeakMap</code> example isn't a stronger motivator?</td></tr>
  <tr class="msg" id="L158"><td class="ts-cell"><a class="ts" href="#L158" alt="Wed Nov 29 2023 13:40:37 GMT-0800 (Pacific Standard Time)">21:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">weak things are used so rarely i don't think it'd motivate any ergonomic changes?</td></tr>
  <tr class="msg" id="L159"><td class="ts-cell"><a class="ts" href="#L159" alt="Wed Nov 29 2023 13:42:53 GMT-0800 (Pacific Standard Time)">21:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">the WeakMap example seems actively bad to me? if I see <code>obj[key] = 1</code> I am really expecting to set a property on <code>obj</code>. if it does something other than that this is bad.</td></tr>
  <tr class="msg" id="L160"><td class="ts-cell"><a class="ts" href="#L160" alt="Wed Nov 29 2023 13:43:06 GMT-0800 (Pacific Standard Time)">21:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">Could someone clarify if we're talking about just the slice <code>1:2</code> proposal now, or also the <code>^</code> one?</td></tr>
  <tr class="msg" id="L161"><td class="ts-cell"><a class="ts" href="#L161" alt="Wed Nov 29 2023 13:43:17 GMT-0800 (Pacific Standard Time)">21:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">whereas <code>map[^key] = value</code> seems nice (altho i'm not sure how it'd work with set)</td></tr>
  <tr class="msg" id="L162"><td class="ts-cell"><a class="ts" href="#L162" alt="Wed Nov 29 2023 13:44:26 GMT-0800 (Pacific Standard Time)">21:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> the WeakMap example seems actively bad to me? if I see <code>obj[key] = 1</code> I am really expecting to set a property on <code>obj</code>. if it does something other than that this is bad.</blockquote></mx-reply>The WeakMap thing was a way to implement the "Private Symbol" mechanism championed by Alex Russel (I think?) without the need to introduce new syntax.</td></tr>
  <tr class="msg" id="L163"><td class="ts-cell"><a class="ts" href="#L163" alt="Wed Nov 29 2023 13:44:38 GMT-0800 (Pacific Standard Time)">21:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><span class="nick-6">ljharb</span>: I am imagining that <code>map[^key] = value</code> is sugar for <code>map[Symbol.set](key, value)</code></td></tr>
  <tr class="msg" id="L164"><td class="ts-cell"><a class="ts" href="#L164" alt="Wed Nov 29 2023 13:44:50 GMT-0800 (Pacific Standard Time)">21:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">i would agree</td></tr>
  <tr class="msg" id="L165"><td class="ts-cell"><a class="ts" href="#L165" alt="Wed Nov 29 2023 13:44:55 GMT-0800 (Pacific Standard Time)">21:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@waldemarh:matrix.org">waldemar</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Could someone clarify if we're talking about just the slice <code>1:2</code> proposal now, or also the <code>^</code> one?</blockquote></mx-reply>It's ambiguous.</td></tr>
  <tr class="msg" id="L166"><td class="ts-cell"><a class="ts" href="#L166" alt="Wed Nov 29 2023 13:45:14 GMT-0800 (Pacific Standard Time)">21:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <span class="nick-6">ljharb</span>: I am imagining that <code>map[^key] = value</code> is sugar for <code>map[Symbol.set](key, value)</code></blockquote></mx-reply>That is at odds with the proposal for <code>[^x]</code> to mean index-from-end.</td></tr>
  <tr class="msg" id="L167"><td class="ts-cell"><a class="ts" href="#L167" alt="Wed Nov 29 2023 13:45:33 GMT-0800 (Pacific Standard Time)">21:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">right, we've been talking about a new imagined proposal for <code>[^x]</code> to not necessarily mean from end</td></tr>
  <tr class="msg" id="L168"><td class="ts-cell"><a class="ts" href="#L168" alt="Wed Nov 29 2023 13:45:46 GMT-0800 (Pacific Standard Time)">21:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">however <code>arr[^-1]</code> could map to <code>.slice</code> or <code>.at</code>, solving that problem</td></tr>
  <tr class="msg" id="L169"><td class="ts-cell"><a class="ts" href="#L169" alt="Wed Nov 29 2023 13:45:51 GMT-0800 (Pacific Standard Time)">21:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">rbuckton</span>: not if <code>Array.prototype[Symbol.set] = function(key, value) { key &lt; 0 ? this[this.length + key] = value : this[key] = value }</code>!</td></tr>
  <tr class="msg" id="L170"><td class="ts-cell"><a class="ts" href="#L170" alt="Wed Nov 29 2023 13:45:55 GMT-0800 (Pacific Standard Time)">21:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> the WeakMap example seems actively bad to me? if I see <code>obj[key] = 1</code> I am really expecting to set a property on <code>obj</code>. if it does something other than that this is bad.</blockquote></mx-reply>I disagree. We <em>already</em> special case objects for indexed access. We just special case them via <code>Symbol.toPrimitive</code></td></tr>
  <tr class="msg" id="L171"><td class="ts-cell"><a class="ts" href="#L171" alt="Wed Nov 29 2023 13:46:21 GMT-0800 (Pacific Standard Time)">21:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">And an explicit <code>Symbol.geti</code> seems directly in line with "stop coercing things".</td></tr>
  <tr class="msg" id="L172"><td class="ts-cell"><a class="ts" href="#L172" alt="Wed Nov 29 2023 13:47:18 GMT-0800 (Pacific Standard Time)">21:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">"stop coercing things" is mainly intended to apply to new APIs, not to change the meaning of existing things</td></tr>
  <tr class="msg" id="L173"><td class="ts-cell"><a class="ts" href="#L173" alt="Wed Nov 29 2023 13:47:25 GMT-0800 (Pacific Standard Time)">21:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">I don't want to change the meaning of existing things as a rule</td></tr>
  <tr class="msg" id="L174"><td class="ts-cell"><a class="ts" href="#L174" alt="Wed Nov 29 2023 13:49:20 GMT-0800 (Pacific Standard Time)">21:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">but also, even in a world where I thought changing the meaning of <code>obj[key]</code> was a good idea, I would still think that it would invoke a method on <code>obj</code>, not a method on <code>key</code></td></tr>
  <tr class="msg" id="L175"><td class="ts-cell"><a class="ts" href="#L175" alt="Wed Nov 29 2023 13:49:38 GMT-0800 (Pacific Standard Time)">21:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Honestly, I'd love to be able to hook <code>a[x]</code> directly to better support custom collections. Indexing with things other than string/number is fairly common in many languages, and is extremely limiting in JS. <code>Symbol.geti</code> avoids hooking all of <code>a[x]</code> for a specific class of key-like things.</td></tr>
  <tr class="msg" id="L176"><td class="ts-cell"><a class="ts" href="#L176" alt="Wed Nov 29 2023 13:50:19 GMT-0800 (Pacific Standard Time)">21:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">My suggestion is to add a new syntax for such cases.</td></tr>
  <tr class="msg" id="L177"><td class="ts-cell"><a class="ts" href="#L177" alt="Wed Nov 29 2023 13:50:23 GMT-0800 (Pacific Standard Time)">21:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">rbuckton</span>: <code>a[b]</code> needs to have simple semantics</td></tr>
  <tr class="msg" id="L178"><td class="ts-cell"><a class="ts" href="#L178" alt="Wed Nov 29 2023 13:50:38 GMT-0800 (Pacific Standard Time)">21:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <span class="nick-15">rbuckton</span>: <code>a[b]</code> needs to have simple semantics</blockquote></mx-reply>I don't agree.</td></tr>
  <tr class="msg" id="L179"><td class="ts-cell"><a class="ts" href="#L179" alt="Wed Nov 29 2023 13:50:41 GMT-0800 (Pacific Standard Time)">21:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">I don't think we should change <code>a[x]</code>, but I think we could reasonably introduce <code>a[^x]</code>, which would allow <code>a</code> to define how it should be indexed by arbitrary <code>x</code></td></tr>
  <tr class="msg" id="L180"><td class="ts-cell"><a class="ts" href="#L180" alt="Wed Nov 29 2023 13:50:49 GMT-0800 (Pacific Standard Time)">21:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> My suggestion is to add a new syntax for such cases.</blockquote></mx-reply>This feels extremely wasteful, imo.</td></tr>
  <tr class="msg" id="L181"><td class="ts-cell"><a class="ts" href="#L181" alt="Wed Nov 29 2023 13:51:05 GMT-0800 (Pacific Standard Time)">21:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">sorry, a better thing to say would be "there needs to be property access with simple semantics; <code>a[b]</code> serves that purpose already"</td></tr>
  <tr class="msg" id="L182"><td class="ts-cell"><a class="ts" href="#L182" alt="Wed Nov 29 2023 13:51:31 GMT-0800 (Pacific Standard Time)">21:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">put more strongly, changing <code>a[x]</code> would likely break a lot of assumptions in existing code and in the minds of existing devs, and i doubt there would ever be consensus for that, such that i think it's a waste of time to pursue it.</td></tr>
  <tr class="msg" id="L183"><td class="ts-cell"><a class="ts" href="#L183" alt="Wed Nov 29 2023 13:51:57 GMT-0800 (Pacific Standard Time)">21:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">yeah, changing that is almost certainly dead in the water</td></tr>
  <tr class="msg" id="L184"><td class="ts-cell"><a class="ts" href="#L184" alt="Wed Nov 29 2023 13:52:03 GMT-0800 (Pacific Standard Time)">21:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I don't think we should change <code>a[x]</code>, but I think we could reasonably introduce <code>a[^x]</code>, which would allow <code>a</code> to define how it should be indexed by arbitrary <code>x</code></blockquote></mx-reply>If we introduced a new syntax for indexing, I'd be opposed to <code>a[^x]</code> specifically as I'd really like it to not mean different things in different places (negative index on Arrays, something else somewhere else, etc)</td></tr>
  <tr class="msg" id="L185"><td class="ts-cell"><a class="ts" href="#L185" alt="Wed Nov 29 2023 13:52:05 GMT-0800 (Pacific Standard Time)">21:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">if that were possible then i would assume we'd have added objects as object keys and not symbols</td></tr>
  <tr class="msg" id="L186"><td class="ts-cell"><a class="ts" href="#L186" alt="Wed Nov 29 2023 13:52:24 GMT-0800 (Pacific Standard Time)">21:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> If we introduced a new syntax for indexing, I'd be opposed to <code>a[^x]</code> specifically as I'd really like it to not mean different things in different places (negative index on Arrays, something else somewhere else, etc)</blockquote></mx-reply>if it's a protocol, then that's inherently unavoidable. no?</td></tr>
  <tr class="msg" id="L187"><td class="ts-cell"><a class="ts" href="#L187" alt="Wed Nov 29 2023 13:52:30 GMT-0800 (Pacific Standard Time)">21:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Especially given the prior art for the <code>^x</code> syntax in C#.</td></tr>
  <tr class="msg" id="L188"><td class="ts-cell"><a class="ts" href="#L188" alt="Wed Nov 29 2023 13:52:34 GMT-0800 (Pacific Standard Time)">21:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">I was hoping that we could save prefix ^ for something more interesting, e.g., shorthand for zero-parameter arrow functions</td></tr>
  <tr class="msg" id="L189"><td class="ts-cell"><a class="ts" href="#L189" alt="Wed Nov 29 2023 13:52:42 GMT-0800 (Pacific Standard Time)">21:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> If we introduced a new syntax for indexing, I'd be opposed to <code>a[^x]</code> specifically as I'd really like it to not mean different things in different places (negative index on Arrays, something else somewhere else, etc)</blockquote></mx-reply>sure, <code>[^x]</code> was just an idea. <code>[@x]</code> or something also fine.</td></tr>
  <tr class="msg" id="L190"><td class="ts-cell"><a class="ts" href="#L190" alt="Wed Nov 29 2023 13:53:17 GMT-0800 (Pacific Standard Time)">21:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell"><span class="nick-13">hax (HE Shi-Jun)</span>: I will definitely help, but I don't think I can sign up for co-championing</td></tr>
  <tr class="msg" id="L191"><td class="ts-cell"><a class="ts" href="#L191" alt="Wed Nov 29 2023 13:53:25 GMT-0800 (Pacific Standard Time)">21:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">or <code>obj@[x]</code>, we could be creative</td></tr>
  <tr class="msg" id="L192"><td class="ts-cell"><a class="ts" href="#L192" alt="Wed Nov 29 2023 13:53:33 GMT-0800 (Pacific Standard Time)">21:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">there's only so much time I have to dedicate to TC39 stuff and I need to prioritise things</td></tr>
  <tr class="msg" id="L193"><td class="ts-cell"><a class="ts" href="#L193" alt="Wed Nov 29 2023 13:53:43 GMT-0800 (Pacific Standard Time)">21:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">(like protocols)</td></tr>
  <tr class="msg" id="L194"><td class="ts-cell"><a class="ts" href="#L194" alt="Wed Nov 29 2023 13:54:01 GMT-0800 (Pacific Standard Time)">21:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">For partial application I'd considered an infix <code>~</code> as an indicator, i.e. <code>a~()</code>. I could see <code>a~[x]</code> as an option for custom syntax, but I still don't think custom syntax is merited if we could easily hook <code>a[x]</code> for a very specific set of things.</td></tr>
  <tr class="msg" id="L195"><td class="ts-cell"><a class="ts" href="#L195" alt="Wed Nov 29 2023 13:54:22 GMT-0800 (Pacific Standard Time)">21:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">lol tell me about it</td></tr>
  <tr class="msg" id="L196"><td class="ts-cell"><a class="ts" href="#L196" alt="Wed Nov 29 2023 13:54:33 GMT-0800 (Pacific Standard Time)">21:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">it's very very important that that syntax not be more hookable than it already is, getters are bad enough</td></tr>
  <tr class="msg" id="L197"><td class="ts-cell"><a class="ts" href="#L197" alt="Wed Nov 29 2023 13:54:38 GMT-0800 (Pacific Standard Time)">21:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">if iterator helpers and follow-ons weren't so damn useful and popular...</td></tr>
  <tr class="msg" id="L198"><td class="ts-cell"><a class="ts" href="#L198" alt="Wed Nov 29 2023 13:54:45 GMT-0800 (Pacific Standard Time)">21:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@haxjs:matrix.org">hax (HE Shi-Jun)</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> there's only so much time I have to dedicate to TC39 stuff and I need to prioritise things</blockquote></mx-reply>Thank you !  I just try to advance it it the simple form which I believe is the best solution on these problems.</td></tr>
  <tr class="msg" id="L199"><td class="ts-cell"><a class="ts" href="#L199" alt="Wed Nov 29 2023 13:54:49 GMT-0800 (Pacific Standard Time)">21:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">You could imagine <code>Symbol</code> as being implemented this way, and the addition of <code>Symbol</code> to <code>x[a]</code> was a change to an existing thing back in 2015</td></tr>
  <tr class="msg" id="L200"><td class="ts-cell"><a class="ts" href="#L200" alt="Wed Nov 29 2023 13:54:49 GMT-0800 (Pacific Standard Time)">21:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">or if someone else was working on them</td></tr>
  <tr class="msg" id="L201"><td class="ts-cell"><a class="ts" href="#L201" alt="Wed Nov 29 2023 13:55:11 GMT-0800 (Pacific Standard Time)">21:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">in the next half year i may have time to help with some of those, fwiw</td></tr>
  <tr class="msg" id="L202"><td class="ts-cell"><a class="ts" href="#L202" alt="Wed Nov 29 2023 13:55:15 GMT-0800 (Pacific Standard Time)">21:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@haxjs:matrix.org">hax (HE Shi-Jun)</span>&gt;</div></td><td class="msg-cell">I'm ok with other syntax, but to be honest I don't see how diff with <code>a[^i]</code>.</td></tr>
  <tr class="msg" id="L203"><td class="ts-cell"><a class="ts" href="#L203" alt="Wed Nov 29 2023 13:55:46 GMT-0800 (Pacific Standard Time)">21:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Thank you !  I just try to advance it it the simple form which I believe is the best solution on these problems.</blockquote></mx-reply>I agree. I think simple slicing can be added on its own, with consideration for how it might fit into the generalisation in the future.</td></tr>
  <tr class="msg" id="L204"><td class="ts-cell"><a class="ts" href="#L204" alt="Wed Nov 29 2023 13:56:25 GMT-0800 (Pacific Standard Time)">21:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@haxjs:matrix.org">hax (HE Shi-Jun)</span>&gt;</div></td><td class="msg-cell">So it seems I have nothing could do...</td></tr>
  <tr class="msg" id="L205"><td class="ts-cell"><a class="ts" href="#L205" alt="Wed Nov 29 2023 13:56:26 GMT-0800 (Pacific Standard Time)">21:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@ethanarrowood:matrix.org">ethanarrowood</span>&gt;</div></td><td class="msg-cell">No more <code>('b' + 'a' + + 'a' + 'a').toLowerCase()</code>?</td></tr>
  <tr class="msg" id="L206"><td class="ts-cell"><a class="ts" href="#L206" alt="Wed Nov 29 2023 13:56:32 GMT-0800 (Pacific Standard Time)">21:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">As a counterpoint to <code>a[@x]</code> or whatever. if <code>x</code> is a reified slice, I would want a way to <em>explicitly</em> throw when it is used via <code>a[x]</code>, since that would be a mistake.</td></tr>
  <tr class="msg" id="L207"><td class="ts-cell"><a class="ts" href="#L207" alt="Wed Nov 29 2023 13:57:03 GMT-0800 (Pacific Standard Time)">21:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">reified properties/indexes/object operations don't sound like a great direction to me personally, we have functions for that.</td></tr>
  <tr class="msg" id="L208"><td class="ts-cell"><a class="ts" href="#L208" alt="Wed Nov 29 2023 13:57:14 GMT-0800 (Pacific Standard Time)">21:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">If the things we want to use with <code>a[@x]</code> shouldn't be used with <code>a[x]</code>, then we have two mutually exclusive syntaxes that arguably do the same thing depending on their inputs.</td></tr>
  <tr class="msg" id="L209"><td class="ts-cell"><a class="ts" href="#L209" alt="Wed Nov 29 2023 13:57:43 GMT-0800 (Pacific Standard Time)">21:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">And that doesn't seem like a valuable use of our syntactic budget if we could merge them into just <code>a[x]</code>.</td></tr>
  <tr class="msg" id="L210"><td class="ts-cell"><a class="ts" href="#L210" alt="Wed Nov 29 2023 13:58:01 GMT-0800 (Pacific Standard Time)">21:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">imo robustness of existing syntax &gt; &gt; &gt; preserving syntax budget</td></tr>
  <tr class="msg" id="L211"><td class="ts-cell"><a class="ts" href="#L211" alt="Wed Nov 29 2023 13:58:16 GMT-0800 (Pacific Standard Time)">21:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">rbuckton</span>: <code>a[b]</code> delegating to a symbol is just <em>not</em> going to happen</td></tr>
  <tr class="msg" id="L212"><td class="ts-cell"><a class="ts" href="#L212" alt="Wed Nov 29 2023 13:58:28 GMT-0800 (Pacific Standard Time)">21:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><code>a[x]</code> isn't robust, its wasteful</td></tr>
  <tr class="msg" id="L213"><td class="ts-cell"><a class="ts" href="#L213" alt="Wed Nov 29 2023 13:58:40 GMT-0800 (Pacific Standard Time)">21:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">lol what's wasteful about it as-is?</td></tr>
  <tr class="msg" id="L214"><td class="ts-cell"><a class="ts" href="#L214" alt="Wed Nov 29 2023 13:58:45 GMT-0800 (Pacific Standard Time)">21:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">(other than that getters exist)</td></tr>
  <tr class="msg" id="L215"><td class="ts-cell"><a class="ts" href="#L215" alt="Wed Nov 29 2023 13:58:55 GMT-0800 (Pacific Standard Time)">21:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">engines will not let that <em>highly-optimised</em>, <em>extremely common</em> operation become slow</td></tr>
  <tr class="msg" id="L216"><td class="ts-cell"><a class="ts" href="#L216" alt="Wed Nov 29 2023 13:59:15 GMT-0800 (Pacific Standard Time)">21:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">That you can't use non-string, non-symbol values as keys withing them being stringified.</td></tr>
  <tr class="msg" id="L217"><td class="ts-cell"><a class="ts" href="#L217" alt="Wed Nov 29 2023 13:59:55 GMT-0800 (Pacific Standard Time)">21:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> engines will not let that <em>highly-optimised</em>, <em>extremely common</em> operation become slow</blockquote></mx-reply>They would be deoptimized in the same way for <code>a[{}]</code> today, since they already have to patch in a call to <code>Symbol.toPrimitive</code>.</td></tr>
  <tr class="msg" id="L218"><td class="ts-cell"><a class="ts" href="#L218" alt="Wed Nov 29 2023 13:59:57 GMT-0800 (Pacific Standard Time)">21:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">they may all be done by then ðŸ’ª</td></tr>
  <tr class="msg" id="L219"><td class="ts-cell"><a class="ts" href="#L219" alt="Wed Nov 29 2023 14:00:26 GMT-0800 (Pacific Standard Time)">22:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">So I don't imagine it would affect performance at all in the common case.</td></tr>
  <tr class="msg" id="L220"><td class="ts-cell"><a class="ts" href="#L220" alt="Wed Nov 29 2023 14:00:38 GMT-0800 (Pacific Standard Time)">22:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">only if anyone anywhere has ever touched <code>Symbol.toPrimitive</code>, which they usually haven't</td></tr>
  <tr class="msg" id="L221"><td class="ts-cell"><a class="ts" href="#L221" alt="Wed Nov 29 2023 14:01:03 GMT-0800 (Pacific Standard Time)">22:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> only if anyone anywhere has ever touched <code>Symbol.toPrimitive</code>, which they usually haven't</blockquote></mx-reply>There is plenty of code in the wild that is just depending on <code>.toString()</code> for the same thing</td></tr>
  <tr class="msg" id="L222"><td class="ts-cell"><a class="ts" href="#L222" alt="Wed Nov 29 2023 14:01:39 GMT-0800 (Pacific Standard Time)">22:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I'm using <code>Symbol.toPrimitive</code> as a general placeholder for all the things <code>ToPropertyKey</code> does for Object values</td></tr>
  <tr class="msg" id="L223"><td class="ts-cell"><a class="ts" href="#L223" alt="Wed Nov 29 2023 14:01:44 GMT-0800 (Pacific Standard Time)">22:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">ðŸ¤·â€â™‚ï¸ well it'll be up to you to convince engines of that then</td></tr>
  <tr class="msg" id="L224"><td class="ts-cell"><a class="ts" href="#L224" alt="Wed Nov 29 2023 14:11:27 GMT-0800 (Pacific Standard Time)">22:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><p>To be clear, I haven't proposed <code>geti</code> because I think there are better solutions, though I do think <code>geti</code> has some interesting value on its own (i.e., using a <code>WeakMap</code> into a reified pseudo-private name). In general I'd love to be able to hook <code>a[x]</code> for custom collections, even if that were limited to only numeric string indexes as they are interpreted by Array and <em>TypedArray</em>, though that limitation wouldn't solve the same case as <code>geti</code>.</p>
<p>In lieu of <code>geti</code>/<code>seti</code>/etc., I'd be happy with a reified <code>Slice</code> and <code>Index</code> object that had specific, explicit handling by property evaluation to call a <code>Symbol.slice</code>/<code>Symbol.splice</code> or <code>Symbol.indexGet</code>/<code>Symbol.indexSet</code> on the object, such that <code>x:y</code> could produce a <code>new Slice(x, y)</code> and <code>^x</code> could produce a <code>new Index(x, /*fromEnd*/ true)</code>. Having reified slices and indexes is extremely convenient as they have a data model that can be interrogated and can thus be composed and reused in user code.</p>
</td></tr>
  <tr class="msg" id="L225"><td class="ts-cell"><a class="ts" href="#L225" alt="Wed Nov 29 2023 14:15:13 GMT-0800 (Pacific Standard Time)">22:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">rbuckton</span>: I encourage you to participate in the Iterator.range issue tracker</td></tr>
  <tr class="msg" id="L226"><td class="ts-cell"><a class="ts" href="#L226" alt="Wed Nov 29 2023 14:18:30 GMT-0800 (Pacific Standard Time)">22:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <span class="nick-15">rbuckton</span>: I encourage you to participate in the Iterator.range issue tracker</blockquote></mx-reply>How does this apply to <code>Iterator.range</code>? Do you have a particular issue this applies to? Ranges and slices are subtly different. I think I did bring up reified slices when <code>Iterator.range</code> was proposed, but I haven't had much time to follow the range proposal since then.</td></tr>
  <tr class="msg" id="L227"><td class="ts-cell"><a class="ts" href="#L227" alt="Wed Nov 29 2023 14:18:48 GMT-0800 (Pacific Standard Time)">22:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">reified ranges seem just as unjavascripty to me as reified slices</td></tr>
  <tr class="msg" id="L228"><td class="ts-cell"><a class="ts" href="#L228" alt="Wed Nov 29 2023 14:19:06 GMT-0800 (Pacific Standard Time)">22:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">rbuckton</span>: I don't see how they are different</td></tr>
  <tr class="msg" id="L229"><td class="ts-cell"><a class="ts" href="#L229" alt="Wed Nov 29 2023 14:19:11 GMT-0800 (Pacific Standard Time)">22:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">It's very pythony, and python and JS share many similarities.</td></tr>
  <tr class="msg" id="L230"><td class="ts-cell"><a class="ts" href="#L230" alt="Wed Nov 29 2023 14:19:23 GMT-0800 (Pacific Standard Time)">22:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@gibson042:matrix.org">Richard Gibson</span>&gt;</div></td><td class="msg-cell">string enums are nice until a change results in garbage like step 24 in <a href="https://tc39.es/ecma402/#sec-initializenumberformat">https://tc39.es/ecma402/#sec-initializenumberformat</a></td></tr>
  <tr class="msg" id="L231"><td class="ts-cell"><a class="ts" href="#L231" alt="Wed Nov 29 2023 14:21:09 GMT-0800 (Pacific Standard Time)">22:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <span class="nick-15">rbuckton</span>: I don't see how they are different</blockquote></mx-reply>Ranges produce values, slices represent ordinal positions from which to read and write chunks. There is a lot of similarity, but a Range that produces values can't really have a meaningful notion of "3 elements from the end"</td></tr>
  <tr class="msg" id="L232"><td class="ts-cell"><a class="ts" href="#L232" alt="Wed Nov 29 2023 14:21:26 GMT-0800 (Pacific Standard Time)">22:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Hence why I said they are subtly different</td></tr>
  <tr class="msg" id="L233"><td class="ts-cell"><a class="ts" href="#L233" alt="Wed Nov 29 2023 14:21:55 GMT-0800 (Pacific Standard Time)">22:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">I hadn't considered that a reified slice would try to represent relative indexing</td></tr>
  <tr class="msg" id="L234"><td class="ts-cell"><a class="ts" href="#L234" alt="Wed Nov 29 2023 14:22:06 GMT-0800 (Pacific Standard Time)">22:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">That was in the slides.</td></tr>
  <tr class="msg" id="L235"><td class="ts-cell"><a class="ts" href="#L235" alt="Wed Nov 29 2023 14:22:12 GMT-0800 (Pacific Standard Time)">22:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><code>x:^y</code></td></tr>
  <tr class="msg" id="L236"><td class="ts-cell"><a class="ts" href="#L236" alt="Wed Nov 29 2023 14:22:26 GMT-0800 (Pacific Standard Time)">22:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">lol sure, there was a lot of things in the slides</td></tr>
  <tr class="msg" id="L237"><td class="ts-cell"><a class="ts" href="#L237" alt="Wed Nov 29 2023 14:23:21 GMT-0800 (Pacific Standard Time)">22:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">The slice syntax is essentially <code>expr:expr</code>, so <code>0:1</code> or <code>x:y</code>. If you want to represent <code>.slice(0, -1)</code>, you use <code>x:^y</code></td></tr>
  <tr class="msg" id="L238"><td class="ts-cell"><a class="ts" href="#L238" alt="Wed Nov 29 2023 14:24:06 GMT-0800 (Pacific Standard Time)">22:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><p>Mostly to avoid the disparity with <code>a[-1]</code>, and to align with <code>a[^1]</code>. It also keeps them visually similar:</p>
<pre><code>a[0:^1]
a[0]
a[^1]
</code></pre>
</td></tr>
  <tr class="msg" id="L239"><td class="ts-cell"><a class="ts" href="#L239" alt="Wed Nov 29 2023 14:25:33 GMT-0800 (Pacific Standard Time)">22:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Thus, a <code>Slice(x, y)</code> is actually a pair of Index objects. <code>x:^y</code> would be reified as <code>new Slice(new Index(x, false), new Index(y, true))</code>. At least, that's how it works in C#.</td></tr>
  <tr class="msg" id="L240"><td class="ts-cell"><a class="ts" href="#L240" alt="Wed Nov 29 2023 14:26:34 GMT-0800 (Pacific Standard Time)">22:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@haxjs:matrix.org">hax (HE Shi-Jun)</span>&gt;</div></td><td class="msg-cell">Refication of index/range are good I believe, the problem is we never have such things in js, all js current methods are just calculate eaglely, for example, this is how resizeable  typedarray deal with negative index. </td></tr>
  <tr class="msg" id="L241"><td class="ts-cell"><a class="ts" href="#L241" alt="Wed Nov 29 2023 14:27:30 GMT-0800 (Pacific Standard Time)">22:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><p>That also ensures the types are consistent and the object model is more user friendly if you want to do something like:</p>
<pre><code>const x = foo ? 0 : ^1;
const s = x:^y;
s.start; // an Index, no need to do a typeof test
s.end; // also an Index
</code></pre>
</td></tr>
  <tr class="msg" id="L242"><td class="ts-cell"><a class="ts" href="#L242" alt="Wed Nov 29 2023 14:27:57 GMT-0800 (Pacific Standard Time)">22:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@haxjs:matrix.org">hax (HE Shi-Jun)</span>&gt;</div></td><td class="msg-cell">Another problem, if there will be index/range I will really hope they are new primitive types. But it seems very impossible as current status.</td></tr>
  <tr class="msg" id="L243"><td class="ts-cell"><a class="ts" href="#L243" alt="Wed Nov 29 2023 14:28:15 GMT-0800 (Pacific Standard Time)">22:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Refication of index/range are good I believe, the problem is we never have such things in js, all js current methods are just calculate eaglely, for example, this is how resizeable  typedarray deal with negative index. </blockquote></mx-reply>I could see a reified slice of <code>x:y</code>, and a reified range like <code>x..y</code> as two distinct things.</td></tr>
  <tr class="msg" id="L244"><td class="ts-cell"><a class="ts" href="#L244" alt="Wed Nov 29 2023 14:28:43 GMT-0800 (Pacific Standard Time)">22:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Another problem, if there will be index/range I will really hope they are new primitive types. But it seems very impossible as current status.</blockquote></mx-reply>Primitives aren't really necessary for this. Regular expression literals produce Objects</td></tr>
  <tr class="msg" id="L245"><td class="ts-cell"><a class="ts" href="#L245" alt="Wed Nov 29 2023 14:29:19 GMT-0800 (Pacific Standard Time)">22:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Though <code>==</code> and <code>!==</code> might be nice, most other operators don't apply to slices and indexes.</td></tr>
  <tr class="msg" id="L246"><td class="ts-cell"><a class="ts" href="#L246" alt="Wed Nov 29 2023 14:29:57 GMT-0800 (Pacific Standard Time)">22:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">You can't really compare <code>^0</code> and <code>^1</code> using <code>&lt;</code> or <code>&gt;</code> as they may point to the same element if the array only has a single element.</td></tr>
  <tr class="msg" id="L247"><td class="ts-cell"><a class="ts" href="#L247" alt="Wed Nov 29 2023 14:30:58 GMT-0800 (Pacific Standard Time)">22:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@haxjs:matrix.org">hax (HE Shi-Jun)</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Primitives aren't really necessary for this. Regular expression literals produce Objects</blockquote></mx-reply>yeah. of coz we can always use object.</td></tr>
  <tr class="msg" id="L248"><td class="ts-cell"><a class="ts" href="#L248" alt="Wed Nov 29 2023 14:31:30 GMT-0800 (Pacific Standard Time)">22:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Also,  <code>range</code> might accept floats, while a slice should only accept integral <code>number</code> values, <code>bigint</code>, and <code>Index</code>, and not coerce</td></tr>
  <tr class="msg" id="L249"><td class="ts-cell"><a class="ts" href="#L249" alt="Wed Nov 29 2023 14:32:10 GMT-0800 (Pacific Standard Time)">22:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Also, a slice of <code>x:y</code> could theoretically hold a non-primitive, so it can't be a primitive.</td></tr>
  <tr class="msg" id="L250"><td class="ts-cell"><a class="ts" href="#L250" alt="Wed Nov 29 2023 14:32:59 GMT-0800 (Pacific Standard Time)">22:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">does this not fall under the "don't coerce objects to primitives"?</td></tr>
  <tr class="msg" id="L251"><td class="ts-cell"><a class="ts" href="#L251" alt="Wed Nov 29 2023 14:33:53 GMT-0800 (Pacific Standard Time)">22:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> does this not fall under the "don't coerce objects to primitives"?</blockquote></mx-reply>Are you asking me, regarding Slice/Index, or something else?</td></tr>
  <tr class="msg" id="L252"><td class="ts-cell"><a class="ts" href="#L252" alt="Wed Nov 29 2023 14:34:12 GMT-0800 (Pacific Standard Time)">22:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">no, I'm talking about the coercion slides</td></tr>
  <tr class="msg" id="L253"><td class="ts-cell"><a class="ts" href="#L253" alt="Wed Nov 29 2023 14:34:24 GMT-0800 (Pacific Standard Time)">22:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">null -&gt; some primitive</td></tr>
  <tr class="msg" id="L254"><td class="ts-cell"><a class="ts" href="#L254" alt="Wed Nov 29 2023 14:36:10 GMT-0800 (Pacific Standard Time)">22:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">these tables are soooooo helpful</td></tr>
  <tr class="msg" id="L255"><td class="ts-cell"><a class="ts" href="#L255" alt="Wed Nov 29 2023 14:53:27 GMT-0800 (Pacific Standard Time)">22:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">"you haveundefined notifications to review"</td></tr>
  <tr class="msg" id="L256"><td class="ts-cell"><a class="ts" href="#L256" alt="Wed Nov 29 2023 14:53:32 GMT-0800 (Pacific Standard Time)">22:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">(or NaN)</td></tr>
  <tr class="msg" id="L257"><td class="ts-cell"><a class="ts" href="#L257" alt="Wed Nov 29 2023 14:55:47 GMT-0800 (Pacific Standard Time)">22:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">IMO, the value for Numbers and BigInts taking strings makes sense given the DOM return value rationale</td></tr>
  <tr class="msg" id="L258"><td class="ts-cell"><a class="ts" href="#L258" alt="Wed Nov 29 2023 14:58:53 GMT-0800 (Pacific Standard Time)">22:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">yeah numeric strings are all over the place in the DOM, and JS kinda has to work nicely with the DOM or people will get mad</td></tr>
  <tr class="msg" id="L259"><td class="ts-cell"><a class="ts" href="#L259" alt="Wed Nov 29 2023 14:59:36 GMT-0800 (Pacific Standard Time)">22:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> "you haveundefined notifications to review"</blockquote></mx-reply><p>Hopefully in an Intl.MessageFormat world, that message would read:</p>
<pre><code>you have {$count} notifications to review
</code></pre>
</td></tr>
  <tr class="msg" id="L260"><td class="ts-cell"><a class="ts" href="#L260" alt="Wed Nov 29 2023 15:00:24 GMT-0800 (Pacific Standard Time)">23:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <p>Hopefully in an Intl.MessageFormat world, that message would read:</p>
<pre><code>you have {$count} notifications to review
</code></pre>
</blockquote></mx-reply>In an ideal world, yeah maybe. In the current world, messages like that are so commonplace they're a meme</td></tr>
  <tr class="msg" id="L261"><td class="ts-cell"><a class="ts" href="#L261" alt="Wed Nov 29 2023 15:09:12 GMT-0800 (Pacific Standard Time)">23:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> As a counterpoint to <code>a[@x]</code> or whatever. if <code>x</code> is a reified slice, I would want a way to <em>explicitly</em> throw when it is used via <code>a[x]</code>, since that would be a mistake.</blockquote></mx-reply>just make the Symbol.toPrimitive method on the Slice class throw?</td></tr>
  <tr class="msg" id="L262"><td class="ts-cell"><a class="ts" href="#L262" alt="Wed Nov 29 2023 15:09:20 GMT-0800 (Pacific Standard Time)">23:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">that seems fairly straightforward to me, not really a counterpoint</td></tr>
  <tr class="msg" id="L263"><td class="ts-cell"><a class="ts" href="#L263" alt="Wed Nov 29 2023 15:09:41 GMT-0800 (Pacific Standard Time)">23:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">but, I also don't see why it would be a mistake?</td></tr>
  <tr class="msg" id="L264"><td class="ts-cell"><a class="ts" href="#L264" alt="Wed Nov 29 2023 15:09:55 GMT-0800 (Pacific Standard Time)">23:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">like if the class knows how to handle slices, like Array, then it would just give you the slice</td></tr>
  <tr class="msg" id="L265"><td class="ts-cell"><a class="ts" href="#L265" alt="Wed Nov 29 2023 15:10:10 GMT-0800 (Pacific Standard Time)">23:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">from its <code>Symbol.get</code> method</td></tr>
  <tr class="msg" id="L266"><td class="ts-cell"><a class="ts" href="#L266" alt="Wed Nov 29 2023 15:11:02 GMT-0800 (Pacific Standard Time)">23:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> but, I also don't see why it would be a mistake?</blockquote></mx-reply>If <code>Slice</code> needs to be used with <code>a[@x]</code>, then using it with <code>a[x]</code> is 100% a bug.</td></tr>
  <tr class="msg" id="L267"><td class="ts-cell"><a class="ts" href="#L267" alt="Wed Nov 29 2023 15:13:05 GMT-0800 (Pacific Standard Time)">23:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">oh, sorry, I misread</td></tr>
  <tr class="msg" id="L268"><td class="ts-cell"><a class="ts" href="#L268" alt="Wed Nov 29 2023 15:13:18 GMT-0800 (Pacific Standard Time)">23:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">yes, using with <code>a[x]</code> is a bug, and would be covered by having slice's <code>Symbol.toPrimitive</code> throw</td></tr>
  <tr class="msg" id="L269"><td class="ts-cell"><a class="ts" href="#L269" alt="Wed Nov 29 2023 15:13:24 GMT-0800 (Pacific Standard Time)">23:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> just make the Symbol.toPrimitive method on the Slice class throw?</blockquote></mx-reply>Yes, that's what I'm getting at. This message leads into the point I was trying to make in the subsequent message. What you use in <code>a[x]</code> and what you would use in <code>a[@x]</code> would be mutually exclusive to avoid bugs. If they are mutually exclusive, then just having <code>a[x]</code> do both would avoid the concern about trying to pick the right one to avoid a bug.</td></tr>
  <tr class="msg" id="L270"><td class="ts-cell"><a class="ts" href="#L270" alt="Wed Nov 29 2023 15:13:49 GMT-0800 (Pacific Standard Time)">23:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">ah, well, they would not be totally mutually exclusive</td></tr>
  <tr class="msg" id="L271"><td class="ts-cell"><a class="ts" href="#L271" alt="Wed Nov 29 2023 15:13:59 GMT-0800 (Pacific Standard Time)">23:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">because Array could have <code>a[@-1]</code> do negative indexing</td></tr>
  <tr class="msg" id="L272"><td class="ts-cell"><a class="ts" href="#L272" alt="Wed Nov 29 2023 15:14:04 GMT-0800 (Pacific Standard Time)">23:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> ah, well, they would not be totally mutually exclusive</blockquote></mx-reply>They should be.</td></tr>
  <tr class="msg" id="L273"><td class="ts-cell"><a class="ts" href="#L273" alt="Wed Nov 29 2023 15:14:07 GMT-0800 (Pacific Standard Time)">23:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">they would be mutually exclusive for object types though, yes</td></tr>
  <tr class="msg" id="L274"><td class="ts-cell"><a class="ts" href="#L274" alt="Wed Nov 29 2023 15:14:35 GMT-0800 (Pacific Standard Time)">23:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">why? if I do <code>map[@"string"]</code>, that can do a map lookup</td></tr>
  <tr class="msg" id="L275"><td class="ts-cell"><a class="ts" href="#L275" alt="Wed Nov 29 2023 15:14:37 GMT-0800 (Pacific Standard Time)">23:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> because Array could have <code>a[@-1]</code> do negative indexing</blockquote></mx-reply>And <code>a[-1]</code> would not, thus its still a potential bug</td></tr>
  <tr class="msg" id="L276"><td class="ts-cell"><a class="ts" href="#L276" alt="Wed Nov 29 2023 15:14:59 GMT-0800 (Pacific Standard Time)">23:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">Well, yes, <code>a[-1]</code> would be a bug but in general passing things to the wrong place is a bug</td></tr>
  <tr class="msg" id="L277"><td class="ts-cell"><a class="ts" href="#L277" alt="Wed Nov 29 2023 15:15:23 GMT-0800 (Pacific Standard Time)">23:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> why? if I do <code>map[@"string"]</code>, that can do a map lookup</blockquote></mx-reply>Because its too easy to write <code>map["string"]</code> and it mean something different.</td></tr>
  <tr class="msg" id="L278"><td class="ts-cell"><a class="ts" href="#L278" alt="Wed Nov 29 2023 15:15:46 GMT-0800 (Pacific Standard Time)">23:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">If that's true it applies to any special syntax for indexing a map. I don't agree.</td></tr>
  <tr class="msg" id="L279"><td class="ts-cell"><a class="ts" href="#L279" alt="Wed Nov 29 2023 15:16:01 GMT-0800 (Pacific Standard Time)">23:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I'm not advocating for indexing a map using <code>[]</code>.</td></tr>
  <tr class="msg" id="L280"><td class="ts-cell"><a class="ts" href="#L280" alt="Wed Nov 29 2023 15:16:07 GMT-0800 (Pacific Standard Time)">23:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">Right, but I am</td></tr>
  <tr class="msg" id="L281"><td class="ts-cell"><a class="ts" href="#L281" alt="Wed Nov 29 2023 15:16:37 GMT-0800 (Pacific Standard Time)">23:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">and above you were advocating for a way to index collection types by non-string values; Map seems like the obvious collection type you'd most want to index by non-string values</td></tr>
  <tr class="msg" id="L282"><td class="ts-cell"><a class="ts" href="#L282" alt="Wed Nov 29 2023 15:17:10 GMT-0800 (Pacific Standard Time)">23:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I'm advocating for doing something meaningful with objects in <code>a[x]</code> aside from just ToString().</td></tr>
  <tr class="msg" id="L283"><td class="ts-cell"><a class="ts" href="#L283" alt="Wed Nov 29 2023 15:18:13 GMT-0800 (Pacific Standard Time)">23:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">What problems does that solve?</td></tr>
  <tr class="msg" id="L284"><td class="ts-cell"><a class="ts" href="#L284" alt="Wed Nov 29 2023 15:20:08 GMT-0800 (Pacific Standard Time)">23:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><p>My suggestion is, introduce a new <code>obj[@x]</code> syntax which invokes a symbol-named method on <code>obj</code> with <code>x</code>, and also <code>obj[@x] = y</code> which invokes a symbol-named method on <code>obj</code> with <code>x</code> and <code>y</code>, which solves</p>
<ul>
<li>you can do negative indexing on arrays</li>
<li>you can <em>assign</em> at negative indexes on arrays</li>
<li>if we have a <code>slice</code> type, you can slice arrays with syntax</li>
<li>you can do Map read/writes with syntax</li>
<li>other collection types can defining indexing behavior for non-string values</li>
</ul>
<p>so it gives you a lot of stuff!</p>
</td></tr>
  <tr class="msg" id="L285"><td class="ts-cell"><a class="ts" href="#L285" alt="Wed Nov 29 2023 15:20:20 GMT-0800 (Pacific Standard Time)">23:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><p>It solves reified <code>Slice</code>, reified <code>Index</code>, <code>WeakMap</code> as a scoped private name, plus a number of other approaches such as a "pick" object, i.e.:</p>
<pre><code class="language-js">const obj = { x: 1, y: 2, z: 3, w: 4 };
const obj2 = obj[new Pick("x", "y", "z")];
obj2; // { x: 1, y: 2, z: 3 }
</code></pre>
</td></tr>
  <tr class="msg" id="L286"><td class="ts-cell"><a class="ts" href="#L286" alt="Wed Nov 29 2023 15:21:22 GMT-0800 (Pacific Standard Time)">23:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">Your suggestion only solves reified <code>Index</code> if either there is also an "indexing" protocol collection types can opt into, or the <code>Index</code> type knows about every single kind of collection</td></tr>
  <tr class="msg" id="L287"><td class="ts-cell"><a class="ts" href="#L287" alt="Wed Nov 29 2023 15:21:26 GMT-0800 (Pacific Standard Time)">23:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I was also considering <code>geti</code> as an approach to handling concurrent reads/writes in multithreaded javascript with Worker and shared structs, though I'm also looking into <code>.{</code> notation as a solution</td></tr>
  <tr class="msg" id="L288"><td class="ts-cell"><a class="ts" href="#L288" alt="Wed Nov 29 2023 15:21:51 GMT-0800 (Pacific Standard Time)">23:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">Ditto <code>pick</code>, etc</td></tr>
  <tr class="msg" id="L289"><td class="ts-cell"><a class="ts" href="#L289" alt="Wed Nov 29 2023 15:21:54 GMT-0800 (Pacific Standard Time)">23:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Yes, I expected there would also be an indexing protocol, just like slice notation added a slice protocol.</td></tr>
  <tr class="msg" id="L290"><td class="ts-cell"><a class="ts" href="#L290" alt="Wed Nov 29 2023 15:21:55 GMT-0800 (Pacific Standard Time)">23:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">and <code>slice</code></td></tr>
  <tr class="msg" id="L291"><td class="ts-cell"><a class="ts" href="#L291" alt="Wed Nov 29 2023 15:22:02 GMT-0800 (Pacific Standard Time)">23:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Pick, not so much.</td></tr>
  <tr class="msg" id="L292"><td class="ts-cell"><a class="ts" href="#L292" alt="Wed Nov 29 2023 15:22:12 GMT-0800 (Pacific Standard Time)">23:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Slice depends on knowing something about the size of a collection. Pick does not.</td></tr>
  <tr class="msg" id="L293"><td class="ts-cell"><a class="ts" href="#L293" alt="Wed Nov 29 2023 15:22:45 GMT-0800 (Pacific Standard Time)">23:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">OK, so, my proposal does not require having an indexing protocol, or a slice protocol. If there is a <code>slice</code> type, and a <code>pick</code> type, then collections can define for themselves what to do when asked to "slice" or "pick" something, without needing a protocol. That seems better.</td></tr>
  <tr class="msg" id="L294"><td class="ts-cell"><a class="ts" href="#L294" alt="Wed Nov 29 2023 15:23:13 GMT-0800 (Pacific Standard Time)">23:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I don't agree that it's better.</td></tr>
  <tr class="msg" id="L295"><td class="ts-cell"><a class="ts" href="#L295" alt="Wed Nov 29 2023 15:23:46 GMT-0800 (Pacific Standard Time)">23:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Slice and index-from-end have a well-defined protocol that multiple different objects could implement.</td></tr>
  <tr class="msg" id="L296"><td class="ts-cell"><a class="ts" href="#L296" alt="Wed Nov 29 2023 15:24:30 GMT-0800 (Pacific Standard Time)">23:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">The way I am suggesting they implement that is, they define a <code>Symbol.get</code> method which has specific behavior for the reified <code>slice</code> values.</td></tr>
  <tr class="msg" id="L297"><td class="ts-cell"><a class="ts" href="#L297" alt="Wed Nov 29 2023 15:24:42 GMT-0800 (Pacific Standard Time)">23:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">If I have a <code>Slice</code> and use it on an array via <code>a[@x]</code>, I get a slice. If I used it on a Map via <code>a[@x]</code>, it might just act as a key, thus it's not interpreted as a slice. That means that <code>a[@x:y]</code> would do something strange on a Map.</td></tr>
  <tr class="msg" id="L298"><td class="ts-cell"><a class="ts" href="#L298" alt="Wed Nov 29 2023 15:25:37 GMT-0800 (Pacific Standard Time)">23:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">Yes, if you use a key with a type of collection which does not know how to interpret that key, you're going to have a bad time. But this is also true in your inverted world if you use a key with a type of collection where the key does not know how to interpret that type of collection.</td></tr>
  <tr class="msg" id="L299"><td class="ts-cell"><a class="ts" href="#L299" alt="Wed Nov 29 2023 15:26:26 GMT-0800 (Pacific Standard Time)">23:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Ignoring the <code>@</code> for a second, <code>a[x:y]</code> and <code>a[^x]</code> should always be interpreted as "take a slice from <code>a</code>" and "get the element from <code>a</code> relative from its end".</td></tr>
  <tr class="msg" id="L300"><td class="ts-cell"><a class="ts" href="#L300" alt="Wed Nov 29 2023 15:27:24 GMT-0800 (Pacific Standard Time)">23:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Yes, if you use a key with a type of collection which does not know how to interpret that key, you're going to have a bad time. But this is also true in your inverted world if you use a key with a type of collection where the key does not know how to interpret that type of collection.</blockquote></mx-reply>That's why I'm not proposing a general indexing hook. I'm proposing a very specific indexing hook.</td></tr>
  <tr class="msg" id="L301"><td class="ts-cell"><a class="ts" href="#L301" alt="Wed Nov 29 2023 15:28:12 GMT-0800 (Pacific Standard Time)">23:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Ignoring the <code>@</code> for a second, <code>a[x:y]</code> and <code>a[^x]</code> should always be interpreted as "take a slice from <code>a</code>" and "get the element from <code>a</code> relative from its end".</blockquote></mx-reply>I am proposing not to have either <code>a[x:y]</code> or negative-indexing <code>a[^x]</code>. I think that having only a general <code>a[@x]</code> hook would solve the use cases for both <code>a[x:y]</code> and <code>a[^x]</code>.</td></tr>
  <tr class="msg" id="L302"><td class="ts-cell"><a class="ts" href="#L302" alt="Wed Nov 29 2023 15:28:52 GMT-0800 (Pacific Standard Time)">23:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><p>With <code>geti</code>, <code>Slice</code> has a very specific and well-defined interaction with something like <code>Array</code>:</p>
<pre><code class="language-js">Slice.prototype[Symbol.geti] = function (value) {
  return value[Symbol.slice](this.start.getIndex(value), this.end.getIndex(value));
}
Array.prototype[Symbol.slice] = function (start, end) {
  return this.slice(start, end);
}
</code></pre>
</td></tr>
  <tr class="msg" id="L303"><td class="ts-cell"><a class="ts" href="#L303" alt="Wed Nov 29 2023 15:30:56 GMT-0800 (Pacific Standard Time)">23:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><p>The same goes for <code>Index</code>:</p>
<pre><code class="language-js">Index.prototype[Symbol.geti] = function (value) {
  return value[Symbol.indexGet](this.getIndex(value));
}
Array.prototype[Symbol.indexGet] = function (index) {
  return this[index];
}
</code></pre>
</td></tr>
  <tr class="msg" id="L304"><td class="ts-cell"><a class="ts" href="#L304" alt="Wed Nov 29 2023 15:31:03 GMT-0800 (Pacific Standard Time)">23:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">(or something to that effect)</td></tr>
  <tr class="msg" id="L305"><td class="ts-cell"><a class="ts" href="#L305" alt="Wed Nov 29 2023 15:31:36 GMT-0800 (Pacific Standard Time)">23:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">With my proposal also: <code>Array.prototype[Symbol.get] = function(v) { if (Slice.isSlice(v)) return this.slice(v.start, v.end); /*...*/ }</code></td></tr>
  <tr class="msg" id="L306"><td class="ts-cell"><a class="ts" href="#L306" alt="Wed Nov 29 2023 15:31:50 GMT-0800 (Pacific Standard Time)">23:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">And it only requires a single protocol, not two.</td></tr>
  <tr class="msg" id="L307"><td class="ts-cell"><a class="ts" href="#L307" alt="Wed Nov 29 2023 15:33:01 GMT-0800 (Pacific Standard Time)">23:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><p>But a <code>WeakMap</code> could do:</p>
<pre><code class="language-js">WeakMap.prototype[Symbol.geti] = function (value) {
  return this.get(value);
}
</code></pre>
<p>and a <code>Pick</code> might look like:</p>
<pre><code class="language-js">class Pick {
  keys;
  constructor(...keys) {
    this.keys = keys;
  }
  [Symbol.geti](value) {
    var obj = {};
    for (var p of Reflect.ownKeys(value)) {
     if (this.keys.includes(p)) obj[p] = value;
    }
    return obj;
  }
}
</code></pre>
</td></tr>
  <tr class="msg" id="L308"><td class="ts-cell"><a class="ts" href="#L308" alt="Wed Nov 29 2023 15:34:18 GMT-0800 (Pacific Standard Time)">23:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">(I really do not think it makes sense for keys to define how they interact with collections, rather than collections defining how they interact with keys.)</td></tr>
  <tr class="msg" id="L309"><td class="ts-cell"><a class="ts" href="#L309" alt="Wed Nov 29 2023 15:34:25 GMT-0800 (Pacific Standard Time)">23:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> With my proposal also: <code>Array.prototype[Symbol.get] = function(v) { if (Slice.isSlice(v)) return this.slice(v.start, v.end); /*...*/ }</code></blockquote></mx-reply>That doesn't solve <code>a[@x:y]</code> potentially not returning a Slice and maybe doing something else instead of erroring in the case of a <code>Map</code>.</td></tr>
  <tr class="msg" id="L310"><td class="ts-cell"><a class="ts" href="#L310" alt="Wed Nov 29 2023 15:35:49 GMT-0800 (Pacific Standard Time)">23:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">I am specifically not proposing to have <code>a[@x:y]</code> syntax</td></tr>
  <tr class="msg" id="L311"><td class="ts-cell"><a class="ts" href="#L311" alt="Wed Nov 29 2023 15:35:51 GMT-0800 (Pacific Standard Time)">23:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> (I really do not think it makes sense for keys to define how they interact with collections, rather than collections defining how they interact with keys.)</blockquote></mx-reply>I would much rather be able to hook indexing, but not at the cost of the cognitive overhead of picking the correct indexing operator or introducing subtle bugs.</td></tr>
  <tr class="msg" id="L312"><td class="ts-cell"><a class="ts" href="#L312" alt="Wed Nov 29 2023 15:36:30 GMT-0800 (Pacific Standard Time)">23:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">But yes, if you have a reified slice type, and you try to index a map by that, the appropriate behavior is to look up the slice instance in the map. That's how maps work.</td></tr>
  <tr class="msg" id="L313"><td class="ts-cell"><a class="ts" href="#L313" alt="Wed Nov 29 2023 15:37:11 GMT-0800 (Pacific Standard Time)">23:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">And as I said, I'd be happy to have <code>Slice</code> and <code>Index</code> have special handling in indexers even without the symbols. That's what C# does. I just feel that <code>geti</code> adds a bit more flexibility.</td></tr>
  <tr class="msg" id="L314"><td class="ts-cell"><a class="ts" href="#L314" alt="Wed Nov 29 2023 15:37:43 GMT-0800 (Pacific Standard Time)">23:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">But I don't think leveraging a general indexing hook to handle <code>Slice</code> and <code>Index</code> is a good idea.</td></tr>
  <tr class="msg" id="L315"><td class="ts-cell"><a class="ts" href="#L315" alt="Wed Nov 29 2023 15:38:33 GMT-0800 (Pacific Standard Time)">23:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> But yes, if you have a reified slice type, and you try to index a map by that, the appropriate behavior is to look up the slice instance in the map. That's how maps work.</blockquote></mx-reply>No. The appropriate behavior for <code>a[x:y]</code> (or <code>a[@x:y]</code>) on a Map that doesn't undertand how to handle a slice should be to throw. Not silently do the wrong thing.</td></tr>
  <tr class="msg" id="L316"><td class="ts-cell"><a class="ts" href="#L316" alt="Wed Nov 29 2023 15:42:15 GMT-0800 (Pacific Standard Time)">23:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Or if you expect <code>a[@x:y]</code> to just be a generalized map indexer, then I'd still strongly prefer we have specific handling for <code>a[x:y]</code> and <code>a[^x]</code>, such that slicing with the correct syntax is <em>always</em> slicing, and that <code>a[@x]</code> just doesn't care at all what you put into it. Documentation that describes slicing with syntax should always refer to <code>a[x:y]</code>, and it should never be recommended that you abuse something like <code>Symbol.get</code>/<code>a[@x]</code> to handle slicing. It's just a bug farm and a source of confusion.</td></tr>
  <tr class="msg" id="L317"><td class="ts-cell"><a class="ts" href="#L317" alt="Wed Nov 29 2023 15:47:31 GMT-0800 (Pacific Standard Time)">23:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">C# lets you write <code>map[0..1]</code> as a key, but C# is typed and thus you know that the input/output is when indexing using the key type. JS isn't typed, so its far easier to do the wrong thing.</td></tr>
  <tr class="msg" id="L318"><td class="ts-cell"><a class="ts" href="#L318" alt="Wed Nov 29 2023 15:56:37 GMT-0800 (Pacific Standard Time)">23:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">As an aside, I'm not sure what symbol you would want to use for <code>a[@b]</code>? You can't use <code>@</code> because of decorators, and I'd prefer to keep <code>^x</code> for reified relative index if possible, so it either has to be an infix operator, or a prefix operator that comes before the <code>[</code>. I'd like to avoid using <code>&amp;</code> and <code>*</code> due to both their precedence for use with pointers in other C-like languages, and that I'd really like to use <code>&amp;</code> for the ref proposal if a <code>ref</code> keyword ends up not being feasible (since <code>ref</code> has a close enough similarity to pointers that the semantic meaning seems reasonable).</td></tr>
  <tr class="msg" id="L319"><td class="ts-cell"><a class="ts" href="#L319" alt="Wed Nov 29 2023 15:58:53 GMT-0800 (Pacific Standard Time)">23:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><code>%</code> may be out as well. We'd considered it for pipeline, but IIRC <code>%</code> is hard to type on a number of international keyboard layouts.</td></tr>

</tbody></table></div></div></div>
</body></html>