<!DOCTYPE html><html><head>
  <title>TC39 Delegates on 2024-04-11</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "TC39 Delegates";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">TC39 Delegates<br>2024-04-11<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2024-04-10" class="nav-link"><span>prev</span></a>
<span style="float:right">next</span>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search TC39 Delegates">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Wed Apr 10 2024 18:04:33 GMT-0700 (Pacific Daylight Time)">01:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">woo-ow</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Wed Apr 10 2024 18:04:44 GMT-0700 (Pacific Daylight Time)">01:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">that example Waldemar found is pretty epic</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Wed Apr 10 2024 18:04:56 GMT-0700 (Pacific Daylight Time)">01:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">what example?</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Wed Apr 10 2024 18:05:34 GMT-0700 (Pacific Daylight Time)">01:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell"><a href="https://github.com/tc39/proposal-pattern-matching/issues/323">https://github.com/tc39/proposal-pattern-matching/issues/323</a>, at the end of the link</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Wed Apr 10 2024 18:06:23 GMT-0700 (Pacific Daylight Time)">01:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">contextual keywords are terrifying</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Wed Apr 10 2024 19:04:49 GMT-0700 (Pacific Daylight Time)">02:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell"><a href="https://matrix.to/#/%40rbuckton%3Amatrix.org">@rbuckton</a> Have you considered <code data-md="`">.</code> for discard bindings before? It’s visually insigificant, isn’t an identifier, and can’t be used in any place that makes discard bindings useful.</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Wed Apr 10 2024 19:05:17 GMT-0700 (Pacific Daylight Time)">02:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">It might be <i data-md="_">too</i> visually small.</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Wed Apr 10 2024 19:06:20 GMT-0700 (Pacific Daylight Time)">02:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">That, and too easy to confuse for a property access.</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Wed Apr 10 2024 19:19:37 GMT-0700 (Pacific Daylight Time)">02:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">How would you confuse it for propery access?</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Wed Apr 10 2024 19:19:49 GMT-0700 (Pacific Daylight Time)">02:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">There’s no preceding object</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Wed Apr 10 2024 20:02:24 GMT-0700 (Pacific Daylight Time)">03:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">it could theoretically be mixed with <code>and</code>, <code>or</code>, or <code>not</code> in pattern matching, though that's not exactly practical.</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Thu Apr 11 2024 03:24:40 GMT-0700 (Pacific Daylight Time)">10:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell">for (using is of and [not/a+"/g]; b++; [/"/g, 5])</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Thu Apr 11 2024 03:25:07 GMT-0700 (Pacific Daylight Time)">10:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell">how Waldemar find this</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Thu Apr 11 2024 03:26:18 GMT-0700 (Pacific Daylight Time)">10:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell">😨 real insight </td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Thu Apr 11 2024 03:50:12 GMT-0700 (Pacific Daylight Time)">10:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell"><pre><code>for (using is of and [not/a+"/g]; b++; [/"/g, 5])

First parse
for (using x of ...) {}
    keyword using
    Identifier is
    keyword of
    Expression [not/a+"/g]; b++; [/"/g, 5]
        ArrayExpression [
            Element not/a+"/g]; b++; [/"/g
                Division not/a
                Plus +
                Division "/g]; b++; [/"/g
                    Left "/g]; b++; [/"
                    Right g
            Element 5
        ]

Second parse
for (a; b; c)
FirstPart
    PatternMatching
        Identifier using
        Keyword is
        Pattern
            IdentifierPattern of
            Keyword and
            ArrayPatter []
                Keyword not
                RegExpPattern /a+"/g
SecondPart b++
ThirdPart [/"/g, 5]
</code></pre>
</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Thu Apr 11 2024 03:53:03 GMT-0700 (Pacific Daylight Time)">10:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Anything involving regexp literals is suspect</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Thu Apr 11 2024 04:03:18 GMT-0700 (Pacific Daylight Time)">11:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell">but it's a real ambiguous example </td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Thu Apr 11 2024 04:03:29 GMT-0700 (Pacific Daylight Time)">11:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell">both interpretations are legal </td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Thu Apr 11 2024 06:09:45 GMT-0700 (Pacific Daylight Time)">13:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</div></td><td class="msg-cell">the authors' copy of the soon-to-be RFC 9557 🎉

<a href="https://www.rfc-editor.org/authors/rfc9557.html">https://www.rfc-editor.org/authors/rfc9557.html</a></td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Thu Apr 11 2024 06:29:18 GMT-0700 (Pacific Daylight Time)">13:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> the authors' copy of the soon-to-be RFC 9557 🎉<br><br><a href="https://www.rfc-editor.org/authors/rfc9557.html">https://www.rfc-editor.org/authors/rfc9557.html</a></blockquote></mx-reply>Wow! The extension if ISO 8601 with custom timezone and calendar syntax has an RFC number!</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Thu Apr 11 2024 06:54:38 GMT-0700 (Pacific Daylight Time)">13:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">Does anyone else fill out the sign-in form every day because they didn't save the Webex link? lol</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Thu Apr 11 2024 06:58:40 GMT-0700 (Pacific Daylight Time)">13:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</div></td><td class="msg-cell">starting real soon folks!</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Thu Apr 11 2024 07:37:31 GMT-0700 (Pacific Daylight Time)">14:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@softwarechris:matrix.org">Chris de Almeida</span>&gt;</div></td><td class="msg-cell">we lost Nicolo as a notes helper.  if someone else here could volunteer to help, even just for this topic, that would really help us out.  chair group is trying to help w/ notes (as we often do), but also have to juggle other things.  thank you 🙏</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Thu Apr 11 2024 07:38:07 GMT-0700 (Pacific Daylight Time)">14:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@softwarechris:matrix.org">Chris de Almeida</span>&gt;</div></td><td class="msg-cell">it's easier during the presentation, and a little more work during discussion</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Thu Apr 11 2024 07:46:03 GMT-0700 (Pacific Daylight Time)">14:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@haxjs:matrix.org">hax (HE Shi-Jun)</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> for (using is of and [not/a+"/g]; b++; [/"/g, 5])</blockquote></mx-reply>It's just like old <code>for (async of () =&gt; {}</code> issue, maybe worse?</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Thu Apr 11 2024 07:49:30 GMT-0700 (Pacific Daylight Time)">14:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell"><span class="nick-9">saminahusain</span>: It'd be great if Ecma could facilitate getting TC39 the relevant ISO/IEEE specs. This is a technical barrier for us in this proposal, as it was in the development of Temporal (with the relationship with ISO 8601)</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Thu Apr 11 2024 07:54:33 GMT-0700 (Pacific Daylight Time)">14:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@softwarechris:matrix.org">Chris de Almeida</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> sent a file.</blockquote></mx-reply>☝️</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Thu Apr 11 2024 08:29:10 GMT-0700 (Pacific Daylight Time)">15:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@waldemarh:matrix.org">waldemar</span>&gt;</div></td><td class="msg-cell">What's TLS?</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Thu Apr 11 2024 08:29:26 GMT-0700 (Pacific Daylight Time)">15:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><span class="nick-6">ljharb</span>: no <code>class extends sharedStruct {}</code> won't work, for the reasons shu is discussing now, as well as that it has too many rough edges. You can't add new public or private fields in a subclass of a shared struct as it would violate the fixed layout. Plus we can't correlate a class prototype across realms.</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Thu Apr 11 2024 08:29:29 GMT-0700 (Pacific Daylight Time)">15:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">TLS: thread-local storage</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Thu Apr 11 2024 08:29:54 GMT-0700 (Pacific Daylight Time)">15:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Though he really means "Realm-local storage"</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Thu Apr 11 2024 08:29:56 GMT-0700 (Pacific Daylight Time)">15:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">the instance would still be sealed ofc</td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Thu Apr 11 2024 08:30:25 GMT-0700 (Pacific Daylight Time)">15:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">and it has the same problem of correlation, but it seems a better way to correlate to me than a "boxed primitive"-like hand wavy mechanism</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Thu Apr 11 2024 08:30:50 GMT-0700 (Pacific Daylight Time)">15:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> the instance would still be sealed ofc</blockquote></mx-reply>The prototype would not be correlated.</td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Thu Apr 11 2024 08:31:04 GMT-0700 (Pacific Daylight Time)">15:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">this also reminds me of yaml class marshalling attack vectors in ruby, for some reason</td></tr>
  <tr class="msg" id="L35"><td class="ts-cell"><a class="ts" href="#L35" alt="Thu Apr 11 2024 08:31:43 GMT-0700 (Pacific Daylight Time)">15:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">You are misunderstanding correlation, I think. We're talking about ensuring the same struct type defined in the same file and loaded into two different realms/threads/agents will have same methods.</td></tr>
  <tr class="msg" id="L36"><td class="ts-cell"><a class="ts" href="#L36" alt="Thu Apr 11 2024 08:31:53 GMT-0700 (Pacific Daylight Time)">15:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">right</td></tr>
  <tr class="msg" id="L37"><td class="ts-cell"><a class="ts" href="#L37" alt="Thu Apr 11 2024 08:32:15 GMT-0700 (Pacific Daylight Time)">15:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">i'm suggesting that you make a class with methods, and extend the struct, and then the "automatic" part would be reloading that same class code in each place</td></tr>
  <tr class="msg" id="L38"><td class="ts-cell"><a class="ts" href="#L38" alt="Thu Apr 11 2024 08:32:20 GMT-0700 (Pacific Daylight Time)">15:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">We can't correlate a class prototype, because classes and class prototypes aren't correlated across threads. We can correlate a struct definition and prototype.</td></tr>
  <tr class="msg" id="L39"><td class="ts-cell"><a class="ts" href="#L39" alt="Thu Apr 11 2024 08:32:37 GMT-0700 (Pacific Daylight Time)">15:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">the prototype is a mutable object tho</td></tr>
  <tr class="msg" id="L40"><td class="ts-cell"><a class="ts" href="#L40" alt="Thu Apr 11 2024 08:32:48 GMT-0700 (Pacific Daylight Time)">15:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">if that can be correlated, why can't anything be?</td></tr>
  <tr class="msg" id="L41"><td class="ts-cell"><a class="ts" href="#L41" alt="Thu Apr 11 2024 08:33:11 GMT-0700 (Pacific Daylight Time)">15:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">No, correlation is based on syntax and source location. </td></tr>
  <tr class="msg" id="L42"><td class="ts-cell"><a class="ts" href="#L42" alt="Thu Apr 11 2024 08:33:41 GMT-0700 (Pacific Daylight Time)">15:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">right but i mean, you have to re-evaluate code in each context in order to get the prototype object, right?</td></tr>
  <tr class="msg" id="L43"><td class="ts-cell"><a class="ts" href="#L43" alt="Thu Apr 11 2024 08:33:50 GMT-0700 (Pacific Daylight Time)">15:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">correlating every <code>class</code> is way too much overhead.</td></tr>
  <tr class="msg" id="L44"><td class="ts-cell"><a class="ts" href="#L44" alt="Thu Apr 11 2024 08:34:22 GMT-0700 (Pacific Daylight Time)">15:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> correlating every <code>class</code> is way too much overhead.</blockquote></mx-reply>this is just the shared ones, right?</td></tr>
  <tr class="msg" id="L45"><td class="ts-cell"><a class="ts" href="#L45" alt="Thu Apr 11 2024 08:34:37 GMT-0700 (Pacific Daylight Time)">15:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">well sure, not every class. only one canonical one that the shared struct creator indicates. that seems like it'd be precisely the same amount of overhead as the prototype object correlation</td></tr>
  <tr class="msg" id="L46"><td class="ts-cell"><a class="ts" href="#L46" alt="Thu Apr 11 2024 08:34:54 GMT-0700 (Pacific Daylight Time)">15:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">We would only correlate <code>shared struct</code> types between realms</td></tr>
  <tr class="msg" id="L47"><td class="ts-cell"><a class="ts" href="#L47" alt="Thu Apr 11 2024 08:35:07 GMT-0700 (Pacific Daylight Time)">15:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">the prototype object isn't a shared struct</td></tr>
  <tr class="msg" id="L48"><td class="ts-cell"><a class="ts" href="#L48" alt="Thu Apr 11 2024 08:35:37 GMT-0700 (Pacific Daylight Time)">15:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><code>class extends sharedStruct</code> cannot be canonical and cannot be determined syntactically.</td></tr>
  <tr class="msg" id="L49"><td class="ts-cell"><a class="ts" href="#L49" alt="Thu Apr 11 2024 08:35:43 GMT-0700 (Pacific Daylight Time)">15:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">if a function is re-eval'd in multiple contexts to achieve the goal of "having the same methods", then surely any code could be</td></tr>
  <tr class="msg" id="L50"><td class="ts-cell"><a class="ts" href="#L50" alt="Thu Apr 11 2024 08:36:02 GMT-0700 (Pacific Daylight Time)">15:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">That isn't the problem.</td></tr>
  <tr class="msg" id="L51"><td class="ts-cell"><a class="ts" href="#L51" alt="Thu Apr 11 2024 08:36:03 GMT-0700 (Pacific Daylight Time)">15:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">there's all sorts of ways that can be covered</td></tr>
  <tr class="msg" id="L52"><td class="ts-cell"><a class="ts" href="#L52" alt="Thu Apr 11 2024 08:36:29 GMT-0700 (Pacific Daylight Time)">15:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">the wrapper class could be defined lexically inside the shared struct, or you could just define method syntax directly inside the shared struct definition and the semantics would be that shared struct methods are copied</td></tr>
  <tr class="msg" id="L53"><td class="ts-cell"><a class="ts" href="#L53" alt="Thu Apr 11 2024 08:37:45 GMT-0700 (Pacific Daylight Time)">15:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Those sound categorically worse than what we are proposing. Class construction has the wrong semantics for shared structs.</td></tr>
  <tr class="msg" id="L54"><td class="ts-cell"><a class="ts" href="#L54" alt="Thu Apr 11 2024 08:38:03 GMT-0700 (Pacific Daylight Time)">15:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell"><p>why would something like</p>
<pre><code>shared struct {
  // existing stuff
  foo() {}
}
</code></pre>
<p>where the methods are auto-re-eval'd be worse?</p>
</td></tr>
  <tr class="msg" id="L55"><td class="ts-cell"><a class="ts" href="#L55" alt="Thu Apr 11 2024 08:38:26 GMT-0700 (Pacific Daylight Time)">15:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> the wrapper class could be defined lexically inside the shared struct, or you could just define method syntax directly inside the shared struct definition and the semantics would be that shared struct methods are copied</blockquote></mx-reply>we are proposing methods defined in the struct.</td></tr>
  <tr class="msg" id="L56"><td class="ts-cell"><a class="ts" href="#L56" alt="Thu Apr 11 2024 08:38:50 GMT-0700 (Pacific Daylight Time)">15:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">hm, maybe i misunderstood shu's slides, it looked like he was mutating <code>.prototype</code></td></tr>
  <tr class="msg" id="L57"><td class="ts-cell"><a class="ts" href="#L57" alt="Thu Apr 11 2024 08:39:10 GMT-0700 (Pacific Daylight Time)">15:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">He was showing a build up to what we actually want.</td></tr>
  <tr class="msg" id="L58"><td class="ts-cell"><a class="ts" href="#L58" alt="Thu Apr 11 2024 08:46:07 GMT-0700 (Pacific Daylight Time)">15:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">We already reference source location in TemplateMap. This isn't a new concept</td></tr>
  <tr class="msg" id="L59"><td class="ts-cell"><a class="ts" href="#L59" alt="Thu Apr 11 2024 08:51:18 GMT-0700 (Pacific Daylight Time)">15:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell">Maybe tooling could extract out the minimal part of the struct declarations so they can have a more concrete source text location. And then re-write the code so it can reference that.</td></tr>
  <tr class="msg" id="L60"><td class="ts-cell"><a class="ts" href="#L60" alt="Thu Apr 11 2024 08:51:34 GMT-0700 (Pacific Daylight Time)">15:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell">(for the virtulization case)</td></tr>
  <tr class="msg" id="L61"><td class="ts-cell"><a class="ts" href="#L61" alt="Thu Apr 11 2024 08:52:18 GMT-0700 (Pacific Daylight Time)">15:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">this is a sidebar but it would be nice if we could structuredClone symbols in a coherent way (i.e., such that if you send the same one over twice, you get the same value)</td></tr>
  <tr class="msg" id="L62"><td class="ts-cell"><a class="ts" href="#L62" alt="Thu Apr 11 2024 08:52:44 GMT-0700 (Pacific Daylight Time)">15:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">That's what bundlers would need to do if they have different entrypoints. IIRC, many bundlers can already do source splitting for those cases.</td></tr>
  <tr class="msg" id="L63"><td class="ts-cell"><a class="ts" href="#L63" alt="Thu Apr 11 2024 08:52:54 GMT-0700 (Pacific Daylight Time)">15:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> this is a sidebar but it would be nice if we could structuredClone symbols in a coherent way (i.e., such that if you send the same one over twice, you get the same value)</blockquote></mx-reply>I've been told that this would be too troublesome to implement</td></tr>
  <tr class="msg" id="L64"><td class="ts-cell"><a class="ts" href="#L64" alt="Thu Apr 11 2024 08:53:43 GMT-0700 (Pacific Daylight Time)">15:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> this is a sidebar but it would be nice if we could structuredClone symbols in a coherent way (i.e., such that if you send the same one over twice, you get the same value)</blockquote></mx-reply>only RegisteredSymbols would be the easier form of this</td></tr>
  <tr class="msg" id="L65"><td class="ts-cell"><a class="ts" href="#L65" alt="Thu Apr 11 2024 08:53:56 GMT-0700 (Pacific Daylight Time)">15:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I've been told that this would be too troublesome to implement</blockquote></mx-reply>huh. doesn't seem like it would be that hard.</td></tr>
  <tr class="msg" id="L66"><td class="ts-cell"><a class="ts" href="#L66" alt="Thu Apr 11 2024 08:54:07 GMT-0700 (Pacific Daylight Time)">15:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">the usefulness for me would be unforgeable transferable symbols, ie, not registered ones</td></tr>
  <tr class="msg" id="L67"><td class="ts-cell"><a class="ts" href="#L67" alt="Thu Apr 11 2024 08:54:43 GMT-0700 (Pacific Daylight Time)">15:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">you can do it in userland if you patch postMessage / the message event / structuredClone and stash symbols in a weakmap</td></tr>
  <tr class="msg" id="L68"><td class="ts-cell"><a class="ts" href="#L68" alt="Thu Apr 11 2024 08:56:36 GMT-0700 (Pacific Daylight Time)">15:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><span class="nick-10">littledan</span>: Maybe doesn't matter, but I prefer the term <code>ConcurrentMap</code> to <code>SharedMap</code>. Just because a map is shareable does not mean it can be used concurrently by multiple threads. A true concurrent map uses lock-free CAS mechanisms to allow for concurrent reads and writes.</td></tr>
  <tr class="msg" id="L69"><td class="ts-cell"><a class="ts" href="#L69" alt="Thu Apr 11 2024 08:57:24 GMT-0700 (Pacific Daylight Time)">15:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mhofman:matrix.org">Mathieu Hofman</span>&gt;</div></td><td class="msg-cell"><span class="nick-6">keith_miller</span>: I have previously advocated for a manual correlation over postMessage, but apparently the DX of that is not acceptable, and prevents some use cases that I don't fully understand</td></tr>
  <tr class="msg" id="L70"><td class="ts-cell"><a class="ts" href="#L70" alt="Thu Apr 11 2024 08:58:06 GMT-0700 (Pacific Daylight Time)">15:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> you can do it in userland if you patch postMessage / the message event / structuredClone and stash symbols in a weakmap</blockquote></mx-reply>Like CK, if the sending realm is also trying to put these symbols in a weak{Map/set/ref}, now the local GC only holds them weakly. They might be GC'ed before the round trip comes back</td></tr>
  <tr class="msg" id="L71"><td class="ts-cell"><a class="ts" href="#L71" alt="Thu Apr 11 2024 08:58:39 GMT-0700 (Pacific Daylight Time)">15:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">CK?</td></tr>
  <tr class="msg" id="L72"><td class="ts-cell"><a class="ts" href="#L72" alt="Thu Apr 11 2024 08:58:46 GMT-0700 (Pacific Daylight Time)">15:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">put them in a weakref that's strongly held by a Map, and if the weakref is collected, you can just make a new symbol?</td></tr>
  <tr class="msg" id="L73"><td class="ts-cell"><a class="ts" href="#L73" alt="Thu Apr 11 2024 08:58:55 GMT-0700 (Pacific Daylight Time)">15:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell">CompositeKeys</td></tr>
  <tr class="msg" id="L74"><td class="ts-cell"><a class="ts" href="#L74" alt="Thu Apr 11 2024 08:59:12 GMT-0700 (Pacific Daylight Time)">15:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell">But then that's not round tripping</td></tr>
  <tr class="msg" id="L75"><td class="ts-cell"><a class="ts" href="#L75" alt="Thu Apr 11 2024 08:59:23 GMT-0700 (Pacific Daylight Time)">15:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">ah, sure, ok</td></tr>
  <tr class="msg" id="L76"><td class="ts-cell"><a class="ts" href="#L76" alt="Thu Apr 11 2024 08:59:44 GMT-0700 (Pacific Daylight Time)">15:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">ah true, hm</td></tr>
  <tr class="msg" id="L77"><td class="ts-cell"><a class="ts" href="#L77" alt="Thu Apr 11 2024 09:00:28 GMT-0700 (Pacific Daylight Time)">16:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell">In Java Valhala, they 'fix' that by letting WeakMaps have a 'soft' policy. Where there is no guarantee that the value will remain in the map, even if it's reachable</td></tr>
  <tr class="msg" id="L78"><td class="ts-cell"><a class="ts" href="#L78" alt="Thu Apr 11 2024 09:00:50 GMT-0700 (Pacific Daylight Time)">16:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <span class="nick-10">littledan</span>: Maybe doesn't matter, but I prefer the term <code>ConcurrentMap</code> to <code>SharedMap</code>. Just because a map is shareable does not mean it can be used concurrently by multiple threads. A true concurrent map uses lock-free CAS mechanisms to allow for concurrent reads and writes.</blockquote></mx-reply>I don't get it; shouldn't we use ConcurrentArray then?</td></tr>
  <tr class="msg" id="L79"><td class="ts-cell"><a class="ts" href="#L79" alt="Thu Apr 11 2024 09:01:39 GMT-0700 (Pacific Daylight Time)">16:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Arrays only usually require a single operation to update. Maps require many more operations that are not thread safe.</td></tr>
  <tr class="msg" id="L80"><td class="ts-cell"><a class="ts" href="#L80" alt="Thu Apr 11 2024 09:02:49 GMT-0700 (Pacific Daylight Time)">16:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mhofman:matrix.org">Mathieu Hofman</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I've been told that this would be too troublesome to implement</blockquote></mx-reply>How is it so much more troublesome that sharing an instance of <code>shared struct SharedSymbol {}</code> ?</td></tr>
  <tr class="msg" id="L81"><td class="ts-cell"><a class="ts" href="#L81" alt="Thu Apr 11 2024 09:03:31 GMT-0700 (Pacific Daylight Time)">16:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell">SharedStructs are in someways finite (and eternal), due to source text location ?</td></tr>
  <tr class="msg" id="L82"><td class="ts-cell"><a class="ts" href="#L82" alt="Thu Apr 11 2024 09:03:42 GMT-0700 (Pacific Daylight Time)">16:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mhofman:matrix.org">Mathieu Hofman</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> you can do it in userland if you patch postMessage / the message event / structuredClone and stash symbols in a weakmap</blockquote></mx-reply>You cannot if you want to make sure you don't leak memory. You need distributed GC for this to work</td></tr>
  <tr class="msg" id="L83"><td class="ts-cell"><a class="ts" href="#L83" alt="Thu Apr 11 2024 09:04:12 GMT-0700 (Pacific Daylight Time)">16:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">presumably shared structs will in fact be more work than structuredCloning symbols would be, and engines just think it's worth it because it is plainly much more valuable</td></tr>
  <tr class="msg" id="L84"><td class="ts-cell"><a class="ts" href="#L84" alt="Thu Apr 11 2024 09:05:39 GMT-0700 (Pacific Daylight Time)">16:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mhofman:matrix.org">Mathieu Hofman</span>&gt;</div></td><td class="msg-cell">Right, if you do the work for shared structs you basically could share unique symbols almost for free</td></tr>
  <tr class="msg" id="L85"><td class="ts-cell"><a class="ts" href="#L85" alt="Thu Apr 11 2024 09:06:21 GMT-0700 (Pacific Daylight Time)">16:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mhofman:matrix.org">Mathieu Hofman</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> SharedStructs are in someways finite (and eternal), due to source text location ?</blockquote></mx-reply>instances of shared structs are definitely not eternal. they require distributed gc. and fun part, they can be used as WeakMap keys</td></tr>
  <tr class="msg" id="L86"><td class="ts-cell"><a class="ts" href="#L86" alt="Thu Apr 11 2024 09:07:20 GMT-0700 (Pacific Daylight Time)">16:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">it would certainly be a nice bonus if this feature gave us clonable symbols!</td></tr>
  <tr class="msg" id="L87"><td class="ts-cell"><a class="ts" href="#L87" alt="Thu Apr 11 2024 09:10:22 GMT-0700 (Pacific Daylight Time)">16:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@haxjs:matrix.org">hax (HE Shi-Jun)</span>&gt;</div></td><td class="msg-cell">Will <code>import {SharedStruct} from "shared.js" with { foo: "bar" }</code> have same source location? I guess not?</td></tr>
  <tr class="msg" id="L88"><td class="ts-cell"><a class="ts" href="#L88" alt="Thu Apr 11 2024 09:12:41 GMT-0700 (Pacific Daylight Time)">16:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> How is it so much more troublesome that sharing an instance of <code>shared struct SharedSymbol {}</code> ?</blockquote></mx-reply>I guess this was from back when we didn't have a shared heap, and it would've been about correlating signals in different agents (and then the question is, how do you GC them)</td></tr>
  <tr class="msg" id="L89"><td class="ts-cell"><a class="ts" href="#L89" alt="Thu Apr 11 2024 09:32:53 GMT-0700 (Pacific Daylight Time)">16:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@gibson042:matrix.org">Richard Gibson</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <span class="nick-6">keith_miller</span>: I have previously advocated for a manual correlation over postMessage, but apparently the DX of that is not acceptable, and prevents some use cases that I don't fully understand</blockquote></mx-reply><p>I'd <em>really</em> like to see these use cases enumerated, because it seems to me like explicit handshaking in which e.g. a reference to the shared struct is exchanged constitutes a more comprehensible and robust pattern</p>
<pre><code>let ready = false;
onmessage = evt =&gt; {
  if (!ready) {
    ready = true;
    correlate(localStructDef, evt.data);
    return;
  }

  assert(Object.getPrototypeOf(evt.data) === localStructDef.prototype);
  …use evt.data as an instance of the shared struct…
}
</code></pre>
</td></tr>
  <tr class="msg" id="L90"><td class="ts-cell"><a class="ts" href="#L90" alt="Thu Apr 11 2024 09:35:12 GMT-0700 (Pacific Daylight Time)">16:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">Yeah, I guess I still don't fully understand. It seems like the spawner of a worker could just forward their shared types to that worker before revealing the existence of that worker to the world. Or alternatively the spawned worker could fetch the shared structs lazily, if desired.</td></tr>
  <tr class="msg" id="L91"><td class="ts-cell"><a class="ts" href="#L91" alt="Thu Apr 11 2024 09:37:21 GMT-0700 (Pacific Daylight Time)">16:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">maybe the answer to this question would be in the V8 CL history, if Shu has already implemented it and found it to be not good enough?</td></tr>
  <tr class="msg" id="L92"><td class="ts-cell"><a class="ts" href="#L92" alt="Thu Apr 11 2024 09:39:22 GMT-0700 (Pacific Daylight Time)">16:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">I guess it could be hard to do it lazily because there's no sync postMessage for workers</td></tr>
  <tr class="msg" id="L93"><td class="ts-cell"><a class="ts" href="#L93" alt="Thu Apr 11 2024 09:41:43 GMT-0700 (Pacific Daylight Time)">16:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <p>I'd <em>really</em> like to see these use cases enumerated, because it seems to me like explicit handshaking in which e.g. a reference to the shared struct is exchanged constitutes a more comprehensible and robust pattern</p>
<pre><code>let ready = false;
onmessage = evt =&gt; {
  if (!ready) {
    ready = true;
    correlate(localStructDef, evt.data);
    return;
  }

  assert(Object.getPrototypeOf(evt.data) === localStructDef.prototype);
  …use evt.data as an instance of the shared struct…
}
</code></pre>
</blockquote></mx-reply>that constitutes a barrier though, right?</td></tr>
  <tr class="msg" id="L94"><td class="ts-cell"><a class="ts" href="#L94" alt="Thu Apr 11 2024 09:42:22 GMT-0700 (Pacific Daylight Time)">16:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">like, your workers can't just import and start doing stuff. it has to import, wait till some barrier is reached, then continue doing stuff. it's worse for loading performance</td></tr>
  <tr class="msg" id="L95"><td class="ts-cell"><a class="ts" href="#L95" alt="Thu Apr 11 2024 09:42:35 GMT-0700 (Pacific Daylight Time)">16:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">it's definitely <em>possible</em>, <span class="nick-15">rbuckton</span> has built such a thing</td></tr>
  <tr class="msg" id="L96"><td class="ts-cell"><a class="ts" href="#L96" alt="Thu Apr 11 2024 09:43:14 GMT-0700 (Pacific Daylight Time)">16:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">the "more robust" argument is interesting, i buy the explicitness of it for sure</td></tr>
  <tr class="msg" id="L97"><td class="ts-cell"><a class="ts" href="#L97" alt="Thu Apr 11 2024 09:43:41 GMT-0700 (Pacific Daylight Time)">16:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@gibson042:matrix.org">Richard Gibson</span>&gt;</div></td><td class="msg-cell">an example of "more robust" is the fact that it isn't broken by naïve bundlers</td></tr>
  <tr class="msg" id="L98"><td class="ts-cell"><a class="ts" href="#L98" alt="Thu Apr 11 2024 09:44:00 GMT-0700 (Pacific Daylight Time)">16:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">ah okay</td></tr>
  <tr class="msg" id="L99"><td class="ts-cell"><a class="ts" href="#L99" alt="Thu Apr 11 2024 09:44:15 GMT-0700 (Pacific Daylight Time)">16:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">that depends on whether that's a goal worth optimizing for</td></tr>
  <tr class="msg" id="L100"><td class="ts-cell"><a class="ts" href="#L100" alt="Thu Apr 11 2024 09:44:50 GMT-0700 (Pacific Daylight Time)">16:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">There's only a small handful of bundlers in common use, and they're all maintained by specific individuals who you can talk to, so I don't want to design a feature on the assumption that bundlers will not be writing careful handling</td></tr>
  <tr class="msg" id="L101"><td class="ts-cell"><a class="ts" href="#L101" alt="Thu Apr 11 2024 09:45:01 GMT-0700 (Pacific Daylight Time)">16:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">i was also initially on the other side of comprehendability argument, but flipped after realizing that the "JS classes are distinct per evaluation" thing is pretty JS-specific and folks generally don't have that mental model</td></tr>
  <tr class="msg" id="L102"><td class="ts-cell"><a class="ts" href="#L102" alt="Thu Apr 11 2024 09:45:04 GMT-0700 (Pacific Daylight Time)">16:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I did not build such a thing, but I do have a document describing that kind of interaction. There is a lot more user error involved though. I also have hopes to eventually support <code>#name</code> private state, but it isn't safe to do so unless I can be certain the struct declarations on both sides are identical. A handshaking mechanism makes that impossible.</td></tr>
  <tr class="msg" id="L103"><td class="ts-cell"><a class="ts" href="#L103" alt="Thu Apr 11 2024 09:45:19 GMT-0700 (Pacific Daylight Time)">16:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">i see, i misremembered</td></tr>
  <tr class="msg" id="L104"><td class="ts-cell"><a class="ts" href="#L104" alt="Thu Apr 11 2024 09:45:56 GMT-0700 (Pacific Daylight Time)">16:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Private state can only maintain its privacy if you can ensure the same encapsulation exists in both realms.</td></tr>
  <tr class="msg" id="L105"><td class="ts-cell"><a class="ts" href="#L105" alt="Thu Apr 11 2024 09:46:30 GMT-0700 (Pacific Daylight Time)">16:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@gibson042:matrix.org">Richard Gibson</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> There's only a small handful of bundlers in common use, and they're all maintained by specific individuals who you can talk to, so I don't want to design a feature on the assumption that bundlers will not be writing careful handling</blockquote></mx-reply>I'm not limiting "more robust" to bundlers, just using that as an easily understood example. The same applies to e.g. dynamic code evaluation/version skew/etc.</td></tr>
  <tr class="msg" id="L106"><td class="ts-cell"><a class="ts" href="#L106" alt="Thu Apr 11 2024 09:47:16 GMT-0700 (Pacific Daylight Time)">16:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">Do shared structs allow for private state in the current proposal?</td></tr>
  <tr class="msg" id="L107"><td class="ts-cell"><a class="ts" href="#L107" alt="Thu Apr 11 2024 09:47:39 GMT-0700 (Pacific Daylight Time)">16:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">No, it is not part of the MVP. They do allow fields, methods, getters, and setters though. </td></tr>
  <tr class="msg" id="L108"><td class="ts-cell"><a class="ts" href="#L108" alt="Thu Apr 11 2024 09:47:44 GMT-0700 (Pacific Daylight Time)">16:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">Is that strictly needed? Or just ergonomic?</td></tr>
  <tr class="msg" id="L109"><td class="ts-cell"><a class="ts" href="#L109" alt="Thu Apr 11 2024 09:47:57 GMT-0700 (Pacific Daylight Time)">16:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I believe it is needed.</td></tr>
  <tr class="msg" id="L110"><td class="ts-cell"><a class="ts" href="#L110" alt="Thu Apr 11 2024 09:48:32 GMT-0700 (Pacific Daylight Time)">16:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">You cannot use a <code>WeakMap</code> as pseudo-privacy like you might have done for a <code>class</code> because a <code>WeakMap</code> is local to a specific thread/agent/realm.</td></tr>
  <tr class="msg" id="L111"><td class="ts-cell"><a class="ts" href="#L111" alt="Thu Apr 11 2024 09:48:34 GMT-0700 (Pacific Daylight Time)">16:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">Because it seems like you could wrap the private bits in a per-worker wrapper?</td></tr>
  <tr class="msg" id="L112"><td class="ts-cell"><a class="ts" href="#L112" alt="Thu Apr 11 2024 09:48:59 GMT-0700 (Pacific Daylight Time)">16:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">How, without exposing the private state as public state?</td></tr>
  <tr class="msg" id="L113"><td class="ts-cell"><a class="ts" href="#L113" alt="Thu Apr 11 2024 09:49:22 GMT-0700 (Pacific Daylight Time)">16:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">You have to share something between threads to communicate private state, and if it is not itself private then there is no private state.</td></tr>
  <tr class="msg" id="L114"><td class="ts-cell"><a class="ts" href="#L114" alt="Thu Apr 11 2024 09:49:22 GMT-0700 (Pacific Daylight Time)">16:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">I guess you can't have that in transitive members though?</td></tr>
  <tr class="msg" id="L115"><td class="ts-cell"><a class="ts" href="#L115" alt="Thu Apr 11 2024 09:50:49 GMT-0700 (Pacific Daylight Time)">16:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">I also don't fully understand how private state interacts with wasm GC</td></tr>
  <tr class="msg" id="L116"><td class="ts-cell"><a class="ts" href="#L116" alt="Thu Apr 11 2024 09:52:10 GMT-0700 (Pacific Daylight Time)">16:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">If private state was important for <code>class</code>, despite <code>WeakMap</code> as a possible solution, then it is <em>more</em> important for <code>struct</code> as <code>WeakMap</code> is not a possible solution. There are a lot of open questions on private state, which is why it's not part of the MVP, but I don't want to chose a direction that completely rules it out as a possibility.</td></tr>
  <tr class="msg" id="L117"><td class="ts-cell"><a class="ts" href="#L117" alt="Thu Apr 11 2024 09:52:46 GMT-0700 (Pacific Daylight Time)">16:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Are we resuming at 1:00pm or 1:10pm?</td></tr>
  <tr class="msg" id="L118"><td class="ts-cell"><a class="ts" href="#L118" alt="Thu Apr 11 2024 09:53:43 GMT-0700 (Pacific Daylight Time)">16:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">i heard 1</td></tr>
  <tr class="msg" id="L119"><td class="ts-cell"><a class="ts" href="#L119" alt="Thu Apr 11 2024 09:54:23 GMT-0700 (Pacific Daylight Time)">16:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Ah, trying to finish eating and wrangling my dogs before we start back up. Thanks</td></tr>
  <tr class="msg" id="L120"><td class="ts-cell"><a class="ts" href="#L120" alt="Thu Apr 11 2024 09:54:37 GMT-0700 (Pacific Daylight Time)">16:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">you're eating your dogs? (lol sorry, will take it to tdz)</td></tr>
  <tr class="msg" id="L121"><td class="ts-cell"><a class="ts" href="#L121" alt="Thu Apr 11 2024 09:54:44 GMT-0700 (Pacific Daylight Time)">16:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">lol.</td></tr>
  <tr class="msg" id="L122"><td class="ts-cell"><a class="ts" href="#L122" alt="Thu Apr 11 2024 09:55:33 GMT-0700 (Pacific Daylight Time)">16:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@gibson042:matrix.org">Richard Gibson</span>&gt;</div></td><td class="msg-cell"><p>I dispute the "makes that impossible" claim. As a strawperson, consider</p>
<pre><code>shared struct SharedPoint {
  #id;
  x;
  y;
  …
}
</code></pre>
<p>describing a struct with three fields in which instance properties <code>x</code> and <code>y</code> can be accessed from anywhere but <code>#id</code> can be accessed only from functions within the definition (i.e., just like <code>class</code>)</p>
</td></tr>
  <tr class="msg" id="L123"><td class="ts-cell"><a class="ts" href="#L123" alt="Thu Apr 11 2024 09:56:38 GMT-0700 (Pacific Daylight Time)">16:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Sure. And via handshaking I can replace what with my own <code>SharedPoint</code> that has a getter that exposes <code>#id</code>.</td></tr>
  <tr class="msg" id="L124"><td class="ts-cell"><a class="ts" href="#L124" alt="Thu Apr 11 2024 09:56:55 GMT-0700 (Pacific Daylight Time)">16:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">The correlation must be unforgeable.</td></tr>
  <tr class="msg" id="L125"><td class="ts-cell"><a class="ts" href="#L125" alt="Thu Apr 11 2024 09:56:55 GMT-0700 (Pacific Daylight Time)">16:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@gibson042:matrix.org">Richard Gibson</span>&gt;</div></td><td class="msg-cell">correct</td></tr>
  <tr class="msg" id="L126"><td class="ts-cell"><a class="ts" href="#L126" alt="Thu Apr 11 2024 09:57:12 GMT-0700 (Pacific Daylight Time)">16:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@gibson042:matrix.org">Richard Gibson</span>&gt;</div></td><td class="msg-cell">because...?</td></tr>
  <tr class="msg" id="L127"><td class="ts-cell"><a class="ts" href="#L127" alt="Thu Apr 11 2024 09:57:37 GMT-0700 (Pacific Daylight Time)">16:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Otherwise a bad actor could spin up a worker with code that does this, pass it a shared struct instance, and extract the private state.</td></tr>
  <tr class="msg" id="L128"><td class="ts-cell"><a class="ts" href="#L128" alt="Thu Apr 11 2024 09:58:04 GMT-0700 (Pacific Daylight Time)">16:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">or even observe that it exists.</td></tr>
  <tr class="msg" id="L129"><td class="ts-cell"><a class="ts" href="#L129" alt="Thu Apr 11 2024 09:58:28 GMT-0700 (Pacific Daylight Time)">16:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">How are they doing this?</td></tr>
  <tr class="msg" id="L130"><td class="ts-cell"><a class="ts" href="#L130" alt="Thu Apr 11 2024 09:58:49 GMT-0700 (Pacific Daylight Time)">16:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@gibson042:matrix.org">Richard Gibson</span>&gt;</div></td><td class="msg-cell">it seems like you and I have wildly different threat models and conceptions of the purpose of private fields</td></tr>
  <tr class="msg" id="L131"><td class="ts-cell"><a class="ts" href="#L131" alt="Thu Apr 11 2024 09:58:52 GMT-0700 (Pacific Daylight Time)">16:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">Wouldn't they be different types? With different private names?</td></tr>
  <tr class="msg" id="L132"><td class="ts-cell"><a class="ts" href="#L132" alt="Thu Apr 11 2024 09:58:52 GMT-0700 (Pacific Daylight Time)">16:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Sorry, must finish eating and prep for my presentation.</td></tr>
  <tr class="msg" id="L133"><td class="ts-cell"><a class="ts" href="#L133" alt="Thu Apr 11 2024 10:00:28 GMT-0700 (Pacific Daylight Time)">17:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mhofman:matrix.org">Mathieu Hofman</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Private state can only maintain its privacy if you can ensure the same encapsulation exists in both realms.</blockquote></mx-reply>Not entirely true. If the capability is derived from the shared struct declaration, it is likely fine for that capability to allow wiring private state access. The same way you can declare static methods on a class that can be plucked to give friends the ability to access class privates.</td></tr>
  <tr class="msg" id="L134"><td class="ts-cell"><a class="ts" href="#L134" alt="Thu Apr 11 2024 10:01:55 GMT-0700 (Pacific Daylight Time)">17:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@gibson042:matrix.org">Richard Gibson</span>&gt;</div></td><td class="msg-cell">exactly. Access to private fields in the above example would require a reference to the struct <em>definition</em>; a mere instance would not suffice</td></tr>
  <tr class="msg" id="L135"><td class="ts-cell"><a class="ts" href="#L135" alt="Thu Apr 11 2024 10:02:45 GMT-0700 (Pacific Daylight Time)">17:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Wouldn't they be different types? With different private names?</blockquote></mx-reply>it'd be like, you'd have a different private name in each agent, but they would both be associated to the same underlying field in memory</td></tr>
  <tr class="msg" id="L136"><td class="ts-cell"><a class="ts" href="#L136" alt="Thu Apr 11 2024 10:02:57 GMT-0700 (Pacific Daylight Time)">17:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell"><span class="nick-3">ryzokuken</span> / <span class="nick-1">Chris de Almeida</span> : Will we have time for the extractor continuation?</td></tr>
  <tr class="msg" id="L137"><td class="ts-cell"><a class="ts" href="#L137" alt="Thu Apr 11 2024 10:02:58 GMT-0700 (Pacific Daylight Time)">17:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@softwarechris:matrix.org">Chris de Almeida</span>&gt;</div></td><td class="msg-cell">for anyone who is disappointed that they missed their opportunity to help with the notes during this plenary meeting, there is an opportunity opening up in about 30 minutes after this topic.  please register your interest by contacting the chair group. first come, first served.  thank you 🙏</td></tr>
  <tr class="msg" id="L138"><td class="ts-cell"><a class="ts" href="#L138" alt="Thu Apr 11 2024 10:03:35 GMT-0700 (Pacific Daylight Time)">17:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@softwarechris:matrix.org">Chris de Almeida</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <span class="nick-3">ryzokuken</span> / <span class="nick-1">Chris de Almeida</span> : Will we have time for the extractor continuation?</blockquote></mx-reply>virtually no chance, unfortunately 😞</td></tr>
  <tr class="msg" id="L139"><td class="ts-cell"><a class="ts" href="#L139" alt="Thu Apr 11 2024 10:03:46 GMT-0700 (Pacific Daylight Time)">17:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">Alas.</td></tr>
  <tr class="msg" id="L140"><td class="ts-cell"><a class="ts" href="#L140" alt="Thu Apr 11 2024 10:04:42 GMT-0700 (Pacific Daylight Time)">17:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@akirose:matrix.org">Aki</span>&gt;</div></td><td class="msg-cell">yikes i'm having a really hard time cognitively keeping up, this is the first time i've tried doing notes since i went on leave for a head injury and maybe it was a touch overambitious of me</td></tr>
  <tr class="msg" id="L141"><td class="ts-cell"><a class="ts" href="#L141" alt="Thu Apr 11 2024 10:05:49 GMT-0700 (Pacific Daylight Time)">17:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@softwarechris:matrix.org">Chris de Almeida</span>&gt;</div></td><td class="msg-cell">oh.  hopefully Daniel is able to keep up. chairs also help but aren't always able to. if you need to bow out, no worries, don't feel obliged if the vibes are off</td></tr>
  <tr class="msg" id="L142"><td class="ts-cell"><a class="ts" href="#L142" alt="Thu Apr 11 2024 10:10:49 GMT-0700 (Pacific Daylight Time)">17:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">the getter and the FinalizationRegistry solutions don't seem so bad...</td></tr>
  <tr class="msg" id="L143"><td class="ts-cell"><a class="ts" href="#L143" alt="Thu Apr 11 2024 10:13:19 GMT-0700 (Pacific Daylight Time)">17:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@pchimento:igalia.com">ptomato</span>&gt;</div></td><td class="msg-cell">particularly FinalizationRegistry seems pretty suboptimal compared to strict enforcement where you can just throw one exception saying "you forgot <code>using</code>" <em>from the source code location where you forgot it</em></td></tr>
  <tr class="msg" id="L144"><td class="ts-cell"><a class="ts" href="#L144" alt="Thu Apr 11 2024 10:13:38 GMT-0700 (Pacific Daylight Time)">17:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">FinalizationRegistry is very bad</td></tr>
  <tr class="msg" id="L145"><td class="ts-cell"><a class="ts" href="#L145" alt="Thu Apr 11 2024 10:13:43 GMT-0700 (Pacific Daylight Time)">17:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">it is not a guarantee at all</td></tr>
  <tr class="msg" id="L146"><td class="ts-cell"><a class="ts" href="#L146" alt="Thu Apr 11 2024 10:13:49 GMT-0700 (Pacific Daylight Time)">17:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">and it is at some point in the future</td></tr>
  <tr class="msg" id="L147"><td class="ts-cell"><a class="ts" href="#L147" alt="Thu Apr 11 2024 10:13:59 GMT-0700 (Pacific Daylight Time)">17:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">it's really, really not a solution for anything except releasing memory</td></tr>
  <tr class="msg" id="L148"><td class="ts-cell"><a class="ts" href="#L148" alt="Thu Apr 11 2024 10:14:04 GMT-0700 (Pacific Daylight Time)">17:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">which is the only thing it was ever for</td></tr>
  <tr class="msg" id="L149"><td class="ts-cell"><a class="ts" href="#L149" alt="Thu Apr 11 2024 10:15:29 GMT-0700 (Pacific Daylight Time)">17:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mhofman:matrix.org">Mathieu Hofman</span>&gt;</div></td><td class="msg-cell">FR is only ok here as a diagnostic mechanism </td></tr>
  <tr class="msg" id="L150"><td class="ts-cell"><a class="ts" href="#L150" alt="Thu Apr 11 2024 10:24:46 GMT-0700 (Pacific Daylight Time)">17:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">Is <a href="https://matrix.to/#/%40shuyuguo%3Amatrix.org">@shu</a>'s concern that you can just manually call <code data-md="`">foo[Symbol.enter]()</code> and so there’s no real enforcement?</td></tr>
  <tr class="msg" id="L151"><td class="ts-cell"><a class="ts" href="#L151" alt="Thu Apr 11 2024 10:25:00 GMT-0700 (Pacific Daylight Time)">17:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell"><ul>
<li>it's still not local warning to the user doing something wrong</li>
</ul>
</td></tr>
  <tr class="msg" id="L152"><td class="ts-cell"><a class="ts" href="#L152" alt="Thu Apr 11 2024 10:25:13 GMT-0700 (Pacific Daylight Time)">17:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">yeah but you don't have the resource if you don't call Symbol.enter, so there's no leak</td></tr>
  <tr class="msg" id="L153"><td class="ts-cell"><a class="ts" href="#L153" alt="Thu Apr 11 2024 10:25:19 GMT-0700 (Pacific Daylight Time)">17:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">right okay</td></tr>
  <tr class="msg" id="L154"><td class="ts-cell"><a class="ts" href="#L154" alt="Thu Apr 11 2024 10:25:29 GMT-0700 (Pacific Daylight Time)">17:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">i think i understand it now, it's just not [[nodiscard]]</td></tr>
  <tr class="msg" id="L155"><td class="ts-cell"><a class="ts" href="#L155" alt="Thu Apr 11 2024 10:25:32 GMT-0700 (Pacific Daylight Time)">17:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">it's something pretty different</td></tr>
  <tr class="msg" id="L156"><td class="ts-cell"><a class="ts" href="#L156" alt="Thu Apr 11 2024 10:25:35 GMT-0700 (Pacific Daylight Time)">17:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">yeah</td></tr>
  <tr class="msg" id="L157"><td class="ts-cell"><a class="ts" href="#L157" alt="Thu Apr 11 2024 10:26:15 GMT-0700 (Pacific Daylight Time)">17:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">it really does seem like you have to gate every public operation on "the dispose getter has been called, and the resource is not yet disposed" (in order to get the enforcement that motivates this proposal)</td></tr>
  <tr class="msg" id="L158"><td class="ts-cell"><a class="ts" href="#L158" alt="Thu Apr 11 2024 10:26:43 GMT-0700 (Pacific Daylight Time)">17:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">iow, the entire thing is invalid before being <code>using</code>d - queued for disposal - and again invalid after disposal</td></tr>
  <tr class="msg" id="L159"><td class="ts-cell"><a class="ts" href="#L159" alt="Thu Apr 11 2024 10:26:51 GMT-0700 (Pacific Daylight Time)">17:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">"resource is not yet disposed" is not quite as important; that can be invalid but is not a leak</td></tr>
  <tr class="msg" id="L160"><td class="ts-cell"><a class="ts" href="#L160" alt="Thu Apr 11 2024 10:27:34 GMT-0700 (Pacific Daylight Time)">17:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">it's still probably good practice but the hit to performance for public fields is not necessarily worth it</td></tr>
  <tr class="msg" id="L161"><td class="ts-cell"><a class="ts" href="#L161" alt="Thu Apr 11 2024 10:27:53 GMT-0700 (Pacific Daylight Time)">17:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">can... TS add [[nodiscard]]?</td></tr>
  <tr class="msg" id="L162"><td class="ts-cell"><a class="ts" href="#L162" alt="Thu Apr 11 2024 10:28:06 GMT-0700 (Pacific Daylight Time)">17:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">not yet disposed? or not yet queued for disposal? because the former true, and the latter false, is the only time you want people to interact with the resource, i'd think</td></tr>
  <tr class="msg" id="L163"><td class="ts-cell"><a class="ts" href="#L163" alt="Thu Apr 11 2024 10:28:12 GMT-0700 (Pacific Daylight Time)">17:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><a href="https://github.com/microsoft/TypeScript/issues/8240">https://github.com/microsoft/TypeScript/issues/8240</a></td></tr>
  <tr class="msg" id="L164"><td class="ts-cell"><a class="ts" href="#L164" alt="Thu Apr 11 2024 10:28:30 GMT-0700 (Pacific Daylight Time)">17:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell">The userland solution might be a naming convention</td></tr>
  <tr class="msg" id="L165"><td class="ts-cell"><a class="ts" href="#L165" alt="Thu Apr 11 2024 10:28:40 GMT-0700 (Pacific Daylight Time)">17:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell">like how in react all hooks are <code>use[A-Z...</code></td></tr>
  <tr class="msg" id="L166"><td class="ts-cell"><a class="ts" href="#L166" alt="Thu Apr 11 2024 10:28:54 GMT-0700 (Pacific Daylight Time)">17:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell">and linters enforce where they are allowed to be called from</td></tr>
  <tr class="msg" id="L167"><td class="ts-cell"><a class="ts" href="#L167" alt="Thu Apr 11 2024 10:28:56 GMT-0700 (Pacific Daylight Time)">17:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">oof, that was such a poor choice by react tho</td></tr>
  <tr class="msg" id="L168"><td class="ts-cell"><a class="ts" href="#L168" alt="Thu Apr 11 2024 10:29:05 GMT-0700 (Pacific Daylight Time)">17:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">unfortunately Ron wants to add Symbol.dispose to existing things, which do not follow any naming convention</td></tr>
  <tr class="msg" id="L169"><td class="ts-cell"><a class="ts" href="#L169" alt="Thu Apr 11 2024 10:29:21 GMT-0700 (Pacific Daylight Time)">17:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">i think they're still planning to name their new mega-hook "use", so RIP googling for things</td></tr>
  <tr class="msg" id="L170"><td class="ts-cell"><a class="ts" href="#L170" alt="Thu Apr 11 2024 10:29:26 GMT-0700 (Pacific Daylight Time)">17:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> unfortunately Ron wants to add Symbol.dispose to existing things, which do not follow any naming convention</blockquote></mx-reply>they'll have to be grandparented in to the set of names ;)</td></tr>
  <tr class="msg" id="L171"><td class="ts-cell"><a class="ts" href="#L171" alt="Thu Apr 11 2024 10:29:52 GMT-0700 (Pacific Daylight Time)">17:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">inconsistent naming I think makes that naming not viable as a solution for saving people from errors here</td></tr>
  <tr class="msg" id="L172"><td class="ts-cell"><a class="ts" href="#L172" alt="Thu Apr 11 2024 10:30:16 GMT-0700 (Pacific Daylight Time)">17:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">It'd be nice if we can really nail down the full scope of these protocols before Stage 3. It'll make rollout of this solution slower to have this diversity of interpretations for using.</td></tr>
  <tr class="msg" id="L173"><td class="ts-cell"><a class="ts" href="#L173" alt="Thu Apr 11 2024 10:31:39 GMT-0700 (Pacific Daylight Time)">17:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">It's too bad that this proposal doesn't give strong enough guarantees to let us use it for AsyncContext</td></tr>
  <tr class="msg" id="L174"><td class="ts-cell"><a class="ts" href="#L174" alt="Thu Apr 11 2024 10:32:15 GMT-0700 (Pacific Daylight Time)">17:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@pchimento:igalia.com">ptomato</span>&gt;</div></td><td class="msg-cell">I'm not sure I understand why adding strict enforcement will bifurcate the ecosystem. resource management doesn't exist currently; code wanting to use resource management needs to port, so why would strict enforcement be a burden that hinders adoption?</td></tr>
  <tr class="msg" id="L175"><td class="ts-cell"><a class="ts" href="#L175" alt="Thu Apr 11 2024 10:33:01 GMT-0700 (Pacific Daylight Time)">17:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">rbuckton</span>: to be clear I am not going to block further advancement of <code>using</code> on this feature existing: it is too late in the process</td></tr>
  <tr class="msg" id="L176"><td class="ts-cell"><a class="ts" href="#L176" alt="Thu Apr 11 2024 10:33:13 GMT-0700 (Pacific Daylight Time)">17:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><em>Mandatory</em> strict enforcement could cause bifurcation. That's why this is an opt-in mechanism.</td></tr>
  <tr class="msg" id="L177"><td class="ts-cell"><a class="ts" href="#L177" alt="Thu Apr 11 2024 10:33:20 GMT-0700 (Pacific Daylight Time)">17:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@abotella:igalia.com">Andreu Botella</span>&gt;</div></td><td class="msg-cell">I opened an issue yesterday to discuss this: <a href="https://github.com/rbuckton/proposal-using-enforcement/issues/1">https://github.com/rbuckton/proposal-using-enforcement/issues/1</a></td></tr>
  <tr class="msg" id="L178"><td class="ts-cell"><a class="ts" href="#L178" alt="Thu Apr 11 2024 10:33:38 GMT-0700 (Pacific Daylight Time)">17:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mhofman:matrix.org">Mathieu Hofman</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> It's too bad that this proposal doesn't give strong enough guarantees to let us use it for AsyncContext</blockquote></mx-reply>why is it not sufficient?</td></tr>
  <tr class="msg" id="L179"><td class="ts-cell"><a class="ts" href="#L179" alt="Thu Apr 11 2024 10:33:42 GMT-0700 (Pacific Daylight Time)">17:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I'm not sure I understand why adding strict enforcement will bifurcate the ecosystem. resource management doesn't exist currently; code wanting to use resource management needs to port, so why would strict enforcement be a burden that hinders adoption?</blockquote></mx-reply>I think it means, if some transpilers/browsers ship the initial <code>using</code> semantics, and others ship the later semantics, then it's harder to start shipping APIs using strict enforcement (since it's not enough to check whether the syntax exists, you also have to check that users are updated)</td></tr>
  <tr class="msg" id="L180"><td class="ts-cell"><a class="ts" href="#L180" alt="Thu Apr 11 2024 10:34:06 GMT-0700 (Pacific Daylight Time)">17:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> why is it not sufficient?</blockquote></mx-reply>you can just call enter and not call dispose, so you'd have unbalanced use of the stack</td></tr>
  <tr class="msg" id="L181"><td class="ts-cell"><a class="ts" href="#L181" alt="Thu Apr 11 2024 10:34:11 GMT-0700 (Pacific Daylight Time)">17:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@pchimento:igalia.com">ptomato</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I think it means, if some transpilers/browsers ship the initial <code>using</code> semantics, and others ship the later semantics, then it's harder to start shipping APIs using strict enforcement (since it's not enough to check whether the syntax exists, you also have to check that users are updated)</blockquote></mx-reply>that's the breaks of stage 3 though?</td></tr>
  <tr class="msg" id="L182"><td class="ts-cell"><a class="ts" href="#L182" alt="Thu Apr 11 2024 10:34:34 GMT-0700 (Pacific Daylight Time)">17:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> that's the breaks of stage 3 though?</blockquote></mx-reply>right, the part that makes this painful is that we knew about this part of the design space through the whole life of the <code>using</code> proposal.</td></tr>
  <tr class="msg" id="L183"><td class="ts-cell"><a class="ts" href="#L183" alt="Thu Apr 11 2024 10:34:43 GMT-0700 (Pacific Daylight Time)">17:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">it is within our power to demote a proposal from stage 3 to 2</td></tr>
  <tr class="msg" id="L184"><td class="ts-cell"><a class="ts" href="#L184" alt="Thu Apr 11 2024 10:35:03 GMT-0700 (Pacific Daylight Time)">17:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> you can just call enter and not call dispose, so you'd have unbalanced use of the stack</blockquote></mx-reply>Calling enter is an explicit action the user takes. They are opting out of strict enforcement, and thus must ensure they do the work themselves.</td></tr>
  <tr class="msg" id="L185"><td class="ts-cell"><a class="ts" href="#L185" alt="Thu Apr 11 2024 10:35:42 GMT-0700 (Pacific Daylight Time)">17:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I've said elsewhere, I'd be fine with a <code>Symbol.enter_DO_NOT_USE_OR_YOU_WILL_BE_FIRED</code>, or something less meme-y, to illustrate the unsafe nature of the operation.</td></tr>
  <tr class="msg" id="L186"><td class="ts-cell"><a class="ts" href="#L186" alt="Thu Apr 11 2024 10:35:57 GMT-0700 (Pacific Daylight Time)">17:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@abotella:igalia.com">Andreu Botella</span>&gt;</div></td><td class="msg-cell">We agree that if a user does this, their code is buggy. I don't think that's in discussion. But some use cases need something stricter</td></tr>
  <tr class="msg" id="L187"><td class="ts-cell"><a class="ts" href="#L187" alt="Thu Apr 11 2024 10:36:10 GMT-0700 (Pacific Daylight Time)">17:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">I'm going to guess that implementors are going to reject production time work for the equivelent of a [[nodiscard]] attribute. I know I currently would.</td></tr>
  <tr class="msg" id="L188"><td class="ts-cell"><a class="ts" href="#L188" alt="Thu Apr 11 2024 10:36:20 GMT-0700 (Pacific Daylight Time)">17:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Calling enter is an explicit action the user takes. They are opting out of strict enforcement, and thus must ensure they do the work themselves.</blockquote></mx-reply>right, so in the rollout, people may find themselves wanting to do that more than would be optimal, to deal with the risk that their code will be transpired with an older version of <code>using</code>.</td></tr>
  <tr class="msg" id="L189"><td class="ts-cell"><a class="ts" href="#L189" alt="Thu Apr 11 2024 10:36:39 GMT-0700 (Pacific Daylight Time)">17:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> We agree that if a user does this, their code is buggy. I don't think that's in discussion. But some use cases need something stricter</blockquote></mx-reply>Without a compiler or type system, I'm not sure something stricter is entirely feasible in JS.</td></tr>
  <tr class="msg" id="L190"><td class="ts-cell"><a class="ts" href="#L190" alt="Thu Apr 11 2024 10:37:00 GMT-0700 (Pacific Daylight Time)">17:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Without a compiler or type system, I'm not sure something stricter is entirely feasible in JS.</blockquote></mx-reply>AsyncContext currently enforces stack discipline strictly by having a callback-based API.</td></tr>
  <tr class="msg" id="L191"><td class="ts-cell"><a class="ts" href="#L191" alt="Thu Apr 11 2024 10:37:11 GMT-0700 (Pacific Daylight Time)">17:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">but there's real demand for having something "flatter"</td></tr>
  <tr class="msg" id="L192"><td class="ts-cell"><a class="ts" href="#L192" alt="Thu Apr 11 2024 10:37:11 GMT-0700 (Pacific Daylight Time)">17:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">you'd do it with a type-aware linter, like typescript-eslint. that's already how people catch unawaited promises with the <code>no-floating-promises</code> rule.</td></tr>
  <tr class="msg" id="L193"><td class="ts-cell"><a class="ts" href="#L193" alt="Thu Apr 11 2024 10:37:31 GMT-0700 (Pacific Daylight Time)">17:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">unary plus is such a weird thing to have</td></tr>
  <tr class="msg" id="L194"><td class="ts-cell"><a class="ts" href="#L194" alt="Thu Apr 11 2024 10:37:38 GMT-0700 (Pacific Daylight Time)">17:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">what was the intention behind its inclusion?</td></tr>
  <tr class="msg" id="L195"><td class="ts-cell"><a class="ts" href="#L195" alt="Thu Apr 11 2024 10:37:46 GMT-0700 (Pacific Daylight Time)">17:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mhofman:matrix.org">Mathieu Hofman</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> you can just call enter and not call dispose, so you'd have unbalanced use of the stack</blockquote></mx-reply>sure, but just don't do that? disposables are not only used syntactically. If you call enter, you accept responsibility to call dispose</td></tr>
  <tr class="msg" id="L196"><td class="ts-cell"><a class="ts" href="#L196" alt="Thu Apr 11 2024 10:37:48 GMT-0700 (Pacific Daylight Time)">17:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@pchimento:igalia.com">ptomato</span>&gt;</div></td><td class="msg-cell">I mean, I'm trying to understand how bad the burden of mandatory enforcement would be? I expect the vast majority of the potential future users of this feature have not ported their code yet (or written it, for that matter)</td></tr>
  <tr class="msg" id="L197"><td class="ts-cell"><a class="ts" href="#L197" alt="Thu Apr 11 2024 10:38:40 GMT-0700 (Pacific Daylight Time)">17:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@abotella:igalia.com">Andreu Botella</span>&gt;</div></td><td class="msg-cell">Do we want to allow that to effectively pollute the caller's scope, switching the current context at their function from under their feet? That's something the current AsyncContext proposal explicitly avoids doing</td></tr>
  <tr class="msg" id="L198"><td class="ts-cell"><a class="ts" href="#L198" alt="Thu Apr 11 2024 10:38:43 GMT-0700 (Pacific Daylight Time)">17:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mhofman:matrix.org">Mathieu Hofman</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> We agree that if a user does this, their code is buggy. I don't think that's in discussion. But some use cases need something stricter</blockquote></mx-reply>I still do not understand the use case</td></tr>
  <tr class="msg" id="L199"><td class="ts-cell"><a class="ts" href="#L199" alt="Thu Apr 11 2024 10:38:56 GMT-0700 (Pacific Daylight Time)">17:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@pchimento:igalia.com">ptomato</span>&gt;</div></td><td class="msg-cell">anyway is there a github issue where I can follow this? I'm splitting my attention between this discussion and Kevin's presentation and it's not working very well 😄</td></tr>
  <tr class="msg" id="L200"><td class="ts-cell"><a class="ts" href="#L200" alt="Thu Apr 11 2024 10:39:25 GMT-0700 (Pacific Daylight Time)">17:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">Yes, we can follow up in <a href="https://github.com/rbuckton/proposal-using-enforcement/issues/1">https://github.com/rbuckton/proposal-using-enforcement/issues/1</a></td></tr>
  <tr class="msg" id="L201"><td class="ts-cell"><a class="ts" href="#L201" alt="Thu Apr 11 2024 10:39:57 GMT-0700 (Pacific Daylight Time)">17:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I mean, I'm trying to understand how bad the burden of mandatory enforcement would be? I expect the vast majority of the potential future users of this feature have not ported their code yet (or written it, for that matter)</blockquote></mx-reply>It depends on the definition of mandatory enforcement. There are two approaches: some magic mechanism that indicates to the resource producer the user is initializing to a <code>using</code>, or that <code>using</code> and <code>DisposableStack</code> explicitly call <code>[Symbol.enter]</code> and throw if it doesn't exist.</td></tr>
  <tr class="msg" id="L202"><td class="ts-cell"><a class="ts" href="#L202" alt="Thu Apr 11 2024 10:40:53 GMT-0700 (Pacific Daylight Time)">17:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">RequireObjectCoercible -&gt; is an Object</td></tr>
  <tr class="msg" id="L203"><td class="ts-cell"><a class="ts" href="#L203" alt="Thu Apr 11 2024 10:41:09 GMT-0700 (Pacific Daylight Time)">17:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mhofman:matrix.org">Mathieu Hofman</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Do we want to allow that to effectively pollute the caller's scope, switching the current context at their function from under their feet? That's something the current AsyncContext proposal explicitly avoids doing</blockquote></mx-reply>Ok I think I now understand, and I have ideas on how to do this at the AsyncContext API layer</td></tr>
  <tr class="msg" id="L204"><td class="ts-cell"><a class="ts" href="#L204" alt="Thu Apr 11 2024 10:41:31 GMT-0700 (Pacific Daylight Time)">17:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">A magical mechanism doesn't work with <code>DisposableStack</code> and wouldn't allow user-defined resource management building blocks.</td></tr>
  <tr class="msg" id="L205"><td class="ts-cell"><a class="ts" href="#L205" alt="Thu Apr 11 2024 10:42:16 GMT-0700 (Pacific Daylight Time)">17:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">lol, core-js used to make Number.prototype iterable</td></tr>
  <tr class="msg" id="L206"><td class="ts-cell"><a class="ts" href="#L206" alt="Thu Apr 11 2024 10:44:43 GMT-0700 (Pacific Daylight Time)">17:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">If <code>[Symbol.enter]</code> is mandatory, existing APIs would have to write <code>[Symbol.enter]() { return this; }</code>, or would need to duplicate the API to one that produces an object with a <code>[Symbol.enter]()</code>. API Bifurcation is a documentation and maintenance headache and would break the ability for tools to introduce simple refactors from <code>const res = ...; try { ... } finally { res.close(); }</code> to <code>using res = ...</code></td></tr>
  <tr class="msg" id="L207"><td class="ts-cell"><a class="ts" href="#L207" alt="Thu Apr 11 2024 10:45:52 GMT-0700 (Pacific Daylight Time)">17:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@abotella:igalia.com">Andreu Botella</span>&gt;</div></td><td class="msg-cell">are we conflating two separate things? I don't think "true strict enforcement" necessarily means a mandatory <code>[Symbol.enter]</code></td></tr>
  <tr class="msg" id="L208"><td class="ts-cell"><a class="ts" href="#L208" alt="Thu Apr 11 2024 10:46:37 GMT-0700 (Pacific Daylight Time)">17:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">For examples of existing APIs that could be adapted to support <code>[Symbol.dispose]</code>, see <a href="https://github.com/tc39/proposal-explicit-resource-management#relation-to-dom-apis">https://github.com/tc39/proposal-explicit-resource-management#relation-to-dom-apis</a> and <a href="https://github.com/tc39/proposal-explicit-resource-management?tab=readme-ov-file#relation-to-nodejs-apis">https://github.com/tc39/proposal-explicit-resource-management?tab=readme-ov-file#relation-to-nodejs-apis</a></td></tr>
  <tr class="msg" id="L209"><td class="ts-cell"><a class="ts" href="#L209" alt="Thu Apr 11 2024 10:46:50 GMT-0700 (Pacific Daylight Time)">17:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> are we conflating two separate things? I don't think "true strict enforcement" necessarily means a mandatory <code>[Symbol.enter]</code></blockquote></mx-reply>What would you consider to be "true strict enforcement"?</td></tr>
  <tr class="msg" id="L210"><td class="ts-cell"><a class="ts" href="#L210" alt="Thu Apr 11 2024 10:47:14 GMT-0700 (Pacific Daylight Time)">17:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@abotella:igalia.com">Andreu Botella</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> A magical mechanism doesn't work with <code>DisposableStack</code> and wouldn't allow user-defined resource management building blocks.</blockquote></mx-reply>^ this "magical mechanism"</td></tr>
  <tr class="msg" id="L211"><td class="ts-cell"><a class="ts" href="#L211" alt="Thu Apr 11 2024 10:48:04 GMT-0700 (Pacific Daylight Time)">17:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Can you conceive of a magical mechanism that works with both <code>using</code> and <code>DisposableStack</code> and user-defined resource management wrapper classes?</td></tr>
  <tr class="msg" id="L212"><td class="ts-cell"><a class="ts" href="#L212" alt="Thu Apr 11 2024 10:48:58 GMT-0700 (Pacific Daylight Time)">17:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@abotella:igalia.com">Andreu Botella</span>&gt;</div></td><td class="msg-cell">I don't have an alternative, but I think that issue has been conflated with the mandatoryness of <code>[Symbol.enter]</code></td></tr>
  <tr class="msg" id="L213"><td class="ts-cell"><a class="ts" href="#L213" alt="Thu Apr 11 2024 10:49:22 GMT-0700 (Pacific Daylight Time)">17:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">for example, if there were a <code>function.using</code> meta-property accessible within a function that is only <code>true</code> when being initialized to a <code>using</code>, how would that work with <code>DisposableStack.prototype.use</code>?</td></tr>
  <tr class="msg" id="L214"><td class="ts-cell"><a class="ts" href="#L214" alt="Thu Apr 11 2024 10:50:18 GMT-0700 (Pacific Daylight Time)">17:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I wasn't trying to conflate strict enforcement with mandatory enforcement. They are mostly separate concerns.</td></tr>
  <tr class="msg" id="L215"><td class="ts-cell"><a class="ts" href="#L215" alt="Thu Apr 11 2024 10:50:56 GMT-0700 (Pacific Daylight Time)">17:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I'm bouncing between two different discussions</td></tr>
  <tr class="msg" id="L216"><td class="ts-cell"><a class="ts" href="#L216" alt="Thu Apr 11 2024 10:51:38 GMT-0700 (Pacific Daylight Time)">17:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">that was much faster than I was expecting!</td></tr>
  <tr class="msg" id="L217"><td class="ts-cell"><a class="ts" href="#L217" alt="Thu Apr 11 2024 10:52:50 GMT-0700 (Pacific Daylight Time)">17:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Mandatory enforcement is a concern for API bifurcation. In general I don't believe mandatory enforcement is necessary, API producers should be able to opt-in or opt-out of enforcement, as should API consumers. </td></tr>
  <tr class="msg" id="L218"><td class="ts-cell"><a class="ts" href="#L218" alt="Thu Apr 11 2024 10:54:46 GMT-0700 (Pacific Daylight Time)">17:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">API producers need an opt-out mechanism for existing APIs or for APIs that don't require such a guarantee. API consumers need an opt-out mechanism so they can compose disposables in their own classes and extend resource management capabilities in userland.</td></tr>
  <tr class="msg" id="L219"><td class="ts-cell"><a class="ts" href="#L219" alt="Thu Apr 11 2024 10:55:00 GMT-0700 (Pacific Daylight Time)">17:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">Agree, mandatory use of <code data-md="`">enter</code> is necessary.</td></tr>
  <tr class="msg" id="L220"><td class="ts-cell"><a class="ts" href="#L220" alt="Thu Apr 11 2024 10:55:16 GMT-0700 (Pacific Daylight Time)">17:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">But for APIs that choose to have an <code data-md="`">enter</code>, some require much stricter requirements.</td></tr>
  <tr class="msg" id="L221"><td class="ts-cell"><a class="ts" href="#L221" alt="Thu Apr 11 2024 10:55:23 GMT-0700 (Pacific Daylight Time)">17:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">(I still need to read <a href="https://github.com/rbuckton/proposal-using-enforcement/issues/1">https://github.com/rbuckton/proposal-using-enforcement/issues/1</a>)</td></tr>
  <tr class="msg" id="L222"><td class="ts-cell"><a class="ts" href="#L222" alt="Thu Apr 11 2024 10:55:27 GMT-0700 (Pacific Daylight Time)">17:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Agree, mandatory use of <code data-md="`">enter</code> is necessary.</blockquote></mx-reply>What are you agreeing with?</td></tr>
  <tr class="msg" id="L223"><td class="ts-cell"><a class="ts" href="#L223" alt="Thu Apr 11 2024 10:55:34 GMT-0700 (Pacific Daylight Time)">17:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">But ideally we’d only allow syntatic <code data-md="`">using</code>.</td></tr>
  <tr class="msg" id="L224"><td class="ts-cell"><a class="ts" href="#L224" alt="Thu Apr 11 2024 10:55:49 GMT-0700 (Pacific Daylight Time)">17:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote>Mandatory enforcement is a concern for API bifurcation. In general I don't believe mandatory enforcement is necessary, API producers should be able to opt-in or opt-out of enforcement, as should API consumers. </blockquote></mx-reply>I was agreeing with this.</td></tr>
  <tr class="msg" id="L225"><td class="ts-cell"><a class="ts" href="#L225" alt="Thu Apr 11 2024 10:55:56 GMT-0700 (Pacific Daylight Time)">17:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I believe <code>Symbol.enter</code> is optional, for those APIs that need it.</td></tr>
  <tr class="msg" id="L226"><td class="ts-cell"><a class="ts" href="#L226" alt="Thu Apr 11 2024 10:56:06 GMT-0700 (Pacific Daylight Time)">17:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mhofman:matrix.org">Mathieu Hofman</span>&gt;</div></td><td class="msg-cell">Syntactic super powers make me feel suspicious</td></tr>
  <tr class="msg" id="L227"><td class="ts-cell"><a class="ts" href="#L227" alt="Thu Apr 11 2024 10:56:12 GMT-0700 (Pacific Daylight Time)">17:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">We can't only have syntactic using.</td></tr>
  <tr class="msg" id="L228"><td class="ts-cell"><a class="ts" href="#L228" alt="Thu Apr 11 2024 10:56:30 GMT-0700 (Pacific Daylight Time)">17:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">You absolutely need composition.</td></tr>
  <tr class="msg" id="L229"><td class="ts-cell"><a class="ts" href="#L229" alt="Thu Apr 11 2024 10:56:57 GMT-0700 (Pacific Daylight Time)">17:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell"><code data-md="`">AsyncContext</code> demands knowing whether you’re using <code data-md="`">using</code> syntatically, using <code data-md="`">DisposableStack</code> (bad), or manually calling (even worse).</td></tr>
  <tr class="msg" id="L230"><td class="ts-cell"><a class="ts" href="#L230" alt="Thu Apr 11 2024 10:57:21 GMT-0700 (Pacific Daylight Time)">17:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mhofman:matrix.org">Mathieu Hofman</span>&gt;</div></td><td class="msg-cell">I don't think this use case requires such a capability. I'll write down my idea after plenary</td></tr>
  <tr class="msg" id="L231"><td class="ts-cell"><a class="ts" href="#L231" alt="Thu Apr 11 2024 10:57:51 GMT-0700 (Pacific Daylight Time)">17:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">why is <code>DisposableStack</code> bad?</td></tr>
  <tr class="msg" id="L232"><td class="ts-cell"><a class="ts" href="#L232" alt="Thu Apr 11 2024 10:58:01 GMT-0700 (Pacific Daylight Time)">17:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">Only syntatic <code data-md="`">using</code> guarantees returning the context stack to the appropriate state.</td></tr>
  <tr class="msg" id="L233"><td class="ts-cell"><a class="ts" href="#L233" alt="Thu Apr 11 2024 10:58:16 GMT-0700 (Pacific Daylight Time)">17:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mhofman:matrix.org">Mathieu Hofman</span>&gt;</div></td><td class="msg-cell">Nope there are alternatives</td></tr>
  <tr class="msg" id="L234"><td class="ts-cell"><a class="ts" href="#L234" alt="Thu Apr 11 2024 10:58:19 GMT-0700 (Pacific Daylight Time)">17:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell"><code data-md="`">DisposableStack</code> may not be disposed.</td></tr>
  <tr class="msg" id="L235"><td class="ts-cell"><a class="ts" href="#L235" alt="Thu Apr 11 2024 10:58:31 GMT-0700 (Pacific Daylight Time)">17:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">Or it’s disposed later.</td></tr>
  <tr class="msg" id="L236"><td class="ts-cell"><a class="ts" href="#L236" alt="Thu Apr 11 2024 10:58:38 GMT-0700 (Pacific Daylight Time)">17:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">In which case the caller has been polluted.</td></tr>
  <tr class="msg" id="L237"><td class="ts-cell"><a class="ts" href="#L237" alt="Thu Apr 11 2024 10:58:44 GMT-0700 (Pacific Daylight Time)">17:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mhofman:matrix.org">Mathieu Hofman</span>&gt;</div></td><td class="msg-cell">you can do a hybrid by introducing a single new stack entry</td></tr>
  <tr class="msg" id="L238"><td class="ts-cell"><a class="ts" href="#L238" alt="Thu Apr 11 2024 10:58:45 GMT-0700 (Pacific Daylight Time)">17:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">Either way, it doesn’t work.</td></tr>
  <tr class="msg" id="L239"><td class="ts-cell"><a class="ts" href="#L239" alt="Thu Apr 11 2024 10:59:33 GMT-0700 (Pacific Daylight Time)">17:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@abotella:igalia.com">Andreu Botella</span>&gt;</div></td><td class="msg-cell">My point with opening that issue is to point out that there are use cases that need something stricter. I would be fine with the proposal simply not supporting that, and using callbacks.</td></tr>
  <tr class="msg" id="L240"><td class="ts-cell"><a class="ts" href="#L240" alt="Thu Apr 11 2024 10:59:36 GMT-0700 (Pacific Daylight Time)">17:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><code>DisposableStack</code>, or any other composition mechanism, is a necessity for building applications that work with resources.</td></tr>
  <tr class="msg" id="L241"><td class="ts-cell"><a class="ts" href="#L241" alt="Thu Apr 11 2024 10:59:54 GMT-0700 (Pacific Daylight Time)">17:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">I’m not arguing against <code data-md="`">DisposableStack</code> in general.</td></tr>
  <tr class="msg" id="L242"><td class="ts-cell"><a class="ts" href="#L242" alt="Thu Apr 11 2024 11:00:08 GMT-0700 (Pacific Daylight Time)">18:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">But it’s not acceptable for <code data-md="`">AsyncContext</code>.</td></tr>
  <tr class="msg" id="L243"><td class="ts-cell"><a class="ts" href="#L243" alt="Thu Apr 11 2024 11:01:02 GMT-0700 (Pacific Daylight Time)">18:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I only have a very rough idea of the use case for <code>AsyncContext</code> you're concerned about.</td></tr>
  <tr class="msg" id="L244"><td class="ts-cell"><a class="ts" href="#L244" alt="Thu Apr 11 2024 11:01:07 GMT-0700 (Pacific Daylight Time)">18:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><span class="nick-6">ljharb</span>: should <code><a href="http://Array.zip">Array.zip</a></code> zip iterables or arrays or array-likes?</td></tr>
  <tr class="msg" id="L245"><td class="ts-cell"><a class="ts" href="#L245" alt="Thu Apr 11 2024 11:01:12 GMT-0700 (Pacific Daylight Time)">18:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I think I need more context.</td></tr>
  <tr class="msg" id="L246"><td class="ts-cell"><a class="ts" href="#L246" alt="Thu Apr 11 2024 11:01:23 GMT-0700 (Pacific Daylight Time)">18:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">presumably array-likes?</td></tr>
  <tr class="msg" id="L247"><td class="ts-cell"><a class="ts" href="#L247" alt="Thu Apr 11 2024 11:01:38 GMT-0700 (Pacific Daylight Time)">18:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">iirc all the array things, except Array.from/fromAsync, take "arraylikes" only (which includes arrays)</td></tr>
  <tr class="msg" id="L248"><td class="ts-cell"><a class="ts" href="#L248" alt="Thu Apr 11 2024 11:01:44 GMT-0700 (Pacific Daylight Time)">18:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">and of course it will produce an array rather than an iterator</td></tr>
  <tr class="msg" id="L249"><td class="ts-cell"><a class="ts" href="#L249" alt="Thu Apr 11 2024 11:01:54 GMT-0700 (Pacific Daylight Time)">18:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">right</td></tr>
  <tr class="msg" id="L250"><td class="ts-cell"><a class="ts" href="#L250" alt="Thu Apr 11 2024 11:02:04 GMT-0700 (Pacific Daylight Time)">18:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mhofman:matrix.org">Mathieu Hofman</span>&gt;</div></td><td class="msg-cell">The stack frame requirement comes from the use case (AsyncContext). It happens that <code>using</code> is a close concept: scope. I will provide an example of API that satisfies the use case without making <code>using</code> required</td></tr>
  <tr class="msg" id="L251"><td class="ts-cell"><a class="ts" href="#L251" alt="Thu Apr 11 2024 11:02:14 GMT-0700 (Pacific Daylight Time)">18:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">i don't <em>mind</em> if it takes iterables, but at that point <code><a href="http://Array.zip">Array.zip</a>(iterables)</code> is just sugar for <code><a href="http://Iterator.zip">Iterator.zip</a>(iterables).toArray()</code> which isn't that valuable</td></tr>
  <tr class="msg" id="L252"><td class="ts-cell"><a class="ts" href="#L252" alt="Thu Apr 11 2024 11:03:00 GMT-0700 (Pacific Daylight Time)">18:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote>I think I need more context.</blockquote></mx-reply>I’ll provide details in the #1 issue later today</td></tr>
  <tr class="msg" id="L253"><td class="ts-cell"><a class="ts" href="#L253" alt="Thu Apr 11 2024 11:03:42 GMT-0700 (Pacific Daylight Time)">18:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">(it's <code>.zip(iterables)</code> not a var-args, to be clear)</td></tr>
  <tr class="msg" id="L254"><td class="ts-cell"><a class="ts" href="#L254" alt="Thu Apr 11 2024 11:05:11 GMT-0700 (Pacific Daylight Time)">18:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">this seems like it will be a useful place to Stop Coercing Things, so that <code>{ optionsbag }</code> isn't treated as an array-like of length 0</td></tr>
  <tr class="msg" id="L255"><td class="ts-cell"><a class="ts" href="#L255" alt="Thu Apr 11 2024 11:09:29 GMT-0700 (Pacific Daylight Time)">18:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell"><p>WH's example:</p>
<pre><code>let x
(a) = b;
</code></pre>
</td></tr>
  <tr class="msg" id="L256"><td class="ts-cell"><a class="ts" href="#L256" alt="Thu Apr 11 2024 11:10:13 GMT-0700 (Pacific Daylight Time)">18:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><code>let</code> strikes again, I hate it</td></tr>
  <tr class="msg" id="L257"><td class="ts-cell"><a class="ts" href="#L257" alt="Thu Apr 11 2024 11:10:20 GMT-0700 (Pacific Daylight Time)">18:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">an NLTH between the identifier and the <code>(</code> seems fine to me, just for extractors</td></tr>
  <tr class="msg" id="L258"><td class="ts-cell"><a class="ts" href="#L258" alt="Thu Apr 11 2024 11:10:43 GMT-0700 (Pacific Daylight Time)">18:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><p>the line break restriction is also bad, I want to write</p>
<pre><code>let Foo
  (long extractor pattern) = RHS
</code></pre>
</td></tr>
  <tr class="msg" id="L259"><td class="ts-cell"><a class="ts" href="#L259" alt="Thu Apr 11 2024 11:10:46 GMT-0700 (Pacific Daylight Time)">18:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell"><p>i don't have empathy for folks who want to write calls like</p>
<pre><code>fn
(a, b)
</code></pre>
</td></tr>
  <tr class="msg" id="L260"><td class="ts-cell"><a class="ts" href="#L260" alt="Thu Apr 11 2024 11:10:50 GMT-0700 (Pacific Daylight Time)">18:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">lol</td></tr>
  <tr class="msg" id="L261"><td class="ts-cell"><a class="ts" href="#L261" alt="Thu Apr 11 2024 11:11:06 GMT-0700 (Pacific Daylight Time)">18:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell"><p>i'd expect there to see</p>
<pre><code>let Foo(
  long extractor pattern
) = RHS
</code></pre>
</td></tr>
  <tr class="msg" id="L262"><td class="ts-cell"><a class="ts" href="#L262" alt="Thu Apr 11 2024 11:11:07 GMT-0700 (Pacific Daylight Time)">18:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">extractors are extremely limited in their syntax; this seems way more minor than the other parts</td></tr>
  <tr class="msg" id="L263"><td class="ts-cell"><a class="ts" href="#L263" alt="Thu Apr 11 2024 11:11:19 GMT-0700 (Pacific Daylight Time)">18:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <p>i'd expect there to see</p>
<pre><code>let Foo(
  long extractor pattern
) = RHS
</code></pre>
</blockquote></mx-reply>I don't think Waldemar's case runs into that</td></tr>
  <tr class="msg" id="L264"><td class="ts-cell"><a class="ts" href="#L264" alt="Thu Apr 11 2024 11:11:46 GMT-0700 (Pacific Daylight Time)">18:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">I think we're just talking about between <code>Foo</code> and <code>)</code></td></tr>
  <tr class="msg" id="L265"><td class="ts-cell"><a class="ts" href="#L265" alt="Thu Apr 11 2024 11:11:50 GMT-0700 (Pacific Daylight Time)">18:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">true, it's only if the extractor pattern looks like a valid parenthesized LHS?</td></tr>
  <tr class="msg" id="L266"><td class="ts-cell"><a class="ts" href="#L266" alt="Thu Apr 11 2024 11:12:19 GMT-0700 (Pacific Daylight Time)">18:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">(I don't understand the question)</td></tr>
  <tr class="msg" id="L267"><td class="ts-cell"><a class="ts" href="#L267" alt="Thu Apr 11 2024 11:12:58 GMT-0700 (Pacific Daylight Time)">18:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">man ASI is just the worst</td></tr>
  <tr class="msg" id="L268"><td class="ts-cell"><a class="ts" href="#L268" alt="Thu Apr 11 2024 11:12:59 GMT-0700 (Pacific Daylight Time)">18:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">like i think waldemar's ambiguity pops up only when the extractor pattern is a valid thing to be in a <code>(reference) =</code> usage</td></tr>
  <tr class="msg" id="L269"><td class="ts-cell"><a class="ts" href="#L269" alt="Thu Apr 11 2024 11:13:12 GMT-0700 (Pacific Daylight Time)">18:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">eg, <code>(x) = 3</code> and <code>(x.y) = 3</code> are currently valid, <code>(x, y) = 3</code> is not, so only the former have the conflict, afaict</td></tr>
  <tr class="msg" id="L270"><td class="ts-cell"><a class="ts" href="#L270" alt="Thu Apr 11 2024 11:13:34 GMT-0700 (Pacific Daylight Time)">18:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">and we couldn't even agree to <em>suggest people avoid it</em></td></tr>
  <tr class="msg" id="L271"><td class="ts-cell"><a class="ts" href="#L271" alt="Thu Apr 11 2024 11:14:01 GMT-0700 (Pacific Daylight Time)">18:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">we actually <em>did</em> agree to suggest people avoid it! and then took it back</td></tr>
  <tr class="msg" id="L272"><td class="ts-cell"><a class="ts" href="#L272" alt="Thu Apr 11 2024 11:14:26 GMT-0700 (Pacific Daylight Time)">18:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">fax</td></tr>
  <tr class="msg" id="L273"><td class="ts-cell"><a class="ts" href="#L273" alt="Thu Apr 11 2024 11:14:39 GMT-0700 (Pacific Daylight Time)">18:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">i guess our decision got a second-pass</td></tr>
  <tr class="msg" id="L274"><td class="ts-cell"><a class="ts" href="#L274" alt="Thu Apr 11 2024 11:14:41 GMT-0700 (Pacific Daylight Time)">18:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">I wish we required you to start your arrow functions with a <code>^</code> or something</td></tr>
  <tr class="msg" id="L275"><td class="ts-cell"><a class="ts" href="#L275" alt="Thu Apr 11 2024 11:15:00 GMT-0700 (Pacific Daylight Time)">18:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">but now I'm dreaming of other possible uses for prefix ^</td></tr>
  <tr class="msg" id="L276"><td class="ts-cell"><a class="ts" href="#L276" alt="Thu Apr 11 2024 11:15:12 GMT-0700 (Pacific Daylight Time)">18:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">(parenthesized assignment LHS's are gross also)</td></tr>
  <tr class="msg" id="L277"><td class="ts-cell"><a class="ts" href="#L277" alt="Thu Apr 11 2024 11:16:03 GMT-0700 (Pacific Daylight Time)">18:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><code>(x, y) = 3</code> technically doesn't but introducing a cover grammar which could distinguish those would be a nightmare</td></tr>
  <tr class="msg" id="L278"><td class="ts-cell"><a class="ts" href="#L278" alt="Thu Apr 11 2024 11:17:31 GMT-0700 (Pacific Daylight Time)">18:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">but as long as we say that extractors are only an identifier followed by a no-newline <code>(</code>, then i think the problem's solved?</td></tr>
  <tr class="msg" id="L279"><td class="ts-cell"><a class="ts" href="#L279" alt="Thu Apr 11 2024 11:17:53 GMT-0700 (Pacific Daylight Time)">18:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><p>As I understand it, Waldemar's concern is this:</p>
<pre><code>let a
(b) = {};
</code></pre>
</td></tr>
  <tr class="msg" id="L280"><td class="ts-cell"><a class="ts" href="#L280" alt="Thu Apr 11 2024 11:18:03 GMT-0700 (Pacific Daylight Time)">18:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@dminor:mozilla.org">dminor</span>&gt;</div></td><td class="msg-cell">Did Extractors advance to Stage 2? I wasn't clear if all blocking concerns were withdrawn.</td></tr>
  <tr class="msg" id="L281"><td class="ts-cell"><a class="ts" href="#L281" alt="Thu Apr 11 2024 11:18:21 GMT-0700 (Pacific Daylight Time)">18:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I don't believe it did, no.</td></tr>
  <tr class="msg" id="L282"><td class="ts-cell"><a class="ts" href="#L282" alt="Thu Apr 11 2024 11:18:25 GMT-0700 (Pacific Daylight Time)">18:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Did Extractors advance to Stage 2? I wasn't clear if all blocking concerns were withdrawn.</blockquote></mx-reply>Extractors did not advance to Stage 2. The sole blocking concern was the NLT issue.</td></tr>
  <tr class="msg" id="L283"><td class="ts-cell"><a class="ts" href="#L283" alt="Thu Apr 11 2024 11:18:28 GMT-0700 (Pacific Daylight Time)">18:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote>I wish we required you to start your arrow functions with a <code>^</code> or something</blockquote></mx-reply>backslash surely</td></tr>
  <tr class="msg" id="L284"><td class="ts-cell"><a class="ts" href="#L284" alt="Thu Apr 11 2024 11:18:33 GMT-0700 (Pacific Daylight Time)">18:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@dminor:mozilla.org">dminor</span>&gt;</div></td><td class="msg-cell">Ok, thank you.</td></tr>
  <tr class="msg" id="L285"><td class="ts-cell"><a class="ts" href="#L285" alt="Thu Apr 11 2024 11:18:46 GMT-0700 (Pacific Daylight Time)">18:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> backslash surely</blockquote></mx-reply>,\</td></tr>
  <tr class="msg" id="L286"><td class="ts-cell"><a class="ts" href="#L286" alt="Thu Apr 11 2024 11:18:47 GMT-0700 (Pacific Daylight Time)">18:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">It sounded like the cover grammar complexity might not be blocking, but the NLT issue is still a concern.</td></tr>
  <tr class="msg" id="L287"><td class="ts-cell"><a class="ts" href="#L287" alt="Thu Apr 11 2024 11:19:08 GMT-0700 (Pacific Daylight Time)">18:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> It sounded like the cover grammar complexity might not be blocking, but the NLT issue is still a concern.</blockquote></mx-reply>the cover grammar complexity will be investigated during stage 2, to resolve before stage 2.7</td></tr>
  <tr class="msg" id="L288"><td class="ts-cell"><a class="ts" href="#L288" alt="Thu Apr 11 2024 11:19:10 GMT-0700 (Pacific Daylight Time)">18:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> but as long as we say that extractors are only an identifier followed by a no-newline <code>(</code>, then i think the problem's solved?</blockquote></mx-reply>yeah, but <span class="nick-10">waldemar</span> didn't like that solution either</td></tr>
  <tr class="msg" id="L289"><td class="ts-cell"><a class="ts" href="#L289" alt="Thu Apr 11 2024 11:19:12 GMT-0700 (Pacific Daylight Time)">18:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> It sounded like the cover grammar complexity might not be blocking, but the NLT issue is still a concern.</blockquote></mx-reply>not blocking for stage 2. i need to do more work to figure out how blocking we consider it for 3</td></tr>
  <tr class="msg" id="L290"><td class="ts-cell"><a class="ts" href="#L290" alt="Thu Apr 11 2024 11:19:13 GMT-0700 (Pacific Daylight Time)">18:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">(I would be fine with it)</td></tr>
  <tr class="msg" id="L291"><td class="ts-cell"><a class="ts" href="#L291" alt="Thu Apr 11 2024 11:21:52 GMT-0700 (Pacific Daylight Time)">18:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@gibson042:matrix.org">Richard Gibson</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> (parenthesized assignment LHS's are gross also)</blockquote></mx-reply><code>++((Ⅰ))</code></td></tr>
  <tr class="msg" id="L292"><td class="ts-cell"><a class="ts" href="#L292" alt="Thu Apr 11 2024 11:22:03 GMT-0700 (Pacific Daylight Time)">18:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">We would need an NLT in binding patterns, which seems fine to me. The question is how easy is it to make the NLT conditional on whether we're parsing a <code>let</code>/<code>const</code>/<code>var</code> or not.</td></tr>
  <tr class="msg" id="L293"><td class="ts-cell"><a class="ts" href="#L293" alt="Thu Apr 11 2024 11:26:15 GMT-0700 (Pacific Daylight Time)">18:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">the first speaker (currently being referred to as JRA in the notes) is not assigned this abbreviation in <a href="https://github.com/tc39/notes/blob/main/delegates.txt">https://github.com/tc39/notes/blob/main/delegates.txt</a></td></tr>
  <tr class="msg" id="L294"><td class="ts-cell"><a class="ts" href="#L294" alt="Thu Apr 11 2024 11:26:29 GMT-0700 (Pacific Daylight Time)">18:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">could someone reach out to them to create a PR?</td></tr>
  <tr class="msg" id="L295"><td class="ts-cell"><a class="ts" href="#L295" alt="Thu Apr 11 2024 11:28:09 GMT-0700 (Pacific Daylight Time)">18:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">i did already <a href="https://github.com/tc39/notes/pull/318">https://github.com/tc39/notes/pull/318</a></td></tr>
  <tr class="msg" id="L296"><td class="ts-cell"><a class="ts" href="#L296" alt="Thu Apr 11 2024 11:28:11 GMT-0700 (Pacific Daylight Time)">18:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@waldemarh:matrix.org">waldemar</span>&gt;</div></td><td class="msg-cell">I'm having trouble understanding the syntax of the slides</td></tr>
  <tr class="msg" id="L297"><td class="ts-cell"><a class="ts" href="#L297" alt="Thu Apr 11 2024 11:28:44 GMT-0700 (Pacific Daylight Time)">18:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">oh okay thanks <a href="https://matrix.to/#/%40shuyuguo%3Amatrix.org">@shu</a></td></tr>
  <tr class="msg" id="L298"><td class="ts-cell"><a class="ts" href="#L298" alt="Thu Apr 11 2024 11:29:01 GMT-0700 (Pacific Daylight Time)">18:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@waldemarh:matrix.org">waldemar</span>&gt;</div></td><td class="msg-cell">What's ({{counter.parity}})?</td></tr>
  <tr class="msg" id="L299"><td class="ts-cell"><a class="ts" href="#L299" alt="Thu Apr 11 2024 11:29:47 GMT-0700 (Pacific Daylight Time)">18:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">literal parens, with a rendered JS value inside them</td></tr>
  <tr class="msg" id="L300"><td class="ts-cell"><a class="ts" href="#L300" alt="Thu Apr 11 2024 11:29:49 GMT-0700 (Pacific Daylight Time)">18:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell"><a href="https://matrix.to/#/%40shuyuguo%3Amatrix.org">@shu</a> oh, it hasn't been merged because CI is failing due to you not adding them in the correct order</td></tr>
  <tr class="msg" id="L301"><td class="ts-cell"><a class="ts" href="#L301" alt="Thu Apr 11 2024 11:29:50 GMT-0700 (Pacific Daylight Time)">18:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">It's vue's templating mechanism.</td></tr>
  <tr class="msg" id="L302"><td class="ts-cell"><a class="ts" href="#L302" alt="Thu Apr 11 2024 11:30:01 GMT-0700 (Pacific Daylight Time)">18:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <a href="https://matrix.to/#/%40shuyuguo%3Amatrix.org">@shu</a> oh, it hasn't been merged because CI is failing due to you not adding them in the correct order</blockquote></mx-reply>oh</td></tr>
  <tr class="msg" id="L303"><td class="ts-cell"><a class="ts" href="#L303" alt="Thu Apr 11 2024 11:31:09 GMT-0700 (Pacific Daylight Time)">18:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">someone more inclined can fix</td></tr>
  <tr class="msg" id="L304"><td class="ts-cell"><a class="ts" href="#L304" alt="Thu Apr 11 2024 11:34:09 GMT-0700 (Pacific Daylight Time)">18:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">i'm confused, isn't the parity supposed to autoupdate with the counter?</td></tr>
  <tr class="msg" id="L305"><td class="ts-cell"><a class="ts" href="#L305" alt="Thu Apr 11 2024 11:34:14 GMT-0700 (Pacific Daylight Time)">18:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">Preact does recreate the vdom, but at least we didn't bother recalculating parity </td></tr>
  <tr class="msg" id="L306"><td class="ts-cell"><a class="ts" href="#L306" alt="Thu Apr 11 2024 11:34:29 GMT-0700 (Pacific Daylight Time)">18:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">but 2 isn't odd. the parity depends on the counter.</td></tr>
  <tr class="msg" id="L307"><td class="ts-cell"><a class="ts" href="#L307" alt="Thu Apr 11 2024 11:34:32 GMT-0700 (Pacific Daylight Time)">18:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">and Preact may be able to save more work when you have nested components--Preact only has to re-render at the component level</td></tr>
  <tr class="msg" id="L308"><td class="ts-cell"><a class="ts" href="#L308" alt="Thu Apr 11 2024 11:35:10 GMT-0700 (Pacific Daylight Time)">18:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> i'm confused, isn't the parity supposed to autoupdate with the counter?</blockquote></mx-reply>in this case, because it incremented by 2, the parity bit stayed the same, so we didn't have to redo the expensive calculation to change 1/0 into odd/even</td></tr>
  <tr class="msg" id="L309"><td class="ts-cell"><a class="ts" href="#L309" alt="Thu Apr 11 2024 11:35:17 GMT-0700 (Pacific Daylight Time)">18:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> but 2 isn't odd</blockquote></mx-reply>1 + 2 is</td></tr>
  <tr class="msg" id="L310"><td class="ts-cell"><a class="ts" href="#L310" alt="Thu Apr 11 2024 11:35:23 GMT-0700 (Pacific Daylight Time)">18:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell"><span class="nick-6">ljharb</span>: It's was X+2 so parity shouldn't change</td></tr>
  <tr class="msg" id="L311"><td class="ts-cell"><a class="ts" href="#L311" alt="Thu Apr 11 2024 11:35:25 GMT-0700 (Pacific Daylight Time)">18:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">ahhh gotcha</td></tr>
  <tr class="msg" id="L312"><td class="ts-cell"><a class="ts" href="#L312" alt="Thu Apr 11 2024 11:35:42 GMT-0700 (Pacific Daylight Time)">18:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">thanks</td></tr>
  <tr class="msg" id="L313"><td class="ts-cell"><a class="ts" href="#L313" alt="Thu Apr 11 2024 11:35:58 GMT-0700 (Pacific Daylight Time)">18:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">so we memoize things in the data dependency graph so that we have to do minimal work to recompute based on changes</td></tr>
  <tr class="msg" id="L314"><td class="ts-cell"><a class="ts" href="#L314" alt="Thu Apr 11 2024 11:36:12 GMT-0700 (Pacific Daylight Time)">18:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">I'm confused is this some mechanism where at closure time we detect the captured variable is a Signal?</td></tr>
  <tr class="msg" id="L315"><td class="ts-cell"><a class="ts" href="#L315" alt="Thu Apr 11 2024 11:36:59 GMT-0700 (Pacific Daylight Time)">18:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I'm confused is this some mechanism where at closure time we detect the captured variable is a Signal?</blockquote></mx-reply>there's a hidden global variable that tracks all the signals read within the execution of the computed</td></tr>
  <tr class="msg" id="L316"><td class="ts-cell"><a class="ts" href="#L316" alt="Thu Apr 11 2024 11:37:10 GMT-0700 (Pacific Daylight Time)">18:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">I don't understand how we would know that <code>parity</code> doesn't need to be updated in general</td></tr>
  <tr class="msg" id="L317"><td class="ts-cell"><a class="ts" href="#L317" alt="Thu Apr 11 2024 11:37:34 GMT-0700 (Pacific Daylight Time)">18:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">what about signals that aren't unconditionally read in the computation?</td></tr>
  <tr class="msg" id="L318"><td class="ts-cell"><a class="ts" href="#L318" alt="Thu Apr 11 2024 11:38:05 GMT-0700 (Pacific Daylight Time)">18:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I expect the execution of <code>Computed</code>'s callback could record any <code>get</code> for a nested signal</td></tr>
  <tr class="msg" id="L319"><td class="ts-cell"><a class="ts" href="#L319" alt="Thu Apr 11 2024 11:38:33 GMT-0700 (Pacific Daylight Time)">18:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> what about signals that aren't unconditionally read in the computation?</blockquote></mx-reply>Their changes don't matter until the condition that made them unread changes?</td></tr>
  <tr class="msg" id="L320"><td class="ts-cell"><a class="ts" href="#L320" alt="Thu Apr 11 2024 11:38:46 GMT-0700 (Pacific Daylight Time)">18:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">this sounds like why react hooks force you via linter to always unconditionally run all hooks, which is super annoying and unergonomic</td></tr>
  <tr class="msg" id="L321"><td class="ts-cell"><a class="ts" href="#L321" alt="Thu Apr 11 2024 11:38:59 GMT-0700 (Pacific Daylight Time)">18:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Their changes don't matter until the condition that made them unread changes?</blockquote></mx-reply>right but you have to rerun the computation, then, to know if it's updated</td></tr>
  <tr class="msg" id="L322"><td class="ts-cell"><a class="ts" href="#L322" alt="Thu Apr 11 2024 11:39:07 GMT-0700 (Pacific Daylight Time)">18:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">which means doing the expensive thing</td></tr>
  <tr class="msg" id="L323"><td class="ts-cell"><a class="ts" href="#L323" alt="Thu Apr 11 2024 11:39:33 GMT-0700 (Pacific Daylight Time)">18:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">What if the condition isn't tracked by a Signal?</td></tr>
  <tr class="msg" id="L324"><td class="ts-cell"><a class="ts" href="#L324" alt="Thu Apr 11 2024 11:39:43 GMT-0700 (Pacific Daylight Time)">18:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">Is that a bug?</td></tr>
  <tr class="msg" id="L325"><td class="ts-cell"><a class="ts" href="#L325" alt="Thu Apr 11 2024 11:39:43 GMT-0700 (Pacific Daylight Time)">18:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I don't understand how we would know that <code>parity</code> doesn't need to be updated in general</blockquote></mx-reply>my understanding from reading the readme was that the dependencies are dynamically re-computed per computation (per "pull")</td></tr>
  <tr class="msg" id="L326"><td class="ts-cell"><a class="ts" href="#L326" alt="Thu Apr 11 2024 11:39:43 GMT-0700 (Pacific Daylight Time)">18:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">No, you either record what signals were used and query whether they've changed, or when they change they notify any computations that depend on them.</td></tr>
  <tr class="msg" id="L327"><td class="ts-cell"><a class="ts" href="#L327" alt="Thu Apr 11 2024 11:39:55 GMT-0700 (Pacific Daylight Time)">18:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">oh dan is saying that right now</td></tr>
  <tr class="msg" id="L328"><td class="ts-cell"><a class="ts" href="#L328" alt="Thu Apr 11 2024 11:40:14 GMT-0700 (Pacific Daylight Time)">18:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">if your signal depends on values which can change which are not themselves signals, it's not going to be able to correctly track updates</td></tr>
  <tr class="msg" id="L329"><td class="ts-cell"><a class="ts" href="#L329" alt="Thu Apr 11 2024 11:40:23 GMT-0700 (Pacific Daylight Time)">18:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">but i mean... don't do that</td></tr>
  <tr class="msg" id="L330"><td class="ts-cell"><a class="ts" href="#L330" alt="Thu Apr 11 2024 11:40:23 GMT-0700 (Pacific Daylight Time)">18:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">ok so it doesn't prevent an expensive computation, it prevents <em>dependent</em> expensive ones?</td></tr>
  <tr class="msg" id="L331"><td class="ts-cell"><a class="ts" href="#L331" alt="Thu Apr 11 2024 11:41:19 GMT-0700 (Pacific Daylight Time)">18:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@aardvark179:matrix.org">Duncan MacGregor</span>&gt;</div></td><td class="msg-cell">I'm trying to think how this would work if multiple realms are involved… Do they all need to share the hidden global?</td></tr>
  <tr class="msg" id="L332"><td class="ts-cell"><a class="ts" href="#L332" alt="Thu Apr 11 2024 11:42:12 GMT-0700 (Pacific Daylight Time)">18:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">i'd assume it's realm-specific, since we probably wouldn't want another cross-realm registry</td></tr>
  <tr class="msg" id="L333"><td class="ts-cell"><a class="ts" href="#L333" alt="Thu Apr 11 2024 11:44:01 GMT-0700 (Pacific Daylight Time)">18:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell">I thought we didn't want per-realm state :D</td></tr>
  <tr class="msg" id="L334"><td class="ts-cell"><a class="ts" href="#L334" alt="Thu Apr 11 2024 11:44:40 GMT-0700 (Pacific Daylight Time)">18:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mhofman:matrix.org">Mathieu Hofman</span>&gt;</div></td><td class="msg-cell">Observable global mutable state is definitely a concern we want to discuss with the champions.</td></tr>
  <tr class="msg" id="L335"><td class="ts-cell"><a class="ts" href="#L335" alt="Thu Apr 11 2024 11:45:48 GMT-0700 (Pacific Daylight Time)">18:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mhofman:matrix.org">Mathieu Hofman</span>&gt;</div></td><td class="msg-cell">it's fine to have internal global state, but it's not to make it observable to user code. It's a fine line that AsyncContext took a lot of pain to prove and satisfy</td></tr>
  <tr class="msg" id="L336"><td class="ts-cell"><a class="ts" href="#L336" alt="Thu Apr 11 2024 11:46:28 GMT-0700 (Pacific Daylight Time)">18:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">i mean, this would effectively just be closed-over variables</td></tr>
  <tr class="msg" id="L337"><td class="ts-cell"><a class="ts" href="#L337" alt="Thu Apr 11 2024 11:46:36 GMT-0700 (Pacific Daylight Time)">18:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">it's not an object you can mutate</td></tr>
  <tr class="msg" id="L338"><td class="ts-cell"><a class="ts" href="#L338" alt="Thu Apr 11 2024 11:46:58 GMT-0700 (Pacific Daylight Time)">18:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mhofman:matrix.org">Mathieu Hofman</span>&gt;</div></td><td class="msg-cell">I'm not sufficiently familiar with signals usages, but I'm wondering if there would be ways to implement this auto tracking without making this internal contextual state observable</td></tr>
  <tr class="msg" id="L339"><td class="ts-cell"><a class="ts" href="#L339" alt="Thu Apr 11 2024 11:50:08 GMT-0700 (Pacific Daylight Time)">18:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@aardvark179:matrix.org">Duncan MacGregor</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I'm not sufficiently familiar with signals usages, but I'm wondering if there would be ways to implement this auto tracking without making this internal contextual state observable</blockquote></mx-reply>Yeah. It feels like the graph should have GC roots somewhere and shouldn't really need a separate global variable… but I think I'd need some time and paper to work that out.</td></tr>
  <tr class="msg" id="L340"><td class="ts-cell"><a class="ts" href="#L340" alt="Thu Apr 11 2024 11:50:18 GMT-0700 (Pacific Daylight Time)">18:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Seems like this could be done with weakly held pub/sub events rather than a global variable.</td></tr>
  <tr class="msg" id="L341"><td class="ts-cell"><a class="ts" href="#L341" alt="Thu Apr 11 2024 11:51:06 GMT-0700 (Pacific Daylight Time)">18:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@anthonybullard:matrix.org">Anthony Bullard</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Seems like this could be done with weakly held pub/sub events rather than a global variable.</blockquote></mx-reply>This is, if memory serves, closer to userland implementations I’ve seen</td></tr>
  <tr class="msg" id="L342"><td class="ts-cell"><a class="ts" href="#L342" alt="Thu Apr 11 2024 11:51:07 GMT-0700 (Pacific Daylight Time)">18:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell">the benefit is that the code doesn't need to know that it's being tracked</td></tr>
  <tr class="msg" id="L343"><td class="ts-cell"><a class="ts" href="#L343" alt="Thu Apr 11 2024 11:51:22 GMT-0700 (Pacific Daylight Time)">18:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell">everything adding event observers manually is a lot of work</td></tr>
  <tr class="msg" id="L344"><td class="ts-cell"><a class="ts" href="#L344" alt="Thu Apr 11 2024 11:51:46 GMT-0700 (Pacific Daylight Time)">18:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell">with signals, I can call functions and they don't need to know that the things they call to get data are getters that add to the tracking</td></tr>
  <tr class="msg" id="L345"><td class="ts-cell"><a class="ts" href="#L345" alt="Thu Apr 11 2024 11:52:31 GMT-0700 (Pacific Daylight Time)">18:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">like <code>Promise</code>s</td></tr>
  <tr class="msg" id="L346"><td class="ts-cell"><a class="ts" href="#L346" alt="Thu Apr 11 2024 11:52:32 GMT-0700 (Pacific Daylight Time)">18:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell">In FunctionalReactiveProgramming there are events and cells.
Signals are much more like cells, than events</td></tr>
  <tr class="msg" id="L347"><td class="ts-cell"><a class="ts" href="#L347" alt="Thu Apr 11 2024 11:52:36 GMT-0700 (Pacific Daylight Time)">18:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">the data does not need to know you're looking at it</td></tr>
  <tr class="msg" id="L348"><td class="ts-cell"><a class="ts" href="#L348" alt="Thu Apr 11 2024 11:52:41 GMT-0700 (Pacific Daylight Time)">18:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mhofman:matrix.org">Mathieu Hofman</span>&gt;</div></td><td class="msg-cell">I understand the motivation, but this is effectively dynamic scoping, and I'm trying to understand if we can put it back within the limits of fluid scoping that AsyncContext offers</td></tr>
  <tr class="msg" id="L349"><td class="ts-cell"><a class="ts" href="#L349" alt="Thu Apr 11 2024 11:56:46 GMT-0700 (Pacific Daylight Time)">18:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@anthonybullard:matrix.org">Anthony Bullard</span>&gt;</div></td><td class="msg-cell">There needs to be a tracking context/scope, and a way to access the underlying value without tracking.</td></tr>
  <tr class="msg" id="L350"><td class="ts-cell"><a class="ts" href="#L350" alt="Thu Apr 11 2024 11:56:49 GMT-0700 (Pacific Daylight Time)">18:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">this sounds like perfect incubation call material</td></tr>
  <tr class="msg" id="L351"><td class="ts-cell"><a class="ts" href="#L351" alt="Thu Apr 11 2024 11:57:14 GMT-0700 (Pacific Daylight Time)">18:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">Could there be a registry for each batch of signals that's not an hidden global value? Not sure if that would be possible or cause other problems?</td></tr>
  <tr class="msg" id="L352"><td class="ts-cell"><a class="ts" href="#L352" alt="Thu Apr 11 2024 11:57:36 GMT-0700 (Pacific Daylight Time)">18:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> this sounds like perfect incubation call material</blockquote></mx-reply>they already have other discussions going</td></tr>
  <tr class="msg" id="L353"><td class="ts-cell"><a class="ts" href="#L353" alt="Thu Apr 11 2024 11:57:41 GMT-0700 (Pacific Daylight Time)">18:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">I don't think an incubation call would help</td></tr>
  <tr class="msg" id="L354"><td class="ts-cell"><a class="ts" href="#L354" alt="Thu Apr 11 2024 11:57:46 GMT-0700 (Pacific Daylight Time)">18:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">signals sounds like it has <em>way</em> bigger scope than incubation calls</td></tr>
  <tr class="msg" id="L355"><td class="ts-cell"><a class="ts" href="#L355" alt="Thu Apr 11 2024 11:57:54 GMT-0700 (Pacific Daylight Time)">18:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">if you create the computed by providing all the signals it cares about explicitly, then you wouldn't need any global state, i think?</td></tr>
  <tr class="msg" id="L356"><td class="ts-cell"><a class="ts" href="#L356" alt="Thu Apr 11 2024 11:57:55 GMT-0700 (Pacific Daylight Time)">18:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">incubation calls are time set-aside for one-off smaller things that don't have regular side discussions</td></tr>
  <tr class="msg" id="L357"><td class="ts-cell"><a class="ts" href="#L357" alt="Thu Apr 11 2024 11:57:57 GMT-0700 (Pacific Daylight Time)">18:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">This is large enough they need a dedicated group call</td></tr>
  <tr class="msg" id="L358"><td class="ts-cell"><a class="ts" href="#L358" alt="Thu Apr 11 2024 11:58:02 GMT-0700 (Pacific Daylight Time)">18:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@aardvark179:matrix.org">Duncan MacGregor</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Could there be a registry for each batch of signals that's not an hidden global value? Not sure if that would be possible or cause other problems?</blockquote></mx-reply>Couldn't that be on the signal itself?</td></tr>
  <tr class="msg" id="L359"><td class="ts-cell"><a class="ts" href="#L359" alt="Thu Apr 11 2024 11:58:06 GMT-0700 (Pacific Daylight Time)">18:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">like <code>Signal.Computed(fn, signals)</code></td></tr>
  <tr class="msg" id="L360"><td class="ts-cell"><a class="ts" href="#L360" alt="Thu Apr 11 2024 11:58:18 GMT-0700 (Pacific Daylight Time)">18:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote>This is large enough they need a dedicated group call</blockquote></mx-reply>sure, even better!</td></tr>
  <tr class="msg" id="L361"><td class="ts-cell"><a class="ts" href="#L361" alt="Thu Apr 11 2024 11:58:22 GMT-0700 (Pacific Daylight Time)">18:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">that would be static dependencies, not dynamic</td></tr>
  <tr class="msg" id="L362"><td class="ts-cell"><a class="ts" href="#L362" alt="Thu Apr 11 2024 11:58:28 GMT-0700 (Pacific Daylight Time)">18:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">that's a pretty big reduction in expressivity</td></tr>
  <tr class="msg" id="L363"><td class="ts-cell"><a class="ts" href="#L363" alt="Thu Apr 11 2024 11:58:36 GMT-0700 (Pacific Daylight Time)">18:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">(not arguing for one way or another, but it's pretty different)</td></tr>
  <tr class="msg" id="L364"><td class="ts-cell"><a class="ts" href="#L364" alt="Thu Apr 11 2024 11:58:38 GMT-0700 (Pacific Daylight Time)">18:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">yeah that API would not be worth having</td></tr>
  <tr class="msg" id="L365"><td class="ts-cell"><a class="ts" href="#L365" alt="Thu Apr 11 2024 11:58:39 GMT-0700 (Pacific Daylight Time)">18:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">then I think we should just go for stage 1 and provide all of this feedback in such a call</td></tr>
  <tr class="msg" id="L366"><td class="ts-cell"><a class="ts" href="#L366" alt="Thu Apr 11 2024 11:59:09 GMT-0700 (Pacific Daylight Time)">18:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">right, i agree with that too</td></tr>
  <tr class="msg" id="L367"><td class="ts-cell"><a class="ts" href="#L367" alt="Thu Apr 11 2024 11:59:20 GMT-0700 (Pacific Daylight Time)">18:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@danielrosenwasser:matrix.org">danielrosenwasser</span>&gt;</div></td><td class="msg-cell">Yes, these topics seem fair to discuss after stage 1.</td></tr>
  <tr class="msg" id="L368"><td class="ts-cell"><a class="ts" href="#L368" alt="Thu Apr 11 2024 11:59:38 GMT-0700 (Pacific Daylight Time)">18:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@anthonybullard:matrix.org">Anthony Bullard</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> if you create the computed by providing all the signals it cares about explicitly, then you wouldn't need any global state, i think?</blockquote></mx-reply>This ruins a good amount of the ergonomics of this feature</td></tr>
  <tr class="msg" id="L369"><td class="ts-cell"><a class="ts" href="#L369" alt="Thu Apr 11 2024 11:59:39 GMT-0700 (Pacific Daylight Time)">18:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@aardvark179:matrix.org">Duncan MacGregor</span>&gt;</div></td><td class="msg-cell">Where did the term <code>Signal</code> itself come from? It feels like these are Signallers rather than Signals.</td></tr>
  <tr class="msg" id="L370"><td class="ts-cell"><a class="ts" href="#L370" alt="Thu Apr 11 2024 11:59:49 GMT-0700 (Pacific Daylight Time)">18:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> This ruins a good amount of the ergonomics of this feature</blockquote></mx-reply>it certainly does</td></tr>
  <tr class="msg" id="L371"><td class="ts-cell"><a class="ts" href="#L371" alt="Thu Apr 11 2024 11:59:55 GMT-0700 (Pacific Daylight Time)">18:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">I’m confused by the global state discussion, there shouldn’t be any.</td></tr>
  <tr class="msg" id="L372"><td class="ts-cell"><a class="ts" href="#L372" alt="Thu Apr 11 2024 12:00:10 GMT-0700 (Pacific Daylight Time)">19:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">It’s all on the Signal</td></tr>
  <tr class="msg" id="L373"><td class="ts-cell"><a class="ts" href="#L373" alt="Thu Apr 11 2024 12:00:19 GMT-0700 (Pacific Daylight Time)">19:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">While I don't consider it a Stage 1 blocking concern, my concern seemed wide reaching enough that it might be a concern for others who had not previously considered the implications.</td></tr>
  <tr class="msg" id="L374"><td class="ts-cell"><a class="ts" href="#L374" alt="Thu Apr 11 2024 12:00:26 GMT-0700 (Pacific Daylight Time)">19:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">but if the ergonomics are only achievable with weird unenforceable caveats like "you must evaluate all signals unconditionally, in the callback" - like react has for hooks, i'm not sure it's worth striving for them (i dont think that's the case, to be clear)</td></tr>
  <tr class="msg" id="L375"><td class="ts-cell"><a class="ts" href="#L375" alt="Thu Apr 11 2024 12:00:55 GMT-0700 (Pacific Daylight Time)">19:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mhofman:matrix.org">Mathieu Hofman</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> It’s all on the Signal</blockquote></mx-reply>From what I understand it's used for auto-tracking and preventing notify footguns</td></tr>
  <tr class="msg" id="L376"><td class="ts-cell"><a class="ts" href="#L376" alt="Thu Apr 11 2024 12:01:00 GMT-0700 (Pacific Daylight Time)">19:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote>but if the ergonomics are only achievable with weird unenforceable caveats like "you must evaluate all signals unconditionally, in the callback" - like react has for hooks, i'm not sure it's worth striving for them (i dont think that's the case, to be clear)</blockquote></mx-reply>You don’t need to</td></tr>
  <tr class="msg" id="L377"><td class="ts-cell"><a class="ts" href="#L377" alt="Thu Apr 11 2024 12:01:12 GMT-0700 (Pacific Daylight Time)">19:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@anthonybullard:matrix.org">Anthony Bullard</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I’m confused by the global state discussion, there shouldn’t be any.</blockquote></mx-reply>Usually there is a tracking context that coordinates updates of a set of signals</td></tr>
  <tr class="msg" id="L378"><td class="ts-cell"><a class="ts" href="#L378" alt="Thu Apr 11 2024 12:01:20 GMT-0700 (Pacific Daylight Time)">19:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> but if the ergonomics are only achievable with weird unenforceable caveats like "you must evaluate all signals unconditionally, in the callback" - like react has for hooks, i'm not sure it's worth striving for them (i dont think that's the case, to be clear)</blockquote></mx-reply>you don't have to evaluate all signals unconditionally</td></tr>
  <tr class="msg" id="L379"><td class="ts-cell"><a class="ts" href="#L379" alt="Thu Apr 11 2024 12:01:23 GMT-0700 (Pacific Daylight Time)">19:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote>From what I understand it's used for auto-tracking and preventing notify footguns</blockquote></mx-reply>But the state is stored on the Signal itself</td></tr>
  <tr class="msg" id="L380"><td class="ts-cell"><a class="ts" href="#L380" alt="Thu Apr 11 2024 12:01:37 GMT-0700 (Pacific Daylight Time)">19:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">i'd love to hear how a computed callback of <code>one.get() ? two.get() : three.get()</code> can deterministically track all three signals</td></tr>
  <tr class="msg" id="L381"><td class="ts-cell"><a class="ts" href="#L381" alt="Thu Apr 11 2024 12:01:51 GMT-0700 (Pacific Daylight Time)">19:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell">As Dan said, it's the last read that is tracked</td></tr>
  <tr class="msg" id="L382"><td class="ts-cell"><a class="ts" href="#L382" alt="Thu Apr 11 2024 12:01:56 GMT-0700 (Pacific Daylight Time)">19:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> i'd love to hear how a computed callback of <code>one.get() ? two.get() : three.get()</code> can deterministically track all three signals</blockquote></mx-reply>Why would it need to?</td></tr>
  <tr class="msg" id="L383"><td class="ts-cell"><a class="ts" href="#L383" alt="Thu Apr 11 2024 12:01:58 GMT-0700 (Pacific Daylight Time)">19:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell">the last set of reads</td></tr>
  <tr class="msg" id="L384"><td class="ts-cell"><a class="ts" href="#L384" alt="Thu Apr 11 2024 12:02:02 GMT-0700 (Pacific Daylight Time)">19:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@anthonybullard:matrix.org">Anthony Bullard</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> i'd love to hear how a computed callback of <code>one.get() ? two.get() : three.get()</code> can deterministically track all three signals</blockquote></mx-reply>One of those would not be tracked until called</td></tr>
  <tr class="msg" id="L385"><td class="ts-cell"><a class="ts" href="#L385" alt="Thu Apr 11 2024 12:02:05 GMT-0700 (Pacific Daylight Time)">19:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote>i'd love to hear how a computed callback of <code>one.get() ? two.get() : three.get()</code> can deterministically track all three signals</blockquote></mx-reply>You only need to track 2 of the 3, the third is irrelevant.</td></tr>
  <tr class="msg" id="L386"><td class="ts-cell"><a class="ts" href="#L386" alt="Thu Apr 11 2024 12:02:11 GMT-0700 (Pacific Daylight Time)">19:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">It only needs to track <code>one.get()</code> and whichever branch was evaluated.</td></tr>
  <tr class="msg" id="L387"><td class="ts-cell"><a class="ts" href="#L387" alt="Thu Apr 11 2024 12:02:19 GMT-0700 (Pacific Daylight Time)">19:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">hm</td></tr>
  <tr class="msg" id="L388"><td class="ts-cell"><a class="ts" href="#L388" alt="Thu Apr 11 2024 12:02:21 GMT-0700 (Pacific Daylight Time)">19:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">if <code>three.get()</code> changes it doesn't affect the computation.</td></tr>
  <tr class="msg" id="L389"><td class="ts-cell"><a class="ts" href="#L389" alt="Thu Apr 11 2024 12:02:34 GMT-0700 (Pacific Daylight Time)">19:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">If <code>one.get()</code> changes, it evaluates the other branch.</td></tr>
  <tr class="msg" id="L390"><td class="ts-cell"><a class="ts" href="#L390" alt="Thu Apr 11 2024 12:02:49 GMT-0700 (Pacific Daylight Time)">19:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mhofman:matrix.org">Mathieu Hofman</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> But the state is stored on the Signal itself</blockquote></mx-reply>but it's ambient during signal computation, which is currently exposed to any user code running during that time</td></tr>
  <tr class="msg" id="L391"><td class="ts-cell"><a class="ts" href="#L391" alt="Thu Apr 11 2024 12:02:50 GMT-0700 (Pacific Daylight Time)">19:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">ok, so the list of tracked signals potentially shifts over time?</td></tr>
  <tr class="msg" id="L392"><td class="ts-cell"><a class="ts" href="#L392" alt="Thu Apr 11 2024 12:02:56 GMT-0700 (Pacific Daylight Time)">19:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">correct</td></tr>
  <tr class="msg" id="L393"><td class="ts-cell"><a class="ts" href="#L393" alt="Thu Apr 11 2024 12:03:02 GMT-0700 (Pacific Daylight Time)">19:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">each time it's re-evaluated</td></tr>
  <tr class="msg" id="L394"><td class="ts-cell"><a class="ts" href="#L394" alt="Thu Apr 11 2024 12:03:02 GMT-0700 (Pacific Daylight Time)">19:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@anthonybullard:matrix.org">Anthony Bullard</span>&gt;</div></td><td class="msg-cell"><span class="nick-6">ljharb</span>: yes</td></tr>
  <tr class="msg" id="L395"><td class="ts-cell"><a class="ts" href="#L395" alt="Thu Apr 11 2024 12:03:02 GMT-0700 (Pacific Daylight Time)">19:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> ok, so the list of tracked signals potentially shifts over time?</blockquote></mx-reply>It would have to</td></tr>
  <tr class="msg" id="L396"><td class="ts-cell"><a class="ts" href="#L396" alt="Thu Apr 11 2024 12:03:21 GMT-0700 (Pacific Daylight Time)">19:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@anthonybullard:matrix.org">Anthony Bullard</span>&gt;</div></td><td class="msg-cell">Which is why there is usually a hierarchy of tracking contexts</td></tr>
  <tr class="msg" id="L397"><td class="ts-cell"><a class="ts" href="#L397" alt="Thu Apr 11 2024 12:03:43 GMT-0700 (Pacific Daylight Time)">19:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@anthonybullard:matrix.org">Anthony Bullard</span>&gt;</div></td><td class="msg-cell">That do the actually coordination and scheduling</td></tr>
  <tr class="msg" id="L398"><td class="ts-cell"><a class="ts" href="#L398" alt="Thu Apr 11 2024 12:03:47 GMT-0700 (Pacific Daylight Time)">19:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> ok, so the list of tracked signals potentially shifts over time?</blockquote></mx-reply><p>exactly</p>
<pre><code>if (false) {
  readSignal();
}
</code></pre>
<p>tracks nothing</p>
</td></tr>
  <tr class="msg" id="L399"><td class="ts-cell"><a class="ts" href="#L399" alt="Thu Apr 11 2024 12:03:49 GMT-0700 (Pacific Daylight Time)">19:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote>but it's ambient during signal computation, which is currently exposed to any user code running during that time</blockquote></mx-reply>It’s the same as an <code data-md="`"><a href="http://AsyncContxt.Variable.run">AsyncContxt.Variable.run</a>()</code> internally in a <code data-md="`">computed()</code> call</td></tr>
  <tr class="msg" id="L400"><td class="ts-cell"><a class="ts" href="#L400" alt="Thu Apr 11 2024 12:03:54 GMT-0700 (Pacific Daylight Time)">19:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@softwarechris:matrix.org">Chris de Almeida</span>&gt;</div></td><td class="msg-cell">it appears we lost the transcriptionist</td></tr>
  <tr class="msg" id="L401"><td class="ts-cell"><a class="ts" href="#L401" alt="Thu Apr 11 2024 12:04:00 GMT-0700 (Pacific Daylight Time)">19:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">My concern is how a <code>Computed</code> interacts with a weakly held <code>Signal</code>. Does it then strongly hold the <code>Signal</code>? that seems leaky.</td></tr>
  <tr class="msg" id="L402"><td class="ts-cell"><a class="ts" href="#L402" alt="Thu Apr 11 2024 12:04:20 GMT-0700 (Pacific Daylight Time)">19:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mhofman:matrix.org">Mathieu Hofman</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> It’s the same as an <code data-md="`"><a href="http://AsyncContxt.Variable.run">AsyncContxt.Variable.run</a>()</code> internally in a <code data-md="`">computed()</code> call</blockquote></mx-reply>Not quite, there are APIs that effectively expose the <code>acVar.get()</code> value</td></tr>
  <tr class="msg" id="L403"><td class="ts-cell"><a class="ts" href="#L403" alt="Thu Apr 11 2024 12:04:29 GMT-0700 (Pacific Daylight Time)">19:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">wouldn't the <code>Computed</code> strongly hold the signal in its closure?</td></tr>
  <tr class="msg" id="L404"><td class="ts-cell"><a class="ts" href="#L404" alt="Thu Apr 11 2024 12:04:46 GMT-0700 (Pacific Daylight Time)">19:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> wouldn't the <code>Computed</code> strongly hold the signal in its closure?</blockquote></mx-reply>Not if it's closure is <code>() =&gt; weakRef.get()?.get()</code></td></tr>
  <tr class="msg" id="L405"><td class="ts-cell"><a class="ts" href="#L405" alt="Thu Apr 11 2024 12:04:52 GMT-0700 (Pacific Daylight Time)">19:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@anthonybullard:matrix.org">Anthony Bullard</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> My concern is how a <code>Computed</code> interacts with a weakly held <code>Signal</code>. Does it then strongly hold the <code>Signal</code>? that seems leaky.</blockquote></mx-reply>Isn’t putting a weakly held anything in a closure potentially leaky?</td></tr>
  <tr class="msg" id="L406"><td class="ts-cell"><a class="ts" href="#L406" alt="Thu Apr 11 2024 12:05:05 GMT-0700 (Pacific Daylight Time)">19:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">oh, yeah, I would hope that this case wouldn't leak</td></tr>
  <tr class="msg" id="L407"><td class="ts-cell"><a class="ts" href="#L407" alt="Thu Apr 11 2024 12:05:13 GMT-0700 (Pacific Daylight Time)">19:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Not if you're holding the weakRef.</td></tr>
  <tr class="msg" id="L408"><td class="ts-cell"><a class="ts" href="#L408" alt="Thu Apr 11 2024 12:05:31 GMT-0700 (Pacific Daylight Time)">19:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote>Not quite, there are APIs that effectively expose the <code>acVar.get()</code> value</blockquote></mx-reply>Internally the <code data-md="`">Signal</code> can access the ambient Computed context’s var, but that’s not exposed?</td></tr>
  <tr class="msg" id="L409"><td class="ts-cell"><a class="ts" href="#L409" alt="Thu Apr 11 2024 12:05:48 GMT-0700 (Pacific Daylight Time)">19:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">though, a <code>weakRef</code> is kind of a scary thing to use in a signal - it's a thing whose state can change which is not being read via a Signal</td></tr>
  <tr class="msg" id="L410"><td class="ts-cell"><a class="ts" href="#L410" alt="Thu Apr 11 2024 12:05:50 GMT-0700 (Pacific Daylight Time)">19:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">That’s still not global state any more than <code data-md="`">AsyncContext</code> is.</td></tr>
  <tr class="msg" id="L411"><td class="ts-cell"><a class="ts" href="#L411" alt="Thu Apr 11 2024 12:06:15 GMT-0700 (Pacific Daylight Time)">19:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@huxpro:matrix.org">Xuan Huang (黄玄)</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> ok, so the list of tracked signals potentially shifts over time?</blockquote></mx-reply>Yes, the dependency graph collected and re-formed by Signals is dynamic, as opposed to the number and indexes of Hooks, which are fixed in React. Therefore you don't need it to be unconditional and don't need a lint rule</td></tr>
  <tr class="msg" id="L412"><td class="ts-cell"><a class="ts" href="#L412" alt="Thu Apr 11 2024 12:06:40 GMT-0700 (Pacific Daylight Time)">19:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> though, a <code>weakRef</code> is kind of a scary thing to use in a signal - it's a thing whose state can change which is not being read via a Signal</blockquote></mx-reply>Sure, but its code someone could conceivably write. I'd just like to know what the behavior is.</td></tr>
  <tr class="msg" id="L413"><td class="ts-cell"><a class="ts" href="#L413" alt="Thu Apr 11 2024 12:06:42 GMT-0700 (Pacific Daylight Time)">19:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mhofman:matrix.org">Mathieu Hofman</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Internally the <code data-md="`">Signal</code> can access the ambient Computed context’s var, but that’s not exposed?</blockquote></mx-reply>See things like <code>currentComputed()</code> and notify guards</td></tr>
  <tr class="msg" id="L414"><td class="ts-cell"><a class="ts" href="#L414" alt="Thu Apr 11 2024 12:07:25 GMT-0700 (Pacific Daylight Time)">19:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@trueadm:matrix.org">trueadm</span>&gt;</div></td><td class="msg-cell">In various signal implementations, there's the notion of a computed signal being "connected" to the graph. In other words, they are actively being watched by a an effect (via a Watcher) when you <code>get()</code> the comptued. If a signal reads a state signal, the state signal strongly holds a relationship with the computed signal. However, if the comptued is read outside an effect, then no strong connection is made, and instead we use a form of counter/version instead.</td></tr>
  <tr class="msg" id="L415"><td class="ts-cell"><a class="ts" href="#L415" alt="Thu Apr 11 2024 12:07:27 GMT-0700 (Pacific Daylight Time)">19:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> it appears we lost the transcriptionist</blockquote></mx-reply>I'm guessing we only paid for up to the hour :)</td></tr>
  <tr class="msg" id="L416"><td class="ts-cell"><a class="ts" href="#L416" alt="Thu Apr 11 2024 12:07:51 GMT-0700 (Pacific Daylight Time)">19:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@softwarechris:matrix.org">Chris de Almeida</span>&gt;</div></td><td class="msg-cell">🙂  they bill us after the fact</td></tr>
  <tr class="msg" id="L417"><td class="ts-cell"><a class="ts" href="#L417" alt="Thu Apr 11 2024 12:07:55 GMT-0700 (Pacific Daylight Time)">19:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@aardvark179:matrix.org">Duncan MacGregor</span>&gt;</div></td><td class="msg-cell">So what can a Signal hold? How do we stop people putting something whose values can change unexpectedly?</td></tr>
  <tr class="msg" id="L418"><td class="ts-cell"><a class="ts" href="#L418" alt="Thu Apr 11 2024 12:07:56 GMT-0700 (Pacific Daylight Time)">19:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote>See things like <code>currentComputed()</code> and notify guards</blockquote></mx-reply>Oh, <code data-md="`">subtle</code> exposes it.</td></tr>
  <tr class="msg" id="L419"><td class="ts-cell"><a class="ts" href="#L419" alt="Thu Apr 11 2024 12:08:12 GMT-0700 (Pacific Daylight Time)">19:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell">There is <code>Signal.subtle.currentComputed</code></td></tr>
  <tr class="msg" id="L420"><td class="ts-cell"><a class="ts" href="#L420" alt="Thu Apr 11 2024 12:08:16 GMT-0700 (Pacific Daylight Time)">19:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@trueadm:matrix.org">trueadm</span>&gt;</div></td><td class="msg-cell">The computed will always have a strong connection to the state signals and other comptueds it depends on, but they might not have a relationship back to it.</td></tr>
  <tr class="msg" id="L421"><td class="ts-cell"><a class="ts" href="#L421" alt="Thu Apr 11 2024 12:08:28 GMT-0700 (Pacific Daylight Time)">19:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell">It's like an async context that everyone has a reference to</td></tr>
  <tr class="msg" id="L422"><td class="ts-cell"><a class="ts" href="#L422" alt="Thu Apr 11 2024 12:08:33 GMT-0700 (Pacific Daylight Time)">19:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> So what can a Signal hold? How do we stop people putting something whose values can change unexpectedly?</blockquote></mx-reply>what does that mean? the developer has to update a Signal.State afaict</td></tr>
  <tr class="msg" id="L423"><td class="ts-cell"><a class="ts" href="#L423" alt="Thu Apr 11 2024 12:08:41 GMT-0700 (Pacific Daylight Time)">19:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@trueadm:matrix.org">trueadm</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> So what can a Signal hold? How do we stop people putting something whose values can change unexpectedly?</blockquote></mx-reply>I state signal holds a value. a computed also holds a value and is memoized.</td></tr>
  <tr class="msg" id="L424"><td class="ts-cell"><a class="ts" href="#L424" alt="Thu Apr 11 2024 12:08:51 GMT-0700 (Pacific Daylight Time)">19:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I have a very mild concern over the name <code>Signal</code>. It could be conflated with <code>AbortSignal</code>. Many years ago it was indicated that WHATWG planned to eventually make more things called <code>Signal</code> that likely weren't this.</td></tr>
  <tr class="msg" id="L425"><td class="ts-cell"><a class="ts" href="#L425" alt="Thu Apr 11 2024 12:10:37 GMT-0700 (Pacific Daylight Time)">19:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@aardvark179:matrix.org">Duncan MacGregor</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I have a very mild concern over the name <code>Signal</code>. It could be conflated with <code>AbortSignal</code>. Many years ago it was indicated that WHATWG planned to eventually make more things called <code>Signal</code> that likely weren't this.</blockquote></mx-reply>I have many concerns with the name Signal, all of them mild but I think it overlaps existing terms that mean different things and doesn't quite express the concept they seem to be aiming for.</td></tr>
  <tr class="msg" id="L426"><td class="ts-cell"><a class="ts" href="#L426" alt="Thu Apr 11 2024 12:10:41 GMT-0700 (Pacific Daylight Time)">19:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@anthonybullard:matrix.org">Anthony Bullard</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I have a very mild concern over the name <code>Signal</code>. It could be conflated with <code>AbortSignal</code>. Many years ago it was indicated that WHATWG planned to eventually make more things called <code>Signal</code> that likely weren't this.</blockquote></mx-reply>Yeah, but it is an omnipresent term in userland today, and always meaning something similar to this. A different term would be more confusing I think</td></tr>
  <tr class="msg" id="L427"><td class="ts-cell"><a class="ts" href="#L427" alt="Thu Apr 11 2024 12:10:47 GMT-0700 (Pacific Daylight Time)">19:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">HI!</td></tr>
  <tr class="msg" id="L428"><td class="ts-cell"><a class="ts" href="#L428" alt="Thu Apr 11 2024 12:11:15 GMT-0700 (Pacific Daylight Time)">19:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@anthonybullard:matrix.org">Anthony Bullard</span>&gt;</div></td><td class="msg-cell">Though this usage is only within the past few years</td></tr>
  <tr class="msg" id="L429"><td class="ts-cell"><a class="ts" href="#L429" alt="Thu Apr 11 2024 12:12:24 GMT-0700 (Pacific Daylight Time)">19:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">This is valid. That said, <code>Signal</code> has a ton of momentum in the ecosystem right now to describe this effort, in part because the standardization effort was spurred by multiple shipped features called "Signal." I have been happy to go with the name :)</td></tr>
  <tr class="msg" id="L430"><td class="ts-cell"><a class="ts" href="#L430" alt="Thu Apr 11 2024 12:12:30 GMT-0700 (Pacific Daylight Time)">19:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> it appears we lost the transcriptionist</blockquote></mx-reply>whisper transcript (linked on reflector) is still going</td></tr>
  <tr class="msg" id="L431"><td class="ts-cell"><a class="ts" href="#L431" alt="Thu Apr 11 2024 12:12:37 GMT-0700 (Pacific Daylight Time)">19:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I find it interesting that signals are gaining so much popularity right now, given that knockout existed </td></tr>
  <tr class="msg" id="L432"><td class="ts-cell"><a class="ts" href="#L432" alt="Thu Apr 11 2024 12:12:50 GMT-0700 (Pacific Daylight Time)">19:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@trueadm:matrix.org">trueadm</span>&gt;</div></td><td class="msg-cell">Arguably, signals existed all the way back from Knockout.js and various other libraries, but the popularity of of the name "signal" has been in the last few years.</td></tr>
  <tr class="msg" id="L433"><td class="ts-cell"><a class="ts" href="#L433" alt="Thu Apr 11 2024 12:12:51 GMT-0700 (Pacific Daylight Time)">19:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@softwarechris:matrix.org">Chris de Almeida</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> whisper transcript (linked on reflector) is still going</blockquote></mx-reply>saved again by the kevbot!</td></tr>
  <tr class="msg" id="L434"><td class="ts-cell"><a class="ts" href="#L434" alt="Thu Apr 11 2024 12:12:59 GMT-0700 (Pacific Daylight Time)">19:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</div></td><td class="msg-cell">bakkotbot*</td></tr>
  <tr class="msg" id="L435"><td class="ts-cell"><a class="ts" href="#L435" alt="Thu Apr 11 2024 12:13:01 GMT-0700 (Pacific Daylight Time)">19:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">Starbeam calls the primitives <code>Cell</code> and <code>Formula</code> as an Excel pun, which I like but I'm not that attached to these details :)</td></tr>
  <tr class="msg" id="L436"><td class="ts-cell"><a class="ts" href="#L436" alt="Thu Apr 11 2024 12:13:03 GMT-0700 (Pacific Daylight Time)">19:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@anthonybullard:matrix.org">Anthony Bullard</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I find it interesting that signals are gaining so much popularity right now, given that knockout existed </blockquote></mx-reply>Ryan Carniato was a knockout dev. Sometimes things come back around</td></tr>
  <tr class="msg" id="L437"><td class="ts-cell"><a class="ts" href="#L437" alt="Thu Apr 11 2024 12:13:39 GMT-0700 (Pacific Daylight Time)">19:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">Convergence around pull-based signals is a pretty important detail imo.</td></tr>
  <tr class="msg" id="L438"><td class="ts-cell"><a class="ts" href="#L438" alt="Thu Apr 11 2024 12:13:42 GMT-0700 (Pacific Daylight Time)">19:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">In .NET there is a somewhat similar mechanism called dependency properties.</td></tr>
  <tr class="msg" id="L439"><td class="ts-cell"><a class="ts" href="#L439" alt="Thu Apr 11 2024 12:13:59 GMT-0700 (Pacific Daylight Time)">19:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Though its tied to a property declaration, not an independent value.</td></tr>
  <tr class="msg" id="L440"><td class="ts-cell"><a class="ts" href="#L440" alt="Thu Apr 11 2024 12:14:01 GMT-0700 (Pacific Daylight Time)">19:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">It's what makes them so abstractable and allows for the separation we were talking about. </td></tr>
  <tr class="msg" id="L441"><td class="ts-cell"><a class="ts" href="#L441" alt="Thu Apr 11 2024 12:14:47 GMT-0700 (Pacific Daylight Time)">19:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">(not suggesting that as a name, "dependency" has an overloaded meaning in JS already)</td></tr>
  <tr class="msg" id="L442"><td class="ts-cell"><a class="ts" href="#L442" alt="Thu Apr 11 2024 12:15:15 GMT-0700 (Pacific Daylight Time)">19:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@danielrosenwasser:matrix.org">danielrosenwasser</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> whisper transcript (linked on reflector) is still going</blockquote></mx-reply>let me know next time!</td></tr>
  <tr class="msg" id="L443"><td class="ts-cell"><a class="ts" href="#L443" alt="Thu Apr 11 2024 12:15:21 GMT-0700 (Pacific Daylight Time)">19:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">Ultimately, for convergence/interop, it's pretty important that the shared primitive can support both arbitrarily interesting reactive objects built on the primitives <em>and</em> integrate deeply with the framework.</td></tr>
  <tr class="msg" id="L444"><td class="ts-cell"><a class="ts" href="#L444" alt="Thu Apr 11 2024 12:15:40 GMT-0700 (Pacific Daylight Time)">19:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-5" title="@danielrosenwasser:matrix.org">danielrosenwasser</span>&gt;</div></td><td class="msg-cell">:D</td></tr>
  <tr class="msg" id="L445"><td class="ts-cell"><a class="ts" href="#L445" alt="Thu Apr 11 2024 12:16:04 GMT-0700 (Pacific Daylight Time)">19:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">If either of those are missing, there's no real motivation to collaborate on a standard rather than build something well tuned for your framework's rendering needs</td></tr>
  <tr class="msg" id="L446"><td class="ts-cell"><a class="ts" href="#L446" alt="Thu Apr 11 2024 12:16:28 GMT-0700 (Pacific Daylight Time)">19:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">also "abortsignal" isn't a great name anyways. the DOM <em>shouldn't</em> build more "signal" things like it</td></tr>
  <tr class="msg" id="L447"><td class="ts-cell"><a class="ts" href="#L447" alt="Thu Apr 11 2024 12:17:24 GMT-0700 (Pacific Daylight Time)">19:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">I am willing to go with this narrative, but I personally don't believe in the strong version that implies a lost decade simply because people couldn't see what was in front of their faces ;)</td></tr>
  <tr class="msg" id="L448"><td class="ts-cell"><a class="ts" href="#L448" alt="Thu Apr 11 2024 12:17:50 GMT-0700 (Pacific Daylight Time)">19:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">👍️</td></tr>
  <tr class="msg" id="L449"><td class="ts-cell"><a class="ts" href="#L449" alt="Thu Apr 11 2024 12:18:25 GMT-0700 (Pacific Daylight Time)">19:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@aardvark179:matrix.org">Duncan MacGregor</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> (not suggesting that as a name, "dependency" has an overloaded meaning in JS already)</blockquote></mx-reply>PropagatedValue and PropagatingCalculation?</td></tr>
  <tr class="msg" id="L450"><td class="ts-cell"><a class="ts" href="#L450" alt="Thu Apr 11 2024 12:18:37 GMT-0700 (Pacific Daylight Time)">19:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">Yeah we've definitely been making incremental progress the whole time</td></tr>
  <tr class="msg" id="L451"><td class="ts-cell"><a class="ts" href="#L451" alt="Thu Apr 11 2024 12:18:59 GMT-0700 (Pacific Daylight Time)">19:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">"propagate" is too easy to misspell</td></tr>
  <tr class="msg" id="L452"><td class="ts-cell"><a class="ts" href="#L452" alt="Thu Apr 11 2024 12:20:11 GMT-0700 (Pacific Daylight Time)">19:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">The signals proposal does something in between. There's always a counter that can be used for invalidation, and you can form a strong connection from state-&gt;effect (via a watcher). The invalidation itself works the same in both cases though (e.g. the cache is invalidated not via a watcher but via the counter)</td></tr>
  <tr class="msg" id="L453"><td class="ts-cell"><a class="ts" href="#L453" alt="Thu Apr 11 2024 12:21:44 GMT-0700 (Pacific Daylight Time)">19:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">I think I had this in my slides: the watcher is narrowly focused on notifying something that is going to flush the signal out into the real world. But then the actual flushing is a regular pull that works in the the way you described the "no strong connection" scenario.</td></tr>
  <tr class="msg" id="L454"><td class="ts-cell"><a class="ts" href="#L454" alt="Thu Apr 11 2024 12:23:38 GMT-0700 (Pacific Daylight Time)">19:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> PropagatedValue and PropagatingCalculation?</blockquote></mx-reply>That's decidedly worse.</td></tr>
  <tr class="msg" id="L455"><td class="ts-cell"><a class="ts" href="#L455" alt="Thu Apr 11 2024 12:24:16 GMT-0700 (Pacific Daylight Time)">19:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@pchimento:igalia.com">ptomato</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Yeah, but it is an omnipresent term in userland today, and always meaning something similar to this. A different term would be more confusing I think</blockquote></mx-reply>a counterexample is the GNOME platform, where "Signal" means pub-sub, and "property notify" is used for this</td></tr>
  <tr class="msg" id="L456"><td class="ts-cell"><a class="ts" href="#L456" alt="Thu Apr 11 2024 12:24:24 GMT-0700 (Pacific Daylight Time)">19:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Maybe something using <code>Cell</code>? i.e., <code>ValueCell</code>, <code>DataCell</code>, etc.</td></tr>
  <tr class="msg" id="L457"><td class="ts-cell"><a class="ts" href="#L457" alt="Thu Apr 11 2024 12:25:17 GMT-0700 (Pacific Daylight Time)">19:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">I have a weak aesthetic dislike for Signal for a similar reason as these rub me the wrong way: the mental model (and design) is really focused on pull-based patterns (i.e. normal JS access patterns). Propagating implies that there's a strong, semantically meaningful arrow from the state through intermediate computeds that lands on effects, and that that's how you think about invalidation.</td></tr>
  <tr class="msg" id="L458"><td class="ts-cell"><a class="ts" href="#L458" alt="Thu Apr 11 2024 12:25:19 GMT-0700 (Pacific Daylight Time)">19:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell"><code>CellLikeTheOneInExcel</code></td></tr>
  <tr class="msg" id="L459"><td class="ts-cell"><a class="ts" href="#L459" alt="Thu Apr 11 2024 12:26:57 GMT-0700 (Pacific Daylight Time)">19:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">What systems that use signals are aiming for is to make the whole end-to-end feel like a one-shot function that somehow is up to date, and one reason signals end up working so well across many different paradigms (and evolved independently) is that the pull-based model facilitates that design. </td></tr>
  <tr class="msg" id="L460"><td class="ts-cell"><a class="ts" href="#L460" alt="Thu Apr 11 2024 12:27:12 GMT-0700 (Pacific Daylight Time)">19:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">If we had a native event mechanism, would we need <code>Watcher</code>?</td></tr>
  <tr class="msg" id="L461"><td class="ts-cell"><a class="ts" href="#L461" alt="Thu Apr 11 2024 12:27:17 GMT-0700 (Pacific Daylight Time)">19:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">Starbeam is <code>Cell</code> and <code>Formula</code> for this reason 🤷</td></tr>
  <tr class="msg" id="L462"><td class="ts-cell"><a class="ts" href="#L462" alt="Thu Apr 11 2024 12:28:01 GMT-0700 (Pacific Daylight Time)">19:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">I just want to respect the ecosystem and my fellow framework collaborators and not turn the conversation into a rathole on this. And frankly I would be ecstatic to get framework interop with a name I don't love.</td></tr>
  <tr class="msg" id="L463"><td class="ts-cell"><a class="ts" href="#L463" alt="Thu Apr 11 2024 12:30:33 GMT-0700 (Pacific Daylight Time)">19:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell"><code>Watcher</code> is very careful to facilitate lossy consumption patterns (i.e. the notification itself is fairly simple, you're not allowed to read from the reactive value inside of it, and you can trivially and efficiently coalesce notifications into a consumer-specified scheduling mechanism)</td></tr>
  <tr class="msg" id="L464"><td class="ts-cell"><a class="ts" href="#L464" alt="Thu Apr 11 2024 12:30:44 GMT-0700 (Pacific Daylight Time)">19:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> If we had a native event mechanism, would we need <code>Watcher</code>?</blockquote></mx-reply>I don't understand the question; what would a native event mechanism solve to simplify Watcher?</td></tr>
  <tr class="msg" id="L465"><td class="ts-cell"><a class="ts" href="#L465" alt="Thu Apr 11 2024 12:30:53 GMT-0700 (Pacific Daylight Time)">19:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">The scheduling mechanism can include things like "validation happens from the top-down in tree order"</td></tr>
  <tr class="msg" id="L466"><td class="ts-cell"><a class="ts" href="#L466" alt="Thu Apr 11 2024 12:31:38 GMT-0700 (Pacific Daylight Time)">19:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">rbuckton</span>: events and observables are really awesome for lossless streams of data, and have affordances and efficiency tradeoffs that are tuned for that.</td></tr>
  <tr class="msg" id="L467"><td class="ts-cell"><a class="ts" href="#L467" alt="Thu Apr 11 2024 12:31:40 GMT-0700 (Pacific Daylight Time)">19:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><p>For example, I'd sketched out an idea awhile back about using a symbol-protocol for pub/sub events that could sit on top of <code>EventTarget</code>/<code>EventEmitter</code>/etc., and just add a very lightweight event primitive to JS.</p>
<p>then you do something like <code>cell::onchanged += () =&gt; {}</code> to watch for changes on a single cell.</p>
</td></tr>
  <tr class="msg" id="L468"><td class="ts-cell"><a class="ts" href="#L468" alt="Thu Apr 11 2024 12:31:59 GMT-0700 (Pacific Daylight Time)">19:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell"><code>stopImmediatePropagation</code> 🤦</td></tr>
  <tr class="msg" id="L469"><td class="ts-cell"><a class="ts" href="#L469" alt="Thu Apr 11 2024 12:32:02 GMT-0700 (Pacific Daylight Time)">19:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">Did I get it right?</td></tr>
  <tr class="msg" id="L470"><td class="ts-cell"><a class="ts" href="#L470" alt="Thu Apr 11 2024 12:33:34 GMT-0700 (Pacific Daylight Time)">19:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">I feel like I'm brushing you off a little too much here. I'd love to sync up and give enough time to hear you out. You've thought about this a lot and I would love to mind-meld :)</td></tr>
  <tr class="msg" id="L471"><td class="ts-cell"><a class="ts" href="#L471" alt="Thu Apr 11 2024 12:33:41 GMT-0700 (Pacific Daylight Time)">19:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">If the event mechanism is hookable (which it would have to be to work with <code>EventTarget</code>/<code>EventEmitter</code>), then you can be flexible in the underlying event notifaction mechanism.</td></tr>
  <tr class="msg" id="L472"><td class="ts-cell"><a class="ts" href="#L472" alt="Thu Apr 11 2024 12:33:52 GMT-0700 (Pacific Daylight Time)">19:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@trueadm:matrix.org">trueadm</span>&gt;</div></td><td class="msg-cell">I think the important part of Watcher, vs events, is that is that signals are designed to be lossy. If you were to write to a signal multiple times, we'd only really care that the signal is dirty and when we get around to scheduling an update from the watcher we get the latest value. The intermediate signal state values wouldn't be important as we only "pull" the latest value when we're interested in it, vs being notified everytime a signal changes.</td></tr>
  <tr class="msg" id="L473"><td class="ts-cell"><a class="ts" href="#L473" alt="Thu Apr 11 2024 12:34:59 GMT-0700 (Pacific Daylight Time)">19:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I think the important part of Watcher, vs events, is that is that signals are designed to be lossy. If you were to write to a signal multiple times, we'd only really care that the signal is dirty and when we get around to scheduling an update from the watcher we get the latest value. The intermediate signal state values wouldn't be important as we only "pull" the latest value when we're interested in it, vs being notified everytime a signal changes.</blockquote></mx-reply>That's perfectly fine. Events don't have to be lossless.</td></tr>
  <tr class="msg" id="L474"><td class="ts-cell"><a class="ts" href="#L474" alt="Thu Apr 11 2024 12:35:39 GMT-0700 (Pacific Daylight Time)">19:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">I can definitely imagine a foundation for events that allows things like the watcher API to fit neatly into it.</td></tr>
  <tr class="msg" id="L475"><td class="ts-cell"><a class="ts" href="#L475" alt="Thu Apr 11 2024 12:36:31 GMT-0700 (Pacific Daylight Time)">19:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">This use-case a good thing to keep in mind if people are going to try to nail down an events foundation</td></tr>
  <tr class="msg" id="L476"><td class="ts-cell"><a class="ts" href="#L476" alt="Thu Apr 11 2024 12:38:19 GMT-0700 (Pacific Daylight Time)">19:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">My main concern is adding Yet Another Subscription Mechanism to JS. I'll admit, I've done my fair share. <code>DisposableStack</code> can take callbacks and notify them, but that capability is a one shot notification and is primarily designed as an adapter for legacy code.</td></tr>
  <tr class="msg" id="L477"><td class="ts-cell"><a class="ts" href="#L477" alt="Thu Apr 11 2024 12:38:22 GMT-0700 (Pacific Daylight Time)">19:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mhofman:matrix.org">Mathieu Hofman</span>&gt;</div></td><td class="msg-cell">(I really wish Matrix had better threading support)</td></tr>
  <tr class="msg" id="L478"><td class="ts-cell"><a class="ts" href="#L478" alt="Thu Apr 11 2024 12:38:42 GMT-0700 (Pacific Daylight Time)">19:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Same...</td></tr>
  <tr class="msg" id="L479"><td class="ts-cell"><a class="ts" href="#L479" alt="Thu Apr 11 2024 12:39:13 GMT-0700 (Pacific Daylight Time)">19:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">rbuckton</span>: that's a good framing for your feelings. It will help me remember your concern as we iterate the design :)</td></tr>
  <tr class="msg" id="L480"><td class="ts-cell"><a class="ts" href="#L480" alt="Thu Apr 11 2024 12:40:11 GMT-0700 (Pacific Daylight Time)">19:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@mhofman:matrix.org">Mathieu Hofman</span>&gt;</div></td><td class="msg-cell"><span class="nick-2">bakkot</span>: is the log bot down?</td></tr>
  <tr class="msg" id="L481"><td class="ts-cell"><a class="ts" href="#L481" alt="Thu Apr 11 2024 12:40:46 GMT-0700 (Pacific Daylight Time)">19:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">But why can’t the unifying mechanism be “callbacks”?</td></tr>
  <tr class="msg" id="L482"><td class="ts-cell"><a class="ts" href="#L482" alt="Thu Apr 11 2024 12:41:27 GMT-0700 (Pacific Daylight Time)">19:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Regardless as to its internal implementation, <code>Watcher</code> is yet another in a long line of pub/sub mechanisms. One would be enough, two is pushing it, but we already have 5+ and some are for <em>very</em> niche events. I'd like us to stop that trend if possible.</td></tr>
  <tr class="msg" id="L483"><td class="ts-cell"><a class="ts" href="#L483" alt="Thu Apr 11 2024 12:42:36 GMT-0700 (Pacific Daylight Time)">19:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">I mean, that underlies all these other ones</td></tr>
  <tr class="msg" id="L484"><td class="ts-cell"><a class="ts" href="#L484" alt="Thu Apr 11 2024 12:42:47 GMT-0700 (Pacific Daylight Time)">19:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">That's not a unified mechanism. If you ask any JS developer if JS has events, I expect they'd say yes. Except, it doesn't. DOM has events, NodeJS has events, JS itself does not.</td></tr>
  <tr class="msg" id="L485"><td class="ts-cell"><a class="ts" href="#L485" alt="Thu Apr 11 2024 12:43:29 GMT-0700 (Pacific Daylight Time)">19:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">One thing to understand about the watcher mechanism is that its use should really be buried within the implementation of effects or rendering, not for direct use by JS devs</td></tr>
  <tr class="msg" id="L486"><td class="ts-cell"><a class="ts" href="#L486" alt="Thu Apr 11 2024 12:43:59 GMT-0700 (Pacific Daylight Time)">19:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@trueadm:matrix.org">trueadm</span>&gt;</div></td><td class="msg-cell">In an earlier design, we had the notion that you could pass a computed a callback function that would trigger when it was made dirty. The downside was that you had to pass this upon construction of the computed, which meant interoperability was impaired. However, it could be modelled differently. Is that better than having a watcher?</td></tr>
  <tr class="msg" id="L487"><td class="ts-cell"><a class="ts" href="#L487" alt="Thu Apr 11 2024 12:46:05 GMT-0700 (Pacific Daylight Time)">19:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Maybe I didn't represent my position correctly when I asked if <code>Watcher</code> is needed. I agree it is needed, even with a native event mechanism, even if only as the event coordinator. I'm trying to ascertain which parts of <code>Watcher</code> are unique to <code>Watcher</code> as opposed to a generalized pub/sub mechanism.</td></tr>
  <tr class="msg" id="L488"><td class="ts-cell"><a class="ts" href="#L488" alt="Thu Apr 11 2024 12:46:33 GMT-0700 (Pacific Daylight Time)">19:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">rbuckton</span>: I mostly defer to Dan and other deep in the implementation constraint space on the fine details. What I primarily care about is not turning it into yet another pipe for data to flow through</td></tr>
  <tr class="msg" id="L489"><td class="ts-cell"><a class="ts" href="#L489" alt="Thu Apr 11 2024 12:46:49 GMT-0700 (Pacific Daylight Time)">19:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">so I guess we're both worried about the same thing, it turns out? :)</td></tr>
  <tr class="msg" id="L490"><td class="ts-cell"><a class="ts" href="#L490" alt="Thu Apr 11 2024 12:47:19 GMT-0700 (Pacific Daylight Time)">19:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">trueadm</span>: doesn't that fly in the face of decoupling and abstraction goals?</td></tr>
  <tr class="msg" id="L491"><td class="ts-cell"><a class="ts" href="#L491" alt="Thu Apr 11 2024 12:47:39 GMT-0700 (Pacific Daylight Time)">19:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">I guess not, since you're always making a computed at the edge</td></tr>
  <tr class="msg" id="L492"><td class="ts-cell"><a class="ts" href="#L492" alt="Thu Apr 11 2024 12:47:46 GMT-0700 (Pacific Daylight Time)">19:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Using .NET as an example (as I am oft to do), events aren't only defined using <code>Delegate</code> or <code>MulticastDelegate</code>, they are hookable. WPF has RoutedEvents which act similar to DOM events and are primarily used to work with dependency properties.</td></tr>
  <tr class="msg" id="L493"><td class="ts-cell"><a class="ts" href="#L493" alt="Thu Apr 11 2024 12:47:53 GMT-0700 (Pacific Daylight Time)">19:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">however... it implies that the watcher is forever, no?</td></tr>
  <tr class="msg" id="L494"><td class="ts-cell"><a class="ts" href="#L494" alt="Thu Apr 11 2024 12:49:32 GMT-0700 (Pacific Daylight Time)">19:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@trueadm:matrix.org">trueadm</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> however... it implies that the watcher is forever, no?</blockquote></mx-reply>Well back then the design allowed for effects to be detached from the graph. I was just seeing what the appetite was for an alternative approach.</td></tr>
  <tr class="msg" id="L495"><td class="ts-cell"><a class="ts" href="#L495" alt="Thu Apr 11 2024 12:50:48 GMT-0700 (Pacific Daylight Time)">19:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@trueadm:matrix.org">trueadm</span>&gt;</div></td><td class="msg-cell">I think events might be fine. However, I do worry about the overhead in allocations from events and EventTarget. The signal graph is essential for performance so it needs to be as lean and optimal as possible to ensure it can scale well for complex UI cases.</td></tr>
  <tr class="msg" id="L496"><td class="ts-cell"><a class="ts" href="#L496" alt="Thu Apr 11 2024 12:51:08 GMT-0700 (Pacific Daylight Time)">19:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell"><span class="nick-4">trueadm</span>: I'm both pretty free-and-easy on the exact details of what's going on at the flushing edges <em>and</em> very committed to designing a feature that facilitates and supports "it looks like one-shot but is magically up to date" patterns.</td></tr>
  <tr class="msg" id="L497"><td class="ts-cell"><a class="ts" href="#L497" alt="Thu Apr 11 2024 12:51:25 GMT-0700 (Pacific Daylight Time)">19:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">Preact and React get a lot of that "for free" (with some cost) from the JSX model.</td></tr>
  <tr class="msg" id="L498"><td class="ts-cell"><a class="ts" href="#L498" alt="Thu Apr 11 2024 12:51:51 GMT-0700 (Pacific Daylight Time)">19:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">But the Watcher API should facilitate a way of thinking about Vue/Svelte/Ember/etc templates that are, more-or-less, like JSX.</td></tr>
  <tr class="msg" id="L499"><td class="ts-cell"><a class="ts" href="#L499" alt="Thu Apr 11 2024 12:51:55 GMT-0700 (Pacific Daylight Time)">19:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">It could be that <code>Watcher</code> ends up being a poor use case for events. I'm still concerned that we don't have events. Signals and events both belong to a similar class of observer-related mechanisms, and that we're catering to a niche use case without considering wider issues.</td></tr>
  <tr class="msg" id="L500"><td class="ts-cell"><a class="ts" href="#L500" alt="Thu Apr 11 2024 12:53:29 GMT-0700 (Pacific Daylight Time)">19:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">I think I see where you're coming from. I'm especially interested in the possibility of stripping away the affordances that have accreted onto the high-level EventEmitter and get down to the fundamentals</td></tr>
  <tr class="msg" id="L501"><td class="ts-cell"><a class="ts" href="#L501" alt="Thu Apr 11 2024 12:54:15 GMT-0700 (Pacific Daylight Time)">19:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">What bothers me about "why not use an event" is that it implies a bunch of noise around the usage pattern when a much tinier pattern actually works. This is probably also why we keep getting more of these things.</td></tr>
  <tr class="msg" id="L502"><td class="ts-cell"><a class="ts" href="#L502" alt="Thu Apr 11 2024 12:54:44 GMT-0700 (Pacific Daylight Time)">19:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">FYI, I think the general consensus is that Matrix threads are a terrible UI. Replies are easier to follow when there aren't 5 conversations going on at once.</td></tr>
  <tr class="msg" id="L503"><td class="ts-cell"><a class="ts" href="#L503" alt="Thu Apr 11 2024 12:56:11 GMT-0700 (Pacific Daylight Time)">19:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">I guess I'm just used to it via work Slack. I have been keeping the threads pane open, but I'm probably swallowing a lot of cognitive overhead because I'm used to it.</td></tr>
  <tr class="msg" id="L504"><td class="ts-cell"><a class="ts" href="#L504" alt="Thu Apr 11 2024 12:56:17 GMT-0700 (Pacific Daylight Time)">19:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> What bothers me about "why not use an event" is that it implies a bunch of noise around the usage pattern when a much tinier pattern actually works. This is probably also why we keep getting more of these things.</blockquote></mx-reply>Yes, but this becomes a death by a thousand papercuts. At some point we have to stop tacking on one-off "similar but not the same" mechanisms.</td></tr>
  <tr class="msg" id="L505"><td class="ts-cell"><a class="ts" href="#L505" alt="Thu Apr 11 2024 12:57:03 GMT-0700 (Pacific Daylight Time)">19:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">I'm super into the design space of "what's the minimal EventEmitter that would be ergonomic enough so people would use it instead of ad-hoc callbacks, and also serve as a foundation for the ones that exist"</td></tr>
  <tr class="msg" id="L506"><td class="ts-cell"><a class="ts" href="#L506" alt="Thu Apr 11 2024 12:57:10 GMT-0700 (Pacific Daylight Time)">19:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">Does that characterize your position correctly?</td></tr>
  <tr class="msg" id="L507"><td class="ts-cell"><a class="ts" href="#L507" alt="Thu Apr 11 2024 12:57:11 GMT-0700 (Pacific Daylight Time)">19:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">If <code>Watcher</code> is dissimilar enough, maybe I drop the concern, It just doesn't <em>feel</em> so dissimilar.</td></tr>
  <tr class="msg" id="L508"><td class="ts-cell"><a class="ts" href="#L508" alt="Thu Apr 11 2024 12:58:14 GMT-0700 (Pacific Daylight Time)">19:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell"><span class="nick-6">ljharb</span> was quibbling with this point, and he's not wrong about the  <code>fetch</code> precedent. That said, I really liked your point (the "simple effects" people intuit they want are a DOM feature).</td></tr>
  <tr class="msg" id="L509"><td class="ts-cell"><a class="ts" href="#L509" alt="Thu Apr 11 2024 12:59:07 GMT-0700 (Pacific Daylight Time)">19:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Does that characterize your position correctly?</blockquote></mx-reply>That and "how do we make it compatible with the DOM and NodeJS". I'm pretty sure there would be opposition to a wholly new event mechanism.</td></tr>
  <tr class="msg" id="L510"><td class="ts-cell"><a class="ts" href="#L510" alt="Thu Apr 11 2024 13:01:29 GMT-0700 (Pacific Daylight Time)">20:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell">`Watcher` is in someways like `FinalizationRegistry`, where its core purpose is to be notified. So taking a single callback as a constructor argument maybe does fit this pattern well. As opposed to EventEmitters which are fan out to a changing N observers&nbsp;</td></tr>
  <tr class="msg" id="L511"><td class="ts-cell"><a class="ts" href="#L511" alt="Thu Apr 11 2024 13:01:53 GMT-0700 (Pacific Daylight Time)">20:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> `Watcher` is in someways like `FinalizationRegistry`, where its core purpose is to be notified. So taking a single callback as a constructor argument maybe does fit this pattern well. As opposed to EventEmitters which are fan out to a changing N</blockquote></mx-reply>Great observation!</td></tr>
  <tr class="msg" id="L512"><td class="ts-cell"><a class="ts" href="#L512" alt="Thu Apr 11 2024 13:02:09 GMT-0700 (Pacific Daylight Time)">20:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I would like to have proposed an events mechanism before, and have wanted one for years, but I'm already overcommitted to other work and I hadn't yet reached the proverbial "last straw".</td></tr>
  <tr class="msg" id="L513"><td class="ts-cell"><a class="ts" href="#L513" alt="Thu Apr 11 2024 13:04:05 GMT-0700 (Pacific Daylight Time)">20:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> `Watcher` is in someways like `FinalizationRegistry`, where its core purpose is to be notified. So taking a single callback as a constructor argument maybe does fit this pattern well. As opposed to EventEmitters which are fan out to a changing N observers&nbsp;</blockquote></mx-reply>Maybe it is, but Signals, Observables, Promises, and Events all belong to a similar category of observation mechanisms, even if they fill out different quadrants.</td></tr>
  <tr class="msg" id="L514"><td class="ts-cell"><a class="ts" href="#L514" alt="Thu Apr 11 2024 13:05:09 GMT-0700 (Pacific Daylight Time)">20:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell">True, but something grouping things hides how they should be approached differently&nbsp;</td></tr>
  <tr class="msg" id="L515"><td class="ts-cell"><a class="ts" href="#L515" alt="Thu Apr 11 2024 13:07:04 GMT-0700 (Pacific Daylight Time)">20:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell">Observables can model Promises and also synchronous return values. But when I worked on projects that used Observables in perhaps too many places it was hard to reason about them. "Is this an observable of many values, or one. Is it async or sync"&nbsp;&nbsp;</td></tr>
  <tr class="msg" id="L516"><td class="ts-cell"><a class="ts" href="#L516" alt="Thu Apr 11 2024 13:07:41 GMT-0700 (Pacific Daylight Time)">20:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell">The Watcher is more like a Sink than an Emitter. And has a different set of responsibilities&nbsp;</td></tr>
  <tr class="msg" id="L517"><td class="ts-cell"><a class="ts" href="#L517" alt="Thu Apr 11 2024 13:07:58 GMT-0700 (Pacific Daylight Time)">20:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell">but I do see your point</td></tr>
  <tr class="msg" id="L518"><td class="ts-cell"><a class="ts" href="#L518" alt="Thu Apr 11 2024 13:08:09 GMT-0700 (Pacific Daylight Time)">20:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Side question: How much of the Signals proposal is actually <code>Signal</code>/<code>Computed</code> vs <code>Watcher</code>? In other words, is <code>Watcher</code> the building block that both <code>Signal</code> and <code>Computed</code> are built on?</td></tr>
  <tr class="msg" id="L519"><td class="ts-cell"><a class="ts" href="#L519" alt="Thu Apr 11 2024 13:10:05 GMT-0700 (Pacific Daylight Time)">20:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell">Signals and computed on their own work, but to be reactive without watcher that would be a polling system. Like how some hardware works where the main loop just keeps checking what is dirty&nbsp;</td></tr>
  <tr class="msg" id="L520"><td class="ts-cell"><a class="ts" href="#L520" alt="Thu Apr 11 2024 13:10:23 GMT-0700 (Pacific Daylight Time)">20:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell">on their own the caching still works&nbsp;</td></tr>
  <tr class="msg" id="L521"><td class="ts-cell"><a class="ts" href="#L521" alt="Thu Apr 11 2024 13:10:33 GMT-0700 (Pacific Daylight Time)">20:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Side question: How much of the Signals proposal is actually <code>Signal</code>/<code>Computed</code> vs <code>Watcher</code>? In other words, is <code>Watcher</code> the building block that both <code>Signal</code> and <code>Computed</code> are built on?</blockquote></mx-reply>No, it's not</td></tr>
  <tr class="msg" id="L522"><td class="ts-cell"><a class="ts" href="#L522" alt="Thu Apr 11 2024 13:10:36 GMT-0700 (Pacific Daylight Time)">20:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@aclaymore:matrix.org">Ashley Claymore</span>&gt;</div></td><td class="msg-cell">Reading a computed twice in a row is cached&nbsp;</td></tr>
  <tr class="msg" id="L523"><td class="ts-cell"><a class="ts" href="#L523" alt="Thu Apr 11 2024 13:12:13 GMT-0700 (Pacific Daylight Time)">20:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> No, it's not</blockquote></mx-reply>Everything about reading computeds, having them cache, invalidation, etc can be described without reference to the <code>Watcher</code></td></tr>
  <tr class="msg" id="L524"><td class="ts-cell"><a class="ts" href="#L524" alt="Thu Apr 11 2024 13:13:08 GMT-0700 (Pacific Daylight Time)">20:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">a <code>Watcher</code> allows you to say "I am using this computed to populate a sink of some sort (usually a DOM node), and I need to know when any of its dependencies change so I can properly schedule it to update and read its value when I do that"</td></tr>
  <tr class="msg" id="L525"><td class="ts-cell"><a class="ts" href="#L525" alt="Thu Apr 11 2024 13:13:26 GMT-0700 (Pacific Daylight Time)">20:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> The Watcher is more like a Sink than an Emitter. And has a different set of responsibilities&nbsp;</blockquote></mx-reply>This is a fair point. I have to think more about my concerns and whether I might still consider them blocking for stage 2. Either way, I still think it is unfortunate that we might have this and yet still be missing events.</td></tr>
  <tr class="msg" id="L526"><td class="ts-cell"><a class="ts" href="#L526" alt="Thu Apr 11 2024 13:17:39 GMT-0700 (Pacific Daylight Time)">20:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> This is a fair point. I have to think more about my concerns and whether I might still consider them blocking for stage 2. Either way, I still think it is unfortunate that we might have this and yet still be missing events.</blockquote></mx-reply>I keep trying to nudge the term <code>Sink</code> into the explanations we give</td></tr>
  <tr class="msg" id="L527"><td class="ts-cell"><a class="ts" href="#L527" alt="Thu Apr 11 2024 13:17:42 GMT-0700 (Pacific Daylight Time)">20:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">I think it's really good</td></tr>
  <tr class="msg" id="L528"><td class="ts-cell"><a class="ts" href="#L528" alt="Thu Apr 11 2024 13:17:55 GMT-0700 (Pacific Daylight Time)">20:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Signals feels like we're giving everyone a chainsaw when they need a flathead screwdriver. Sure, that's great for the woodcutters, but that means the rest of us have to get by with a butter knife. Normally, I wouldn't conflate two proposals in this way were it not for the close similarities.</td></tr>
  <tr class="msg" id="L529"><td class="ts-cell"><a class="ts" href="#L529" alt="Thu Apr 11 2024 13:19:16 GMT-0700 (Pacific Daylight Time)">20:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Maybe it is, but Signals, Observables, Promises, and Events all belong to a similar category of observation mechanisms, even if they fill out different quadrants.</blockquote></mx-reply>I'm pretty open to filling out the table. Some formal-ish observations: Signals facilitate discrete updates, are pull-based, and have a lot in common with the incremental computation academic space</td></tr>
  <tr class="msg" id="L530"><td class="ts-cell"><a class="ts" href="#L530" alt="Thu Apr 11 2024 13:19:39 GMT-0700 (Pacific Daylight Time)">20:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">And don't get me wrong, I like the idea of signals. I've used knockout and React and so many other systems with a similar concept, and I can see its utility in other places as well.</td></tr>
  <tr class="msg" id="L531"><td class="ts-cell"><a class="ts" href="#L531" alt="Thu Apr 11 2024 13:20:12 GMT-0700 (Pacific Daylight Time)">20:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I'm pretty open to filling out the table. Some formal-ish observations: Signals facilitate discrete updates, are pull-based, and have a lot in common with the incremental computation academic space</blockquote></mx-reply>People want to tell me that they're push-pull, but signals do a pretty different thing than what people usually mean by push-pull, producing pretty different abstractability and interface outcomes</td></tr>
  <tr class="msg" id="L532"><td class="ts-cell"><a class="ts" href="#L532" alt="Thu Apr 11 2024 13:20:28 GMT-0700 (Pacific Daylight Time)">20:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">I could believe you want to make "push-pull" more subtle</td></tr>
  <tr class="msg" id="L533"><td class="ts-cell"><a class="ts" href="#L533" alt="Thu Apr 11 2024 13:21:20 GMT-0700 (Pacific Daylight Time)">20:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">"Filling out the table" was supposed to include Observable as well. I'm not certain why the proposal switched venues.</td></tr>
  <tr class="msg" id="L534"><td class="ts-cell"><a class="ts" href="#L534" alt="Thu Apr 11 2024 13:21:45 GMT-0700 (Pacific Daylight Time)">20:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Can setting a signal trigger a UI update? If so, it's <em>also</em> push based.</td></tr>
  <tr class="msg" id="L535"><td class="ts-cell"><a class="ts" href="#L535" alt="Thu Apr 11 2024 13:21:47 GMT-0700 (Pacific Daylight Time)">20:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">rbuckton</span>: What, imo, is new from the FRP wikipedia page (or even the various attempts to nail this down in terms of promises and observables) is that we have a lot of existence proofs now that the theoretical issues people have with those choices are managable and efficient at scale in the context of web UIs.</td></tr>
  <tr class="msg" id="L536"><td class="ts-cell"><a class="ts" href="#L536" alt="Thu Apr 11 2024 13:22:47 GMT-0700 (Pacific Daylight Time)">20:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Can setting a signal trigger a UI update? If so, it's <em>also</em> push based.</blockquote></mx-reply>Setting a signal sends a notification, but there's an all-signals read-write barrier in the notification, which prevents you from simply updating the UI right there</td></tr>
  <tr class="msg" id="L537"><td class="ts-cell"><a class="ts" href="#L537" alt="Thu Apr 11 2024 13:22:57 GMT-0700 (Pacific Daylight Time)">20:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">it also doesn't need to propagate through computeds</td></tr>
  <tr class="msg" id="L538"><td class="ts-cell"><a class="ts" href="#L538" alt="Thu Apr 11 2024 13:22:57 GMT-0700 (Pacific Daylight Time)">20:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><code>Computed</code> is definitely pull only.</td></tr>
  <tr class="msg" id="L539"><td class="ts-cell"><a class="ts" href="#L539" alt="Thu Apr 11 2024 13:24:02 GMT-0700 (Pacific Daylight Time)">20:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">At the extreme end, the original Ember model (which is spiritually equivalent) has a single microtask notification that coalesces any amount of signal updates</td></tr>
  <tr class="msg" id="L540"><td class="ts-cell"><a class="ts" href="#L540" alt="Thu Apr 11 2024 13:25:37 GMT-0700 (Pacific Daylight Time)">20:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">and that causes a top-down revalidation uses pull-based revalidation to cut off subtrees, and which manages to be relatively efficient because of the natural logarithmic(ish) properties of output DOM trees</td></tr>
  <tr class="msg" id="L541"><td class="ts-cell"><a class="ts" href="#L541" alt="Thu Apr 11 2024 13:26:06 GMT-0700 (Pacific Daylight Time)">20:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">You can call this a "push" but it's not really what people mean when they talk about "push-pull" models</td></tr>
  <tr class="msg" id="L542"><td class="ts-cell"><a class="ts" href="#L542" alt="Thu Apr 11 2024 13:29:04 GMT-0700 (Pacific Daylight Time)">20:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I will withdraw my Stage 2 blocking concern. While I'd like to have a native event mechanism, <code>Watcher</code> does not seem like a fit for it and I don't think it's fair to block a proposal on the basis of the existence or non-existence of a separate proposal I do not have the capacity to champion myself. I am still concerned about the lack of events, but I'm willing to wait until the next push trigger to raise the concern, or for when I have less on my plate.</td></tr>
  <tr class="msg" id="L543"><td class="ts-cell"><a class="ts" href="#L543" alt="Thu Apr 11 2024 13:31:37 GMT-0700 (Pacific Daylight Time)">20:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> You can call this a "push" but it's not really what people mean when they talk about "push-pull" models</blockquote></mx-reply>I suppose that's true in the broader sense</td></tr>
  <tr class="msg" id="L544"><td class="ts-cell"><a class="ts" href="#L544" alt="Thu Apr 11 2024 13:50:39 GMT-0700 (Pacific Daylight Time)">20:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><p>I have an interesting observation, though in the end it is perhaps not relevant to signals. For a number of years I have also been considering a proposal to add <code>ref</code> (though potentially spelled <code>&amp;</code>) for both reference passing and reified references, i.e.:</p>
<pre><code class="language-js">function f(&amp;x) { x = 1; } // reference passing
function g(xref) { xref.value = 2; } // reified reference

let y = 0;

f(&amp;y); // pass reference to mutable binding
y; // 1

const yref = &amp;y; 
g(yref); // pass reified reference to mutable binding

y; // 2

let &amp;ym = yref; // dereference to mutable binding
ym = 3;

y; // 3

const &amp;yc = yref; // dereference to immutable (but live) binding
y++;
yc; // 4
</code></pre>
<p>I wonder how interesting it would be if you could treat state/computed as refs:</p>
<pre><code class="language-js">let &amp;counter = new Signal.State(0);
counter; // 0
counter++;
counter; // 1

const &amp;parity = new Signal.Computed(() =&gt; counter % 2 ? "odd" : "even");
</code></pre>
</td></tr>
  <tr class="msg" id="L545"><td class="ts-cell"><a class="ts" href="#L545" alt="Thu Apr 11 2024 13:51:28 GMT-0700 (Pacific Daylight Time)">20:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I've been collecting use cases and this seems like an interesting one.</td></tr>
  <tr class="msg" id="L546"><td class="ts-cell"><a class="ts" href="#L546" alt="Thu Apr 11 2024 13:57:01 GMT-0700 (Pacific Daylight Time)">20:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><p>Some of the other use cases include decorators (to handle circularity/TDZ)</p>
<pre><code class="language-js">@Entity
class Parent {
  @OneToMany(&amp;Child) children;
}

@Entity
class Child {
  @ManyToOne(&amp;Parent) parent;
}
</code></pre>
<p>and private state in shared structs</p>
<pre><code class="language-js">shared struct AtomicValue {
  #value; // do not allow unordered access to private field

  load() { return Atomics.load(&amp;this.#value); }
  compareExchange(expected, replacement) { return Atomics.compareExchange(&amp;this.#value, expected, replacement); }
  ...
}
</code></pre>
<p>Plus a few others.</p>
</td></tr>
  <tr class="msg" id="L547"><td class="ts-cell"><a class="ts" href="#L547" alt="Thu Apr 11 2024 14:02:04 GMT-0700 (Pacific Daylight Time)">21:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><p>To the runtime, <code>&amp;</code> is more like a syntactic transformation, so the signals example ends up treated as something roughly like this:</p>
<pre><code class="language-js">const ref_mut_counter = new Signal.State(0);
ref_mut_counter.value; // 0
ref_mut_counter.value++;
ref_mut_counter.value; // 1

const ref_cnst_parity = new Signal.Computed(() =&gt; ref_mut_counter.value % 2 ? "odd" : "even");
</code></pre>
</td></tr>
  <tr class="msg" id="L548"><td class="ts-cell"><a class="ts" href="#L548" alt="Thu Apr 11 2024 14:03:44 GMT-0700 (Pacific Daylight Time)">21:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">One benefit to having Signals as a built-in mechanism in ECMA-262 is that we could get away with specifying it as a reified reference.</td></tr>
  <tr class="msg" id="L549"><td class="ts-cell"><a class="ts" href="#L549" alt="Thu Apr 11 2024 14:04:09 GMT-0700 (Pacific Daylight Time)">21:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">or rather, a kind of reified reference.</td></tr>
  <tr class="msg" id="L550"><td class="ts-cell"><a class="ts" href="#L550" alt="Thu Apr 11 2024 14:19:23 GMT-0700 (Pacific Daylight Time)">21:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">I had to suddenly switch back to work-work -- sorry for disappearing mid-convo :)</td></tr>
  <tr class="msg" id="L551"><td class="ts-cell"><a class="ts" href="#L551" alt="Thu Apr 11 2024 14:21:32 GMT-0700 (Pacific Daylight Time)">21:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <p>To the runtime, <code>&amp;</code> is more like a syntactic transformation, so the signals example ends up treated as something roughly like this:</p>
<pre><code class="language-js">const ref_mut_counter = new Signal.State(0);
ref_mut_counter.value; // 0
ref_mut_counter.value++;
ref_mut_counter.value; // 1

const ref_cnst_parity = new Signal.Computed(() =&gt; ref_mut_counter.value % 2 ? "odd" : "even");
</code></pre>
</blockquote></mx-reply>fwiw, I am personally interested in exploring trimming down the portion of the API that really has to be a reference, ideally separating it from the value portion. This is roughly the Starbeam API, but I would need to float it by other framework authors to see whether there are incidental simplifying assumptions in Ember that let us get away with that design, but which prevent it from being fully general</td></tr>
  <tr class="msg" id="L552"><td class="ts-cell"><a class="ts" href="#L552" alt="Thu Apr 11 2024 14:30:31 GMT-0700 (Pacific Daylight Time)">21:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I had to suddenly switch back to work-work -- sorry for disappearing mid-convo :)</blockquote></mx-reply>And now I really do have to go! Please DM me with any follow-ups. The thoughtful feedback and questions were really invigorating :)</td></tr>
  <tr class="msg" id="L553"><td class="ts-cell"><a class="ts" href="#L553" alt="Thu Apr 11 2024 14:43:18 GMT-0700 (Pacific Daylight Time)">21:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@trueadm:matrix.org">trueadm</span>&gt;</div></td><td class="msg-cell"><p>That's pretty much how Svelte 5 works with signals. We don't actually expose Signal objects, instead they're hidden away by the compiler.</p>
<pre><code class="language-js">let counter = $state(0):

counter++;
console.log(counter); // 1
</code></pre>
</td></tr>
  <tr class="msg" id="L554"><td class="ts-cell"><a class="ts" href="#L554" alt="Thu Apr 11 2024 14:45:04 GMT-0700 (Pacific Daylight Time)">21:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <p>That's pretty much how Svelte 5 works with signals. We don't actually expose Signal objects, instead they're hidden away by the compiler.</p>
<pre><code class="language-js">let counter = $state(0):

counter++;
console.log(counter); // 2
</code></pre>
</blockquote></mx-reply>it's also how Ember works with our precursor to signals and how Starbeam (our next generation reactivity system, which is my primary technical project on Ember these days) interacts with them.</td></tr>
  <tr class="msg" id="L555"><td class="ts-cell"><a class="ts" href="#L555" alt="Thu Apr 11 2024 14:45:20 GMT-0700 (Pacific Daylight Time)">21:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">There's mostly a pretty close mapping between the concepts we use and signals.</td></tr>
  <tr class="msg" id="L556"><td class="ts-cell"><a class="ts" href="#L556" alt="Thu Apr 11 2024 14:45:39 GMT-0700 (Pacific Daylight Time)">21:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@wycats:matrix.org">Yehuda Katz</span>&gt;</div></td><td class="msg-cell">Also, turns out if I want to avoid nerd-sniping myself, I need to turn off notifications :P</td></tr>

</tbody></table></div></div></div>
</body></html>