<!DOCTYPE html><html><head>
  <title>TC39 Delegates on 2024-07-29</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "TC39 Delegates";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">TC39 Delegates<br>2024-07-29<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2024-07-27" class="nav-link"><span>prev</span></a>
<span style="float:right">next</span>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search TC39 Delegates">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Mon Jul 29 2024 08:59:09 GMT-0700 (Pacific Daylight Time)">15:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">it's T-1 hours and still no VC link?</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Mon Jul 29 2024 09:14:10 GMT-0700 (Pacific Daylight Time)">16:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell"><a href="https://matrix.to/#/%40shuyuguo%3Amatrix.org">@shu</a> VC link is up now</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Mon Jul 29 2024 09:19:27 GMT-0700 (Pacific Daylight Time)">16:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">we have to sign into webex?</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Mon Jul 29 2024 09:19:44 GMT-0700 (Pacific Daylight Time)">16:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@softwarechris:matrix.org">Chris de Almeida</span>&gt;</div></td><td class="msg-cell"> * Draft schedule is up:
<a href="https://github.com/tc39/Reflector/issues/536">https://github.com/tc39/Reflector/issues/536</a></td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Mon Jul 29 2024 09:19:51 GMT-0700 (Pacific Daylight Time)">16:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@softwarechris:matrix.org">Chris de Almeida</span>&gt;</div></td><td class="msg-cell">no</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Mon Jul 29 2024 09:21:06 GMT-0700 (Pacific Daylight Time)">16:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">oh i see. the screen saying sign in with existing account got me 😄</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Mon Jul 29 2024 09:22:55 GMT-0700 (Pacific Daylight Time)">16:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@softwarechris:matrix.org">Chris de Almeida</span>&gt;</div></td><td class="msg-cell">and you don't have to use the app either -- you can use browser </td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Mon Jul 29 2024 09:48:45 GMT-0700 (Pacific Daylight Time)">16:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@robpalme:matrix.org">Rob Palmer</span>&gt;</div></td><td class="msg-cell">The meeting will begin in 11 minutes.  There are seven of us in the call now.</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Mon Jul 29 2024 09:48:58 GMT-0700 (Pacific Daylight Time)">16:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@akirose:matrix.org">Aki</span>&gt;</div></td><td class="msg-cell">i'm here! hi!</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Mon Jul 29 2024 09:49:09 GMT-0700 (Pacific Daylight Time)">16:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@akirose:matrix.org">Aki</span>&gt;</div></td><td class="msg-cell">i'm in the self-imposed lobby bc i'm on the phone</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Mon Jul 29 2024 09:49:43 GMT-0700 (Pacific Daylight Time)">16:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@robpalme:matrix.org">Rob Palmer</span>&gt;</div></td><td class="msg-cell">Is the lobby music good?  Do you need any any help progressing?</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Mon Jul 29 2024 09:50:17 GMT-0700 (Pacific Daylight Time)">16:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@akirose:matrix.org">Aki</span>&gt;</div></td><td class="msg-cell">lol thank you webex, i noticed: <a href="https://snaps.akiro.se/2407_ua0hr.jpg">https://snaps.akiro.se/2407_ua0hr.jpg</a></td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Mon Jul 29 2024 09:50:59 GMT-0700 (Pacific Daylight Time)">16:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">could just have the meeting in the lobby</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Mon Jul 29 2024 09:57:11 GMT-0700 (Pacific Daylight Time)">16:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@robpalme:matrix.org">Rob Palmer</span>&gt;</div></td><td class="msg-cell">3 minutes... encounting</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Mon Jul 29 2024 09:57:46 GMT-0700 (Pacific Daylight Time)">16:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@akirose:matrix.org">Aki</span>&gt;</div></td><td class="msg-cell"><em>encounting</em> ?</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Mon Jul 29 2024 09:58:53 GMT-0700 (Pacific Daylight Time)">16:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@robpalme:matrix.org">Rob Palmer</span>&gt;</div></td><td class="msg-cell">(I will find you the relevant movie clip soon)</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Mon Jul 29 2024 10:03:41 GMT-0700 (Pacific Daylight Time)">17:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">rob you're roboting a lot</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Mon Jul 29 2024 10:04:34 GMT-0700 (Pacific Daylight Time)">17:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell"> maybe turn your video off?</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Mon Jul 29 2024 10:10:18 GMT-0700 (Pacific Daylight Time)">17:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@robpalme:matrix.org">Rob Palmer</span>&gt;</div></td><td class="msg-cell">I am getting a new router delivered tomorrow.</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Mon Jul 29 2024 10:17:09 GMT-0700 (Pacific Daylight Time)">17:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">my webex cuts out for like 5s every 2 mins or so</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Mon Jul 29 2024 10:17:22 GMT-0700 (Pacific Daylight Time)">17:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">i wonder if it's a web version problem or a corp wifi problem...</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Mon Jul 29 2024 10:17:23 GMT-0700 (Pacific Daylight Time)">17:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@jkup:matrix.org">jkup</span>&gt;</div></td><td class="msg-cell">Wow 4 new members 🚀</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Mon Jul 29 2024 10:18:33 GMT-0700 (Pacific Daylight Time)">17:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">i think its a web version problem</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Mon Jul 29 2024 10:20:05 GMT-0700 (Pacific Daylight Time)">17:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">i don't want to install the native client but all right</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Mon Jul 29 2024 10:40:35 GMT-0700 (Pacific Daylight Time)">17:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@kriskowal:aelf.land">kriskowal</span>&gt;</div></td><td class="msg-cell">But we can say, Welcome Back <em>Editor</em> Ben.</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Mon Jul 29 2024 10:41:07 GMT-0700 (Pacific Daylight Time)">17:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">Chip had me in the first half</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Mon Jul 29 2024 10:41:31 GMT-0700 (Pacific Daylight Time)">17:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">i got a new coin you gotta hear about then</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Mon Jul 29 2024 10:52:33 GMT-0700 (Pacific Daylight Time)">17:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">fomo</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Mon Jul 29 2024 10:54:52 GMT-0700 (Pacific Daylight Time)">17:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">I wanted to say something funny but my mic is not working</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Mon Jul 29 2024 10:54:57 GMT-0700 (Pacific Daylight Time)">17:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">Thanks everybody!</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Mon Jul 29 2024 10:55:15 GMT-0700 (Pacific Daylight Time)">17:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">Somebody say that I say thanks :P</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Mon Jul 29 2024 11:13:11 GMT-0700 (Pacific Daylight Time)">18:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@peetk:matrix.org">peetk</span>&gt;</div></td><td class="msg-cell">should there be a <code>String.prototype.chars</code> for when you really do want to iterate over a string's characters</td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Mon Jul 29 2024 11:13:52 GMT-0700 (Pacific Daylight Time)">18:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">"characters" is a wildly overloaded term</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Mon Jul 29 2024 11:14:05 GMT-0700 (Pacific Daylight Time)">18:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">there should be a <code>String.prototype.codepoints</code> to iterate over a string's codepoints</td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Mon Jul 29 2024 11:14:24 GMT-0700 (Pacific Daylight Time)">18:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">I'm less convinced of a <code>.graphemes</code> because that's a 402 thing but it could perhaps be done</td></tr>
  <tr class="msg" id="L35"><td class="ts-cell"><a class="ts" href="#L35" alt="Mon Jul 29 2024 11:14:51 GMT-0700 (Pacific Daylight Time)">18:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">I am not sure there's any use cases for a <code>.codeunits</code> but if you have a strong use case that could be done as well</td></tr>
  <tr class="msg" id="L36"><td class="ts-cell"><a class="ts" href="#L36" alt="Mon Jul 29 2024 11:15:09 GMT-0700 (Pacific Daylight Time)">18:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">my brain assumed it would be <code>.values</code></td></tr>
  <tr class="msg" id="L37"><td class="ts-cell"><a class="ts" href="#L37" alt="Mon Jul 29 2024 11:15:27 GMT-0700 (Pacific Daylight Time)">18:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">but i guess Symbol.iterator is a better way to spell that</td></tr>
  <tr class="msg" id="L38"><td class="ts-cell"><a class="ts" href="#L38" alt="Mon Jul 29 2024 11:16:58 GMT-0700 (Pacific Daylight Time)">18:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@peetk:matrix.org">peetk</span>&gt;</div></td><td class="msg-cell">yea mb i meant codepoints</td></tr>
  <tr class="msg" id="L39"><td class="ts-cell"><a class="ts" href="#L39" alt="Mon Jul 29 2024 11:24:27 GMT-0700 (Pacific Daylight Time)">18:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">My mic keeps not working in webex even with different browsers and after rebooting 😭</td></tr>
  <tr class="msg" id="L40"><td class="ts-cell"><a class="ts" href="#L40" alt="Mon Jul 29 2024 11:28:04 GMT-0700 (Pacific Daylight Time)">18:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">Oh it works on my ipad</td></tr>
  <tr class="msg" id="L41"><td class="ts-cell"><a class="ts" href="#L41" alt="Mon Jul 29 2024 11:28:06 GMT-0700 (Pacific Daylight Time)">18:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">Good</td></tr>
  <tr class="msg" id="L42"><td class="ts-cell"><a class="ts" href="#L42" alt="Mon Jul 29 2024 11:28:44 GMT-0700 (Pacific Daylight Time)">18:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">When we decide that we want to change the behavior of spec operations like <code>toFixed</code> do we comment or rename them to say that they're legacy?</td></tr>
  <tr class="msg" id="L43"><td class="ts-cell"><a class="ts" href="#L43" alt="Mon Jul 29 2024 11:29:47 GMT-0700 (Pacific Daylight Time)">18:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">If we don't, would it be worthwhile to do that so we don't accidentally slip in new uses in the future? Or we could have a spec linter rule, idk if such a tool exists?</td></tr>
  <tr class="msg" id="L44"><td class="ts-cell"><a class="ts" href="#L44" alt="Mon Jul 29 2024 11:30:33 GMT-0700 (Pacific Daylight Time)">18:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">yeah, probably we should rename the existing ones and add new stricter ones</td></tr>
  <tr class="msg" id="L45"><td class="ts-cell"><a class="ts" href="#L45" alt="Mon Jul 29 2024 11:30:42 GMT-0700 (Pacific Daylight Time)">18:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">or add a "looseness" parameter, I guess</td></tr>
  <tr class="msg" id="L46"><td class="ts-cell"><a class="ts" href="#L46" alt="Mon Jul 29 2024 11:32:10 GMT-0700 (Pacific Daylight Time)">18:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">Are there other changes that we would make to Temporal if we wanted to apply all the conventions?</td></tr>
  <tr class="msg" id="L47"><td class="ts-cell"><a class="ts" href="#L47" alt="Mon Jul 29 2024 11:32:21 GMT-0700 (Pacific Daylight Time)">18:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">not doing any coercions at all :)</td></tr>
  <tr class="msg" id="L48"><td class="ts-cell"><a class="ts" href="#L48" alt="Mon Jul 29 2024 11:32:29 GMT-0700 (Pacific Daylight Time)">18:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">which would save a lot of tests, among other things</td></tr>
  <tr class="msg" id="L49"><td class="ts-cell"><a class="ts" href="#L49" alt="Mon Jul 29 2024 11:32:44 GMT-0700 (Pacific Daylight Time)">18:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">I meant for the conventions that we already adopted</td></tr>
  <tr class="msg" id="L50"><td class="ts-cell"><a class="ts" href="#L50" alt="Mon Jul 29 2024 11:32:56 GMT-0700 (Pacific Daylight Time)">18:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">we already adopted "don't do any coercions"</td></tr>
  <tr class="msg" id="L51"><td class="ts-cell"><a class="ts" href="#L51" alt="Mon Jul 29 2024 11:33:03 GMT-0700 (Pacific Daylight Time)">18:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">Oh right</td></tr>
  <tr class="msg" id="L52"><td class="ts-cell"><a class="ts" href="#L52" alt="Mon Jul 29 2024 11:33:19 GMT-0700 (Pacific Daylight Time)">18:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">I am in favor of applying this to Temporal</td></tr>
  <tr class="msg" id="L53"><td class="ts-cell"><a class="ts" href="#L53" alt="Mon Jul 29 2024 11:34:08 GMT-0700 (Pacific Daylight Time)">18:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">I think it is much more likely that we can apply this change to 402.</td></tr>
  <tr class="msg" id="L54"><td class="ts-cell"><a class="ts" href="#L54" alt="Mon Jul 29 2024 11:34:22 GMT-0700 (Pacific Daylight Time)">18:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">We aren’t talking about 262 overall, just those three methods</td></tr>
  <tr class="msg" id="L55"><td class="ts-cell"><a class="ts" href="#L55" alt="Mon Jul 29 2024 11:35:27 GMT-0700 (Pacific Daylight Time)">18:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@pchimento:igalia.com">ptomato</span>&gt;</div></td><td class="msg-cell">FWIW for Temporal.Duration we already rejected non-integral inputs because of people putting in values like <code>Temporal.Duration.from({ hours: 1.5 })</code></td></tr>
  <tr class="msg" id="L56"><td class="ts-cell"><a class="ts" href="#L56" alt="Mon Jul 29 2024 11:37:28 GMT-0700 (Pacific Daylight Time)">18:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@pchimento:igalia.com">ptomato</span>&gt;</div></td><td class="msg-cell">I'm open to going back and changing other things like <code>roundingIncrement</code>, <code>fractionalSecondDigits</code>, and <code>Temporal.PlainDate.from({ year: 2024.5, month: 7.5, day: 29.5 })</code> to reject non-integral inputs but I'd like us to explicitly approve that now, rather than me coming back to a following meeting with a PR</td></tr>
  <tr class="msg" id="L57"><td class="ts-cell"><a class="ts" href="#L57" alt="Mon Jul 29 2024 11:38:23 GMT-0700 (Pacific Daylight Time)">18:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I'm open to going back and changing other things like <code>roundingIncrement</code>, <code>fractionalSecondDigits</code>, and <code>Temporal.PlainDate.from({ year: 2024.5, month: 7.5, day: 29.5 })</code> to reject non-integral inputs but I'd like us to explicitly approve that now, rather than me coming back to a following meeting with a PR</blockquote></mx-reply>What about the other conventions?</td></tr>
  <tr class="msg" id="L58"><td class="ts-cell"><a class="ts" href="#L58" alt="Mon Jul 29 2024 11:38:54 GMT-0700 (Pacific Daylight Time)">18:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@pchimento:igalia.com">ptomato</span>&gt;</div></td><td class="msg-cell">I don't know off the top of my head how much deviation there is from the other conventions, I'd have to check</td></tr>
  <tr class="msg" id="L59"><td class="ts-cell"><a class="ts" href="#L59" alt="Mon Jul 29 2024 11:39:14 GMT-0700 (Pacific Daylight Time)">18:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">IMO, it makes sense that year, month, and day require integral inputs, but not hour/minute/second. Given one of the goals of Temporal is to make date and time math easier, not being able to write <code>Temporal.Duration.from({ hours: 1.5 })</code> is unfortunate.</td></tr>
  <tr class="msg" id="L60"><td class="ts-cell"><a class="ts" href="#L60" alt="Mon Jul 29 2024 11:41:25 GMT-0700 (Pacific Daylight Time)">18:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@pchimento:igalia.com">ptomato</span>&gt;</div></td><td class="msg-cell">should <code>Temporal.Duration.from({ hours: 1.15 })</code> be 1.15 hours or 1.1499999999999999112 hours? those are distinct nanosecond values</td></tr>
  <tr class="msg" id="L61"><td class="ts-cell"><a class="ts" href="#L61" alt="Mon Jul 29 2024 11:41:57 GMT-0700 (Pacific Daylight Time)">18:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> What about the other conventions?</blockquote></mx-reply>Are there any? Other than the new strings-aren't-iterable one I guess. <a href="https://github.com/tc39/how-we-work/blob/main/normative-conventions.md">https://github.com/tc39/how-we-work/blob/main/normative-conventions.md</a></td></tr>
  <tr class="msg" id="L62"><td class="ts-cell"><a class="ts" href="#L62" alt="Mon Jul 29 2024 11:42:46 GMT-0700 (Pacific Daylight Time)">18:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">Well I was wondering if ptomato had an opinion on the “not coercing at all” one with respect to Temporal</td></tr>
  <tr class="msg" id="L63"><td class="ts-cell"><a class="ts" href="#L63" alt="Mon Jul 29 2024 11:43:05 GMT-0700 (Pacific Daylight Time)">18:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I regularly want to be able to easily scale a duration to implement backoff, and there's already no convenient way to scale a fixed duration (e.g., hours and smaller). </td></tr>
  <tr class="msg" id="L64"><td class="ts-cell"><a class="ts" href="#L64" alt="Mon Jul 29 2024 11:44:11 GMT-0700 (Pacific Daylight Time)">18:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@pchimento:igalia.com">ptomato</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Well I was wondering if ptomato had an opinion on the “not coercing at all” one with respect to Temporal</blockquote></mx-reply>I don't have much of an opinion, but what I don't want is to have to come back to the next meeting with a PR</td></tr>
  <tr class="msg" id="L65"><td class="ts-cell"><a class="ts" href="#L65" alt="Mon Jul 29 2024 11:45:32 GMT-0700 (Pacific Daylight Time)">18:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I don't have much of an opinion, but what I don't want is to have to come back to the next meeting with a PR</blockquote></mx-reply>I agree, we should be able to agree on the conclusion in principle and then you should just be able to land it with some async review</td></tr>
  <tr class="msg" id="L66"><td class="ts-cell"><a class="ts" href="#L66" alt="Mon Jul 29 2024 11:45:36 GMT-0700 (Pacific Daylight Time)">18:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">for backoff I'm more likely to convert a <code>Duration</code> input into ms or ns via <code>total</code> and just work with the single unit that I can scale appropriately.</td></tr>
  <tr class="msg" id="L67"><td class="ts-cell"><a class="ts" href="#L67" alt="Mon Jul 29 2024 11:46:16 GMT-0700 (Pacific Daylight Time)">18:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">Rbuckton: you are making a very different feature request from this coercion discussion. Probably this is best for the temporal v2 bucket</td></tr>
  <tr class="msg" id="L68"><td class="ts-cell"><a class="ts" href="#L68" alt="Mon Jul 29 2024 11:47:05 GMT-0700 (Pacific Daylight Time)">18:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@pchimento:igalia.com">ptomato</span>&gt;</div></td><td class="msg-cell"><span class="nick-15">rbuckton</span>: we considered a <code>Temporal.Duration.prototype.multiply</code> at one point but decided it was out of scope. if you have an idea for how it should work, could you open an issue on <a href="https://github.com/js-temporal/proposal-temporal-v2/">https://github.com/js-temporal/proposal-temporal-v2/</a>? I think the use case would be helpful</td></tr>
  <tr class="msg" id="L69"><td class="ts-cell"><a class="ts" href="#L69" alt="Mon Jul 29 2024 11:47:35 GMT-0700 (Pacific Daylight Time)">18:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Rbuckton: you are making a very different feature request from this coercion discussion. Probably this is best for the temporal v2 bucket</blockquote></mx-reply>Perhaps. It started as commentary related to the statement that Temporal rejects non-integral values.</td></tr>
  <tr class="msg" id="L70"><td class="ts-cell"><a class="ts" href="#L70" alt="Mon Jul 29 2024 11:48:11 GMT-0700 (Pacific Daylight Time)">18:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@pchimento:igalia.com">ptomato</span>&gt;</div></td><td class="msg-cell">oh actually we already have one: <a href="https://github.com/js-temporal/proposal-temporal-v2/issues/7">https://github.com/js-temporal/proposal-temporal-v2/issues/7</a></td></tr>
  <tr class="msg" id="L71"><td class="ts-cell"><a class="ts" href="#L71" alt="Mon Jul 29 2024 11:51:38 GMT-0700 (Pacific Daylight Time)">18:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><span class="nick-10">littledan</span> <span class="nick-13">ptomato</span> this meeting has some extra time if you want to put together a last-minute item for dropping coercion from temporal, though it is very far past the deadline so it would need to be conditional approval</td></tr>
  <tr class="msg" id="L72"><td class="ts-cell"><a class="ts" href="#L72" alt="Mon Jul 29 2024 11:55:15 GMT-0700 (Pacific Daylight Time)">18:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">Why not stage 4 today for import attributes?</td></tr>
  <tr class="msg" id="L73"><td class="ts-cell"><a class="ts" href="#L73" alt="Mon Jul 29 2024 11:55:47 GMT-0700 (Pacific Daylight Time)">18:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <span class="nick-10">littledan</span> <span class="nick-13">ptomato</span> this meeting has some extra time if you want to put together a last-minute item for dropping coercion from temporal, though it is very far past the deadline so it would need to be conditional approval</blockquote></mx-reply>Conditional on what?</td></tr>
  <tr class="msg" id="L74"><td class="ts-cell"><a class="ts" href="#L74" alt="Mon Jul 29 2024 11:57:06 GMT-0700 (Pacific Daylight Time)">18:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">no one subsequently raising an objection at the next meeting once they'd had time to review, I guess</td></tr>
  <tr class="msg" id="L75"><td class="ts-cell"><a class="ts" href="#L75" alt="Mon Jul 29 2024 11:58:09 GMT-0700 (Pacific Daylight Time)">18:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell"><span class="nick-10">waldemar</span>: what's the issue with the spec text?</td></tr>
  <tr class="msg" id="L76"><td class="ts-cell"><a class="ts" href="#L76" alt="Mon Jul 29 2024 11:58:27 GMT-0700 (Pacific Daylight Time)">18:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">OK, this is a different way of using conditional advancement than we usually do, which is more about conditions which can be met async</td></tr>
  <tr class="msg" id="L77"><td class="ts-cell"><a class="ts" href="#L77" alt="Mon Jul 29 2024 13:01:07 GMT-0700 (Pacific Daylight Time)">20:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@benallen:igalia.com">Ben</span>&gt;</div></td><td class="msg-cell">I'm having trouble with my microphone,  but I'll get in on notes again</td></tr>
  <tr class="msg" id="L78"><td class="ts-cell"><a class="ts" href="#L78" alt="Mon Jul 29 2024 13:03:36 GMT-0700 (Pacific Daylight Time)">20:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@saminahusain:matrix.org">saminahusain</span>&gt;</div></td><td class="msg-cell">Hat's are still available</td></tr>
  <tr class="msg" id="L79"><td class="ts-cell"><a class="ts" href="#L79" alt="Mon Jul 29 2024 13:03:42 GMT-0700 (Pacific Daylight Time)">20:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">I can help in 5ish min</td></tr>
  <tr class="msg" id="L80"><td class="ts-cell"><a class="ts" href="#L80" alt="Mon Jul 29 2024 13:04:52 GMT-0700 (Pacific Daylight Time)">20:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@abotella:igalia.com">Andreu Botella</span>&gt;</div></td><td class="msg-cell">I can help until AsyncContext</td></tr>
  <tr class="msg" id="L81"><td class="ts-cell"><a class="ts" href="#L81" alt="Mon Jul 29 2024 13:07:35 GMT-0700 (Pacific Daylight Time)">20:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@legendecas:matrix.org">Chengzhong Wu</span>&gt;</div></td><td class="msg-cell">How can I register for one? 🤠</td></tr>
  <tr class="msg" id="L82"><td class="ts-cell"><a class="ts" href="#L82" alt="Mon Jul 29 2024 13:08:35 GMT-0700 (Pacific Daylight Time)">20:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">I don't recall a linearity consensus</td></tr>
  <tr class="msg" id="L83"><td class="ts-cell"><a class="ts" href="#L83" alt="Mon Jul 29 2024 13:08:44 GMT-0700 (Pacific Daylight Time)">20:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">monotonicity only, which is what we have</td></tr>
  <tr class="msg" id="L84"><td class="ts-cell"><a class="ts" href="#L84" alt="Mon Jul 29 2024 13:10:48 GMT-0700 (Pacific Daylight Time)">20:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">I thought exponential backoff was waiting longer and longer (I don't have background in this area)</td></tr>
  <tr class="msg" id="L85"><td class="ts-cell"><a class="ts" href="#L85" alt="Mon Jul 29 2024 13:11:09 GMT-0700 (Pacific Daylight Time)">20:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">I also thought the same, <del>but wikipedia clearly shows it's the other way around</del></td></tr>
  <tr class="msg" id="L86"><td class="ts-cell"><a class="ts" href="#L86" alt="Mon Jul 29 2024 13:11:20 GMT-0700 (Pacific Daylight Time)">20:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">depends on what you're talking about</td></tr>
  <tr class="msg" id="L87"><td class="ts-cell"><a class="ts" href="#L87" alt="Mon Jul 29 2024 13:11:24 GMT-0700 (Pacific Daylight Time)">20:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">For some reason I always assumed that pause was monotonically increasing, and not monotonically decreasing</td></tr>
  <tr class="msg" id="L88"><td class="ts-cell"><a class="ts" href="#L88" alt="Mon Jul 29 2024 13:11:28 GMT-0700 (Pacific Daylight Time)">20:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">in this case it gets shorter and shorter until falling back to the slow path</td></tr>
  <tr class="msg" id="L89"><td class="ts-cell"><a class="ts" href="#L89" alt="Mon Jul 29 2024 13:11:45 GMT-0700 (Pacific Daylight Time)">20:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@softwarechris:matrix.org">Chris de Almeida</span>&gt;</div></td><td class="msg-cell"><blockquote>
<p>SYG: Okay, understood, I would document that, that the input number is intended to increase linearly.</p>
</blockquote>
</td></tr>
  <tr class="msg" id="L90"><td class="ts-cell"><a class="ts" href="#L90" alt="Mon Jul 29 2024 13:12:32 GMT-0700 (Pacific Daylight Time)">20:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">wait, that's still not talking about the relationship</td></tr>
  <tr class="msg" id="L91"><td class="ts-cell"><a class="ts" href="#L91" alt="Mon Jul 29 2024 13:12:55 GMT-0700 (Pacific Daylight Time)">20:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">yes the input can increase linearly, but that doesn't mean it is linearly proportional to the time waited</td></tr>
  <tr class="msg" id="L92"><td class="ts-cell"><a class="ts" href="#L92" alt="Mon Jul 29 2024 13:15:04 GMT-0700 (Pacific Daylight Time)">20:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">saying "the spec is not intelligible" is not an effective way to communicate because it is very unspecific.</td></tr>
  <tr class="msg" id="L93"><td class="ts-cell"><a class="ts" href="#L93" alt="Mon Jul 29 2024 13:15:22 GMT-0700 (Pacific Daylight Time)">20:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">It would be better to separate the discussions of what <em>should</em> happen, from how we encode this in the words</td></tr>
  <tr class="msg" id="L94"><td class="ts-cell"><a class="ts" href="#L94" alt="Mon Jul 29 2024 13:15:37 GMT-0700 (Pacific Daylight Time)">20:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">also there is no editorial issue with the spec as far as I can tell</td></tr>
  <tr class="msg" id="L95"><td class="ts-cell"><a class="ts" href="#L95" alt="Mon Jul 29 2024 13:15:53 GMT-0700 (Pacific Daylight Time)">20:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">we were very careful with the phrasing in this proposal</td></tr>
  <tr class="msg" id="L96"><td class="ts-cell"><a class="ts" href="#L96" alt="Mon Jul 29 2024 13:17:12 GMT-0700 (Pacific Daylight Time)">20:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@robpalme:matrix.org">Rob Palmer</span>&gt;</div></td><td class="msg-cell">This is reminding me of the coffee <code>filter</code> in/out discussion in Nov 2019.  Folk are seeing the pause N from both sides.  Shu wants small N to mean a longer pause.</td></tr>
  <tr class="msg" id="L97"><td class="ts-cell"><a class="ts" href="#L97" alt="Mon Jul 29 2024 13:17:37 GMT-0700 (Pacific Daylight Time)">20:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@peetk:matrix.org">peetk</span>&gt;</div></td><td class="msg-cell">i agree with justin that note 3 does not say what shu was saying it should say</td></tr>
  <tr class="msg" id="L98"><td class="ts-cell"><a class="ts" href="#L98" alt="Mon Jul 29 2024 13:18:07 GMT-0700 (Pacific Daylight Time)">20:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> This is reminding me of the coffee <code>filter</code> in/out discussion in Nov 2019.  Folk are seeing the pause N from both sides.  Shu wants small N to mean a longer pause.</blockquote></mx-reply>the two discussions are being mixed together, the editorial and normative</td></tr>
  <tr class="msg" id="L99"><td class="ts-cell"><a class="ts" href="#L99" alt="Mon Jul 29 2024 13:18:10 GMT-0700 (Pacific Daylight Time)">20:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">note 1 literally says that this means a pause instruction on such architectures lol</td></tr>
  <tr class="msg" id="L100"><td class="ts-cell"><a class="ts" href="#L100" alt="Mon Jul 29 2024 13:18:14 GMT-0700 (Pacific Daylight Time)">20:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">so it is confusing; we need to separate and order them</td></tr>
  <tr class="msg" id="L101"><td class="ts-cell"><a class="ts" href="#L101" alt="Mon Jul 29 2024 13:20:11 GMT-0700 (Pacific Daylight Time)">20:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">My reading of step 2 is the opposite of what shu is saying, and it's not just the note being the opposite. Assuming that "a signal is sent" means "wait a little bit", for larger Ns it waits for a little bit more times</td></tr>
  <tr class="msg" id="L102"><td class="ts-cell"><a class="ts" href="#L102" alt="Mon Jul 29 2024 13:20:42 GMT-0700 (Pacific Daylight Time)">20:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">I am also confused by the wording, but let's first focus on, what <em>should</em> the thing do, and then we can fix/disambiguate the wording</td></tr>
  <tr class="msg" id="L103"><td class="ts-cell"><a class="ts" href="#L103" alt="Mon Jul 29 2024 13:21:15 GMT-0700 (Pacific Daylight Time)">20:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-13" title="@robpalme:matrix.org">Rob Palmer</span>&gt;</div></td><td class="msg-cell">I think we have agreement on the normative:  the pauses between spins get bigger and bigger before going to sleep.</td></tr>
  <tr class="msg" id="L104"><td class="ts-cell"><a class="ts" href="#L104" alt="Mon Jul 29 2024 13:21:29 GMT-0700 (Pacific Daylight Time)">20:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">no it was the opposite :)</td></tr>
  <tr class="msg" id="L105"><td class="ts-cell"><a class="ts" href="#L105" alt="Mon Jul 29 2024 13:21:30 GMT-0700 (Pacific Daylight Time)">20:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I think we have agreement on the normative:  the pauses between spins get bigger and bigger before going to sleep.</blockquote></mx-reply>Didn't Shu say the opposite?</td></tr>
  <tr class="msg" id="L106"><td class="ts-cell"><a class="ts" href="#L106" alt="Mon Jul 29 2024 13:21:43 GMT-0700 (Pacific Daylight Time)">20:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">also we don't have agreement; Justin is disagreeing on substance</td></tr>
  <tr class="msg" id="L107"><td class="ts-cell"><a class="ts" href="#L107" alt="Mon Jul 29 2024 13:22:44 GMT-0700 (Pacific Daylight Time)">20:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">what is it that Shu is proposing?</td></tr>
  <tr class="msg" id="L108"><td class="ts-cell"><a class="ts" href="#L108" alt="Mon Jul 29 2024 13:22:50 GMT-0700 (Pacific Daylight Time)">20:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@kriskowal:aelf.land">kriskowal</span>&gt;</div></td><td class="msg-cell">We must now decide whether to spin in session or yield to the agenda :P</td></tr>
  <tr class="msg" id="L109"><td class="ts-cell"><a class="ts" href="#L109" alt="Mon Jul 29 2024 13:23:02 GMT-0700 (Pacific Daylight Time)">20:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@kriskowal:aelf.land">kriskowal</span>&gt;</div></td><td class="msg-cell">Context switches are expensive</td></tr>
  <tr class="msg" id="L110"><td class="ts-cell"><a class="ts" href="#L110" alt="Mon Jul 29 2024 13:23:19 GMT-0700 (Pacific Daylight Time)">20:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">Having the smaller-i-longer-wait sematnics is fine with me if it’s really how other implemenations have done it.</td></tr>
  <tr class="msg" id="L111"><td class="ts-cell"><a class="ts" href="#L111" alt="Mon Jul 29 2024 13:23:35 GMT-0700 (Pacific Daylight Time)">20:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">pauses get bigger and smaller in mature implementations. ideally you want to have the behavior that kris explained, but implementations like linux for example also have a signal of "starvation" which can cause the delay to get longer as well.</td></tr>
  <tr class="msg" id="L112"><td class="ts-cell"><a class="ts" href="#L112" alt="Mon Jul 29 2024 13:23:42 GMT-0700 (Pacific Daylight Time)">20:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">The current semantics with reworded text and note would be fine with me.</td></tr>
  <tr class="msg" id="L113"><td class="ts-cell"><a class="ts" href="#L113" alt="Mon Jul 29 2024 13:24:11 GMT-0700 (Pacific Daylight Time)">20:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">The current semantics reads as the opposite of the current spec/note to me.</td></tr>
  <tr class="msg" id="L114"><td class="ts-cell"><a class="ts" href="#L114" alt="Mon Jul 29 2024 13:24:34 GMT-0700 (Pacific Daylight Time)">20:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@saminahusain:matrix.org">saminahusain</span>&gt;</div></td><td class="msg-cell">will you be in Tokyo? I will bring a bunch.</td></tr>
  <tr class="msg" id="L115"><td class="ts-cell"><a class="ts" href="#L115" alt="Mon Jul 29 2024 13:24:57 GMT-0700 (Pacific Daylight Time)">20:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> pauses get bigger and smaller in mature implementations. ideally you want to have the behavior that kris explained, but implementations like linux for example also have a signal of "starvation" which can cause the delay to get longer as well.</blockquote></mx-reply>yeah let's just not give this semantics</td></tr>
  <tr class="msg" id="L116"><td class="ts-cell"><a class="ts" href="#L116" alt="Mon Jul 29 2024 13:25:27 GMT-0700 (Pacific Daylight Time)">20:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">yeah i think it would be best if we simply don't constrain it</td></tr>
  <tr class="msg" id="L117"><td class="ts-cell"><a class="ts" href="#L117" alt="Mon Jul 29 2024 13:25:33 GMT-0700 (Pacific Daylight Time)">20:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">this will need an overflow item, there's too much overflow to get through it</td></tr>
  <tr class="msg" id="L118"><td class="ts-cell"><a class="ts" href="#L118" alt="Mon Jul 29 2024 13:25:36 GMT-0700 (Pacific Daylight Time)">20:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">we have a lot to say</td></tr>
  <tr class="msg" id="L119"><td class="ts-cell"><a class="ts" href="#L119" alt="Mon Jul 29 2024 13:26:27 GMT-0700 (Pacific Daylight Time)">20:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">if we don't give it semantics, then someone will ship (wlog) "longer iteration number is short wait", and then some application be written in such a way that depends on that behavior for performance, and now it is web-reality and can't be changed without negative performance impact</td></tr>
  <tr class="msg" id="L120"><td class="ts-cell"><a class="ts" href="#L120" alt="Mon Jul 29 2024 13:26:36 GMT-0700 (Pacific Daylight Time)">20:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">so I don't see much benefit from not giving it semantics</td></tr>
  <tr class="msg" id="L121"><td class="ts-cell"><a class="ts" href="#L121" alt="Mon Jul 29 2024 13:26:39 GMT-0700 (Pacific Daylight Time)">20:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">spin locks use the counter to make a determination as to whether you've been spinning often enough to justify a context switch/kernel transition. The counter is used to indicate frequency and sometimes introduce and reduce contention. not all counter values are guaranteed to pause in some implementations</td></tr>
  <tr class="msg" id="L122"><td class="ts-cell"><a class="ts" href="#L122" alt="Mon Jul 29 2024 13:26:49 GMT-0700 (Pacific Daylight Time)">20:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">I guess it allows implementations to give special behavior for specific scripts, which they do sometimes do, but... ugh</td></tr>
  <tr class="msg" id="L123"><td class="ts-cell"><a class="ts" href="#L123" alt="Mon Jul 29 2024 13:27:20 GMT-0700 (Pacific Daylight Time)">20:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">well, this is a lot like tuning GC</td></tr>
  <tr class="msg" id="L124"><td class="ts-cell"><a class="ts" href="#L124" alt="Mon Jul 29 2024 13:28:07 GMT-0700 (Pacific Daylight Time)">20:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Most spinlock/spinwait implementations are very handwavy on specifics because it's CPU architecture dependent</td></tr>
  <tr class="msg" id="L125"><td class="ts-cell"><a class="ts" href="#L125" alt="Mon Jul 29 2024 13:28:46 GMT-0700 (Pacific Daylight Time)">20:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@legendecas:matrix.org">Chengzhong Wu</span>&gt;</div></td><td class="msg-cell">Likely will be there, thanks!</td></tr>
  <tr class="msg" id="L126"><td class="ts-cell"><a class="ts" href="#L126" alt="Mon Jul 29 2024 13:32:06 GMT-0700 (Pacific Daylight Time)">20:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">iteration count is used more to determine <code>pause</code> request frequency, not how much time to wait.</td></tr>
  <tr class="msg" id="L127"><td class="ts-cell"><a class="ts" href="#L127" alt="Mon Jul 29 2024 13:34:27 GMT-0700 (Pacific Daylight Time)">20:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">If the iteration count is high and you're approaching a context switch, you want to wait less and less time to give the high-iteration spin a chance to attain the lock. But many spin wait operations will decide that it may only pause for any length of time when <code>iterationCount % 10 === 0</code> or <code>iterationCount % 100 === 0</code>, etc., and return immediately in other cases.</td></tr>
  <tr class="msg" id="L128"><td class="ts-cell"><a class="ts" href="#L128" alt="Mon Jul 29 2024 13:35:52 GMT-0700 (Pacific Daylight Time)">20:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">The purpose of the argument is indicate spin frequency and to not always pause.</td></tr>
  <tr class="msg" id="L129"><td class="ts-cell"><a class="ts" href="#L129" alt="Mon Jul 29 2024 13:37:05 GMT-0700 (Pacific Daylight Time)">20:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">i am just confused what there is to disagree on, there is literally no observable behavior</td></tr>
  <tr class="msg" id="L130"><td class="ts-cell"><a class="ts" href="#L130" alt="Mon Jul 29 2024 13:37:39 GMT-0700 (Pacific Daylight Time)">20:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> i am just confused what there is to disagree on, there is literally no observable behavior</blockquote></mx-reply>How is the number of signals related to the pause length in nanoseconds?</td></tr>
  <tr class="msg" id="L131"><td class="ts-cell"><a class="ts" href="#L131" alt="Mon Jul 29 2024 13:37:53 GMT-0700 (Pacific Daylight Time)">20:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">it's implementation-defined</td></tr>
  <tr class="msg" id="L132"><td class="ts-cell"><a class="ts" href="#L132" alt="Mon Jul 29 2024 13:38:27 GMT-0700 (Pacific Daylight Time)">20:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">My understanding of the concerns are that the spec text that is either over detailed, or uses the confusing terminology.</td></tr>
  <tr class="msg" id="L133"><td class="ts-cell"><a class="ts" href="#L133" alt="Mon Jul 29 2024 13:38:51 GMT-0700 (Pacific Daylight Time)">20:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">i will remove the text about the backoff and any particular relation between the pause length and the iterationNumber argument</td></tr>
  <tr class="msg" id="L134"><td class="ts-cell"><a class="ts" href="#L134" alt="Mon Jul 29 2024 13:39:28 GMT-0700 (Pacific Daylight Time)">20:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">there's another design constraint in play which waldemar and michael saboff seem to be saying: if there is no observable behavior, there should be no argument</td></tr>
  <tr class="msg" id="L135"><td class="ts-cell"><a class="ts" href="#L135" alt="Mon Jul 29 2024 13:39:54 GMT-0700 (Pacific Daylight Time)">20:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote>i will remove the text about the backoff and any particular relation between the pause length and the iterationNumber argument</blockquote></mx-reply>I think that’ll upset @msaboff ?</td></tr>
  <tr class="msg" id="L136"><td class="ts-cell"><a class="ts" href="#L136" alt="Mon Jul 29 2024 13:40:05 GMT-0700 (Pacific Daylight Time)">20:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell"><span class="nick-1">Justin Ridgewell</span>: how so?</td></tr>
  <tr class="msg" id="L137"><td class="ts-cell"><a class="ts" href="#L137" alt="Mon Jul 29 2024 13:40:17 GMT-0700 (Pacific Daylight Time)">20:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">he said JSC will likely ignore it, which is certainly fine</td></tr>
  <tr class="msg" id="L138"><td class="ts-cell"><a class="ts" href="#L138" alt="Mon Jul 29 2024 13:40:35 GMT-0700 (Pacific Daylight Time)">20:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">my personal intention is that until the code is in the optimizing JIT and inlined, it <em>is</em> ignored</td></tr>
  <tr class="msg" id="L139"><td class="ts-cell"><a class="ts" href="#L139" alt="Mon Jul 29 2024 13:40:47 GMT-0700 (Pacific Daylight Time)">20:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">His final statement was that if there’s no note, the param will just be ignored.</td></tr>
  <tr class="msg" id="L140"><td class="ts-cell"><a class="ts" href="#L140" alt="Mon Jul 29 2024 13:40:49 GMT-0700 (Pacific Daylight Time)">20:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> he said JSC will likely ignore it, which is certainly fine</blockquote></mx-reply>presumably it'd be better for the web if you can align on this...</td></tr>
  <tr class="msg" id="L141"><td class="ts-cell"><a class="ts" href="#L141" alt="Mon Jul 29 2024 13:41:02 GMT-0700 (Pacific Daylight Time)">20:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">i don't think i do...?</td></tr>
  <tr class="msg" id="L142"><td class="ts-cell"><a class="ts" href="#L142" alt="Mon Jul 29 2024 13:41:13 GMT-0700 (Pacific Daylight Time)">20:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">presumably JSC will do the right thing for M-chips</td></tr>
  <tr class="msg" id="L143"><td class="ts-cell"><a class="ts" href="#L143" alt="Mon Jul 29 2024 13:41:25 GMT-0700 (Pacific Daylight Time)">20:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">and V8 might do a more generic thing?</td></tr>
  <tr class="msg" id="L144"><td class="ts-cell"><a class="ts" href="#L144" alt="Mon Jul 29 2024 13:41:40 GMT-0700 (Pacific Daylight Time)">20:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">OK sure</td></tr>
  <tr class="msg" id="L145"><td class="ts-cell"><a class="ts" href="#L145" alt="Mon Jul 29 2024 13:42:04 GMT-0700 (Pacific Daylight Time)">20:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">but "just ignore it" doesn't sound like something tuned for M-chips; it sounds like not engaging with the question</td></tr>
  <tr class="msg" id="L146"><td class="ts-cell"><a class="ts" href="#L146" alt="Mon Jul 29 2024 13:42:27 GMT-0700 (Pacific Daylight Time)">20:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> but "just ignore it" doesn't sound like something tuned for M-chips; it sounds like not engaging with the question</blockquote></mx-reply>fair, but it's intended to be a hint</td></tr>
  <tr class="msg" id="L147"><td class="ts-cell"><a class="ts" href="#L147" alt="Mon Jul 29 2024 13:42:34 GMT-0700 (Pacific Daylight Time)">20:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">why would we try to align on how to interpret a hint?</td></tr>
  <tr class="msg" id="L148"><td class="ts-cell"><a class="ts" href="#L148" alt="Mon Jul 29 2024 13:42:39 GMT-0700 (Pacific Daylight Time)">20:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">it's supposed to give freedom to implementations!</td></tr>
  <tr class="msg" id="L149"><td class="ts-cell"><a class="ts" href="#L149" alt="Mon Jul 29 2024 13:42:47 GMT-0700 (Pacific Daylight Time)">20:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">(I don't know if this is actually implementable given the perf constraints)

What if instead of the iteration number we passed an object, and the engine internally counts how many times it sees that object? So that there is no possible expectation connected to "big number" vs "small number"</td></tr>
  <tr class="msg" id="L150"><td class="ts-cell"><a class="ts" href="#L150" alt="Mon Jul 29 2024 13:42:58 GMT-0700 (Pacific Daylight Time)">20:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">no thanks...</td></tr>
  <tr class="msg" id="L151"><td class="ts-cell"><a class="ts" href="#L151" alt="Mon Jul 29 2024 13:43:00 GMT-0700 (Pacific Daylight Time)">20:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@kriskowal:aelf.land">kriskowal</span>&gt;</div></td><td class="msg-cell">I approve of every possible steam (locomotive, motor) metaphor as we can cram into this language.</td></tr>
  <tr class="msg" id="L152"><td class="ts-cell"><a class="ts" href="#L152" alt="Mon Jul 29 2024 13:43:04 GMT-0700 (Pacific Daylight Time)">20:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> why would we try to align on how to interpret a hint?</blockquote></mx-reply>well, we'd want to align on, engines feeling like they can interpret this as a hint, rather than that it's just something to ignore</td></tr>
  <tr class="msg" id="L153"><td class="ts-cell"><a class="ts" href="#L153" alt="Mon Jul 29 2024 13:43:30 GMT-0700 (Pacific Daylight Time)">20:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> well, we'd want to align on, engines feeling like they can interpret this as a hint, rather than that it's just something to ignore</blockquote></mx-reply>yes, i agree. but ignoring is a valid interpretation of a hint, do we agree on that?</td></tr>
  <tr class="msg" id="L154"><td class="ts-cell"><a class="ts" href="#L154" alt="Mon Jul 29 2024 13:44:00 GMT-0700 (Pacific Daylight Time)">20:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">I assume the CPU architecture has some semantic meaning for the hint?</td></tr>
  <tr class="msg" id="L155"><td class="ts-cell"><a class="ts" href="#L155" alt="Mon Jul 29 2024 13:44:03 GMT-0700 (Pacific Daylight Time)">20:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">yes, it is valid, but I hope that JS engines can get past the philosophical disagreement that seems to exist right now and agree that this is a potentially usable hint if it makes sense for the architecture</td></tr>
  <tr class="msg" id="L156"><td class="ts-cell"><a class="ts" href="#L156" alt="Mon Jul 29 2024 13:44:17 GMT-0700 (Pacific Daylight Time)">20:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">We can tell engines to ignore it, but how do they map our hint’s intention to the arch’s intention?</td></tr>
  <tr class="msg" id="L157"><td class="ts-cell"><a class="ts" href="#L157" alt="Mon Jul 29 2024 13:44:22 GMT-0700 (Pacific Daylight Time)">20:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">since msaboff's statement was not about the architecture</td></tr>
  <tr class="msg" id="L158"><td class="ts-cell"><a class="ts" href="#L158" alt="Mon Jul 29 2024 13:44:40 GMT-0700 (Pacific Daylight Time)">20:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I assume the CPU architecture has some semantic meaning for the hint?</blockquote></mx-reply>not the CPU arch per se, more the VM</td></tr>
  <tr class="msg" id="L159"><td class="ts-cell"><a class="ts" href="#L159" alt="Mon Jul 29 2024 13:45:05 GMT-0700 (Pacific Daylight Time)">20:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><p><code>Atomics.pause</code> is purely a CPU architecture dependent operation. A conforming implementation is welcome to ignore <code>iterationCount</code> and return immediately if it so chooses, though that is the least efficient approach as it most likely results in thread starvation and does not improve contention.<br>An efficient implementation of <code>pause</code> will use the <code>iterationCount</code> to avoid thread starvation and optimize contention by <em>periodically</em> introducing an asm <code>pause</code> or similar instruction based on whatever information is relevant for that architecture. The main goal is to avoid spinning longer than you would have had to wait for a context switch/kernel transition. These optimizations can include, but are not limited to:</p>
<ul>
<li>Only <code>pausing</code> every <em>n</em> iterations</li>
<li>issuing a <code>pause</code> more or less frequently the longer we've been spinning</li>
<li>issuing a <code>pause</code> more or less frequently based on how frequently we've been spinning</li>
<li>issuing a <code>pause</code> more or less frequently as you approach an amount of time since you started spinning that would be equivalent to the time spent waiting for a context switch.</li>
</ul>
</td></tr>
  <tr class="msg" id="L160"><td class="ts-cell"><a class="ts" href="#L160" alt="Mon Jul 29 2024 13:46:06 GMT-0700 (Pacific Daylight Time)">20:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote><p><code>Atomics.pause</code> is purely a CPU architecture dependent operation. A conforming implementation is welcome to ignore <code>iterationCount</code> and return immediately if it so chooses, though that is the least efficient approach as it most likely results in thread starvation and does not improve contention.<br>An efficient implementation of <code>pause</code> will use the <code>iterationCount</code> to avoid thread starvation and optimize contention by <em>periodically</em> introducing an asm <code>pause</code> or similar instruction based on whatever information is relevant for that architecture. The main goal is to avoid spinning longer than you would have had to wait for a context switch/kernel transition. These optimizations can include, but are not limited to:</p>
<ul>
<li>Only <code>pausing</code> every <em>n</em> iterations</li>
<li>issuing a <code>pause</code> more or less frequently the longer we've been spinning</li>
<li>issuing a <code>pause</code> more or less frequently based on how frequently we've been spinning</li>
<li>issuing a <code>pause</code> more or less frequently as you approach an amount of time since you started spinning that would be equivalent to the time spent waiting for a context switch.</li>
</ul>
</blockquote></mx-reply>Is this the interpretation you’re proposing, or is this a written behavior somewhere?</td></tr>
  <tr class="msg" id="L161"><td class="ts-cell"><a class="ts" href="#L161" alt="Mon Jul 29 2024 13:46:07 GMT-0700 (Pacific Daylight Time)">20:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Most implementations of a <code>pause</code>-like method I've seen are heavily optimized based on OS, CPU Arch, runtime, clock speed, and other factors and as such can't be easily expressed in an algorithmic form.</td></tr>
  <tr class="msg" id="L162"><td class="ts-cell"><a class="ts" href="#L162" alt="Mon Jul 29 2024 13:46:41 GMT-0700 (Pacific Daylight Time)">20:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">This is my observation from looking at spin-wait mechanisms in several languages and runtimes.</td></tr>
  <tr class="msg" id="L163"><td class="ts-cell"><a class="ts" href="#L163" alt="Mon Jul 29 2024 13:46:52 GMT-0700 (Pacific Daylight Time)">20:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">This isn't precise copy that I would use in the spec.</td></tr>
  <tr class="msg" id="L164"><td class="ts-cell"><a class="ts" href="#L164" alt="Mon Jul 29 2024 13:47:33 GMT-0700 (Pacific Daylight Time)">20:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">This is more to argue that we should put a lot less into the algorithm steps and NOTEs than we currently are.</td></tr>
  <tr class="msg" id="L165"><td class="ts-cell"><a class="ts" href="#L165" alt="Mon Jul 29 2024 13:49:12 GMT-0700 (Pacific Daylight Time)">20:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell"><p>i think there are only two realistic options:</p>
<ol>
<li>drop the hint argument entirely</li>
<li>accept an integer as an hint and say it is implementation-defined how it is used to determine how long to pause</li>
</ol>
<p>i still think 2 is uncontroversial but clearly it <em>is</em> controversial but not in a way i understand how to make progress on</p>
</td></tr>
  <tr class="msg" id="L166"><td class="ts-cell"><a class="ts" href="#L166" alt="Mon Jul 29 2024 13:49:51 GMT-0700 (Pacific Daylight Time)">20:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">We should not drop the hint argument. </td></tr>
  <tr class="msg" id="L167"><td class="ts-cell"><a class="ts" href="#L167" alt="Mon Jul 29 2024 13:50:13 GMT-0700 (Pacific Daylight Time)">20:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">i think this would be a strictly worse API for its purpose if it dropped the hint argument, yes</td></tr>
  <tr class="msg" id="L168"><td class="ts-cell"><a class="ts" href="#L168" alt="Mon Jul 29 2024 13:51:27 GMT-0700 (Pacific Daylight Time)">20:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">Would Waldemar be satisifed with bigger-number-longer-wait? Then let the engine handle that to match the VM’s CPU instructions, eg smaller-number-longer-wait?</td></tr>
  <tr class="msg" id="L169"><td class="ts-cell"><a class="ts" href="#L169" alt="Mon Jul 29 2024 13:51:42 GMT-0700 (Pacific Daylight Time)">20:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">The simplest text would be something along the lines of: "An implementation can use the value of <code>iterationCount</code> as a hint to determine whether it is advisable to request the CPU pause for an extremely short period of time (TBD) to decrease contention and avoid an expensive context switch." I can look for something better though.</td></tr>
  <tr class="msg" id="L170"><td class="ts-cell"><a class="ts" href="#L170" alt="Mon Jul 29 2024 13:52:39 GMT-0700 (Pacific Daylight Time)">20:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Basically, (2) but with a few examples of what <code>iterationCount</code> could be used for and the time scale we are trying to avoid.</td></tr>
  <tr class="msg" id="L171"><td class="ts-cell"><a class="ts" href="#L171" alt="Mon Jul 29 2024 13:54:04 GMT-0700 (Pacific Daylight Time)">20:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Would Waldemar be satisifed with bigger-number-longer-wait? Then let the engine handle that to match the VM’s CPU instructions, eg smaller-number-longer-wait?</blockquote></mx-reply>would that question arise? if something is implementation-defined, you can object to implementation-defined, but it'd be odd to object to specific implementations</td></tr>
  <tr class="msg" id="L172"><td class="ts-cell"><a class="ts" href="#L172" alt="Mon Jul 29 2024 13:55:20 GMT-0700 (Pacific Daylight Time)">20:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">I am confused about why people don't like "semaphore" as the name for this</td></tr>
  <tr class="msg" id="L173"><td class="ts-cell"><a class="ts" href="#L173" alt="Mon Jul 29 2024 13:55:21 GMT-0700 (Pacific Daylight Time)">20:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">this is the obvious name</td></tr>
  <tr class="msg" id="L174"><td class="ts-cell"><a class="ts" href="#L174" alt="Mon Jul 29 2024 13:55:36 GMT-0700 (Pacific Daylight Time)">20:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I don't think "bigger-number-longer-wait" is correct, TBH.</td></tr>
  <tr class="msg" id="L175"><td class="ts-cell"><a class="ts" href="#L175" alt="Mon Jul 29 2024 13:55:40 GMT-0700 (Pacific Daylight Time)">20:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">everyone uses this name when independently implementing this exact API, which has happened many times</td></tr>
  <tr class="msg" id="L176"><td class="ts-cell"><a class="ts" href="#L176" alt="Mon Jul 29 2024 13:56:03 GMT-0700 (Pacific Daylight Time)">20:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">I think the implementation is still left to the engine, but the hint now has a known meaning. Whether it uses exponential/quadratic/etc, whether the CPU expect big or large numbers, is left for the implementation.</td></tr>
  <tr class="msg" id="L177"><td class="ts-cell"><a class="ts" href="#L177" alt="Mon Jul 29 2024 13:56:10 GMT-0700 (Pacific Daylight Time)">20:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><a href="https://www.npmjs.com/package/semaphore">https://www.npmjs.com/package/semaphore</a>
<a href="https://www.npmjs.com/package/@shopify/semaphore">https://www.npmjs.com/package/@shopify/semaphore</a>
<a href="https://www.npmjs.com/package/async-sema">https://www.npmjs.com/package/async-sema</a></td></tr>
  <tr class="msg" id="L178"><td class="ts-cell"><a class="ts" href="#L178" alt="Mon Jul 29 2024 13:56:13 GMT-0700 (Pacific Daylight Time)">20:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">I think just because "semaphore" is often used to mean "binary semaphore"</td></tr>
  <tr class="msg" id="L179"><td class="ts-cell"><a class="ts" href="#L179" alt="Mon Jul 29 2024 13:56:25 GMT-0700 (Pacific Daylight Time)">20:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">but yes I agree that the name makes sense, just trying to explain the confusion</td></tr>
  <tr class="msg" id="L180"><td class="ts-cell"><a class="ts" href="#L180" alt="Mon Jul 29 2024 13:57:29 GMT-0700 (Pacific Daylight Time)">20:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote>I don't think "bigger-number-longer-wait" is correct, TBH.</blockquote></mx-reply>It’s the most intuitive, and it’s how I’ve written async-retires before.</td></tr>
  <tr class="msg" id="L181"><td class="ts-cell"><a class="ts" href="#L181" alt="Mon Jul 29 2024 13:57:47 GMT-0700 (Pacific Daylight Time)">20:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">It may be helpful to put together links to spin wait implementations in other languages and to papers on spin waiting, contention, and cpu/task scheduling that are relevant.</td></tr>
  <tr class="msg" id="L182"><td class="ts-cell"><a class="ts" href="#L182" alt="Mon Jul 29 2024 13:57:57 GMT-0700 (Pacific Daylight Time)">20:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">I don’t know whether it matches CPU behavior.</td></tr>
  <tr class="msg" id="L183"><td class="ts-cell"><a class="ts" href="#L183" alt="Mon Jul 29 2024 13:57:59 GMT-0700 (Pacific Daylight Time)">20:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> It’s the most intuitive, and it’s how I’ve written async-retires before.</blockquote></mx-reply>This is not async retries, that is the wrong paradigm.</td></tr>
  <tr class="msg" id="L184"><td class="ts-cell"><a class="ts" href="#L184" alt="Mon Jul 29 2024 13:58:41 GMT-0700 (Pacific Daylight Time)">20:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">Sync retries sounds very similar to async retries…</td></tr>
  <tr class="msg" id="L185"><td class="ts-cell"><a class="ts" href="#L185" alt="Mon Jul 29 2024 14:00:24 GMT-0700 (Pacific Daylight Time)">21:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I think the implementation is still left to the engine, but the hint now has a known meaning. Whether it uses exponential/quadratic/etc, whether the CPU expect big or large numbers, is left for the implementation.</blockquote></mx-reply>it doesn't have a known meaning, that's why it's a hint</td></tr>
  <tr class="msg" id="L186"><td class="ts-cell"><a class="ts" href="#L186" alt="Mon Jul 29 2024 14:01:13 GMT-0700 (Pacific Daylight Time)">21:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">the meaning is basically, write this: <code>for (i; i &lt; spinCount; i++) { TryLock(); Atomics.pause(i); }</code>, and know the VM will do what it thinks best</td></tr>
  <tr class="msg" id="L187"><td class="ts-cell"><a class="ts" href="#L187" alt="Mon Jul 29 2024 14:01:43 GMT-0700 (Pacific Daylight Time)">21:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">I think if we're going to spec something bigger number longer wait is more intuitive. If you want the opposite you can just implement your spin lock in a countdown loop rather than a count up loop</td></tr>
  <tr class="msg" id="L188"><td class="ts-cell"><a class="ts" href="#L188" alt="Mon Jul 29 2024 14:01:56 GMT-0700 (Pacific Daylight Time)">21:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">do not think at a lower level, because the JS programmer has no control at that lower level given the multi-tiered execution, etc</td></tr>
  <tr class="msg" id="L189"><td class="ts-cell"><a class="ts" href="#L189" alt="Mon Jul 29 2024 14:02:18 GMT-0700 (Pacific Daylight Time)">21:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell"><span class="nick-6">keith_miller</span>: my proposal is to say nothing in the spec text. an implementation can simply choose to interpret it as "larger number is longer"</td></tr>
  <tr class="msg" id="L190"><td class="ts-cell"><a class="ts" href="#L190" alt="Mon Jul 29 2024 14:02:39 GMT-0700 (Pacific Daylight Time)">21:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">why do people want to specify a certain relationship between loop count and pauses</td></tr>
  <tr class="msg" id="L191"><td class="ts-cell"><a class="ts" href="#L191" alt="Mon Jul 29 2024 14:02:43 GMT-0700 (Pacific Daylight Time)">21:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">I think that's the worst outcome</td></tr>
  <tr class="msg" id="L192"><td class="ts-cell"><a class="ts" href="#L192" alt="Mon Jul 29 2024 14:03:05 GMT-0700 (Pacific Daylight Time)">21:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Sync retries sounds very similar to async retries…</blockquote></mx-reply>The purpose is more like this: "Ideally we shouldn't spin for longer than it would take for a context switch resulting from putting the thread to sleep or waking it up. To help avoid contention, we should periodically <code>pause</code> the thread to give another core an opportunity to perform the operation under contention. However, the closer we get to the amount of time it should have taken to put the thread to sleep, we should <code>pause</code> less frequently to aggressively avoid that threshold."<br>In some implementations, like .NET's <code>SpinWait</code>, once you reach a certain number of spins you trigger a <code>sleep(0)</code> or <code>sleep(1)</code>, which is a long wait, and then essentially restart as if the spin count was close to zero again.</td></tr>
  <tr class="msg" id="L193"><td class="ts-cell"><a class="ts" href="#L193" alt="Mon Jul 29 2024 14:03:11 GMT-0700 (Pacific Daylight Time)">21:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I think that's the worst outcome</blockquote></mx-reply>can you say more?</td></tr>
  <tr class="msg" id="L194"><td class="ts-cell"><a class="ts" href="#L194" alt="Mon Jul 29 2024 14:03:45 GMT-0700 (Pacific Daylight Time)">21:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">we don't specify pauses for GC; we just trust that engines will figure out a good policy</td></tr>
  <tr class="msg" id="L195"><td class="ts-cell"><a class="ts" href="#L195" alt="Mon Jul 29 2024 14:03:47 GMT-0700 (Pacific Daylight Time)">21:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">Then we could end up in a world where one implementation does longer waits as count goes up and others do shorter </td></tr>
  <tr class="msg" id="L196"><td class="ts-cell"><a class="ts" href="#L196" alt="Mon Jul 29 2024 14:04:17 GMT-0700 (Pacific Daylight Time)">21:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">that's good, the implementation should do whatever is best on the machine its running on.</td></tr>
  <tr class="msg" id="L197"><td class="ts-cell"><a class="ts" href="#L197" alt="Mon Jul 29 2024 14:04:19 GMT-0700 (Pacific Daylight Time)">21:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">So the "backoff" tends to be something like: short -&gt; shorter -&gt; shortest -&gt; long -&gt; short -&gt; shorter -&gt; shortest -&gt; etc.</td></tr>
  <tr class="msg" id="L198"><td class="ts-cell"><a class="ts" href="#L198" alt="Mon Jul 29 2024 14:04:42 GMT-0700 (Pacific Daylight Time)">21:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">With a number of "don't even wait at all" operations thrown into the mix.</td></tr>
  <tr class="msg" id="L199"><td class="ts-cell"><a class="ts" href="#L199" alt="Mon Jul 29 2024 14:04:59 GMT-0700 (Pacific Daylight Time)">21:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">That's perfectly acceptable. An implementation should choose the pause strategy that works best within its own requirements.</td></tr>
  <tr class="msg" id="L200"><td class="ts-cell"><a class="ts" href="#L200" alt="Mon Jul 29 2024 14:05:13 GMT-0700 (Pacific Daylight Time)">21:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">I guess my concern is that one workload wants longer and longer waits. And others want shorter and shorter waits</td></tr>
  <tr class="msg" id="L201"><td class="ts-cell"><a class="ts" href="#L201" alt="Mon Jul 29 2024 14:05:30 GMT-0700 (Pacific Daylight Time)">21:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">And there's no way to know as an implementation a priori which is better</td></tr>
  <tr class="msg" id="L202"><td class="ts-cell"><a class="ts" href="#L202" alt="Mon Jul 29 2024 14:05:43 GMT-0700 (Pacific Daylight Time)">21:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell"><span class="nick-6">keith_miller</span>: that's fair, and the concession is that you can't actually express that in JS code</td></tr>
  <tr class="msg" id="L203"><td class="ts-cell"><a class="ts" href="#L203" alt="Mon Jul 29 2024 14:05:53 GMT-0700 (Pacific Daylight Time)">21:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">because the call overhead is so high in the interpreter</td></tr>
  <tr class="msg" id="L204"><td class="ts-cell"><a class="ts" href="#L204" alt="Mon Jul 29 2024 14:06:04 GMT-0700 (Pacific Daylight Time)">21:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</div></td><td class="msg-cell"><span class="nick-6">ljharb</span> could you add yourself to the queue again?</td></tr>
  <tr class="msg" id="L205"><td class="ts-cell"><a class="ts" href="#L205" alt="Mon Jul 29 2024 14:06:08 GMT-0700 (Pacific Daylight Time)">21:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><span class="nick-8">shu</span>: I guess I agree that the actual API doesn't look like exactly like traditional semaphore but the way you use it is exactly the way you use a semaphore 99% of the time</td></tr>
  <tr class="msg" id="L206"><td class="ts-cell"><a class="ts" href="#L206" alt="Mon Jul 29 2024 14:06:11 GMT-0700 (Pacific Daylight Time)">21:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I guess my concern is that one workload wants longer and longer waits. And others want shorter and shorter waits</blockquote></mx-reply>That's not what you do with spin locking.</td></tr>
  <tr class="msg" id="L207"><td class="ts-cell"><a class="ts" href="#L207" alt="Mon Jul 29 2024 14:06:12 GMT-0700 (Pacific Daylight Time)">21:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">i don't think a user of the pause api would want that. that is a concern you have to express in cpu instructions, so js would be a poor choice for that code.</td></tr>
  <tr class="msg" id="L208"><td class="ts-cell"><a class="ts" href="#L208" alt="Mon Jul 29 2024 14:06:45 GMT-0700 (Pacific Daylight Time)">21:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">Then we should just not have anything passed by the JS users and the JS engine can infer the loop count if they <em>really</em> want to</td></tr>
  <tr class="msg" id="L209"><td class="ts-cell"><a class="ts" href="#L209" alt="Mon Jul 29 2024 14:06:50 GMT-0700 (Pacific Daylight Time)">21:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">If you want longer waits, you use a mutex/condvar or futex. Spin waiting generally should be as short as possible to avoid starvation and break contention.</td></tr>
  <tr class="msg" id="L210"><td class="ts-cell"><a class="ts" href="#L210" alt="Mon Jul 29 2024 14:07:07 GMT-0700 (Pacific Daylight Time)">21:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">If you want longer waits, you <code>sleep</code>, not <code>pause</code>.</td></tr>
  <tr class="msg" id="L211"><td class="ts-cell"><a class="ts" href="#L211" alt="Mon Jul 29 2024 14:07:50 GMT-0700 (Pacific Daylight Time)">21:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Then we should just not have anything passed by the JS users and the JS engine can infer the loop count if they <em>really</em> want to</blockquote></mx-reply>How is the JS engine supposed to know when you start spinning and are under contention when that is purely driven by user code?</td></tr>
  <tr class="msg" id="L212"><td class="ts-cell"><a class="ts" href="#L212" alt="Mon Jul 29 2024 14:08:16 GMT-0700 (Pacific Daylight Time)">21:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell"><span class="nick-2">bakkot</span>: the API as proposed currently is about governing rate limits, not a mutual exclusion building block. i understand conceptually the core mechanism is the same.</td></tr>
  <tr class="msg" id="L213"><td class="ts-cell"><a class="ts" href="#L213" alt="Mon Jul 29 2024 14:08:34 GMT-0700 (Pacific Daylight Time)">21:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">"Spin lock" is also the wrong terminology. This is a "spin wait" and is generally used to write lock-free code via compare-and-swap</td></tr>
  <tr class="msg" id="L214"><td class="ts-cell"><a class="ts" href="#L214" alt="Mon Jul 29 2024 14:08:44 GMT-0700 (Pacific Daylight Time)">21:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">if i were to propose a mutual exclusion Semaphore, i would not use this protocol</td></tr>
  <tr class="msg" id="L215"><td class="ts-cell"><a class="ts" href="#L215" alt="Mon Jul 29 2024 14:08:48 GMT-0700 (Pacific Daylight Time)">21:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">You can write a spin lock using <code>pause</code>, but that's not the goal.</td></tr>
  <tr class="msg" id="L216"><td class="ts-cell"><a class="ts" href="#L216" alt="Mon Jul 29 2024 14:09:01 GMT-0700 (Pacific Daylight Time)">21:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">it may be that because of this API mismatch, neither Semaphore-like APIs should get the simple name "Semaphore"</td></tr>
  <tr class="msg" id="L217"><td class="ts-cell"><a class="ts" href="#L217" alt="Mon Jul 29 2024 14:09:04 GMT-0700 (Pacific Daylight Time)">21:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@lucacasonato:matrix.org">Luca Casonato</span>&gt;</div></td><td class="msg-cell"><a href="https://docs.rs/tokio/latest/tokio/sync/struct.Semaphore.html">https://docs.rs/tokio/latest/tokio/sync/struct.Semaphore.html</a> &lt;- thing called semaphore in a non-js language, with a broadly similar api to our proposal. we will investigate other names though! :D</td></tr>
  <tr class="msg" id="L218"><td class="ts-cell"><a class="ts" href="#L218" alt="Mon Jul 29 2024 14:09:05 GMT-0700 (Pacific Daylight Time)">21:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">+1 on Stage 1</td></tr>
  <tr class="msg" id="L219"><td class="ts-cell"><a class="ts" href="#L219" alt="Mon Jul 29 2024 14:09:43 GMT-0700 (Pacific Daylight Time)">21:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">it can also be perhaps more simply resolved by just namespacing</td></tr>
  <tr class="msg" id="L220"><td class="ts-cell"><a class="ts" href="#L220" alt="Mon Jul 29 2024 14:09:55 GMT-0700 (Pacific Daylight Time)">21:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell"><code>Governor.Semaphore</code> vs <code>Locks.Sempahore</code> or <code>Atomics.Semaphore</code> or whatever</td></tr>
  <tr class="msg" id="L221"><td class="ts-cell"><a class="ts" href="#L221" alt="Mon Jul 29 2024 14:10:27 GMT-0700 (Pacific Daylight Time)">21:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">In esfx, I use <code>Semaphore</code> for the thread coordination primitive, and <code>AsyncSemaphore</code> for the async coordination (non multi-threaded) primitive, though <code>AsyncSemaphore</code> is still a simple coordination primitive and has now knowledge of async iteration.</td></tr>
  <tr class="msg" id="L222"><td class="ts-cell"><a class="ts" href="#L222" alt="Mon Jul 29 2024 14:10:32 GMT-0700 (Pacific Daylight Time)">21:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <a href="https://docs.rs/tokio/latest/tokio/sync/struct.Semaphore.html">https://docs.rs/tokio/latest/tokio/sync/struct.Semaphore.html</a> &lt;- thing called semaphore in a non-js language, with a broadly similar api to our proposal. we will investigate other names though! :D</blockquote></mx-reply>that thing's namespaced under <code>tokio::sync</code>, right?</td></tr>
  <tr class="msg" id="L223"><td class="ts-cell"><a class="ts" href="#L223" alt="Mon Jul 29 2024 14:11:04 GMT-0700 (Pacific Daylight Time)">21:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@lucacasonato:matrix.org">Luca Casonato</span>&gt;</div></td><td class="msg-cell">Yes!</td></tr>
  <tr class="msg" id="L224"><td class="ts-cell"><a class="ts" href="#L224" alt="Mon Jul 29 2024 14:11:18 GMT-0700 (Pacific Daylight Time)">21:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> In esfx, I use <code>Semaphore</code> for the thread coordination primitive, and <code>AsyncSemaphore</code> for the async coordination (non multi-threaded) primitive, though <code>AsyncSemaphore</code> is still a simple coordination primitive and has now knowledge of async iteration.</blockquote></mx-reply>(<code>Semaphore</code> as proposed wouldn't have knowledge of async iteration; async iteration would take a governor-protocol-implementing-thing, which <code>Semaphore</code> would be)</td></tr>
  <tr class="msg" id="L225"><td class="ts-cell"><a class="ts" href="#L225" alt="Mon Jul 29 2024 14:11:19 GMT-0700 (Pacific Daylight Time)">21:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">right, my objection is about this being a globally named <code>Semaphore</code></td></tr>
  <tr class="msg" id="L226"><td class="ts-cell"><a class="ts" href="#L226" alt="Mon Jul 29 2024 14:12:06 GMT-0700 (Pacific Daylight Time)">21:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><code>Governor.Semaphore</code> wfm if we have such a class though fwiw I don't think <code>Governor</code> needs to actually exist</td></tr>
  <tr class="msg" id="L227"><td class="ts-cell"><a class="ts" href="#L227" alt="Mon Jul 29 2024 14:12:55 GMT-0700 (Pacific Daylight Time)">21:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">Governor is just a protocol right? Like Thenable</td></tr>
  <tr class="msg" id="L228"><td class="ts-cell"><a class="ts" href="#L228" alt="Mon Jul 29 2024 14:13:03 GMT-0700 (Pacific Daylight Time)">21:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">right</td></tr>
  <tr class="msg" id="L229"><td class="ts-cell"><a class="ts" href="#L229" alt="Mon Jul 29 2024 14:13:12 GMT-0700 (Pacific Daylight Time)">21:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">but the proposal includes a class, also</td></tr>
  <tr class="msg" id="L230"><td class="ts-cell"><a class="ts" href="#L230" alt="Mon Jul 29 2024 14:13:12 GMT-0700 (Pacific Daylight Time)">21:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">for some reason</td></tr>
  <tr class="msg" id="L231"><td class="ts-cell"><a class="ts" href="#L231" alt="Mon Jul 29 2024 14:13:21 GMT-0700 (Pacific Daylight Time)">21:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@lucacasonato:matrix.org">Luca Casonato</span>&gt;</div></td><td class="msg-cell"><span class="nick-2">bakkot</span>: the helpers! :D</td></tr>
  <tr class="msg" id="L232"><td class="ts-cell"><a class="ts" href="#L232" alt="Mon Jul 29 2024 14:13:31 GMT-0700 (Pacific Daylight Time)">21:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <span class="nick-6">keith_miller</span>: that's fair, and the concession is that you can't actually express that in JS code</blockquote></mx-reply>Then the API should provide a mechanism for saying if you want the pauses to get longer and longer or shorter and shorter or we should just have nothing, IMO.</td></tr>
  <tr class="msg" id="L233"><td class="ts-cell"><a class="ts" href="#L233" alt="Mon Jul 29 2024 14:14:13 GMT-0700 (Pacific Daylight Time)">21:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">yeah I agree with Igalia that this stuff is a bit complicated, but investigating APIs during Stage 1 SGTM</td></tr>
  <tr class="msg" id="L234"><td class="ts-cell"><a class="ts" href="#L234" alt="Mon Jul 29 2024 14:14:14 GMT-0700 (Pacific Daylight Time)">21:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell"><span class="nick-6">keith_miller</span>: but it might not be a linear/superlinear relationship at all, like what Ron was saying with "wait every 10th iteration" or something</td></tr>
  <tr class="msg" id="L235"><td class="ts-cell"><a class="ts" href="#L235" alt="Mon Jul 29 2024 14:14:48 GMT-0700 (Pacific Daylight Time)">21:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell"><span class="nick-6">keith_miller</span>: can you articulate why an implementation-defined hint is the worst outcome?</td></tr>
  <tr class="msg" id="L236"><td class="ts-cell"><a class="ts" href="#L236" alt="Mon Jul 29 2024 14:14:54 GMT-0700 (Pacific Daylight Time)">21:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><a href="https://en.cppreference.com/w/cpp/thread/counting_semaphore">https://en.cppreference.com/w/cpp/thread/counting_semaphore</a>
<a href="https://learn.microsoft.com/en-us/dotnet/api/system.threading.semaphore?view=net-8.0">https://learn.microsoft.com/en-us/dotnet/api/system.threading.semaphore?view=net-8.0</a>
<a href="https://learn.microsoft.com/en-us/dotnet/api/system.threading.semaphoreslim?view=net-8.0">https://learn.microsoft.com/en-us/dotnet/api/system.threading.semaphoreslim?view=net-8.0</a>
<a href="https://docs.python.org/3/library/asyncio-sync.html#asyncio.Semaphore">https://docs.python.org/3/library/asyncio-sync.html#asyncio.Semaphore</a>
<a href="https://docs.python.org/3/library/asyncio-sync.html#boundedsemaphore">https://docs.python.org/3/library/asyncio-sync.html#boundedsemaphore</a>
<a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Semaphore.html">https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Semaphore.html</a>
<a href="https://esfx.js.org/esfx/api/threading-semaphore.html?tabs=ts">https://esfx.js.org/esfx/api/threading-semaphore.html?tabs=ts</a> (NOTE: my implementation, though not heavily used)
<a href="https://esfx.js.org/esfx/api/async-semaphore.html?tabs=ts">https://esfx.js.org/esfx/api/async-semaphore.html?tabs=ts</a> (NOTE: my implementation, though not heavily used)</td></tr>
  <tr class="msg" id="L237"><td class="ts-cell"><a class="ts" href="#L237" alt="Mon Jul 29 2024 14:15:52 GMT-0700 (Pacific Daylight Time)">21:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <span class="nick-6">keith_miller</span>: but it might not be a linear/superlinear relationship at all, like what Ron was saying with "wait every 10th iteration" or something</blockquote></mx-reply>Not linear. Here's .NET's version of <code>pause()</code> (MIT Licensed): <a href="https://github.com/dotnet/runtime/blob/4c58b5a5132cb089b23d32cafe3fcfa7e615a0da/src/libraries/System.Private.CoreLib/src/System/Threading/SpinWait.cs#L144">https://github.com/dotnet/runtime/blob/4c58b5a5132cb089b23d32cafe3fcfa7e615a0da/src/libraries/System.Private.CoreLib/src/System/Threading/SpinWait.cs#L144</a></td></tr>
  <tr class="msg" id="L238"><td class="ts-cell"><a class="ts" href="#L238" alt="Mon Jul 29 2024 14:16:38 GMT-0700 (Pacific Daylight Time)">21:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Also: <a href="https://github.com/dotnet/runtime/blob/040fde48a75f0c211353f073e4f69e2e31607752/src/coreclr/System.Private.CoreLib/src/System/Threading/Thread.CoreCLR.cs#L139">https://github.com/dotnet/runtime/blob/040fde48a75f0c211353f073e4f69e2e31607752/src/coreclr/System.Private.CoreLib/src/System/Threading/Thread.CoreCLR.cs#L139</a></td></tr>
  <tr class="msg" id="L239"><td class="ts-cell"><a class="ts" href="#L239" alt="Mon Jul 29 2024 14:16:59 GMT-0700 (Pacific Daylight Time)">21:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">to me a semaphore are those big flags the dude waves on the top of an aircraft carrier</td></tr>
  <tr class="msg" id="L240"><td class="ts-cell"><a class="ts" href="#L240" alt="Mon Jul 29 2024 14:17:41 GMT-0700 (Pacific Daylight Time)">21:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">like, a way to send messages/signals</td></tr>
  <tr class="msg" id="L241"><td class="ts-cell"><a class="ts" href="#L241" alt="Mon Jul 29 2024 14:18:39 GMT-0700 (Pacific Daylight Time)">21:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">From skimming that code it does <code>Thread.Yield();</code> so it doesn't provide a hint?</td></tr>
  <tr class="msg" id="L242"><td class="ts-cell"><a class="ts" href="#L242" alt="Mon Jul 29 2024 14:18:41 GMT-0700 (Pacific Daylight Time)">21:18</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> to me a semaphore are those big flags the dude waves on the top of an aircraft carrier</blockquote></mx-reply>That's pretty much the idea. A counting semaphore tracks how many concurrent users are allowed in and blocks new users from entering until someone leaves. You want in? I check the count and if you're allowed in I waive the flag to let you in, otherwise I waive the flag to tell you to stay put. When someone leaves, I waive the flag to let the next person in.</td></tr>
  <tr class="msg" id="L243"><td class="ts-cell"><a class="ts" href="#L243" alt="Mon Jul 29 2024 14:19:04 GMT-0700 (Pacific Daylight Time)">21:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <a href="https://en.cppreference.com/w/cpp/thread/counting_semaphore">https://en.cppreference.com/w/cpp/thread/counting_semaphore</a><br><a href="https://learn.microsoft.com/en-us/dotnet/api/system.threading.semaphore?view=net-8.0">https://learn.microsoft.com/en-us/dotnet/api/system.threading.semaphore?view=net-8.0</a><br><a href="https://learn.microsoft.com/en-us/dotnet/api/system.threading.semaphoreslim?view=net-8.0">https://learn.microsoft.com/en-us/dotnet/api/system.threading.semaphoreslim?view=net-8.0</a><br><a href="https://docs.python.org/3/library/asyncio-sync.html#asyncio.Semaphore">https://docs.python.org/3/library/asyncio-sync.html#asyncio.Semaphore</a><br><a href="https://docs.python.org/3/library/asyncio-sync.html#boundedsemaphore">https://docs.python.org/3/library/asyncio-sync.html#boundedsemaphore</a><br><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Semaphore.html">https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Semaphore.html</a><br><a href="https://esfx.js.org/esfx/api/threading-semaphore.html?tabs=ts">https://esfx.js.org/esfx/api/threading-semaphore.html?tabs=ts</a> (NOTE: my implementation, though not heavily used)<br><a href="https://esfx.js.org/esfx/api/async-semaphore.html?tabs=ts">https://esfx.js.org/esfx/api/async-semaphore.html?tabs=ts</a> (NOTE: my implementation, though not heavily used)</blockquote></mx-reply>Given this list, <code>Semaphore</code> really seems like the right name, though I'm fine with <code>CountingSemaphore</code> also. <span class="nick-8">shu</span> wdyt about this list?</td></tr>
  <tr class="msg" id="L244"><td class="ts-cell"><a class="ts" href="#L244" alt="Mon Jul 29 2024 14:19:34 GMT-0700 (Pacific Daylight Time)">21:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Given this list, <code>Semaphore</code> really seems like the right name, though I'm fine with <code>CountingSemaphore</code> also. <span class="nick-8">shu</span> wdyt about this list?</blockquote></mx-reply>i'll rephase my objection to that i will die on the hill of there being a global builtin named <code>Semaphore</code> that implements this symbol-based governor protocol</td></tr>
  <tr class="msg" id="L245"><td class="ts-cell"><a class="ts" href="#L245" alt="Mon Jul 29 2024 14:19:54 GMT-0700 (Pacific Daylight Time)">21:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">i do not object to using the name <code>Semaphore</code>, so long as it is clear that it is not the mutual exclusion building block semaphore</td></tr>
  <tr class="msg" id="L246"><td class="ts-cell"><a class="ts" href="#L246" alt="Mon Jul 29 2024 14:20:09 GMT-0700 (Pacific Daylight Time)">21:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">the protocol isn't symbol-based</td></tr>
  <tr class="msg" id="L247"><td class="ts-cell"><a class="ts" href="#L247" alt="Mon Jul 29 2024 14:20:11 GMT-0700 (Pacific Daylight Time)">21:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">I agree it does sleep periodically but <code>sleep</code> is an independent concept.</td></tr>
  <tr class="msg" id="L248"><td class="ts-cell"><a class="ts" href="#L248" alt="Mon Jul 29 2024 14:20:23 GMT-0700 (Pacific Daylight Time)">21:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">i thought it has a protocol?</td></tr>
  <tr class="msg" id="L249"><td class="ts-cell"><a class="ts" href="#L249" alt="Mon Jul 29 2024 14:20:32 GMT-0700 (Pacific Daylight Time)">21:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">it's string-based, at least currently</td></tr>
  <tr class="msg" id="L250"><td class="ts-cell"><a class="ts" href="#L250" alt="Mon Jul 29 2024 14:20:37 GMT-0700 (Pacific Daylight Time)">21:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">Which, I assume isn't intended to be part of your proposal?</td></tr>
  <tr class="msg" id="L251"><td class="ts-cell"><a class="ts" href="#L251" alt="Mon Jul 29 2024 14:20:43 GMT-0700 (Pacific Daylight Time)">21:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">it is, there is a string-named async <code>acquire</code> method which gives you an object with a string-named sync <code>release</code> method</td></tr>
  <tr class="msg" id="L252"><td class="ts-cell"><a class="ts" href="#L252" alt="Mon Jul 29 2024 14:21:12 GMT-0700 (Pacific Daylight Time)">21:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">ah, string, sorry</td></tr>
  <tr class="msg" id="L253"><td class="ts-cell"><a class="ts" href="#L253" alt="Mon Jul 29 2024 14:21:17 GMT-0700 (Pacific Daylight Time)">21:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@lucacasonato:matrix.org">Luca Casonato</span>&gt;</div></td><td class="msg-cell"><pre><code class="language-ts">interface Governor {
  acquire(): Promise&lt;GovernorToken&gt;;
}

interface GovernorToken {
  release(): void;
  // or
  [Symbol.dispose](): void;
}
</code></pre>
</td></tr>
  <tr class="msg" id="L254"><td class="ts-cell"><a class="ts" href="#L254" alt="Mon Jul 29 2024 14:21:30 GMT-0700 (Pacific Daylight Time)">21:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">yeah string vs symbol was one of the post-Stage 1 design considerations</td></tr>
  <tr class="msg" id="L255"><td class="ts-cell"><a class="ts" href="#L255" alt="Mon Jul 29 2024 14:21:39 GMT-0700 (Pacific Daylight Time)">21:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">The <code>Semaphore</code> in the slides implements the <code>Governor</code> interface, which is very iterator specific</td></tr>
  <tr class="msg" id="L256"><td class="ts-cell"><a class="ts" href="#L256" alt="Mon Jul 29 2024 14:21:42 GMT-0700 (Pacific Daylight Time)">21:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">(<code>Symbol.dispose</code> isn't part of the protocol but should generally be there yes)</td></tr>
  <tr class="msg" id="L257"><td class="ts-cell"><a class="ts" href="#L257" alt="Mon Jul 29 2024 14:21:54 GMT-0700 (Pacific Daylight Time)">21:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote><pre><code class="language-ts">interface Governor {
  acquire(): Promise&lt;GovernorToken&gt;;
}

interface GovernorToken {
  release(): void;
  // or
  [Symbol.dispose](): void;
}
</code></pre>
</blockquote></mx-reply>and, not or</td></tr>
  <tr class="msg" id="L258"><td class="ts-cell"><a class="ts" href="#L258" alt="Mon Jul 29 2024 14:22:09 GMT-0700 (Pacific Daylight Time)">21:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">that <code>acquire(): Promise&lt;GovernorToken&gt;</code> is not how i would declare <code>acquire</code> if i were designing a shmem semaphore</td></tr>
  <tr class="msg" id="L259"><td class="ts-cell"><a class="ts" href="#L259" alt="Mon Jul 29 2024 14:22:26 GMT-0700 (Pacific Daylight Time)">21:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">how about tryAcquire</td></tr>
  <tr class="msg" id="L260"><td class="ts-cell"><a class="ts" href="#L260" alt="Mon Jul 29 2024 14:22:27 GMT-0700 (Pacific Daylight Time)">21:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@lucacasonato:matrix.org">Luca Casonato</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> and, not or</blockquote></mx-reply>depends on if the token is a protocol or a class</td></tr>
  <tr class="msg" id="L261"><td class="ts-cell"><a class="ts" href="#L261" alt="Mon Jul 29 2024 14:22:31 GMT-0700 (Pacific Daylight Time)">21:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Well, it's listed as "non-essential", to be fair, but if it did it would pollute semaphore with unrelated functionality, IMO.</td></tr>
  <tr class="msg" id="L262"><td class="ts-cell"><a class="ts" href="#L262" alt="Mon Jul 29 2024 14:22:37 GMT-0700 (Pacific Daylight Time)">21:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">like, it would be a blocking void <code>acquire()</code> that can't be called on the main thread</td></tr>
  <tr class="msg" id="L263"><td class="ts-cell"><a class="ts" href="#L263" alt="Mon Jul 29 2024 14:22:42 GMT-0700 (Pacific Daylight Time)">21:22</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@lucacasonato:matrix.org">Luca Casonato</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> how about tryAcquire</blockquote></mx-reply><a href="https://github.com/michaelficarra/proposal-concurrency-control/issues/2">https://github.com/michaelficarra/proposal-concurrency-control/issues/2</a></td></tr>
  <tr class="msg" id="L264"><td class="ts-cell"><a class="ts" href="#L264" alt="Mon Jul 29 2024 14:23:18 GMT-0700 (Pacific Daylight Time)">21:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote>how about tryAcquire</blockquote></mx-reply>that was in the post-Stage 1 design considerations slide</td></tr>
  <tr class="msg" id="L265"><td class="ts-cell"><a class="ts" href="#L265" alt="Mon Jul 29 2024 14:23:23 GMT-0700 (Pacific Daylight Time)">21:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-14" title="@michaelficarra:matrix.org">Michael Ficarra</span>&gt;</div></td><td class="msg-cell">sorry it went by really fast</td></tr>
  <tr class="msg" id="L266"><td class="ts-cell"><a class="ts" href="#L266" alt="Mon Jul 29 2024 14:23:33 GMT-0700 (Pacific Daylight Time)">21:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">no i was distracted, mb</td></tr>
  <tr class="msg" id="L267"><td class="ts-cell"><a class="ts" href="#L267" alt="Mon Jul 29 2024 14:23:44 GMT-0700 (Pacific Daylight Time)">21:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> like, it would be a blocking void <code>acquire()</code> that can't be called on the main thread</blockquote></mx-reply>how attached are you to the <code>void</code> part? the fact that you can <code>release</code> a thing you didn't previously <code>acquire</code> seems like a non-essential (and bad) part of textbook C semaphore implementation</td></tr>
  <tr class="msg" id="L268"><td class="ts-cell"><a class="ts" href="#L268" alt="Mon Jul 29 2024 14:24:31 GMT-0700 (Pacific Daylight Time)">21:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">In my <code>AsyncSemaphore</code> implementation, you don't <code>acquire</code> and then <code>dispose</code>, as that grants a capability to the <code>acquire</code> caller that belongs on the semaphore itself</td></tr>
  <tr class="msg" id="L269"><td class="ts-cell"><a class="ts" href="#L269" alt="Mon Jul 29 2024 14:24:53 GMT-0700 (Pacific Daylight Time)">21:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">i am also a fan of release tokens. you can build the meh c api on top of that if you want.</td></tr>
  <tr class="msg" id="L270"><td class="ts-cell"><a class="ts" href="#L270" alt="Mon Jul 29 2024 14:25:18 GMT-0700 (Pacific Daylight Time)">21:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> how attached are you to the <code>void</code> part? the fact that you can <code>release</code> a thing you didn't previously <code>acquire</code> seems like a non-essential (and bad) part of textbook C semaphore implementation</blockquote></mx-reply>Why is this bad? The semaphore maintains its capabilities rather than blindly handing them off to callers.</td></tr>
  <tr class="msg" id="L271"><td class="ts-cell"><a class="ts" href="#L271" alt="Mon Jul 29 2024 14:25:42 GMT-0700 (Pacific Daylight Time)">21:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">another reason why those other snapshots are not all exposed is because these are often not useful and each is complicated to define. So the idea is to add the "causal snapshots" where they are useful.</td></tr>
  <tr class="msg" id="L272"><td class="ts-cell"><a class="ts" href="#L272" alt="Mon Jul 29 2024 14:25:46 GMT-0700 (Pacific Daylight Time)">21:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">... access to the semaphore should not imply access to the ability to cause the semaphore to think it has more resources available</td></tr>
  <tr class="msg" id="L273"><td class="ts-cell"><a class="ts" href="#L273" alt="Mon Jul 29 2024 14:25:55 GMT-0700 (Pacific Daylight Time)">21:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">IMO that's like putting <code>cancel()</code> on a <code>Promise</code> return value. It's the wrong separation of concerns.</td></tr>
  <tr class="msg" id="L274"><td class="ts-cell"><a class="ts" href="#L274" alt="Mon Jul 29 2024 14:25:58 GMT-0700 (Pacific Daylight Time)">21:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">you should only be able to cause it to think it has resources if it previously told you that you owned those resources</td></tr>
  <tr class="msg" id="L275"><td class="ts-cell"><a class="ts" href="#L275" alt="Mon Jul 29 2024 14:26:24 GMT-0700 (Pacific Daylight Time)">21:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">I have exactly the reverse intuition about who should be responsible for this capability</td></tr>
  <tr class="msg" id="L276"><td class="ts-cell"><a class="ts" href="#L276" alt="Mon Jul 29 2024 14:26:51 GMT-0700 (Pacific Daylight Time)">21:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">yeah that particular implementation keeps a magic internal _count to determine</td></tr>
  <tr class="msg" id="L277"><td class="ts-cell"><a class="ts" href="#L277" alt="Mon Jul 29 2024 14:26:56 GMT-0700 (Pacific Daylight Time)">21:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">wait ron you're arguing that there should be a release method that does not require a previously acquired capability?</td></tr>
  <tr class="msg" id="L278"><td class="ts-cell"><a class="ts" href="#L278" alt="Mon Jul 29 2024 14:27:10 GMT-0700 (Pacific Daylight Time)">21:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">To use the train or ship "Semaphore" metaphor, that's like waiving a flag to let a user in, and then that user gets to waive the flag to let the next user in. </td></tr>
  <tr class="msg" id="L279"><td class="ts-cell"><a class="ts" href="#L279" alt="Mon Jul 29 2024 14:27:18 GMT-0700 (Pacific Daylight Time)">21:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell"><a href="https://github.com/dotnet/runtime/blob/4c58b5a5132cb089b23d32cafe3fcfa7e615a0da/src/libraries/System.Private.CoreLib/src/System/Threading/SpinWait.cs#L225-L230">https://github.com/dotnet/runtime/blob/4c58b5a5132cb089b23d32cafe3fcfa7e615a0da/src/libraries/System.Private.CoreLib/src/System/Threading/SpinWait.cs#L225-L230</a></td></tr>
  <tr class="msg" id="L280"><td class="ts-cell"><a class="ts" href="#L280" alt="Mon Jul 29 2024 14:27:37 GMT-0700 (Pacific Daylight Time)">21:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">... right, yes, that's the correct thing</td></tr>
  <tr class="msg" id="L281"><td class="ts-cell"><a class="ts" href="#L281" alt="Mon Jul 29 2024 14:27:40 GMT-0700 (Pacific Daylight Time)">21:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">the user announces when they're done</td></tr>
  <tr class="msg" id="L282"><td class="ts-cell"><a class="ts" href="#L282" alt="Mon Jul 29 2024 14:27:48 GMT-0700 (Pacific Daylight Time)">21:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">i am warming up to the idea of letting the VM do complete magic here without a userland hint</td></tr>
  <tr class="msg" id="L283"><td class="ts-cell"><a class="ts" href="#L283" alt="Mon Jul 29 2024 14:27:51 GMT-0700 (Pacific Daylight Time)">21:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">the user does not get to say "someone is done", only "I personally am done"</td></tr>
  <tr class="msg" id="L284"><td class="ts-cell"><a class="ts" href="#L284" alt="Mon Jul 29 2024 14:27:53 GMT-0700 (Pacific Daylight Time)">21:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@lucacasonato:matrix.org">Luca Casonato</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> To use the train or ship "Semaphore" metaphor, that's like waiving a flag to let a user in, and then that user gets to waive the flag to let the next user in. </blockquote></mx-reply>It's like waving the flag, and then giving the flag to the user. And then when the user is done they have to give the flag back to whoever is waving flags so they can wave in the next person</td></tr>
  <tr class="msg" id="L285"><td class="ts-cell"><a class="ts" href="#L285" alt="Mon Jul 29 2024 14:27:57 GMT-0700 (Pacific Daylight Time)">21:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> wait ron you're arguing that there should be a release method that does not require a previously acquired capability?</blockquote></mx-reply>That's how my <code>AsyncSemaphore</code> works, though releasing an empty semaphore does nothing.</td></tr>
  <tr class="msg" id="L286"><td class="ts-cell"><a class="ts" href="#L286" alt="Mon Jul 29 2024 14:28:12 GMT-0700 (Pacific Daylight Time)">21:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">And I do have "release tokens" in many of the other coordination primitives in esfx</td></tr>
  <tr class="msg" id="L287"><td class="ts-cell"><a class="ts" href="#L287" alt="Mon Jul 29 2024 14:28:25 GMT-0700 (Pacific Daylight Time)">21:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">i am new to someone arguing that linear types are bad</td></tr>
  <tr class="msg" id="L288"><td class="ts-cell"><a class="ts" href="#L288" alt="Mon Jul 29 2024 14:28:36 GMT-0700 (Pacific Daylight Time)">21:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">do &lt;2 minutes remain?</td></tr>
  <tr class="msg" id="L289"><td class="ts-cell"><a class="ts" href="#L289" alt="Mon Jul 29 2024 14:28:51 GMT-0700 (Pacific Daylight Time)">21:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">Mark: Yes, that is the case</td></tr>
  <tr class="msg" id="L290"><td class="ts-cell"><a class="ts" href="#L290" alt="Mon Jul 29 2024 14:29:12 GMT-0700 (Pacific Daylight Time)">21:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">I guess it's also weird because all of the examples are behaviors that the particular lock implementation wants and don't seem to be architecture specific.</td></tr>
  <tr class="msg" id="L291"><td class="ts-cell"><a class="ts" href="#L291" alt="Mon Jul 29 2024 14:29:12 GMT-0700 (Pacific Daylight Time)">21:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-3" title="@usharma:igalia.com">ryzokuken</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> do &lt;2 minutes remain?</blockquote></mx-reply>looked like a TCQ bug</td></tr>
  <tr class="msg" id="L292"><td class="ts-cell"><a class="ts" href="#L292" alt="Mon Jul 29 2024 14:30:10 GMT-0700 (Pacific Daylight Time)">21:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">Maybe for compile times? :P</td></tr>
  <tr class="msg" id="L293"><td class="ts-cell"><a class="ts" href="#L293" alt="Mon Jul 29 2024 14:30:21 GMT-0700 (Pacific Daylight Time)">21:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">lol, fair</td></tr>
  <tr class="msg" id="L294"><td class="ts-cell"><a class="ts" href="#L294" alt="Mon Jul 29 2024 14:31:08 GMT-0700 (Pacific Daylight Time)">21:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">the high-level goal here is for the VMs to do the optimal thing in both the interpreter (where the call overhead is huge) and in inlined code (where you can inline <code>pause</code>)</td></tr>
  <tr class="msg" id="L295"><td class="ts-cell"><a class="ts" href="#L295" alt="Mon Jul 29 2024 14:31:18 GMT-0700 (Pacific Daylight Time)">21:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">do you see a way to do that other than an implementation-defined hint parameter? that was my best idea</td></tr>
  <tr class="msg" id="L296"><td class="ts-cell"><a class="ts" href="#L296" alt="Mon Jul 29 2024 14:31:28 GMT-0700 (Pacific Daylight Time)">21:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@softwarechris:matrix.org">Chris de Almeida</span>&gt;</div></td><td class="msg-cell">this topic goes to the end of day (~28 mins remaining)</td></tr>
  <tr class="msg" id="L297"><td class="ts-cell"><a class="ts" href="#L297" alt="Mon Jul 29 2024 14:31:39 GMT-0700 (Pacific Daylight Time)">21:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">if that causes more confusion and problems, then i will drop it. but that also means giving up on that goal, which is too bad</td></tr>
  <tr class="msg" id="L298"><td class="ts-cell"><a class="ts" href="#L298" alt="Mon Jul 29 2024 14:31:41 GMT-0700 (Pacific Daylight Time)">21:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> i am new to someone arguing that linear types are bad</blockquote></mx-reply>In the case of <code>Semaphore</code>, it's about capability and separation of concerns.</td></tr>
  <tr class="msg" id="L299"><td class="ts-cell"><a class="ts" href="#L299" alt="Mon Jul 29 2024 14:32:38 GMT-0700 (Pacific Daylight Time)">21:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">Do you just want consistent timing? Or are you looking for something else? I guess I don't see how you're anticipating the goal to be achieved.</td></tr>
  <tr class="msg" id="L300"><td class="ts-cell"><a class="ts" href="#L300" alt="Mon Jul 29 2024 14:33:10 GMT-0700 (Pacific Daylight Time)">21:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Just because a user can invoke <code>acquire()</code> or <code>wait()</code> on a semaphore does not mean that the next waiting user should automatically be let in when that user is done. A counting semaphore only lets one user in, but can release <code>n</code> waiting users as is necessary.</td></tr>
  <tr class="msg" id="L301"><td class="ts-cell"><a class="ts" href="#L301" alt="Mon Jul 29 2024 14:33:25 GMT-0700 (Pacific Daylight Time)">21:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">I don't see how the loop count is related to the JIT tier</td></tr>
  <tr class="msg" id="L302"><td class="ts-cell"><a class="ts" href="#L302" alt="Mon Jul 29 2024 14:33:44 GMT-0700 (Pacific Daylight Time)">21:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">i want consistent timing, yes</td></tr>
  <tr class="msg" id="L303"><td class="ts-cell"><a class="ts" href="#L303" alt="Mon Jul 29 2024 14:34:16 GMT-0700 (Pacific Daylight Time)">21:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell"><p>if i have a fast path loop:</p>
<pre><code>do {
  TryLock();
  Atomics.pause(spins);
} while (spins++ &lt; kSpinCount)
</code></pre>
</td></tr>
  <tr class="msg" id="L304"><td class="ts-cell"><a class="ts" href="#L304" alt="Mon Jul 29 2024 14:34:19 GMT-0700 (Pacific Daylight Time)">21:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">I guess I still don't see how the loop hint helps with that?</td></tr>
  <tr class="msg" id="L305"><td class="ts-cell"><a class="ts" href="#L305" alt="Mon Jul 29 2024 14:35:00 GMT-0700 (Pacific Daylight Time)">21:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">what i was going for was, if that do-while loop is running in the interpreter, <code>Atomics.pause(spins)</code> would always execute one <code>pause</code></td></tr>
  <tr class="msg" id="L306"><td class="ts-cell"><a class="ts" href="#L306" alt="Mon Jul 29 2024 14:35:01 GMT-0700 (Pacific Daylight Time)">21:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">The goal seems reasonable. But wouldn't it just be implemented with extra pauses in the JIT?</td></tr>
  <tr class="msg" id="L307"><td class="ts-cell"><a class="ts" href="#L307" alt="Mon Jul 29 2024 14:35:22 GMT-0700 (Pacific Daylight Time)">21:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">if it's inlined JIT code, Atomics.pause(spins) would use <code>spins</code> to determine how many <code>pause</code>s</td></tr>
  <tr class="msg" id="L308"><td class="ts-cell"><a class="ts" href="#L308" alt="Mon Jul 29 2024 14:35:39 GMT-0700 (Pacific Daylight Time)">21:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> The goal seems reasonable. But wouldn't it just be implemented with extra pauses in the JIT?</blockquote></mx-reply>well right, but i wanted the user to signal that intent instead of doing it for <em>all</em> calls to <code>pause</code></td></tr>
  <tr class="msg" id="L309"><td class="ts-cell"><a class="ts" href="#L309" alt="Mon Jul 29 2024 14:35:50 GMT-0700 (Pacific Daylight Time)">21:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">i don't think it's the end of the world to do it for all calls of pause, to be clear</td></tr>
  <tr class="msg" id="L310"><td class="ts-cell"><a class="ts" href="#L310" alt="Mon Jul 29 2024 14:35:54 GMT-0700 (Pacific Daylight Time)">21:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">i thought this would be uncontroversial</td></tr>
  <tr class="msg" id="L311"><td class="ts-cell"><a class="ts" href="#L311" alt="Mon Jul 29 2024 14:36:17 GMT-0700 (Pacific Daylight Time)">21:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">Are you saying you want the total spin loop time to be the same between JIT and interpreter?</td></tr>
  <tr class="msg" id="L312"><td class="ts-cell"><a class="ts" href="#L312" alt="Mon Jul 29 2024 14:36:30 GMT-0700 (Pacific Daylight Time)">21:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">yes</td></tr>
  <tr class="msg" id="L313"><td class="ts-cell"><a class="ts" href="#L313" alt="Mon Jul 29 2024 14:36:40 GMT-0700 (Pacific Daylight Time)">21:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">Or that any given pause is the same</td></tr>
  <tr class="msg" id="L314"><td class="ts-cell"><a class="ts" href="#L314" alt="Mon Jul 29 2024 14:36:41 GMT-0700 (Pacific Daylight Time)">21:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">i mean, or as close as feasible</td></tr>
  <tr class="msg" id="L315"><td class="ts-cell"><a class="ts" href="#L315" alt="Mon Jul 29 2024 14:36:49 GMT-0700 (Pacific Daylight Time)">21:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">not some hard real-time kind of guarantee</td></tr>
  <tr class="msg" id="L316"><td class="ts-cell"><a class="ts" href="#L316" alt="Mon Jul 29 2024 14:36:55 GMT-0700 (Pacific Daylight Time)">21:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">I see, I misunderstood</td></tr>
  <tr class="msg" id="L317"><td class="ts-cell"><a class="ts" href="#L317" alt="Mon Jul 29 2024 14:37:18 GMT-0700 (Pacific Daylight Time)">21:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">if i write a mutex implementation in JS, i don't want the contention fast path to be waiting for longer/shorter depending on whether you're in the interpreter or in the JITs</td></tr>
  <tr class="msg" id="L318"><td class="ts-cell"><a class="ts" href="#L318" alt="Mon Jul 29 2024 14:38:54 GMT-0700 (Pacific Daylight Time)">21:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">there are different ways to accomplish that goal: i thought a hint parameter was the most flexible</td></tr>
  <tr class="msg" id="L319"><td class="ts-cell"><a class="ts" href="#L319" alt="Mon Jul 29 2024 14:40:16 GMT-0700 (Pacific Daylight Time)">21:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">Hmm, it almost feels like the right way to express that would be <code>Atomics.compareExchangeWithRetry(..., count)</code> or something but idk</td></tr>
  <tr class="msg" id="L320"><td class="ts-cell"><a class="ts" href="#L320" alt="Mon Jul 29 2024 14:40:30 GMT-0700 (Pacific Daylight Time)">21:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">Or at least less controversial at this point lol</td></tr>
  <tr class="msg" id="L321"><td class="ts-cell"><a class="ts" href="#L321" alt="Mon Jul 29 2024 14:41:04 GMT-0700 (Pacific Daylight Time)">21:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">The user should be the one who indicates that they are done. Ability to <code>acquire</code> should not give you any further capabilities except the ability to indicate that you're done. And you should not have the ability to indicate that you're done without previously having exactly one corresponding completed <code>acquire</code>.</td></tr>
  <tr class="msg" id="L322"><td class="ts-cell"><a class="ts" href="#L322" alt="Mon Jul 29 2024 14:41:10 GMT-0700 (Pacific Daylight Time)">21:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> if i write a mutex implementation in JS, i don't want the contention fast path to be waiting for longer/shorter depending on whether you're in the interpreter or in the JITs</blockquote></mx-reply>I kinda agree but isn't that already up to scheduling in native-land anyway?</td></tr>
  <tr class="msg" id="L323"><td class="ts-cell"><a class="ts" href="#L323" alt="Mon Jul 29 2024 14:41:43 GMT-0700 (Pacific Daylight Time)">21:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">right, it's a best effort thing</td></tr>
  <tr class="msg" id="L324"><td class="ts-cell"><a class="ts" href="#L324" alt="Mon Jul 29 2024 14:41:46 GMT-0700 (Pacific Daylight Time)">21:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">my thread can certainly be preempted</td></tr>
  <tr class="msg" id="L325"><td class="ts-cell"><a class="ts" href="#L325" alt="Mon Jul 29 2024 14:42:10 GMT-0700 (Pacific Daylight Time)">21:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">i mean, that doesn't stop C++ implementations from trying to be clever with inline asm and spin counts even though it's also up to OS scheduling</td></tr>
  <tr class="msg" id="L326"><td class="ts-cell"><a class="ts" href="#L326" alt="Mon Jul 29 2024 14:42:27 GMT-0700 (Pacific Daylight Time)">21:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">since it shows enough improvement on enough workloads on enough OSes</td></tr>
  <tr class="msg" id="L327"><td class="ts-cell"><a class="ts" href="#L327" alt="Mon Jul 29 2024 14:43:56 GMT-0700 (Pacific Daylight Time)">21:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><p>It's easy enough for a consumer to wrap release:</p>
<pre><code class="language-js">class WorkArea {
  #sem = new Semaphore(1);
  async acquire() {
    await this.#sem.acquire();
    const stack = new DisposableStack();
    stack.defer(() =&gt; { this.#sem.release(1); });
    return stack;
  }
}
</code></pre>
<p>But you can also implement semaphore wrappers that defer the actual call to <code>release()</code> based on other heuristics, such as application load, quiescence, etc.</p>
</td></tr>
  <tr class="msg" id="L328"><td class="ts-cell"><a class="ts" href="#L328" alt="Mon Jul 29 2024 14:45:10 GMT-0700 (Pacific Daylight Time)">21:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Counting semaphores, especially, have different cases than a simple binary semaphore or mutex</td></tr>
  <tr class="msg" id="L329"><td class="ts-cell"><a class="ts" href="#L329" alt="Mon Jul 29 2024 14:45:34 GMT-0700 (Pacific Daylight Time)">21:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">Yeah, idk, I think if I really cared about this enough I would probably just implement my spin loop in WASM where I have more control on the assembly that's generated anyway.</td></tr>
  <tr class="msg" id="L330"><td class="ts-cell"><a class="ts" href="#L330" alt="Mon Jul 29 2024 14:47:01 GMT-0700 (Pacific Daylight Time)">21:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">why would you want to have to write a wrapper for the behavior that enforces correct usage</td></tr>
  <tr class="msg" id="L331"><td class="ts-cell"><a class="ts" href="#L331" alt="Mon Jul 29 2024 14:47:31 GMT-0700 (Pacific Daylight Time)">21:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">You're assuming a single correct usage, and there is not a single correct usage.</td></tr>
  <tr class="msg" id="L332"><td class="ts-cell"><a class="ts" href="#L332" alt="Mon Jul 29 2024 14:48:28 GMT-0700 (Pacific Daylight Time)">21:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote>You're assuming a single correct usage, and there is not a single correct usage.</blockquote></mx-reply>I don’t understand why you’d encoruage putting <code data-md="`">dispose</code> on the manager instead of the instance.</td></tr>
  <tr class="msg" id="L333"><td class="ts-cell"><a class="ts" href="#L333" alt="Mon Jul 29 2024 14:49:15 GMT-0700 (Pacific Daylight Time)">21:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><p>You can also separate the "locking" mechanism of a semaphore from the "counting" mechanism  of a semaphore, just as we're considering separating the "locking" mechanism of a Mutex from the state of the mutex, e.g.:</p>
<pre><code>const mut = new Mutex();
startThread(mut, data);
{
  using lck = new UniqueLock(mut);
  ...
} // releases `lck`
</code></pre>
</td></tr>
  <tr class="msg" id="L334"><td class="ts-cell"><a class="ts" href="#L334" alt="Mon Jul 29 2024 14:49:20 GMT-0700 (Pacific Daylight Time)">21:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">but i still have not heard a counter argument on why it's bad to have a hint</td></tr>
  <tr class="msg" id="L335"><td class="ts-cell"><a class="ts" href="#L335" alt="Mon Jul 29 2024 14:49:28 GMT-0700 (Pacific Daylight Time)">21:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">i think the release(n) use case is valid and is also better served with tokens.</td></tr>
  <tr class="msg" id="L336"><td class="ts-cell"><a class="ts" href="#L336" alt="Mon Jul 29 2024 14:49:31 GMT-0700 (Pacific Daylight Time)">21:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I don’t understand why you’d encoruage putting <code data-md="`">dispose</code> on the manager instead of the instance.</blockquote></mx-reply>I didn't?</td></tr>
  <tr class="msg" id="L337"><td class="ts-cell"><a class="ts" href="#L337" alt="Mon Jul 29 2024 14:50:03 GMT-0700 (Pacific Daylight Time)">21:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">tauri://<a href="http://localhost/#/%23tc39-space%3Amatrix.org/%23tc39-delegates%3Amatrix.org/%24-8J3nO4bp71-0prpP61GST9bcoyqHtYjRn_JCuXs0NA">localhost/#/%23tc39-space%3Amatrix.org/%23tc39-delegates%3Amatrix.org/%24-8J3nO4bp71-0prpP61GST9bcoyqHtYjRn_JCuXs0NA</a> is on the manager instead of the token instance.</td></tr>
  <tr class="msg" id="L338"><td class="ts-cell"><a class="ts" href="#L338" alt="Mon Jul 29 2024 14:50:14 GMT-0700 (Pacific Daylight Time)">21:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><code>acquire().dispose()</code> maybe makes sense for binary semaphores, but not necessarily counting semaphores.</td></tr>
  <tr class="msg" id="L339"><td class="ts-cell"><a class="ts" href="#L339" alt="Mon Jul 29 2024 14:50:17 GMT-0700 (Pacific Daylight Time)">21:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">Wow, that’ copy-link is borked.</td></tr>
  <tr class="msg" id="L340"><td class="ts-cell"><a class="ts" href="#L340" alt="Mon Jul 29 2024 14:50:33 GMT-0700 (Pacific Daylight Time)">21:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">That link didn't work in matrix</td></tr>
  <tr class="msg" id="L341"><td class="ts-cell"><a class="ts" href="#L341" alt="Mon Jul 29 2024 14:50:47 GMT-0700 (Pacific Daylight Time)">21:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell"><a href="https://matrixlogs.bakkot.com/TC39_Delegates/2024-07-29#L327">https://matrixlogs.bakkot.com/TC39_Delegates/2024-07-29#L327</a></td></tr>
  <tr class="msg" id="L342"><td class="ts-cell"><a class="ts" href="#L342" alt="Mon Jul 29 2024 14:51:03 GMT-0700 (Pacific Daylight Time)">21:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">In JavaScript, I claim, the overwhelming most common use case for an API that looks kinda like this is "I want to make at most 5 simultaneous network requests" (or database connections, or filesystem accesses, or threads, or whatever). Leaving aside naming questions, I think that use case is best served by the API presented today.</td></tr>
  <tr class="msg" id="L343"><td class="ts-cell"><a class="ts" href="#L343" alt="Mon Jul 29 2024 14:51:06 GMT-0700 (Pacific Daylight Time)">21:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell">Cinny apparently doesn’t implement link to message well.</td></tr>
  <tr class="msg" id="L344"><td class="ts-cell"><a class="ts" href="#L344" alt="Mon Jul 29 2024 14:51:45 GMT-0700 (Pacific Daylight Time)">21:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">i don't agree that there is a difference in api preference for n=1 vs n&gt;1</td></tr>
  <tr class="msg" id="L345"><td class="ts-cell"><a class="ts" href="#L345" alt="Mon Jul 29 2024 14:51:57 GMT-0700 (Pacific Daylight Time)">21:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <a href="https://matrixlogs.bakkot.com/TC39_Delegates/2024-07-29#L327">https://matrixlogs.bakkot.com/TC39_Delegates/2024-07-29#L327</a></blockquote></mx-reply>That example didn't put dispose on the manager? It wrapped <code>release</code> in the call to <code>acquire</code> to emulate what <span class="nick-7">snek</span> was suggesting.</td></tr>
  <tr class="msg" id="L346"><td class="ts-cell"><a class="ts" href="#L346" alt="Mon Jul 29 2024 14:52:19 GMT-0700 (Pacific Daylight Time)">21:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-2" title="@bakkot:matrix.org">bakkot</span>&gt;</div></td><td class="msg-cell">If the concern is "I sometimes want to do something other than that, and I think of that other thing as being called Semaphore", that's a fair piece of feedback to support the rename, but not to support a different API.</td></tr>
  <tr class="msg" id="L347"><td class="ts-cell"><a class="ts" href="#L347" alt="Mon Jul 29 2024 14:52:22 GMT-0700 (Pacific Daylight Time)">21:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-1" title="@jridgewell:matrix.org">Justin Ridgewell</span>&gt;</div></td><td class="msg-cell"><code data-md="`">this.#sem.release(1)</code>, with <code data-md="`">#sem</code> being a manger.</td></tr>
  <tr class="msg" id="L348"><td class="ts-cell"><a class="ts" href="#L348" alt="Mon Jul 29 2024 14:52:50 GMT-0700 (Pacific Daylight Time)">21:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">That's what a <code>{ acquire(): Promise&lt;Disposable&gt; }</code> would do anyways?</td></tr>
  <tr class="msg" id="L349"><td class="ts-cell"><a class="ts" href="#L349" alt="Mon Jul 29 2024 14:53:54 GMT-0700 (Pacific Daylight Time)">21:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@kriskowal:aelf.land">kriskowal</span>&gt;</div></td><td class="msg-cell">So, consider <code>ReverseAsyncContext</code> with <code>add</code> and <code>reduce</code> instead of <code>set</code> and <code>get</code>.</td></tr>
  <tr class="msg" id="L350"><td class="ts-cell"><a class="ts" href="#L350" alt="Mon Jul 29 2024 14:54:24 GMT-0700 (Pacific Daylight Time)">21:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">what does this mean</td></tr>
  <tr class="msg" id="L351"><td class="ts-cell"><a class="ts" href="#L351" alt="Mon Jul 29 2024 14:54:36 GMT-0700 (Pacific Daylight Time)">21:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">If the hint does anything other than monotonically increase/decrease doesn't it kinda need to know the limit anyway?</td></tr>
  <tr class="msg" id="L352"><td class="ts-cell"><a class="ts" href="#L352" alt="Mon Jul 29 2024 14:55:05 GMT-0700 (Pacific Daylight Time)">21:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">I don't think it's necessarily bad just that without any comment on what it means then it's unclear.</td></tr>
  <tr class="msg" id="L353"><td class="ts-cell"><a class="ts" href="#L353" alt="Mon Jul 29 2024 14:55:07 GMT-0700 (Pacific Daylight Time)">21:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@kriskowal:aelf.land">kriskowal</span>&gt;</div></td><td class="msg-cell">We were looking into something like this for opentracing, opencontext, which is now opentel.</td></tr>
  <tr class="msg" id="L354"><td class="ts-cell"><a class="ts" href="#L354" alt="Mon Jul 29 2024 14:55:33 GMT-0700 (Pacific Daylight Time)">21:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">oh no i just mean what is a ReverseAsyncContext</td></tr>
  <tr class="msg" id="L355"><td class="ts-cell"><a class="ts" href="#L355" alt="Mon Jul 29 2024 14:55:36 GMT-0700 (Pacific Daylight Time)">21:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@kriskowal:aelf.land">kriskowal</span>&gt;</div></td><td class="msg-cell">We were interested because it would make it possible to solve some “read after write” hazards, with a “cookie” or lamport clock variants</td></tr>
  <tr class="msg" id="L356"><td class="ts-cell"><a class="ts" href="#L356" alt="Mon Jul 29 2024 14:55:41 GMT-0700 (Pacific Daylight Time)">21:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">there would be an internal limit</td></tr>
  <tr class="msg" id="L357"><td class="ts-cell"><a class="ts" href="#L357" alt="Mon Jul 29 2024 14:55:56 GMT-0700 (Pacific Daylight Time)">21:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@kriskowal:aelf.land">kriskowal</span>&gt;</div></td><td class="msg-cell">It’s AsyncContext but the variables are sets instead of cells.</td></tr>
  <tr class="msg" id="L358"><td class="ts-cell"><a class="ts" href="#L358" alt="Mon Jul 29 2024 14:55:59 GMT-0700 (Pacific Daylight Time)">21:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">like no matter waht the input is you'd never <code>pause</code> more than N times, whatever that is</td></tr>
  <tr class="msg" id="L359"><td class="ts-cell"><a class="ts" href="#L359" alt="Mon Jul 29 2024 14:56:03 GMT-0700 (Pacific Daylight Time)">21:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">50, 100</td></tr>
  <tr class="msg" id="L360"><td class="ts-cell"><a class="ts" href="#L360" alt="Mon Jul 29 2024 14:56:06 GMT-0700 (Pacific Daylight Time)">21:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">Like what if I like to write my loops as <code>for (I = spinCount; I--;) Atomics.yield(i);</code></td></tr>
  <tr class="msg" id="L361"><td class="ts-cell"><a class="ts" href="#L361" alt="Mon Jul 29 2024 14:56:17 GMT-0700 (Pacific Daylight Time)">21:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@kriskowal:aelf.land">kriskowal</span>&gt;</div></td><td class="msg-cell">Such that it’s meaningful for information to flow up the stack instead of broadcast outward.</td></tr>
  <tr class="msg" id="L362"><td class="ts-cell"><a class="ts" href="#L362" alt="Mon Jul 29 2024 14:56:18 GMT-0700 (Pacific Daylight Time)">21:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">because it's less characters or w/e</td></tr>
  <tr class="msg" id="L363"><td class="ts-cell"><a class="ts" href="#L363" alt="Mon Jul 29 2024 14:56:24 GMT-0700 (Pacific Daylight Time)">21:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">oh i see, got it, ty</td></tr>
  <tr class="msg" id="L364"><td class="ts-cell"><a class="ts" href="#L364" alt="Mon Jul 29 2024 14:56:57 GMT-0700 (Pacific Daylight Time)">21:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@keith_miller:matrix.org">keith_miller</span>&gt;</div></td><td class="msg-cell">Wait then why not have the JIT inject a count into the IR?</td></tr>
  <tr class="msg" id="L365"><td class="ts-cell"><a class="ts" href="#L365" alt="Mon Jul 29 2024 14:57:32 GMT-0700 (Pacific Daylight Time)">21:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@kriskowal:aelf.land">kriskowal</span>&gt;</div></td><td class="msg-cell">The reducer would merge all the members of the set such that the next consumer would have less work.</td></tr>
  <tr class="msg" id="L366"><td class="ts-cell"><a class="ts" href="#L366" alt="Mon Jul 29 2024 14:58:08 GMT-0700 (Pacific Daylight Time)">21:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@kriskowal:aelf.land">kriskowal</span>&gt;</div></td><td class="msg-cell">It is probably a Bad Idea™ but this is the natural conclusion. There was a paper about it that I will have to find.</td></tr>
  <tr class="msg" id="L367"><td class="ts-cell"><a class="ts" href="#L367" alt="Mon Jul 29 2024 14:59:33 GMT-0700 (Pacific Daylight Time)">21:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@legendecas:matrix.org">Chengzhong Wu</span>&gt;</div></td><td class="msg-cell">Thanks for sharing! We was discussing about possible merging/reducing with this flow at <a href="https://github.com/tc39/proposal-async-context/pull/94#discussion_r1651720741">https://github.com/tc39/proposal-async-context/pull/94#discussion_r1651720741</a> </td></tr>
  <tr class="msg" id="L368"><td class="ts-cell"><a class="ts" href="#L368" alt="Mon Jul 29 2024 15:00:15 GMT-0700 (Pacific Daylight Time)">22:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Like what if I like to write my loops as <code>for (I = spinCount; I--;) Atomics.yield(i);</code></blockquote></mx-reply>yeah, that's fair</td></tr>
  <tr class="msg" id="L369"><td class="ts-cell"><a class="ts" href="#L369" alt="Mon Jul 29 2024 15:00:20 GMT-0700 (Pacific Daylight Time)">22:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@littledan:matrix.org">littledan</span>&gt;</div></td><td class="msg-cell">yeah we were thinking that it'd be bad if JS code got injected into the middle whenever context merges happen (which is all the time)</td></tr>
  <tr class="msg" id="L370"><td class="ts-cell"><a class="ts" href="#L370" alt="Mon Jul 29 2024 15:01:09 GMT-0700 (Pacific Daylight Time)">22:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> If the concern is "I sometimes want to do something other than that, and I think of that other thing as being called Semaphore", that's a fair piece of feedback to support the rename, but not to support a different API.</blockquote></mx-reply><p>I have two concerns:</p>
<ol>
<li>The <code>Semaphore</code> API proposed depends on asynchrony and is geared for async coordination, not thread coordination. We also hope to introduce other thread coordination primitives in the future, including a <code>Semaphore</code> in line with <code>Mutex</code> and <code>Condition</code> that can be shared and does not require asynchrony. As such, we must avoid conflicting naming.</li>
<li>Before we decide on a final API for an async coordination <code>Semaphore</code>, we must ensure we understand the full problem domain of counting semaphores, to ensure we chose an API that is consistent with intended use cases.</li>
</ol>
</td></tr>
  <tr class="msg" id="L371"><td class="ts-cell"><a class="ts" href="#L371" alt="Mon Jul 29 2024 15:01:23 GMT-0700 (Pacific Daylight Time)">22:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">the guidance is that you pass monotonic increasing integers as hints that you are pausing for the Nth time</td></tr>
  <tr class="msg" id="L372"><td class="ts-cell"><a class="ts" href="#L372" alt="Mon Jul 29 2024 15:01:35 GMT-0700 (Pacific Daylight Time)">22:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">whatever strategy the VM chooses, it needs to understand that</td></tr>
  <tr class="msg" id="L373"><td class="ts-cell"><a class="ts" href="#L373" alt="Mon Jul 29 2024 15:01:36 GMT-0700 (Pacific Daylight Time)">22:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@kriskowal:aelf.land">kriskowal</span>&gt;</div></td><td class="msg-cell">Coming to think of it, putting a Set in an AsyncContext variable can’t be prevented, and this kind of work will be possible regardleess</td></tr>
  <tr class="msg" id="L374"><td class="ts-cell"><a class="ts" href="#L374" alt="Mon Jul 29 2024 15:01:38 GMT-0700 (Pacific Daylight Time)">22:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-8" title="@shuyuguo:matrix.org">shu</span>&gt;</div></td><td class="msg-cell">it can then choose whatever</td></tr>
  <tr class="msg" id="L375"><td class="ts-cell"><a class="ts" href="#L375" alt="Mon Jul 29 2024 15:02:08 GMT-0700 (Pacific Daylight Time)">22:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@kriskowal:aelf.land">kriskowal</span>&gt;</div></td><td class="msg-cell">And it’s only safe anyway if the mergers are consistent (which is enforced to a degree by ocap discipline around holding the variable)</td></tr>
  <tr class="msg" id="L376"><td class="ts-cell"><a class="ts" href="#L376" alt="Mon Jul 29 2024 15:02:58 GMT-0700 (Pacific Daylight Time)">22:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">For <code>Mutex</code>, we have been discussing an API design to allow <code>Mutex</code>, <code>Condition</code>, and <code>UniqueLock</code> to work in a blocking manner (when off the UI thread in the browser), and an async manner (when on the UI thread in the browser). The current design has both sync and async methods on <code>UniqueLock</code>.</td></tr>
  <tr class="msg" id="L377"><td class="ts-cell"><a class="ts" href="#L377" alt="Mon Jul 29 2024 15:03:54 GMT-0700 (Pacific Daylight Time)">22:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@kriskowal:aelf.land">kriskowal</span>&gt;</div></td><td class="msg-cell">Ah, but contexts derived from a context holding growing subsets that might contribute to the parent set is not there.</td></tr>
  <tr class="msg" id="L378"><td class="ts-cell"><a class="ts" href="#L378" alt="Mon Jul 29 2024 15:04:05 GMT-0700 (Pacific Daylight Time)">22:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Were we able to consider <code>Semaphore</code> for the MVP for shared structs, it likely would be a sharable object like <code>Mutex</code>, and have both a blocking (off UI thread) and non-blocking async (on UI thread) API, that would likely make a separate <code>Semaphore</code> unnecessary.</td></tr>
  <tr class="msg" id="L379"><td class="ts-cell"><a class="ts" href="#L379" alt="Mon Jul 29 2024 15:04:06 GMT-0700 (Pacific Daylight Time)">22:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">why do you draw a line between binary and counting semaphores for this api? </td></tr>
  <tr class="msg" id="L380"><td class="ts-cell"><a class="ts" href="#L380" alt="Mon Jul 29 2024 15:04:13 GMT-0700 (Pacific Daylight Time)">22:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-7" title="@devsnek:matrix.org">snek</span>&gt;</div></td><td class="msg-cell">do you think they must have different apis?</td></tr>
  <tr class="msg" id="L381"><td class="ts-cell"><a class="ts" href="#L381" alt="Mon Jul 29 2024 15:04:17 GMT-0700 (Pacific Daylight Time)">22:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@kriskowal:aelf.land">kriskowal</span>&gt;</div></td><td class="msg-cell">Well, it’ll be fun to talk about.</td></tr>
  <tr class="msg" id="L382"><td class="ts-cell"><a class="ts" href="#L382" alt="Mon Jul 29 2024 15:05:11 GMT-0700 (Pacific Daylight Time)">22:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-11" title="@kriskowal:aelf.land">kriskowal</span>&gt;</div></td><td class="msg-cell">(I for one do not think that we need to replay the history of mutual exclusion with all its conventional names.)</td></tr>

</tbody></table></div></div></div>
</body></html>