<!DOCTYPE html><html><head>
  <meta charset="UTF-8">
  <title>TC39 Decimal_Amount on 2025-09-22</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "TC39 Decimal_Amount";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">TC39 Decimal_Amount<br>2025-09-22<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2025-09-21" class="nav-link"><span>prev</span></a>
<span style="float:right">next</span>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search TC39 Decimal_Amount">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Sun Sep 21 2025 23:06:09 GMT-0700 (Pacific Daylight Time)">06:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">If we’re getting the calculations of significant digits wrong, even after adapting keep-trailing-zeros’s SDO, I wonder if there’s a bug in the SDO or whether I’m using it incorrectly</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Sun Sep 21 2025 23:07:05 GMT-0700 (Pacific Daylight Time)">06:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">what do we think of the suggestion to not even compute significant digits?</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Sun Sep 21 2025 23:07:32 GMT-0700 (Pacific Daylight Time)">06:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">JRL usually comes but I’m not sure if he’s in the V8 team</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Sun Sep 21 2025 23:37:13 GMT-0700 (Pacific Daylight Time)">06:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">Morning. I've not looked at issues yet, but not computing significant digits has been on my mind as a decent solution. As in, I don't think without further information we can know whether <code>'4200'</code> has two or four significant digits, or whether <code>'0.042'</code> and <code>'4.2e-2'</code> have the same or different numbers of significant digits. I'll go find an issue where to comment on this more publicly.</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Sun Sep 21 2025 23:58:21 GMT-0700 (Pacific Daylight Time)">06:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">regarding the issue of arithmetic, I thought we generally wanted to avoid that. At most, arithmetic would happen internally when doing unit conversions, but that's different from Amount offering you an API for doing arithmetic</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Sun Sep 21 2025 23:58:47 GMT-0700 (Pacific Daylight Time)">06:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">I'd say <a href="https://github.com/tc39/proposal-amount/issues/54">https://github.com/tc39/proposal-amount/issues/54</a> is a good candidate</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Mon Sep 22 2025 00:02:21 GMT-0700 (Pacific Daylight Time)">07:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">It seems like you just forgot to subtract from the number of fractional digits the exponent, for numbers written in exponential notation </td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Mon Sep 22 2025 00:02:46 GMT-0700 (Pacific Daylight Time)">07:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">And then use the conversion between fractional and significant that WH proposes in the issue?</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Mon Sep 22 2025 00:03:02 GMT-0700 (Pacific Daylight Time)">07:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">IIRC the spec already has a notion of "significant digit" whereby <code>4200</code> has 2 significant digits (a block of trailing zeros is ignored)</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Mon Sep 22 2025 00:03:06 GMT-0700 (Pacific Daylight Time)">07:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell"><em>but</em></td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Mon Sep 22 2025 00:03:16 GMT-0700 (Pacific Daylight Time)">07:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">you're right that those <em>could</em> be significant</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Mon Sep 22 2025 00:04:18 GMT-0700 (Pacific Daylight Time)">07:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">We should convert between the two using the algorithm we've always told Mark when he asked about the relationship between the two</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Mon Sep 22 2025 00:05:10 GMT-0700 (Pacific Daylight Time)">07:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">the proposal as it stands does allow you to stipulate that <code>4200</code> has 4 digits</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Mon Sep 22 2025 00:06:05 GMT-0700 (Pacific Daylight Time)">07:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">That seems what I expect</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Mon Sep 22 2025 00:06:10 GMT-0700 (Pacific Daylight Time)">07:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">And 4.2e2 has 2</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Mon Sep 22 2025 00:06:21 GMT-0700 (Pacific Daylight Time)">07:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> We should convert between the two using the algorithm we've always told Mark when he asked about the relationship between the two</blockquote></mx-reply>significant = fractional + ceil(1+ log10(value)), I think</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Mon Sep 22 2025 00:06:30 GMT-0700 (Pacific Daylight Time)">07:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">Added my comment to #54.</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Mon Sep 22 2025 00:07:37 GMT-0700 (Pacific Daylight Time)">07:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">I thnk the keep-trailing-zeros would say <code>4200</code> has 4 if I understand <a href="http://tc39.es/proposal-intl-keep-trailing-zeros/#sec-runtime-semantics-stringintlmv">http://tc39.es/proposal-intl-keep-trailing-zeros/#sec-runtime-semantics-stringintlmv</a></td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Mon Sep 22 2025 00:07:56 GMT-0700 (Pacific Daylight Time)">07:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">Idk I studied in school that for significant digits you include all the zeros on the right of the number</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Mon Sep 22 2025 00:07:59 GMT-0700 (Pacific Daylight Time)">07:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">right, we can calculate one from the other</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Mon Sep 22 2025 00:08:02 GMT-0700 (Pacific Daylight Time)">07:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">That's what it should be doing, yes.</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Mon Sep 22 2025 00:08:08 GMT-0700 (Pacific Daylight Time)">07:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">well, in a certain understanding of "significant digits"</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Mon Sep 22 2025 00:08:19 GMT-0700 (Pacific Daylight Time)">07:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> Idk I studied in school that for significant digits you include all the zeros on the right of the number</blockquote></mx-reply>Which makes the answer for 4200 quite clear</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Mon Sep 22 2025 00:10:12 GMT-0700 (Pacific Daylight Time)">07:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">I think the calculation approach doesn't work well with the current "ignore tailing zeroes, including in the integer part" perspective</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Mon Sep 22 2025 00:10:38 GMT-0700 (Pacific Daylight Time)">07:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">because it works with the mathematical value rather than a presentation of it</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Mon Sep 22 2025 00:10:42 GMT-0700 (Pacific Daylight Time)">07:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">I think saying how many significant digits 4200 has is problematic, and we should only do so if we need to. So, given that we can and do calculate how many fraction digits it has, what is the need for us to calculate significant digits for it?</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Mon Sep 22 2025 00:11:27 GMT-0700 (Pacific Daylight Time)">07:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">If it's in order to provide information about the number, then we'd be much better off reporting <code>integerDigits</code> in addition to <code>fractionDigits</code>.</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Mon Sep 22 2025 00:11:44 GMT-0700 (Pacific Daylight Time)">07:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">ah, interesting suggestion</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Mon Sep 22 2025 00:13:20 GMT-0700 (Pacific Daylight Time)">07:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">That pair is much more absolutely calculable from the value, match each other closely, and can e.g. give an indicator of how much space is needed to represent the number, or whether e.g. exponential notation might be appropriate for it.</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Mon Sep 22 2025 00:14:06 GMT-0700 (Pacific Daylight Time)">07:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-9" title="@nicolo-ribaudo:matrix.org">nicolo-ribaudo</span>&gt;</div></td><td class="msg-cell">Mh I guess yeah if the goal is formatting/interchange you don't need significant digits</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Mon Sep 22 2025 00:14:26 GMT-0700 (Pacific Daylight Time)">07:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@eemeli:mozilla.org">eemeli</span>&gt;</div></td><td class="msg-cell">To be clear, I'm not necesarily saying we <em>should</em> include <code>integerDigits</code>, I'm trying to provide an alternative to the one use case I'm aware of for a calculated <code>significantDigits</code>.</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Mon Sep 22 2025 00:16:02 GMT-0700 (Pacific Daylight Time)">07:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">I think we should have that in our back pocket as a counterproposal; I expect WH to bring this up in discussion</td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Mon Sep 22 2025 01:59:33 GMT-0700 (Pacific Daylight Time)">08:59</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">I don't quite see why the current spec fails to handle 0 and -0, but if I understand <a href="https://github.com/tc39/proposal-amount/issues/54#issuecomment-3316517702">https://github.com/tc39/proposal-amount/issues/54#issuecomment-3316517702</a> correctly, the reason why we don't handle <code>"NaN"</code> correctly is because the SDO for StringIntlMV apparently doesn't handle that string? I took a look at the grammar and AOs and SDOs like <code>ToNumber</code> and <code>StringNumericValue</code> but don't see how those produce NaN. Is that the root cause of the concern?</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Mon Sep 22 2025 02:03:11 GMT-0700 (Pacific Daylight Time)">09:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">Ah, I think I see what is meant: we should "handle" <code>"NaN"</code> as a failure to parse a decimal string</td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Mon Sep 22 2025 02:05:01 GMT-0700 (Pacific Daylight Time)">09:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">it took me a while to understand this becasue we've been talking about NaN as a valid string to be handled; but it seems that , following this approach,<code>"NaN"</code> is just an invalid notation for decimal strings, just like <code>"xyz"</code> would be an invalid decimal string</td></tr>
  <tr class="msg" id="L35"><td class="ts-cell"><a class="ts" href="#L35" alt="Mon Sep 22 2025 03:34:05 GMT-0700 (Pacific Daylight Time)">10:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">there's a bit more: <a href="https://github.com/tc39/proposal-amount/issues/54#issuecomment-3317514477">https://github.com/tc39/proposal-amount/issues/54#issuecomment-3317514477</a></td></tr>
  <tr class="msg" id="L36"><td class="ts-cell"><a class="ts" href="#L36" alt="Mon Sep 22 2025 03:35:36 GMT-0700 (Pacific Daylight Time)">10:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">I wonder if we might want to just remove support for significant digits in the constructor and <code>with</code>, though we could keep the significant property (it would be calculated in the constructor)</td></tr>
  <tr class="msg" id="L37"><td class="ts-cell"><a class="ts" href="#L37" alt="Mon Sep 22 2025 03:36:08 GMT-0700 (Pacific Daylight Time)">10:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-16" title="@jesse:igalia.com">Jesse</span>&gt;</div></td><td class="msg-cell">also, given the thinking of fraction digits that allows negative values, I wonder if we should also support that in the constructor and <code>.with</code></td></tr>

</tbody></table></div></div></div>
</body></html>