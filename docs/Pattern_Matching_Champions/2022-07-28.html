<!DOCTYPE html><html><head>
  <title>Pattern Matching Champions on 2022-07-28</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "Pattern Matching Champions";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">Pattern Matching Champions<br>2022-07-28<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2022-07-27" class="nav-link"><span>prev</span></a>
<a href="2022-07-29" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search Pattern Matching Champions">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Thu Jul 28 2022 03:07:45 GMT-0700 (Pacific Daylight Time)">10:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell"><p>I hope you don't mind me butting in - just a distant observer. I quite like the presentation of the layering from <span class="nick-10">yulia</span> . However, one concern, which I think <span class="nick-10">TabAtkins</span> picked upon, with the specific content of the proposal is that the <code>let when</code> matching doesn't allow for matching on nested properties, which I think is pretty core to the value of the original pattern matching proposal and is a common feature across prior art in other languages.</p>
<p>For some context, I originally suggested expanding the matcher proposal to include implementation for at least all scalars in the language, and I provide some example use cases in the first few comments <a href="https://github.com/tc39/proposal-pattern-matching/issues/209">https://github.com/tc39/proposal-pattern-matching/issues/209</a></p>
</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Thu Jul 28 2022 03:09:40 GMT-0700 (Pacific Daylight Time)">10:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">but I can definitely see the value of building up the feature from smaller parts that can be used standalone - it could make it a better integrated feature in the language if its made up of smaller parts that have value elsewhere</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Thu Jul 28 2022 03:09:54 GMT-0700 (Pacific Daylight Time)">10:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">easier to understand, and educate users</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Thu Jul 28 2022 03:10:39 GMT-0700 (Pacific Daylight Time)">10:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">let-when (in my original thinking) is intentionally restricted to make sure that it is unambiguous for users</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Thu Jul 28 2022 03:10:55 GMT-0700 (Pacific Daylight Time)">10:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">but, if you need more complex matching, you can break it into let ... when ... where the when is more powerful</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Thu Jul 28 2022 03:11:49 GMT-0700 (Pacific Daylight Time)">10:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">its an idea -- largely coming from a difficulty that you also noted in your examples that it is a little difficult to tell how destructuring works exactly. That problem will be compounded if we are not careful. Especially if we allow patterns in other contexts (which i believe will be very powerful and we should try)</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Thu Jul 28 2022 03:12:35 GMT-0700 (Pacific Daylight Time)">10:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">can you point me to a more specific example? I am (as always) low on time, so i can only take a glance at the very detailed comments you have. You can take one specific one and ill take a look</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Thu Jul 28 2022 03:12:41 GMT-0700 (Pacific Daylight Time)">10:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">yeah, but in prior art I wouldn't need to say use a <code>where</code> clause for matching against a nested <code>Some</code> for example</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Thu Jul 28 2022 03:12:58 GMT-0700 (Pacific Daylight Time)">10:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">A <code>Some</code> containing a <code>Some</code></td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Thu Jul 28 2022 03:13:25 GMT-0700 (Pacific Daylight Time)">10:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">can you write out what you have in mind?</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Thu Jul 28 2022 03:13:48 GMT-0700 (Pacific Daylight Time)">10:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell"><p>forgive the made up syntax, just copying it from the issue I linked</p>
<pre><code class="language-ts">type User = 
  | { id: string, name: string} 
  | { id: string, name: { name: string } } 
  | string 
  | number 
  | null

declare function getNameFromId(id: number): string;

declare const user: User;

// again I'm not sure about how binding works in this proposals, so taking a haphazard guess
const str = match( user ) {
  when ( { name: _string } ) { name }
  when ( { name: { name } ) { name }
  when _string { user }
  when _number { getNameFromId(user) }
  otherwise { "unknown user" }
}

</code></pre>
</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Thu Jul 28 2022 03:14:35 GMT-0700 (Pacific Daylight Time)">10:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">its kinda arbitrary and refers back to when <code>do</code> was part of the proposal</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Thu Jul 28 2022 03:14:56 GMT-0700 (Pacific Daylight Time)">10:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">the proposal hasnt' changed at the moment</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Thu Jul 28 2022 03:15:06 GMT-0700 (Pacific Daylight Time)">10:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">so you mean this kind of match</td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Thu Jul 28 2022 03:15:10 GMT-0700 (Pacific Daylight Time)">10:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell"><pre><code class="language-js">const str = match( user ) {
  when ( { name: _string } ) { name }
  when ( { name: { name } ) { name }
  when _string { user }
  when _number { getNameFromId(user) }
  otherwise { "unknown user" }
}
</code></pre>
</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Thu Jul 28 2022 03:15:30 GMT-0700 (Pacific Daylight Time)">10:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">haha, yes</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Thu Jul 28 2022 03:15:37 GMT-0700 (Pacific Daylight Time)">10:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">I'm guessing you read the issue</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Thu Jul 28 2022 03:15:41 GMT-0700 (Pacific Daylight Time)">10:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">and i guess with the current proposal it would look like this</td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Thu Jul 28 2022 03:15:57 GMT-0700 (Pacific Daylight Time)">10:15</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell"><code>_string</code> is kinda like <code>${String}</code> or in a previous iteration <code>^String</code></td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Thu Jul 28 2022 03:16:38 GMT-0700 (Pacific Daylight Time)">10:16</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell"><pre><code class="language-js">const str = match( user ) {
  when ( { name: ${String} } ) { name }
  when ( { name: { name } ) { name }
  when (${String}) { user }
  when ($number}) { getNameFromId(user) }
  otherwise { "unknown user" }
}
</code></pre>
</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Thu Jul 28 2022 03:17:04 GMT-0700 (Pacific Daylight Time)">10:17</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">yep, that is how it would roughly look I think in the current proposal </td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Thu Jul 28 2022 03:19:50 GMT-0700 (Pacific Daylight Time)">10:19</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">I'm matching potentially on a union of possible values, and some of those values have nested properties that I want to match against</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Thu Jul 28 2022 03:20:30 GMT-0700 (Pacific Daylight Time)">10:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell"><p>in the fully layered version, we could have:</p>
<pre><code class="language-js">function hasName(user) {
  if (user.name) {
    if (user.name.name) {
       return MatchPattern({ result: true, value: user.name.name})
    }
    return MatchPattern({ result: true, value: user.name})
  }
  return MatchPattern({ result: false} )
}
const str = match( user ) {
  let { name } when hasName { name }
  when String { user }
  when Number { getNameFromId(user) }
  otherwise { "unknown user" }
}
</code></pre>
</td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Thu Jul 28 2022 03:21:08 GMT-0700 (Pacific Daylight Time)">10:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">I suppose the issue is then that I have to now create a dedicated function for matching against this - I suppose this could be solved in userland </td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Thu Jul 28 2022 03:21:26 GMT-0700 (Pacific Daylight Time)">10:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">I can imagine that userland libraries will emerge that would allow you to construct that function </td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Thu Jul 28 2022 03:21:43 GMT-0700 (Pacific Daylight Time)">10:21</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell"><p>but you could arguably do</p>
<pre><code class="language-js">const str = match( user ) {
  let when ( { name: { name } ) { name }
  let when ( { name } ) { name }
  when (${String}) { user }
  when ($number}) { getNameFromId(user) }
  otherwise { "unknown user" }
}
</code></pre>
<p>this misses the string because i haven't thought that through</p>
</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Thu Jul 28 2022 03:23:03 GMT-0700 (Pacific Daylight Time)">10:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <p>in the fully layered version, we could have:</p>
<pre><code class="language-js">function hasName(user) {
  if (user.name) {
    if (user.name.name) {
       return MatchPattern({ result: true, value: user.name.name})
    }
    return MatchPattern({ result: true, value: user.name})
  }
  return MatchPattern({ result: false} )
}
const str = match( user ) {
  let { name } when hasName { name }
  when String { user }
  when Number { getNameFromId(user) }
  otherwise { "unknown user" }
}
</code></pre>
</blockquote></mx-reply>I think a consequence of this is that we will likely have a proliferation of user lands libraries that give you builders for these functions to build up complex patterns with nested values</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Thu Jul 28 2022 03:23:04 GMT-0700 (Pacific Daylight Time)">10:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell"><p>though this is also possible:</p>
<pre><code class="language-js">const str = match( user ) {
  let { name: name } when ( { name: { name: ${String} } ) { name }
  let { name }  when ( { name: ${String} } ) { name }
  when (${String}) { user }
  when ($number}) { getNameFromId(user) }
  otherwise { "unknown user" }
}
</code></pre>
</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Thu Jul 28 2022 03:23:11 GMT-0700 (Pacific Daylight Time)">10:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">which might not be a bad thing</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Thu Jul 28 2022 03:23:36 GMT-0700 (Pacific Daylight Time)">10:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">it might give us more type safety in a dynamic language, which i guess is also an interest of mine</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Thu Jul 28 2022 03:23:37 GMT-0700 (Pacific Daylight Time)">10:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">oh that is interesting </td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Thu Jul 28 2022 03:23:50 GMT-0700 (Pacific Daylight Time)">10:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">effectively matching on structures, and making that something that can be used almost anywhere</td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Thu Jul 28 2022 03:24:12 GMT-0700 (Pacific Daylight Time)">10:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">but with the way the syntax is right now, it shadows and overlaps with destructuring in a way that may be ambiguous</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Thu Jul 28 2022 03:24:27 GMT-0700 (Pacific Daylight Time)">10:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">so in a way we are moving the pattern matching syntax slightly over to the right?</td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Thu Jul 28 2022 03:24:39 GMT-0700 (Pacific Daylight Time)">10:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">or the left, it can be <code>when { ... } as { ... } </code></td></tr>
  <tr class="msg" id="L35"><td class="ts-cell"><a class="ts" href="#L35" alt="Thu Jul 28 2022 03:24:40 GMT-0700 (Pacific Daylight Time)">10:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell"><code>( { name: { name: ${String} } )</code> is going to create a funciton?</td></tr>
  <tr class="msg" id="L36"><td class="ts-cell"><a class="ts" href="#L36" alt="Thu Jul 28 2022 03:24:57 GMT-0700 (Pacific Daylight Time)">10:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">equivalent to <code>hasName</code></td></tr>
  <tr class="msg" id="L37"><td class="ts-cell"><a class="ts" href="#L37" alt="Thu Jul 28 2022 03:24:59 GMT-0700 (Pacific Daylight Time)">10:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <code>( { name: { name: ${String} } )</code> is going to create a funciton?</blockquote></mx-reply>a matcher rather, but same idea</td></tr>
  <tr class="msg" id="L38"><td class="ts-cell"><a class="ts" href="#L38" alt="Thu Jul 28 2022 03:25:08 GMT-0700 (Pacific Daylight Time)">10:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">matcher as defined in the current proposal</td></tr>
  <tr class="msg" id="L39"><td class="ts-cell"><a class="ts" href="#L39" alt="Thu Jul 28 2022 03:25:21 GMT-0700 (Pacific Daylight Time)">10:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">ok, that sound fairly reasonable to me </td></tr>
  <tr class="msg" id="L40"><td class="ts-cell"><a class="ts" href="#L40" alt="Thu Jul 28 2022 03:25:35 GMT-0700 (Pacific Daylight Time)">10:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">that could be a way of addressing my concern </td></tr>
  <tr class="msg" id="L41"><td class="ts-cell"><a class="ts" href="#L41" alt="Thu Jul 28 2022 03:26:16 GMT-0700 (Pacific Daylight Time)">10:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">binding happens on the left, matcher is constructed in the middle, expression on the right </td></tr>
  <tr class="msg" id="L42"><td class="ts-cell"><a class="ts" href="#L42" alt="Thu Jul 28 2022 03:26:54 GMT-0700 (Pacific Daylight Time)">10:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell"><p>i have a crazy idea (please no one shoot me for this, this is a thought experiment)</p>
<pre><code class="language-js">function handle(res when { status: 200 }) {...} // matched when no "body" present

function handle(res when { status: 200, body: $validBody }) {...} // the match when "body" is present and valid

function handle(res when { status: 200, body }) {...} // the match when "body" is present

function handle(res when { status: 200 }) {...} // this overwrites the first function

function handle(res) { ...} // fall through case
</code></pre>
</td></tr>
  <tr class="msg" id="L43"><td class="ts-cell"><a class="ts" href="#L43" alt="Thu Jul 28 2022 03:27:09 GMT-0700 (Pacific Daylight Time)">10:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">you might recognize this as pattern matching of a different sort -- specifically haskell-likes</td></tr>
  <tr class="msg" id="L44"><td class="ts-cell"><a class="ts" href="#L44" alt="Thu Jul 28 2022 03:27:32 GMT-0700 (Pacific Daylight Time)">10:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">typescript would like to have a word, you just broke overloads :P</td></tr>
  <tr class="msg" id="L45"><td class="ts-cell"><a class="ts" href="#L45" alt="Thu Jul 28 2022 03:27:47 GMT-0700 (Pacific Daylight Time)">10:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">i already spoke with them a bit about this ;) they don't hate it</td></tr>
  <tr class="msg" id="L46"><td class="ts-cell"><a class="ts" href="#L46" alt="Thu Jul 28 2022 03:27:48 GMT-0700 (Pacific Daylight Time)">10:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">yet</td></tr>
  <tr class="msg" id="L47"><td class="ts-cell"><a class="ts" href="#L47" alt="Thu Jul 28 2022 03:28:12 GMT-0700 (Pacific Daylight Time)">10:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">oh, they all have bodies</td></tr>
  <tr class="msg" id="L48"><td class="ts-cell"><a class="ts" href="#L48" alt="Thu Jul 28 2022 03:28:22 GMT-0700 (Pacific Daylight Time)">10:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">typescript probably doesn't mind so much then</td></tr>
  <tr class="msg" id="L49"><td class="ts-cell"><a class="ts" href="#L49" alt="Thu Jul 28 2022 03:28:31 GMT-0700 (Pacific Daylight Time)">10:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">but effectively, if you leave out the default case -- the engine would treat values passed to <code>handle</code> that don't match, as a call to an undefined function</td></tr>
  <tr class="msg" id="L50"><td class="ts-cell"><a class="ts" href="#L50" alt="Thu Jul 28 2022 03:28:36 GMT-0700 (Pacific Daylight Time)">10:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">this reminds me of axum in rust</td></tr>
  <tr class="msg" id="L51"><td class="ts-cell"><a class="ts" href="#L51" alt="Thu Jul 28 2022 03:28:43 GMT-0700 (Pacific Daylight Time)">10:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">with their extractor functions </td></tr>
  <tr class="msg" id="L52"><td class="ts-cell"><a class="ts" href="#L52" alt="Thu Jul 28 2022 03:28:55 GMT-0700 (Pacific Daylight Time)">10:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">meaning that you could be restrictive in what kind of shapes can be passed to functions. i think this might be interesting.</td></tr>
  <tr class="msg" id="L53"><td class="ts-cell"><a class="ts" href="#L53" alt="Thu Jul 28 2022 03:29:40 GMT-0700 (Pacific Daylight Time)">10:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">what i find additionally interesting is that WASM has roughly settled on a structural typing approach (with some nominal typing). This would give us a way to talk about what structures are permitted, and that would mean that we take a somewhat unified approach across the platform</td></tr>
  <tr class="msg" id="L54"><td class="ts-cell"><a class="ts" href="#L54" alt="Thu Jul 28 2022 03:29:47 GMT-0700 (Pacific Daylight Time)">10:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">that said, its very fuzzy</td></tr>
  <tr class="msg" id="L55"><td class="ts-cell"><a class="ts" href="#L55" alt="Thu Jul 28 2022 03:29:54 GMT-0700 (Pacific Daylight Time)">10:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">just, you know, interesting</td></tr>
  <tr class="msg" id="L56"><td class="ts-cell"><a class="ts" href="#L56" alt="Thu Jul 28 2022 03:30:01 GMT-0700 (Pacific Daylight Time)">10:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">its an interesting idea</td></tr>
  <tr class="msg" id="L57"><td class="ts-cell"><a class="ts" href="#L57" alt="Thu Jul 28 2022 03:30:08 GMT-0700 (Pacific Daylight Time)">10:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">don't immediately hate it</td></tr>
  <tr class="msg" id="L58"><td class="ts-cell"><a class="ts" href="#L58" alt="Thu Jul 28 2022 03:30:23 GMT-0700 (Pacific Daylight Time)">10:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">but it might be a bit verbose </td></tr>
  <tr class="msg" id="L59"><td class="ts-cell"><a class="ts" href="#L59" alt="Thu Jul 28 2022 03:30:41 GMT-0700 (Pacific Daylight Time)">10:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">and these are function statements, not expressions</td></tr>
  <tr class="msg" id="L60"><td class="ts-cell"><a class="ts" href="#L60" alt="Thu Jul 28 2022 03:30:59 GMT-0700 (Pacific Daylight Time)">10:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">so I would probably need to define these statements in module scope </td></tr>
  <tr class="msg" id="L61"><td class="ts-cell"><a class="ts" href="#L61" alt="Thu Jul 28 2022 03:31:12 GMT-0700 (Pacific Daylight Time)">10:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell"><p>yep, someone i spoke to suggested that we add sugar for it, ie:</p>
<pre><code class="language-js">let foo = (res when { // whaever } ) =&gt; { ... }
    | (res when { // whaever } ) =&gt; { ... };
</code></pre>
</td></tr>
  <tr class="msg" id="L62"><td class="ts-cell"><a class="ts" href="#L62" alt="Thu Jul 28 2022 03:31:43 GMT-0700 (Pacific Daylight Time)">10:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">i mean, that is just the original proposal isn't it?</td></tr>
  <tr class="msg" id="L63"><td class="ts-cell"><a class="ts" href="#L63" alt="Thu Jul 28 2022 03:32:12 GMT-0700 (Pacific Daylight Time)">10:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">it is close, with the exception that it gets interesting for single definitions</td></tr>
  <tr class="msg" id="L64"><td class="ts-cell"><a class="ts" href="#L64" alt="Thu Jul 28 2022 03:32:36 GMT-0700 (Pacific Daylight Time)">10:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">so if its a single def, and you call it</td></tr>
  <tr class="msg" id="L65"><td class="ts-cell"><a class="ts" href="#L65" alt="Thu Jul 28 2022 03:32:38 GMT-0700 (Pacific Daylight Time)">10:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">would it throw?</td></tr>
  <tr class="msg" id="L66"><td class="ts-cell"><a class="ts" href="#L66" alt="Thu Jul 28 2022 03:32:50 GMT-0700 (Pacific Daylight Time)">10:32</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">yes, if you call it with a non matching shape, the function is treated as undefined</td></tr>
  <tr class="msg" id="L67"><td class="ts-cell"><a class="ts" href="#L67" alt="Thu Jul 28 2022 03:33:01 GMT-0700 (Pacific Daylight Time)">10:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">basically baking in assertions and runtime type checking into the langauge </td></tr>
  <tr class="msg" id="L68"><td class="ts-cell"><a class="ts" href="#L68" alt="Thu Jul 28 2022 03:33:15 GMT-0700 (Pacific Daylight Time)">10:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">my naive implementation would be: for each shaped function, we create an internal function that is only called for that shape</td></tr>
  <tr class="msg" id="L69"><td class="ts-cell"><a class="ts" href="#L69" alt="Thu Jul 28 2022 03:33:55 GMT-0700 (Pacific Daylight Time)">10:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">this is currently fantasy, but interested to hear feedback. I think patterns everywhere is just so damn interesting</td></tr>
  <tr class="msg" id="L70"><td class="ts-cell"><a class="ts" href="#L70" alt="Thu Jul 28 2022 03:34:16 GMT-0700 (Pacific Daylight Time)">10:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">I could imagine someone adding an eslint rule that says all functions need to be pattern functions </td></tr>
  <tr class="msg" id="L71"><td class="ts-cell"><a class="ts" href="#L71" alt="Thu Jul 28 2022 03:34:33 GMT-0700 (Pacific Daylight Time)">10:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">so that at runtime every function call gets checked</td></tr>
  <tr class="msg" id="L72"><td class="ts-cell"><a class="ts" href="#L72" alt="Thu Jul 28 2022 03:34:52 GMT-0700 (Pacific Daylight Time)">10:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">this may have an impact on initial runs of a script. That is -- this is effectively an if statement</td></tr>
  <tr class="msg" id="L73"><td class="ts-cell"><a class="ts" href="#L73" alt="Thu Jul 28 2022 03:35:11 GMT-0700 (Pacific Daylight Time)">10:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">jits remove those, so on hot code it might be equally fast. slow path code may be slower -- something to consider</td></tr>
  <tr class="msg" id="L74"><td class="ts-cell"><a class="ts" href="#L74" alt="Thu Jul 28 2022 03:39:16 GMT-0700 (Pacific Daylight Time)">10:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">maybe making matcher and pattern construction syntax for custom matchers as standalone proposal could be the launch of some interesting paths </td></tr>
  <tr class="msg" id="L75"><td class="ts-cell"><a class="ts" href="#L75" alt="Thu Jul 28 2022 03:39:26 GMT-0700 (Pacific Daylight Time)">10:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">my thoughts exactly ;)</td></tr>
  <tr class="msg" id="L76"><td class="ts-cell"><a class="ts" href="#L76" alt="Thu Jul 28 2022 03:39:37 GMT-0700 (Pacific Daylight Time)">10:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell"><code>match</code> could come later</td></tr>
  <tr class="msg" id="L77"><td class="ts-cell"><a class="ts" href="#L77" alt="Thu Jul 28 2022 03:40:15 GMT-0700 (Pacific Daylight Time)">10:40</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">but you could then move on to match or extractor functions - made up a name for them</td></tr>
  <tr class="msg" id="L78"><td class="ts-cell"><a class="ts" href="#L78" alt="Thu Jul 28 2022 03:41:11 GMT-0700 (Pacific Daylight Time)">10:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">for what its worth -- all of the syntax i proposed is entirely up in the air. it is just to get the idea across and express why we don't want to combine matchers with assignment</td></tr>
  <tr class="msg" id="L79"><td class="ts-cell"><a class="ts" href="#L79" alt="Thu Jul 28 2022 03:41:41 GMT-0700 (Pacific Daylight Time)">10:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">or, restrict where they can be combined. or, maybe i am not creative enough, and they can be combined anyway -- someone might bring an interesting way to do it (personal reflection: i suspect it will still be difficult to read, and we want a split anyway for those cases)</td></tr>
  <tr class="msg" id="L80"><td class="ts-cell"><a class="ts" href="#L80" alt="Thu Jul 28 2022 03:41:53 GMT-0700 (Pacific Daylight Time)">10:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">aliasing was a mistake tho</td></tr>
  <tr class="msg" id="L81"><td class="ts-cell"><a class="ts" href="#L81" alt="Thu Jul 28 2022 03:42:03 GMT-0700 (Pacific Daylight Time)">10:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">(in destructuring, not in this proposal)</td></tr>
  <tr class="msg" id="L82"><td class="ts-cell"><a class="ts" href="#L82" alt="Thu Jul 28 2022 03:45:54 GMT-0700 (Pacific Daylight Time)">10:45</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">a downside I just thought of, what about <code>or</code>?</td></tr>
  <tr class="msg" id="L83"><td class="ts-cell"><a class="ts" href="#L83" alt="Thu Jul 28 2022 03:46:14 GMT-0700 (Pacific Daylight Time)">10:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">actually, probably not an issue</td></tr>
  <tr class="msg" id="L84"><td class="ts-cell"><a class="ts" href="#L84" alt="Thu Jul 28 2022 03:46:28 GMT-0700 (Pacific Daylight Time)">10:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">yep, or can be handled in various ways, as it represents a non-match</td></tr>
  <tr class="msg" id="L85"><td class="ts-cell"><a class="ts" href="#L85" alt="Thu Jul 28 2022 03:46:35 GMT-0700 (Pacific Daylight Time)">10:46</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">but same behavior</td></tr>
  <tr class="msg" id="L86"><td class="ts-cell"><a class="ts" href="#L86" alt="Thu Jul 28 2022 03:47:05 GMT-0700 (Pacific Daylight Time)">10:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">actually, say I have two patterns that are very different shapes </td></tr>
  <tr class="msg" id="L87"><td class="ts-cell"><a class="ts" href="#L87" alt="Thu Jul 28 2022 03:47:16 GMT-0700 (Pacific Daylight Time)">10:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">but the same object matches both?</td></tr>
  <tr class="msg" id="L88"><td class="ts-cell"><a class="ts" href="#L88" alt="Thu Jul 28 2022 03:47:23 GMT-0700 (Pacific Daylight Time)">10:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">the binding on the left, won't necessarily make sense </td></tr>
  <tr class="msg" id="L89"><td class="ts-cell"><a class="ts" href="#L89" alt="Thu Jul 28 2022 03:47:36 GMT-0700 (Pacific Daylight Time)">10:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">I want both patterns to go into the same branch</td></tr>
  <tr class="msg" id="L90"><td class="ts-cell"><a class="ts" href="#L90" alt="Thu Jul 28 2022 03:47:43 GMT-0700 (Pacific Daylight Time)">10:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">ah, i see</td></tr>
  <tr class="msg" id="L91"><td class="ts-cell"><a class="ts" href="#L91" alt="Thu Jul 28 2022 03:47:51 GMT-0700 (Pacific Daylight Time)">10:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">that is a very common usecase </td></tr>
  <tr class="msg" id="L92"><td class="ts-cell"><a class="ts" href="#L92" alt="Thu Jul 28 2022 03:48:01 GMT-0700 (Pacific Daylight Time)">10:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">at least in prior art</td></tr>
  <tr class="msg" id="L93"><td class="ts-cell"><a class="ts" href="#L93" alt="Thu Jul 28 2022 03:48:09 GMT-0700 (Pacific Daylight Time)">10:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">is this for the match statement or the generic case?</td></tr>
  <tr class="msg" id="L94"><td class="ts-cell"><a class="ts" href="#L94" alt="Thu Jul 28 2022 03:48:24 GMT-0700 (Pacific Daylight Time)">10:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">anything that involves binding I guess</td></tr>
  <tr class="msg" id="L95"><td class="ts-cell"><a class="ts" href="#L95" alt="Thu Jul 28 2022 03:48:44 GMT-0700 (Pacific Daylight Time)">10:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">I was trying to think why most prior art marries binding and patterns</td></tr>
  <tr class="msg" id="L96"><td class="ts-cell"><a class="ts" href="#L96" alt="Thu Jul 28 2022 03:48:57 GMT-0700 (Pacific Daylight Time)">10:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">i think largely due to repetition</td></tr>
  <tr class="msg" id="L97"><td class="ts-cell"><a class="ts" href="#L97" alt="Thu Jul 28 2022 03:49:50 GMT-0700 (Pacific Daylight Time)">10:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell"><pre><code class="language-ts"> let { name: name } when ( { name: { name: ${String} } ) { name }
 let { name }  when ( { name: ${String} } ) { name }
</code></pre>
<p>what if both of these cases are meant to do the same work in their branch</p>
</td></tr>
  <tr class="msg" id="L98"><td class="ts-cell"><a class="ts" href="#L98" alt="Thu Jul 28 2022 03:49:53 GMT-0700 (Pacific Daylight Time)">10:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">and we have <code>do</code></td></tr>
  <tr class="msg" id="L99"><td class="ts-cell"><a class="ts" href="#L99" alt="Thu Jul 28 2022 03:49:58 GMT-0700 (Pacific Daylight Time)">10:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">and the body of <code>do</code> is complex and maybe makes use of values in the outer scope</td></tr>
  <tr class="msg" id="L100"><td class="ts-cell"><a class="ts" href="#L100" alt="Thu Jul 28 2022 03:50:00 GMT-0700 (Pacific Daylight Time)">10:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">but i would say the more important aspect -- is that it aids reading: a long statement is harder to comprehend than a short one, and if the two truely hold the same information then the repetition unnecessarily obfuscate what is happening</td></tr>
  <tr class="msg" id="L101"><td class="ts-cell"><a class="ts" href="#L101" alt="Thu Jul 28 2022 03:50:33 GMT-0700 (Pacific Daylight Time)">10:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <pre><code class="language-ts"> let { name: name } when ( { name: { name: ${String} } ) { name }
 let { name }  when ( { name: ${String} } ) { name }
</code></pre>
<p>what if both of these cases are meant to do the same work in their branch</p>
</blockquote></mx-reply>i think this example is why we want to be able to call functions that can return matchers</td></tr>
  <tr class="msg" id="L102"><td class="ts-cell"><a class="ts" href="#L102" alt="Thu Jul 28 2022 03:50:42 GMT-0700 (Pacific Daylight Time)">10:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">rather than doing it in syntax</td></tr>
  <tr class="msg" id="L103"><td class="ts-cell"><a class="ts" href="#L103" alt="Thu Jul 28 2022 03:51:04 GMT-0700 (Pacific Daylight Time)">10:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">syntax will always be restrictive -- what we enable to do easily in syntax should aid readability </td></tr>
  <tr class="msg" id="L104"><td class="ts-cell"><a class="ts" href="#L104" alt="Thu Jul 28 2022 03:51:28 GMT-0700 (Pacific Daylight Time)">10:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">but the above would still be two statements in the current proposal iiuc</td></tr>
  <tr class="msg" id="L105"><td class="ts-cell"><a class="ts" href="#L105" alt="Thu Jul 28 2022 03:53:46 GMT-0700 (Pacific Daylight Time)">10:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell"><em>yulia is a big fan of the custom matchers, if it isn't obvious</em></td></tr>
  <tr class="msg" id="L106"><td class="ts-cell"><a class="ts" href="#L106" alt="Thu Jul 28 2022 03:56:51 GMT-0700 (Pacific Daylight Time)">10:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">so we go back to the <code>hasName</code> matcher - so you can specify the pertinent value that you likely want to later bind</td></tr>
  <tr class="msg" id="L107"><td class="ts-cell"><a class="ts" href="#L107" alt="Thu Jul 28 2022 03:58:18 GMT-0700 (Pacific Daylight Time)">10:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@m-rutter:matrix.org">michael</span>&gt;</div></td><td class="msg-cell">which probably will result in userland libraries to aide in their construction - which might not be a bad thing </td></tr>
  <tr class="msg" id="L108"><td class="ts-cell"><a class="ts" href="#L108" alt="Thu Jul 28 2022 04:02:25 GMT-0700 (Pacific Daylight Time)">11:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">yeah, maybe at some point this can be aided by syntax. but overall i am a big fan of functions as they allow what we cannot anticipate</td></tr>
  <tr class="msg" id="L109"><td class="ts-cell"><a class="ts" href="#L109" alt="Thu Jul 28 2022 04:02:35 GMT-0700 (Pacific Daylight Time)">11:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell">or perhaps, should not anticipate</td></tr>
  <tr class="msg" id="L110"><td class="ts-cell"><a class="ts" href="#L110" alt="Thu Jul 28 2022 08:25:16 GMT-0700 (Pacific Daylight Time)">15:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@tabatkins:matrix.org">TabAtkins</span>&gt;</div></td><td class="msg-cell">A "function returning a matcher" can just be a custom matcher that uses <code>match()</code> internally, I think?</td></tr>
  <tr class="msg" id="L111"><td class="ts-cell"><a class="ts" href="#L111" alt="Thu Jul 28 2022 08:25:32 GMT-0700 (Pacific Daylight Time)">15:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@tabatkins:matrix.org">TabAtkins</span>&gt;</div></td><td class="msg-cell">And that doesn't require us to reify the matcher structures into first-class values</td></tr>
  <tr class="msg" id="L112"><td class="ts-cell"><a class="ts" href="#L112" alt="Thu Jul 28 2022 08:28:51 GMT-0700 (Pacific Daylight Time)">15:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@tabatkins:matrix.org">TabAtkins</span>&gt;</div></td><td class="msg-cell">oh and <span class="nick-4">Jack Works</span> Yeah you're right, plain functions aren't usable. Need to write, like, `when(${{[Symbol.matcher]: somePredicate}})`, which is a bit annoying.</td></tr>
  <tr class="msg" id="L113"><td class="ts-cell"><a class="ts" href="#L113" alt="Thu Jul 28 2022 09:07:21 GMT-0700 (Pacific Daylight Time)">16:07</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@yulia:mozilla.org">yulia</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> A "function returning a matcher" can just be a custom matcher that uses <code>match()</code> internally, I think?</blockquote></mx-reply>yep, also true.</td></tr>
  <tr class="msg" id="L114"><td class="ts-cell"><a class="ts" href="#L114" alt="Thu Jul 28 2022 09:11:39 GMT-0700 (Pacific Daylight Time)">16:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@tabatkins:matrix.org">TabAtkins</span>&gt;</div></td><td class="msg-cell">Hmmmmm I wonder if it's acceptable to have functions automatically act as custom matchers (if they don't have a Symbol.matcher on them or their prototype). It would mean if you wanted to check if the matchable <em>is</em> a particular function, you'll need to write a trivial <code>${x=&gt;x===func}</code>, but I think I'm fine with that? And the fact that you can write arbitrarily-complex matchers with a tiny little arrow func like that seems <em>really</em> appealing.</td></tr>
  <tr class="msg" id="L115"><td class="ts-cell"><a class="ts" href="#L115" alt="Thu Jul 28 2022 09:13:08 GMT-0700 (Pacific Daylight Time)">16:13</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@tabatkins:matrix.org">TabAtkins</span>&gt;</div></td><td class="msg-cell">That would be putting us at enough carve-outs for non-primitive values that I'm becoming less sanguine about random non-primitives in <code>${}</code> patterns just being treated as an equality matcher.</td></tr>
  <tr class="msg" id="L116"><td class="ts-cell"><a class="ts" href="#L116" alt="Thu Jul 28 2022 09:14:07 GMT-0700 (Pacific Daylight Time)">16:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@tabatkins:matrix.org">TabAtkins</span>&gt;</div></td><td class="msg-cell">i'll open an issue</td></tr>
  <tr class="msg" id="L117"><td class="ts-cell"><a class="ts" href="#L117" alt="Thu Jul 28 2022 09:35:54 GMT-0700 (Pacific Daylight Time)">16:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@tabatkins:matrix.org">TabAtkins</span>&gt;</div></td><td class="msg-cell"><a href="https://github.com/tc39/proposal-pattern-matching/issues/282">https://github.com/tc39/proposal-pattern-matching/issues/282</a></td></tr>

</tbody></table></div></div></div>
</body></html>