<!DOCTYPE html><html><head>
  <title>Pattern Matching Champions on 2023-09-24</title>
  <link rel="stylesheet" href="../style.css">
  <script>window.room = "Pattern Matching Champions";</script><script src="../render-roomlist.js"></script>
  <script src="../logs.js"></script>
</head>
<body><div class="wrapper">
<div class="sidebar">
<div class="title">Pattern Matching Champions<br>2023-09-24<br><a href="plaintext/">plaintext logs</a></div>
<div class="nav">
<a href="2023-09-23" class="nav-link"><span>prev</span></a>
<a href="2023-09-25" class="nav-link"><span style="float:right">next</span></a>
</div>
    <div class="all-rooms"><noscript>JavaScript is required to load the channel index, but you can go to <a href="../..">the static index</a> directly.</noscript></div>
<div class="footer"><a href="https://github.com/bakkot/matrix-archive-bot">source on github</a></div>
</div>
<div class="rhs">
<div class="rhs-header">
<span id="error" style="color: red; display:none">error</span>

<input type="text" id="query" size="25" placeholder="Search Pattern Matching Champions">
<a id="search-submit" class="button icon-link" title="Search">
  <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg>
</a>
</div>

<div class="log"><table id="log-table"><tbody id="log-tbody">

  <tr class="msg" id="L0"><td class="ts-cell"><a class="ts" href="#L0" alt="Sat Sep 23 2023 18:23:57 GMT-0700 (Pacific Daylight Time)">01:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">the bit you just quoted <em>isn't</em> hyperbole</td></tr>
  <tr class="msg" id="L1"><td class="ts-cell"><a class="ts" href="#L1" alt="Sat Sep 23 2023 18:24:05 GMT-0700 (Pacific Daylight Time)">01:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">it's literally a problem statement</td></tr>
  <tr class="msg" id="L2"><td class="ts-cell"><a class="ts" href="#L2" alt="Sat Sep 23 2023 18:25:13 GMT-0700 (Pacific Daylight Time)">01:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">my tone may have been an upset/shocked one, but I was genuinely waiting to hear a single concrete benefit</td></tr>
  <tr class="msg" id="L3"><td class="ts-cell"><a class="ts" href="#L3" alt="Sat Sep 23 2023 18:31:54 GMT-0700 (Pacific Daylight Time)">01:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">I brought this discussion outside of the PR because I expected a conversation</td></tr>
  <tr class="msg" id="L4"><td class="ts-cell"><a class="ts" href="#L4" alt="Sat Sep 23 2023 18:33:21 GMT-0700 (Pacific Daylight Time)">01:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">if this proposal is a story of repeatedly trying to go too far and needing to rewrite, then "why do we need this?" is THE most important question to ask about any facet of it<br>(<em>I mean, I think it's the most important question about any proposal, but yeah.</em>)</td></tr>
  <tr class="msg" id="L5"><td class="ts-cell"><a class="ts" href="#L5" alt="Sat Sep 23 2023 18:35:54 GMT-0700 (Pacific Daylight Time)">01:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">it would need to be extremely clear why JS requires <code>if</code> patterns if that is an unusual concept for pattern matching constructs crosslinguistically</td></tr>
  <tr class="msg" id="L6"><td class="ts-cell"><a class="ts" href="#L6" alt="Sat Sep 23 2023 18:43:31 GMT-0700 (Pacific Daylight Time)">01:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">and in attempting to figure out the rationale myself, I identified an even larger concern than the one I initially had, but I did <em>not</em> manage to identify why greater ability to short-circuit should constitute an undeniable benefit</td></tr>
  <tr class="msg" id="L7"><td class="ts-cell"><a class="ts" href="#L7" alt="Sat Sep 23 2023 18:44:22 GMT-0700 (Pacific Daylight Time)">01:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">I think you're reacting to "objectively nasty", and that's super unfortunate because I said that as a "laugh together" phrase</td></tr>
  <tr class="msg" id="L8"><td class="ts-cell"><a class="ts" href="#L8" alt="Sat Sep 23 2023 19:09:25 GMT-0700 (Pacific Daylight Time)">02:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">IIRC, one of the reasons we considered <code>if</code> patterns was to provide a way to continue to have some ability to evaluate expressions in-situ within the pattern without needing the full <code>${}</code> syntax, which was also unique to this proposal in comparison to other pattern matching systems. <code>if</code> patterns were at least <em>close</em> to existing syntax, by expanding <code>when ... if ...</code> to be more flexible. I'm not sure if there were other reasons.</td></tr>
  <tr class="msg" id="L9"><td class="ts-cell"><a class="ts" href="#L9" alt="Sat Sep 23 2023 19:12:59 GMT-0700 (Pacific Daylight Time)">02:12</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I personally found <code>${}</code> to be more problematic because it allowed completely arbitrary expressions, which could make patterns completely unreadable, and because it would prevent future use of <code>identifier{</code> due to <code>$</code> being a legal identifier.</td></tr>
  <tr class="msg" id="L10"><td class="ts-cell"><a class="ts" href="#L10" alt="Sat Sep 23 2023 19:25:14 GMT-0700 (Pacific Daylight Time)">02:25</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><p><code>if</code> patterns, at least, provide some additional benefit. For example:</p>
<pre><code>match ([1, "a"]) {
  when [Number and let x, String] or [1 or "1", "a"] if (x % 2 === 0): ...; // (a)
  when [Number and let x and if (x % 2 === 0), String] or [1 or "1", "a"]: ...;  // (b)
}
</code></pre>
<p>With <code>if</code> as a clause and not a pattern (a), the first branch of the disjunction succeeds, but the <code>if</code> clause fails, even though the second branch of the disjunction would have succeeded.<br>With <code>if</code> as a pattern (b), we can perform the check locally within the subpattern. As a result, the first branch fails, but the 2nd branch succeeds.</p>
</td></tr>
  <tr class="msg" id="L11"><td class="ts-cell"><a class="ts" href="#L11" alt="Sat Sep 23 2023 19:26:39 GMT-0700 (Pacific Daylight Time)">02:26</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><p>Now consider this modified example:</p>
<pre><code>match (["1", "a"]) {
  when [Number and let x, String] or [1 or "1", "a"] if (x % 2 === 0): ...; // (a)
  when [Number and let x and if (x % 2 === 0), String] or [1 or "1", "a"]: ...;  // (b)
}
</code></pre>
<p>Here <code>x</code> is not defined in the 2nd branch of (a), so the <code>if</code> clause would result in a TDZ error. There would be no way around this aside from introducing a dummy <code>let x</code> somewhere just to ensure its valid on both sides.</p>
</td></tr>
  <tr class="msg" id="L12"><td class="ts-cell"><a class="ts" href="#L12" alt="Sat Sep 23 2023 19:28:24 GMT-0700 (Pacific Daylight Time)">02:28</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Having two separate <code>when</code> clauses isn't necessarily an option if you don't want to repeat the expression in <code>...</code>. I can't recall whether <code>when</code> branches have fall-through for empty bodies like <code>case</code> does, but I don't imagine they do.</td></tr>
  <tr class="msg" id="L13"><td class="ts-cell"><a class="ts" href="#L13" alt="Sat Sep 23 2023 19:29:32 GMT-0700 (Pacific Daylight Time)">02:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Also, <code>if</code> patterns don't preclude us from having a standalone <code>if</code> clause so that you don't need to do <code>when if (x): </code> on its own and could just use <code>if(x):</code></td></tr>
  <tr class="msg" id="L14"><td class="ts-cell"><a class="ts" href="#L14" alt="Sat Sep 23 2023 19:44:18 GMT-0700 (Pacific Daylight Time)">02:44</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><p>One could also argue that we don't need <code>when</code> at all. It isn't strictly necessary as a syntactic disambiguation. We could have made <code>match</code> syntax look like this instead:</p>
<pre><code>match (x) {
  String: ...;
  [Number]: ...;
  { y: let y } and if (y.foo()): ...;
  if (x &gt; 0): ...;
  default: ...;
}
</code></pre>
</td></tr>
  <tr class="msg" id="L15"><td class="ts-cell"><a class="ts" href="#L15" alt="Sat Sep 23 2023 19:50:31 GMT-0700 (Pacific Daylight Time)">02:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><p>C# doesn't use a clause keyword like <code>when</code> to introduce a new match leg:</p>
<pre><code class="language-cs">vehicle switch {
  Car _ =&gt; ...,
  Truck _ =&gt; ...,
  _ =&gt; throw new ArgumentNullException(),
};
</code></pre>
<p>Neither does Rust:</p>
<pre><code class="language-rs">match x {
  Some(x) =&gt; Some(x + 1),
  None =&gt; None
}
</code></pre>
</td></tr>
  <tr class="msg" id="L16"><td class="ts-cell"><a class="ts" href="#L16" alt="Sat Sep 23 2023 20:00:50 GMT-0700 (Pacific Daylight Time)">03:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><p>In fact, I've mentioned before how it's unfortunate that we don't have an "irrefutable match" pattern, aside from the <code>let</code>/<code>const</code>/<code>var</code> declaration patterns which introduce bindings. If we had one, we wouldn't need <code>default</code> at all. I'd suggested <code>void</code> as a potential "irrefutable match" pattern with the semantic meaning of "match whatever, it doesn't matter" being close enough to <code>void</code> to be meaningful. Without the <code>when</code> clause head, and using <code>void</code> for an irrefutable match, it could be patterns all the way down:</p>
<pre><code>const transform = point =&gt; match (point) {
  { x: let x, y: let y and if (y &gt; x) } : new Point(x + y, y);
  { x: let x, y: let y and if (y &lt; x) } : new Point(x - y, y);
  { x: let x, y: let y }                : new Point(2 * x, 2 * y);
  void                                  : new Point(0, 0)
}
</code></pre>
</td></tr>
  <tr class="msg" id="L17"><td class="ts-cell"><a class="ts" href="#L17" alt="Sat Sep 23 2023 20:01:46 GMT-0700 (Pacific Daylight Time)">03:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell">if pattern to me is an escape hatch when the pattern is not expressive enough </td></tr>
  <tr class="msg" id="L18"><td class="ts-cell"><a class="ts" href="#L18" alt="Sat Sep 23 2023 20:02:48 GMT-0700 (Pacific Daylight Time)">03:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-4" title="@jackworks:matrix.org">Jack Works</span>&gt;</div></td><td class="msg-cell">for example today you cannot match `&gt; 0`, but you can make it via if pattern</td></tr>
  <tr class="msg" id="L19"><td class="ts-cell"><a class="ts" href="#L19" alt="Sat Sep 23 2023 20:05:14 GMT-0700 (Pacific Daylight Time)">03:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><p>I'll admit the above example doesn't showcase the need for the escape hatch in the presence of relational patterns like <code>&gt;</code>:</p>
<pre><code>const transform = point =&gt; match (point) {
  { x: let x, y: &gt; x and let y } : new Point(x + y, y);
  { x: let x, y: &lt; x and let y } : new Point(x - y, y);
  { x: let x, y: let y }         : new Point(2 * x, 2 * y);
  void                           : new Point(0, 0)
}
</code></pre>
<p>However, a better example might be method calls (again using a <code>when</code>-less variant of the syntax):</p>
<pre><code>match (x) {
  { foo: let y and if (y.bar()), baz: String }: ...;
}
</code></pre>
</td></tr>
  <tr class="msg" id="L20"><td class="ts-cell"><a class="ts" href="#L20" alt="Sat Sep 23 2023 20:08:47 GMT-0700 (Pacific Daylight Time)">03:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><p>Hmm. I wonder if <code>*</code> would make for a good "irrefutable pattern" token?</p>
<pre><code>match (obj) {
  { x: Number, y: * }: ...;
  *: ...;
}
</code></pre>
<p>My only concern would be using up a token that could have other more useful potential meanings in the future.</p>
</td></tr>
  <tr class="msg" id="L21"><td class="ts-cell"><a class="ts" href="#L21" alt="Sat Sep 23 2023 20:09:15 GMT-0700 (Pacific Daylight Time)">03:09</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">(It's a shame we can't use <code>_</code> as a discard)</td></tr>
  <tr class="msg" id="L22"><td class="ts-cell"><a class="ts" href="#L22" alt="Sat Sep 23 2023 20:10:47 GMT-0700 (Pacific Daylight Time)">03:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <p>In fact, I've mentioned before how it's unfortunate that we don't have an "irrefutable match" pattern, aside from the <code>let</code>/<code>const</code>/<code>var</code> declaration patterns which introduce bindings. If we had one, we wouldn't need <code>default</code> at all. I'd suggested <code>void</code> as a potential "irrefutable match" pattern with the semantic meaning of "match whatever, it doesn't matter" being close enough to <code>void</code> to be meaningful. Without the <code>when</code> clause head, and using <code>void</code> for an irrefutable match, it could be patterns all the way down:</p>
<pre><code>const transform = point =&gt; match (point) {
  { x: let x, y: let y and if (y &gt; x) } : new Point(x + y, y);
  { x: let x, y: let y and if (y &lt; x) } : new Point(x - y, y);
  { x: let x, y: let y }                : new Point(2 * x, 2 * y);
  void                                  : new Point(0, 0)
}
</code></pre>
</blockquote></mx-reply>Note that the example here is adapted from this example in the C# documentation: <a href="https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/operators/switch-expression#case-guards">https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/operators/switch-expression#case-guards</a></td></tr>
  <tr class="msg" id="L23"><td class="ts-cell"><a class="ts" href="#L23" alt="Sat Sep 23 2023 21:31:45 GMT-0700 (Pacific Daylight Time)">04:31</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <p><code>if</code> patterns, at least, provide some additional benefit. For example:</p>
<pre><code>match ([1, "a"]) {
  when [Number and let x, String] or [1 or "1", "a"] if (x % 2 === 0): ...; // (a)
  when [Number and let x and if (x % 2 === 0), String] or [1 or "1", "a"]: ...;  // (b)
}
</code></pre>
<p>With <code>if</code> as a clause and not a pattern (a), the first branch of the disjunction succeeds, but the <code>if</code> clause fails, even though the second branch of the disjunction would have succeeded.<br>With <code>if</code> as a pattern (b), we can perform the check locally within the subpattern. As a result, the first branch fails, but the 2nd branch succeeds.</p>
</blockquote></mx-reply>thanks, (b) is definitely a nice example</td></tr>
  <tr class="msg" id="L24"><td class="ts-cell"><a class="ts" href="#L24" alt="Sat Sep 23 2023 21:33:59 GMT-0700 (Pacific Daylight Time)">04:33</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">(I too am forever sad that <code>_</code> isn't usable)</td></tr>
  <tr class="msg" id="L25"><td class="ts-cell"><a class="ts" href="#L25" alt="Sat Sep 23 2023 21:34:56 GMT-0700 (Pacific Daylight Time)">04:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">have we spent time discussing keywordless clauses? I feel I wouldn't be surprised if that had come up previously and been objected to on some basis that's not occurring to me</td></tr>
  <tr class="msg" id="L26"><td class="ts-cell"><a class="ts" href="#L26" alt="Sat Sep 23 2023 21:51:25 GMT-0700 (Pacific Daylight Time)">04:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell"><p>But yeah, my concerns boil down to:</p>
<ol>
<li>
<p>We obviously can't just look at <code>when if (x % 2 === 0):</code> and be like "yup, that's fine". ðŸ˜… I can understand if making the keyword droppable in just this case would feel special-casey, but if we really want <code>if</code> patterns, then that instead means we need to re-evaluate the keyword <code>when</code> itself. After all, if it were <code>case if (...):</code> then there'd be no particular nastiness to speak of.</p>
</li>
<li>
<p><code>if (... is if (...))</code> feels like a downright scary thing to have proposed to be valid JS. I would not feel this way if there were braces involved, say.</p>
</li>
</ol>
</td></tr>
  <tr class="msg" id="L27"><td class="ts-cell"><a class="ts" href="#L27" alt="Sat Sep 23 2023 21:53:48 GMT-0700 (Pacific Daylight Time)">04:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">Also I hope it's clear that my shocked tone is coming from being totally blindsided by these. <code>when if</code> doesn't even make an appearance until the appendix of the document (<a href="https://github.com/tc39/proposal-pattern-matching/pull/293/files#diff-b335630551682c19a781afebcf4d07bf978fb1f8ac04c6bf87428ed5106870f5R1407-R1408">https://github.com/tc39/proposal-pattern-matching/pull/293/files#diff-b335630551682c19a781afebcf4d07bf978fb1f8ac04c6bf87428ed5106870f5R1407-R1408</a>) and <code>is if</code> doesn't make an appearance at all</td></tr>
  <tr class="msg" id="L28"><td class="ts-cell"><a class="ts" href="#L28" alt="Sat Sep 23 2023 22:23:13 GMT-0700 (Pacific Daylight Time)">05:23</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <p>But yeah, my concerns boil down to:</p>
<ol>
<li>
<p>We obviously can't just look at <code>when if (x % 2 === 0):</code> and be like "yup, that's fine". ðŸ˜… I can understand if making the keyword droppable in just this case would feel special-casey, but if we really want <code>if</code> patterns, then that instead means we need to re-evaluate the keyword <code>when</code> itself. After all, if it were <code>case if (...):</code> then there'd be no particular nastiness to speak of.</p>
</li>
<li>
<p><code>if (... is if (...))</code> feels like a downright scary thing to have proposed to be valid JS. I would not feel this way if there were braces involved, say.</p>
</li>
</ol>
</blockquote></mx-reply>I mean, we have <code>if (... ? ... : ...)</code> already today, so the <em>capability</em> exists if not the syntax.</td></tr>
  <tr class="msg" id="L29"><td class="ts-cell"><a class="ts" href="#L29" alt="Sat Sep 23 2023 22:24:28 GMT-0700 (Pacific Daylight Time)">05:24</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Also, I consider <code>is if ()</code> to be a degenerate case. Yes, its possible because it falls out of the syntax, but you probably won't see it in practice.</td></tr>
  <tr class="msg" id="L30"><td class="ts-cell"><a class="ts" href="#L30" alt="Sat Sep 23 2023 22:27:29 GMT-0700 (Pacific Daylight Time)">05:27</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">right and it could even be linted against but</td></tr>
  <tr class="msg" id="L31"><td class="ts-cell"><a class="ts" href="#L31" alt="Sat Sep 23 2023 22:29:34 GMT-0700 (Pacific Daylight Time)">05:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><p>All syntax has cases like that, and I'm not sure its worth being overly pedantic in that case. Especially because I <em>can</em> see uses for it, contrived though they may be:</p>
<pre><code>for (let i = 0; i &lt; 10; i++) {
  x = ar[i].foo() is if (i % 2 === 0) and String;

  // observable semantics:
  // - element `i` is read from `ar`
  // - `ar[i].foo()` is called
  // - the result is tested
}
</code></pre>
<p>no temp variable is necessary to capture the result of <code>ar[i].foo()</code></p>
</td></tr>
  <tr class="msg" id="L32"><td class="ts-cell"><a class="ts" href="#L32" alt="Sat Sep 23 2023 22:30:51 GMT-0700 (Pacific Daylight Time)">05:30</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">But as I said, that's not likely to come up in practice.</td></tr>
  <tr class="msg" id="L33"><td class="ts-cell"><a class="ts" href="#L33" alt="Sat Sep 23 2023 22:34:44 GMT-0700 (Pacific Daylight Time)">05:34</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">even if the "the keywords read weirdly together" were avoided, my primary worry is about <code>if (o is { x: let x, y: let y } and if (x &gt; y))</code></td></tr>
  <tr class="msg" id="L34"><td class="ts-cell"><a class="ts" href="#L34" alt="Sat Sep 23 2023 22:35:06 GMT-0700 (Pacific Daylight Time)">05:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">the point about the functionality being there with a ternary is valid, but</td></tr>
  <tr class="msg" id="L35"><td class="ts-cell"><a class="ts" href="#L35" alt="Sat Sep 23 2023 22:35:32 GMT-0700 (Pacific Daylight Time)">05:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">in theory you could keep nesting <code>is ... if (...)</code>s</td></tr>
  <tr class="msg" id="L36"><td class="ts-cell"><a class="ts" href="#L36" alt="Sat Sep 23 2023 22:35:53 GMT-0700 (Pacific Daylight Time)">05:35</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I'll be honest, that example looks fine to me, and actually warranted if there are more pattern terms following the <code>if</code></td></tr>
  <tr class="msg" id="L37"><td class="ts-cell"><a class="ts" href="#L37" alt="Sat Sep 23 2023 22:36:26 GMT-0700 (Pacific Daylight Time)">05:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">I don't think it's a ridiculous thing to want, to be clear</td></tr>
  <tr class="msg" id="L38"><td class="ts-cell"><a class="ts" href="#L38" alt="Sat Sep 23 2023 22:36:38 GMT-0700 (Pacific Daylight Time)">05:36</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Though you're still more likely to see it as <code>&amp;&amp; x &gt; y</code> in practice</td></tr>
  <tr class="msg" id="L39"><td class="ts-cell"><a class="ts" href="#L39" alt="Sat Sep 23 2023 22:37:08 GMT-0700 (Pacific Daylight Time)">05:37</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">It's kind of like writing <code>[...[]] = []</code>. There's not much benefit to doing it that way.</td></tr>
  <tr class="msg" id="L40"><td class="ts-cell"><a class="ts" href="#L40" alt="Sat Sep 23 2023 22:38:39 GMT-0700 (Pacific Daylight Time)">05:38</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Or people writing things like <code>[+[]][+[]]</code>. Perfectly legal JS, evaluates to <code>0</code>.</td></tr>
  <tr class="msg" id="L41"><td class="ts-cell"><a class="ts" href="#L41" alt="Sat Sep 23 2023 22:39:01 GMT-0700 (Pacific Daylight Time)">05:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">like maybe I'm actually worried about <code>is</code> in general</td></tr>
  <tr class="msg" id="L42"><td class="ts-cell"><a class="ts" href="#L42" alt="Sat Sep 23 2023 22:39:28 GMT-0700 (Pacific Daylight Time)">05:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">that was supposed to make <code>match</code> integrate better into the language IIUC and I didn't initially think that to be bad, but</td></tr>
  <tr class="msg" id="L43"><td class="ts-cell"><a class="ts" href="#L43" alt="Sat Sep 23 2023 22:39:30 GMT-0700 (Pacific Daylight Time)">05:39</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I think <code>is</code> is wonderful, but I'm biased.</td></tr>
  <tr class="msg" id="L44"><td class="ts-cell"><a class="ts" href="#L44" alt="Sat Sep 23 2023 22:41:02 GMT-0700 (Pacific Daylight Time)">05:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">combined with combinators and if patterns it's as if we're now not just redoing <code>switch</code> but also redoing destructuring, boolean operators, and ternaries; it feels like a bifurcation of the language</td></tr>
  <tr class="msg" id="L45"><td class="ts-cell"><a class="ts" href="#L45" alt="Sat Sep 23 2023 22:41:05 GMT-0700 (Pacific Daylight Time)">05:41</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><p>It also provides us with <code>if-let</code> and <code>while-let</code>-like semantics, which <code>match</code> does not:</p>
<pre><code>while (ar.pop() is not undefined and let x) {
  ...
}

if (value is Option.Some(let x)) {
  ...
}
</code></pre>
</td></tr>
  <tr class="msg" id="L46"><td class="ts-cell"><a class="ts" href="#L46" alt="Sat Sep 23 2023 22:42:28 GMT-0700 (Pacific Daylight Time)">05:42</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> combined with combinators and if patterns it's as if we're now not just redoing <code>switch</code> but also redoing destructuring, boolean operators, and ternaries; it feels like a bifurcation of the language</blockquote></mx-reply>That's kind of what pattern matching <em>is</em>. It's a very powerful tool in the FP programmers toolbox.</td></tr>
  <tr class="msg" id="L47"><td class="ts-cell"><a class="ts" href="#L47" alt="Sat Sep 23 2023 22:43:49 GMT-0700 (Pacific Daylight Time)">05:43</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I don't think the original premise of the pattern matching proposal was "let's make a better <code>switch</code>", it was "let's do pattern matching, and while we're at it let's not repeat the same mistakes as <code>switch</code>"</td></tr>
  <tr class="msg" id="L48"><td class="ts-cell"><a class="ts" href="#L48" alt="Sat Sep 23 2023 22:47:00 GMT-0700 (Pacific Daylight Time)">05:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">one can reasonably expect that a pattern matching feature would be confined to a <code>match</code> statement though</td></tr>
  <tr class="msg" id="L49"><td class="ts-cell"><a class="ts" href="#L49" alt="Sat Sep 23 2023 22:47:29 GMT-0700 (Pacific Daylight Time)">05:47</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Maybe? That's not the case in a large number of languages with pattern matching though.</td></tr>
  <tr class="msg" id="L50"><td class="ts-cell"><a class="ts" href="#L50" alt="Sat Sep 23 2023 22:48:12 GMT-0700 (Pacific Daylight Time)">05:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Rust has patterns everywhere, as well as <code>if-let</code> and <code>while-let</code>. C# has <code>switch</code> expressions, improved <code>switch</code> statements, and <code>is</code>.</td></tr>
  <tr class="msg" id="L51"><td class="ts-cell"><a class="ts" href="#L51" alt="Sat Sep 23 2023 22:48:39 GMT-0700 (Pacific Daylight Time)">05:48</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><code>match</code> is a better <code>switch</code>, <code>is</code> is a better <code>instanceof</code> :)</td></tr>
  <tr class="msg" id="L52"><td class="ts-cell"><a class="ts" href="#L52" alt="Sat Sep 23 2023 22:49:11 GMT-0700 (Pacific Daylight Time)">05:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">I mean, <code>is</code> is basically a rewrite of boolean expressions</td></tr>
  <tr class="msg" id="L53"><td class="ts-cell"><a class="ts" href="#L53" alt="Sat Sep 23 2023 22:49:39 GMT-0700 (Pacific Daylight Time)">05:49</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">boolean expressions that only target a single value, maybe.</td></tr>
  <tr class="msg" id="L54"><td class="ts-cell"><a class="ts" href="#L54" alt="Sat Sep 23 2023 22:50:04 GMT-0700 (Pacific Daylight Time)">05:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">aside from <code>if</code> patterns, <code>is</code> can only operate on the left-hand side expression and its properties</td></tr>
  <tr class="msg" id="L55"><td class="ts-cell"><a class="ts" href="#L55" alt="Sat Sep 23 2023 22:50:25 GMT-0700 (Pacific Daylight Time)">05:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">so <code>is</code> is never going to replace regular boolean expressions. That wasn't the case in C# either.</td></tr>
  <tr class="msg" id="L56"><td class="ts-cell"><a class="ts" href="#L56" alt="Sat Sep 23 2023 22:50:50 GMT-0700 (Pacific Daylight Time)">05:50</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">It will certainly grow to fill its niche, but it won't take over.</td></tr>
  <tr class="msg" id="L57"><td class="ts-cell"><a class="ts" href="#L57" alt="Sat Sep 23 2023 22:51:45 GMT-0700 (Pacific Daylight Time)">05:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">it's really hard to keep up with you but</td></tr>
  <tr class="msg" id="L58"><td class="ts-cell"><a class="ts" href="#L58" alt="Sat Sep 23 2023 22:51:57 GMT-0700 (Pacific Daylight Time)">05:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Besides with the potential for relational patterns in the future, I find <code>x is &gt; 0 and &lt;= 10</code> to be a vast improvement over <code>x &gt; 0 &amp;&amp; x &lt;= 10</code> in terms of readability.</td></tr>
  <tr class="msg" id="L59"><td class="ts-cell"><a class="ts" href="#L59" alt="Sat Sep 23 2023 22:52:50 GMT-0700 (Pacific Daylight Time)">05:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">what other languages do only informs so much; one is obliged to begin any conversation about pattern matching in JS with concern for whether that can be suitably realized in a dynamic language that's obliged to never break the web</td></tr>
  <tr class="msg" id="L60"><td class="ts-cell"><a class="ts" href="#L60" alt="Sat Sep 23 2023 22:53:18 GMT-0700 (Pacific Daylight Time)">05:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">obviously I would like there to be a way to realize it in a way that suits JS and not some other language</td></tr>
  <tr class="msg" id="L61"><td class="ts-cell"><a class="ts" href="#L61" alt="Sat Sep 23 2023 22:53:39 GMT-0700 (Pacific Daylight Time)">05:53</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">but "here's a billion new things we can do" is not a thing I ever want to hear about JS</td></tr>
  <tr class="msg" id="L62"><td class="ts-cell"><a class="ts" href="#L62" alt="Sat Sep 23 2023 22:54:58 GMT-0700 (Pacific Daylight Time)">05:54</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">Yes, but I also want to avoid the "death by 1,000 papercuts" that JS often is. pattern matching makes it easy to express complex things simply, which is a huge improvement to readability as it gains adoption. </td></tr>
  <tr class="msg" id="L63"><td class="ts-cell"><a class="ts" href="#L63" alt="Sat Sep 23 2023 22:55:05 GMT-0700 (Pacific Daylight Time)">05:55</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">a <code>match</code> statement is quite a comfortable space to work in, and if you ask a random JS dev about pattern matching, you'd expect that they'd view those as synonymous</td></tr>
  <tr class="msg" id="L64"><td class="ts-cell"><a class="ts" href="#L64" alt="Sat Sep 23 2023 22:56:43 GMT-0700 (Pacific Daylight Time)">05:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">I understood the rationale of <code>is</code> to be a way to make the feature deployable in smaller phases by having patterns be a standalone concept but</td></tr>
  <tr class="msg" id="L65"><td class="ts-cell"><a class="ts" href="#L65" alt="Sat Sep 23 2023 22:56:54 GMT-0700 (Pacific Daylight Time)">05:56</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">My goal isn't to shove as many things as possible into JS, my goal is to add features that remove the sharp edges from the language and improve developer productivity. To benefit various camps of developers coming <em>to</em> JS <em>from</em> other languages, as well as those starting from scratch.</td></tr>
  <tr class="msg" id="L66"><td class="ts-cell"><a class="ts" href="#L66" alt="Sat Sep 23 2023 22:57:13 GMT-0700 (Pacific Daylight Time)">05:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I understood the rationale of <code>is</code> to be a way to make the feature deployable in smaller phases by having patterns be a standalone concept but</blockquote></mx-reply>That is one of its intended values, yes.</td></tr>
  <tr class="msg" id="L67"><td class="ts-cell"><a class="ts" href="#L67" alt="Sat Sep 23 2023 22:57:18 GMT-0700 (Pacific Daylight Time)">05:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">tbh I haven't really known how I've felt about this proposal <em>since</em> that moment</td></tr>
  <tr class="msg" id="L68"><td class="ts-cell"><a class="ts" href="#L68" alt="Sat Sep 23 2023 22:57:38 GMT-0700 (Pacific Daylight Time)">05:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">I liked the proposal that that came as a response to</td></tr>
  <tr class="msg" id="L69"><td class="ts-cell"><a class="ts" href="#L69" alt="Sat Sep 23 2023 22:57:42 GMT-0700 (Pacific Daylight Time)">05:57</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">It's a good introduction to "here is what a pattern is"</td></tr>
  <tr class="msg" id="L70"><td class="ts-cell"><a class="ts" href="#L70" alt="Sat Sep 23 2023 22:58:58 GMT-0700 (Pacific Daylight Time)">05:58</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">The <code>let when</code> proposal? I had a strong dislike for the syntax in that design. It felt so convoluted. I didn't disagree with the principals it espoused though.</td></tr>
  <tr class="msg" id="L71"><td class="ts-cell"><a class="ts" href="#L71" alt="Sat Sep 23 2023 23:00:27 GMT-0700 (Pacific Daylight Time)">06:00</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">But if you want to break things down into layering in terms of a framework to build an understanding of the feature, it isn't "here is <code>is</code>, then here is all of the patterns, and finally here is <code>match</code>." It's far more nuanced.</td></tr>
  <tr class="msg" id="L72"><td class="ts-cell"><a class="ts" href="#L72" alt="Sat Sep 23 2023 23:01:37 GMT-0700 (Pacific Daylight Time)">06:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">so in particular, I actually liked <code>${}</code> a lot, because I felt like it was really comfortable wrt how bindings work in the pattern matching constructs that I'm used to</td></tr>
  <tr class="msg" id="L73"><td class="ts-cell"><a class="ts" href="#L73" alt="Sat Sep 23 2023 23:01:47 GMT-0700 (Pacific Daylight Time)">06:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I see it more as "here is <code>is</code>. It lets you test a value against a pattern, and either succeeds (<code>true</code>) or fails (<code>false</code>). <code>match</code> extends this concept into multiple branches.</td></tr>
  <tr class="msg" id="L74"><td class="ts-cell"><a class="ts" href="#L74" alt="Sat Sep 23 2023 23:01:58 GMT-0700 (Pacific Daylight Time)">06:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> so in particular, I actually liked <code>${}</code> a lot, because I felt like it was really comfortable wrt how bindings work in the pattern matching constructs that I'm used to</blockquote></mx-reply>In which language?</td></tr>
  <tr class="msg" id="L75"><td class="ts-cell"><a class="ts" href="#L75" alt="Sat Sep 23 2023 23:01:59 GMT-0700 (Pacific Daylight Time)">06:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">but that's fine, I can see that var/let/const is going to make people happier <em>as JS</em></td></tr>
  <tr class="msg" id="L76"><td class="ts-cell"><a class="ts" href="#L76" alt="Sat Sep 23 2023 23:02:48 GMT-0700 (Pacific Daylight Time)">06:02</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">like Haskell/ML, say; I found it comfortable to view binding as the default behavior and demarcate the stuff that is going to behave in a fancy way</td></tr>
  <tr class="msg" id="L77"><td class="ts-cell"><a class="ts" href="#L77" alt="Sat Sep 23 2023 23:03:47 GMT-0700 (Pacific Daylight Time)">06:03</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">I also have desire for <code>if-let</code>, as a separate matter</td></tr>
  <tr class="msg" id="L78"><td class="ts-cell"><a class="ts" href="#L78" alt="Sat Sep 23 2023 23:04:25 GMT-0700 (Pacific Daylight Time)">06:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">My biggest gripe with Rust's pattern matching syntax is that Reference vs. Binding wholly depends on whether the thing already exists in scope.</td></tr>
  <tr class="msg" id="L79"><td class="ts-cell"><a class="ts" href="#L79" alt="Sat Sep 23 2023 23:04:38 GMT-0700 (Pacific Daylight Time)">06:04</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">this is a very nice phrasing, particularly if <code>is</code> really were deployed as an earlier feature</td></tr>
  <tr class="msg" id="L80"><td class="ts-cell"><a class="ts" href="#L80" alt="Sat Sep 23 2023 23:05:36 GMT-0700 (Pacific Daylight Time)">06:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">and I mean, in that space, you'd have the ability to clearly see what seems like a clear improvement to the language as opposed to just "a new way to do all the same stuff"</td></tr>
  <tr class="msg" id="L81"><td class="ts-cell"><a class="ts" href="#L81" alt="Sat Sep 23 2023 23:05:36 GMT-0700 (Pacific Daylight Time)">06:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I look at <code>let</code> bindings as something you talk about first in terms of <code>match</code>, as the way to get values out of the pattern in each branch, and then you bring it back to <code>is</code> for its use with <code>if</code> and <code>while</code>, in particular.</td></tr>
  <tr class="msg" id="L82"><td class="ts-cell"><a class="ts" href="#L82" alt="Sat Sep 23 2023 23:08:57 GMT-0700 (Pacific Daylight Time)">06:08</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><p>And, while I admit it's nowhere near as clean as <code>let ... in ...</code> in other languages, you can use <code>let</code> patterns to achieve much of the same effect:</p>
<pre><code>// with let ... in ...
x = let y = 1 in y + y;

// with `is let`
x = 1 is let y &amp;&amp; y + y;
</code></pre>
<p>It's not <em>great</em>, to be fair, but it is mostly sufficient for that purpose.</p>
</td></tr>
  <tr class="msg" id="L83"><td class="ts-cell"><a class="ts" href="#L83" alt="Sat Sep 23 2023 23:10:26 GMT-0700 (Pacific Daylight Time)">06:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">oh wow</td></tr>
  <tr class="msg" id="L84"><td class="ts-cell"><a class="ts" href="#L84" alt="Sat Sep 23 2023 23:10:33 GMT-0700 (Pacific Daylight Time)">06:10</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@rkirsling:matrix.org">rkirsling</span>&gt;</div></td><td class="msg-cell">wouldn't've thought of that usage</td></tr>
  <tr class="msg" id="L85"><td class="ts-cell"><a class="ts" href="#L85" alt="Sat Sep 23 2023 23:11:15 GMT-0700 (Pacific Daylight Time)">06:11</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell">I <em>really</em> would like some form of <code>let ... in ...</code>, but I'm happy enough with that at least being possible if not convenient.</td></tr>
  <tr class="msg" id="L86"><td class="ts-cell"><a class="ts" href="#L86" alt="Sat Sep 23 2023 23:14:45 GMT-0700 (Pacific Daylight Time)">06:14</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><p>I too often see code like this (even as recently in some C++ code I was reviewing):</p>
<pre><code class="language-js">let temp;
if (foo() &amp;&amp; (temp = bar()) &amp;&amp; baz(temp)) {
  ...
}
</code></pre>
<p>where the temp variable is far divorced from its assignment. <code>let ... in ...</code> or <code>is let</code> achieves locality to the declaration. Especially when you'd rather it be declared as <code>const</code> instead:</p>
<pre><code>if (foo() &amp;&amp; bar() is const temp &amp;&amp; temp &amp;&amp; baz(temp)) {
}
</code></pre>
</td></tr>
  <tr class="msg" id="L87"><td class="ts-cell"><a class="ts" href="#L87" alt="Sat Sep 23 2023 23:20:20 GMT-0700 (Pacific Daylight Time)">06:20</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><p>One thing I like about <code>let</code>/<code>const</code> patterns is that you can mix and match them:</p>
<pre><code>if (obj is { x: let x, y: const y }) {
}
</code></pre>
<p>You can't do that with binding patterns. They're either all <code>let</code> or all <code>const</code> (or <code>var</code>).</p>
</td></tr>
  <tr class="msg" id="L88"><td class="ts-cell"><a class="ts" href="#L88" alt="Sun Sep 24 2023 11:01:58 GMT-0700 (Pacific Daylight Time)">18:01</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@tabatkins:matrix.org">TabAtkins</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> I think you're reacting to "objectively nasty", and that's super unfortunate because I said that as a "laugh together" phrase</blockquote></mx-reply>No, I was reacting to "I'd expect to see an undeniable benefit, but I'm only seeing negatives". I provided a benefit, and it's undeniable. We can certainly argue whether the benefit is <em>sufficiently worthwhile</em>, but you can't deny that it is, indeed, a benefit of the syntax. The only response I can give to feedback like this is "this is incorrect, I'll repeat the benefit that I previously listed".</td></tr>
  <tr class="msg" id="L89"><td class="ts-cell"><a class="ts" href="#L89" alt="Sun Sep 24 2023 11:05:05 GMT-0700 (Pacific Daylight Time)">18:05</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@tabatkins:matrix.org">TabAtkins</span>&gt;</div></td><td class="msg-cell"><mx-reply><blockquote> <p>One could also argue that we don't need <code>when</code> at all. It isn't strictly necessary as a syntactic disambiguation. We could have made <code>match</code> syntax look like this instead:</p>
<pre><code>match (x) {
  String: ...;
  [Number]: ...;
  { y: let y } and if (y.foo()): ...;
  if (x &gt; 0): ...;
  default: ...;
}
</code></pre>
</blockquote></mx-reply>I do think we should consider this actually. While I like how the final <code>default</code> clause reads, given that I've snuck <code>void</code> patterns in, it is indeed unnecessary.</td></tr>
  <tr class="msg" id="L90"><td class="ts-cell"><a class="ts" href="#L90" alt="Sun Sep 24 2023 11:06:07 GMT-0700 (Pacific Daylight Time)">18:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@tabatkins:matrix.org">TabAtkins</span>&gt;</div></td><td class="msg-cell">And if <span class="nick-6">rkirsling</span> 's main objection to if patterns is how <code>when if(...)</code> looks, that would address it too.</td></tr>
  <tr class="msg" id="L91"><td class="ts-cell"><a class="ts" href="#L91" alt="Sun Sep 24 2023 11:06:35 GMT-0700 (Pacific Daylight Time)">18:06</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-10" title="@tabatkins:matrix.org">TabAtkins</span>&gt;</div></td><td class="msg-cell">(But I still don't think the aesthetics of that particular, assumed rare, case are that important to hang an objection off of.)</td></tr>
  <tr class="msg" id="L92"><td class="ts-cell"><a class="ts" href="#L92" alt="Sun Sep 24 2023 12:51:37 GMT-0700 (Pacific Daylight Time)">19:51</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">ftr i think the â€œwhenâ€ is a very valuable marker, and i still donâ€™t think we should be including void patterns here - that should be a follow on.</td></tr>
  <tr class="msg" id="L93"><td class="ts-cell"><a class="ts" href="#L93" alt="Sun Sep 24 2023 12:52:08 GMT-0700 (Pacific Daylight Time)">19:52</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-6" title="@ljharb:matrix.org">ljharb</span>&gt;</div></td><td class="msg-cell">i donâ€™t care how â€œwhenâ€ is spelled ofc, but i would still prefer to use else instead of default, and thatâ€™s only possible without a bare top level if.</td></tr>
  <tr class="msg" id="L94"><td class="ts-cell"><a class="ts" href="#L94" alt="Sun Sep 24 2023 16:29:30 GMT-0700 (Pacific Daylight Time)">23:29</a></td><td class="nick-cell"><div class="m-ov">&lt;<span class="nick nick-15" title="@rbuckton:matrix.org">rbuckton</span>&gt;</div></td><td class="msg-cell"><p>I don't have a strong preference for keeping or dropping <code>when</code>, but I don't find it all that valuable. It is somewhat like having to write <code>function</code> over and over again in expression positions. Everyone was much happier when arrow functions came around and removed that burden.<br>Also, if we drop <code>when</code> as the <em>clause</em> we might be able to use <code>when</code> instead of <code>if</code> for the pattern syntax, which frees us up to use <code>else</code> instead of <code>default</code>:</p>
<pre><code>const transform = point =&gt; match (point) {
  { x: let x, y: let y } when x &lt; y: ...;
  { x: let x, y: let y } when x &gt; y: ...;
  when point.isEmpty()             : ...;
  else                             : ...;
}
</code></pre>
</td></tr>

</tbody></table></div></div></div>
</body></html>